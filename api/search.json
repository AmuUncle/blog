[{"id":"02d1724bb70f847f99a6b9b1b37f943a","title":"MacDockä»‹ç»","content":"MacDockï¼šä½¿ç”¨ QtWidget å¼€å‘çš„å¼ºå¤§æ¡Œé¢ DockMacDock æ˜¯ä¸€ä¸ªä½¿ç”¨ QtWidget å¼€å‘çš„æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œå…·å¤‡ç±»ä¼¼ macOS Dock çš„åŠŸèƒ½ã€‚è¯¥åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥ç®¡ç†å’Œå¯åŠ¨å¸¸ç”¨åº”ç”¨ç¨‹åºï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡» Dock ä¸­çš„å›¾æ ‡æ¥å¿«é€Ÿå¯åŠ¨ã€åˆ é™¤æˆ–æ·»åŠ æ–°çš„åº”ç”¨ã€‚å‡­å€Ÿ Qt çš„è·¨å¹³å°ç‰¹æ€§ï¼ŒMacDock èƒ½åœ¨ Windowsã€Linux å’Œ macOS ä¸Šæ— ç¼è¿è¡Œã€‚\n\n\nåŠŸèƒ½ç‰¹ç‚¹\næ¡Œé¢å¸é™„æ˜¾ç¤ºï¼šMacDock å¯ä»¥çµæ´»åœ°å¸é™„åœ¨å±å¹•çš„ä¸Šä¸‹å·¦å³å››ä¸ªè¾¹ç¼˜ã€‚ç”¨æˆ·å¯ä»¥è‡ªç”±æ‹–åŠ¨ Dock åˆ°å±å¹•çš„ä»»æ„è¾¹ç¼˜ï¼ŒDock ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰çš„è¾¹ç¼˜å¹¶ç´§è´´å¸é™„ã€‚è¿™ä¸ªåŠŸèƒ½ä½¿å¾— MacDock éå¸¸çµæ´»ï¼Œé€‚åˆä¸åŒçš„æ¡Œé¢å¸ƒå±€å’Œä½¿ç”¨ä¹ æƒ¯ã€‚æ­¤å¤–ï¼Œå¸é™„åŠŸèƒ½è¿˜æ”¯æŒæ™ºèƒ½è°ƒæ•´ï¼Œç¡®ä¿ Dock ä¸ä¼šé®æŒ¡é‡è¦çš„æ¡Œé¢å†…å®¹æˆ–çª—å£ã€‚\n\næ»‘åŠ¨åŠ¨ç”»ï¼šMacDock çš„äº¤äº’ä½“éªŒä»¥æµç•…ä¸ºç›®æ ‡ã€‚æ— è®ºæ˜¯æ˜¾ç¤ºæˆ–éšè— Dockï¼Œè¿˜æ˜¯åœ¨åˆ‡æ¢åº”ç”¨ç¨‹åºæ—¶ï¼Œéƒ½ä¼šè§¦å‘å¹³æ»‘çš„æ»‘åŠ¨åŠ¨ç”»ã€‚ç”¨æˆ·åœ¨ä¸ Dock è¿›è¡Œäº¤äº’æ—¶ï¼ŒåŠ¨ç”»èƒ½å¢å¼ºè§†è§‰ä¸Šçš„æ„‰æ‚¦æ„Ÿï¼Œä½¿æ•´ä¸ªè¿‡ç¨‹æ›´ä¸ºè‡ªç„¶ã€‚é€šè¿‡ QPropertyAnimation å®ç°çš„æ»‘åŠ¨åŠ¨ç”»ï¼Œç¡®ä¿ Dock åœ¨æ‰“å¼€å’Œå…³é—­æ—¶æ²¡æœ‰å¡é¡¿æ„Ÿã€‚\n\nå¯åŠ¨åº”ç”¨ï¼šMacDock ä¸­çš„æ¯ä¸ªå›¾æ ‡ä»£è¡¨ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥ç‚¹å‡»å›¾æ ‡æ¥å¯åŠ¨ç›¸åº”çš„ç¨‹åºã€‚æ¯ä¸ªå›¾æ ‡éƒ½ä¸ç³»ç»Ÿä¸­çš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼ç›¸å…³è”ï¼Œç‚¹å‡»å›¾æ ‡ä¼šè°ƒç”¨ç³»ç»Ÿçš„ API æ¥æ‰§è¡Œå¯åŠ¨å‘½ä»¤ã€‚è¿™ä½¿å¾— MacDock æˆä¸ºäº†ä¸€ä¸ªæ–¹ä¾¿ã€ç›´è§‚çš„åº”ç”¨å¯åŠ¨å¹³å°ï¼Œå‡å°‘äº†ç”¨æˆ·æŸ¥æ‰¾å’Œæ‰“å¼€åº”ç”¨ç¨‹åºçš„æ—¶é—´ã€‚\n\nåˆ é™¤åº”ç”¨ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„äº¤äº’æ¥åˆ é™¤ Dock ä¸­çš„åº”ç”¨å›¾æ ‡ã€‚è¯¥åŠŸèƒ½è®¾è®¡éå¸¸ç›´è§‚ï¼Œç”¨æˆ·åªéœ€ç‚¹å‡»å¹¶åˆ é™¤å›¾æ ‡ï¼Œå³å¯å°†ä¸éœ€è¦çš„åº”ç”¨ä» Dock ä¸­ç§»é™¤ã€‚è€Œä¸”ï¼Œè¿™ä¸€æ“ä½œåªä¼šå½±å“ Dockï¼Œä¸ä¼šå½±å“åº”ç”¨ç¨‹åºæœ¬èº«çš„è¿è¡Œæˆ–å®‰è£…çŠ¶æ€ã€‚\n\n\n\nç•Œé¢å±•ç¤ºMacDock æä¾›äº†çµæ´»çš„å¸ƒå±€é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥åœ¨å±å¹•çš„å››ä¸ªè¾¹ç¼˜æ‘†æ”¾ Dockï¼Œé€‚åº”ä¸åŒçš„æ¡Œé¢å¸ƒå±€ä¹ æƒ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç•Œé¢å±•ç¤ºï¼š\n\nåº•éƒ¨å¸é™„æ˜¾ç¤ºï¼š\n\nå·¦ä¾§å¸é™„æ˜¾ç¤ºï¼š\n\né¡¶éƒ¨å¸é™„æ˜¾ç¤ºï¼š\n\nå³ä¾§å¸é™„æ˜¾ç¤ºï¼š\n\nåŠŸèƒ½èœå•ï¼š\n\n\n\næŠ€æœ¯å®ç°1. QtWidgets å¼€å‘MacDock é€šè¿‡ QtWidgets å®ç°äº†å¼ºå¤§çš„ç”¨æˆ·ç•Œé¢ï¼Œæä¾›è·¨å¹³å°æ”¯æŒï¼Œå¹¶åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸­ä¿æŒä¸€è‡´çš„ç”¨æˆ·ä½“éªŒã€‚QtWidgets ä½œä¸º Qt æ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨äºå¼€å‘æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œå…·å¤‡é«˜åº¦çš„çµæ´»æ€§å’Œä¸°å¯Œçš„ UI æ§ä»¶ï¼Œç¡®ä¿ç•Œé¢äº¤äº’æµç•…ä¸”åŠŸèƒ½å¼ºå¤§ã€‚\n2. å¸é™„åŠŸèƒ½å®ç°å¸é™„åŠŸèƒ½çš„å®ç°é€šè¿‡ç›‘æ§çª—å£åœ¨æ¡Œé¢ä¸Šçš„ä½ç½®ï¼Œå¹¶æ ¹æ®çª—å£ä¸å±å¹•è¾¹ç¼˜çš„è·ç¦»æ¥è°ƒæ•´çª—å£çš„ä½ç½®ã€‚åœ¨ MacDock ä¸­ï¼Œé€šè¿‡ä¸æ–­æ£€æŸ¥çª—å£çš„è¾¹ç¼˜ä½ç½®ï¼Œæ¥å†³å®šçª—å£æ˜¯å¦å¸é™„åˆ°æœ€è¿‘çš„å±å¹•è¾¹ç¼˜ã€‚è¿™é¡¹åŠŸèƒ½ä¸ä»…æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œä¹Ÿç¡®ä¿äº†åº”ç”¨çª—å£ä¸ä¼šéšæ„æ¼‚æµ®åœ¨æ¡Œé¢ä¸Šï¼Œèƒ½å¤Ÿä¸å±å¹•æ›´å¥½åœ°èåˆã€‚\n3. æ»‘åŠ¨åŠ¨ç”»æ»‘åŠ¨åŠ¨ç”»çš„å®ç°é€šè¿‡ QPropertyAnimationï¼Œè¿™æ˜¯ Qt æä¾›çš„åŠ¨ç”»ç±»ï¼Œèƒ½å¤Ÿå¯¹çª—å£å±æ€§ï¼ˆå¦‚ä½ç½®ã€å¤§å°ç­‰ï¼‰è¿›è¡ŒåŠ¨ç”»å¤„ç†ã€‚MacDock åœ¨æ˜¾ç¤ºå’Œéšè—æ—¶ï¼Œè§¦å‘äº†ä¸çª—å£ä½ç½®ç›¸å…³çš„åŠ¨ç”»ï¼Œç¡®ä¿åŠ¨ç”»çš„é¡ºæ»‘åº¦å’Œå“åº”é€Ÿåº¦ã€‚æ»‘åŠ¨åŠ¨ç”»çš„å±æ€§å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€æ±‚è¿›è¡Œå®šåˆ¶ï¼Œä¾‹å¦‚åŠ¨ç”»æŒç»­æ—¶é—´ã€åŠ¨ç”»æ›²çº¿ç­‰ï¼Œä»¥æä¾›æ›´çµæ´»çš„è§†è§‰æ•ˆæœã€‚\n4. åº”ç”¨ç®¡ç†åº”ç”¨ç®¡ç†æ˜¯ MacDock çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå€ŸåŠ©ç³»ç»Ÿ APIï¼ŒMacDock å¯ä»¥å¯åŠ¨ã€åˆ é™¤å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚é€šè¿‡ä¸ç³»ç»Ÿäº¤äº’ï¼ŒMacDock èƒ½å¤Ÿå¿«é€Ÿå¯åŠ¨æŒ‡å®šçš„åº”ç”¨ï¼Œä¸”ç”¨æˆ·å¯ä»¥é€šè¿‡æ‹–æ”¾çš„æ–¹å¼è½»æ¾æ·»åŠ æˆ–ç§»é™¤åº”ç”¨å›¾æ ‡ï¼Œæå¤§æå‡äº†æ“ä½œä¾¿æ·æ€§ã€‚\n\nä»£ç å®ç°ä¸è¯¦ç»†æ³¨é‡Š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110class MacDock : public QWidget&#123;    Q_OBJECT    // ä½¿ç”¨ Q_PROPERTY å£°æ˜å±æ€§ enterChange å’Œ moucePosï¼Œæ”¯æŒåŠ¨ç”»æ•ˆæœ    Q_PROPERTY(qreal enterChange READ enterChange WRITE setEnterChange)    Q_PROPERTY(QPoint moucePos READ getMoucePos WRITE setMoucePos)public:    // æšä¸¾ Direction è¡¨ç¤º Dock æ–¹å‘ï¼šä¸Šä¸‹å·¦å³    enum Direction &#123; Up, Down, Left, Right &#125;;    explicit MacDock(QWidget *parent = nullptr);    // æ˜¾ç¤º Dock    void show();    // åˆå§‹åŒ– Dockï¼Œè®¾ç½®é»˜è®¤å¸ƒå±€å’ŒæŒ‰é’®    void init();    // æ·»åŠ æ–°æŒ‰é’®ï¼ˆç¨‹åºå›¾æ ‡ï¼‰ï¼ŒåŒ…æ‹¬å¯åŠ¨å‘½ä»¤å’Œæç¤º    void addButton(const QString &amp;program, const QStringList &amp;arguments, const QString&amp; tip);    // åœ¨ç‰¹å®šä½ç½®æ’å…¥æ–°æŒ‰é’®    void insertButton(const int &amp;index, const QString &amp;program, const QStringList &amp;arguments, const QString&amp; tip);    // ä» Dock ä¸­ç§»é™¤æŒ‰é’®    void removeButton(const QString &amp;program);    // è·å–å’Œè®¾ç½®è¿›å…¥åŠ¨ç”»çš„è¿›åº¦ï¼ˆç”¨äºæ»‘åŠ¨åŠ¨ç”»ï¼‰    qreal enterChange() const;    void setEnterChange(const qreal &amp;enterChange);    // è·å–å’Œè®¾ç½® Dock çš„æ–¹å‘    Qt::Alignment alignment() const;    Direction direction() const;    void setDirection(const Direction &amp;direction);    // åˆ¤æ–­å½“å‰ Dock æ–¹å‘æ˜¯å¦ä¸ºæ°´å¹³    inline bool isHorizontal() &#123; return Up == m_direction || Down == m_direction;&#125;    // è·å–å’Œè®¾ç½®é¼ æ ‡ä½ç½®ï¼ˆç”¨äºæ‹–åŠ¨å’Œå¸é™„åŠŸèƒ½ï¼‰    QPoint getMoucePos() const;    void setMoucePos(const QPoint &amp;moucePos);protected:    // ç»˜åˆ¶ Dock ç•Œé¢    void paintEvent(QPaintEvent *event);    // é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œç”¨äºæ‹–åŠ¨ Dock    void mouseMoveEvent(QMouseEvent *event);    // é¼ æ ‡é‡Šæ”¾äº‹ä»¶ï¼Œç”¨äºå®Œæˆ Dock çš„ä½ç½®è°ƒæ•´    void mouseReleaseEvent(QMouseEvent *event);    // è¿›å…¥å’Œç¦»å¼€ Dock çš„äº‹ä»¶ï¼Œè§¦å‘æ˜¾ç¤ºå’Œéšè—åŠ¨ç”»    void enterEvent(QEvent *);    void leaveEvent(QEvent *);    // å®ç°æ‹–æ”¾åŠŸèƒ½    void dragEnterEvent(QDragEnterEvent *event);    void dragMoveEvent(QDragMoveEvent *event);    void dropEvent(QDropEvent *event);    void dragLeaveEvent(QDragLeaveEvent *event);    // æ¸…ç†å¸ƒå±€    void clearLayout(QLayout *pMainLayout);    // æ›´æ–°å‡ ä½•å¸ƒå±€ï¼Œè°ƒæ•´ Dock å¤§å°å’Œä½ç½®    virtual void updateGeometry() = 0;    // æ›´æ–° Dock å¸ƒå±€    virtual void updateLayout() = 0;    // è·å– Dock åŒºåŸŸï¼Œç”¨äºå¸é™„æ˜¾ç¤º    virtual QRect getDockArea() = 0;    // å¯åŠ¨åŠ¨ç”»ï¼ˆå¯æ‰©å±•ä¸ºè‡ªå®šä¹‰åŠ¨ç”»ï¼‰    virtual void startUpAnimation() &#123;&#125;protected slots:    // æ§½å‡½æ•°ï¼šæ·»åŠ ã€ç§»é™¤ã€æ’å…¥å’Œæ›¿æ¢æŒ‰é’®    void add();    void remove();    void insert(int index, const QString &amp;program);    void replace();    void position(Qt::Alignment alignment);protected:    QList&lt;AniButton*&gt; m_listBtns;              // æŒ‰é’®åˆ—è¡¨    QList&lt;AniButtonInfo&gt; m_listBtnsInfo;       // æŒ‰é’®ä¿¡æ¯åˆ—è¡¨    QMap&lt;int, QLabel*&gt; m_mapSpace;             // ç©ºç™½åŒºåŸŸæ˜ å°„    bool m_bFirstEnter;                        // æ ‡è®°æ˜¯å¦ä¸ºé¦–æ¬¡è¿›å…¥    QPoint m_moucePos;                         // å½“å‰é¼ æ ‡ä½ç½®    qreal m_enterChange;                       // è¿›å…¥åŠ¨ç”»è¿›åº¦    QPropertyAnimation *m_enterAnimation;      // åŠ¨ç”»å±æ€§ç±»    Direction m_direction;                     // Dock çš„æ–¹å‘    bool m_init;                               // æ˜¯å¦å·²ç»åˆå§‹åŒ–    QParallelAnimationGroup *m_startAnimationGroup; // å¯åŠ¨åŠ¨ç”»ç»„    QPropertyAnimation *m_startAnimation;      // å¯åŠ¨åŠ¨ç”»    bool m_inAdding;                           // æ ‡è®°æ˜¯å¦å¤„äºæ·»åŠ çŠ¶æ€    QBoxLayout *m_layoutDock;                  // Dock å¸ƒå±€    int m_indexDrag;                           // æ‹–åŠ¨çš„æŒ‰é’®ç´¢å¼•&#125;;\n\n\næ€»ç»“MacDock æ˜¯ä¸€æ¬¾åŸºäº QtWidget çš„è½»é‡çº§æ¡Œé¢å·¥å…·æ¡ï¼Œå…·å¤‡å¸é™„æ˜¾ç¤ºã€å¹³æ»‘åŠ¨ç”»ã€åº”ç”¨ç¨‹åºç®¡ç†ç­‰åŠŸèƒ½ã€‚å…¶è®¾è®¡ç®€å•æ˜“ç”¨ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªå®šä¹‰åº”ç”¨ç¨‹åºå›¾æ ‡å’Œå¸ƒå±€ï¼ŒåŒæ—¶é€šè¿‡æµç•…çš„äº¤äº’åŠ¨ç”»æå‡æ•´ä½“ç”¨æˆ·ä½“éªŒã€‚é€šè¿‡ Qt çš„å¼ºå¤§åŠŸèƒ½å’Œè·¨å¹³å°æ”¯æŒï¼ŒMacDock å¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šæä¾›ä¸€è‡´çš„ä½“éªŒï¼Œé€‚ç”¨äºå„ç§æ¡Œé¢ç¯å¢ƒã€‚\n","slug":"mackdockä»‹ç»","date":"2024-11-11T07:15:45.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"63c8a92f74a53e2268681abcf94a416e","title":"Qt WebAssembly åˆä½“éªŒ","content":"æ ‡é¢˜ï¼šQt WebAssembly åˆä½“éªŒï¼šå¼€å¯Webå¼€å‘æ–°çºªå…ƒ\nåœ¨è¿‘å¹´æ¥ï¼ŒWebå¼€å‘é¢†åŸŸç»å†äº†å·¨å¤§çš„å˜é©ã€‚éšç€WebAssemblyæŠ€æœ¯çš„å‡ºç°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»¥å‰æ‰€æœªæœ‰çš„æ–¹å¼å°†é«˜æ€§èƒ½åº”ç”¨ç¨‹åºå¸¦åˆ°Webæµè§ˆå™¨ä¸­ã€‚è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒQt WebAssemblyå‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘å¯¹Qt WebAssemblyçš„åˆä½“éªŒï¼Œå¹¶æ¢è®¨å®ƒå¦‚ä½•æ”¹å˜Webå¼€å‘çš„æ¸¸æˆè§„åˆ™ã€‚\nä»€ä¹ˆæ˜¯Qt WebAssemblyï¼ŸQt WebAssemblyæ˜¯ä¸€ä¸ªåŸºäºQtæ¡†æ¶å’ŒWebAssemblyæŠ€æœ¯çš„å¼€å‘å·¥å…·åŒ…ã€‚å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ç†Ÿæ‚‰çš„C++è¯­è¨€å’ŒQtæ¡†æ¶ç¼–å†™Webåº”ç”¨ç¨‹åºï¼Œç„¶åå°†å…¶ç¼–è¯‘æˆWebAssemblyå­—èŠ‚ç ï¼Œç›´æ¥åœ¨Webæµè§ˆå™¨ä¸­è¿è¡Œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Qtçš„å¼ºå¤§åŠŸèƒ½å’Œé«˜æ•ˆæ€§èƒ½ï¼Œå¼€å‘å‡ºä¸åŸç”Ÿåº”ç”¨åª²ç¾çš„Webåº”ç”¨ã€‚\nå¼€å§‹Qt WebAssemblyä¹‹æ—…ä¸ºäº†ä½“éªŒQt WebAssemblyçš„é­…åŠ›ï¼Œæˆ‘é¦–å…ˆå®‰è£…äº†Emscriptenå’ŒQt for WebAssemblyçš„å¼€å‘ç¯å¢ƒã€‚å®‰è£…è¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œåªéœ€æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„æŒ‡å¼•è¿›è¡Œæ“ä½œå³å¯ã€‚ä¸€æ—¦ç¯å¢ƒå‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Qt Creatoræˆ–å‘½ä»¤è¡Œå·¥å…·å¼€å§‹ç¼–å†™ä»£ç ã€‚\nç¼–å†™Qt WebAssemblyåº”ç”¨æˆ‘é€‰æ‹©äº†ç¼–å†™ä¸€ä¸ªç®€å•çš„å›¾å½¢åº”ç”¨ç¨‹åºä½œä¸ºåˆä½“éªŒçš„é¡¹ç›®ã€‚é€šè¿‡ä½¿ç”¨Qtçš„ä¸°å¯Œæ§ä»¶å’Œå¸ƒå±€ç®¡ç†å™¨ï¼Œæˆ‘è½»æ¾åœ°åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·ç•Œé¢ã€‚åœ¨ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°Qt WebAssemblyçš„å¼€å‘ä½“éªŒä¸åŸç”ŸQtå¼€å‘éå¸¸ç›¸ä¼¼ï¼Œè¿™ä½¿å¾—æˆ‘èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹å¹¶ä¸“æ³¨äºå®ç°åŠŸèƒ½ã€‚\nç¼–è¯‘ä¸éƒ¨ç½²ç¼–å†™å®Œä»£ç åï¼Œæˆ‘ä½¿ç”¨Emscriptenå·¥å…·é“¾å°†åº”ç”¨ç¨‹åºç¼–è¯‘æˆWebAssemblyå­—èŠ‚ç ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œä½†ä¸€æ—¦å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†ç”Ÿæˆçš„æ–‡ä»¶éƒ¨ç½²åˆ°WebæœåŠ¡å™¨ä¸Šã€‚åœ¨æµè§ˆå™¨ä¸­è®¿é—®åº”ç”¨ç¨‹åºæ—¶ï¼ŒQt WebAssemblyè¿è¡Œæ—¶å°†åŠ è½½å¹¶æ‰§è¡Œç¼–è¯‘åçš„å­—èŠ‚ç ï¼Œå¸¦æ¥æµç•…ä¸”é«˜æ€§èƒ½çš„ç”¨æˆ·ä½“éªŒã€‚\nåˆä½“éªŒæ€»ç»“é€šè¿‡å¯¹Qt WebAssemblyçš„åˆä½“éªŒï¼Œæˆ‘æ·±åˆ»æ„Ÿå—åˆ°äº†å®ƒå¯¹Webå¼€å‘çš„å·¨å¤§æ½œåŠ›ã€‚å®ƒç»“åˆäº†Qtæ¡†æ¶çš„å¼ºå¤§åŠŸèƒ½å’ŒWebAssemblyçš„é«˜æ€§èƒ½ç‰¹æ€§ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä»¥å…¨æ–°çš„æ–¹å¼å¼€å‘Webåº”ç”¨ç¨‹åºã€‚è¿™ç§æŠ€æœ¯çš„å‡ºç°ï¼Œä¸ä»…é™ä½äº†Webå¼€å‘çš„é—¨æ§›ï¼Œè¿˜ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿå¼€å‘å‡ºæ›´é«˜æ€§èƒ½å’Œæ›´ä¸°å¯Œçš„åº”ç”¨ç¨‹åºã€‚\nç„¶è€Œï¼Œä½œä¸ºä¸€é¡¹æ–°æŠ€æœ¯ï¼ŒQt WebAssemblyç›®å‰ä»å¤„äºä¸æ–­å‘å±•å’Œå®Œå–„çš„é˜¶æ®µã€‚æœªæ¥ï¼Œéšç€æ›´å¤šçš„å¼€å‘è€…å’Œå…¬å¸çš„åŠ å…¥ï¼Œæˆ‘ä»¬æœ‰ç†ç”±ç›¸ä¿¡å®ƒå°†ä¸ºWebå¼€å‘é¢†åŸŸå¸¦æ¥æ›´å¤šçš„åˆ›æ–°å’Œçªç ´ã€‚å¯¹äºæˆ‘ä»¬è¿™äº›çƒ­çˆ±æŠ€æœ¯çš„äººæ¥è¯´ï¼Œè¿™æ— ç–‘æ˜¯ä¸€ä¸ªä»¤äººæœŸå¾…çš„æ—¶åˆ»ã€‚\nç¤ºä¾‹é¡¹ç›®ä½ å¯ä»¥è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ï¼šç¤ºä¾‹demo\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qt WebAssembly åˆä½“éªŒ","date":"2023-10-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"78d706026c7ad286c335846453427351","title":"FFmpegåˆä½“éªŒ","content":"\n","slug":"FFmpeg/FFmpegåˆä½“éªŒ","date":"2023-09-20T05:35:00.000Z","categories_index":"FFmpeg","tags_index":"C++,FFmpeg","author_index":"é˜¿æœ¨å¤§å”"},{"id":"85d75116aefe90c7e26f6d4e2c2f9e5c","title":"Qt UIç»„ä»¶åº“","content":"HUIğŸ“šç®€ä»‹æœ¬é¡¹ç›®æ—¨åœ¨åˆ©ç”¨Qtå®ç°å¤šä¸ªåŸºç¡€UIæ§ä»¶ï¼Œç¡®ä¿å®ƒä»¬å…·æœ‰ç»Ÿä¸€çš„é£æ ¼ï¼Œå¹¶é€šè¿‡æ ·å¼ç»Ÿä¸€ç®¡ç†ï¼Œä»¥æå‡ç”¨æˆ·ç•Œé¢çš„ä¸€è‡´æ€§å’Œç¾è§‚åº¦ã€‚Qtæ¡†æ¶æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”è·¨å¹³å°çš„å·¥å…·é›†ï¼Œå¯ä»¥è½»æ¾æ„å»ºå„ç§ç•Œé¢å…ƒç´ å’Œäº¤äº’æ•ˆæœã€‚é€šè¿‡æ­¤é¡¹ç›®ï¼Œæˆ‘ä»¬å°†å¼€å‘å‡ºæ˜“äºä½¿ç”¨ä¸”é«˜åº¦å¯å®šåˆ¶çš„UIæ§ä»¶ï¼ŒåŒ…æ‹¬æŒ‰é’®ã€æ–‡æœ¬æ¡†ã€ä¸‹æ‹‰æ¡†ç­‰ï¼Œç¡®ä¿å®ƒä»¬åœ¨ä¸åŒçš„åº”ç”¨åœºæ™¯ä¸­éƒ½èƒ½è¡¨ç°å‡ºä¸€è‡´çš„å¤–è§‚å’Œè¡Œä¸ºã€‚åŒæ—¶ï¼Œé€šè¿‡æ ·å¼ç»Ÿä¸€ç®¡ç†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ çµæ´»åœ°å¯¹UIæ§ä»¶è¿›è¡Œä¸»é¢˜åˆ‡æ¢å’Œæ ·å¼è°ƒæ•´ï¼Œä»¥é€‚åº”ä¸åŒçš„éœ€æ±‚å’Œè®¾è®¡è¦æ±‚ã€‚è¿™å°†å¤§å¤§ç®€åŒ–å¼€å‘æµç¨‹ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼ŒåŒæ—¶ä¸ºç”¨æˆ·æä¾›æ›´åŠ ä¸€è‡´å’Œä¼˜åŒ–çš„ç•Œé¢ä½“éªŒã€‚\nè¯¥é¡¹ç›®çš„ç›®æ ‡ä¸ä»…ä»…æ˜¯å®ç°åŸºç¡€UIæ§ä»¶çš„ç»Ÿä¸€é£æ ¼ï¼Œè¿˜åŒ…æ‹¬æä¾›ä¸°å¯Œçš„åŠŸèƒ½å’Œäº¤äº’æ•ˆæœï¼Œä»¥å¢å¼ºç”¨æˆ·ç•Œé¢çš„å¸å¼•åŠ›å’Œå¯ç”¨æ€§ã€‚ä½¿ç”¨Qtæ¡†æ¶çš„ä¼˜åŠ¿åœ¨äºå…¶è·¨å¹³å°ç‰¹æ€§ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å°†åº”ç”¨ç¨‹åºç§»æ¤åˆ°ä¸åŒçš„æ“ä½œç³»ç»Ÿè®¾è®¡å’Œå¼€å‘æŒ‰é’®æ ·å¼ï¼Œæ–‡æœ¬æ¡†äº¤äº’ï¼Œä¸‹æ‹‰æ¡†é€‰ä¿è¿™äº›æ§ä»¶åœ¨å„ç§åœºæ™¯ä¸­éƒ½èƒ½å‘ˆç°å‡ºä¸€è‡´çš„å¤–è§‚å’Œè¡Œä¸ºï¼Œå¹¶æ»¡è¶³ç”¨æˆ·çš„æœŸæœ›å’Œéœ€æ±‚ã€‚\næ­¤å¤–ï¼Œé€šè¿‡æ ·å¼ç»Ÿä¸€ç®¡ç†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç®€ä¾¿åœ°ä¿®æ”¹å’Œè°ƒæ•´UIæ§ä»¶çš„å¤–è§‚ï¼Œæ— éœ€é€ä¸ªæ“ä½œæ¯ä¸ªæ§ä»¶ï¼Œä»è€Œå¤§å¤§èŠ‚çœäº†å¼€å‘æ—¶é—´å’Œç²¾åŠ›ã€‚æˆ‘ä»¬å°†åˆ¶å®šä¸€å¥—æ¸…æ™°çš„æ ·å¼è§„èŒƒå’Œç»´æŠ¤æ–¹æ³•ï¼Œä½¿å¾—å¼€å‘å›¢é˜Ÿå¯ä»¥è½»æ¾åœ°ç®¡ç†å’Œæ›´æ–°UIé£æ ¼ï¼ŒåŒæ—¶ç¡®ä¿ä¸æ•´ä½“è®¾è®¡çš„ä¸€è‡´æ€§ã€‚\nè¿™ä¸ªé¡¹ç›®çš„ç»“æœå°†æ„å‘³ç€æ›´é«˜æ•ˆçš„å¼€å‘æµç¨‹å’Œæ›´çŸ­çš„ä¸Šçº¿æ—¶é—´ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œè€Œæ— éœ€èŠ±è´¹è¿‡å¤šæ—¶é—´å¤„ç†UIæ–¹é¢çš„é—®é¢˜ã€‚å¯¹äºæœ€ç»ˆç”¨æˆ·æ¥è¯´ï¼Œä»–ä»¬å°†è·å¾—ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ç¾è§‚ä¸”æ˜“äºä½¿ç”¨çš„ç•Œé¢ï¼Œæ— è®ºä»–ä»¬æ˜¯åœ¨æ¡Œé¢ã€ç§»åŠ¨è®¾å¤‡è¿˜æ˜¯å…¶ä»–å¹³å°ä¸Šä½¿ç”¨åº”ç”¨ç¨‹åºï¼Œéƒ½èƒ½äº«å—åˆ°ä¸€è‡´å’Œä¼˜åŒ–çš„ç”¨æˆ·ä½“éªŒã€‚\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šéƒ½æ”¯æŒ\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾æŒ‰é’®\nè¾“å…¥æ¡†\nä¸‹æ‹‰æ¡†\nè¡¨æ ¼\nèœå•\næ ‡å‡†å¯¹è¯æ¡†\næç¤ºå¯¹è¯æ¡†\nç¡®è®¤å¯¹è¯æ¡†\nç­‰å¾…æ¡†\nä¾§è¾¹æŠ½å±‰\né¡¶éƒ¨æç¤º\næ»‘å—è¿›åº¦æ¡\nè½®æ’­å›¾\nè¯„åˆ†æ§ä»¶q\næ°”æ³¡ç¡®è®¤æ¡†\né€‰æ‹©æ¡†\næ•°å­—è¾“å…¥æ¡†\nå…¨å±€é€šçŸ¥\næ—¥æœŸé€‰æ‹©å™¨\næ°´æ³¢è¿›åº¦æ¡\næŠ˜å é¢æ¿\næ‚¬æµ®æŒ‰é’®\nå¯¼èˆªæ \né€šç”¨ä¸»çª—å£\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/UIç»„ä»¶åº“","date":"2023-06-20T08:40:04.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"4dc19acbc442d3c601963ca4bb14ef60","title":"QPainterï¼šQtå›¾å½¢æ¸²æŸ“å¼•æ“","content":"QPainterï¼šQtå›¾å½¢æ¸²æŸ“å¼•æ“Qt æ˜¯ä¸€ç§è·¨å¹³å°çš„ C++ åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œæ‹¥æœ‰ä¸°å¯Œè€Œå¼ºå¤§çš„ç»˜å›¾åŠŸèƒ½ã€‚åœ¨ Qt ä¸­ï¼Œç”¨äºç»˜åˆ¶å›¾å½¢å’Œæ–‡æœ¬çš„ä¸»è¦ç±»æ˜¯ QPainterã€‚QPainter æ˜¯ä¸€ç§åŸºäºæ‰«æçº¿çš„å›¾å½¢æ¸²æŸ“å¼•æ“ï¼Œå¯ç»˜åˆ¶çº¿æ¡ã€å¤šè¾¹å½¢ã€å›¾åƒå’Œæ–‡å­—ç­‰ã€‚\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ QPainter ç±»è¿›è¡Œç»˜å›¾ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæ‚¨éœ€è¦äº†è§£ä»¥ä¸‹å†…å®¹ï¼š\n\nC++ çš„åŸºæœ¬è¯­æ³•å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹\nQt çš„åŸºæœ¬ç»„ä»¶å’Œ API\nQt ä¿¡å·å’Œçš„æœºåˆ¶\n\nQPainter ç±»æ¦‚è¿°QPainter æ˜¯ Qt çš„æ ¸å¿ƒç»˜å›¾ç±»ä¹‹ä¸€ï¼Œæä¾›äº†å„ç§æ–¹æ³•æ¥ç”»å‡ºå„ç§å›¾å½¢å’Œæ–‡æœ¬ã€‚QPainter ç±»é€šè¿‡ä¸ç‰¹å®šè®¾å¤‡çš„ QPainterDevice å¯¹è±¡äº¤äº’ï¼Œå°†äºŒç»´å›¾å½¢å‘ˆç°åˆ°çª—å£ä¹‹ä¸Šã€‚\nQPainter å¯ä»¥ä¸ QWidget æˆ–å…¶ä»–æ˜¾ç¤ºè®¾å¤‡ï¼ˆå¦‚ QImage æˆ– QPrinterï¼‰é…åˆä½¿ç”¨ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨å±å¹•ä¸Šè½»æ¾åœ°å‘ˆç°å¤æ‚çš„å‡ ä½•å›¾å½¢å’Œæ–‡æœ¬ã€‚\nQPainter çš„é«˜æ•ˆæ€§å¯èƒ½ä¼šäº§ç”Ÿæ··æ·†ï¼Œå°¤å…¶æ˜¯å¯¹æ–°æ‰‹ï¼Œä½†å®é™…ä¸Š QPainter ä½¿ç”¨äº†ä¼˜åŒ–çš„ç®—æ³•ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ¸²æŸ“å¤§éƒ¨åˆ†ç±»å‹çš„å›¾å½¢å’Œæ–‡æœ¬æ•°æ®ã€‚æ­¤å¤–ï¼ŒQPainter è¿˜å®ç°äº†åŒç¼“å†²æŠ€æœ¯ã€‚\nQPainter è¿˜æä¾›äº†ä¸°å¯Œçš„ API æ¥è½»æ¾å®ç°ä»¥ä¸‹æ“ä½œï¼š\n\nç»˜åˆ¶åŸºæœ¬çš„å‡ ä½•å½¢çŠ¶ï¼Œå¦‚çº¿æ®µï¼Œå¤šè¾¹å½¢å’Œæ¤­åœ†ã€‚\nå¡«å……çŸ©å½¢ï¼Œå¤šè¾¹å½¢å’Œå¤æ‚è·¯å¾„ã€‚\nç»˜åˆ¶æ–‡æœ¬å¹¶æ ¹æ®éœ€è¦è¿›è¡Œå¸ƒå±€ã€‚\nç»˜åˆ¶å›¾åƒå’Œåƒç´ æ•°æ®ã€‚\nå˜æ¢å’Œç§»åŠ¨ç»˜å›¾å¯¹è±¡ã€‚\n\nè®©æˆ‘ä»¬å¼€å§‹å­¦ä¹  QPainter çš„ä½¿ç”¨å§ï¼\nQPainter ç»˜ç”»è®¾å¤‡QPainter ä¸ä¸åŒçš„ QPainterDevice ç±»äº¤äº’ï¼ˆä¾‹å¦‚çª—å£ã€pixmapã€printer ç­‰ï¼‰ï¼Œé€šè¿‡ QPainterDevice çš„ begin() å’Œ end() æ–¹æ³•ä»¥åŠ QPaintDeviceMetrics æ¥æ§åˆ¶ç»˜ç”»è®¾å¤‡ã€‚\nåœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å½“ç”Ÿæˆ QImage ï¼ˆå›¾åƒï¼‰å¹¶å°†å…¶ç”¨ä½œ QPainterDevice æ—¶ï¼Œå°±ä½¿ç”¨ QPainter åœ¨å…¶ä¸Šç»˜åˆ¶å›¾ç‰‡ï¼š\n1234567891011121314QImage image(400, 400, QImage::Format_RGB32); QPainter painter(&amp;image); // åˆ›å»ºä¸€ä¸ªç»˜åˆ¶å™¨å¹¶å°†å®ƒä¸ Image å…³è”èµ·æ¥ painter.fillRect(image.rect(), Qt::white); // å¡«å……çŸ©å½¢èƒŒæ™¯ä¸ºç™½è‰² QPen pen(Qt::green, 4, Qt::DashLine, Qt::RoundCap, Qt::RoundJoin);painter.setPen(pen); painter.drawLine(50, 250, 200, 100);  // ç»˜åˆ¶ç›´çº¿painter.drawRect(150, 150, 50, 50);  // ç»˜åˆ¶çŸ©å½¢painter.drawEllipse(250, 50, 100, 150);  // ç»˜åˆ¶æ¤­åœ† painter.end();    // å’Œä¸Šé¢ä¸€æ ·ï¼Œå¿…é¡»è¦è°ƒç”¨ end() ç»“æŸç»˜ç”»\n\nå°† QImage ä½œä¸º QPainterDevice å¯ä»¥å®ç°ç¦»å±æ¸²æŸ“ï¼Œä»¥ä¾¿åœ¨çª—å£æˆ–æ‰“å°æœºå¤–ç»˜å›¾ï¼Œå¹¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°† QImage å†™å…¥æ–‡ä»¶çš„ä¾‹å­ï¼š\n1image.save(&quot;example.jpg&quot;, &quot;JPG&quot;);\n\né™¤ QImage å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ QWidgetï¼ˆæˆ–æ´¾ç”Ÿç±»ï¼‰ä½œä¸º QPainterDeviceï¼Œè¿™ç§æƒ…å†µä¸‹ QPainter å°†è‡ªåŠ¨åœ¨çª—å£ä¸Šç»˜åˆ¶ã€‚è¯·æ³¨æ„ï¼Œåœ¨ç»˜åˆ¶ QWidget ä¸Šçš„å†…å®¹ä¹‹å‰ï¼Œæ‚¨éœ€è¦é¦–å…ˆåœ¨QWidget ä¸Šé€‰æ‹© QPainterã€‚\nä»¥ QWidget ä½œä¸º QPainterDevice çš„ç¤ºä¾‹ä»£ç ï¼š\n123456789101112void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);     painter.fillRect(rect(), Qt::white);     QPen pen(Qt::blue, 3);    painter.setPen(pen);     painter.drawLine(0, 0,(), height());    painter.drawLine(width(), 0, 0, height());&#125;\n\nç»˜åˆ¶å‡ ä½•å½¢çŠ¶QPainter æä¾›äº†å„ç§æ–¹æ³•æ¥ç»˜åˆ¶åŸºæœ¬çš„å‡ ä½•å½¢çŠ¶ï¼Œä¾‹å¦‚çº¿æ®µã€çŸ©å½¢ã€åœ†å’Œæ¤­åœ†ã€‚å½“ä½¿ç”¨ QPainter æ—¶ï¼Œé¦–å…ˆéœ€è¦è®¾ç½®å›¾å½¢å±æ€§ï¼Œåˆ·å’Œé¢œè‰²ã€‚\nç”»ç¬”å’Œç”»åˆ·å°½ç®¡ä½ å¯ä»¥ä¸ºæ¯ä¸ªå‡ ä½•å½¢çŠ¶è®¾ç½®è‡ªå·±çš„é¢œè‰²å’Œç¬”åˆ·ï¼Œä½†å¾ˆå¤šæ—¶å€™ï¼Œè¿™äº›å±æ€§ä¼šé€‚ç”¨äºåœ¨ QPainter ä¸Šç»˜åˆ¶çš„æ‰€æœ‰å‡ ä½•å½¢çŠ¶ã€‚QPainter ä½¿ç”¨ QPen å’Œ QBrush ç±»æ¥ç®¡ç†è¿™äº›å±æ€§ã€‚\nQPen å®šä¹‰åˆ’ï¼Œå¯ä»¥å®šä¹‰é¢œè‰²ã€å®½åº¦ã€æ ·å¼ã€çº¿ç«¯ç‚¹ä»¥åŠè§’çš„ç±»å‹ã€‚åˆ›å»º QPen å¯¹è±¡æ—¶ï¼Œéœ€è¦æŒ‡å®šé¢œè‰²å’Œçº¿å®½ï¼Œå…¶ä»–é€‰é¡¹ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„å±æ€§æ¥è°ƒæ•´ã€‚\nQBrush å®šä¹‰äº†ä¸€ä¸ªå›¾æ¡ˆæˆ–é¢œè‰²å¡«å……ï¼Œå¯ä»¥å®šä¹‰é¢œè‰²ã€æ¸å˜å’Œçº¹ç†ç­‰ã€‚åœ¨åˆ›å»º QBrush å¯¹è±¡æ—¶ï¼Œå¯ä»¥ä¸ºå…¶ä¼ é€’ QColor å¯¹è±¡ï¼ˆå¦‚æœè¦å¡«å……ä¸€ç§é¢œè‰²ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ QGradient ï¼ˆå¦‚ QLinearGradient æˆ– QRadialGradientï¼‰æ¥åˆ›å»ºæ¸å˜æ•ˆæœã€‚\nç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç»˜åˆ¶å‡ ä½•å½¢çŠ¶ã€‚ä¸‹é¢æ˜¯ç»˜åˆ¶ä¸‰è§’å½¢å’Œæ¢¯å½¢çš„ä¾‹å­ï¼š\n1234567891011121314151617181920212223242526void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);     QLinearGradient gradient(0, 0, width(), height());    // æ¸å˜è‰²å¡«å……    gradient.setColorAt(0, Qt::red);    gradient.setColorAt(0.5, Qt::green);    gradient.setColorAt(1, Qt::blue);    QBrush brush(gradient);     // å¸¦æœ‰æ¸å˜è‰²çš„ç”»åˆ·    painter.setBrush(brush);   // è®¾ç½®ç”»åˆ·    painter.setPen(Qt::black); // è®¾ç½®é“…ç¬”é¢œè‰²     // ç»˜åˆ¶ä¸‰è§’å½¢    QPolygonF triangle;    triangle &lt;&lt; QPointF(0, 0) &lt;&lt; QPointF(width(), 0) &lt;&lt; QPointF(0, height());    painter.drawPolygon(triangle);     // ç»˜åˆ¶æ¢¯å½¢    QPolygonF trapezoid;    trapezoid &lt;&lt; QPointF(0, 0) &lt;&lt; QPointF(width(), 0) &lt;&lt; QPointF(width() - 50, height()) &lt;&lt; QPointF(50, height());    painter.drawPolygon(trapezoid);&#125;\n\nåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ QPolygonF æ¥å®šä¹‰ä¸‰è§’å½¢å’Œæ¢¯å½¢çš„é¡¶ç‚¹ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å…¶ä¼ é€’åˆ° QPainter çš„ drawPolygon å‡½æ•°ä¸­è¿›è¡Œç»˜åˆ¶ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®šä¹‰ QPolygonF å¯¹è±¡æ—¶ï¼Œéœ€è¦æŒ‡å®šæ‰€æœ‰çš„ç‚¹åæ ‡ã€‚è¿™äº›åæ ‡æ˜¯ä»¥å±€éƒ¨åæ ‡ç³»ä¸ºå‚è€ƒçš„ã€‚\nçŸ©å½¢å’Œåœ†å½¢QPainter è¿˜æä¾›äº†å…¶ä»–ä¸€äº›å¸¸è§å›¾å½¢çš„ç»˜åˆ¶æ–¹æ³•ï¼Œå¦‚çŸ©å½¢å’Œåœ†å½¢ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®ƒä½¿ç”¨ QPen å’Œ QBrush åˆ†åˆ«è®¾ç½®çŸ©å½¢å’Œåœ†å½¢çš„å¤–è§‚ï¼š\n123456789101112131415161718void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);     QPen pen(Qt::black, 2, Qt::SolidLine);   // å®šä¹‰é“…ç¬”    painter.setPen(pen);                     // è®¾ç½®é“…ç¬”     Q::blue, Qt::Dense4Pattern);// å®šä¹‰ç”»åˆ·    painter.setBrush(brush);                 // è®¾ç½®ç”»åˆ·     // ç»˜åˆ¶çŸ©å½¢    QRectF rect(10, 10, 100, 50);           // å®šä¹‰çŸ©å½¢åŒºåŸŸ    painter.drawRect(rect);                 // ç»˜åˆ¶çŸ©å½¢     // ç»˜åˆ¶åœ†    QRectF circle(150, 10, 50, 50);          // å®šä¹‰åœ†å½¢çš„å¤–æ¥çŸ©å½¢    painter.drawEllipse(circle);             // ç»˜åˆ¶åœ†å½¢&#125;\n\nåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ QRectF æ¥æŒ‡å®šçŸ©å½¢å’Œåœ†å½¢çš„ä½ç½®å’Œå°ºå¯¸ã€‚æˆ‘ä»¬è¿˜å°† QPenã€QBrush å’Œ QRectF å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ QPainter ç±»çš„ç»˜åˆ¶å‡½æ•°ã€‚\nç»˜åˆ¶æ–‡æœ¬QPainter è¿˜æä¾›äº†ä¸€ç§ç»˜åˆ¶æ–‡æœ¬çš„æ–¹æ³•ã€‚ä½¿ç”¨ drawText å‡½æ•°æ¥å®Œæˆæ­¤æ“ä½œã€‚æ‚¨éœ€è¦æŒ‡å®šå­—ç¬¦ä¸²ï¼Œä»¥åŠä½äºå­—ç¬¦ä¸²åº•éƒ¨æ°´å¹³å¯¹é½å’Œå‚ç›´å¯¹é½çš„åæ ‡ã€‚å¦‚æœéœ€è¦æ›´å¤§çš„æ§åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ drawStaticTextã€‚\nä¸‹é¢çš„ä»£ç æ¼”ç¤ºå¦‚ä½•å‘çª—å£ä¸­ç»˜åˆ¶æ–‡æœ¬ï¼š\n1234567891011121314void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);     QFont font;    font.setPointSize(24);    font.setBold(true);    painter.setFont(font);     QString text = &quot;Hello, world!&quot;;    QRect rect = painter.boundingRect(0, 0, width(), height(), Qt::AlignCenter, text);     painter.drawText(rect, text, Qt::AlignCenter);&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»º QFont å¯¹è±¡æ¥è®¾ç½®å­—ä½“çš„å¤§å°å’Œç²—ç»†ç¨‹åº¦ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è·å–å…¶å¼•èµ·çš„çŸ©å½¢å¯¹è±¡ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ QRect å’Œ QString å‚æ•°è°ƒç”¨ drawText å‡½æ•°æ¥åœ¨çª—å£ä¸Šæ˜¾ç¤ºå­—ç¬¦ä¸²ã€‚\nå¦‚æœæ‚¨æ²¡æœ‰æŒ‡å®šå¯¹é½æ–¹å¼ï¼Œåˆ™æ–‡å­—å°†ä½äº Painter æŒ‡å®šçš„çŸ©å½¢å·¦ä¸Šè§’ã€‚\næ€§èƒ½QPainter æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç»˜å›¾å·¥å…·ï¼Œå¯ä»¥ç”¨äºå‘ˆç°ä»»æ„å½¢çŠ¶ã€æ–‡æœ¬å’Œå›¾åƒã€‚ç”±äºå…¶çµæ´»æ€§å’Œé«˜åº¦ä¼˜åŒ–çš„ç®—æ³•ï¼Œå®ƒä¹Ÿè¢«å¹¿æ³›ç”¨äºç»˜åˆ¶å®æ—¶å›¾å½¢ã€‚\nä½†æ˜¯ï¼Œç”±äºç»˜åˆ¶å¤æ‚å‡ ä½•å½¢çŠ¶å’Œä½¿ç”¨å¤§é‡çš„çº¹ç†æˆ–ç½‘æ ¼ä¼šå½±å“ç»˜åˆ¶æ€§èƒ½ï¼ŒQPainter åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å¹¶ä¸æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸“é—¨çš„å›¾å½¢åº“ï¼Œæ¯”å¦‚ OpenGL æˆ– Vulkanã€‚\nå¦å¤–ï¼Œä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œå»ºè®®æ‚¨åœ¨ä½¿ç”¨ QPainter æ—¶éµå¾ªä»¥ä¸‹å‡†åˆ™ï¼š\n\né¿å…æ¯æ¬¡è°ƒç”¨ paintEvent å‡½æ•°æ—¶é‡æ–°åˆ›å»º QPen å’Œ QBrush å¯¹è±¡ã€‚å°½å¯èƒ½å¤ç”¨å…ˆå‰åˆ›å»ºçš„å¯¹è±¡ã€‚\nä½¿ç”¨ QPixmap è€Œä¸æ˜¯ QImageï¼Œåœ¨çª—å£ä¸­ç»˜åˆ¶ç®€å•çš„å›¾å½¢æ—¶ã€‚å› ä¸º QPixmap é€šå¸¸æ¯” QImage æ›´é«˜æ•ˆåœ°å‘ˆç°åˆ°å±å¹•ä¸Šã€‚\né¿å…åœ¨ paintEvent ä¸­è¿›è¡Œè¿‡å¤šçš„è®¡ç®—ï¼ˆä¾‹å¦‚è®¡ç®—å¤šè¾¹å½¢è·¯å¾„æˆ–ç”Ÿæˆæ¸å˜ï¼‰ã€‚å¦‚æœå¿…é¡»è¦è¿›è¡Œå¤æ‚çš„è®¡ç®—ï¼Œè¯·å°†é¢„å…ˆè®¡ç®—çš„ç»“æœå­˜å‚¨åœ¨æˆå‘˜å˜é‡æˆ–å…¨å±€å˜é‡ä¸­ï¼Œå¹¶åœ¨éœ€è¦æ—¶é‡ç”¨å®ƒä»¬ã€‚\n\nåœ¨ Qt ä¸­ï¼Œä½¿ç”¨ QPainter ç»˜å›¾æ˜¯éå¸¸å¸¸è§çš„æ“ä½œã€‚å¦‚æœæ‚¨äº†è§£ QPainter çš„ API å¹¶æŒ‰ç…§æœ€ä½³å®è·µä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆå°†å¯ä»¥è½»æ¾åœ°åˆ›å»ºå¤æ‚çš„å›¾å½¢å’Œæ–‡æœ¬å¸ƒå±€ï¼Œå¹¶ä»¥é«˜æ•ˆçš„æ–¹å¼å‘ˆç°åˆ°å±å¹•ä¸Šã€‚## QPainter ä¸ Qt ç»„ä»¶\nåœ¨ Qt åº”ç”¨ç¨‹åºä¸­ï¼Œé™¤äº†ç›´æ¥ç»˜åˆ¶åˆ°çª—å£ä¸Šä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥å°† QPainter ç”¨äº Qt ç»„ä»¶çš„ç»˜åˆ¶ï¼ˆä¾‹å¦‚ QPushButtonã€QLabel å’Œ QGraphicsScene ç­‰ï¼‰ã€‚\né€šè¿‡ç»§æ‰¿ QWidget å’Œå®ç° paintEvent å‡½æ•°æ¥è¿›è¡Œç»˜åˆ¶æ˜¯ä¸€ç§å¸¸è§çš„æ–¹æ³•ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯æ›´é«˜çº§åˆ«çš„ç»„ä»¶ï¼Œåˆ™å¯èƒ½éœ€è¦é‡å†™æ›´å…·ä½“çš„ç»˜åˆ¶å‡½æ•°ï¼ˆä¾‹å¦‚ QStylePainter::drawControl å’Œ QStyle::drawPrimitiveï¼‰æ¥æ§åˆ¶ç»„ä»¶çš„å‘ˆç°ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ QWidget ä¸Šç»˜åˆ¶ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²ï¼š\n1234567891011121314void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);     QFont font;    font.setPointSize(24);    font.setBold(true);    painter.setFont(font);     QString text = &quot;Hello, world!&quot;;    QRect rect = painter.boundingRect(0, 0, width(), height(), Qt::AlignCenter, text);     painter.drawText(rect, text, Qt::AlignCenter);&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°† QPainter ç›´æ¥ä¼ é€’ç»™ QWidget å®ä¾‹ï¼Œå¹¶ä¸”åœ¨ paintEvent å‡½æ•°ä¸­ç»˜åˆ¶æ–‡æœ¬ã€‚\nåœ¨æ›´é«˜çº§åˆ«çš„ Qt ç»„ä»¶ä¸­ï¼Œæ‚¨é€šå¸¸éœ€è¦ä½¿ç”¨ QStylePainter æˆ– QPainterPath ç±»æ¥æ§åˆ¶ç»„ä»¶çš„æ ·å¼å’Œå‡ ä½•å½¢çŠ¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ QStylePainter æ¥è‡ªå®šä¹‰ QPushButton çš„å¤–è§‚ï¼š\n1234567void MyButton::paintEvent(QPaintEvent *event)&#123;    QStylePainter painter(this);     QStyleOptionButton option;    painter.drawControl(QStyle::CE_PushButton, option);&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰ QPushButton å­ç±»ï¼Œç„¶ååœ¨ paintEvent å‡½æ•°ä¸­ä½¿ç”¨ QStylePainter è¿›è¡Œç»˜åˆ¶ã€‚QStyleOptionButton å¯¹è±¡ç”¨äºæŒ‡å®šæŒ‰é’®çš„çŠ¶æ€å’Œæ–‡æœ¬ï¼Œç„¶åè°ƒç”¨ QStylePainter çš„ drawControl å‡½æ•°æ¥ç»˜åˆ¶æŒ‰é’®ã€‚\næ€»ç»“åœ¨ Qt ä¸­ï¼ŒQPainter æ˜¯ä¸€ç§å¼ºå¤§çš„å›¾å½¢ç»˜åˆ¶å·¥å…·ï¼Œå¯ç”¨äºå°†å‡ ä½•å½¢çŠ¶ã€æ–‡æœ¬å’Œå›¾åƒå‘ˆç°åˆ°çª—å£æˆ– Qt ç»„ä»¶ä¸­ã€‚æ‚¨å¯ä»¥é€šè¿‡è®¾ç½®å±æ€§ï¼ˆå¦‚é“…ç¬”å®½åº¦ã€ç”»åˆ·é¢œè‰²å’Œå­—ä½“ï¼‰æ¥æ§åˆ¶ç»˜åˆ¶è¿‡ç¨‹ï¼Œå¹¶ä½¿ç”¨ QPainterPath ç±»å‹æ¥åˆ›å»ºå¤æ‚çš„å½¢çŠ¶ã€‚\nä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œè¯·æ³¨æ„éµå¾ªæœ€ä½³å®è·µï¼Œå¹¶ä½¿ç”¨ä¼˜åŒ–è¿‡çš„ç®—æ³•æ¥è®¡ç®—å’Œç»˜åˆ¶å½¢çŠ¶ã€‚å¦‚æœæ‚¨æ›´é«˜çº§åˆ«çš„ç»˜å›¾åŠŸèƒ½ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨ OpenGL æˆ– Vulkan ç­‰ä¸“ä¸šåº“æ¥è¿›è¡Œç»˜å›¾ã€‚é™¤äº†æœ¬æ–‡æ‰€è¿°çš„åŸºæœ¬åŠŸèƒ½ä¹‹å¤–ï¼ŒQPainter è¿˜å…·æœ‰å¦å¤–è®¸å¤šé«˜çº§åŠŸèƒ½ã€‚\nä¾‹å¦‚ï¼ŒQPainter è¿˜æ”¯æŒè£å‰ªåŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ QPainter::setClipRect() æˆ– QPainter::setClipPath() å‡½æ•°å°†ç»˜åˆ¶åŒºåŸŸé™åˆ¶ä¸ºä¸€ä¸ªçŸ©å½¢æˆ– Qt è·¯å¾„ã€‚è¿™å¯¹äºåœ¨ä¸åŒéƒ¨åˆ†ç»˜åˆ¶é¢œè‰²å’Œå›¾æ¡ˆæ—¶éå¸¸æœ‰ç”¨ï¼Œé¿å…äº†æ¸²æŸ“åˆ°æ•´ä¸ªçª—å£çš„éœ€è¦ã€‚\nQPainter è¿˜æ”¯æŒåœ¨å›¾å½¢ä¸Šåº”ç”¨å˜æ¢ï¼ŒåŒ…æ‹¬æ—‹è½¬ã€ç¼©æ”¾å’Œç§»åŠ¨ï¼Œè¿™å¯ä»¥ä½¿ç”¨ QTransform å¯¹è±¡å®Œæˆã€‚æ‚¨å¯ä»¥ä½¿ç”¨ QPainter::setWorldTransform() å‡½æ•°å°†å˜æ¢åº”ç”¨äº QPainterï¼Œå¹¶ä½¿ç”¨ QPainter::resetTransform() å‡½æ•°å°†å…¶é‡ç½®å›é»˜è®¤çŠ¶æ€ã€‚\nå¦‚æœæ‚¨éœ€è¦åœ¨å›¾å½¢ä¸Šåº”ç”¨æ··åˆæ•ˆæœï¼ŒQPainter ä¹Ÿæä¾›äº†æ”¯æŒã€‚æ‚¨å¯ä»¥ä½¿ç”¨ QPainter::setCompositionMode() å‡½æ•°å°†ç»˜åˆ¶æ“ä½œä¸ç°æœ‰ç”»å¸ƒå†…å®¹ç»„åˆï¼Œä»¥äº§ç”Ÿé€æ˜æ•ˆæœï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ··åˆæ¨¡å¼å®ç°å„ç§æ•ˆæœã€‚\næœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„æ˜¯ï¼ŒQt æ–‡æ¡£ä¸­è¿˜æœ‰å¤§é‡é¢å¤–çš„ç¤ºä¾‹ã€æ•™ç¨‹å’Œè§£é‡Šï¼Œæ·±å…¥æ¢ç´¢ QPainter çš„ä½¿ç”¨æ–¹æ³•ã€‚æ— è®ºæ‚¨æ˜¯æ–°æ‰‹è¿˜æ˜¯æœ‰ç»éªŒçš„ Qt å¼€å‘äººå‘˜ï¼Œéƒ½å¯ä»¥ä»ä¸­è·ç›Šã€‚\nå¸Œæœ›æœ¬æ–‡å¯¹æ‚¨åŠ æ·±å¯¹ QPainter çš„ç†è§£ï¼Œå¹¶å¸®åŠ©æ‚¨æ›´å¥½åœ°ä½¿ç”¨å®ƒè¿›è¡Œå›¾å½¢ç»˜åˆ¶ï¼\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QPainterï¼šQtå›¾å½¢æ¸²æŸ“å¼•æ“","date":"2023-06-13T03:12:58.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"93c9bfd646dfd76fb6a48df45545ae28","title":"Qtå®ç°å¤šå†…æ ¸æ’­æ”¾å™¨","content":"MusicPlayerğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°ä¸€æ¬¾å°å·§è½»ä¾¿çš„è§†é¢‘æ’­æ”¾å™¨ï¼Œé›†æˆvlcï¼Œffmpegï¼Œmpvä¸‰ç§è§£ç å†…æ ¸ï¼Œä¸€é”®åˆ‡æ¢è§£ç æ¨¡å¼ï¼Œæ”¯æŒ4kï¼ŒGPUåŠ é€Ÿç­‰\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šmsvcç¼–è¯‘å™¨éƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\nQPainter\néƒ¨åˆ†çª—å£çš„ç»˜åˆ¶ï¼Œä¾‹å¦‚å®æ—¶å¤©æ°”ç•Œé¢\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nffmpeg\néŸ³è§†é¢‘è§£ç \n\n\nmpv\néŸ³è§†é¢‘è§£ç \n\n\nvlc\néŸ³è§†é¢‘è§£ç \n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°å¤šå†…æ ¸æ’­æ”¾å™¨","date":"2023-06-05T02:54:54.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"fbaaa363297ea0ad24d687796af4340f","title":"HTTPSå·¥ä½œåŸç†","content":"HTTPSå·¥ä½œåŸç†HTTPSï¼ˆHyperText Transfer Protocol Secureï¼‰æ˜¯ä¸€ç§åŸºäºSSL&#x2F;TLSåè®®çš„å®‰å…¨åŠ å¯†é€šä¿¡åè®®ï¼Œç”¨äºä¿è¯ç½‘ç»œé€šä¿¡çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»HTTPSçš„å·¥ä½œåŸç†ï¼Œå¹¶ä½¿ç”¨mermaidè¯­æ³•ç»˜åˆ¶äº¤äº’æ—¶åºå›¾ã€‚\nHTTPSåè®®äº¤äº’è¿‡ç¨‹HTTPSé€šä¿¡åè®®çš„äº¤äº’æµç¨‹å¦‚ä¸‹ï¼š\n\nå®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚ã€‚\n\næœåŠ¡å™¨å‘é€æ•°å­—è¯ä¹¦ç»™å®¢æˆ·ç«¯ã€‚\n\nå®¢æˆ·ç«¯éªŒè¯æ•°å­—è¯ä¹¦çš„åˆæ³•æ€§ã€‚\n\nå®¢æˆ·ç«¯ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œå¹¶ä½¿ç”¨æœåŠ¡å™¨çš„å…¬é’¥è¿›è¡ŒåŠ å¯†åå‘é€ç»™æœåŠ¡å™¨ã€‚\n\næœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œå¹¶ä½¿ç”¨è¯¥å¯†é’¥å¯¹éšåçš„é€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚\n\nåŒæ–¹å¼€å§‹å®‰å…¨é€šä¿¡ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æŠ€æœ¯å¯¹é€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œä»¥ä¿è¯æ•°æ®çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚\n\n\nä¸‹é¢å°†é€šè¿‡mermaidè¯­æ³•ç»˜åˆ¶äº¤äº’æ—¶åºå›¾ï¼Œè¿›ä¸€æ­¥è§£é‡ŠHTTPSé€šä¿¡åè®®äº¤äº’è¿‡ç¨‹ã€‚\næ—¶åºå›¾12345678910111213sequenceDiagram    participant Client    participant Server    Note over Client,Server: SSLæ¡æ‰‹é˜¶æ®µ    Client-&gt;&gt;Server: è¯·æ±‚è¿æ¥    Server-&gt;&gt;Client: å‘é€æ•°å­—è¯ä¹¦    Client-&gt;&gt;Server: éªŒè¯æ•°å­—è¯ä¹¦çš„åˆæ³•æ€§    Client-&gt;&gt;+Server: å‘é€å¯¹ç§°åŠ å¯†å¯†é’¥    Server-&gt;&gt;-Client: ä½¿ç”¨ç§é’¥è§£å¯†å¯¹ç§°åŠ å¯†å¯†é’¥    Note over Client,Server: å®‰å…¨é€šä¿¡é˜¶æ®µ    Client-&gt;&gt;Server: åŠ å¯†æ•°æ®    Server-&gt;&gt;Client: è§£å¯†æ•°æ®\n\nä»¥ä¸Šçš„æ—¶åºå›¾ä¸­ï¼Œç¬¬ä¸€éƒ¨åˆ†å±•ç¤ºäº†HTTPSæ¡æ‰‹é˜¶æ®µï¼Œå®¢æˆ·ç«¯è¯·æ±‚è¿æ¥å¹¶éªŒè¯æœåŠ¡å™¨å‘é€çš„æ•°å­—è¯ä¹¦çš„åˆæ³•æ€§ã€‚åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼ŒåŒæ–¹ä½¿ç”¨å¯¹ç§°åŠ å¯†å¯†é’¥è¿›è¡Œå®‰å…¨é€šä¿¡ï¼Œå…¶ä¸­å®¢æˆ·ç«¯è´Ÿè´£åŠ å¯†æ•°æ®ï¼ŒæœåŠ¡å™¨åˆ™è´Ÿè´£è§£å¯†æ•°æ®ã€‚\nç»“è®ºHTTPSåè®®æ˜¯ä¸€ç§åŸºäºSSL&#x2F;TLSåè®®çš„åŠ å¯†é€šä¿¡åè®®ï¼Œå…¶å·¥ä½œåŸç†åŒ…æ‹¬æ¡æ‰‹é˜¶æ®µå’Œå®‰å…¨é€šä¿¡é˜¶æ®µã€‚åœ¨æ¡æ‰‹é˜¶æ®µä¸­ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´é€šè¿‡æ•°å­—è¯ä¹¦äº¤æ¢å…¬é’¥ï¼Œå¹¶ç”Ÿæˆå¯¹ç§°åŠ å¯†å¯†é’¥ã€‚åœ¨å®‰å…¨é€šä¿¡é˜¶æ®µä¸­ï¼ŒåŒæ–¹ä½¿ç”¨å¯¹ç§°åŠ å¯†å¯†é’¥å¯¹é€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚\nè™½ç„¶HTTPSåè®®å¯ä»¥æä¾›ç›¸å¯¹è¾ƒé«˜çš„å®‰å…¨çº§åˆ«ï¼Œä½†ä»å­˜åœ¨ç€æŸäº›å®‰å…¨é£é™©ï¼Œå¦‚æ•°å­—è¯ä¹¦æ³„éœ²ã€å¯†ç å­¦ç®—æ³•å¼±åŒ–ç­‰é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦é‡‡å–é€‚å½“çš„æªæ–½æ¥å®Œå–„å®‰å…¨æœºåˆ¶ï¼Œä»¥ç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚\næ€»ç»“HTTPSæ˜¯ä¸€ç§åŸºäºSSL&#x2F;TLSåè®®çš„åŠ å¯†é€šä¿¡åè®®ï¼Œç”¨äºä¿è¯ç½‘ç»œé€šä¿¡çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚HTTPSçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š\n\nå®¢æˆ·ç«¯å‘èµ·HTTPSè¯·æ±‚\n\nå®¢æˆ·ç«¯ä½¿ç”¨HTTPSè¯·æ±‚è¿æ¥æœåŠ¡å™¨æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªHTTPSè¯·æ±‚ç»™æœåŠ¡å™¨ã€‚\n\næœåŠ¡å™¨æä¾›SSLè¯ä¹¦\n\næœåŠ¡å™¨æ”¶åˆ°HTTPSè¯·æ±‚åï¼Œä¼šå‘å®¢æˆ·ç«¯å‘é€å…¶æ•°å­—è¯ä¹¦ï¼Œå…¶ä¸­åŒ…å«äº†æœåŠ¡å™¨å…¬é’¥ã€è¯ä¹¦é¢å‘æœºæ„ã€æœåŠ¡å™¨åç§°ç­‰ä¿¡æ¯ã€‚\n\nå®¢æˆ·ç«¯éªŒè¯è¯ä¹¦\n\nå®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡å™¨çš„æ•°å­—è¯ä¹¦åï¼Œä¼šè¿›è¡Œä»¥ä¸‹æ­¥éª¤æ¥éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼š\n\néªŒè¯è¯ä¹¦æ˜¯å¦ç”±å—ä¿¡ä»»çš„è¯ä¹¦é¢å‘æœºæ„ç­¾åã€‚\néªŒè¯æœåŠ¡å™¨åç§°ä¸è¯ä¹¦æ˜¯å¦åŒ¹é…ã€‚\néªŒè¯è¯ä¹¦æ˜¯å¦å·²è¿‡æœŸã€‚\n\nå¦‚æœè¯ä¹¦éªŒè¯æˆåŠŸï¼Œåˆ™å®¢æˆ·ç«¯å¯ä»¥å¼€å§‹ä½¿ç”¨è¯ä¹¦ä¸­åŒ…å«çš„å…¬é’¥å’ŒæœåŠ¡å™¨è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚\n\nå»ºç«‹å®‰å…¨è¿æ¥\n\nå®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡å™¨çš„å…¬é’¥å¯¹éšæœºç”Ÿæˆçš„å¯¹ç§°åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†å…¶å‘é€ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†è¯¥å¯†é’¥ï¼Œå¹¶ä½¿ç”¨è¯¥å¯†é’¥å¯¹é€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚\næ­¤æ—¶å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å°±å»ºç«‹äº†ä¸€ä¸ªå®‰å…¨çš„åŠ å¯†é€šé“ï¼Œå¯ä»¥é€šè¿‡è¯¥é€šé“è¿›è¡Œå®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚\n\nå®‰å…¨é€šä¿¡\n\nä¸€æ—¦å®‰å…¨è¿æ¥å»ºç«‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±å¯ä»¥ä½¿ç”¨å¯¹ç§°åŠ å¯†æŠ€æœ¯å¯¹é€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œä»¥ä¿è¯æ•°æ®çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿˜å¯ä»¥ä½¿ç”¨æ‘˜è¦ç®—æ³•å¯¹æ¶ˆæ¯è¿›è¡ŒéªŒè¯ï¼Œä»è€Œä¿è¯æ•°æ®çš„çœŸå®æ€§å’Œå®Œæ•´æ€§ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHTTPSåè®®æ˜¯åŸºäºSSLæˆ–TLSåè®®çš„ï¼Œå› æ­¤å®ƒå…·æœ‰ä¸è¿™äº›åè®®ç›¸åŒçš„ç¼ºç‚¹å’Œå®‰å…¨é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ•°å­—è¯ä¹¦è¢«ç¯¡æ”¹æˆ–ä¼ªé€ ï¼Œåˆ™ä¼šå¯¼è‡´é€šä¿¡çš„ä¸å®‰å…¨æ€§ï¼›å¦‚æœå¯†ç å­¦ç®—æ³•å¼±åŒ–æˆ–å¯†é’¥ç®¡ç†ä¸å½“ï¼Œåˆ™ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´åŠ å¯†æ•°æ®æ³„éœ²ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨HTTPSæ—¶ï¼Œå¿…é¡»é‡‡å–é€‚å½“çš„å®‰å…¨æªæ–½æ¥ç¡®ä¿é€šä¿¡çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚\n","slug":"å…¶ä»–/HTTPSå·¥ä½œåŸç†","date":"2023-05-23T05:29:48.000Z","categories_index":"å…¶ä»–æ•™ç¨‹","tags_index":"https","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5ad5ce4ee7b2f8c117390804baa8feb4","title":"OpenSSLåº“å®ç°AESåŠ è§£å¯†ç®—æ³•","content":"ä¸‹é¢æ˜¯ä½¿ç”¨OpenSSLåº“è¿›è¡ŒAES-128-CBCåŠ å¯†å’Œè§£å¯†ï¼Œæ”¯æŒPKCS7Paddingã€PKCS5Paddingã€ZEROPaddingä¸‰ç§å¡«å……æ–¹å¼çš„ç¤ºä¾‹ä»£ç ã€‚åœ¨å®ç°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†EVPæ¥å£å’ŒCryptoPPåº“ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;openssl/evp.h&gt;#include &lt;crypto++/modes.h&gt;#include &lt;crypto++/aes.h&gt;#define AES_BLOCK_SIZE 16// PKCS7Paddingå¡«å……æ–¹å¼bool pkcs7_padding(unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len)&#123;    size_t padded_len = AES_BLOCK_SIZE - (in_len % AES_BLOCK_SIZE);    out_len = in_len + padded_len;    memcpy(out, in, in_len);    for (size_t i = in_len; i &lt; out_len; ++i) &#123;        out[i] = padded_len;    &#125;    return true;&#125;size_t pkcs7_unpadding(unsigned char *in, size_t in_len)&#123;    unsigned char padding_byte = in[in_len - 1];    if (padding_byte &gt; AES_BLOCK_SIZE || padding_byte &gt; in_len) &#123;        return 0;    &#125;    return in_len - padding_byte;&#125;// PKCS5Paddingå¡«å……æ–¹å¼bool pkcs5_padding(unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len)&#123;    size_t padded_len = (in_len / AES_BLOCK_SIZE + 1) * AES_BLOCK_SIZE;    size_t padding_len = padded_len - in_len;    unsigned char padding_byte = (unsigned char)padding_len;    memcpy(out, in, in_len);    for (size_t i = in_len; i &lt; padded_len; ++i) &#123;        out[i] = padding_byte;    &#125;    out_len = padded_len;    return true;&#125;size_t pkcs5_unpadding(unsigned char *in, size_t in_len)&#123;    size_t unpadded_len = in_len;    unsigned char padding_byte = in[in_len - 1];    if (padding_byte &gt; AES_BLOCK_SIZE || unpadded_len &lt; padding_byte) &#123;        return 0;    &#125;    unpadded_len -= padding_byte;    return unpadded_len;&#125;// ZEROPaddingå¡«å……æ–¹å¼bool zero_padding(unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len)&#123;    size_t padded_len = ((in_len / AES_BLOCK_SIZE) + 1) * AES_BLOCK_SIZE;    memcpy(out, in, in_len);    memset(out + in_len, 0, padded_len - in_len);    out_len = padded_len;    return true;&#125;size_t zero_unpadding(unsigned char *in, size_t in_len)&#123;    size_t unpadded_len = in_len;    while (in[unpadded_len - 1] == 0) &#123;        --unpadded_len;    &#125;    return unpadded_len;&#125;// ä½¿ç”¨EVPæ¥å£è¿›è¡ŒAES-128-CBCåŠ è§£å¯†bool aes_encrypt_evp(const unsigned char *key, const unsigned char *iv, const unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len, int padding_mode)&#123;    EVP_CIPHER_CTX *ctx = NULL;    int len, outlen;    bool ret = false;    if (!(ctx = EVP_CIPHER_CTX_new())) &#123;        return false;    &#125;    const EVP_CIPHER *cipher;    switch (padding_mode) &#123;        case 0:            cipher = EVP_aes_128_cbc();            break;        case 1:            cipher = EVP_aes_128_cbc();            break;        case 2:            cipher = EVP_aes_128_cbc();            break;        default:            goto clean_up;    &#125;    if (EVP_EncryptInit_ex(ctx, cipher, NULL, key, iv) != 1) &#123;        goto clean_up;    &#125;    unsigned char *padded_in = new unsigned char[in_len + AES_BLOCK_SIZE];    switch (padding_mode) &#123;        case 0:            memcpy(padded_in, in, in_len);            out_len = in_len;            break;        case 1:            pkcs5_padding(in, in_len, padded_in, out_len);            break;        case 2:            zero_padding(in, in_len, padded_in, out_len);            break;        default:            goto clean_up;    &#125;    if (EVP_EncryptUpdate(ctx, out, &amp;len, padded_in, out_len) != 1) &#123;        goto clean_up;    &#125;    outlen = len;    if (EVP_EncryptFinal_ex(ctx, out + len, &amp;len) != 1) &#123;        goto clean_up;    &#125;    outlen += len;    out_len = outlen;    ret = true;clean_up:    EVP_CIPHER_CTX_free(ctx);    delete[] padded_in;    return ret;&#125;bool aes_decrypt_evp(const unsigned char *key, const unsigned char *iv, const unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len, int padding_mode)&#123;    EVP_CIPHER_CTX *ctx = NULL;    int len, outlen;    bool ret = false;    if (!(ctx = EVP_CIPHER_CTX_new())) &#123;        return false;    &#125;    const EVP_CIPHER *cipher;    switch (padding_mode) &#123;        case 0:            cipher = EVP_aes_128_cbc();            break;        case 1:            cipher = EVP_aes_128_cbc();            break;        case 2:            cipher = EVP_aes_128_cbc();            break;        default:            goto clean_up;    &#125;    if (EVP_DecryptInit_ex(ctx, cipher, NULL, key, iv) != 1) &#123;        goto clean_up;    &#125;    if (EVP_DecryptUpdate(ctx, out, &amp;len, in, in_len) != 1) &#123;        goto clean_up;    &#125;    outlen = len;    if (EVP_DecryptFinal_ex(ctx, out + len, &amp;len) != 1) &#123;        goto clean_up;    &#125;    outlen += len;    unsigned char *unpadded_out = new unsigned char[outlen];    switch (padding_mode) &#123;        case 0:            out_len = outlen;            break;        case 1:            out_len = pkcs5_unpadding(out, outlen);            break;        case 2:            out_len = zero_unpadding(out, outlen);            break;        default:            goto clean_up;    &#125;    if (out_len == 0) &#123;        delete[] unpadded_out;        ret = false;        goto clean_up;    &#125;    memcpy(unpadded_out, out, out_len);    memcpy(out, unpadded_out, out_len);    out_len = outlen;    ret = true;clean_up:    EVP_CIPHER_CTX_free(ctx);    delete[] unpadded_out;    return ret;&#125;// ä½¿ç”¨CryptoPPåº“è¿›è¡ŒAES-128-CBCåŠ è§£å¯†bool aes_encrypt_cryptopp(const unsigned char *key, const unsigned char *iv, const unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len, int padding_mode)&#123;    CryptoPP::AES::Encryption aes(key, AES_BLOCK_SIZE);    std::string cipher;    switch (padding_mode) &#123;        case 0:            CryptoPP::CBC_Mode_ExternalCipher::Encryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(cipher));            filter.Put(in, in_len);            filter.MessageEnd();            break;        case 1:            CryptoPP::PKCS_PADDING::Pad(padded_in, in, in_len, in_len + AES_BLOCK_SIZE);            CryptoPP::CBC_Mode_ExternalCipher::Encryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(cipher));            filter.Put(padded_in, in_len + AES_BLOCK_SIZE);            filter.MessageEnd();            break;        case 2:            CryptoPP::ZeroPadding().Pad(in, in_len, in_len + AES_BLOCK_SIZE);            CryptoPP::CBC_Mode_ExternalCipher::Encryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(cipher));            filter.Put(in, in_len + AES_BLOCK_SIZE);            filter.MessageEnd();            break;        default:            return false;    &#125;    out_len = cipher.size();    memcpy(out, cipher.data(), out_len);    return true;&#125;bool aes_decrypt_cryptopp(const unsigned char *key, const unsigned char *iv, const unsigned char *in, size_t in_len, unsigned char *out, size_t &amp;out_len, int padding_mode)&#123;    if (in_len % AES_BLOCK_SIZE != 0) &#123;        return false;    &#125;    CryptoPP::AES::Decryption aes(key, AES_BLOCK_SIZE);    std::string plain;    switch (padding_mode) &#123;        case 0:            CryptoPP::CBC_Mode_ExternalCipher::Decryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(plain));            filter.Put(in, in_len);            filter.MessageEnd();            break;        case 1:            CryptoPP::CBC_Mode_ExternalCipher::Decryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(plain));            filter.Put(in, in_len);            filter.MessageEnd();            CryptoPP::PKCS_PADDING::Unpad(out, plain.data(), plain.size());            out_len = plain.size();            break;        case 2:            CryptoPP::CBC_Mode_ExternalCipher::Decryption cbc(aes, iv);            CryptoPP::StreamTransformationFilter filter(cbc, new CryptoPP::StringSink(plain));            filter.Put(in, in_len);            filter.MessageEnd();            CryptoPP::ZeroPadding().Unpad(out, plain.data(), plain.size());            out_len = plain.size();            break;        default:            return false;    &#125;    return true;&#125;int main()&#123;    const unsigned char key[] = &quot;0123456789abcdef&quot;;    const unsigned char iv[] = &quot;0123456789abcdef&quot;;    unsigned char in[128] = &#123;0&#125;;    unsigned char out[256] = &#123;0&#125;;    size_t outlen = 0;    // æµ‹è¯•PKCS7Paddingå¡«å……æ–¹å¼    std::cout &lt;&lt; &quot;ä½¿ç”¨PKCS7Paddingå¡«å……æ–¹å¼è¿›è¡ŒåŠ è§£å¯†&quot; &lt;&lt; std::endl;    strcpy((char *)in, &quot;hello world&quot;);    aes_encrypt_evp(key, iv, in, strlen((char *)in), out, outlen, 1);    std::cout &lt;&lt; &quot;åŠ å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; std::endl;    for (size_t i = 0; i &lt; outlen; ++i) &#123;        printf(&quot;%02x &quot;, out[i]);    &#125;    std::cout &lt;&lt; std::endl;    memset(in, 0, sizeof(in));    aes_decrypt_evp(key, iv, out, outlen, in, outlen, 1);    std::cout &lt;&lt; &quot;è§£å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; (char *)in &lt;&lt; std::endl;    // æµ‹è¯•PKCS5Paddingå¡«å……æ–¹å¼    std::cout &lt;&lt; &quot;ä½¿ç”¨PKCS5Paddingå¡«å……æ–¹å¼è¿›è¡ŒåŠ è§£å¯†&quot; &lt;&lt; std::endl;    strcpy((char *)in, &quot;hello world&quot;);    aes_encrypt_evp(key, iv, in, strlen((char *)in), out, outlen, 2);    std::cout &lt;&lt; &quot;åŠ å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; std::endl;    for (size_t i = 0; i &lt; outlen; ++i) &#123;        printf(&quot;%02x &quot;, out[i]);    &#125;    std::cout &lt;&lt; std::endl;    memset(in, 0, sizeof(in));    aes_decrypt_evp(key, iv, out, outlen, in, outlen, 2);    std::cout &lt;&lt; &quot;è§£å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; (char *)in &lt;&lt; std::endl;    // æµ‹è¯•ZEROPaddingå¡«å……æ–¹å¼    std::cout &lt;&lt; &quot;ä½¿ç”¨ZEROPaddingå¡«å……æ–¹å¼è¿›è¡ŒåŠ è§£å¯†&quot; &lt;&lt; std::endl;    strcpy((char *)in, &quot;hello world&quot;);    aes_encrypt_evp(key, iv, in, strlen((char *)in), out, outlen, 3);    std::cout &lt;&lt; &quot;åŠ å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; std::endl;    for (size_t i = 0; i &lt; outlen; ++i) &#123;        printf(&quot;%02x &quot;, out[i]);    &#125;    std::cout &lt;&lt; std::endl;    memset(in, 0, sizeof(in));    aes_decrypt_evp(key, iv, out, outlen, in, outlen, 3);    std::cout &lt;&lt; &quot;è§£å¯†åçš„ç»“æœä¸ºï¼š&quot; &lt;&lt; (char *)in &lt;&lt; std::endl;    return 0;&#125;\n\nä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸‰ç§å¡«å……æ–¹å¼çš„å¯¹åº”å‡½æ•°ï¼špkcs7_paddingã€pkcs5_paddingã€zero_paddingï¼Œä»¥åŠå®ƒä»¬çš„åå‘æ“ä½œå‡½æ•°ï¼špkcs7_unpaddingã€pkcs5_unpaddingã€zero_unpaddingã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨EVPæ¥å£å’ŒCryptoPPåº“åˆ†åˆ«å®ç°äº†AES-128-CBCåŠ å¯†å’Œè§£å¯†ã€‚åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®å¡«å……æ–¹å¼çš„ä¸åŒï¼Œåœ¨åŠ å¯†ä¹‹å‰å¯¹åŸå§‹æ•°æ®è¿›è¡Œäº†å¡«å……ï¼Œè€Œåœ¨è§£å¯†ä¹‹ååˆ™è¿›è¡Œäº†åå‘æ“ä½œå»é™¤å¡«å……ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­åˆ†åˆ«æµ‹è¯•äº†è¿™ä¸‰ç§å¡«å……æ–¹å¼çš„åŠ è§£å¯†æ•ˆæœï¼Œå¹¶æ‰“å°äº†ç»“æœã€‚è¿™æ®µä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯è¿›è¡ŒAES-128-CBCåŠ è§£å¯†ï¼Œæ”¯æŒä¸‰ç§å¡«å……æ–¹å¼ï¼šPKCS7Paddingã€PKCS5Paddingå’ŒZEROPaddingã€‚ä¸»å‡½æ•°ä¸­å¯¹è¿™äº›å¡«å……æ–¹å¼è¿›è¡Œäº†æµ‹è¯•ï¼ŒéªŒè¯äº†å®ƒä»¬çš„æ­£ç¡®æ€§ã€‚\næ­¤å¤–ï¼Œåœ¨ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†EVPæ¥å£å’ŒCryptoPPåº“ä¸¤ç§ä¸åŒçš„æ–¹å¼è¿›è¡ŒåŠ è§£å¯†ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å…·ä½“éœ€æ±‚é€‰æ‹©ä¸åŒçš„æ–¹å¼ã€‚EVPæ¥å£æ˜¯OpenSSLåº“æä¾›çš„ä¸€ä¸ªé«˜å±‚æ¬¡çš„åŠ å¯†æ¥å£ï¼Œä½¿ç”¨ç®€å•ï¼Œä½†é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼›è€ŒCryptoPPåº“åˆ™æ˜¯ä¸€ä¸ªå¼€æºçš„å¯†ç å­¦åº“ï¼Œæä¾›äº†è®¸å¤šé«˜æ•ˆçš„åŠ å¯†ç®—æ³•å®ç°ï¼Œé€Ÿåº¦æ¯”EVPæ›´å¿«ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºä½¿ç”¨å“ªç§æ–¹å¼è¿›è¡ŒåŠ è§£å¯†ï¼Œéƒ½åº”è¯¥ä¸¥æ ¼éµå¾ªå¯†ç å­¦å®‰å…¨çš„æœ€ä½³å®è·µã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å»ºè®®ï¼š\n\nå¯†é’¥ç®¡ç†ï¼šå¯†é’¥åº”è¯¥å®šæœŸæ›´æ¢ï¼Œå¹¶ä¸”åº”è¯¥åœ¨ç³»ç»Ÿä¸­å­˜å‚¨å’Œä¼ è¾“æ—¶è¿›è¡ŒåŠ å¯†ã€‚å¯†é’¥åº”è¯¥ä»…é™äºæˆæƒç”¨æˆ·è®¿é—®ã€‚\nå¡«å……æ–¹å¼ï¼šåº”è¯¥å§‹ç»ˆä½¿ç”¨å¡«å……æ–¹å¼å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä»¥é¿å…æ˜æ–‡é•¿åº¦æ³„éœ²ä¿¡æ¯ã€‚å¸¸è§çš„å¡«å……æ–¹å¼åŒ…æ‹¬PKCS7Paddingã€PKCS5Paddingå’ŒZEROPaddingã€‚\néšæœºæ€§ï¼šåˆå§‹åŒ–å‘é‡åº”è¯¥å…·æœ‰å¼ºéšæœºæ€§ï¼Œå¹¶ä¸”ä¸èƒ½é‡å¤ä½¿ç”¨ã€‚æ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªæ–°çš„éšæœºçš„åˆå§‹åŒ–å‘é‡æ¥ä¿è¯å®‰å…¨æ€§ã€‚\nåŠ å¯†æ¨¡å¼ï¼šé™¤äº†ECBæ¨¡å¼å¤–ï¼Œå…¶ä»–åŠ å¯†æ¨¡å¼éƒ½åº”è¯¥å¾—åˆ°ä¼˜å…ˆè€ƒè™‘ã€‚CBCã€CTRå’ŒGCMæ¨¡å¼è¢«è®¤ä¸ºæ˜¯æœ€å®‰å…¨å’Œæœ€å¸¸è§çš„æ¨¡å¼ã€‚\n\næ€»ä¹‹ï¼ŒAES-128-CBCæ˜¯ä¸€ç§æµè¡Œçš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåº”ç”¨å¹¿æ³›ã€‚ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨å®ƒè¿›è¡ŒåŠ è§£å¯†æ—¶å¿…é¡»è¦æ³¨æ„å®‰å…¨æ€§é—®é¢˜ï¼Œé‡‡å–ç›¸åº”çš„æªæ–½æ¥é˜²æ­¢æ”»å‡»ã€‚åŒæ—¶ä¹Ÿéœ€è¦æ³¨æ„é€‰æ‹©åˆé€‚çš„åº“æˆ–è€…æ¥å£ï¼Œç¡®ä¿ç¨‹åºæ­£ç¡®ä¸”é«˜æ•ˆåœ°å®ŒæˆåŠ è§£å¯†æ“ä½œã€‚\n","slug":"å…¶ä»–/OpenSSLåº“å®ç°AESåŠ è§£å¯†ç®—æ³•","date":"2023-05-23T05:29:48.000Z","categories_index":"å…¶ä»–æ•™ç¨‹","tags_index":"openssl","author_index":"é˜¿æœ¨å¤§å”"},{"id":"47c166aa1551adcab409a420e5d0d7ce","title":"å®¢æˆ·ç«¯é€šä¿¡å®‰å…¨è®¾è®¡","content":"æ¶ˆæ¯ä¼ è¾“æ–¹æ¡ˆæ–¹æ¡ˆä¸€\nå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†\næ¡æ‰‹åï¼Œé‡‡ç”¨å¯¹ç§°åŠ å¯†1234567891011sequenceDiagram    participant A as å®¢æˆ·ç«¯A    participant B as å®¢æˆ·ç«¯B    A-&gt;&gt;+B: å‘é€å¥½å‹æŸ¥æ‰¾å¹¿æ’­æ¶ˆæ¯    B-&gt;&gt;+B: ç»„å»ºæœ¬èº«ä¿¡æ¯ï¼Œå¹¿æ’­å‘é€å‡ºæ¥    B--&gt;&gt;-A: æ”¶åˆ°å¹¿æ’­æ¶ˆæ¯åï¼Œæ·»åŠ åˆ°å¥½å‹åˆ—è¡¨å†…    A-&gt;&gt;+B: å»ºç«‹è¿æ¥å¹¶å‘é€æ¡æ‰‹æ¶ˆæ¯    B--&gt;&gt;+A: æ”¶åˆ°æ¡æ‰‹æ¶ˆæ¯åï¼Œæç¤ºç”¨æˆ·æ˜¯å¦å…è®¸èŠå¤©    A-&gt;&gt;+B: å‘é€åŠ å¯†åçš„éšæœºå¯†ç     B--&gt;&gt;-A: æ”¶åˆ°å¯†ç åï¼Œåˆ©ç”¨ç§é’¥è§£å¯†å¯†ç     A-&gt;&gt;B: ä½¿ç”¨æ­¤å¯†ç è¿›è¡Œå¯¹ç§°åŠ å¯†ï¼Œè¿›è¡Œæ¶ˆæ¯ä¼ è¾“\n\næ–¹æ¡ˆäºŒ\nä¸¤å¥—å…¬é’¥å’Œç§é’¥\nåˆ†åˆ«ä½¿ç”¨å¯¹æ–¹å…¬é’¥åŠ å¯†ï¼Œè‡ªèº«ç§é’¥è§£å¯†123456789101112sequenceDiagram    participant A as å®¢æˆ·ç«¯A    participant B as å®¢æˆ·ç«¯B    A-&gt;&gt;+B: å‘é€å¥½å‹æŸ¥æ‰¾å¹¿æ’­æ¶ˆæ¯    B-&gt;&gt;+B: ç»„å»ºæœ¬èº«ä¿¡æ¯ï¼Œå¹¿æ’­å‘é€å‡ºæ¥    B--&gt;&gt;-A: æ”¶åˆ°å¹¿æ’­æ¶ˆæ¯åï¼Œæ·»åŠ åˆ°å¥½å‹åˆ—è¡¨å†…    A-&gt;&gt;+B: è¿æ¥å¹¶å‘é€æ¡æ‰‹æ¶ˆæ¯    B--&gt;&gt;+A: æ”¶åˆ°æ¡æ‰‹æ¶ˆæ¯åï¼Œæç¤ºæ˜¯å¦å…è®¸èŠå¤©    B--&gt;&gt;+A: å‘é€æºå¸¦å…¬é’¥çš„æ¥å—æ¶ˆæ¯    A-&gt;&gt;+B: å‘é€è‡ªå·±çš„å…¬é’¥    B--&gt;&gt;-A: æ”¶åˆ°å…¬é’¥åï¼Œå›å¤æˆåŠŸæ¶ˆæ¯å®Œæˆæ¡æ‰‹ä»ªå¼    A-&gt;&gt;B: ä½¿ç”¨å¯¹æ–¹å…¬é’¥è¿›è¡Œæ¶ˆæ¯åŠ è§£å¯†ï¼Œè¿›è¡ŒèŠå¤©\n\næ–¹æ¡ˆä¸‰\nä¸¤å¥—å…¬é’¥å’Œç§é’¥\nåˆ†åˆ«ä½¿ç”¨å¯¹æ–¹å…¬é’¥åŠ å¯†ï¼Œè‡ªèº«ç§é’¥è§£å¯†\næ¯ä¸ªæ¶ˆæ¯éƒ½ä½¿ç”¨è‡ªèº«ç§é’¥å¯¹æ¶ˆæ¯çš„å“ˆå¸Œå€¼è¿›ç¨‹åŠ å¯†ç­¾åï¼Œä»è€ŒéªŒè¯æ¶ˆæ¯çš„å®Œæ•´æ€§å’Œæ¥æº123456789101112131415161718sequenceDiagram    participant A as å®¢æˆ·ç«¯A    participant B as å®¢æˆ·ç«¯B    A-&gt;&gt;+B: å‘é€å¥½å‹æŸ¥æ‰¾å¹¿æ’­æ¶ˆæ¯    B-&gt;&gt;+B: ç»„å»ºæœ¬èº«ä¿¡æ¯ï¼Œå¹¿æ’­å‘é€å‡ºæ¥    B--&gt;&gt;-A: æ”¶åˆ°å¹¿æ’­æ¶ˆæ¯åï¼Œæ·»åŠ åˆ°å¥½å‹åˆ—è¡¨å†…    A-&gt;&gt;+B: è¿æ¥å¹¶å‘é€æ¡æ‰‹æ¶ˆæ¯    B--&gt;&gt;+A: æ”¶åˆ°æ¡æ‰‹æ¶ˆæ¯åï¼Œæç¤ºæ˜¯å¦å…è®¸èŠå¤©    B--&gt;&gt;+A: å‘é€æºå¸¦å…¬é’¥çš„æ¥å—æ¶ˆæ¯    A-&gt;&gt;+B: å‘é€è‡ªå·±çš„å…¬é’¥    B--&gt;&gt;-A: æ”¶åˆ°å…¬é’¥åï¼Œå›å¤æˆåŠŸæ¶ˆæ¯å®Œæˆæ¡æ‰‹ä»ªå¼    A-&gt;&gt;+B: ä½¿ç”¨å“ˆå¸Œç®—æ³•å¯¹æ¶ˆæ¯è¿›è¡Œè®¡ç®—å¾—åˆ°æ•£åˆ—å€¼M    A-&gt;&gt;+B: ä½¿ç”¨ç§é’¥å°†æ•£åˆ—å€¼Mè¿›è¡ŒåŠ å¯†å¾—åˆ°ç­¾åS    A-&gt;&gt;+B: ä½¿ç”¨Açš„å…¬é’¥å°†æ¶ˆæ¯åŠ å¯†å¾—åˆ°M2    A-&gt;&gt;+B: å°†æ¶ˆæ¯M2å’Œç­¾åSå‘é€ç»™B    B--&gt;&gt;+A: æ”¶åˆ°æ¶ˆæ¯M2å’Œç­¾åSåï¼Œç”¨ç§é’¥è§£å¯†M2å¹¶å¾—åˆ°M3    B--&gt;&gt;-A: ç”¨Açš„å…¬é’¥è§£å¯†ç­¾åSå¹¶å¾—åˆ°ç­¾åS1    B-&gt;&gt;+A: å¯¹M3ä½¿ç”¨ç›¸åŒå“ˆå¸Œç®—æ³•è®¡ç®—æ•£åˆ—å€¼å¾—åˆ°M4ï¼Œå¹¶æ ¹æ®S1å’ŒM4æ˜¯å¦ä¸€è‡´åˆ¤æ–­æ¶ˆæ¯çš„çœŸå®æ€§\n\n","slug":"å…¶ä»–/å®¢æˆ·ç«¯é€šä¿¡å®‰å…¨è®¾è®¡","date":"2023-05-23T05:29:48.000Z","categories_index":"å…¶ä»–æ•™ç¨‹","tags_index":"åŠ å¯†,aes,rsa","author_index":"é˜¿æœ¨å¤§å”"},{"id":"71fd0f421f976303f8841082c0a437ed","title":"QtçŠ¶æ€æœºä¸QtåŠ¨ç”»çš„ç»“åˆä½¿ç”¨","content":"QtçŠ¶æ€æœºä¸QtåŠ¨ç”»çš„ç»“åˆä½¿ç”¨Qtæ˜¯ä¸€ä¸ªæµè¡Œçš„è·¨å¹³å°åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…è½»æ¾åœ°åˆ›å»ºé¢å‘å¯¹è±¡çš„GUIåº”ç”¨ç¨‹åºã€‚Qtæ¡†æ¶æä¾›äº†è®¸å¤šæœ‰ç”¨çš„å·¥å…·å’Œåº“ï¼Œå…¶ä¸­åŒ…æ‹¬çŠ¶æ€æœºå’ŒåŠ¨ç”»ã€‚çŠ¶æ€æœºæ˜¯ä¸€ç§è‡ªåŠ¨æœºï¼Œç”¨äºç®¡ç†å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ï¼Œè€ŒåŠ¨ç”»åˆ™å¯ä»¥ä½¿è¿™äº›çŠ¶æ€è½¬æ¢æ›´åŠ æµç•…å’Œè‡ªç„¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•å°†QtçŠ¶æ€æœºä¸QtåŠ¨ç”»ç»“åˆä½¿ç”¨ã€‚\nç®€ä»‹QtçŠ¶æ€æœºæ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ¡†æ¶ï¼Œç”¨äºç®¡ç†å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ã€‚çŠ¶æ€æœºç”±çŠ¶æ€ã€è½¬æ¢å’ŒåŠ¨ä½œç»„æˆã€‚çŠ¶æ€è¡¨ç¤ºå¯¹è±¡å¯èƒ½å¤„äºçš„çŠ¶æ€ï¼Œè½¬æ¢è¡¨ç¤ºå¯¹è±¡ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è½¬æ¢ï¼Œè€ŒåŠ¨ä½œæ˜¯åœ¨çŠ¶æ€è½¬æ¢æœŸé—´æ‰§è¡Œçš„æ“ä½œã€‚\nQtåŠ¨ç”»æ˜¯ä¸€ä¸ªåº“ï¼Œç”¨äºåˆ›å»ºåŠ¨æ€çš„ç”¨æˆ·ç•Œé¢æ•ˆæœã€‚å®ƒå¯ä»¥ç”¨äºåˆ›å»ºåŠ¨ç”»ã€è¿‡æ¸¡å’Œå…¶ä»–æ•ˆæœï¼Œä½¿åº”ç”¨ç¨‹åºæ›´åŠ ç”ŸåŠ¨å’Œå¸å¼•äººã€‚\nå°†è¿™ä¸¤ä¸ªæ¡†æ¶ç»“åˆä½¿ç”¨å¯ä»¥ä½¿å¼€å‘è€…è½»æ¾åœ°åˆ›å»ºå…·æœ‰å¤æ‚çŠ¶æ€è½¬æ¢å’ŒåŠ¨ç”»æ•ˆæœçš„åº”ç”¨ç¨‹åºã€‚\nçŠ¶æ€æœºå’ŒåŠ¨ç”»çš„ç»“åˆä½¿ç”¨åœ¨Qtä¸­ï¼ŒçŠ¶æ€æœºå’ŒåŠ¨ç”»å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»“åˆä½¿ç”¨ã€‚åœ¨çŠ¶æ€è½¬æ¢æœŸé—´ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨ç”»æ¥ä½¿è¿‡æ¸¡æ›´åŠ å¹³æ»‘å’Œè‡ªç„¶ã€‚\nä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªçŠ¶æ€çš„å¯¹è±¡ï¼šçŠ¶æ€Aå’ŒçŠ¶æ€Bã€‚æˆ‘ä»¬å¸Œæœ›åœ¨å¯¹è±¡ä»çŠ¶æ€Aè½¬æ¢åˆ°çŠ¶æ€Bæ—¶ä½¿ç”¨åŠ¨ç”»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥å®ç°è¿™ä¸€ç‚¹ï¼š\n12345678910111213141516171819202122// åˆ›å»ºçŠ¶æ€æœºQStateMachine *machine = new QStateMachine();// åˆ›å»ºçŠ¶æ€AQState *stateA = new QState(machine);stateA-&gt;assignProperty(object, &quot;x&quot;, 0);// åˆ›å»ºçŠ¶æ€BQState *stateB = new QState(machine);stateB-&gt;assignProperty(object, &quot;x&quot;, 100);// åˆ›å»ºè½¬æ¢QAbstractTransition *transition = stateA-&gt;addTransition(signal, stateB);// åˆ›å»ºåŠ¨ç”»QPropertyAnimation *animation = new QPropertyAnimation(object, &quot;x&quot;, this);animation-&gt;setDuration(1000);transition-&gt;addAnimation(animation);// å¯åŠ¨çŠ¶æ€æœºmachine-&gt;setInitialState(stateA);machine-&gt;start();\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªçŠ¶æ€çš„çŠ¶æ€æœºï¼ŒçŠ¶æ€Aå’ŒçŠ¶æ€Bã€‚æˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ªä¿¡å·ï¼Œå½“æ¥æ”¶åˆ°è¿™ä¸ªä¿¡å·æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹è±¡ä»çŠ¶æ€Aè½¬æ¢åˆ°çŠ¶æ€Bã€‚æˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ªåŠ¨ç”»ï¼Œç”¨äºä½¿è¿‡æ¸¡æ›´åŠ å¹³æ»‘å’Œè‡ªç„¶ã€‚åŠ¨ç”»å°†å¯¹è±¡çš„xå±æ€§ä»0å˜ä¸º100ï¼ŒæŒç»­æ—¶é—´ä¸º1ç§’ã€‚æœ€åï¼Œæˆ‘ä»¬å¯åŠ¨äº†çŠ¶æ€æœºã€‚\nç¤ºä¾‹ä»£ç ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨QtçŠ¶æ€æœºå’ŒQtåŠ¨ç”»ç»“åˆä½¿ç”¨ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;QApplication&gt;#include &lt;QStateMachine&gt;#include &lt;QState&gt;#include &lt;QAbstractTransition&gt;#include &lt;QPushButton&gt;#include &lt;QPropertyAnimation&gt;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    // åˆ›å»ºä¸€ä¸ªæŒ‰é’®    QPushButton button(&quot;Click me!&quot;);    // åˆ›å»ºçŠ¶æ€æœº    QStateMachine *machine = new QStateMachine();    // åˆ›å»ºçŠ¶æ€A    QState *stateA = new QState(machine);    stateA-&gt;assignProperty(&amp;button, &quot;text&quot;, &quot;Click me!&quot;);    // åˆ›å»ºçŠ¶æ€B    QState *stateB = new QState(machine);    stateB-&gt;assignProperty(&amp;button, &quot;text&quot;, &quot;Hello!&quot;);    // åˆ›å»ºè½¬æ¢    QAbstractTransition *transition = stateA-&gt;addTransition(&amp;button, SIGNAL(clicked()), stateB);    // åˆ›å»ºåŠ¨ç”»    QPropertyAnimation *animation = new QPropertyAnimation(&amp;button, &quot;geometry&quot;, &amp;button);    animation-&gt;setDuration(1000);    transition-&gt;addAnimation(animation);    // å¯åŠ¨çŠ¶æ€æœº    machine-&gt;setInitialState(stateA);    machine-&gt;start();    // æ˜¾ç¤ºæŒ‰é’®    button.setGeometry(100, 100, 100, 50);    button.show();    return app.exec();&#125;\n\nåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒ‰é’®ï¼Œå¹¶ä½¿ç”¨çŠ¶æ€æœºå’ŒåŠ¨ç”»æ¥ç®¡ç†æŒ‰é’®çš„çŠ¶æ€è½¬æ¢ã€‚å½“ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶ï¼ŒæŒ‰é’®å°†ä»çŠ¶æ€Aè½¬æ¢åˆ°çŠ¶æ€Bï¼Œå¹¶ä½¿ç”¨åŠ¨ç”»ä½¿è¿‡æ¸¡æ›´åŠ å¹³æ»‘å’Œè‡ªç„¶ã€‚æŒ‰é’®çš„æ–‡æœ¬å°†ä»â€œClick me!â€å˜ä¸ºâ€œHello!â€ã€‚\nç»“è®ºåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å°†QtçŠ¶æ€æœºä¸QtåŠ¨ç”»ç»“åˆä½¿ç”¨ã€‚çŠ¶æ€æœºå¯ä»¥ç®¡ç†å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ï¼Œè€ŒåŠ¨ç”»å¯ä»¥ä½¿è¿™äº›çŠ¶æ€è½¬æ¢æ›´åŠ å¹³æ»‘å’Œè‡ªç„¶ã€‚é€šè¿‡å°†è¿™ä¸¤ä¸ªæ¡†æ¶ç»“åˆä½¿ç”¨ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°åˆ›å»ºå…·æœ‰å¤æ‚çŠ¶æ€è½¬æ¢å’ŒåŠ¨ç”»æ•ˆæœçš„åº”ç”¨ç¨‹åºã€‚\nQtçŠ¶æ€æœºä¸QtåŠ¨ç”»ä¸€èµ·ä½¿ç”¨Qtæ˜¯ä¸€ä¸ªå¼ºå¤§çš„åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå…¶ä¸­åŒ…å«äº†è®¸å¤šæœ‰ç”¨çš„å·¥å…·å’Œåº“ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´è½»æ¾åœ°æ„å»ºè·¨å¹³å°çš„åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨QtçŠ¶æ€æœºå’ŒQtåŠ¨ç”»æ¥åˆ›å»ºæ›´åŠ æµç•…å’Œäº¤äº’å¼çš„ç”¨æˆ·ç•Œé¢ã€‚\nä»€ä¹ˆæ˜¯QtçŠ¶æ€æœºï¼ŸQtçŠ¶æ€æœºæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºç®¡ç†å’Œæ§åˆ¶å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ã€‚å®ƒæä¾›äº†ä¸€ç§ç®€æ´ä¸”æ˜“äºç†è§£çš„æ–¹å¼æ¥å¤„ç†çŠ¶æ€å˜åŒ–ï¼Œä½¿å¾—ä»£ç æ›´åŠ å¯ç»´æŠ¤å’Œå¯æ‰©å±•ã€‚\nåœ¨Qtä¸­ï¼ŒçŠ¶æ€æœºé€šå¸¸ç”±ä¸¤ä¸ªä¸»è¦ç»„ä»¶ç»„æˆï¼šçŠ¶æ€å’Œè½¬æ¢ã€‚çŠ¶æ€è¡¨ç¤ºå¯¹è±¡çš„å½“å‰çŠ¶æ€ï¼Œè€Œè½¬æ¢åˆ™å®šä¹‰çŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚å½“å¯¹è±¡æ¥æ”¶åˆ°æŸä¸ªäº‹ä»¶æ—¶ï¼ŒçŠ¶æ€æœºä¼šæ ¹æ®å½“å‰çŠ¶æ€å’Œäº‹ä»¶ç±»å‹æ‰§è¡Œç›¸åº”çš„è½¬æ¢ï¼Œè¿›è€Œæ”¹å˜å¯¹è±¡çš„çŠ¶æ€ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨Qtä¸­å®ç°çŠ¶æ€æœºï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// å®šä¹‰ä¸¤ç§çŠ¶æ€enum State &#123;    IdleState,    RunningState&#125;;// å®šä¹‰ä¸¤ç§äº‹ä»¶enum Event &#123;    StartEvent,    StopEvent&#125;;class MyObject : public QObject &#123;    Q_OBJECT    public:    MyObject(QObject* parent = nullptr) : QObject(parent) &#123;        // åˆ›å»ºçŠ¶æ€æœº        m_stateMachine = new QStateMachine(this);                // åˆ›å»ºçŠ¶æ€        QState* idleState = new QState();        QState* runningState = new QState();                // å°†çŠ¶æ€æ·»åŠ åˆ°çŠ¶æ€æœºä¸­        m_stateMachine-&gt;addState(idleState);        m_stateMachine-&gt;addState(runningState);                // åˆ›å»ºè½¬æ¢        QSignalTransition* startTransition = new QSignalTransition(this, &amp;MyObject::start);        QSignalTransition* stopTransition = new QSignalTransition(this, &amp;MyObject::stop);                // å®šä¹‰è½¬æ¢çš„æºçŠ¶æ€å’Œç›®æ ‡çŠ¶æ€        startTransition-&gt;setSourceState(idleState);        startTransition-&gt;setTargetState(runningState);                stopTransition-&gt;setSourceState(runningState);        stopTransition-&gt;setTargetState(idleState);                // æ·»åŠ è½¬æ¢åˆ°çŠ¶æ€æœºä¸­        idleState-&gt;addTransition(startTransition);        runningState-&gt;addTransition(stopTransition);                m_stateMachine-&gt;setInitialState(idleState);        m_stateMachine-&gt;start();    &#125;    signals:    void start();    void stop();    private:    QStateMachine* m_stateMachine;&#125;;\n\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºMyObjectçš„ç±»ï¼Œå¹¶å®ç°äº†ä¸€ä¸ªç®€å•çš„çŠ¶æ€æœºã€‚è¯¥çŠ¶æ€æœºåŒ…å«ä¸¤ä¸ªçŠ¶æ€ï¼ˆIdleStateå’ŒRunningStateï¼‰å’Œä¸¤ä¸ªäº‹ä»¶ï¼ˆStartEventå’ŒStopEventï¼‰ã€‚å½“å¯¹è±¡æ¥æ”¶åˆ°StartEventäº‹ä»¶æ—¶ï¼ŒçŠ¶æ€æœºä¼šä»IdleStateè½¬æ¢åˆ°RunningStateï¼Œå½“æ¥æ”¶åˆ°StopEventäº‹ä»¶æ—¶ï¼Œåˆ™ä¼šä»RunningStateè½¬æ¢å›IdleStateã€‚\nä»€ä¹ˆæ˜¯QtåŠ¨ç”»ï¼ŸQtåŠ¨ç”»æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºå¹³æ»‘å’ŒåŠ¨æ€æ•ˆæœçš„å·¥å…·ã€‚å®ƒå…è®¸å¼€å‘è€…åˆ›å»ºå¤æ‚çš„åŠ¨ç”»åºåˆ—ï¼ŒåŒ…æ‹¬ç¼“åŠ¨æ•ˆæœã€é€æ˜åº¦å˜åŒ–ã€æ—‹è½¬å’Œç¼©æ”¾ç­‰ã€‚\nåœ¨Qtä¸­ï¼ŒåŠ¨ç”»é€šå¸¸ç”±ä»¥ä¸‹ç»„ä»¶ç»„æˆï¼š\n\nQPropertyAnimationï¼šç”¨äºæ§åˆ¶å±æ€§å€¼çš„åŠ¨ç”»ç±»ã€‚\nQEasingCurveï¼šç”¨äºå®šä¹‰ç¼“åŠ¨æ•ˆæœçš„ç±»ã€‚\nQSequentialAnimationGroupï¼šç”¨äºæŒ‰é¡ºåºæ’­æ”¾å¤šä¸ªåŠ¨ç”»çš„ç±»ã€‚\nQParallelAnimationGroupï¼šç”¨äºåŒæ—¶æ’­æ”¾å¤šä¸ªåŠ¨ç”»çš„ç±»ã€‚\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨Qtä¸­å®ç°åŠ¨ç”»ï¼š\n123456789101112131415161718192021222324// åˆ›å»ºç¿»è½¬åŠ¨ç”»QPropertyAnimation* flipAnimation = new QPropertyAnimation(myWidget, &quot;rotation&quot;);flipAnimation-&gt;setDuration(500);flipAnimation-&gt;setStartValue(0);flipAnimation-&gt;setEndValue(180);// å®šä¹‰ç¼“åŠ¨æ•ˆæœ// åˆ›å»ºç¼“åŠ¨æ•ˆæœQEasingCurve easeInCubic(QEasingCurve::InCubic);flipAnimation-&gt;setEasingCurve(easeInCubic);// åˆ›å»ºå¹³ç§»åŠ¨ç”»QPropertyAnimation* translateAnimation = new QPropertyAnimation(myWidget, &quot;pos&quot;);translateAnimation-&gt;setDuration(1000);translateAnimation-&gt;setStartValue(QPoint(0, 0));translateAnimation-&gt;setEndValue(QPoint(100, 100));// å®šä¹‰å¹¶è¡ŒåŠ¨ç”»ç»„QParallelAnimationGroup* animationGroup = new QParallelAnimationGroup();animationGroup-&gt;addAnimation(flipAnimation);animationGroup-&gt;addAnimation(translateAnimation);// å¯åŠ¨åŠ¨ç”»ç»„animationGroup-&gt;start();\n\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªåŠ¨ç”»ï¼šä¸€ä¸ªæ—‹è½¬åŠ¨ç”»å’Œä¸€ä¸ªå¹³ç§»åŠ¨ç”»ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å®ƒä»¬æ·»åŠ åˆ°ä¸€ä¸ªå¹¶è¡ŒåŠ¨ç”»ç»„ä¸­ï¼Œå¹¶åŒæ—¶å¯åŠ¨è¿™ä¸¤ä¸ªåŠ¨ç”»ã€‚\nå°†QtçŠ¶æ€æœºä¸QtåŠ¨ç”»ç»“åˆä½¿ç”¨ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨QtçŠ¶æ€æœºå’ŒQtåŠ¨ç”»æ¥åˆ†åˆ«å®ç°çŠ¶æ€ç®¡ç†å’ŒåŠ¨ç”»æ’­æ”¾ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å°†å®ƒä»¬ç»“åˆä½¿ç”¨ï¼Œåˆ›å»ºä¸€ä¸ªæ›´åŠ æµç•…å’Œäº¤äº’å¼çš„ç”¨æˆ·ç•Œé¢ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨Qtä¸­å°†çŠ¶æ€æœºå’ŒåŠ¨ç”»ç»“åˆä½¿ç”¨ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667class MyObject : public QObject &#123;    Q_OBJECT    public:    MyObject(QWidget* parent = nullptr) : QObject(parent) &#123;        // åˆ›å»ºçŠ¶æ€æœº        m_stateMachine = new QStateMachine(this);                // åˆ›å»ºçŠ¶æ€        QState* idleState = new QState();        QState* runningState = new QState();                // å°†çŠ¶æ€æ·»åŠ åˆ°çŠ¶æ€æœºä¸­        m_stateMachine-&gt;addState(idleState);        m_stateMachine-&gt;addState(runningState);                // åˆ›å»ºè½¬æ¢        QSignalTransition* startTransition = new QSignalTransition(this, &amp;MyObject::start);        QSignalTransition* stopTransition = new QSignalTransition(this, &amp;MyObject::stop);                // å®šä¹‰è½¬æ¢çš„æºçŠ¶æ€å’Œç›®æ ‡çŠ¶æ€        startTransition-&gt;setSourceState(idleState);        startTransition-&gt;setTargetState(runningState);                stopTransition-&gt;setSourceState(runningState);        stopTransition-&gt;setTargetState(idleState);                // æ·»åŠ è½¬æ¢åˆ°çŠ¶æ€æœºä¸­        idleState-&gt;addTransition(startTransition);        runningState-&gt;addTransition(stopTransition);                // åˆ›å»ºæ—‹è½¬åŠ¨ç”»        QPropertyAnimation* flipAnimation = new QPropertyAnimation(parent, &quot;rotation&quot;);        flipAnimation-&gt;setDuration(500);        flipAnimation-&gt;setStartValue(0);        flipAnimation-&gt;setEndValue(180);                // å®šä¹‰ç¼“åŠ¨æ•ˆæœ        QEasingCurve easeInCubic(QEasingCurve::InCubic);        flipAnimation-&gt;setEasingCurve(easeInCubic);                // åˆ›å»ºå¹³ç§»åŠ¨ç”»        QPropertyAnimation* translateAnimation = new QPropertyAnimation(parent, &quot;pos&quot;);        translateAnimation-&gt;setDuration(1000);        translateAnimation-&gt;setStartValue(QPoint(0, 0));        translateAnimation-&gt;setEndValue(QPoint(100, 100));                // å®šä¹‰å¹¶è¡ŒåŠ¨ç”»ç»„        QParallelAnimationGroup* animationGroup = new QParallelAnimationGroup();        animationGroup-&gt;addAnimation(flipAnimation);        animationGroup-&gt;addAnimation(translateAnimation);                // åˆ›å»ºçŠ¶æ€æœºåŠ¨ç”»        QAbstractTransition* runningTransition = runningState-&gt;addTransition(animationGroup);                // æ·»åŠ çŠ¶æ€æœºåˆ°å¯¹è±¡ä¸­        m_stateMachine-&gt;setInitialState(idleState);        m_stateMachine-&gt;start();    &#125;    signals:    void start();    void stop();    private:    QStateMachine* m_stateMachine;&#125;;\n\nåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºMyObjectçš„ç±»ï¼Œå¹¶å®ç°äº†ä¸€ä¸ªå°†çŠ¶æ€æœºå’ŒåŠ¨ç”»ç»“åˆä½¿ç”¨çš„ç¤ºä¾‹ã€‚è¯¥ç±»åŒ…å«ä¸€ä¸ªçŠ¶æ€æœºå’Œä¸¤ä¸ªä¿¡å·ï¼ˆstart()å’Œstop()ï¼‰ã€‚å½“å¯¹è±¡æ¥æ”¶åˆ°start()ä¿¡å·æ—¶ï¼ŒçŠ¶æ€æœºä¼šä»idleStateè½¬æ¢åˆ°runningStateï¼Œå¹¶åŒæ—¶æ’­æ”¾æ—‹è½¬å’Œå¹³ç§»åŠ¨ç”»ï¼›å½“æ¥æ”¶åˆ°stop()ä¿¡å·æ—¶ï¼Œåˆ™ä¼šä»runningStateè½¬æ¢å›idleStateã€‚\næ€»ç»“QtçŠ¶æ€æœºå’ŒQtåŠ¨ç”»æ˜¯ä¸¤ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…åˆ›å»ºæ›´åŠ æµç•…å’Œäº¤äº’å¼çš„ç”¨æˆ·ç•Œé¢ã€‚é€šè¿‡å°†å®ƒä»¬ç»“åˆä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ç®¡ç†å¯¹è±¡çš„çŠ¶æ€ï¼Œå¹¶åŒæ—¶æ’­æ”¾å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚\nåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†å¦‚ä½•åœ¨Qtä¸­å®ç°çŠ¶æ€æœºå’ŒåŠ¨ç”»ï¼Œä»¥åŠå¦‚ä½•å°†å®ƒä»¬ç»“åˆä½¿ç”¨ã€‚é€šè¿‡è¿™äº›ç¤ºä¾‹ä»£ç ï¼Œæ‚¨å¯ä»¥æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QtçŠ¶æ€æœºä¸QtåŠ¨ç”»çš„ç»“åˆä½¿ç”¨","date":"2023-05-13T05:46:53.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ab15d9005aa078928d65bb1db59a3d04","title":"QGraphicsViewå›¾å½¢è§†å›¾æ¡†æ¶è¯¦è§£","content":"QGraphicsViewå›¾å½¢è§†å›¾æ¡†æ¶è¯¦è§£ä»€ä¹ˆæ˜¯QGraphicsViewï¼ŸQGraphicsViewæ˜¯Qtä¸­çš„ä¸€ä¸ªå›¾å½¢è§†å›¾æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥æ˜¾ç¤ºå’Œç¼–è¾‘å¤§é‡çš„2Då›¾å½¢å…ƒç´ ã€‚QGraphicsViewå¯ä»¥ä¸QGraphicsSceneä¸€èµ·ä½¿ç”¨ï¼ŒQGraphicsSceneæ˜¯ä¸€ä¸ª2Då›¾å½¢åœºæ™¯ï¼Œå®ƒåŒ…å«äº†ä¸€ç»„å›¾å½¢é¡¹ï¼Œå¯ä»¥åœ¨å…¶ä¸­æ·»åŠ ã€åˆ é™¤ã€ç§»åŠ¨å’Œå˜æ¢å›¾å½¢é¡¹ã€‚QGraphicsViewæä¾›äº†ä¸€ç§äº¤äº’å¼çš„æ–¹å¼æ¥æ˜¾ç¤ºå’Œç¼–è¾‘QGraphicsSceneä¸­çš„å›¾å½¢é¡¹ï¼ŒåŒ…æ‹¬å¹³ç§»ã€ç¼©æ”¾ã€æ—‹è½¬ã€é€‰æ‹©ã€æ‹–æ‹½ç­‰æ“ä½œã€‚\nQGraphicsViewçš„åŸºæœ¬ç”¨æ³•ä½¿ç”¨QGraphicsViewéœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\n\nåˆ›å»ºä¸€ä¸ªQGraphicsSceneå¯¹è±¡ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ å›¾å½¢é¡¹ã€‚\nåˆ›å»ºä¸€ä¸ªQGraphicsViewå¯¹è±¡ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºQGraphicsSceneçš„è§†å›¾ã€‚\nå°†QGraphicsViewæ·»åŠ åˆ°çª—å£ä¸­ï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨QGraphicsViewæ˜¾ç¤ºä¸€ä¸ªçŸ©å½¢å’Œä¸€ä¸ªæ–‡æœ¬é¡¹ï¼š\n123456789101112131415#include &lt;QtWidgets&gt;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    QGraphicsScene scene;    QGraphicsRectItem *rectItem = scene.addRect(QRectF(0, 0, 100, 100), QPen(Qt::black), QBrush(Qt::red));    QGraphicsTextItem *textItem = scene.addText(&quot;Hello, QGraphicsView!&quot;);    QGraphicsView view(&amp;scene);    view.show();    return app.exec();&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªQGraphicsSceneå¯¹è±¡ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ äº†ä¸€ä¸ªçŸ©å½¢å’Œä¸€ä¸ªæ–‡æœ¬é¡¹ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªQGraphicsViewå¯¹è±¡ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºQGraphicsSceneçš„è§†å›¾ã€‚æœ€åï¼Œæˆ‘ä»¬å°†QGraphicsViewæ·»åŠ åˆ°çª—å£ä¸­ï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚\nQGraphicsViewçš„äº¤äº’æ“ä½œQGraphicsViewæä¾›äº†ä¸€ç³»åˆ—äº¤äº’æ“ä½œï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹QGraphicsSceneä¸­çš„å›¾å½¢é¡¹è¿›è¡Œæ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„äº¤äº’æ“ä½œï¼š\n\nå¹³ç§»ï¼šæŒ‰ä½é¼ æ ‡å·¦é”®å¹¶æ‹–åŠ¨è§†å›¾ï¼Œå¯ä»¥å¹³ç§»è§†å›¾ã€‚\nç¼©æ”¾ï¼šä½¿ç”¨é¼ æ ‡æ»šè½®å¯ä»¥ç¼©æ”¾è§†å›¾ã€‚\næ—‹è½¬ï¼šæŒ‰ä½é¼ æ ‡å³é”®å¹¶æ‹–åŠ¨è§†å›¾ï¼Œå¯ä»¥æ—‹è½¬è§†å›¾ã€‚\né€‰æ‹©ï¼šå•å‡»å›¾å½¢é¡¹å¯ä»¥é€‰æ‹©å®ƒï¼ŒæŒ‰ä½Ctrlé”®å¯ä»¥å¤šé€‰å›¾å½¢é¡¹ã€‚\næ‹–æ‹½ï¼šæŒ‰ä½é¼ æ ‡å·¦é”®å¹¶æ‹–åŠ¨å›¾å½¢é¡¹ï¼Œå¯ä»¥æ‹–æ‹½å®ƒã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨QGraphicsViewçš„äº¤äº’æ“ä½œï¼š\n123456789101112131415161718#include &lt;QtWidgets&gt;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    QGraphicsScene scene;    QGraphicsRectItem *rectItem = scene.addRect(QRectF(0, 0, 100, 100), QPen(Qt::black), QBrush(Qt::red));    QGraphicsTextItem *textItem = scene.addText(&quot;Hello, QGraphicsView!&quot;);    QGraphicsView view(&amp;scene);    view.setRenderHint(QPainter::Antialiasing);    view.setDragMode(QGraphicsView::ScrollHandDrag);    view.setInteractive(true);    view.show();    return app.exec();&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†QGraphicsViewçš„æ¸²æŸ“é€‰é¡¹ä¸ºæŠ—é”¯é½¿ï¼Œè®¾ç½®äº†æ‹–æ‹½æ¨¡å¼ä¸ºæ»šåŠ¨æ‰‹æŸ„æ‹–æ‹½ï¼Œå¹¶å°†äº¤äº’æ¨¡å¼è®¾ç½®ä¸ºå¯äº¤äº’ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨QGraphicsViewçš„äº¤äº’æ“ä½œæ¥æ“ä½œQGraphicsSceneä¸­çš„å›¾å½¢é¡¹äº†ã€‚\nQGraphicsViewçš„é«˜çº§ç”¨æ³•é™¤äº†åŸºæœ¬ç”¨æ³•å’Œäº¤äº’æ“ä½œå¤–ï¼ŒQGraphicsViewè¿˜æä¾›äº†ä¸€äº›é«˜çº§ç”¨æ³•ï¼ŒåŒ…æ‹¬ï¼š\n\nè‡ªå®šä¹‰è§†å›¾ï¼šå¯ä»¥ç»§æ‰¿QGraphicsViewç±»ï¼Œå¹¶é‡å†™å®ƒçš„ä¸€äº›å‡½æ•°æ¥å®ç°è‡ªå®šä¹‰çš„è§†å›¾ã€‚\nè‡ªå®šä¹‰å›¾å½¢é¡¹ï¼šå¯ä»¥ç»§æ‰¿QGraphicsItemç±»ï¼Œå¹¶é‡å†™å®ƒçš„ä¸€äº›å‡½æ•°æ¥å®ç°è‡ªå®šä¹‰çš„å›¾å½¢é¡¹ã€‚\nå›¾å½¢é¡¹ç»„åˆï¼šå¯ä»¥å°†å¤šä¸ªå›¾å½¢é¡¹ç»„åˆæˆä¸€ä¸ªç»„ï¼Œå¹¶å¯¹ç»„è¿›è¡Œæ“ä½œã€‚\nå›¾å½¢é¡¹åŠ¨ç”»ï¼šå¯ä»¥ä½¿ç”¨QPropertyAnimationç±»æ¥å®ç°å›¾å½¢é¡¹çš„åŠ¨ç”»æ•ˆæœã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨QGraphicsViewçš„é«˜çº§ç”¨æ³•ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#include &lt;QtWidgets&gt;class CustomView : public QGraphicsView&#123;public:    CustomView(QGraphicsScene *scene, QWidget *parent = nullptr) : QGraphicsView(scene, parent)    &#123;        setRenderHint(QPainter::Antialiasing);        setDragMode(QGraphicsView::ScrollHandDrag);        setInteractive(true);    &#125;protected:    void wheelEvent(QWheelEvent *event) override    &#123;        if (event-&gt;modifiers() &amp; Qt::ControlModifier) &#123;            double scaleFactor = 1.15;            if (event-&gt;delta() &gt; 0) &#123;                scale(scaleFactor, scaleFactor);            &#125; else &#123;                scale(1 / scaleFactor, 1 / scaleFactor);            &#125;            event-&gt;accept();        &#125; else &#123;            QGraphicsView::wheelEvent(event);        &#125;    &#125;&#125;;class CustomItem : public QGraphicsItem&#123;public:    CustomItem(QGraphicsItem *parent = nullptr) : QGraphicsItem(parent)    &#123;        setFlag(QGraphicsItem::ItemIsMovable);    &#125;    QRectF boundingRect() const override    &#123;        return QRectF(-50, -50, 100, 100);    &#125;    void paint(QPainter *painter, const QStyleOptionGraphicsItem *option, QWidget *widget = nullptr) override    &#123;        painter-&gt;setPen(Qt::black);        painter-&gt;setBrush(Qt::yellow);        painter-&gt;drawEllipse(-50, -50, 100, 100);    &#125;&#125;;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    QGraphicsScene scene;    CustomItem *item = new CustomItem;    scene.addItem(item);    CustomView view(&amp;scene);    view.show();    return app.exec();&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªCustomViewç±»ï¼Œç»§æ‰¿è‡ªQGraphicsViewç±»ï¼Œå¹¶é‡å†™äº†å®ƒçš„wheelEventå‡½æ•°ï¼Œå®ç°äº†ç¼©æ”¾è§†å›¾çš„åŠŸèƒ½ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªCustomItemç±»ï¼Œç»§æ‰¿è‡ªQGraphicsItemç±»ï¼Œå¹¶é‡å†™äº†å®ƒçš„boundingRectå’Œpaintå‡½æ•°ï¼Œå®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å›¾å½¢é¡¹ã€‚æœ€åï¼Œæˆ‘ä»¬å°†CustomItemæ·»åŠ åˆ°QGraphicsSceneä¸­ï¼Œå¹¶ä½¿ç”¨CustomViewæ¥æ˜¾ç¤ºQGraphicsSceneã€‚\né€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°QGraphicsViewçš„é«˜çº§ç”¨æ³•éå¸¸çµæ´»ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè‡ªå®šä¹‰å’Œæ‰©å±•ã€‚å¦‚æœæ‚¨æƒ³è¦è¿›ä¸€æ­¥äº†è§£QGraphicsViewçš„é«˜çº§ç”¨æ³•ï¼Œå¯ä»¥å‚è€ƒQtå®˜æ–¹æ–‡æ¡£æˆ–è€…ç›¸å…³ä¹¦ç±ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QGraphicsViewå›¾å½¢è§†å›¾æ¡†æ¶è¯¦è§£","date":"2023-05-13T03:00:12.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"dc668aa3f9d7827fe3cbf73af04ed4c5","title":"Qtå¤šè¿›ç¨‹é€šä¿¡","content":"Qtå¤šè¿›ç¨‹é€šä¿¡åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œå¤šè¿›ç¨‹é€šä¿¡ï¼ˆIPCï¼‰æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦å°†æ•°æ®ä»ä¸€ä¸ªè¿›ç¨‹ä¼ é€’åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œæˆ–è€…éœ€è¦åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´åŒæ­¥ä¿¡æ¯ã€‚Qt æä¾›äº†ä¸€äº›æ–¹æ³•æ¥å®ç°å¤šè¿›ç¨‹é€šä¿¡ï¼Œæœ¬æ–‡å°†ä»‹ç»å…¶ä¸­çš„ä¸€äº›ã€‚\nè¿›ç¨‹é—´é€šä¿¡æ–¹å¼Qtæä¾›äº†å‡ ç§è¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼ï¼Œå¸¸è§çš„æœ‰ï¼š\n1. ä¿¡å·å’Œæ§½ä¿¡å·å’Œæ§½æ˜¯Qtä¸­æœ€å¸¸ç”¨çš„é€šä¿¡æœºåˆ¶ï¼Œå®ƒå¯ä»¥åœ¨å•ä¸ªè¿›ç¨‹å†…å‘é€æ¶ˆæ¯å¹¶å“åº”æ¶ˆæ¯ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨ä¸åŒè¿›ç¨‹ä¹‹é—´ä½¿ç”¨ä¿¡å·å’Œæ§½è¿›è¡Œé€šä¿¡ï¼Œåˆ™éœ€è¦ä½¿ç”¨QSharedMemoryå’ŒQLocalServerç­‰ç±»æ¥å®ç°è·¨è¿›ç¨‹è®¿é—®å…±äº«å†…å­˜å’Œç›‘å¬å¥—æ¥å­—ã€‚\n2. å¥—æ¥å­—å¥—æ¥å­—æ˜¯Linuxå’ŒWindowsæ“ä½œç³»ç»Ÿä¸Šå®ç°è¿›ç¨‹é—´é€šä¿¡çš„æ ‡å‡†æ–¹æ³•ã€‚Qtæä¾›äº†QTcpSocketå’ŒQTcpServerä½œä¸ºåŸºäºTCP&#x2F;IPåè®®çš„å¥—æ¥å­—å®ç°ä»¥åŠQUdpSocketå’ŒQUdpServerä½œä¸ºUDPåè®®çš„å¥—æ¥å­—å®ç°ã€‚\n3. å…±äº«å†…å­˜å…±äº«å†…å­˜æ˜¯ä¸€ç§éå¸¸å¿«é€Ÿçš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚Qtæä¾›äº†QSharedMemoryç±»æ¥å®ç°å…±äº«å†…å­˜ã€‚\n4. æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡Qtæä¾›äº†QLocalSocketå’ŒQLocalServerç±»æ¥å®ç°æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ã€‚è¿™äº›ç±»ä½¿ç”¨å¥—æ¥å­—å®ç°ï¼Œä½†å®ƒä»¬å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå¿«é€Ÿåœ°è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸å¿…é€šè¿‡ç½‘ç»œã€‚\nå®ç°æ–¹å¼ä¸‹é¢å°†é’ˆå¯¹ä»¥ä¸Šå››ç§æ–¹å¼åˆ†åˆ«ä»‹ç»å¦‚ä½•åœ¨Qtä¸­å®ç°å¤šè¿›ç¨‹é€šä¿¡ã€‚\n1. ä¿¡å·å’Œæ§½ä¿¡å·å’Œæ§½æ˜¯ä¸€ç§éå¸¸æ–¹ä¾¿çš„æ–¹å¼æ¥è·¨çº¿ç¨‹æˆ–è¿›ç¨‹å‘é€æ¶ˆæ¯å¹¶å“åº”æ¶ˆæ¯ã€‚åœ¨Qtä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QSharedMemoryç±»æ¥å®ç°è·¨è¿›ç¨‹è®¿é—®å…±äº«å†…å­˜å’Œç›‘å¬å¥—æ¥å­—ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQSharedMemoryå¯¹è±¡ï¼Œå¹¶è°ƒç”¨create()æ–¹æ³•æ¥åˆ›å»ºå…±äº«å†…å­˜æ®µï¼š\n12QSharedMemory sharedMemory;sharedMemory.create(sizeof(int)); // åˆ›å»ºä¸€ä¸ªå¤§å°ä¸ºintçš„å…±äº«å†…å­˜æ®µ\n\nç„¶åï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®å†™å…¥å…±äº«å†…å­˜ï¼š\n123int value = 42;char *data = (char *)sharedMemory.data();memcpy(data, &amp;value, sizeof(value));\n\næœ€åï¼Œæˆ‘ä»¬éœ€è¦å‘é€ä¸€ä¸ªä¿¡å·ï¼Œä»¥ä¾¿å¦ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¯»å–å…±äº«å†…å­˜ä¸­çš„å€¼ï¼š\n1emit valueChanged(sharedMemory.nativeKey());\n\nåœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥åˆ°è¿™ä¸ªä¿¡å·å¹¶è¯»å–å…±äº«å†…å­˜ï¼š\n123456789101112void MyClass::onValueChanged(int key)&#123;    QSharedMemory sharedMemory;    sharedMemory.setNativeKey(key);    if (!sharedMemory.attach()) &#123;        // å¤„ç†å…±äº«å†…å­˜é™„åŠ å¤±è´¥çš„æƒ…å†µ    &#125;    int value;    char *data = (char *)sharedMemory.data();    memcpy(&amp;value, data, sizeof(value));    qDebug() &lt;&lt; &quot;Value: &quot; &lt;&lt; value;&#125;\n\n2. å¥—æ¥å­—è¦åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´ä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨QTcpSocketå’ŒQTcpServerï¼ˆæˆ–QUdpSocketå’ŒQUdpServerï¼‰ç±»ã€‚é¦–å…ˆï¼Œåœ¨æœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQTcpServerå¯¹è±¡å¹¶å°†å…¶ç»‘å®šåˆ°ä¸€ä¸ªç«¯å£ï¼š\n1234QTcpServer server;if (!server.listen(QHostAddress::Any, 1234)) &#123;    // å¤„ç†æœåŠ¡å™¨å¯åŠ¨å¤±è´¥çš„æƒ…å†µ&#125;\n\nç„¶åï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼š\n1234567891011121314void MyClass::onNewConnection()&#123;    QTcpSocket *socket = server.nextPendingConnection();    connect(socket, &amp;QTcpSocket::readyRead, this, &amp;MyClass::onReadyRead);&#125;åœ¨å®¢æˆ·ç«¯è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQTcpSocketå¯¹è±¡ï¼Œå¹¶è¿æ¥åˆ°æœåŠ¡å™¨ï¼š```cppQTcpSocket socket;socket.connectToHost(&quot;localhost&quot;, 1234);if (!socket.waitForConnected()) &#123;    // å¤„ç†è¿æ¥å¤±è´¥çš„æƒ…å†µ&#125;\n\nç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨write()æ–¹æ³•å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼š\n12QDataStream out(&amp;socket);out &lt;&lt; QString(&quot;Hello, server!&quot;);\n\næœ€åï¼ŒæœåŠ¡å™¨å¯ä»¥ä½¿ç”¨readyRead()ä¿¡å·æ¥è¯»å–æ•°æ®ï¼š\n12345678910void MyClass::onReadyRead()&#123;    QTcpSocket *socket = qobject_cast&lt;QTcpSocket *&gt;(sender());    if (socket) &#123;        QDataStream in(socket);        QString message;        in &gt;&gt; message;        qDebug() &lt;&lt; &quot;Received message: &quot; &lt;&lt; message;    &#125;&#125;\n\n3. å…±äº«å†…å­˜å…±äº«å†…å­˜æ˜¯ä¸€ç§éå¸¸å¿«é€Ÿçš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚Qtæä¾›äº†QSharedMemoryç±»æ¥å®ç°å…±äº«å†…å­˜ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQSharedMemoryå¯¹è±¡ï¼Œå¹¶è°ƒç”¨create()æ–¹æ³•æ¥åˆ›å»ºå…±äº«å†…å­˜æ®µï¼š\n12QSharedMemory sharedMemory;sharedMemory.create(sizeof(int)); // åˆ›å»ºä¸€ä¸ªå¤§å°ä¸ºintçš„å…±äº«å†…å­˜æ®µ\n\nç„¶åï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®å†™å…¥å…±äº«å†…å­˜ï¼š\n123int value = 42;char *data = (char *)sharedMemory.data();memcpy(data, &amp;value, sizeof(value));\n\næœ€åï¼Œæˆ‘ä»¬éœ€è¦å‘é€ä¸€ä¸ªä¿¡å·ï¼Œä»¥ä¾¿å¦ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¯»å–å…±äº«å†…å­˜ä¸­çš„å€¼ï¼š\n1emit valueChanged(sharedMemory.nativeKey());\n\nåœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥åˆ°è¿™ä¸ªä¿¡å·å¹¶è¯»å–å…±äº«å†…å­˜ï¼š\n123456789101112void MyClass::onValueChanged(int key)&#123;    QSharedMemory sharedMemory;    sharedMemory.setNativeKey(key);    if (!sharedMemory.attach()) &#123;        // å¤„ç†å…±äº«å†…å­˜é™„åŠ å¤±è´¥çš„æƒ…å†µ    &#125;    int value;    char *data = (char *)sharedMemory.data();    memcpy(&amp;value, data, sizeof(value));    qDebug() &lt;&lt; &quot;Value: &quot; &lt;&lt; value;&#125;\n\n4. æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡Qtæä¾›äº†QLocalSocketå’ŒQLocalServerç±»æ¥å®ç°æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ã€‚è¿™äº›ç±»ä½¿ç”¨å¥—æ¥å­—å®ç°ï¼Œä½†å®ƒä»¬å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå¿«é€Ÿåœ°è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸å¿…é€šè¿‡ç½‘ç»œã€‚\né¦–å…ˆï¼Œåœ¨æœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQLocalServerå¯¹è±¡å¹¶å°†å…¶ç»‘å®šåˆ°ä¸€ä¸ªåœ°å€ï¼š\n12QLocalServer server;server.listen(&quot;myserver&quot;);\n\nç„¶åï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼š\n12345void MyClass::onNewConnection()&#123;    QLocalSocket *socket = server.nextPendingConnection();    connect(socket, &amp;QLocalSocket::readyRead, this, &amp;MyClass::onReadyRead);&#125;\n\nåœ¨å®¢æˆ·ç«¯è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQLocalSocketå¯¹è±¡ï¼Œå¹¶è¿æ¥åˆ°æœåŠ¡å™¨ï¼š\n12345QLocalSocket socket;socket.connectToServer(&quot;myserver&quot;);if (!socket.waitForConnected()) &#123;    // å¤„ç†è¿æ¥å¤±è´¥çš„æƒ…å†µ&#125;\n\nç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨write()æ–¹æ³•å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼š\n12QDataStream out(&amp;socket);out &lt;&lt; QString(&quot;Hello, server!&quot;);\n\næœ€åï¼ŒæœåŠ¡å™¨å¯ä»¥ä½¿ç”¨readyRead()ä¿¡å·æ¥è¯»å–æ•°æ®ï¼š\n12345678910void MyClass::onReadyRead()&#123;    QLocalSocket *socket = qobject_cast&lt;QLocalSocket *&gt;(sender());    if (socket) &#123;        QDataStream in(socket);        QString message;        in &gt;&gt; message;        qDebug() &lt;&lt; &quot;Received message: &quot; &lt;&lt; message;    &#125;&#125;\n\næ€»ç»“åœ¨Qtä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥å®ç°å¤šè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œå…·ä½“è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚æ— è®ºé‡‡ç”¨å“ªç§æ–¹å¼ï¼ŒQtéƒ½æä¾›äº†ä¸°å¯Œçš„ç±»å’Œæ–¹æ³•æ¥å¸®åŠ©æˆ‘ä»¬å®ç°é«˜æ•ˆã€ç¨³å®šçš„è¿›ç¨‹é—´é€šä¿¡ã€‚\nä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹ï¼Œå¸Œæœ›èƒ½å¯¹ä½ åœ¨Qtä¸­å®ç°å¤šè¿›ç¨‹é€šä¿¡æœ‰æ‰€å¸®åŠ©ï¼## é™„åŠ ä»£ç ç¤ºä¾‹\nä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨å…±äº«å†…å­˜å®ç°è¿›ç¨‹é—´é€šä¿¡çš„ç®€å•ä»£ç ç¤ºä¾‹ï¼š\n12345678910111213141516171819// sender.cpp#include &lt;QCoreApplication&gt;#include &lt;QSharedMemory&gt;#include &lt;QDebug&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    QSharedMemory sharedMemory;    sharedMemory.create(sizeof(int));    int value = 42;    char *data = (char *)sharedMemory.data();    memcpy(data, &amp;value, sizeof(value));    emit valueChanged(sharedMemory.nativeKey());    return a.exec();&#125;\n\n1234567891011121314151617181920212223// receiver.cpp#include &lt;QCoreApplication&gt;#include &lt;QSharedMemory&gt;#include &lt;QDebug&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    QSharedMemory sharedMemory;    sharedMemory.setNativeKey(1234); // å‡å®šsenderå·²ç»åˆ›å»ºäº†å…±äº«å†…å­˜ï¼Œkeyä¸º1234    if (!sharedMemory.attach()) &#123;        qDebug() &lt;&lt; &quot;Failed to attach to shared memory.&quot;;        return -1;    &#125;    int value;    char *data = (char *)sharedMemory.data();    memcpy(&amp;value, data, sizeof(value));    qDebug() &lt;&lt; &quot;Received value: &quot; &lt;&lt; value;    return a.exec();&#125;\n\nåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œsender.cppå°†ä¸€ä¸ªæ•´æ•°å€¼å†™å…¥å…±äº«å†…å­˜å¹¶å‘å‡ºä¸€ä¸ªä¿¡å·ã€‚receiver.cppè¿æ¥åˆ°è¿™ä¸ªä¿¡å·å¹¶è¯»å–å…±äº«å†…å­˜ä¸­çš„å€¼ã€‚\nå‚è€ƒèµ„æ–™\nQt Documentation: Interprocess Communication in Qt\nQt Forum: Inter-process communication through signals and slots\nTowards Data Science: A Comprehensive Guide to Shared Memory in C++\n\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qtå¤šè¿›ç¨‹é€šä¿¡","date":"2023-05-13T03:00:12.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"bfa7a2b6ebbeca6f6d16afb84bd5fd2a","title":"UDPçš„åŸºç¡€çŸ¥è¯†-å•æ’­ã€ç»„æ’­å’Œå¹¿æ’­","content":"UDPçš„åŸºç¡€çŸ¥è¯†UDPï¼ˆUser Datagram Protocolï¼‰æ˜¯ä¸€ç§æ— è¿æ¥åè®®ï¼Œå®ƒå°†æ•°æ®æŠ¥æ–‡å‘é€å‡ºå»ï¼Œç”±æ¥æ”¶ç«¯æ¥è¿›è¡Œå¤„ç†ã€‚UDPä¸æä¾›å¯é æ€§ï¼Œä¹Ÿä¸ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œé¡ºåºã€‚ä½†æ˜¯ï¼ŒUDPå…·æœ‰è¾ƒä½çš„å»¶è¿Ÿå’Œè¾ƒå°‘çš„å¼€é”€ã€‚åœ¨ç½‘ç»œæ¸¸æˆã€è§†é¢‘æµä¼ è¾“ã€DNSç­‰åº”ç”¨ä¸­å¹¿æ³›ä½¿ç”¨ã€‚\nUDPä½¿ç”¨IPåè®®æ¥ä¼ è¾“æ•°æ®ï¼Œæ¯ä¸ªUDPæ•°æ®åŒ…è¢«å°è£…åœ¨ä¸€ä¸ªIPæ•°æ®åŒ…ä¸­å¹¶é€šè¿‡ç½‘ç»œçš„å…¶ä»–èŠ‚ç‚¹è¿›è¡Œè·¯ç”±ã€‚UDPä½¿ç”¨ç«¯å£æ¥æ ‡è¯†ä¸åŒåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶ä¸ºæ¯ä¸ªUDPæ•°æ®åŒ…æä¾›æºç«¯å£å’Œç›®çš„ç«¯å£ã€‚æºç«¯å£å’Œç›®æ ‡ç«¯å£çš„ç»“åˆå½¢æˆäº†ä¸€ä¸ªå¥—æ¥å­—ï¼ˆsocketï¼‰ï¼Œå¥—æ¥å­—å¯ä»¥å”¯ä¸€æ ‡è¯†ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´çš„å•ç‹¬çš„ä¼šè¯ã€‚\nå•æ’­å•æ’­ï¼ˆUnicastï¼‰ æ˜¯ä¸€å¯¹ä¸€é€šä¿¡æ¨¡å¼ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªå‘é€è€…å‘ä¸€ä¸ªæ¥æ”¶è€…å‘é€æ•°æ®åŒ…ã€‚å•æ’­é€šè¿‡ä»¥ä¸‹ç¨‹åºç¤ºä¾‹å®ç°ï¼š\n12345678910111213141516171819202122232425262728#include &lt;iostream&gt;#include &lt;sys/socket.h&gt;#include &lt;netinet/in.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;cstring&gt;using namespace std;int main() &#123;    // åˆ›å»ºä¸€ä¸ªIPv4 UDPå¥—æ¥å­—    int sockfd = socket(AF_INET, SOCK_DGRAM, 0);    // æ„é€ æœåŠ¡å™¨åœ°å€    struct sockaddr_in server_addr;    memset(&amp;server_addr, 0, sizeof(server_addr));    server_addr.sin_family = AF_INET;    server_addr.sin_port = htons(8888);    server_addr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);    // å‘é€æ•°æ®    char buf[] = &quot;Hello, this is a unicast message!&quot;;    sendto(sockfd, buf, strlen(buf), 0, (struct sockaddr *)&amp;server_addr, sizeof(server_addr));    // å…³é—­å¥—æ¥å­—    close(sockfd);    return 0;&#125;\n\nåœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨socketå‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªIPv4 UDPå¥—æ¥å­—ï¼Œå¹¶ä½¿ç”¨sendtoå‡½æ•°å‘æŒ‡å®šçš„æœåŠ¡å™¨IPåœ°å€å’Œç«¯å£å‘é€æ•°æ®åŒ…ã€‚\nç»„æ’­ç»„æ’­æ˜¯ä¸€ç§ç”¨äºåœ¨ç½‘ç»œä¸­å‘å¤šä¸ªæ¥æ”¶æ–¹åŒæ—¶ä¼ è¾“æ•°æ®çš„é€šä¿¡æ–¹å¼ã€‚åœ¨UDPåè®®ä¸­ï¼Œç»„æ’­ä½¿ç”¨ç‰¹å®šçš„IPåœ°å€èŒƒå›´ï¼ˆ224.0.0.0 - 239.255.255.255ï¼‰è¿›è¡Œæ ‡è¯†ã€‚å‘é€æ–¹é€šè¿‡å°†æ•°æ®åŒ…å‘é€åˆ°ç»„æ’­åœ°å€ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„ç›®æ ‡åœ°å€ï¼Œå¯ä»¥å°†æ•°æ®ä¼ è¾“ç»™ä¸€ç»„æ¥æ”¶æ–¹ã€‚\nç»„æ’­éœ€è¦ä½¿ç”¨ä¸“é—¨çš„åè®®æ”¯æŒï¼Œå¦‚IGMPï¼ˆInternet Group Management Protocolï¼‰ï¼Œä»¥ä¾¿ç¡®å®šå“ªäº›æ¥æ”¶æ–¹å¯¹è¯¥ç»„æ’­æ„Ÿå…´è¶£ï¼Œå¹¶å°†æ•°æ®åŒ…è·¯ç”±åˆ°æ­£ç¡®çš„æ¥æ”¶æ–¹ã€‚\nåœ¨C++ä¸­ä½¿ç”¨UDPè¿›è¡Œç»„æ’­çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;cstdlib&gt;#include &lt;arpa/inet.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;#include &lt;netinet/in.h&gt;#include &lt;unistd.h&gt;#define PORT 8888#define GROUP &quot;239.0.0.1&quot;int main()&#123;    struct sockaddr_in addr;    int sock, cnt;    char message[] = &quot;Hello, multicast!&quot;;    sock = socket(AF_INET, SOCK_DGRAM, 0);    if(sock &lt; 0)    &#123;        perror(&quot;socket&quot;);        exit(EXIT_FAILURE);    &#125;    memset(&amp;addr, 0, sizeof(addr));    addr.sin_family = AF_INET;    addr.sin_addr.s_addr = inet_addr(GROUP);    addr.sin_port = htons(PORT);    while(1)    &#123;        cnt = sendto(sock, message, sizeof(message), 0, (struct sockaddr *)&amp;addr, sizeof(addr));        if(cnt &lt; 0)        &#123;            perror(&quot;sendto&quot;);            exit(EXIT_FAILURE);        &#125;        sleep(1);    &#125;    close(sock);    return 0;&#125;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨socket()å‡½æ•°åˆ›å»ºä¸€ä¸ªUDPå¥—æ¥å­—å¹¶æŒ‡å®šç»„æ’­çš„IPåœ°å€å’Œç«¯å£å·ã€‚å‘é€æ–¹é€šè¿‡sendto()å‡½æ•°å°†æ•°æ®åŒ…å‘é€åˆ°ç»„æ’­åœ°å€ï¼Œå¹¶ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”é‡å¤æ‰§è¡Œæ­¤æ“ä½œã€‚\nå¹¿æ’­å¹¿æ’­æ˜¯å¦ä¸€ç§ç”¨äºå‘ä¸€ç»„æ¥æ”¶æ–¹ä¼ è¾“æ•°æ®çš„é€šä¿¡æ–¹å¼ï¼Œåœ¨ç½‘ç»œä¸­å‘åŒä¸€å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºå‘é€æ•°æ®åŒ…ã€‚åœ¨IPv4ç½‘ç»œä¸­ï¼Œå¹¿æ’­ä½¿ç”¨ç‰¹æ®Šçš„IPåœ°å€ï¼ˆ255.255.255.255ï¼‰è¿›è¡Œæ ‡è¯†ã€‚\nåœ¨C++ä¸­ä½¿ç”¨UDPè¿›è¡Œå¹¿æ’­çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;cstdlib&gt;#include &lt;arpa/inet.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;#include &lt;netinet/in.h&gt;#include &lt;unistd.h&gt;#define PORT 8888#define BROADCAST &quot;255.255.255.255&quot;int main()&#123;    struct sockaddr_in addr;    int sock, cnt;    char message[] = &quot;Hello, broadcast!&quot;;    sock = socket(AF_INET, SOCK_DGRAM, 0);    if(sock &lt; 0)    &#123;        perror(&quot;socket&quot;);        exit(EXIT_FAILURE);    &#125;    memset(&amp;addr, 0, sizeof(addr));    addr.sin_family = AF_INET;    addr.sin_addr.s_addr = inet_addr(BROADCAST);    addr.sin_port = htons(PORT);    int optval = 1;    setsockopt(sock, SOL_SOCKET, SO_BROADCAST, &amp;optval, sizeof(optval));    while(1)    &#123;        cnt = sendto(sock, message, sizeof(message), 0, (struct sockaddr *)&amp;addr, sizeof(addr));        if(cnt &lt; 0)        &#123;            perror(&quot;sendto&quot;);            exit(EXIT_FAILURE);        &#125;        sleep(1);    &#125;    close(sock);    return 0;&#125;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨socket()å‡½æ•°åˆ›å»ºä¸€ä¸ªUDPå¥—æ¥å­—å¹¶æŒ‡å®šå¹¿æ’­çš„IPåœ°å€å’Œç«¯å£å·ã€‚å‘é€æ–¹é€šè¿‡setsockopt()å‡½æ•°å°†SO_BROADCASTé€‰é¡¹è®¾ç½®ä¸ºå¯ç”¨å¹¿æ’­åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨sendto()å‡½æ•°å°†æ•°æ®åŒ…å‘é€åˆ°å¹¿æ’­åœ°å€ï¼Œå¹¶ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”é‡å¤æ‰§è¡Œæ­¤æ“ä½œã€‚\næ€»ç»“å•æ’­ã€ç»„æ’­å’Œå¹¿æ’­éƒ½æ˜¯UDPåè®®ä¸­å¸¸ç”¨çš„é€šä¿¡æ–¹å¼ã€‚å•æ’­é€‚ç”¨äºç‚¹å¯¹ç‚¹çš„é€šä¿¡ï¼Œç»„æ’­å’Œå¹¿æ’­é€‚ç”¨äºå‘å¤šä¸ªæ¥æ”¶æ–¹ä¼ è¾“æ•°æ®ã€‚å…¶ä¸­ç»„æ’­éœ€è¦ä½¿ç”¨IGMPåè®®æ”¯æŒï¼Œå¹¶ä½¿ç”¨ç‰¹å®šçš„IPåœ°å€èŒƒå›´è¿›è¡Œæ ‡è¯†ï¼›å¹¿æ’­éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„IPåœ°å€ï¼ˆ255.255.255.255ï¼‰è¿›è¡Œæ ‡è¯†ï¼Œå¹¶å¯ç”¨SO_BROADCASTé€‰é¡¹ã€‚\nåœ¨C++ä¸­ï¼Œå¯ä»¥ä½¿ç”¨socket()å‡½æ•°åˆ›å»ºUDPå¥—æ¥å­—ï¼Œå¹¶ä½¿ç”¨sendto()å‡½æ•°å°†æ•°æ®åŒ…å‘é€åˆ°ç›®æ ‡åœ°å€ã€ç»„æ’­åœ°å€æˆ–å¹¿æ’­åœ°å€ï¼Œä»¥å®ç°å•æ’­ã€ç»„æ’­å’Œå¹¿æ’­åŠŸèƒ½ã€‚\n","slug":"C++/UDPçš„åŸºç¡€çŸ¥è¯†-å•æ’­ã€ç»„æ’­å’Œå¹¿æ’­","date":"2023-05-12T05:52:41.000Z","categories_index":"C++åŸºç¡€","tags_index":"C++,ç½‘ç»œé€šä¿¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"8f33bd7fed458691a6f6e03ce02f258a","title":"vs2017ç¼–è¯‘FFmpeg","content":"ç¼–è¯‘ç¯å¢ƒ\næ“ä½œç³»ç»Ÿ: Window10 64ä½\néœ€è¦ä¸‹è½½çš„æ–‡ä»¶\nvs2017\nMSYS2\n\n\n\nç¼–è¯‘æ­¥éª¤å®‰è£…vs2017\nç½‘ç»œä¸Šå¾ˆå¤šå®‰è£…æ•™ç¨‹ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè‡ªè¡Œå®‰è£…\n\n\nå®‰è£…MSYS2\nMSYS2å®˜ç½‘https://www.msys2.org/ä¸‹è½½ä¸Šå›¾å®‰è£…åŒ…ï¼Œé»˜è®¤å®‰è£…å³å¯ï¼Œå®‰è£…è·¯å¾„C:\\msys64\n\nå¦‚ä½•å¯åŠ¨ msys2 ï¼Ÿæ‰“å¼€WinCMD è¿›å…¥ C:\\msys64 ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ è¿›å…¥ mingw32 æˆ–è€… mingw64ä½ç¯å¢ƒã€‚\n\n.\\msys2_shell.cmd -mingw32\n.\\msys2_shell.cmd -mingw64msys2 å®é™…ä¸Šæ˜¯ä¸€ä¸ª åœ¨ Windows ç³»ç»Ÿæ¨¡æ‹Ÿ Linux çš„ä¸€ä¸ªå‘½ä»¤çª—å£ç¨‹åº\n\n\n\n\nmsvc+MSYS2ç¼–è¯‘ffmpegå‡†å¤‡ç¯å¢ƒ\nä¿®æ”¹C:\\msys64\\msys2_shell.cmdæ–‡ä»¶å°†rem set MSYS2_PATH_TYPE&#x3D;inheritå‰é¢çš„remå»é™¤\n\næ‰§è¡Œvs2017å‘½ä»¤è¡Œå·¥å…·\n\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨msys2æ¨¡æ‹Ÿmingw64ç¯å¢ƒ\n12cd c:\\msys64\\.\\msys2_shell.cmd -mingw64\n\n\næµ‹è¯•ç¯å¢ƒ\n1which cl.exe\nåœ¨msys2å‘½ä»¤è¡Œçª—å£è¾“å…¥ä¸Šæ–¹å‘½ä»¤ï¼Œè¾“å‡ºå¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ\n\nå®‰è£…ä¾èµ–è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…ä¾èµ–ç»„ä»¶\n1pacman -S diffutils make pkg-config yasm\n\n\n\nå¼€å§‹ç¼–è¯‘\nä¸‹è½½ffmpegæºç ffmpegå¼€æºåœ°å€ï¼šhttps://github.com/FFmpeg/FFmpegå¯ä»¥ä¸‹è½½æœ€æ–°ä»£ç \n\næ¼”ç¤ºä»£ç ç›®å½•ï¼šE:\\CODE\\gitee_code\\FFmpeg\\src\\ffmpeg\n\nä¿®æ”¹æºç ä¿®æ”¹fftools\\ffprobe.cã€fftools\\opt_common.cä¸¤ä¸ªæ–‡ä»¶å°†åŒ…å« CC_IDENT çš„è¡Œæ³¨é‡Šæ‰ï¼Œä¸å½±å“åŠŸèƒ½ï¼Œåªæ˜¯æ‰“å°è¾“å‡ºç¼–ç æœ‰ç‚¹é—®é¢˜ï¼Œæ³¨é‡Šæ‰å³å¯\n\nè¿›å…¥ç›®å½•\n1cd E:\\CODE\\gitee_code\\FFmpeg\\src\\ffmpeg\nåˆ›å»ºç¼–è¯‘è¾“å‡ºç›®å½•ï¼šE:&#x2F;CODE&#x2F;gitee_code&#x2F;FFmpeg&#x2F;build64&#x2F;ffmepg-4.4-msvc\n\nå¼€å§‹ç¼–è¯‘\n12345678910111213./configure \\--prefix=E:/CODE/gitee_code/FFmpeg/build64/ffmepg-4.4-msvc \\--enable-gpl \\--enable-nonfree \\--enable-shared \\--disable-optimizations \\--disable-asm \\--disable-stripping \\--toolchain=msvcmake -j8# è¦æ‰§è¡Œ make installmake install\n\né¡ºåˆ©çš„è¯ï¼Œæ‰§è¡Œå®Œä»¥ä¸Šå‘½ä»¤ï¼Œä¾¿å¯ç¼–è¯‘å®Œæˆï¼Œåœ¨E:&#x2F;CODE&#x2F;gitee_code&#x2F;FFmpeg&#x2F;build64&#x2F;ffmepg-4.4-msvcç›®å½•å¯ä»¥çœ‹è§è¾“å‡ºæ–‡ä»¶\n\næµ‹è¯•\nffmpeg.exe -i http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8 -vcodec copy -f mp4 1.mp4 &#x2F;&#x2F; è‹¹æœæµ‹è¯•æºï¼Œæ­¤å‘½ä»¤ä¸ºå°†åœ¨çº¿è§†é¢‘æºä¿å­˜ä¸ºmp4æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640ffmpeg version N-108922-ge27bef9a56 Copyright (c) 2000-2022 the FFmpeg developers  built with gcc 9 (Ubuntu 9.4.0-1ubuntu1~20.04.1)  configuration: --enable-shared --enable-nonfree --enable-gpl --enable-pthreads --enable-libx264 --enable-libx265 --prefix=../ffmpeg_output  libavutil      57. 40.100 / 57. 40.100  libavcodec     59. 51.101 / 59. 51.101  libavformat    59. 34.101 / 59. 34.101  libavdevice    59.  8.101 / 59.  8.101  libavfilter     8. 49.101 /  8. 49.101  libswscale      6.  8.112 /  6.  8.112  libswresample   4.  9.100 /  4.  9.100  libpostproc    56.  7.100 / 56.  7.100[hls @ 0x563459342040] Skip (&#x27;#EXT-X-VERSION:3&#x27;)[hls @ 0x563459342040] Opening &#x27;http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/fileSequence0.ts&#x27; for reading[hls @ 0x563459342040] Opening &#x27;http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/fileSequence1.ts&#x27; for reading[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=903000, dts=906000, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=903000, dts=906000, size=1078[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=909000, dts=912000, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=909000, dts=912000, size=1353[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=915000, dts=918000, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=915000, dts=918000, size=1260[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=921000, dts=924000, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=921000, dts=924000, size=1211[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=927000, dts=930150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=927000, dts=930150, size=1271[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=933150, dts=936150, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=933150, dts=936150, size=1059[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=939150, dts=942150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=939150, dts=942150, size=1381[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=945150, dts=948150, size=709[hls @ 0x563459342040] Invalid timestamps stream=0, pts=945150, dts=948150, size=829[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=951150, dts=954150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=951150, dts=954150, size=1303[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=957150, dts=960150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=957150, dts=960150, size=1207Input #0, hls, from &#x27;http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8&#x27;:  Duration: 00:30:00.00, start: 9.904222, bitrate: 0 kb/s  Program 0     Metadata:      variant_bitrate : 0  Stream #0:0: Video: h264 (Main) ([27][0][0][0] / 0x001B), yuv420p(tv, smpte170m/smpte170m/bt709), 640x480, Closed Captions, 29.92 fps, 29.92 tbr, 90k tbn    Metadata:      variant_bitrate : 0  Stream #0:1: Audio: aac (LC) ([15][0][0][0] / 0x000F), 22050 Hz, stereo, fltp    Metadata:      variant_bitrate : 0Stream mapping:  Stream #0:0 -&gt; #0:0 (copy)  Stream #0:1 -&gt; #0:1 (aac (native) -&gt; aac (native))Press [q] to stop, [?] for helpOutput #0, mp4, to &#x27;1.mp4&#x27;:  Metadata:    encoder         : Lavf59.34.101  Stream #0:0: Video: h264 (Main) (avc1 / 0x31637661), yuv420p(tv, smpte170m/smpte170m/bt709), 640x480, q=2-31, 29.92 fps, 29.92 tbr, 90k tbn    Metadata:      variant_bitrate : 0  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 22050 Hz, stereo, fltp, 128 kb/s    Metadata:      variant_bitrate : 0      encoder         : Lavc59.51.101 aac[mp4 @ 0x563459363200] Invalid DTS: 14620 PTS: 11620 in output stream 0:0, replacing by guess    [mp4 @ 0x563459363200] Invalid DTS: 20620 PTS: 17620 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 26620 PTS: 23620 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 32620 PTS: 29620 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 38770 PTS: 35620 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 44770 PTS: 41770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=963150, dts=966150, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=963150, dts=966150, size=898[mp4 @ 0x563459363200] Invalid DTS: 50770 PTS: 47770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 56770 PTS: 53770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 62770 PTS: 59770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 68770 PTS: 65770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 74770 PTS: 71770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=975150, dts=978150, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=975150, dts=978150, size=1192[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=981150, dts=984150, size=1445[mp4 @ 0x563459363200] Invalid DTS: 86770 PTS: 83770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=981150, dts=984150, size=1270[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=987150, dts=990150, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=987150, dts=990150, size=1215[mp4 @ 0x563459363200] Invalid DTS: 92770 PTS: 89770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=993150, dts=996150, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=993150, dts=996150, size=1092[mp4 @ 0x563459363200] Invalid DTS: 98770 PTS: 95770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 104770 PTS: 101770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=999150, dts=1002150, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=999150, dts=1002150, size=1436[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1005150, dts=1008150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1005150, dts=1008150, size=1291[mp4 @ 0x563459363200] Invalid DTS: 110770 PTS: 107770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1011150, dts=1014150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1011150, dts=1014150, size=1214[mp4 @ 0x563459363200] Invalid DTS: 116770 PTS: 113770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1017150, dts=1020150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1017150, dts=1020150, size=1274[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1023150, dts=1026150, size=1077[mp4 @ 0x563459363200] Invalid DTS: 122770 PTS: 119770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1023150, dts=1026150, size=1025[mp4 @ 0x563459363200] Invalid DTS: 128770 PTS: 125770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 134770 PTS: 131770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1029150, dts=1032150, size=1629[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1029150, dts=1032150, size=1468[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1035150, dts=1038150, size=893[mp4 @ 0x563459363200] Invalid DTS: 140770 PTS: 137770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1035150, dts=1038150, size=921[mp4 @ 0x563459363200] Invalid DTS: 146770 PTS: 143770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1047150, dts=1050150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1047150, dts=1050150, size=1208[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1053150, dts=1056150, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1053150, dts=1056150, size=951[mp4 @ 0x563459363200] Invalid DTS: 158770 PTS: 155770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1059150, dts=1062150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1059150, dts=1062150, size=1222[mp4 @ 0x563459363200] Invalid DTS: 164770 PTS: 161770 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 170770 PTS: 167770 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1065150, dts=1068150, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1065150, dts=1068150, size=1155[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1071150, dts=1074150, size=1445[mp4 @ 0x563459363200] Invalid DTS: 176770 PTS: 173770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1071150, dts=1074150, size=1289[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1077150, dts=1080300, size=1077[mp4 @ 0x563459363200] Invalid DTS: 182770 PTS: 179770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1077150, dts=1080300, size=1100[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1083300, dts=1086300, size=893[mp4 @ 0x563459363200] Invalid DTS: 188920 PTS: 185770 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1083300, dts=1086300, size=1074[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1089300, dts=1092300, size=1261[mp4 @ 0x563459363200] Invalid DTS: 194920 PTS: 191920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1089300, dts=1092300, size=1360[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1095300, dts=1098300, size=1261[mp4 @ 0x563459363200] Invalid DTS: 200920 PTS: 197920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1095300, dts=1098300, size=1257[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1101300, dts=1104300, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1101300, dts=1104300, size=1226[mp4 @ 0x563459363200] Invalid DTS: 206920 PTS: 203920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 212920 PTS: 209920 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1107300, dts=1110300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1107300, dts=1110300, size=1263[mp4 @ 0x563459363200] Invalid DTS: 218920 PTS: 215920 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1119300, dts=1122300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1119300, dts=1122300, size=1317[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1125300, dts=1128300, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1125300, dts=1128300, size=820[mp4 @ 0x563459363200] Invalid DTS: 230920 PTS: 227920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 236920 PTS: 233920 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1131300, dts=1134300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1131300, dts=1134300, size=1325[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1137300, dts=1140300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1137300, dts=1140300, size=1173[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1143300, dts=1146300, size=893[mp4 @ 0x563459363200] Invalid DTS: 242920 PTS: 239920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 248920 PTS: 245920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1143300, dts=1146300, size=925[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1149300, dts=1152300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1149300, dts=1152300, size=1160[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1155300, dts=1158300, size=1077[mp4 @ 0x563459363200] Invalid DTS: 254920 PTS: 251920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 260920 PTS: 257920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1155300, dts=1158300, size=1109[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1161300, dts=1164300, size=1261[mp4 @ 0x563459363200] Invalid DTS: 266920 PTS: 263920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1161300, dts=1164300, size=1275[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1167300, dts=1170300, size=1077[mp4 @ 0x563459363200] Invalid DTS: 272920 PTS: 269920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1167300, dts=1170300, size=1169[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1173300, dts=1176300, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1173300, dts=1176300, size=1044[mp4 @ 0x563459363200] Invalid DTS: 278920 PTS: 275920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 284920 PTS: 281920 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1179300, dts=1182300, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1179300, dts=1182300, size=1410[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1191300, dts=1194300, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1191300, dts=1194300, size=1140[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1197300, dts=1200300, size=1261[mp4 @ 0x563459363200] Invalid DTS: 290920 PTS: 287920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 302920 PTS: 299920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1197300, dts=1200300, size=1239[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1203300, dts=1206300, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1203300, dts=1206300, size=1004[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1209300, dts=1212300, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1209300, dts=1212300, size=1383[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1215300, dts=1218300, size=893[mp4 @ 0x563459363200] Invalid DTS: 308920 PTS: 305920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1215300, dts=1218300, size=894[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1221300, dts=1224300, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1221300, dts=1224300, size=1317[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1227300, dts=1230450, size=1077[mp4 @ 0x563459363200] Invalid DTS: 314920 PTS: 311920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 320920 PTS: 317920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 326920 PTS: 323920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 332920 PTS: 329920 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1227300, dts=1230450, size=1221[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1233450, dts=1236450, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1233450, dts=1236450, size=948[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1239450, dts=1242450, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1239450, dts=1242450, size=1218[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1245450, dts=1248450, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1245450, dts=1248450, size=1146[mp4 @ 0x563459363200] Invalid DTS: 339070 PTS: 335920 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 345070 PTS: 342070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 351070 PTS: 348070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 357070 PTS: 354070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1251450, dts=1254450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1251450, dts=1254450, size=1297[mp4 @ 0x563459363200] Invalid DTS: 363070 PTS: 360070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1263450, dts=1266450, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1263450, dts=1266450, size=1076[mp4 @ 0x563459363200] Invalid DTS: 375070 PTS: 372070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1269450, dts=1272450, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1269450, dts=1272450, size=1348[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1275450, dts=1278450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1275450, dts=1278450, size=1260[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1281450, dts=1284450, size=1077[mp4 @ 0x563459363200] Invalid DTS: 381070 PTS: 378070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1281450, dts=1284450, size=1214[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1287450, dts=1290450, size=1261[mp4 @ 0x563459363200] Invalid DTS: 387070 PTS: 384070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1287450, dts=1290450, size=1284[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1293450, dts=1296450, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1293450, dts=1296450, size=1053[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1299450, dts=1302450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1299450, dts=1302450, size=1426[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1305450, dts=1308450, size=709[mp4 @ 0x563459363200] Invalid DTS: 393070 PTS: 390070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1305450, dts=1308450, size=829[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1311450, dts=1314450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1311450, dts=1314450, size=1281[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1317450, dts=1320450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1317450, dts=1320450, size=1207[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1323450, dts=1326450, size=893[mp4 @ 0x563459363200] Invalid DTS: 399070 PTS: 396070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 405070 PTS: 402070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1323450, dts=1326450, size=903[mp4 @ 0x563459363200] Invalid DTS: 411070 PTS: 408070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 417070 PTS: 414070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 423070 PTS: 420070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 429070 PTS: 426070 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 435070 PTS: 432070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1335450, dts=1338450, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1335450, dts=1338450, size=1194[mp4 @ 0x563459363200] Invalid DTS: 447070 PTS: 444070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1341450, dts=1344450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1341450, dts=1344450, size=1356[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1347450, dts=1350450, size=1261[mp4 @ 0x563459363200] Invalid DTS: 453070 PTS: 450070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1347450, dts=1350450, size=1200[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1353450, dts=1356450, size=1077[mp4 @ 0x563459363200] Invalid DTS: 459070 PTS: 456070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1353450, dts=1356450, size=1095[mp4 @ 0x563459363200] Invalid DTS: 465070 PTS: 462070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1359450, dts=1362450, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1359450, dts=1362450, size=1445[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1365450, dts=1368450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1365450, dts=1368450, size=1286[mp4 @ 0x563459363200] Invalid DTS: 471070 PTS: 468070 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1371450, dts=1374450, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1371450, dts=1374450, size=1207[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1377450, dts=1380600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 477070 PTS: 474070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1377450, dts=1380600, size=1287[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1383600, dts=1386600, size=893[mp4 @ 0x563459363200] Invalid DTS: 483070 PTS: 480070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1383600, dts=1386600, size=1020[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1389600, dts=1392600, size=1445[mp4 @ 0x563459363200] Invalid DTS: 489220 PTS: 486070 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1389600, dts=1392600, size=1429[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1395600, dts=1398600, size=893[mp4 @ 0x563459363200] Invalid DTS: 495220 PTS: 492220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1395600, dts=1398600, size=862[mp4 @ 0x563459363200] Invalid DTS: 501220 PTS: 498220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 507220 PTS: 504220 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1407600, dts=1410600, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1407600, dts=1410600, size=1196[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1413600, dts=1416600, size=1077[mp4 @ 0x563459363200] Invalid DTS: 519220 PTS: 516220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1413600, dts=1416600, size=944[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1419600, dts=1422600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 525220 PTS: 522220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1419600, dts=1422600, size=1200[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1425600, dts=1428600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1425600, dts=1428600, size=1155[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1431600, dts=1434600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 531220 PTS: 528220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 537220 PTS: 534220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1431600, dts=1434600, size=1296[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1437600, dts=1440600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1437600, dts=1440600, size=1103[mp4 @ 0x563459363200] Invalid DTS: 543220 PTS: 540220 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1443600, dts=1446600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1443600, dts=1446600, size=1065[mp4 @ 0x563459363200] Invalid DTS: 549220 PTS: 546220 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1449600, dts=1452600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 555220 PTS: 552220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1449600, dts=1452600, size=1358[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1455600, dts=1458600, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1455600, dts=1458600, size=1260[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1461600, dts=1464600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 561220 PTS: 558220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 567220 PTS: 564220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1461600, dts=1464600, size=1220[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1467600, dts=1470600, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1467600, dts=1470600, size=1256[mp4 @ 0x563459363200] Invalid DTS: 573220 PTS: 570220 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1479600, dts=1482600, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1479600, dts=1482600, size=1360[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1485600, dts=1488600, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1485600, dts=1488600, size=819[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1491600, dts=1494600, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1491600, dts=1494600, size=1279[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1497600, dts=1500600, size=1077[mp4 @ 0x563459363200] Invalid DTS: 579220 PTS: 576220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 591220 PTS: 588220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 597220 PTS: 594220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 603220 PTS: 600220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1497600, dts=1500600, size=1169[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1503600, dts=1506600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1503600, dts=1506600, size=926[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1509600, dts=1512600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1509600, dts=1512600, size=1151[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1515600, dts=1518600, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1515600, dts=1518600, size=1112[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1521600, dts=1524600, size=1261[mp4 @ 0x563459363200] Invalid DTS: 609220 PTS: 606220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 615220 PTS: 612220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 621220 PTS: 618220 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 627220 PTS: 624220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1521600, dts=1524600, size=1279[mp4 @ 0x563459363200] Invalid DTS: 633220 PTS: 630220 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1527600, dts=1530750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1527600, dts=1530750, size=1183[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1533750, dts=1536750, size=1077[mp4 @ 0x563459363200] Invalid DTS: 639370 PTS: 636220 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1533750, dts=1536750, size=1056[mp4 @ 0x563459363200] Invalid DTS: 645370 PTS: 642370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1539750, dts=1542750, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1539750, dts=1542750, size=1398[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1551750, dts=1554750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1551750, dts=1554750, size=1099[mp4 @ 0x563459363200] Invalid DTS: 651370 PTS: 648370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1557750, dts=1560750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1557750, dts=1560750, size=1220[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1563750, dts=1566750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1563750, dts=1566750, size=974[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1569750, dts=1572750, size=1445[mp4 @ 0x563459363200] Invalid DTS: 663370 PTS: 660370 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 669370 PTS: 666370 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 675370 PTS: 672370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1569750, dts=1572750, size=1384[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1575750, dts=1578750, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1575750, dts=1578750, size=837[mp4 @ 0x563459363200] Invalid DTS: 681370 PTS: 678370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1581750, dts=1584750, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1581750, dts=1584750, size=1323[mp4 @ 0x563459363200] Invalid DTS: 687370 PTS: 684370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1587750, dts=1590750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1587750, dts=1590750, size=1180[mp4 @ 0x563459363200] Invalid DTS: 693370 PTS: 690370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1593750, dts=1596750, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1593750, dts=1596750, size=914[mp4 @ 0x563459363200] Invalid DTS: 699370 PTS: 696370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1599750, dts=1602750, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1599750, dts=1602750, size=1225[mp4 @ 0x563459363200] Invalid DTS: 705370 PTS: 702370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1605750, dts=1608750, size=1077[mp4 @ 0x563459363200] Invalid DTS: 711370 PTS: 708370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1605750, dts=1608750, size=1167[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1611750, dts=1614750, size=1261[mp4 @ 0x563459363200] Invalid DTS: 717370 PTS: 714370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1611750, dts=1614750, size=1295[mp4 @ 0x563459363200] Invalid DTS: 723370 PTS: 720370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1623750, dts=1626750, size=1575.8x    [mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1623750, dts=1626750, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1623750, dts=1626750, size=1079[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1629750, dts=1632750, size=1445[mp4 @ 0x563459363200] Invalid DTS: 735370 PTS: 732370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1629750, dts=1632750, size=1349[mp4 @ 0x563459363200] Invalid DTS: 741370 PTS: 738370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1635750, dts=1638750, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1635750, dts=1638750, size=1279[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1641750, dts=1644750, size=1261[mp4 @ 0x563459363200] Invalid DTS: 747370 PTS: 744370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1641750, dts=1644750, size=1235[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1647750, dts=1650750, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1647750, dts=1650750, size=1284[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1653750, dts=1656750, size=1077[mp4 @ 0x563459363200] Invalid DTS: 753370 PTS: 750370 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 759370 PTS: 756370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1653750, dts=1656750, size=1060[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1659750, dts=1662750, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1659750, dts=1662750, size=1387[mp4 @ 0x563459363200] Invalid DTS: 765370 PTS: 762370 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1665750, dts=1668750, size=709[mp4 @ 0x563459363200] Invalid DTS: 771370 PTS: 768370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1665750, dts=1668750, size=825[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1671750, dts=1674750, size=1261[mp4 @ 0x563459363200] Invalid DTS: 777370 PTS: 774370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1671750, dts=1674750, size=1292[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1677750, dts=1680900, size=1077[mp4 @ 0x563459363200] Invalid DTS: 783370 PTS: 780370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1677750, dts=1680900, size=1206[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1683900, dts=1686900, size=893[mp4 @ 0x563459363200] Invalid DTS: 789520 PTS: 786370 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1683900, dts=1686900, size=906[mp4 @ 0x563459363200] Invalid DTS: 795520 PTS: 792520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1695900, dts=1698900, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1695900, dts=1698900, size=1214[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1701900, dts=1704900, size=1261[mp4 @ 0x563459363200] Invalid DTS: 807520 PTS: 804520 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1701900, dts=1704900, size=1269[mp4 @ 0x563459363200] Invalid DTS: 813520 PTS: 810520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1707900, dts=1710900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1707900, dts=1710900, size=1204[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1713900, dts=1716900, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1713900, dts=1716900, size=1091[mp4 @ 0x563459363200] Invalid DTS: 819520 PTS: 816520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 825520 PTS: 822520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1719900, dts=1722900, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1719900, dts=1722900, size=1428[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1725900, dts=1728900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1725900, dts=1728900, size=1299[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1731900, dts=1734900, size=1077[mp4 @ 0x563459363200] Invalid DTS: 831520 PTS: 828520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 837520 PTS: 834520 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1731900, dts=1734900, size=1209[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1737900, dts=1740900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1737900, dts=1740900, size=1277[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1743900, dts=1746900, size=1077[mp4 @ 0x563459363200] Invalid DTS: 843520 PTS: 840520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 849520 PTS: 846520 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1743900, dts=1746900, size=1021[mp4 @ 0x563459363200] Invalid DTS: 855520 PTS: 852520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1749900, dts=1752900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1749900, dts=1752900, size=1382[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1755900, dts=1758900, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1755900, dts=1758900, size=869[mp4 @ 0x563459363200] Invalid DTS: 861520 PTS: 858520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 867520 PTS: 864520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1767900, dts=1770900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1767900, dts=1770900, size=1204[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1773900, dts=1776900, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1773900, dts=1776900, size=945[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1779900, dts=1782900, size=1261[mp4 @ 0x563459363200] Invalid DTS: 879520 PTS: 876520 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1779900, dts=1782900, size=1205[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1785900, dts=1788900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1785900, dts=1788900, size=1162[http @ 0x563459365740] Opening &#x27;http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/fileSequence2.ts&#x27; for reading[mp4 @ 0x563459363200] Invalid DTS: 885520 PTS: 882520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 891520 PTS: 888520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 897520 PTS: 894520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1791900, dts=1794900, size=1391[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1791900, dts=1794900, size=1290[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1797900, dts=1800900, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1797900, dts=1800900, size=1106[mp4 @ 0x563459363200] Invalid DTS: 903520 PTS: 900520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 909520 PTS: 906520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1803900, dts=1806900, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1803900, dts=1806900, size=1072[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1809900, dts=1812900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1809900, dts=1812900, size=1380[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1815900, dts=1818900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1815900, dts=1818900, size=1273[mp4 @ 0x563459363200] Invalid DTS: 915520 PTS: 912520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 921520 PTS: 918520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 927520 PTS: 924520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1821900, dts=1824900, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1821900, dts=1824900, size=1212[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1827900, dts=1831050, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1827900, dts=1831050, size=1324[mp4 @ 0x563459363200] Invalid DTS: 933520 PTS: 930520 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 939670 PTS: 936520 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1840050, dts=1843050, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1840050, dts=1843050, size=1330[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1846050, dts=1849050, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1846050, dts=1849050, size=821[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1852050, dts=1855050, size=1261[mp4 @ 0x563459363200] Invalid DTS: 951670 PTS: 948670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 957670 PTS: 954670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1852050, dts=1855050, size=1326[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1858050, dts=1861050, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1858050, dts=1861050, size=1178[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1864050, dts=1867050, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1864050, dts=1867050, size=917[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1870050, dts=1873050, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1870050, dts=1873050, size=1163[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1876050, dts=1879050, size=1077[mp4 @ 0x563459363200] Invalid DTS: 963670 PTS: 960670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 969670 PTS: 966670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 975670 PTS: 972670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 981670 PTS: 978670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1876050, dts=1879050, size=1102[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1882050, dts=1885050, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1882050, dts=1885050, size=1263[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1888050, dts=1891050, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1888050, dts=1891050, size=1184[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1894050, dts=1897050, size=1077[mp4 @ 0x563459363200] Invalid DTS: 987670 PTS: 984670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 993670 PTS: 990670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 999670 PTS: 996670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1894050, dts=1897050, size=1043[mp4 @ 0x563459363200] Invalid DTS: 1005670 PTS: 1002670 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1900050, dts=1903050, size=1261.7x    [hls @ 0x563459342040] Invalid timestamps stream=0, pts=1900050, dts=1903050, size=1417[mp4 @ 0x563459363200] Invalid DTS: 1011670 PTS: 1008670 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1912050, dts=1915050, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1912050, dts=1915050, size=1122[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1918050, dts=1921050, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1918050, dts=1921050, size=1223[mp4 @ 0x563459363200] Invalid DTS: 1023670 PTS: 1020670 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1924050, dts=1927050, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1924050, dts=1927050, size=1055[mp4 @ 0x563459363200] Invalid DTS: 1029670 PTS: 1026670 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1035670 PTS: 1032670 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1930050, dts=1933050, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1930050, dts=1933050, size=1406[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1936050, dts=1939050, size=893[mp4 @ 0x563459363200] Invalid DTS: 1041670 PTS: 1038670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1936050, dts=1939050, size=870[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1942050, dts=1945050, size=1445[mp4 @ 0x563459363200] Invalid DTS: 1047670 PTS: 1044670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1942050, dts=1945050, size=1299[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1948050, dts=1951050, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1053670 PTS: 1050670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1948050, dts=1951050, size=1198[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1954050, dts=1957050, size=893[mp4 @ 0x563459363200] Invalid DTS: 1059670 PTS: 1056670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1954050, dts=1957050, size=935[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1960050, dts=1963050, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1065670 PTS: 1062670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1960050, dts=1963050, size=1224[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1966050, dts=1969050, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1071670 PTS: 1068670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1966050, dts=1969050, size=1136[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1972050, dts=1975050, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1077670 PTS: 1074670 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1972050, dts=1975050, size=1258[mp4 @ 0x563459363200] Invalid DTS: 1083670 PTS: 1080670 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1984200, dts=1987200, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1984200, dts=1987200, size=1080[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1990200, dts=1993200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1990200, dts=1993200, size=1356[mp4 @ 0x563459363200] Invalid DTS: 1095820 PTS: 1092820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1101820 PTS: 1098820 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=1996200, dts=1999200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=1996200, dts=1999200, size=1264[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2002200, dts=2005200, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1107820 PTS: 1104820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2002200, dts=2005200, size=1231[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2008200, dts=2011200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2008200, dts=2011200, size=1270[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2014200, dts=2017200, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1113820 PTS: 1110820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1119820 PTS: 1116820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2014200, dts=2017200, size=1055[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2020200, dts=2023200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2020200, dts=2023200, size=1366[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2026200, dts=2029200, size=893[mp4 @ 0x563459363200] Invalid DTS: 1125820 PTS: 1122820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2026200, dts=2029200, size=825[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2032200, dts=2035200, size=1445[mp4 @ 0x563459363200] Invalid DTS: 1131820 PTS: 1128820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2032200, dts=2035200, size=1303[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2038200, dts=2041200, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1137820 PTS: 1134820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2038200, dts=2041200, size=1200[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2044200, dts=2047200, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1143820 PTS: 1140820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2044200, dts=2047200, size=913[mp4 @ 0x563459363200] Invalid DTS: 1149820 PTS: 1146820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1155820 PTS: 1152820 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2056200, dts=2059200, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2056200, dts=2059200, size=1193[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2062200, dts=2065200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2062200, dts=2065200, size=1265[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2068200, dts=2071200, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1167820 PTS: 1164820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1173820 PTS: 1170820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2068200, dts=2071200, size=1206[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2074200, dts=2077200, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2074200, dts=2077200, size=1092[mp4 @ 0x563459363200] Invalid DTS: 1179820 PTS: 1176820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1185820 PTS: 1182820 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2080200, dts=2083200, size=1445[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2080200, dts=2083200, size=1435[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2086200, dts=2089200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2086200, dts=2089200, size=1292[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2092200, dts=2095200, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1191820 PTS: 1188820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1197820 PTS: 1194820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2092200, dts=2095200, size=1092[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2098200, dts=2101200, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2098200, dts=2101200, size=1253[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2104200, dts=2107200, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2104200, dts=2107200, size=1021[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2110200, dts=2113200, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1203820 PTS: 1200820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1209820 PTS: 1206820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1215820 PTS: 1212820 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2110200, dts=2113200, size=1391[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2116200, dts=2119200, size=893[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2116200, dts=2119200, size=860[mp4 @ 0x563459363200] Invalid DTS: 1221820 PTS: 1218820 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1227820 PTS: 1224820 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2128200, dts=2131350, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2128200, dts=2131350, size=1199[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2134350, dts=2137350, size=893.56x    [hls @ 0x563459342040] Invalid timestamps stream=0, pts=2134350, dts=2137350, size=944[mp4 @ 0x563459363200] Invalid DTS: 1239970 PTS: 1236820 in output stream 0:0, replacing by guess[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2140350, dts=2143350, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1245970 PTS: 1242970 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2140350, dts=2143350, size=1216[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2146350, dts=2149350, size=157[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2146350, dts=2149350, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1251970 PTS: 1248970 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2146350, dts=2149350, size=1149[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2152350, dts=2155350, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1257970 PTS: 1254970 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2152350, dts=2155350, size=1298[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2158350, dts=2161350, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2158350, dts=2161350, size=1100[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2164350, dts=2167350, size=1077[mp4 @ 0x563459363200] Invalid DTS: 1263970 PTS: 1260970 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2164350, dts=2167350, size=1065[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2170350, dts=2173350, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2170350, dts=2173350, size=1358[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2176350, dts=2179350, size=1261[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2176350, dts=2179350, size=1257[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2182350, dts=2185350, size=1077[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2182350, dts=2185350, size=1202[mpegts @ 0x56345935c4c0] Invalid timestamps stream=0, pts=2188350, dts=2191350, size=1261[mp4 @ 0x563459363200] Invalid DTS: 1269970 PTS: 1266970 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1275970 PTS: 1272970 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1281970 PTS: 1278970 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1287970 PTS: 1284970 in output stream 0:0, replacing by guess[mp4 @ 0x563459363200] Invalid DTS: 1293970 PTS: 1290970 in output stream 0:0, replacing by guess[hls @ 0x563459342040] Invalid timestamps stream=0, pts=2188350, dts=2191350, size=1270[mp4 @ 0x563459363200] Invalid DTS: 1299970 PTS: 1296970 in output stream 0:0, replacing by guessframe=  432 fps=248 q=-1.0 Lsize=    1136kB time=00:00:14.44 bitrate= 644.2kbits/s speed=8.29x    video:1099kB audio:20kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 1.557765%[aac @ 0x5634593649c0] Qavg: 65403.508Exiting normally, received signal 2.\nctrl+c åœæ­¢åï¼Œlsï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹å­˜åœ¨1.mp4æ–‡ä»¶ï¼Œå¯ä»¥æ’­æ”¾æ–‡ä»¶çœ‹çœ‹æ•ˆæœ\n\n","slug":"å…¶ä»–/vs2017ç¼–è¯‘FFmpeg","date":"2023-05-11T11:52:25.000Z","categories_index":"éŸ³è§†é¢‘ç¼–ç ","tags_index":"FFmpeg","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3ab7f0783815eb0913f3bccc1c62e62d","title":"å¼€æºé¡¹ç›®æ¨è","content":"Qtå¼€æºé¡¹ç›®æ¨èæ’åä¸åˆ†å…ˆå\nQWidgetDemo\nä½œè€…ï¼šé£æ‰¬é’äº‘\né¡¹ç›®ç®€ä»‹ï¼šQtç¼–å†™çš„ä¸€äº›å¼€æºçš„demoï¼Œæ”¯æŒQt4ã€Qt5ã€Qt6ï¼Œæ”¯æŒä»»æ„ç³»ç»Ÿï¼Œé¢„è®¡ä¼šæœ‰100å¤šä¸ªï¼Œä¸€ç›´æŒç»­æ›´æ–°å®Œå–„ï¼Œä»£ç ç®€æ´æ˜“æ‡‚æ³¨é‡Šè¯¦ç»†ï¼Œæ¯ä¸ªéƒ½æ˜¯ç‹¬ç«‹é¡¹ç›®ï¼Œéå¸¸é€‚åˆåˆå­¦è€…ï¼Œä»£ç éšæ„ä¼ æ’­ä½¿ç”¨ï¼Œæ‹’ç»æ‰“èµå’Œæèµ ï¼Œæ¬¢è¿ç•™è¨€è¯„è®ºï¼\né¡¹ç›®åœ°å€ï¼šhttps://gitee.com/feiyangqingyun/QWidgetDemo\næ¨èç†ç”±ï¼šQWidgetå…¥é—¨å¿…å¤‡\n\nqt-material-widgets\nä½œè€…ï¼šlaserpants\né¡¹ç›®ç®€ä»‹ï¼šqt-material-widgetsæ˜¯ä¸€æ¬¾åŸºäº Qt æ¡†æ¶çš„ UI ç»„ä»¶åº“ï¼Œæ—¨åœ¨ä¸ºæ¡Œé¢åº”ç”¨ç¨‹åºæä¾›ç°ä»£åŒ–å’Œç¾è§‚çš„ Material Design é£æ ¼ã€‚å®ƒæ˜¯ä½¿ç”¨ C++ å’Œ Qt å¼€å‘çš„ï¼Œå¹¶å¯ä»¥ä¸ Qt 5.x å’Œ Qt 6.x ç‰ˆæœ¬å…¼å®¹ã€‚è¯¥ç»„ä»¶åº“æä¾›äº†ä¸°å¯Œçš„ UI æ§ä»¶å’Œæ ·å¼ï¼ŒåŒ…æ‹¬æŒ‰é’®ã€å¤é€‰æ¡†ã€æ–‡æœ¬è¾“å…¥æ¡†ã€å¼¹å‡ºèœå•ç­‰å¸¸è§æ§ä»¶ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†å¤šç§ä¸»é¢˜å’Œé¢œè‰²æ–¹æ¡ˆï¼Œå¯å¸®åŠ©ç”¨æˆ·è‡ªå®šä¹‰ç•Œé¢å’Œä¸»é¢˜é£æ ¼ã€‚æ‰€æœ‰çš„æ§ä»¶å’Œæ ·å¼éƒ½ç¬¦åˆ Material Design è®¾è®¡è§„èŒƒï¼Œä½¿å¾—ä½ å¯ä»¥åœ¨ä½¿ç”¨ä¸­è·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œè§†è§‰æ•ˆæœã€‚qt-material-widgets çš„ä»£ç æ˜¯å¼€æºçš„ï¼Œæ‰˜ç®¡åœ¨ GitHub ä¸Šï¼Œå‘å¸ƒçš„ç‰ˆæœ¬åŒ…æ‹¬ .zip å½’æ¡£æ–‡ä»¶å’Œæºä»£ç ã€‚å®˜æ–¹ç½‘ç«™ä¸Šä¹Ÿæä¾›äº†è¯¦ç»†çš„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œä»¥å¸®åŠ©å¼€å‘äººå‘˜åˆæ­¥äº†è§£å’Œä½¿ç”¨è¯¥ç»„ä»¶åº“ã€‚å¦‚æœä½ ä½¿ç”¨ Qt å¼€å‘æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œå¹¶æƒ³è¦å®ç° Material Design é£æ ¼çš„ç”¨æˆ·ç•Œé¢ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ qt-material-widgets è¿™ä¸ªç»„ä»¶åº“ã€‚\né¡¹ç›®åœ°å€ï¼šhttps://github.com/laserpants/qt-material-widgets\næ¨èç†ç”±ï¼šQtç•Œé¢æ¡†æ¶æ·±å±‚æ¬¡ç†è§£ ï¼ˆå¯æƒœåé¢ä¸ç»´æŠ¤äº†ï¼Œä½†æ˜¯ä¾ç„¶å€¼å¾—å­¦ä¹ ï¼‰\n\nTaoQuick\nä½œè€…ï¼šæ­¦å¨çš„æ¶›å“¥\né¡¹ç›®ç®€ä»‹ï¼šä¸€å¥—é…·ç‚«çš„QtQuick&#x2F;QmlåŸºç¡€åº“å’Œç¤ºä¾‹(a cool QtQuick&#x2F;qml component library and demo)\né¡¹ç›®åœ°å€ï¼šhttps://gitee.com/jaredtao/TaoQuick\næ¨èç†ç”±ï¼šQtQuick&#x2F;Qmlå…¥é—¨å¿…å¤‡\n\nQtAv\nä½œè€…ï¼šwang-bin\né¡¹ç›®ç®€ä»‹ï¼šQtAV is a multimedia playback library based on Qt and FFmpeg. It can help you to write a player with less effort than ever before.QtAV has been added to FFmpeg projects page http://ffmpeg.org/projects.htmlQtAV is free software licensed under the term of LGPL v2.1. The player example is licensed under GPL v3. If you use QtAV or its constituent libraries, you must adhere to the terms of the license in question.\né¡¹ç›®åœ°å€ï¼šhttps://github.com/wang-bin/QtAV\næ¨èç†ç”±ï¼šQtå®ç°é«˜æ€§èƒ½æ’­æ”¾å™¨ï¼Œæ•´ä½“å·¥ç¨‹ç»“æ„å€¼å¾—ä¸€çœ‹\n\nWeComCopy\nä½œè€…ï¼šé˜¿æœ¨å¤§å”\né¡¹ç›®ç®€ä»‹ï¼šQt æ¨¡ä»¿ä¼ä¸šå¾®ä¿¡ç•Œé¢ æœ¬é¡¹ç›®ä¸ºQtå®ç°ä¼ä¸šå¾®ä¿¡ç•Œé¢é¡¹ç›®ï¼Œçº¯ç•Œé¢é€»è¾‘ï¼Œä¸åŒ…å«çœŸå®ä¸šåŠ¡é€»è¾‘ã€‚ä¸»è¦ç”¨äºå­¦ä¹ QWidgetçš„ä½¿ç”¨ï¼ŒåŒ…å«ç»˜åˆ¶ï¼Œå¸ƒå±€ï¼Œä¿¡å·ï¼Œäº‹ä»¶ï¼Œé‡å†™ï¼Œå¤šçº¿ç¨‹ï¼Œqssç­‰æŠ€æœ¯ä½¿ç”¨ã€‚\né¡¹ç›®åœ°å€ï¼šhttps://gitee.com/hudejie/wecom-copy\næ¨èç†ç”±ï¼šQtç•Œé¢å…¥é—¨é¡¹ç›®ï¼Œå€¼å¾—æ–°æ‰‹å­¦ä¹ ï¼Œå¹¶ä¸”ä¸»é¡µå¼€æºå¤šä¸ªQtç›¸å…³é¡¹ç›®ï¼Œé€‚åˆæ–°æ‰‹å­¦ä¹ é”»ç‚¼ã€‚ä¸»é¡µåœ°å€ï¼šhttps://gitee.com/hudejie\n\nC&#x2F;C++å¼€æºé¡¹ç›®æ¨èlibevent\nä½œè€…ï¼šNirvanaliu\né¡¹ç›®ç®€ä»‹ï¼šlibeventæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¼€æºé«˜æ€§èƒ½ç½‘ç»œåº“\né¡¹ç›®åœ°å€ï¼šhttps://github.com/libevent/libevent\næ¨èç†ç”±ï¼š\näº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œé«˜æ€§èƒ½;\nè½»é‡çº§ï¼Œä¸“æ³¨äºç½‘ç»œï¼Œä¸å¦‚ACEé‚£ä¹ˆè‡ƒè‚¿åºå¤§ï¼›\næºä»£ç ç›¸å½“ç²¾ç‚¼ã€æ˜“è¯»ï¼›\nè·¨å¹³å°ï¼Œæ”¯æŒWindowsã€Linuxã€BSDå’ŒMac Osï¼›\næ”¯æŒå¤šç§I&#x2F;Oå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œ epollã€pollã€dev&#x2F;pollã€selectå’Œkqueueç­‰ï¼›\næ”¯æŒI&#x2F;Oï¼Œå®šæ—¶å™¨å’Œä¿¡å·ç­‰äº‹ä»¶ï¼›\næ³¨å†Œäº‹ä»¶ä¼˜å…ˆçº§ï¼›\nlibeventå·²ç»è¢«å¹¿æ³›çš„åº”ç”¨ï¼Œä½œä¸ºåº•å±‚çš„ç½‘ç»œåº“ï¼›æ¯”å¦‚memcachedã€Vomitã€Nylonã€Netchatç­‰ç­‰ã€‚\n\n\n\nHP-Socket\nä½œè€…ï¼šä¼¤ç¥å°æ€ªå…½\né¡¹ç›®ç®€ä»‹ï¼šHP-Socket æ˜¯ä¸€å¥—é€šç”¨çš„é«˜æ€§èƒ½ TCP&#x2F;UDP&#x2F;HTTP é€šä¿¡æ¡†æ¶ï¼ŒåŒ…å«æœåŠ¡ç«¯ç»„ä»¶ã€å®¢æˆ·ç«¯ç»„ä»¶å’ŒAgentç»„ä»¶ï¼Œå¹¿æ³›é€‚ç”¨äºå„ç§ä¸åŒåº”ç”¨åœºæ™¯çš„ TCP&#x2F;UDP&#x2F;HTTP é€šä¿¡ç³»ç»Ÿï¼Œæä¾› C&#x2F;C++ã€C#ã€Delphiã€Eï¼ˆæ˜“è¯­è¨€ï¼‰ã€Javaã€Python ç­‰ç¼–ç¨‹è¯­è¨€æ¥å£ã€‚HP-Socket å¯¹é€šä¿¡å±‚å®ç°å®Œå…¨å°è£…ï¼Œåº”ç”¨ç¨‹åºä¸å¿…å…³æ³¨é€šä¿¡å±‚çš„ä»»ä½•ç»†èŠ‚ï¼›HP-Socket æä¾›åŸºäºäº‹ä»¶é€šçŸ¥æ¨¡å‹çš„ API æ¥å£ï¼Œèƒ½éå¸¸ç®€å•é«˜æ•ˆåœ°æ•´åˆåˆ°æ–°æ—§åº”ç”¨ç¨‹åºä¸­ã€‚\né¡¹ç›®åœ°å€ï¼šhttps://gitee.com/ldcsaa/HP-Socket\næ¨èç†ç”±ï¼šé«˜æ€§èƒ½socketæ¡†æ¶ï¼Œä»£ç æ¡†æ¶åŠä»£ç è§„èŒƒå€¼å¾—å­¦ä¹ \n\n","slug":"å¼€æºé¡¹ç›®/å¼€æºé¡¹ç›®æ¨è","date":"2023-05-08T02:27:52.000Z","categories_index":"å¼€æºé¡¹ç›®","tags_index":"c++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"d2b5059492d6e2887d56c31f82cb8443","title":"ã€è½¬è½½ã€‘Qtå¼€å‘ç»éªŒ-é£æ‰¬é’äº‘","content":"åŸæ–‡åœ°å€ï¼šhttps://gitee.com/feiyangqingyun/qtkaifajingyan\n1 å¼€å‘ç»éªŒ01ï¼š001-010\nå½“ç¼–è¯‘å‘ç°å¤§é‡é”™è¯¯çš„æ—¶å€™ï¼Œä»ç¬¬ä¸€ä¸ªçœ‹èµ·ï¼Œä¸€ä¸ªä¸€ä¸ªçš„è§£å†³ï¼Œä¸è¦æ€¥ç€å»çœ‹ä¸‹ä¸€ä¸ªé”™è¯¯ï¼Œå¾€å¾€åé¢çš„é”™è¯¯éƒ½æ˜¯ç”±äºå‰é¢çš„é”™è¯¯å¼•èµ·çš„ï¼Œç¬¬ä¸€ä¸ªè§£å†³åå¾ˆå¯èƒ½éƒ½è§£å†³äº†ã€‚æ¯”å¦‚æˆ‘ä»¬å¯èƒ½å°±å†™é”™äº†ä¸€è¡Œä»£ç ï¼Œç¼–è¯‘æç¤ºå‡ ç™¾ä¸ªé”™è¯¯ï¼Œä½ åªè¦æŠŠè¿™ä¸€è¡Œçº æ­£äº†ï¼Œå…¶ä»–é”™è¯¯ä¹Ÿå°±æ²¡äº†ã€‚\n\nå®šæ—¶å™¨æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå­¦ä¼šå¥½ä½¿ç”¨å®ƒï¼Œæœ‰æ—¶å€™ç”¨QTimer::singleShotå•æ¬¡å®šæ—¶å™¨å’ŒQMetaObject::invokeMethodå¯ä»¥è§£å†³æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚æ¯”å¦‚åœ¨çª—ä½“åˆå§‹åŒ–çš„æ—¶å€™åŠ è½½ä¸€ä¸ªè€—æ—¶çš„æ“ä½œï¼Œå¾ˆå®¹æ˜“å¡ä¸»ç•Œé¢çš„æ˜¾ç¤ºï¼Œè¦åœ¨åŠ è½½å®Œä»¥åæ‰ä¼šæ˜¾ç¤ºç•Œé¢ï¼Œè¿™å°±å¯¼è‡´äº†ä½“éªŒå¾ˆå¡ä¸å‹å¥½çš„æ„Ÿè§‰ï¼Œæ­¤æ—¶ä½ å¯ä»¥å°†è€—æ—¶çš„åŠ è½½ï¼ˆæœ‰æ—¶å€™è¿™äº›åŠ è½½åˆå¿…é¡»åœ¨ä¸»çº¿ç¨‹ï¼Œæ¯”å¦‚ç”¨QStackWidgetå †æ ˆçª—ä½“åŠ è½½ä¸€äº›å­çª—ä½“ï¼‰ï¼Œå»¶æ—¶æˆ–è€…å¼‚æ­¥è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¼šåœ¨ç•Œé¢æ˜¾ç¤ºåå»æ‰§è¡Œï¼Œè€Œä¸æ˜¯å¡ä½ä¸»ç•Œé¢ã€‚\n1234//å¼‚æ­¥æ‰§è¡Œloadå‡½æ•°QMetaObject::invokeMethod(this, &quot;load&quot;, Qt::QueuedConnection);//å»¶æ—¶10æ¯«ç§’æ‰§è¡Œloadå‡½æ•°QTimer::singleShot(10, this, SLOT(load()));\n\né»˜è®¤QtCreatoræ˜¯å•çº¿ç¨‹ç¼–è¯‘ï¼Œå¯èƒ½è®¾è®¡ä¹‹åˆè€ƒè™‘åˆ°å°½é‡ä¸è¿‡å¤šå ç”¨ç³»ç»Ÿèµ„æºï¼Œè€Œç°åœ¨çš„ç”µè„‘éƒ½æ˜¯å¤šæ ¸å¿ƒçš„ï¼Œé»˜è®¤msvcç¼–è¯‘å™¨æ˜¯å¤šçº¿ç¨‹ç¼–è¯‘çš„ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼Œè€Œå¯¹äºå…¶ä»–ç¼–è¯‘å™¨ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®æ‰è¡Œã€‚\n\n\n\næ–¹æ³•ä¸€ï¼šåœ¨æ¯ä¸ªé¡¹ç›®çš„æ„å»ºè®¾ç½®ä¸­ï¼ˆå¯ä»¥å‹¾é€‰ä¸€ä¸ª shadow build çš„é¡µé¢åœ°æ–¹ï¼‰çš„buildæ­¥éª¤ï¼Œmake argumentså¢åŠ ä¸€è¡Œ -j16 å³å¯ï¼Œæ­¤è®¾ç½®ä¼šä¿å­˜åœ¨pro.useræ–‡ä»¶ä¸­ï¼Œä¸€æ—¦åˆ é™¤å°±éœ€è¦é‡æ–°è®¾ç½®ï¼Œä¸å»ºè®®æ­¤æ–¹æ³•ï¼›\næ–¹æ³•äºŒï¼šåœ¨æ„å»ºå¥—ä»¶çš„ç¯å¢ƒä¸­å¢åŠ ï¼Œå·¥å…·-&gt;é€‰é¡¹-&gt;æ„å»ºå¥—ä»¶(kits)-&gt;é€‰ä¸­ä¸€ä¸ªæ„å»ºå¥—ä»¶-&gt;environment-&gt;å³ä¾§changeæŒ‰é’®-&gt;æ‰“å¼€çš„è¾“å…¥æ¡†ä¸­å¡«å…¥ MAKEFLAGS&#x3D;-j4 ï¼Œ è¿™æ ·å°±å¯ä»¥ä¸ç”¨æ¯æ¬¡è®¾ç½®å¤šçº¿ç¨‹ç¼–è¯‘ï¼Œåªè¦æ˜¯åº”ç”¨è¯¥æ„ä»¶å¥—ä»¶çš„é¡¹ç›®éƒ½ä¼šåŠ ä¸Šè¿™ä¸ªç¼–è¯‘å‚æ•°ï¼›\næ³¨æ„ï¼š-jåé¢æ¥çš„æ˜¯ç”µè„‘çš„æ ¸å¿ƒæ•°ï¼Œå†™å¤šäº†ä¸ä¼šæœ‰æ•ˆæœï¼Œè¦è‡ªå·±çœ‹ä¸‹ç”µè„‘çš„å‚æ•°ï¼Œæˆ–è€…å¡«ä¸ª-j4å°±è¡Œï¼Œæ¯•ç«Ÿç°åœ¨ç”µè„‘4æ ¸å¿ƒåº”è¯¥æ˜¯æœ€åŸºæœ¬çš„ï¼›\nå¤§æ¦‚ä»2019å¹´å¼€å§‹çš„æ–°ç‰ˆæœ¬çš„QtCreatoré»˜è®¤å·²ç»ä¼šæ ¹æ®ç”µè„‘çš„æ ¸å¿ƒè‡ªåŠ¨è®¾ç½®å¤šçº¿ç¨‹ç¼–è¯‘ï¼Œæ¯”å¦‚è¯†åˆ«åˆ°ä½ çš„ç”µè„‘æ˜¯16æ ¸å¿ƒçš„å°±ä¼šé»˜è®¤è®¾ç½®-j16å‚æ•°è¿›è¡Œç¼–è¯‘ï¼›\nQtCreator8ç‰ˆæœ¬å¼€å§‹ï¼Œé€‰é¡¹é…ç½®èœå•ä»å·¥å…·ç§»åˆ°äº†ç¼–è¾‘èœå•ä¸­ï¼Œå¾ˆå¤šäººæœ‰ç‚¹ä¸é€‚åº”è¯´æ€ä¹ˆæ²¡æœ‰äº†ï¼Œå…¶å®ç¨å¾®é¼ æ ‡åˆ’ä¸€åˆ’æ‰¾ä¸€æ‰¾å°±çœ‹åˆ°äº†ã€‚\n\n\nå¦‚æœä½ æƒ³é¡ºåˆ©ç”¨QtCreatoréƒ¨ç½²å®‰å“ç¨‹åºï¼Œé¦–å…ˆä½ è¦åœ¨ Android Studio é‡Œé¢é…ç½®æˆåŠŸï¼Œç¼–è¯‘ä¸€ä¸ªç¨‹åºèƒ½å¤Ÿåœ¨æ‰‹æœºä¸Šæˆ–è€…æ¨¡æ‹Ÿå™¨ä¸­è·‘èµ·æ¥ï¼ŒæŠŠå‘å…¨éƒ¨è¶Ÿå¹³ã€‚\n\nå¾ˆå¤šæ—¶å€™æ‰¾åˆ°Qtå¯¹åº”å°è£…çš„æ–¹æ³•åï¼Œè®°å¾—å¤šçœ‹çœ‹è¯¥å‡½æ•°çš„é‡è½½ï¼Œå¤šä¸ªå‚æ•°çš„ï¼Œä½ ä¼šå‘ç°ä¸ä¸€æ ·çš„ä¸–ç•Œï¼Œæœ‰æ—¶å€™ä¼šæç„¶å¤§æ‚Ÿï¼ŒåŸæ¥Qtå·²ç»å¸®æˆ‘ä»¬å°è£…å¥½äº†ï¼Œæ¯”å¦‚QStringã€QColorçš„é‡è½½å‚æ•°æå…¶ä¸°å¯Œï¼Œå¾ˆå¤šä½ åšæ¢¦éƒ½æƒ³è¦çš„åŠŸèƒ½å°±åœ¨é‡Œé¢ã€‚\n\nå¯ä»¥åœ¨proæ–‡ä»¶ä¸­å†™ä¸Šç‰ˆæœ¬å·ã€ç¨‹åºå›¾æ ‡ã€äº§å“åç§°ã€ç‰ˆæƒæ‰€æœ‰ã€æ–‡ä»¶è¯´æ˜ç­‰ä¿¡æ¯ï¼ˆQt5æ‰æ”¯æŒï¼‰ï¼Œå…¶å®åœ¨windowsä¸Šå°±æ˜¯qmakeçš„æ—¶å€™ä¼šè‡ªåŠ¨å°†æ­¤ä¿¡æ¯è½¬æ¢æˆrcæ–‡ä»¶ã€‚å¯¹äºæ—©æœŸçš„Qt4ç‰ˆæœ¬ä½ å¯ä»¥æ‰‹åŠ¨å†™rcæ–‡ä»¶å®ç°ã€‚\n12345678910#ç¨‹åºç‰ˆæœ¬VERSION  = 2025.10.01#ç¨‹åºå›¾æ ‡RC_ICONS = main.ico#äº§å“åç§°QMAKE_TARGET_PRODUCT = quc#ç‰ˆæƒæ‰€æœ‰QMAKE_TARGET_COPYRIGHT = feiyangqingyun#æ–‡ä»¶è¯´æ˜QMAKE_TARGET_DESCRIPTION = QQ: 517216493  WX: feiyangqingyun\n\nç®¡ç†å‘˜è¿è¡Œç¨‹åºï¼Œé™å®šåœ¨MSVCç¼–è¯‘å™¨ï¼Œåœ¨é¡¹ç›®proæ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ã€‚\n12QMAKE_LFLAGS += /MANIFESTUAC:&quot;level=&#x27;requireAdministrator&#x27; uiAccess=&#x27;false&#x27;&quot; #ä»¥ç®¡ç†å‘˜è¿è¡ŒQMAKE_LFLAGS += /SUBSYSTEM:WINDOWS,&quot;5.01&quot; #VS2013 åœ¨XPè¿è¡Œ\n\nè¿è¡Œæ–‡ä»¶é™„å¸¦è°ƒè¯•è¾“å‡ºçª—å£ï¼Œè¿™ä¸ªéå¸¸æœ‰ç”¨ï¼Œå¾ˆå¤šæ—¶å€™å½“æˆ‘ä»¬å‘å¸ƒç¨‹åºé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ç¨‹åºåŒå‡»æ— æ³•è¿è¡Œä¹Ÿä¸æŠ¥é”™æç¤ºï¼ˆå¼€å‘æœºå™¨ä¸Šä¸€åˆ‡æ­£å¸¸ï¼‰ï¼Œéƒ½ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç”šè‡³ä»»åŠ¡ç®¡ç†å™¨å¯ä»¥çœ‹åˆ°è¿è¡Œäº†ä½†æ˜¯æ²¡æœ‰ç•Œé¢å¼¹å‡ºæ¥ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨é¡¹ç›®çš„proæ–‡ä»¶ä¸­åŠ ä¸Šä¸€è¡ŒCONFIG +&#x3D; consoleï¼Œå¸¦ç•Œé¢çš„ç¨‹åºä¹Ÿä¼šè‡ªåŠ¨å¼¹å‡ºè°ƒè¯•çª—å£æ‰“å°è¾“å‡ºä¿¡æ¯ï¼Œæ–¹ä¾¿æ‰¾é—®é¢˜ï¼Œä¸€èˆ¬æ²¡æ³•æ­£å¸¸è¿è¡Œçš„ç¨‹åºéƒ½ä¼šæ‰“å°ä¸€äº›æç¤ºä¿¡æ¯ç¼ºå•¥ä¹‹ç±»çš„ã€‚\n1234567TEMPLATE    = appMOC_DIR     = temp/mocRCC_DIR     = temp/rccUI_DIR      = temp/uiOBJECTS_DIR = temp/obj#å°±æ˜¯ä¸‹é¢è¿™è¡Œç”¨æ¥è®¾ç½®è¿è¡Œæ–‡ä»¶é™„å¸¦è°ƒè¯•è¾“å‡ºçª—å£CONFIG      += console\n\nç»˜åˆ¶å¹³é“ºèƒŒæ™¯QPainter::drawTiledPixmapï¼Œç»˜åˆ¶åœ†è§’çŸ©å½¢QPainter::drawRoundedRect()ï¼Œè€Œä¸æ˜¯QPainter::drawRoundRect()ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éå¸¸å®¹æ˜“ææ··ã€‚\n\næŒ‡å®šæ§ä»¶ç§»é™¤æ—§çš„æ ·å¼ã€‚\n123456//ç§»é™¤åŸæœ‰æ ·å¼style()-&gt;unpolish(ui-&gt;btn);//å¿…é¡»è¦æœ‰ä¸‹é¢è¿™è¡Œä¸ç„¶è¿˜æ˜¯ä¸ä¼šå¸è½½ui-&gt;btn-&gt;setStyleSheet(&quot;&quot;);//é‡æ–°è®¾ç½®æ–°çš„è¯¥æ§ä»¶çš„æ ·å¼ã€‚style()-&gt;polish(ui-&gt;btn);\n\n02ï¼š011-020\nè·å–ç±»çš„å±æ€§å’Œæ–¹æ³•\n123456789101112131415161718192021222324252627//æ‹¿åˆ°æ§ä»¶å…ƒå¯¹è±¡const QMetaObject *metaObject = widget-&gt;metaObject();//æ‰€æœ‰å±æ€§çš„æ•°é‡int propertyCount = metaObject-&gt;propertyCount();//propertyOffsetæ˜¯è‡ªå®šä¹‰çš„å±æ€§å¼€å§‹çš„ä½ç½®int propertyOffset = metaObject-&gt;propertyOffset();//å¾ªç¯å–å‡ºæ§ä»¶çš„è‡ªå®šä¹‰å±æ€§, int i = 0 è¡¨ç¤ºæ‰€æœ‰å±æ€§for (int i = propertyOffset; i &lt; propertyCount; ++i) &#123;    QMetaProperty metaProperty = metaObject-&gt;property(i);    const char *name = metaProperty.name();    const char *type = metaProperty.typeName();    QVariant value = widget-&gt;property(name);    qDebug() &lt;&lt; name &lt;&lt; type &lt;&lt; value;&#125;//æ‰€æœ‰æ–¹æ³•çš„æ•°é‡int methodCount = metaObject-&gt;methodCount();//methodOffsetæ˜¯è‡ªå®šä¹‰çš„æ–¹æ³•å¼€å§‹çš„ä½ç½®int methodOffset = metaObject-&gt;methodOffset();//å¾ªç¯å–å‡ºæ§ä»¶çš„è‡ªå®šä¹‰æ–¹æ³•, int i = 0 è¡¨ç¤ºæ‰€æœ‰æ–¹æ³•for (int i = methodOffset; i &lt; methodCount; ++i) &#123;    QMetaMethod metaMethod = metaObject-&gt;method(i);    const char *name = metaMethod.name();    const char *type = metaMethod.typeName();    qDebug() &lt;&lt; name &lt;&lt; type;&#125;\n\nQtå†…ç½®å›¾æ ‡å°è£…åœ¨QStyleä¸­ï¼Œå¤§æ¦‚ä¸ƒåå¤šä¸ªå›¾æ ‡ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚\n123456789101112SP_TitleBarMenuButton,SP_TitleBarMinButton,SP_TitleBarMaxButton,SP_TitleBarCloseButton,SP_MessageBoxInformation,SP_MessageBoxWarning,SP_MessageBoxCritical,SP_MessageBoxQuestion,...//ä¸‹é¢è¿™æ ·å–å‡ºæ¥ä½¿ç”¨å°±è¡ŒQPixmap pixmap = this-&gt;style()-&gt;standardPixmap(QStyle::SP_TitleBarMenuButton);ui-&gt;label-&gt;setPixmap(pixmap);\n\næ ¹æ®æ“ä½œç³»ç»Ÿä½æ•°åˆ¤æ–­åŠ è½½\n1234567win32 &#123;    contains(DEFINES, WIN64) &#123;        DESTDIR = $$PWD/../bin64    &#125; else &#123;         DESTDIR = $$PWD/../bin32    &#125;&#125;\n\nQt5å¢å¼ºäº†å¾ˆå¤šå®‰å…¨æ€§éªŒè¯ï¼Œå¦‚æœå‡ºç°setGeometry: Unable to set geometryï¼Œè¯·å°†è¯¥æ§ä»¶çš„å¯è§ç§»åˆ°åŠ å…¥å¸ƒå±€ä¹‹åã€‚\n\nå¯ä»¥å°†æ§ä»¶Aæ·»åŠ åˆ°å¸ƒå±€ï¼Œç„¶åæ§ä»¶Bè®¾ç½®è¯¥å¸ƒå±€ï¼Œè¿™ç§çµæ´»æ€§æé«˜äº†æ§ä»¶çš„ç»„åˆåº¦ï¼Œæ¯”å¦‚å¯ä»¥åœ¨æ–‡æœ¬æ¡†å·¦ä¾§å³ä¾§å¢åŠ ä¸€ä¸ªæœç´¢æŒ‰é’®ï¼ŒæŒ‰é’®è®¾ç½®å›¾æ ‡å³å¯ã€‚\n123456QPushButton *btn = new QPushButton;btn-&gt;resize(30, ui-&gt;lineEdit-&gt;height());QHBoxLayout *layout = new QHBoxLayout(ui-&gt;lineEdit);layout-&gt;setMargin(0);layout-&gt;addStretch();layout-&gt;addWidget(btn);\n\nå¯¹QLCDNumberæ§ä»¶è®¾ç½®æ ·å¼ï¼Œéœ€è¦å°†QLCDNumberçš„segmentstyleè®¾ç½®ä¸ºflatï¼Œä¸ç„¶ä½ ä¼šå‘ç°æ²¡æ•ˆæœã€‚\n\nå·§å¦™çš„ä½¿ç”¨ findChildren å¯ä»¥æŸ¥æ‰¾è¯¥æ§ä»¶ä¸‹çš„æ‰€æœ‰å­æ§ä»¶ã€‚ findChild ä¸ºæŸ¥æ‰¾å•ä¸ªã€‚\n123456//æŸ¥æ‰¾æŒ‡å®šç±»åobjectNameçš„æ§ä»¶QList&lt;QWidget *&gt; widgets = fatherWidget.findChildren&lt;QWidget *&gt;(&quot;widgetname&quot;);//æŸ¥æ‰¾æ‰€æœ‰QPushButtonQList&lt;QPushButton *&gt; allPButtons = fatherWidget.findChildren&lt;QPushButton *&gt;();//æŸ¥æ‰¾ä¸€çº§å­æ§ä»¶,ä¸ç„¶ä¼šä¸€ç›´éå†æ‰€æœ‰å­æ§ä»¶QList&lt;QPushButton *&gt; childButtons = fatherWidget.findChildren&lt;QPushButton *&gt;(QString(), Qt::FindDirectChildrenOnly);\n\nå·§å¦™çš„ä½¿ç”¨inheritsåˆ¤æ–­æ˜¯å¦å±äºæŸç§ç±»ã€‚\n1234QTimer *timer = new QTimer;         // QTimer inherits QObjecttimer-&gt;inherits(&quot;QTimer&quot;);          // returns truetimer-&gt;inherits(&quot;QObject&quot;);         // returns truetimer-&gt;inherits(&quot;QAbstractButton&quot;); // returns false\n\nä½¿ç”¨å¼±å±æ€§æœºåˆ¶ï¼Œå¯ä»¥å­˜å‚¨ä¸´æ—¶çš„å€¼ç”¨äºä¼ é€’åˆ¤æ–­ã€‚å¯ä»¥é€šè¿‡widget-&gt;dynamicPropertyNames()åˆ—å‡ºæ‰€æœ‰å¼±å±æ€§åç§°ï¼Œç„¶åé€šè¿‡widget-&gt;property(â€œnameâ€)å–å‡ºå¯¹åº”çš„å¼±å±æ€§çš„å€¼ã€‚\n\nåœ¨å¼€å‘æ—¶, æ— è®ºæ˜¯å‡ºäºç»´æŠ¤çš„ä¾¿æ·æ€§, è¿˜æ˜¯èŠ‚çœå†…å­˜èµ„æºçš„è€ƒè™‘, éƒ½åº”è¯¥æœ‰ä¸€ä¸ª qss æ–‡ä»¶æ¥å­˜æ”¾æ‰€æœ‰çš„æ ·å¼è¡¨, è€Œä¸åº”è¯¥å°† setStyleSheet å†™çš„åˆ°å¤„éƒ½æ˜¯ã€‚å¦‚æœæ˜¯åˆå­¦é˜¶æ®µæˆ–è€…æµ‹è¯•é˜¶æ®µå¯ä»¥ç›´æ¥UIä¸Šå³é”®è®¾ç½®æ ·å¼è¡¨ï¼Œæ­£å¼é¡¹ç›®è¿˜æ˜¯å»ºè®®ç»Ÿä¸€åˆ°ä¸€ä¸ªqssæ ·å¼è¡¨æ–‡ä»¶æ¯”è¾ƒå¥½ï¼Œç»Ÿä¸€ç®¡ç†ã€‚\n\n\n03ï¼š021-030\nå¦‚æœå‡ºç°Z-order assignment: is not a valid widget.é”™è¯¯æç¤ºï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å¯¹åº”çš„uiæ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸ºç©ºçš„åœ°æ–¹ï¼Œåˆ é™¤å³å¯ã€‚\n\nå–„äºåˆ©ç”¨QComboBoxçš„addItemçš„ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ç”¨æˆ·æ•°æ®ï¼Œå¯ä»¥å®ç°å¾ˆå¤šæ•ˆæœï¼Œä½¿ç”¨itemDataå–å‡ºæ¥ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•°æ˜¯QVariantç±»å‹ï¼Œè¿™å°±ä¸è¦å¤ªçµæ´»äº†ï¼Œæ„å‘³ç€å¯ä»¥é™„å¸¦ä¸‡èƒ½çš„æ•°æ®æ¯”å¦‚ç»“æ„ä½“ï¼Œè¿™æ ·å°±å¯ä»¥å¸¦ä¸€å †æ•°æ®äº†ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ•°æ®ã€‚æ¯”å¦‚ä¸‹æ‹‰æ¡†é€‰æ‹©å­¦å·ï¼Œå¯¹åº”å…ƒç´ å¯ä»¥é™„å¸¦è¯¥å­¦ç”Ÿçš„å§“åã€ç­çº§ã€æˆç»©ç­‰ã€‚å¾ˆå¤šäººä»¥ä¸ºåªèƒ½é™„å¸¦QStringã€intä¹‹ç±»çš„æ•°æ®ï¼Œå› ä¸ºé€šå¸¸çš„ç”¨æ³•ä¹Ÿæ˜¯é‚£ä¸¤ç§ã€‚\n123456789QStringList listVideoOpenInterval, listVideoOpenIntervalx;listVideoOpenInterval &lt;&lt; &quot;0.0 ç§’&quot; &lt;&lt; &quot;0.1 ç§’&quot; &lt;&lt; &quot;0.3 ç§’&quot; &lt;&lt; &quot;0.5 ç§’&quot; &lt;&lt; &quot;1.0 ç§’&quot; &lt;&lt; &quot;2.0 ç§’&quot;;listVideoOpenIntervalx &lt;&lt; &quot;0&quot; &lt;&lt; &quot;100&quot; &lt;&lt; &quot;300&quot; &lt;&lt; &quot;500&quot; &lt;&lt; &quot;1000&quot; &lt;&lt; &quot;2000&quot;;for (int i = 0; i &lt; listVideoOpenInterval.count(); ++i) &#123;    ui-&gt;cboxVideoOpenInterval-&gt;addItem(listVideoOpenInterval.at(i), listVideoOpenIntervalx.at(i));&#125;//å–å‡ºå¯¹åº”çš„å€¼int indexVideoOpenInterval = ui-&gt;cboxVideoOpenInterval-&gt;currentIndex();indexVideoOpenInterval = ui-&gt;cboxVideoOpenInterval-&gt;itemData(indexVideoOpenInterval).toInt();\n\nå¦‚æœç”¨äº†webengineæ¨¡å—ï¼Œå‘å¸ƒç¨‹åºçš„æ—¶å€™å¸¦ä¸ŠQtWebEngineProcess.exeã€translationsæ–‡ä»¶å¤¹ã€resourcesæ–‡ä»¶å¤¹ï¼Œä¸ç„¶æ— æ³•æ­£å¸¸è¿è¡Œã€‚\n\nåœ¨MFCç¨‹åºæˆ–è€…VB&#x2F;C#ç­‰çª—ä½“ç¨‹åºä¸­ï¼Œæ¯ä¸ªæ§ä»¶éƒ½æœ‰ä¸€ä¸ªå¥æŸ„ï¼Œè€Œä¸”ç”¨å¥æŸ„å·¥å…·ç§»è¿‡å»ä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œä½†æ˜¯åœ¨Qtç¨‹åºä¸­é»˜è®¤Qtæ˜¯ä¸€ä¸ªçª—ä½“ä¸€ä¸ªå¥æŸ„ï¼Œå¦‚æœè¦è®©æ¯ä¸ªæ§ä»¶éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„å¥æŸ„ï¼Œåœ¨mainå‡½æ•°ä¸­è¦åšå¦‚ä¸‹è®¾ç½®ã€‚\n12345int main(int argc, char *argv[])&#123;    QApplication a(argc, argv);    a.setAttribute(Qt::AA_NativeWindows);&#125;\n\nQtç¼–å†™çš„Androidç¨‹åºé˜²æ­¢ç¨‹åºè¢«å…³é—­ã€‚\n1234567#if defined(Q_OS_ANDROID)QAndroidService a(argc, argv);return a.exec()#elseQApplication a(argc, argv);return a.exec();#endif\n\nå¯ä»¥å¯¹æ•´ä½“çš„æŒ‡ç¤ºå™¨è®¾ç½®æ ·å¼ï¼Œè€Œä¸éœ€è¦å•ç‹¬å¯¹æ¯ä¸ªæ§ä»¶çš„æŒ‡ç¤ºå™¨è®¾ç½®ï¼Œ \n1234*::down-arrow&#123;&#125;*::menu-indicator&#123;&#125;*::up-arrow:disabled&#123;&#125;*::up-arrow:off&#123;&#125;\n\nå¯ä»¥æŒ‡å®šä½ç½®è®¾ç½®èƒŒæ™¯å›¾ç‰‡ã€‚\n123456QMainWindow &gt; .QWidget &#123;    background-color: gainsboro;    background-image: url(:/images/xxoo.png);    background-position: top right;    background-repeat: no-repeat&#125;\n\nåµŒå…¥å¼linuxè¿è¡ŒQtç¨‹åº\n1234567//Qt4å†™æ³•./HelloQt -qws &amp;//Qt5å†™æ³• xcb å¯ä»¥æ”¹æˆ linuxfb eglfs vnc wayland ç­‰,æœ‰å“ªä¸ªå°±ç”¨å“ªä¸ªæŒ¨ä¸ªæµ‹è¯•./HelloQt --platform xcb./HelloQt --platform linuxfb./HelloQt --platform wayland\n\nå¦‚æœå‘ç°QtCreatorä¸­çš„æ„å»ºå¥—ä»¶ä¸æ­£å¸¸äº†æˆ–è€…åäº†ï¼ˆæ¯”å¦‚ä¸èƒ½æ­£ç¡®è¯†åˆ«ç¯å¢ƒä¸­çš„qmakeæˆ–è€…ç¼–è¯‘å™¨ã€æ‰“å¼€é¡¹ç›®ä¸èƒ½æ­£å¸¸ç”Ÿæˆå½±å­æ„å»ºç›®å½•ï¼‰ï¼Œè¯·æ‰¾åˆ°ä¸¤ä¸ªç›®å½•ï¼ˆC:\\Users\\Administrator\\AppData\\Local\\QtProjectã€C:\\Users\\Administrator\\AppData\\Roaming\\QtProjectï¼‰åˆ é™¤å³å¯ï¼Œåˆ é™¤åé‡æ–°æ‰“å¼€QtCreatorè¿›è¡Œæ„å»ºå¥—ä»¶çš„é…ç½®å°±è¡Œã€‚\n\nQMediaPlayeræ˜¯ä¸ªå£³ï¼ˆä¹Ÿå¯ä»¥å«æ¡†æ¶ï¼‰ï¼Œä¾èµ–æœ¬åœ°è§£ç å™¨ï¼Œè§†é¢‘è¿™å—é»˜è®¤åŸºæœ¬ä¸Šå°±æ’­æ”¾ä¸ªMP4ç”šè‡³è¿MP4éƒ½ä¸èƒ½æ’­æ”¾ï¼Œå¦‚æœè¦æ”¯æŒå…¶ä»–æ ¼å¼éœ€è¦ä¸‹è½½k-liteæˆ–è€…LAV Filterså®‰è£…å³å¯ï¼ˆk-liteæˆ–è€…LAV Filtersæ˜¯æŒ‡windowsä¸Šçš„ï¼Œå…¶ä»–ç³»ç»Ÿä¸Šè‡ªè¡Œæœç´¢ï¼Œè²Œä¼¼åµŒå…¥å¼linuxä¸Šä¾èµ–GStreamerï¼ˆsudo apt-get install gstreamer1.0-libav ubuntu-restricted-extrasï¼‰ï¼Œå¹¶æœªå®Œæ•´éªŒè¯ï¼ŒæŠ¥é”™æç¤º Your GStreamer installation is missing a plug-inï¼Œéœ€è¦å‘½ä»¤å®‰è£… sudo apt-get install ubuntu-restricted-extrasï¼‰ã€‚å¦‚æœéœ€è¦åšåŠŸèƒ½å¼ºåŠ²çš„æ’­æ”¾å™¨ï¼Œåˆå­¦è€…å»ºè®®ç”¨vlcã€mpvï¼Œç»ˆæä¸‡èƒ½å¤§æ³•ç”¨ffmpegï¼ˆè§£ç å‡ºæ¥çš„è§†é¢‘å¯ä»¥ç”¨QOpenGLWidgetèµ°GPUç»˜åˆ¶æˆ–è€…è½¬æˆQImageç»˜åˆ¶ï¼ŒéŸ³é¢‘æ•°æ®å¯ä»¥ç”¨QAudioOutputæ’­æ”¾ï¼‰ã€‚\n\n\n04ï¼š031-040\nåˆ¤æ–­ç¼–è¯‘å™¨ç±»å‹ã€ç¼–è¯‘å™¨ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081//GCCç¼–è¯‘å™¨#ifdef __GNUC__#if __GNUC__ &gt;= 3   // GCC3.0  ä»¥ä¸Š//MSVCç¼–è¯‘å™¨#ifdef _MSC_VER#if _MSC_VER &gt;=1000 // VC++4.0 ä»¥ä¸Š#if _MSC_VER &gt;=1100 // VC++5.0 ä»¥ä¸Š#if _MSC_VER &gt;=1200 // VC++6.0 ä»¥ä¸Š#if _MSC_VER &gt;=1300 // VC2003  ä»¥ä¸Š#if _MSC_VER &gt;=1400 // VC2005  ä»¥ä¸Š#if _MSC_VER &gt;=1500 // VC2008  ä»¥ä¸Š#if _MSC_VER &gt;=1600 // VC2010  ä»¥ä¸Š#if _MSC_VER &gt;=1700 // VC2012  ä»¥ä¸Š#if _MSC_VER &gt;=1800 // VC2013  ä»¥ä¸Š#if _MSC_VER &gt;=1900 // VC2015  ä»¥ä¸Š//Visual Studioç‰ˆæœ¬ä¸MSVCç‰ˆæœ¬å·çš„å¯¹åº”å…³ç³»MSC    1.0   _MSC_VER == 100MSC    2.0   _MSC_VER == 200MSC    3.0   _MSC_VER == 300MSC    4.0   _MSC_VER == 400MSC    5.0   _MSC_VER == 500MSC    6.0   _MSC_VER == 600MSC    7.0   _MSC_VER == 700MSVC++ 1.0   _MSC_VER == 800MSVC++ 2.0   _MSC_VER == 900MSVC++ 4.0   _MSC_VER == 1000 (Developer Studio 4.0)MSVC++ 4.2   _MSC_VER == 1020 (Developer Studio 4.2)MSVC++ 5.0   _MSC_VER == 1100 (Visual Studio 97 version 5.0)MSVC++ 6.0   _MSC_VER == 1200 (Visual Studio 6.0 version 6.0)MSVC++ 7.0   _MSC_VER == 1300 (Visual Studio .NET 2002 version 7.0)MSVC++ 7.1   _MSC_VER == 1310 (Visual Studio .NET 2003 version 7.1)MSVC++ 8.0   _MSC_VER == 1400 (Visual Studio 2005 version 8.0)MSVC++ 9.0   _MSC_VER == 1500 (Visual Studio 2008 version 9.0)MSVC++ 10.0  _MSC_VER == 1600 (Visual Studio 2010 version 10.0)MSVC++ 11.0  _MSC_VER == 1700 (Visual Studio 2012 version 11.0)MSVC++ 12.0  _MSC_VER == 1800 (Visual Studio 2013 version 12.0)MSVC++ 14.0  _MSC_VER == 1900 (Visual Studio 2015 version 14.0)MSVC++ 14.1  _MSC_VER == 1910 (Visual Studio 2017 version 15.0)MSVC++ 14.11 _MSC_VER == 1911 (Visual Studio 2017 version 15.3)MSVC++ 14.12 _MSC_VER == 1912 (Visual Studio 2017 version 15.5)MSVC++ 14.13 _MSC_VER == 1913 (Visual Studio 2017 version 15.6)MSVC++ 14.14 _MSC_VER == 1914 (Visual Studio 2017 version 15.7)MSVC++ 14.15 _MSC_VER == 1915 (Visual Studio 2017 version 15.8)MSVC++ 14.16 _MSC_VER == 1916 (Visual Studio 2017 version 15.9)MSVC++ 14.2  _MSC_VER == 1920 (Visual Studio 2019 Version 16.0)MSVC++ 14.21 _MSC_VER == 1921 (Visual Studio 2019 Version 16.1)MSVC++ 14.22 _MSC_VER == 1922 (Visual Studio 2019 Version 16.2)MSVC++ 14.30 _MSC_VER == 1930 (Visual Studio 2022 Version 17.0)MSVC++ 14.31 _MSC_VER == 1931 (Visual Studio 2022 Version 17.1)MSVC++ 14.32 _MSC_VER == 1932 (Visual Studio 2022 Version 17.2)//Borland C++#ifdef __BORLANDC__//Cygwin#ifdef __CYGWIN__#ifdef __CYGWIN32__//mingw#ifdef __MINGW32__//windows#ifdef _WIN32           //32bit#ifdef _WIN64           //64bit#ifdef _WINDOWS         //å›¾å½¢ç•Œé¢ç¨‹åº#ifdef _CONSOLE         //æ§åˆ¶å°ç¨‹åº//Windowsï¼ˆ95/98/Me/NT/2000/XP/Vistaï¼‰å’ŒWindows CEéƒ½å®šä¹‰äº†#if (WINVER &gt;= 0x030a)  // Windows 3.1ä»¥ä¸Š#if (WINVER &gt;= 0x0400)  // Windows 95/NT4.0ä»¥ä¸Š#if (WINVER &gt;= 0x0410)  // Windows 98ä»¥ä¸Š#if (WINVER &gt;= 0x0500)  // Windows Me/2000ä»¥ä¸Š#if (WINVER &gt;= 0x0501)  // Windows XPä»¥ä¸Š#if (WINVER &gt;= 0x0600)  // Windows Vistaä»¥ä¸Š//_WIN32_WINNT å†…æ ¸ç‰ˆæœ¬#if (_WIN32_WINNT &gt;= 0x0500) // Windows 2000ä»¥ä¸Š#if (_WIN32_WINNT &gt;= 0x0501) // Windows XPä»¥ä¸Š#if (_WIN32_WINNT &gt;= 0x0600) // Windows Vistaä»¥ä¸Š\n\nåœ¨proä¸­åˆ¤æ–­Qtç‰ˆæœ¬åŠæ„å»ºå¥—ä»¶ä½æ•°\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#æ‰“å°ç‰ˆæœ¬ä¿¡æ¯message(qt version: $$QT_VERSION)#åˆ¤æ–­å½“å‰qtç‰ˆæœ¬å·QT_VERSION = $$[QT_VERSION]QT_VERSION = $$split(QT_VERSION, &quot;.&quot;)QT_VER_MAJ = $$member(QT_VERSION, 0)QT_VER_MIN = $$member(QT_VERSION, 1)#ä¸‹é¢æ˜¯è¡¨ç¤º Qt5.5åŠä»¥ä¸Šç‰ˆæœ¬greaterThan(QT_VER_MAJ, 4) &#123;greaterThan(QT_VER_MIN, 4) &#123;#è‡ªå·±æ ¹æ®éœ€è¦åšä¸€äº›å¤„ç†&#125;&#125;#QT_ARCHæ˜¯Qt5æ–°å¢çš„,åœ¨Qt4ä¸Šæ²¡æ•ˆæœ#æ‰“å°å½“å‰Qtæ„å»ºå¥—ä»¶çš„ä¿¡æ¯message($$QT_ARCH)#è¡¨ç¤ºarmå¹³å°æ„å»ºå¥—ä»¶contains(QT_ARCH, arm) &#123;&#125;#è¡¨ç¤º32ä½çš„æ„å»ºå¥—ä»¶contains(QT_ARCH, i386) &#123;&#125;#è¡¨ç¤º64ä½çš„æ„å»ºå¥—ä»¶contains(QT_ARCH, x86_64) &#123;&#125;#å…¶å®Qtå†…ç½®äº†ä¸»ç‰ˆæœ¬å·å’Œå­ç‰ˆæœ¬å·å˜é‡#åˆ¤æ–­å½“å‰qtç‰ˆæœ¬å·message($$QT_ARCH : $$QT_VERSION -&gt; $$QT_MAJOR_VERSION . $$QT_MINOR_VERSION)#ä¸‹é¢çš„å«ä¹‰æ˜¯å¦‚æœç‰ˆæœ¬ &lt; 4.8lessThan(QT_MAJOR_VERSION, 5) &#123;lessThan(QT_MINOR_VERSION, 8) &#123;#è¿™é‡Œæ”¾è¦åšçš„å¤„ç†&#125;&#125;#ä¸‹é¢çš„å«ä¹‰æ˜¯å¦‚æœç‰ˆæœ¬ &lt; 5.12.0REQ_QT_MAJOR = 5REQ_QT_MINOR = 12REQ_QT_PATCH = 0lessThan(QT_MAJOR_VERSION, $$REQ_QT_MAJOR)|lessThan(QT_MINOR_VERSION, $$REQ_QT_MINOR)|lessThan(QT_MINOR_VERSION, $$REQ_QT_PATCH) &#123;#è¿™é‡Œæ”¾è¦åšçš„å¤„ç†&#125;#ä¸‹é¢çš„å«ä¹‰æ˜¯å¦‚æœç‰ˆæœ¬ &gt;= 5.5greaterThan(QT_MAJOR_VERSION, 4) &#123;greaterThan(QT_MINOR_VERSION, 4) &#123;#è¿™é‡Œæ”¾è¦åšçš„å¤„ç†&#125;&#125;//ä»£ç ä¸­åˆ¤æ–­ç‰ˆæœ¬ä¸è¦å¤ªç®€å•#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))//è¿™é‡Œæ”¾è¦åšçš„å¤„ç†#endif//ä¸‹é¢è¡¨ç¤º &gt;= 5.0.0#if QT_VERSION &gt;= 0x050000...#endif//ä¸‹é¢è¡¨ç¤º &lt; 5.12.10#if QT_VERSION &lt; 0x050C0A...#endif\n\nQtæœ€å°åŒ–åæ¢å¤ç•Œé¢å¯èƒ½ä¼šå‡ºç°å‡æ­»å†»ç»“ç°è±¡ï¼ŒåŠ ä¸Šä»£ç \n12345void showEvent(QShowEvent *e)&#123;    setAttribute(Qt::WA_Mapped);    QWidget::showEvent(e);&#125;\n\nè·å–æ ‡é¢˜æ é«˜åº¦ï¼šstyle()-&gt;pixelMetric(QStyle::PM_TitleBarHeight); PM_TitleBarHeightç‚¹è¿›å»ä½ ä¼šå‘ç°æ–°å¤§é™†ï¼Œæœ‰ä¸€å †ç©æ„åœ¨é‡Œé¢ã€‚\n\nè®¾ç½®é«˜åˆ†å±å±æ€§ä»¥ä¾¿æ”¯æŒ2K4Kç­‰é«˜åˆ†è¾¨ç‡ï¼Œå°¤å…¶æ˜¯æ‰‹æœºappã€‚å¿…é¡»å†™åœ¨mainå‡½æ•°çš„QApplication a(argc, argv);çš„å‰é¢ã€‚\n1234#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,6,0))    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);#endif    QApplication a(argc, argv);\n\nå¦‚æœè¿è¡Œç¨‹åºå‡ºç° Fault tolerant heap shim applied to current process. This is usually due to previous crashes. é”™è¯¯ã€‚\n\n\n\nç¬¬ä¸€æ­¥ï¼šè¾“å…¥å‘½ä»¤ regedit æ‰“å¼€æ³¨å†Œè¡¨ï¼›\nç¬¬äºŒæ­¥ï¼šæ‰¾åˆ°èŠ‚ç‚¹ HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers\\ï¼›\nç¬¬ä¸‰æ­¥ï¼šé€‰ä¸­Layersé”®å€¼ï¼Œä»å³ä¾§åˆ—è¡¨ä¸­åˆ é™¤è‡ªå·±çš„é‚£ä¸ªç¨‹åºè·¯å¾„å³å¯ã€‚\n\n\nQtå†…ç½®äº†QFormLayoutè¡¨å•å¸ƒå±€ç”¨äºè‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾+è¾“å…¥æ¡†çš„ç»„åˆçš„è¡¨å•ç•Œé¢ï¼Œè®¾ç½®å¸ƒå±€ç”¨çš„å¾ˆå°‘ï¼Œä¸€èˆ¬ç”¨çš„æœ€å¤šçš„æ˜¯æ¨ªå‘å¸ƒå±€ã€å‚ç›´å¸ƒå±€ã€è¡¨æ ¼å¸ƒå±€ã€‚\n\nqmlæ’­æ”¾è§†é¢‘åœ¨linuxéœ€è¦å®‰è£… sudo apt-get install libpulse-devã€‚\n\nå¯ä»¥ç›´æ¥ç»§æ‰¿QSqlQueryModelå®ç°è‡ªå®šä¹‰çš„QueryModelï¼Œæ¯”å¦‚æŸä¸€åˆ—å­—ä½“é¢œè‰²ï¼Œå ä½ç¬¦ï¼Œå…¶ä»–æ ·å¼ç­‰ï¼Œé‡å†™QVariant CustomSqlModel::data(const QModelIndex &amp;index, int role) constã€‚\n\nQt5ä»¥åæä¾›äº†ç±»QScrollerç›´æ¥å°†æ§ä»¶æ»šåŠ¨ã€‚\n1234567891011//ç¦ç”¨æ¨ªå‘æ»šåŠ¨æ¡ui-&gt;listWidget-&gt;setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);//ç¦ç”¨çºµå‘æ»šåŠ¨æ¡ui-&gt;listWidget-&gt;setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOff);//è®¾ç½®æ¨ªå‘æŒ‰ç…§åƒç´ å€¼ä¸ºå•ä½æ»šåŠ¨ui-&gt;listWidget-&gt;setHorizontalScrollMode(QListWidget::ScrollPerPixel);//è®¾ç½®çºµå‘æŒ‰ç…§åƒç´ å€¼ä¸ºå•ä½æ»šåŠ¨ui-&gt;listWidget-&gt;setVerticalScrollMode(QListWidget::ScrollPerPixel);//è®¾ç½®æ»šåŠ¨å¯¹è±¡ä»¥åŠæ»šåŠ¨æ–¹å¼ä¸ºé¼ æ ‡å·¦é”®æ‹‰åŠ¨æ»šåŠ¨QScroller::grabGesture(ui-&gt;listWidget, QScroller::LeftMouseButtonGesture);//è¿˜æœ‰ä¸ªQScrollerPropertieså¯ä»¥è®¾ç½®æ»šåŠ¨çš„ä¸€äº›å‚æ•°\n\n05ï¼š041-050\nå¦‚æœä½¿ç”¨sqliteæ•°æ®åº“ä¸æƒ³äº§ç”Ÿæ•°æ®åº“æ–‡ä»¶ï¼Œå¯ä»¥åˆ›å»ºå†…å­˜æ•°æ®åº“ã€‚\n12QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);db.setDatabaseName(&quot;:memory:&quot;);\n\næ¸…ç©ºæ•°æ®è¡¨å¹¶é‡ç½®è‡ªå¢IDï¼Œsql &#x3D; truncate table table_nameã€‚\n\nQtChartæ¨¡å—ä»Qt5.7å¼€å§‹è‡ªå¸¦ï¼Œæœ€ä½ç¼–è¯‘è¦æ±‚Qt5.4ã€‚åœ¨å®‰è£…çš„æ—¶å€™è®°å¾—å‹¾é€‰ï¼Œé»˜è®¤ä¸å‹¾é€‰ã€‚ä½¿ç”¨è¯¥æ¨¡å—éœ€è¦å¼•å…¥å‘½åç©ºé—´ã€‚\n123#include &lt;QChartView&gt;QT_CHARTS_USE_NAMESPACEclass CustomChart : public QChartView\n\nQPushButtonå·¦å¯¹é½æ–‡å­—ï¼Œéœ€è¦è®¾ç½®æ ·å¼è¡¨QPushButton{text-align:left;}\n\nQLabelæœ‰ä¸‰ç§è®¾ç½®æ–‡æœ¬çš„æ–¹æ³•ï¼ŒæŒæ¡å¥½Qtçš„å±æ€§ç³»ç»Ÿï¼Œä¸¾ä¸€åä¸‰ï¼Œå¯ä»¥åšå‡ºå¾ˆå¤šæ•ˆæœã€‚\n123456//å¸¸è§„åŠæ³•ui-&gt;label-&gt;setText(&quot;hello&quot;);//å–å·§åŠæ³•ui-&gt;label-&gt;setProperty(&quot;text&quot;, &quot;hello&quot;);//å±æ€§å¤§æ³•ui-&gt;label-&gt;setStyleSheet(&quot;qproperty-text:hello;&quot;);\n\nå·§å¦™çš„ç”¨QEventLoopå¼€å¯äº‹ä»¶å¾ªç¯ï¼Œå¯ä»¥ä½¿å¾—å¾ˆå¤šåŒæ­¥è·å–è¿”å›ç»“æœè€Œä¸é˜»å¡ç•Œé¢ã€‚æŸ¥çœ‹æºç å¾—çŸ¥ï¼ŒåŸæ¥QEventLoopå†…éƒ¨æ–°å»ºäº†çº¿ç¨‹æ‰§è¡Œã€‚\n123QEventLoop loop;connect(reply, SIGNAL(finished()), &amp;loop, SLOT(quit()));loop.exec();\n\nQtä¸­ä¹Ÿæ”¯æŒå¤šç§é¢„å®šä¹‰å˜é‡ç»„åˆåˆ¤æ–­ï¼Œå»æ‰ç”Ÿæˆç©ºçš„debugå’Œreleaseç›®å½•ï¼Œåœ¨proæ–‡ä»¶ä¸­åŠ ä¸€è¡Œ CONFIG -&#x3D; debug_and_releaseã€‚\n123456789101112131415161718192021#if defined(Q_OS_ANDROID) || defined(Q_OS_IOS)#endif#if !defined(Q_OS_ANDROID) &amp;&amp; !defined(Q_OS_IOS)#endif#ifdef Q_OS_WIN//windowsç³»ç»Ÿ#else//éwindowsç³»ç»Ÿ#endif//ä¸‹é¢å†™æ³•ç¼–è¯‘ä¼šæŠ¥é”™#ifdef Q_OS_WIN#elif Q_OS_LINUX#endif//æ­£ç¡®å†™æ³•#if defined(Q_OS_WIN)#elif defined(Q_OS_LINUX)#endif\n\næ–°ç‰ˆçš„Qtcreatorå¢å¼ºäº†è¯­æ³•æ£€æŸ¥ï¼Œä¼šå¼¹å‡ºå¾ˆå¤šè­¦å‘Šæç¤ºç­‰ï¼Œå¯ä»¥åœ¨æ’ä»¶åˆ—è¡¨ä¸­å…³é—­clangæ‰“å¤´çš„å‡ ä¸ªå³å¯ï¼ŒHelpã€‹About Pluginsã€‚ä¹Ÿå¯ä»¥è®¾ç½®ä»£ç æ£€æŸ¥çº§åˆ«ï¼ŒToolsã€‹Options ã€‹C++ ã€‹Code Modelã€‚\n\nQSqlTableModelçš„rowCountæ–¹æ³•ï¼Œé»˜è®¤æœ€å¤§è¿”å›256ï¼Œå¦‚æœè¶…è¿‡256ï¼Œå¯ä»¥å°†è¡¨æ ¼æ‹‰åˆ°åº•éƒ¨ï¼Œä¼šè‡ªåŠ¨åŠ è½½å‰©ä½™çš„ï¼Œæ¯æ¬¡æœ€å¤§åŠ è½½256æ¡æ•°æ®ï¼Œå¦‚æœéœ€è¦æ‰“å°æˆ–è€…å¯¼å‡ºæ•°æ®ï¼Œè®°å¾—æœ€å¥½é‡‡ç”¨sqlè¯­å¥å»æŸ¥è¯¢ï¼Œè€Œä¸æ˜¯ä½¿ç”¨QSqlTableModelçš„rowCountæ–¹æ³•ã€‚ä¸ç„¶æ°¸è¿œæœ€å¤§åªä¼šå¯¼å‡º256æ¡æ•°æ®ã€‚å¦‚æœæ•°æ®é‡å¾ˆå°ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š\n1234//ä¸»åŠ¨åŠ è½½æ‰€æœ‰æ•°æ®,ä¸ç„¶è·å–åˆ°çš„è¡Œæ•°&lt;=256while(model-&gt;canFetchMore()) &#123;    model-&gt;fetchMore();&#125;\n\nå¦‚æœéœ€è¦æŒ‡å®šæ— è¾¹æ¡†çª—ä½“ï¼Œä½†æ˜¯åˆéœ€è¦ä¿ç•™æ“ä½œç³»ç»Ÿçš„è¾¹æ¡†ç‰¹æ€§ï¼Œæ¯”å¦‚è‡ªç”±æ‹‰ä¼¸è¾¹æ¡†ï¼Œå¯ä»¥ä½¿ç”¨ setWindowFlags(Qt::CustomizeWindowHint)ï¼Œè¿™æ ·ä¼šä¿ç•™ä¸€ä¸ªç³»ç»Ÿç™½è¾¹æ¡†ã€‚\n\n\n06ï¼š051-060\nåœ¨æŸäº›http postæ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯&amp;å­—ç¬¦ä¸²è¿æ¥çš„æ•°æ®å‘é€ï¼Œä¸­æ–‡è§£æä¹±ç çš„è¯ï¼Œéœ€è¦å°†ä¸­æ–‡è¿›è¡ŒURLè½¬ç ã€‚\n12QString content = &quot;æµ‹è¯•ä¸­æ–‡&quot;;QString note = content.toUtf8().toPercentEncoding();\n\nQté»˜è®¤ä¸æ”¯æŒå¤§èµ„æºæ–‡ä»¶ï¼Œæ¯”å¦‚æ·»åŠ äº†å­—ä½“æ–‡ä»¶ï¼Œéœ€è¦proæ–‡ä»¶å¼€å¯ã€‚CONFIG +&#x3D; resources_big\n\nQtä¸­ç»§æ‰¿QWidgetä¹‹åï¼Œæ ·å¼è¡¨ä¸èµ·ä½œç”¨ï¼Œè§£å†³åŠæ³•æœ‰ä¸‰ä¸ªã€‚å¼ºçƒˆæ¨èæ–¹æ³•ä¸€ã€‚\n\n\n\næ–¹æ³•ä¸€ï¼šè®¾ç½®å±æ€§ this-&gt;setAttribute(Qt::WA_StyledBackground, true);\næ–¹æ³•äºŒï¼šæ”¹æˆç»§æ‰¿QFrameï¼Œå› ä¸ºQFrameè‡ªå¸¦paintEventå‡½æ•°å·²åšäº†å®ç°ï¼Œåœ¨ä½¿ç”¨æ ·å¼è¡¨æ—¶ä¼šè¿›è¡Œè§£æå’Œç»˜åˆ¶ã€‚\næ–¹æ³•ä¸‰ï¼šé‡æ–°å®ç°QWidgetçš„paintEventå‡½æ•°æ—¶ï¼Œä½¿ç”¨QStylePainterç»˜åˆ¶ã€‚1234567void Widget::paintEvent(QPaintEvent *)&#123;    QStyleOption option;    option.initFrom(this);    QPainter painter(this);    style()-&gt;drawPrimitive(QStyle::PE_Widget, &amp;option, &amp;painter, this);&#125;\n\n\næœ‰æ—¶å€™åœ¨ç•Œé¢ä¸ŠåŠ äº†å¼¹ç°§ï¼Œéœ€è¦åŠ¨æ€æ”¹å˜å¼¹ç°§å¯¹åº”çš„æ‹‰ä¼¸ç­–ç•¥ï¼Œå¯¹åº”æ–¹æ³•ä¸ºchangeSizeï¼Œå¾ˆå¤šäººä¼šé€‰æ‹©ä½¿ç”¨setå¼€å¤´å»æ‰¾ï¼Œæ‰¾ä¸åˆ°çš„ã€‚\n\nåœ¨ä½¿ç”¨QFileçš„è¿‡ç¨‹ä¸­ï¼Œä¸å»ºè®®é¢‘ç¹çš„æ‰“å¼€æ–‡ä»¶å†™å…¥ç„¶åå†å…³é—­æ–‡ä»¶ï¼Œæ¯”å¦‚é—´éš”5msè¾“å‡ºæ—¥å¿—ï¼ŒIOæ€§èƒ½ç“¶é¢ˆå¾ˆå¤§ï¼Œè¿™ç§æƒ…å†µå»ºè®®å…ˆæ‰“å¼€æ–‡ä»¶ä¸è¦å…³é—­ï¼Œç­‰å¾…åˆé€‚çš„æ—¶æœºæ¯”å¦‚ææ„å‡½æ•°ä¸­æˆ–è€…æ—¥æœŸå˜äº†éœ€è¦é‡æ–°å˜æ¢æ—¥å¿—æ–‡ä»¶çš„æ—¶å€™å…³é—­æ–‡ä»¶ã€‚ä¸ç„¶çŸ­æ—¶é—´å†…å¤§é‡çš„æ‰“å¼€å…³é—­æ–‡ä»¶ä¼šå¾ˆå¡ï¼Œæ–‡ä»¶è¶Šå¤§è¶Šå¡ã€‚\n\nåœ¨å¾ˆå¤šç½‘ç»œåº”ç”¨ç¨‹åºï¼Œéœ€è¦è‡ªå®šä¹‰å¿ƒè·³åŒ…æ¥ä¿æŒè¿æ¥ï¼Œä¸ç„¶æ–­ç”µæˆ–è€…éæ³•å…³é—­ç¨‹åºï¼Œå¯¹æ–¹ä¸èƒ½ç«‹å³è¯†åˆ«æˆ–è€…è¦å¾ˆä¹…ï¼ˆä¸€èˆ¬è‡³å°‘è¦30sï¼‰æ‰èƒ½è¯†åˆ«åˆ°ï¼Œéœ€è¦è¿›è¡Œè¶…æ—¶æ£€æµ‹ï¼Œä½†æ˜¯æœ‰äº›ç¨‹åºæ²¡æœ‰æä¾›å¿ƒè·³åè®®ï¼Œæ­¤æ—¶éœ€è¦å¯ç”¨ç³»ç»Ÿå±‚çš„ä¿æ´»ç¨‹åºï¼Œæ­¤æ–¹æ³•é€‚ç”¨äºTCPè¿æ¥ã€‚\n123456789int fd = tcpSocket-&gt;socketDescriptor();int keepAlive = 1;      //å¼€å¯keepaliveå±æ€§,ç¼ºçœå€¼:0(å…³é—­)int keepIdle = 5;       //å¦‚æœåœ¨5ç§’å†…æ²¡æœ‰ä»»ä½•æ•°æ®äº¤äº’,åˆ™è¿›è¡Œæ¢æµ‹,ç¼ºçœå€¼:7200(s)int keepInterval = 2;   //æ¢æµ‹æ—¶å‘æ¢æµ‹åŒ…çš„æ—¶é—´é—´éš”ä¸º2ç§’,ç¼ºçœå€¼:75(s)int keepCount = 2;      //æ¢æµ‹é‡è¯•çš„æ¬¡æ•°,å…¨éƒ¨è¶…æ—¶åˆ™è®¤å®šè¿æ¥å¤±æ•ˆ,ç¼ºçœå€¼:9(æ¬¡)setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, (void *)&amp;keepAlive, sizeof(keepAlive));setsockopt(fd, SOL_TCP, TCP_KEEPIDLE, (void *)&amp;keepIdle, sizeof(keepIdle));setsockopt(fd, SOL_TCP, TCP_KEEPINTVL, (void *)&amp;keepInterval, sizeof(keepInterval));setsockopt(fd, SOL_TCP, TCP_KEEPCNT, (void *)&amp;keepCount, sizeof(keepCount));\n\nå¦‚æœç¨‹åºæ‰“åŒ…å¥½ä»¥åå¼¹å‡ºæç¤º This application failed to start because it could not find or load the Qt platform plugin ä¸€èˆ¬éƒ½æ˜¯å› ä¸ºplatformsæ’ä»¶ç›®å½•æœªæ‰“åŒ…æˆ–è€…æ‰“åŒ…é”™äº†çš„åŸå› å¯¼è‡´çš„ã€‚\n\néå¸¸ä¸å»ºè®®trä¸­åŒ…å«ä¸­æ–‡ï¼Œå°½ç®¡ç°åœ¨çš„æ–°ç‰ˆQtæ”¯æŒä¸­æ–‡åˆ°å…¶ä»–è¯­è¨€çš„ç¿»è¯‘ï¼Œä½†æ˜¯å¾ˆä¸è§„èŒƒï¼Œä¹Ÿä¸çŸ¥é“TMDæ˜¯è°æ•™çš„ï¼ˆåé¢å‘ç°æˆ‘åœ¨åˆšå­¦Qtçš„æ—¶å€™ä¹Ÿå‘å¸ƒäº†ä¸€äº›demoåˆ°ç½‘ä¸Šä¹Ÿæ˜¯tråŒ…å«ä¸­æ–‡çš„ï¼Œå½“æ—¶å°±ç‹ ç‹ çš„æ‰“äº†è‡ªå·±ä¸€å·´æŒï¼‰ï¼Œtrçš„æœ¬æ„æ˜¯åŒ…å«è‹±æ–‡ï¼Œç„¶åç¿»è¯‘åˆ°å…¶ä»–è¯­è¨€æ¯”å¦‚ä¸­æ–‡ï¼Œç°åœ¨å¤§é‡çš„åˆå­¦è€…æ»¥ç”¨trï¼Œå¦‚æœæ²¡æœ‰ç¿»è¯‘çš„éœ€æ±‚ï¼Œç¦ç”¨trï¼Œtréœ€è¦å¼€é”€çš„ï¼ŒQté»˜è®¤ä¼šè®¤ä¸ºä»–éœ€è¦ç¿»è¯‘ï¼Œä¼šé¢å¤–è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚\n\nå¾ˆå¤šäººQtå’ŒQt Creatorå‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Œç»å¸¸é—®Qtä»€ä¹ˆç‰ˆæœ¬ç»“æœå‘ä¸€ä¸ªQt Creatorçš„ç‰ˆæœ¬è¿‡æ¥ï¼ŒQt Creatoræ˜¯ä½¿ç”¨Qtç¼–å†™çš„é›†æˆå¼€å‘ç¯å¢ƒIDEï¼Œå’Œå®‡å®™ç¬¬ä¸€çš„Visual Studioä¸€æ ·ï¼Œä»–å¯ä»¥æ˜¯msvcç¼–è¯‘å™¨çš„ï¼ˆWINå¯¹åº”çš„Qté›†æˆå®‰è£…ç¯å¢ƒä¸­è‡ªå¸¦çš„Qt Ceratoræ˜¯msvcçš„ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯mingwç¼–è¯‘çš„ï¼Œè¿˜å¯ä»¥æ˜¯gccçš„ã€‚å¦‚æœæ˜¯è‡ªå®šä¹‰æ§ä»¶æ’ä»¶ï¼Œéœ€è¦é›†æˆåˆ°Qt Creatorä¸­ï¼Œå¿…é¡»ä¿è¯è¯¥æ’ä»¶çš„åŠ¨æ€åº“æ–‡ä»¶ï¼ˆdllæˆ–è€…soç­‰æ–‡ä»¶ï¼‰å¯¹åº”çš„ç¼–è¯‘å™¨å’ŒQtç‰ˆæœ¬ä»¥åŠä½æ•°å’ŒQt Creatorçš„ç‰ˆæœ¬å®Œå…¨ä¸€è‡´æ‰è¡Œï¼Œå¦åˆ™åŸºæœ¬ä¸å¤§å¯èƒ½é›†æˆè¿›å»ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯Qté›†æˆç¯å¢ƒå®‰è£…åŒ…ä¸­çš„Qtç‰ˆæœ¬å’ŒQt Creatorç‰ˆæœ¬æœªå¿…å®Œå…¨ä¸€è‡´ï¼Œå¿…é¡»æ“¦äº®çœ¼ç›çœ‹æ¸…æ¥šï¼Œæœ‰äº›æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚\n\nè¶…è¿‡ä¸¤å¤„ç›¸åŒå¤„ç†çš„ä»£ç ï¼Œå»ºè®®å•ç‹¬å†™æˆå‡½æ•°ã€‚ä»£ç å°½é‡è§„èŒƒç²¾ç®€ï¼Œæ¯”å¦‚ if(a &#x3D;&#x3D; 123) è¦å†™æˆ if (123 &#x3D;&#x3D; a)ï¼Œå€¼åœ¨å‰é¢ï¼Œå†æ¯”å¦‚ if (ok &#x3D;&#x3D; true) è¦å†™æˆ if (ok)ï¼Œif (ok &#x3D;&#x3D; false) è¦å†™æˆ if (!ok)ç­‰ã€‚\n\n\n07ï¼š061-070\nå¾ˆå¤šäººé—®QtåµŒå…¥å¼å¹³å°ç”¨å“ªä¸ªå¥½ï¼Œè¿™é‡Œç»Ÿä¸€å›ç­”ï¼ˆå½“å‰æ—¶é—´èŠ‚ç‚¹2018å¹´ï¼‰ï¼šimx6+335xæ¯”è¾ƒç¨³å®šï¼Œæ€§èƒ½é«˜å°±ç”¨RK3288 RK3399ï¼Œä¾¿å®œçš„è¯å°±ç”¨å…¨å¿—H3ï¼Œç©ä¸€ç©å¯ä»¥ç”¨æ ‘è“æ´¾é¦™æ©™æ´¾ã€‚\n\nå¯¹äºå¤§æ®µçš„æ³¨é‡Šä»£ç ï¼Œå»ºè®®ç”¨ #if 0 #endif å°†ä»£ç å—åŒ…å«èµ·æ¥ï¼Œè€Œä¸æ˜¯å°†è¯¥æ®µä»£ç é€‰ä¸­ç„¶åå…¨éƒ¨åŒæ–œæ æ³¨é‡Šï¼Œä¸‹æ¬¡è¦æ‰“å¼€è¿™æ®µä»£ç çš„è¯ï¼Œåˆéœ€è¦é‡æ–°é€‰ä¸­ä¸€æ¬¡å–æ¶ˆï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯ #if 0åˆ™åªè¦æŠŠ0æ”¹æˆ1å³å¯ï¼Œå¼€å‘æ•ˆç‡æå‡å¾ˆå¤šã€‚\n\nQtæ‰“åŒ…å‘å¸ƒï¼Œæœ‰å¾ˆå¤šåŠæ³•ï¼ŒQt5ä»¥åæä¾›äº†æ‰“åŒ…å·¥å…·windeployqtï¼ˆlinuxä¸Šä¸ºlinuxdeployqtï¼Œmacä¸Šä¸ºmacdeployqtï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†åº”ç”¨ç¨‹åºæ‰“åŒ…ï¼Œä½¿ç”¨ä¸‹æ¥å‘ç°ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæœ‰æ—¶å€™ä¼šå¤šæ‰“åŒ…ä¸€äº›æ²¡æœ‰ä¾èµ–çš„æ–‡ä»¶ï¼Œæœ‰æ—¶å€™åˆä¼šå¿˜è®°æ‰“åŒ…ä¸€äº›æ’ä»¶å°¤å…¶æ˜¯ç”¨äº†qmlçš„æƒ…å†µä¸‹ï¼Œè€Œä¸”ä¸èƒ½è¯†åˆ«ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚ç¨‹åºä¾èµ–ffmpegï¼Œåˆ™å¯¹åº”çš„åº“éœ€è¦è‡ªè¡Œæ‹·è´ï¼Œç»ˆæå¤§æ³•å°±æ˜¯å°†ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°Qtå®‰è£…ç›®å½•ä¸‹çš„binç›®å½•ï¼Œç„¶åæ•´ä¸ªä¸€èµ·æ‰“åŒ…ï¼ŒæŒ¨ä¸ªåˆ é™¤ä¸å¤§å¯èƒ½ä¾èµ–çš„ç»„ä»¶ï¼Œç›´åˆ°åˆ åˆ°æ­£å¸¸è¿è¡Œä¸ºæ­¢ã€‚\n\nQtä¸­çš„åŠ¨ç”»ï¼Œåº•å±‚ç”¨çš„æ˜¯QElapsedTimerå®šæ—¶å™¨æ¥å®Œæˆå¤„ç†ï¼Œæ¯”å¦‚äº§ç”Ÿä¸€äº›æŒ‡å®šè§„åˆ™ç®—æ³•çš„æ•°æ®ï¼Œç„¶åå¯¹å±æ€§è¿›è¡Œå¤„ç†ã€‚\n\nåœ¨ç»˜åˆ¶æ— èƒŒæ™¯é¢œè‰²åªæœ‰è¾¹æ¡†é¢œè‰²çš„åœ†å½¢æ—¶å€™ï¼Œå¯ä»¥ç”¨ç»˜åˆ¶360åº¦çš„åœ†å¼§æ›¿ä»£ï¼Œæ•ˆæœå®Œå…¨ä¸€è‡´ã€‚\n1234QRect rect(-radius, -radius, radius * 2, radius * 2);//ä»¥ä¸‹ä¸¤ç§æ–¹æ³•äºŒé€‰ä¸€,å…¶å®ç»˜åˆ¶360åº¦çš„åœ†å¼§=ç»˜åˆ¶æ— èƒŒæ™¯çš„åœ†å½¢painter-&gt;drawArc(rect, 0, 360 * 16);painter-&gt;drawEllipse(rect);\n\nä¸è¦æŠŠdæŒ‡é’ˆçœ‹çš„å¾ˆç„ä¹ï¼Œå…¶å®å°±æ˜¯åœ¨ç±»çš„å®ç°æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªç§æœ‰ç±»ï¼Œç”¨æ¥å­˜æ”¾å±€éƒ¨å˜é‡ï¼Œä¸ªäººå»ºè®®åœ¨åšä¸€äº›å°é¡¹ç›®æ—¶ï¼Œæ²¡æœ‰å¤ªå¤§å¿…è¦å¼•å…¥è¿™ç§æœºåˆ¶ï¼Œä¼šé™ä½ä»£ç å¯è¯»æ€§ï¼Œå¢åŠ å¤æ‚æ€§ï¼Œæ–°æ‰‹æ¥å—é¡¹ç›®åä¼šçœ‹çš„å¾ˆæ‡µé€¼ã€‚\n\nå¾ˆå¤šäººåœ¨ç»˜åˆ¶çš„æ—¶å€™ï¼Œè®¾ç½®ç”»ç¬”ä»¥ä¸ºå°±åªå¯ä»¥è®¾ç½®ä¸ªå•è°ƒçš„é¢œè‰²ï¼Œå…¶å®QPenè¿˜å¯ä»¥è®¾ç½®brushï¼Œè¿™æ ·çµæ´»æ€§å°±æé«˜ä¸çŸ¥é“å¤šå°‘å€ï¼Œæ¯”å¦‚è®¾ç½®QPençš„brushä»¥åï¼Œå¯ä»¥ä½¿ç”¨å„ç§æ¸å˜ï¼Œæ¯”å¦‚ç»˜åˆ¶æ¸å˜é¢œè‰²çš„è¿›åº¦æ¡å’Œæ–‡å­—ç­‰ï¼Œè€Œä¸å†æ˜¯å•è°ƒçš„ä¸€ç§é¢œè‰²ã€‚\n\nå¾ˆå¤šæ§ä»¶éƒ½å¸¦æœ‰viewportï¼Œæ¯”å¦‚QTextEdit&#x2F;QTableWidget&#x2F;QScrollAreaï¼Œæœ‰æ—¶å€™å¯¹è¿™äº›æ§ä»¶ç›´æ¥å¤„ç†çš„æ—¶å€™å‘ç°ä¸èµ·ä½œç”¨ï¼Œéœ€è¦å¯¹å…¶viewport()è®¾ç½®æ‰è¡Œï¼Œæ¯”å¦‚è®¾ç½®æ»šåŠ¨æ¡åŒºåŸŸèƒŒæ™¯é€æ˜ï¼Œéœ€è¦ä½¿ç”¨scrollArea-&gt;viewport()-&gt;setStyleSheet(â€œbackground-color:transparent;â€);è€Œä¸æ˜¯scrollArea-&gt;setStyleSheet(â€œQScrollArea{background-color:transparent;}â€);\n\næœ‰æ—¶å€™è®¾ç½®äº†é¼ æ ‡è·Ÿè¸ªsetMouseTrackingä¸ºçœŸï¼Œå¦‚æœè¯¥çª—ä½“ä¸Šé¢è¿˜æœ‰å…¶ä»–æ§ä»¶ï¼Œå½“é¼ æ ‡ç§»åˆ°å…¶ä»–æ§ä»¶ä¸Šé¢çš„æ—¶å€™ï¼Œçˆ¶ç±»çš„é¼ æ ‡ç§»åŠ¨äº‹ä»¶MouseMoveè¯†åˆ«ä¸åˆ°äº†ï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ°HoverMoveäº‹ä»¶ï¼Œéœ€è¦å…ˆè®¾ç½® setAttribute(Qt::WA_Hover, true);\n\nQtå°è£…çš„QDateTimeæ—¥æœŸæ—¶é—´ç±»éå¸¸å¼ºå¤§ï¼Œå¯ä»¥å­—ç¬¦ä¸²å’Œæ—¥æœŸæ—¶é—´ç›¸äº’è½¬æ¢ï¼Œä¹Ÿå¯ä»¥æ¯«ç§’æ•°å’Œæ—¥æœŸæ—¶é—´ç›¸äº’è½¬æ¢ï¼Œè¿˜å¯ä»¥1970ç»è¿‡çš„ç§’æ•°å’Œæ—¥æœŸæ—¶é—´ç›¸äº’è½¬æ¢ç­‰ã€‚\n12345678910QDateTime dateTime;QString dateTime_str = dateTime.currentDateTime().toString(&quot;yyyy-MM-dd hh:mm:ss&quot;);//ä»å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ¯«ç§’ï¼ˆéœ€å®Œæ•´çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰datetime.fromString(&quot;2011-09-10 12:07:50:541&quot;, &quot;yyyy-MM-dd hh:mm:ss:zzz&quot;).toMSecsSinceEpoch();//ä»å­—ç¬¦ä¸²è½¬æ¢ä¸ºç§’ï¼ˆéœ€å®Œæ•´çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰datetime.fromString(&quot;2011-09-10 12:07:50:541&quot;, &quot;yyyy-MM-dd hh:mm:ss:zzz&quot;).toTime_t();//ä»æ¯«ç§’è½¬æ¢åˆ°å¹´æœˆæ—¥æ—¶åˆ†ç§’datetime.fromMSecsSinceEpoch(1315193829218).toString(&quot;yyyy-MM-dd hh:mm:ss:zzz&quot;);//ä»ç§’è½¬æ¢åˆ°å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼ˆè‹¥æœ‰zzzï¼Œåˆ™ä¸º000ï¼‰datetime.fromTime_t(1315193829).toString(&quot;yyyy-MM-dd hh:mm:ss[:zzz]&quot;);\n\n08ï¼š071-080\nåœ¨æˆ‘ä»¬ä½¿ç”¨QListã€QStringListã€QByteArrayç­‰é“¾è¡¨æˆ–è€…æ•°ç»„çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåªéœ€è¦å–å€¼ï¼Œè€Œä¸æ˜¯èµ‹å€¼ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ at() å–å€¼è€Œä¸æ˜¯ [] æ“ä½œç¬¦ï¼Œåœ¨å®˜æ–¹ä¹¦ç±ã€ŠC++ GUI Qt 4ç¼–ç¨‹ï¼ˆç¬¬äºŒç‰ˆï¼‰ã€‹çš„ä¹¦ä¸­æœ‰ç‰¹åˆ«çš„å¼ºè°ƒè¯´æ˜ï¼Œæ­¤æ•™æçš„åŸä½œè€…æ®è¯´æ˜¯Qtå¼€å‘çš„æ ¸å¿ƒäººå‘˜ç¼–å†™çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒæƒå¨ï¼Œè‡³äºä½¿ç”¨ at() ä¸ä½¿ç”¨ [] æ“ä½œç¬¦é€Ÿåº¦æ•ˆç‡çš„æ¯”è¾ƒï¼Œç½‘ä¸Šä¹Ÿæœ‰ç½‘å‹åšè¿‡æ­¤ç±»å¯¹æ¯”ã€‚åŸæ–‡åœ¨ä¹¦çš„212é¡µï¼Œè¿™æ ·æè¿°çš„ï¼šQtå¯¹æ‰€æœ‰çš„å®¹å™¨å’Œè®¸å¤šå…¶ä»–ç±»éƒ½ä½¿ç”¨éšå«å…±äº«ï¼Œéšå«å…±äº«æ˜¯Qtå¯¹ä¸å¸Œæœ›ä¿®æ”¹çš„æ•°æ®å†³ä¸è¿›è¡Œå¤åˆ¶çš„ä¿è¯ï¼Œä¸ºäº†ä½¿éšå«å…±äº«çš„ä½œç”¨å‘æŒ¥å¾—æœ€å¥½ï¼Œå¯ä»¥é‡‡ç”¨ä¸¤ä¸ªæ–°çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚ç¬¬ä¸€ç§ä¹ æƒ¯æ˜¯å¯¹äºä¸€ä¸ªï¼ˆéå¸¸é‡çš„ï¼‰å‘é‡æˆ–è€…åˆ—è¡¨è¿›è¡Œåªè¯»å­˜å–æ—¶ï¼Œä½¿ç”¨ at() å‡½æ•°è€Œä¸ç”¨ [] æ“ä½œç¬¦ï¼Œå› ä¸ºQtçš„å®¹å™¨ç±»ä¸èƒ½è¾¨åˆ« [] æ“ä½œç¬¦æ˜¯å¦å°†å‡ºç°åœ¨ä¸€ä¸ªèµ‹å€¼çš„å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼Œä»–å‡è®¾æœ€åçš„æƒ…å†µå‡ºç°å¹¶ä¸”å¼ºåˆ¶æ‰§è¡Œæ·±å±‚èµ‹å€¼ï¼Œè€Œ at() å‡½æ•°åˆ™ä¸è¢«å…è®¸å‡ºç°åœ¨ä¸€ä¸ªèµ‹å€¼çš„å·¦è¾¹ã€‚\n\nå¦‚æœæ˜¯dialogçª—ä½“ï¼Œéœ€è¦åœ¨execä»¥åè¿˜èƒ½è®©å…¶ä»–ä»£ç ç»§ç»­æ‰§è¡Œï¼Œè¯·åœ¨dialogçª—ä½“execå‰å¢åŠ ä¸€è¡Œä»£ç ï¼Œå¦åˆ™ä¼šé˜»å¡çª—ä½“æ¶ˆæ¯ã€‚\n123QDialog dialog;dialog.setWindowModality(Qt::WindowModal);dialog.exec();\n\nå®‰å…¨çš„åˆ é™¤Qtçš„å¯¹è±¡ç±»ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨deleteLaterè€Œä¸æ˜¯deleteï¼Œå› ä¸ºdeleteLaterä¼šé€‰æ‹©åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œé‡Šæ”¾ï¼Œè€Œdeleteä¼šç«‹å³é‡Šæ”¾ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºé”™å´©æºƒã€‚å¦‚æœè¦æ‰¹é‡åˆ é™¤å¯¹è±¡é›†åˆï¼Œå¯ä»¥ç”¨qDeleteAllï¼Œæ¯”å¦‚ qDeleteAll(btns);\n\nåœ¨QTableViewæ§ä»¶ä¸­ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰çš„åˆ—æŒ‰é’®ã€å¤é€‰æ¡†ã€ä¸‹æ‹‰æ¡†ç­‰å…¶ä»–æ¨¡å¼æ˜¾ç¤ºï¼Œå¯ä»¥é‡‡ç”¨è‡ªå®šä¹‰å§”æ‰˜QItemDelegateæ¥å®ç°ï¼Œå¦‚æœéœ€è¦ç¦ç”¨æŸåˆ—ï¼Œåˆ™åœ¨è‡ªå®šä¹‰å§”æ‰˜çš„é‡è½½createEditorå‡½æ•°è¿”å›0å³å¯ã€‚è‡ªå®šä¹‰å§”æ‰˜å¯¹åº”çš„æ§ä»¶åœ¨è¿›å…¥ç¼–è¾‘çŠ¶æ€çš„æ—¶å€™å‡ºç°ï¼Œå¦‚æœæƒ³ä¸€ç›´å‡ºç°ï¼Œåˆ™éœ€è¦é‡è½½paintå‡½æ•°ç”¨drawPrimitiveæˆ–è€…drawControlæ¥ç»˜åˆ¶ã€‚\n\nå°† QApplication::style() å¯¹åº”çš„drawPrimitiveã€drawControlã€drawItemTextã€drawItemPixmapç­‰å‡ ä¸ªæ–¹æ³•ç”¨ç†Ÿæ‚‰äº†ï¼Œå†ç»“åˆQStyleOptionå±æ€§ï¼Œå¯ä»¥ç©è½¬å„ç§è‡ªå®šä¹‰å§”æ‰˜ï¼Œè¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨paintå‡½æ•°ä¸­çš„painterè¿›è¡Œå„ç§ç»˜åˆ¶ï¼Œå„ç§ç‰›é€¼çš„è¡¨æ ¼ã€æ ‘çŠ¶åˆ—è¡¨ã€ä¸‹æ‹‰æ¡†ç­‰ï¼Œç»å¯¹å±Œç‚¸å¤©ã€‚QApplication::style()-&gt;drawControl çš„ç¬¬4ä¸ªå‚æ•°å¦‚æœä¸è®¾ç½®ï¼Œåˆ™ç»˜åˆ¶å‡ºæ¥çš„æ§ä»¶ä¸ä¼šåº”ç”¨æ ·å¼è¡¨ã€‚\n\nå¿ƒä¸­æœ‰åæ ‡ï¼Œä¸‡ç‰©çš†painterï¼Œå¼ºçƒˆå»ºè®®åœ¨å­¦ä¹ è‡ªå®šä¹‰æ§ä»¶ç»˜åˆ¶çš„æ—¶å€™ï¼Œå°†qpainter.hå¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å…¨éƒ¨çœ‹ä¸€éã€è¯•ä¸€éã€ç†è§£ä¸€éï¼Œè¿™é‡Œè¾¹åŒ…å«äº†æ‰€æœ‰Qtå†…ç½®çš„ç»˜åˆ¶çš„æ¥å£ï¼Œå¯¹åº”çš„å‚æ•°éƒ½è¯•ä¸€éï¼Œä½ ä¼šå‘ç°å¾ˆå¤šæ–°å¤§é™†ï¼Œä¼šä¸€å®šç¨‹åº¦ä¸Šæ¿€å‘ä½ çš„ç»˜åˆ¶çš„å…´è¶£ï¼ŒçŠ¹å¦‚ç¥ç¬”é©¬è‰¯ä¸€èˆ¬ï¼Œç­–é©¬å´©è…¾é¨æ¸¸ä»£ç ç»˜åˆ¶çš„ä¸–ç•Œã€‚\n\nåœ¨ä½¿ç”¨setItemWidgetæˆ–è€…setCellWidgetçš„è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°è®¾ç½®çš„æ§ä»¶æ²¡æœ‰å±…ä¸­æ˜¾ç¤ºè€Œæ˜¯é»˜è®¤çš„å·¦å¯¹é½ï¼Œè€Œä¸”ä¸ä¼šè‡ªåŠ¨æ‹‰ä¼¸å¡«å……ï¼Œå¯¹äºè¿½æ±‚å®Œç¾çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ä¸ªå¯ä¸å¤§å¥½çœ‹ï¼Œæœ‰ä¸ªç»ˆæé€šç”¨åŠæ³•å°±æ˜¯ï¼Œå°†è¿™ä¸ªæ§ä»¶æ”¾åˆ°ä¸€ä¸ªwidgetçš„å¸ƒå±€ä¸­ï¼Œç„¶åå°†widgetæ·»åŠ åˆ°itemä¸­ï¼Œè¿™æ ·å°±å®Œç¾è§£å†³äº†ï¼Œè€Œä¸”è¿™æ ·å¯ä»¥ç»„åˆå¤šä¸ªæ§ä»¶äº§ç”Ÿå¤æ‚çš„æ§ä»¶ã€‚\n12345678910//å®ä¾‹åŒ–è¿›åº¦æ¡æ§ä»¶QProgressBar *progress = new QProgressBar;//å¢åŠ widget+å¸ƒå±€å·§å¦™å®ç°å±…ä¸­QWidget *widget = new QWidget;QHBoxLayout *layout = new QHBoxLayout;layout-&gt;setSpacing(0);layout-&gt;setMargin(0);layout-&gt;addWidget(progress);widget-&gt;setLayout(layout);ui-&gt;tableWidget-&gt;setCellWidget(0, 0, widget);\n\nå¾ˆå¤šæ—¶å€™éœ€è¦åœ¨å·²çŸ¥èƒŒæ™¯è‰²çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿæ¸…æ™°çš„ç»˜åˆ¶æ–‡å­—ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è®¡ç®—å¯¹åº”çš„æ–‡å­—é¢œè‰²ã€‚\n123//æ ¹æ®èƒŒæ™¯è‰²è‡ªåŠ¨è®¡ç®—åˆé€‚çš„å‰æ™¯è‰²double gray = (0.299 * color.red() + 0.587 * color.green() + 0.114 * color.blue()) / 255;QColor textColor = gray &gt; 0.5 ? Qt::black : Qt::white;\n\nå¯¹QTableViewã€QTableWidgetã€QTreeViewã€QTreeWidgetç¦ç”¨åˆ—æ‹–åŠ¨ã€‚\n1234567#if (QT_VERSION &lt; QT_VERSION_CHECK(5,0,0))    ui-&gt;tableView-&gt;horizontalHeader()-&gt;setResizeMode(0, QHeaderView::Fixed);    ui-&gt;treeView-&gt;header()-&gt;setResizeMode(0, QHeaderView::Fixed);#else    ui-&gt;tableView-&gt;horizontalHeader()-&gt;setSectionResizeMode(0, QHeaderView::Fixed);    ui-&gt;treeView-&gt;header()-&gt;setSectionResizeMode(0, QHeaderView::Fixed);#endif\n\nä»Qt4è½¬åˆ°Qt5ï¼Œæœ‰äº›ç±»çš„æ–¹æ³•å·²ç»åºŸå¼ƒæˆ–è€…è¿‡æ—¶äº†ï¼Œå¦‚æœæƒ³è¦åœ¨Qt5ä¸­å¯ç”¨Qt4çš„æ–¹æ³•ï¼Œæ¯”å¦‚QHeadVewçš„setMovableï¼Œå¯ä»¥åœ¨ä½ çš„proæˆ–è€…priæ–‡ä»¶ä¸­åŠ ä¸Šä¸€è¡Œå³å¯ï¼šDEFINES +&#x3D; QT_DISABLE_DEPRECATED_BEFORE&#x3D;0\n\n\n09ï¼š081-090\nQtä¸­çš„QColorå¯¹é¢œè‰²å°è£…çš„å¾ˆå®Œç¾ï¼Œæ”¯æŒå„ç§è½¬æ¢ï¼Œæ¯”å¦‚rgbã€hsbã€cmyã€hslï¼Œå¯¹åº”çš„æ˜¯toRgbã€toHsvã€toCmykã€toHslï¼Œè¿˜æ”¯æŒé€æ˜åº¦è®¾ç½®ï¼Œé¢œè‰²å€¼è¿˜èƒ½è½¬æˆ16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºã€‚\n123QColor color(255, 0, 0, 100);qDebug() &lt;&lt; color.name() &lt;&lt; color.name(QColor::HexArgb);//è¾“å‡º #ff0000 #64ff0000\n\nQVariantç±»å‹å¼‚å¸¸çš„å¼ºå¤§ï¼Œå¯ä»¥è¯´æ˜¯ä¸‡èƒ½çš„ç±»å‹ï¼Œåœ¨è¿›è¡Œé…ç½®æ–‡ä»¶çš„å­˜å‚¨çš„æ—¶å€™ï¼Œç»å¸¸ä¼šç”¨åˆ°QVariantçš„è½¬æ¢ï¼ŒQVarianté»˜è®¤è‡ªå¸¦äº†toStringã€toFloatç­‰å„ç§è½¬æ¢ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å¤Ÿï¼Œæ¯”å¦‚æœ‰æ—¶å€™éœ€è¦ä»QVariantè½¬åˆ°QColorï¼Œè€Œå´æ²¡æœ‰æä¾›toColorçš„å‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°ä¸‡èƒ½åŠæ³•ã€‚\n12345if (variant.typeName() == &quot;QColor&quot;) &#123;    QColor color = variant.value&lt;QColor&gt;();    QFont font = variant.value&lt;QFont&gt;();    QString nodeValue = color.name(QColor::HexArgb);&#125;\n\nQtä¸­çš„QStringå’Œconst char *ä¹‹é—´è½¬æ¢ï¼Œæœ€å¥½ç”¨toStdString().c_str()è€Œä¸æ˜¯toLocal8Bit().constData()ï¼Œæ¯”å¦‚åœ¨setPropertyä¸­å¦‚æœç”¨åè€…ï¼Œå­—ç¬¦ä¸²ä¸­æ–‡å°±ä¼šä¸æ­£ç¡®ï¼Œè‹±æ–‡æ­£å¸¸ã€‚\n\nQtçš„ä¿¡å·æ§½æœºåˆ¶éå¸¸ç‰›é€¼ï¼Œä¹Ÿæ˜¯Qtçš„ç‹¬ç‰¹çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬åœ¨å¾ˆå¤šçª—ä½“ä¸­ä¼ é€’ä¿¡å·æ¥å®ç°æ›´æ–°æˆ–è€…å¤„ç†ï¼Œå¦‚æœçª—ä½“å±‚çº§æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚çª—ä½“Açš„çˆ¶ç±»æ˜¯çª—ä½“Bï¼Œçª—ä½“Bçš„çˆ¶ç±»æ˜¯çª—ä½“Cï¼Œçª—ä½“Cæœ‰ä¸ªå­çª—ä½“Dï¼Œå¦‚æœçª—ä½“Aä¸€ä¸ªä¿¡å·è¦ä¼ é€’ç»™çª—ä½“Dï¼Œé—®é¢˜æ¥äº†ï¼Œå¿…é¡»å…ˆç»è¿‡çª—ä½“Bä¸­è½¬åˆ°çª—ä½“Cå†åˆ°çª—ä½“Dæ‰è¡Œï¼Œè¿™æ ·çš„è¯å„ç§ä¿¡å·å…³è”ä¿¡å·çš„connectä¼šéå¸¸å¤šè€Œä¸”ç®¡ç†èµ·æ¥æ¯”è¾ƒä¹±ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ ä¸€ä¸ªå…¨å±€çš„å•ä¾‹ç±»AppEventï¼Œå…¬å…±çš„ä¿¡å·æ”¾è¿™é‡Œï¼Œç„¶åçª—ä½“Aå¯¹åº”ä¿¡å·ç»‘å®šåˆ°AppEventï¼Œçª—ä½“Dç»‘å®šAppEventçš„ä¿¡å·åˆ°å¯¹åº”çš„æ§½å‡½æ•°å³å¯ï¼Œå¹²å‡€æ¸…çˆ½æ•´æ´ã€‚\n\nQTextEditå³é”®èœå•é»˜è®¤è‹±æ–‡çš„ï¼Œå¦‚æœæƒ³è¦ä¸­æ–‡æ˜¾ç¤ºï¼ŒåŠ è½½widgets.qmæ–‡ä»¶å³å¯ï¼Œä¸€ä¸ªQtç¨‹åºä¸­å¯ä»¥å®‰è£…å¤šä¸ªç¿»è¯‘æ–‡ä»¶ï¼Œä¸å†²çªã€‚\n\nQtä¸­æœ‰ä¸ªå…¨å±€çš„ç„¦ç‚¹åˆ‡æ¢ä¿¡å·focusChangedï¼Œå¯ä»¥ç”¨å®ƒåšè‡ªå®šä¹‰çš„è¾“å…¥æ³•ã€‚Qt4ä¸­é»˜è®¤ä¼šå®‰è£…è¾“å…¥æ³•ä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚åœ¨mainå‡½æ•°æ‰“å°a.inputContextä¼šæ˜¾ç¤ºå€¼ï¼Œè¿™ä¸ªé»˜è®¤å®‰è£…çš„è¾“å…¥æ³•ä¸Šä¸‹æ–‡ï¼Œä¼šæ‹¦æˆªä¸¤ä¸ªç‰›é€¼çš„ä¿¡å·QEvent::RequestSoftwareInputPanelå’ŒQEvent::CloseSoftwareInputPanelï¼Œä»¥è‡³äºå°±ç®—ä½ å®‰è£…äº†å…¨å±€çš„äº‹ä»¶è¿‡æ»¤å™¨ä¾ç„¶è¯†åˆ«ä¸åˆ°è¿™ä¸¤ä¸ªä¿¡å·ï¼Œä½ åªéœ€è¦åœ¨mainå‡½æ•°æ‰§è¡Œa.setInputContext(0)å³å¯ï¼Œæ„æ€æ˜¯å®‰è£…è¾“å…¥æ³•ä¸Šä¸‹æ–‡ä¸ºç©ºã€‚Qt5.7ä»¥åæä¾›äº†å†…ç½®çš„è¾“å…¥æ³•ï¼Œå¯ä»¥é€šè¿‡åœ¨mainå‡½æ•°æœ€å‰é¢åŠ ä¸Š qputenv(â€œQT_IM_MODULEâ€, QByteArray(â€œqtvirtualkeyboardâ€)); æ¥å¯ç”¨ã€‚\n\nåœ¨Qt5.10ä»¥åï¼Œè¡¨æ ¼æ§ä»¶QTableWidgetæˆ–è€…QTableViewçš„é»˜è®¤æœ€å°åˆ—å®½æ”¹æˆäº†15ï¼Œä»¥å‰çš„ç‰ˆæœ¬æ˜¯0ï¼Œæ‰€ä»¥åœ¨æ–°ç‰ˆçš„qtä¸­ï¼Œå¦‚æœè®¾ç½®è¡¨æ ¼çš„åˆ—å®½è¿‡å°ï¼Œä¸ä¼šåº”ç”¨ï¼Œå–çš„æ˜¯æœ€å°çš„åˆ—å®½ã€‚æ‰€ä»¥å¦‚æœè¦è®¾ç½®æ›´å°çš„åˆ—å®½éœ€è¦é‡æ–°è®¾ç½®ui-&gt;tableView-&gt;horizontalHeader()-&gt;setMinimumSectionSize(0);\n\nQtæºç ä¸­å†…ç½®äº†ä¸€äº›æœªå…¬å¼€çš„ä¸èƒ½ç›´æ¥ä½¿ç”¨çš„é»‘ç§‘æŠ€ï¼Œéƒ½è—åœ¨å¯¹åº”æ¨¡å—çš„privateä¸­ï¼Œæ¯”å¦‚gui-private widgets-privateç­‰ï¼Œæ¯”å¦‚zipæ–‡ä»¶è§£å‹ç±»QZipReaderã€å‹ç¼©ç±»QZipWriterå°±åœ¨gui-privateæ¨¡å—ä¸­ï¼Œéœ€è¦åœ¨proä¸­å¼•å…¥QT +&#x3D; gui-privateæ‰èƒ½ä½¿ç”¨ã€‚\n12345678910111213141516171819202122232425#include &quot;QtGui/private/qzipreader_p.h&quot;#include &quot;QtGui/private/qzipwriter_p.h&quot;QZipReader reader(dirPath);QString path(&quot;&quot;);//è§£å‹æ–‡ä»¶å¤¹åˆ°å½“å‰ç›®å½•reader.extractAll(path);//æ–‡ä»¶å¤¹åç§°QZipReader::FileInfo fileInfo = reader.entryInfoAt(0);//è§£å‹æ–‡ä»¶QFile file(filePath);file.open(QIODevice::WriteOnly);file.write(reader.fileData(QString::fromLocal8Bit(&quot;%1&quot;).arg(filePath)));file.close();reader.close();QZipWriter *writer = new QZipWriter(dirPath);//æ·»åŠ æ–‡ä»¶å¤¹writer-&gt;addDirectory(unCompress);//æ·»åŠ æ–‡ä»¶QFile file(filePath);file.open(QIODevice::ReadOnly);writer-&gt;addFile(data, file.readAll());file.close();writer-&gt;close();\n\nç†è®ºä¸Šä¸²å£å’Œç½‘ç»œæ”¶å‘æ•°æ®éƒ½æ˜¯é»˜è®¤å¼‚æ­¥çš„ï¼Œæ“ä½œç³»ç»Ÿè‡ªåŠ¨è°ƒåº¦ï¼Œå®Œå…¨ä¸ä¼šå¡ä½ç•Œé¢ï¼Œç½‘ä¸Šé‚£äº›è¯´æ”¶å‘æ•°æ®å¡ä½ç•Œé¢ä¸»çº¿ç¨‹çš„éƒ½æ˜¯æ‰¯å‡ æŠŠè›‹ï¼ŒçœŸæ­£çš„è€—æ—¶æ˜¯åœ¨è¿ç®—ä»¥åŠè¿ç®—åçš„å¤„ç†ï¼Œè€Œä¸æ˜¯æ”¶å‘æ•°æ®ï¼Œåœ¨ä¸€äº›å°æ•°æ®é‡è¿ç®—å¤„ç†çš„é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬ä¸å»ºè®®åŠ¨ç”¨çº¿ç¨‹å»å¤„ç†ï¼Œçº¿ç¨‹éœ€è¦è°ƒåº¦å¼€é”€çš„ï¼Œä¸è¦ä»€ä¹ˆä¸œè¥¿éƒ½å¾€çº¿ç¨‹é‡Œè¾¹æ‰”ï¼Œçº¿ç¨‹ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åªæœ‰å½“çœŸæ­£éœ€è¦å°†ä¸€äº›å¾ˆè€—æ—¶çš„æ“ä½œæ¯”å¦‚ç¼–ç è§£ç ç­‰ï¼Œæ‰éœ€è¦ç§»åˆ°çº¿ç¨‹å¤„ç†ã€‚\n\nåœ¨æ„é€ å‡½æ•°ä¸­è·å–æ§ä»¶çš„å®½é«˜å¾ˆå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ï¼Œéœ€è¦åœ¨æ§ä»¶é¦–æ¬¡æ˜¾ç¤ºä»¥åå†è·å–æ‰æ˜¯æ­£ç¡®çš„ï¼Œæ§ä»¶æ˜¯åœ¨é¦–æ¬¡æ˜¾ç¤ºä»¥åæ‰ä¼šè®¾ç½®å¥½æ­£ç¡®çš„å®½é«˜å€¼ï¼Œè®°ä½æ˜¯åœ¨é¦–æ¬¡æ˜¾ç¤ºä»¥åï¼Œè€Œä¸æ˜¯æ„é€ å‡½æ•°æˆ–è€…ç¨‹åºå¯åŠ¨å¥½ä»¥åï¼Œå¦‚æœç¨‹åºå¯åŠ¨å¥½ä»¥åæœ‰äº›å®¹å™¨æ§ä»¶æ¯”å¦‚QTabWidgetä¸­çš„æ²¡æœ‰æ˜¾ç¤ºçš„é¡µé¢çš„æ§ä»¶ï¼Œä½ å»è·å–å®½é«˜å¾ˆå¯èƒ½ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ï¼Œä¸‡æ— ä¸€å¤±çš„åŠæ³•å°±æ˜¯é¦–æ¬¡æ˜¾ç¤ºä»¥åå»è·å–ã€‚\n\n\n10ï¼š091-100\næ•°æ®åº“å¤„ç†ä¸€èˆ¬å»ºè®®åœ¨ä¸»çº¿ç¨‹ï¼Œå¦‚æœéè¦åœ¨å…¶ä»–çº¿ç¨‹ï¼ŒåŠ¡å¿…è®°å¾—æ‰“å¼€æ•°æ®åº“ä¹Ÿè¦åœ¨é‚£ä¸ªçº¿ç¨‹ï¼Œå³åœ¨é‚£ä¸ªçº¿ç¨‹ä½¿ç”¨æ•°æ®åº“å°±åœ¨é‚£ä¸ªçº¿ç¨‹æ‰“å¼€ï¼Œä¸èƒ½æ‰“å¼€æ•°æ®åº“åœ¨ä¸»çº¿ç¨‹ï¼Œæ‰§è¡Œsqlåœ¨å­çº¿ç¨‹ï¼Œå¾ˆå¯èƒ½å‡ºé—®é¢˜ã€‚\n\næ–°ç‰ˆçš„QTcpServerç±»åœ¨64ä½ç‰ˆæœ¬çš„Qtä¸‹å¾ˆå¯èƒ½ä¸ä¼šè¿›å…¥incomingConnectionå‡½æ•°ï¼Œé‚£æ˜¯å› ä¸ºQt5å¯¹åº”çš„incomingConnectionå‡½æ•°å‚æ•°å˜äº†ï¼Œç”±ä¹‹å‰çš„intæ”¹æˆäº†qintptrï¼Œæ”¹æˆqintptræœ‰ä¸ªå¥½å¤„ï¼Œåœ¨32ä½ä¸Šè‡ªåŠ¨æ˜¯quint32è€Œåœ¨64ä½ä¸Šè‡ªåŠ¨æ˜¯quint64ï¼Œå¦‚æœåœ¨Qt5ä¸­ç»§ç»­å†™çš„å‚æ•°æ˜¯intåˆ™åœ¨32ä½ä¸Šæ²¡æœ‰é—®é¢˜åœ¨64ä½ä¸Šæ‰æœ‰é—®é¢˜ï¼Œæ‰€ä»¥ä¸ºäº†å…¼å®¹Qt4å’ŒQt5ï¼Œå¿…é¡»æŒ‰ç…§ä¸ä¸€æ ·çš„å‚æ•°å†™ã€‚\n12345#if (QT_VERSION &gt; QT_VERSION_CHECK(5,0,0))    void incomingConnection(qintptr handle);#else    void incomingConnection(int handle);#endif\n\nQtæ”¯æŒæ‰€æœ‰çš„ç•Œé¢æ§ä»¶æ¯”å¦‚QPushButtonã€QLineEditè‡ªåŠ¨å…³è” on_æ§ä»¶å_ä¿¡å·(å‚æ•°) ä¿¡å·æ§½ï¼Œæ¯”å¦‚æŒ‰é’®çš„å•å‡»ä¿¡å· on_pushButton_clicked()ï¼Œç„¶åç›´æ¥å®ç°æ§½å‡½æ•°å³å¯ã€‚\n\nQWebEngineViewæ§ä»¶ç”±äºä½¿ç”¨äº†openglï¼Œåœ¨æŸäº›ç”µè„‘ä¸Šå¯èƒ½ç”±äºopenglçš„é©±åŠ¨è¿‡ä½ä¼šå¯¼è‡´èŠ±å±æˆ–è€…å„ç§å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ¯”å¦‚showfullscreençš„æƒ…å†µä¸‹é¼ æ ‡å³é”®å¤±æ•ˆï¼Œéœ€è¦åœ¨mainå‡½æ•°å¯ç”¨è½¯ä»¶openglæ¸²æŸ“ã€‚\n123456#if (QT_VERSION &gt; QT_VERSION_CHECK(5,4,0))    //ä¸‹é¢ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥,Qté»˜è®¤é‡‡ç”¨çš„æ˜¯AA_UseDesktopOpenGL    QCoreApplication::setAttribute(Qt::AA_UseOpenGLES);    //QCoreApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);#endif    QApplication a(argc, argv);\nå¦å¤–ä¸€ä¸ªæ–¹æ³•è§£å†³ å…¨å±+QWebEngineViewæ§ä»¶ä¸€èµ·ä¼šäº§ç”Ÿå³é”®èœå•æ— æ³•å¼¹å‡ºçš„bug,éœ€è¦ä¸Šç§»ä¸€ä¸ªåƒç´ \n1234QRect rect = qApp-&gt;desktop()-&gt;geometry();rect.setY(-1);rect.setHeight(rect.height());this-&gt;setGeometry(rect);\n\nQStyleå†…ç½®äº†å¾ˆå¤šæ–¹æ³•ç”¨å¤„å¾ˆå¤§ï¼Œæ¯”å¦‚ç²¾ç¡®è·å–æ»‘åŠ¨æ¡é¼ æ ‡æŒ‰ä¸‹å¤„çš„å€¼ã€‚\n1QStyle::sliderValueFromPosition(minimum(), maximum(), event-&gt;x(), width());\n\nç”¨QFileè¯»å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œæ¨èç”¨QTextStreamæ–‡ä»¶æµçš„æ–¹å¼æ¥è¯»å†™æ–‡ä»¶ï¼Œé€Ÿåº¦å¿«å¾ˆå¤šï¼ŒåŸºæœ¬ä¸Šä¼šæœ‰30%çš„æå‡ï¼Œæ–‡ä»¶è¶Šå¤§æ€§èƒ½åŒºåˆ«è¶Šå¤§ã€‚\n123456789101112131415161718//ä»æ–‡ä»¶åŠ è½½è‹±æ–‡å±æ€§ä¸ä¸­æ–‡å±æ€§å¯¹ç…§è¡¨QFile file(&quot;:/propertyname.txt&quot;);if (file.open(QFile::ReadOnly)) &#123;    //QTextStreamæ–¹æ³•è¯»å–é€Ÿåº¦è‡³å°‘å¿«ç™¾åˆ†ä¹‹30#if 0    while(!file.atEnd()) &#123;        QString line = file.readLine();        appendName(line);    &#125;#else    QTextStream in(&amp;file);    while (!in.atEnd()) &#123;        QString line = in.readLine();        appendName(line);    &#125;#endif    file.close();&#125;\n\nç”¨QFile.readAll()è¯»å–QSSæ–‡ä»¶é»˜è®¤æ˜¯ANSIæ ¼å¼ï¼Œä¸æ”¯æŒUTF8ï¼Œå¦‚æœåœ¨QtCreatorä¸­æ‰“å¼€qssæ–‡ä»¶æ¥ç¼–è¾‘ä¿å­˜ï¼Œè¿™æ ·å¾ˆå¯èƒ½å¯¼è‡´qssåŠ è½½ä»¥åæ²¡æœ‰æ•ˆæœã€‚\n123456789101112131415161718192021222324252627282930void frmMain::initStyle()&#123;    //åŠ è½½æ ·å¼è¡¨    QString qss;    //QFile file(&quot;:/qss/psblack.css&quot;);    //QFile file(&quot;:/qss/flatwhite.css&quot;);    QFile file(&quot;:/qss/lightblue.css&quot;);    if (file.open(QFile::ReadOnly)) &#123;#if 1        //ç”¨QTextStreamè¯»å–æ ·å¼æ–‡ä»¶ä¸ç”¨åŒºåˆ†æ–‡ä»¶ç¼–ç  å¸¦bomä¹Ÿè¡Œ        QStringList list;        QTextStream in(&amp;file);        //in.setCodec(&quot;utf-8&quot;);        while (!in.atEnd()) &#123;            QString line;            in &gt;&gt; line;            list &lt;&lt; line;        &#125;        qss = list.join(&quot;\\n&quot;);#else        //ç”¨readAllè¯»å–é»˜è®¤æ”¯æŒçš„æ˜¯ANSIæ ¼å¼,å¦‚æœä¸å°å¿ƒç”¨creatoræ‰“å¼€ç¼–è¾‘è¿‡äº†å¾ˆå¯èƒ½æ‰“ä¸å¼€        qss = QLatin1String(file.readAll());#endif        QString paletteColor = qss.mid(20, 7);        qApp-&gt;setPalette(QPalette(QColor(paletteColor)));        qApp-&gt;setStyleSheet(qss);        file.close();    &#125;&#125;\n\nQStringå†…ç½®äº†å¾ˆå¤šè½¬æ¢å‡½æ•°ï¼Œæ¯”å¦‚å¯ä»¥è°ƒç”¨toDoubleè½¬ä¸ºdoubleæ•°æ®ï¼Œä½†æ˜¯å½“ä½ è½¬å®Œå¹¶æ‰“å°çš„æ—¶å€™ä½ ä¼šå‘ç°ç²¾ç¡®å°‘äº†ï¼Œåªå‰©ä¸‹ä¸‰ä½äº†ï¼Œå…¶å®åŸå§‹æ•°æ®è¿˜æ˜¯å®Œæ•´çš„ç²¾ç¡®åº¦çš„ï¼Œåªæ˜¯æ‰“å°çš„æ—¶å€™ä¼˜åŒ–æˆäº†ä¸‰ä½ï¼Œå¦‚æœè¦ä¿è¯å®Œæ•´çš„ç²¾ç¡®åº¦ï¼Œå¯ä»¥è°ƒç”¨ qSetRealNumberPrecision å‡½æ•°è®¾ç½®ç²¾ç¡®åº¦ä½æ•°å³å¯ã€‚\n1234QString s1, s2;s1 = &quot;666.5567124&quot;;s2.setNum(888.5632123, &#x27;f&#x27;, 7);qDebug() &lt;&lt; qSetRealNumberPrecision(10) &lt;&lt; s1.toDouble() &lt;&lt; s2.toDouble();\n\nç”¨QScriptValueIteratorè§£ææ•°æ®çš„æ—¶å€™ï¼Œä¼šå‘ç°æ€»æ˜¯ä¼šå¤šä¸€ä¸ªèŠ‚ç‚¹å†…å®¹ï¼Œå¹¶ä¸”å†…å®¹ä¸ºç©ºï¼Œå¦‚æœéœ€è¦è·³è¿‡åˆ™å¢åŠ ä¸€è¡Œä»£ç ã€‚\n123456while (it.hasNext()) &#123;    it.next();        if (it.flags() &amp; QScriptValue::SkipInEnumeration)             continue;         qDebug() &lt;&lt; it.name();&#125;\n\nsetPixmapæ˜¯æœ€ç³Ÿç³•çš„è´´å›¾æ–¹å¼ï¼Œä¸€èˆ¬åªç”¨æ¥ç®€å•çš„ä¸æ˜¯å¾ˆé¢‘ç¹çš„è´´å›¾ï¼Œé¢‘ç¹çš„å»ºè®®painterç»˜åˆ¶ï¼Œé»˜è®¤åŒç¼“å†²ï¼Œåœ¨é«˜çº§ç‚¹ç”¨openglç»˜åˆ¶ï¼Œåˆ©ç”¨GPUã€‚\n\n\n11ï¼š101-110\nå¦‚æœéœ€è¦åœ¨å°ºå¯¸æ”¹å˜çš„æ—¶å€™ä¸é‡ç»˜çª—ä½“ï¼Œåˆ™è®¾ç½®å±æ€§å³å¯ this-&gt;setAttribute(Qt::WA_StaticContents, true); è¿™æ ·å¯ä»¥é¿å…å¯¹å·²ç»æ˜¾ç¤ºåŒºåŸŸçš„é‡æ–°ç»˜åˆ¶ã€‚\n\né»˜è®¤ç¨‹åºä¸­è·å–ç„¦ç‚¹ä»¥åä¼šæœ‰è™šè¾¹æ¡†ï¼Œå¦‚æœçœ‹ç€è§‰å¾—ç¢çœ¼ä¸èˆ’æœå¯ä»¥å»æ‰ï¼Œè®¾ç½®æ ·å¼å³å¯ï¼šsetStyleSheet(â€œ*{outline:0px;}â€);\n\nQtè¡¨æ ¼æ§ä»¶ä¸€äº›å¸¸ç”¨çš„è®¾ç½®å°è£…ï¼ŒQTableWidgetç»§æ‰¿è‡ªQTableViewï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸ªå‡½æ•°æ”¯æŒä¼ å…¥QTableWidgetã€‚\n1234567891011121314151617181920212223242526272829303132333435void QUIHelper::initTableView(QTableView *tableView, int rowHeight, bool headVisible, bool edit)&#123;    //å¥‡æ•°å¶æ•°è¡Œé¢œè‰²äº¤æ›¿    tableView-&gt;setAlternatingRowColors(false);    //å‚ç›´è¡¨å¤´æ˜¯å¦å¯è§    tableView-&gt;verticalHeader()-&gt;setVisible(headVisible);    //é€‰ä¸­ä¸€è¡Œè¡¨å¤´æ˜¯å¦åŠ ç²—    tableView-&gt;horizontalHeader()-&gt;setHighlightSections(false);    //æœ€åä¸€è¡Œæ‹‰ä¼¸å¡«å……    tableView-&gt;horizontalHeader()-&gt;setStretchLastSection(true);    //è¡Œæ ‡é¢˜æœ€å°å®½åº¦å°ºå¯¸    tableView-&gt;horizontalHeader()-&gt;setMinimumSectionSize(0);    //è¡Œæ ‡é¢˜æœ€å¤§é«˜åº¦    tableView-&gt;horizontalHeader()-&gt;setMaximumHeight(rowHeight);    //é»˜è®¤è¡Œé«˜    tableView-&gt;verticalHeader()-&gt;setDefaultSectionSize(rowHeight);    //é€‰ä¸­æ—¶ä¸€è¡Œæ•´ä½“é€‰ä¸­    tableView-&gt;setSelectionBehavior(QAbstractItemView::SelectRows);    //åªå…è®¸é€‰æ‹©å•ä¸ª    tableView-&gt;setSelectionMode(QAbstractItemView::SingleSelection);    //è¡¨å¤´ä¸å¯å•å‡»#if (QT_VERSION &gt; QT_VERSION_CHECK(5,0,0))    tableView-&gt;horizontalHeader()-&gt;setSectionsClickable(false);#else    tableView-&gt;horizontalHeader()-&gt;setClickable(false);#endif    //é¼ æ ‡æŒ‰ä¸‹å³è¿›å…¥ç¼–è¾‘æ¨¡å¼    if (edit) &#123;        tableView-&gt;setEditTriggers(QAbstractItemView::CurrentChanged | QAbstractItemView::DoubleClicked);    &#125; else &#123;        tableView-&gt;setEditTriggers(QAbstractItemView::NoEditTriggers);    &#125;&#125;\n\nåœ¨ä¸€äº›å¤§çš„é¡¹ç›®ä¸­ï¼Œå¯èƒ½åµŒå¥—äº†å¾ˆå¤šå­é¡¹ç›®ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°å­é¡¹ç›®ä¾èµ–å…¶ä»–å­é¡¹ç›®çš„æ—¶å€™ï¼Œæ¯”å¦‚ä¸€éƒ¨åˆ†å­é¡¹ç›®ç”¨æ¥ç”ŸæˆåŠ¨æ€åº“ï¼Œä¸€éƒ¨åˆ†å­é¡¹ç›®ä¾èµ–è¿™ä¸ªåŠ¨æ€åº“è¿›è¡Œç¼–è¯‘ï¼Œæ­¤æ—¶å°±éœ€è¦å­é¡¹ç›®æŒ‰ç…§é¡ºåºç¼–è¯‘æˆ–è€…è®¾ç½®å¥½ä¾èµ–è§„åˆ™ã€‚\n12345678910TEMPLATE = subdirs#è®¾ç½®orderedå‚æ•°ä»¥åä¼šä¾æ¬¡ç¼–è¯‘ projA projB projCCONFIG  += orderedSUBDIRS += projASUBDIRS += projBSUBDIRS += projC#è¿˜å¯ä»¥é€šè¿‡è®¾ç½®dependsæŒ‡å®šæŸä¸ªé¡¹ç›®ä¾èµ– æ¯”å¦‚ä¸‹é¢æŒ‡å®šprojBä¾èµ–projAprojB.depends = projAprojC.depends = projAprojD.depends = projC\n\nMSVCç¼–è¯‘å™¨çš„é€‰æ‹©è¯´æ˜\n\n\n\nå¦‚æœæ˜¯32ä½çš„Qtåˆ™ç¼–è¯‘å™¨é€‰æ‹©x86å¼€å¤´çš„\nå¦‚æœæ˜¯64ä½çš„Qtåˆ™ç¼–è¯‘å™¨é€‰æ‹©amd64å¼€å¤´çš„\nå…·ä½“æ˜¯çœ‹å®‰è£…çš„Qtæ„å»ºå¥—ä»¶ç‰ˆæœ¬ä»¥åŠç›®æ ‡è¿è¡Œå¹³å°çš„ç³»ç»Ÿä½æ•°å’Œæ¶æ„\nä¸€èˆ¬ç°åœ¨çš„ç”µè„‘é»˜è®¤ä»¥64ä½çš„å±…å¤šï¼Œé€‰æ‹©amd64å³å¯\nå¦‚æœç”¨æˆ·éœ€è¦å…¼å®¹32ä½çš„ç³»ç»Ÿåˆ™å»ºè®®é€‰æ‹©32ä½çš„Qtï¼Œè¿™æ ·å³å¯åœ¨32ä½ä¹Ÿå¯ä»¥åœ¨64ä½ç³»ç»Ÿè¿è¡Œ\nè¯¸è‘›å¤§ä½¬è¡¥å……ï¼šx86&#x2F;x64éƒ½æ˜¯ç¼–è¯‘ç¯å¢ƒå’Œè¿è¡Œç¯å¢ƒç›¸åŒï¼Œæ²¡æœ‰æˆ–ã€‚å¸¦ä¸‹åˆ’çº¿çš„å°±æ˜¯äº¤å‰ç¼–è¯‘ï¼Œå‰é¢æ˜¯ç¼–è¯‘ç¯å¢ƒï¼Œåé¢æ˜¯è¿è¡Œç¯å¢ƒã€‚\n\n\n\n\nåç§°\nè¯´æ˜\n\n\n\nx86\n32&#x2F;64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨32&#x2F;64ä½ç³»ç»Ÿä¸Šè¿è¡Œ\n\n\nx86_amd64\n32&#x2F;64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨64ä½ç³»ç»Ÿä¸Šè¿è¡Œ\n\n\nx86_arm\n32&#x2F;64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨armç³»ç»Ÿä¸Šè¿è¡Œ\n\n\namd64\n64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨64ä½ç³»ç»Ÿä¸Šè¿è¡Œ\n\n\namd64_x86\n64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨32&#x2F;64ä½ç³»ç»Ÿä¸Šè¿è¡Œ\n\n\namd64_arm\n64ä½ç³»ç»Ÿä¸Šç¼–è¯‘åœ¨armç³»ç»Ÿä¸Šè¿è¡Œ\n\n\n\nå¾ˆå¤šæ—¶å€™ç”¨QDialogçš„æ—¶å€™ä¼šå‘ç°é˜»å¡äº†æ¶ˆæ¯ï¼Œè€Œæœ‰çš„æ—¶å€™æˆ‘ä»¬å¸Œæœ›æ˜¯åå°çš„ä¸€äº›æ¶ˆæ¯ç»§ç»­è¿è¡Œä¸è¦ç»ˆæ­¢ï¼Œæ­¤æ—¶éœ€è¦åšä¸ªè®¾ç½®ã€‚\n12QDialog dialog;dialog.setWindowModality(Qt::WindowModal);\n\nå¾ˆå¤šåˆå­¦è€…ç”šè‡³å‡ å¹´å·¥ä½œç»éªŒçš„äººï¼Œå¯¹å¤šçº¿ç¨‹æœ‰å¾ˆæ·±çš„è¯¯è§£å’Œæ»¥ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ä¸²å£å’Œç½‘ç»œé€šä¿¡è¿™å—ï¼Œä»€ä¹ˆéƒ½å¾€å¤šçº¿ç¨‹é‡Œé¢ä¸¢ï¼Œä¸€æ—¦é‡åˆ°ç•Œé¢å¡ï¼Œå°±æŠŠæ•°æ®æ”¶å‘å•¥çš„éƒ½æåˆ°å¤šçº¿ç¨‹é‡Œé¢å»ï¼Œæ®Šä¸çŸ¥ç»å¤§éƒ¨åˆ†æ—¶å€™é‚£æ ¹æœ¬æ²¡å•¥ç”¨ï¼Œå› ä¸ºæ²¡æ‰¾åˆ°å‡ºé—®é¢˜çš„æ ¹æºã€‚\n\n\n\nå¦‚æœä½ æ²¡æœ‰ä½¿ç”¨wait***å‡½æ•°çš„è¯ï¼Œå¤§éƒ¨åˆ†çš„ç•Œé¢å¡éƒ½å‡ºåœ¨æ•°æ®å¤„ç†å’Œå±•ç¤ºä¸­ï¼Œæ¯”å¦‚ä¼ è¿‡æ¥çš„æ˜¯ä¸€å¼ å›¾ç‰‡çš„æ•°æ®ï¼Œä½ éœ€è¦å°†è¿™äº›æ•°æ®è½¬æˆå›¾ç‰‡ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯è€—æ—¶çš„ï¼›\nè¿˜æœ‰å°±æ˜¯å°±æ”¶åˆ°çš„æ•°æ®æ›²çº¿ç»˜åˆ¶å‡ºæ¥ï¼Œå¦‚æœè¿‡äºé¢‘ç¹æˆ–è€…é—´éš”è¿‡çŸ­ï¼Œè‚¯å®šä¼šç»™UIé€ æˆå¾ˆå¤§çš„å‹åŠ›çš„ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯è§£å†³å¦‚ä½•ä¸è¦é¢‘ç¹ç»˜åˆ¶UIæ¯”å¦‚åˆå¹¶æ•°æ®ä¸€èµ·ç»˜åˆ¶ç­‰ï¼›\nå¦‚æœæ˜¯å› ä¸ºç»˜åˆ¶UIé€ æˆçš„å¡ï¼Œé‚£å¤šçº¿ç¨‹ä¹Ÿæ˜¯æ²¡å•¥ç”¨çš„ï¼Œå› ä¸ºUIåªèƒ½åœ¨ä¸»çº¿ç¨‹ï¼›\nä¸²å£å’Œç½‘ç»œçš„æ•°æ®æ”¶å‘é»˜è®¤éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œç”±æ“ä½œç³»ç»Ÿè°ƒåº¦çš„ï¼Œå¦‚æœæ•°æ®å¤„ç†å¤æ‚è€Œä¸”æ•°æ®é‡å¤§ï¼Œä½ è¦åšçš„æ˜¯å°†æ•°æ®å¤„ç†æ”¾åˆ°å¤šçº¿ç¨‹ä¸­ï¼›\nå¦‚æœæ²¡æœ‰ä¸¥æ ¼çš„æ•°æ®åŒæ­¥éœ€æ±‚ï¼Œæ ¹æœ¬ä¸éœ€è¦è°ƒç”¨wait***ä¹‹ç±»çš„å‡½æ•°æ¥ç«‹å³å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œå®é™…éœ€æ±‚ä¸­å¤§éƒ¨åˆ†çš„åº”ç”¨åœºæ™¯å…¶å®å¼‚æ­¥æ”¶å‘æ•°æ®å°±è¶³å¤Ÿäº†ï¼›\næœ‰ä¸¥æ ¼æ•°æ®åŒæ­¥éœ€æ±‚çš„åœºæ™¯è¿˜æ˜¯æ”¾åˆ°å¤šçº¿ç¨‹ä¼šå¥½ä¸€äº›ï¼Œä¸ç„¶ä½ wait***å°±å¡åœ¨é‚£è¾¹äº†ï¼›\nå¤šçº¿ç¨‹æ˜¯éœ€è¦å ç”¨ç³»ç»Ÿèµ„æºçš„ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¶…è¿‡äº†CPUçš„æ ¸å¿ƒæ•°é‡ï¼Œå…¶å®å¤šçº¿ç¨‹è°ƒåº¦å¯èƒ½èŠ±è´¹çš„æ—¶é—´æ›´å¤šï¼Œå„ä½åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è¦æƒè¡¡åˆ©å¼Šï¼›\nå†æ¬¡å¼ºè°ƒï¼Œä¸è¦æŒ‡æœ›Qtçš„ç½‘ç»œé€šä¿¡æ”¯æŒé«˜å¹¶å‘ï¼Œæœ€å¤šåˆ°1000ä¸ªèƒ½æ­£å¸¸å·¥ä½œå°±ä¸‡äº‹å¤§å‰ï¼Œä¸€èˆ¬å»ºè®®500ä»¥å†…çš„è¿æ¥æ•°ã€‚æœ‰å¤§é‡é«˜å¹¶å‘çš„éœ€æ±‚è¯·ç”¨ç¬¬ä¸‰æ–¹åº“æ¯”å¦‚swooleç­‰ã€‚\n\n\nåœ¨åµŒå…¥å¼linuxä¸Šï¼Œå¦‚æœè®¾ç½®äº†æ— è¾¹æ¡†çª—ä½“ï¼Œè€Œè¯¥çª—ä½“ä¸­åˆæœ‰æ–‡æœ¬æ¡†ä¹‹ç±»çš„ï¼Œå‘ç°æ²¡æ³•äº§ç”Ÿç„¦ç‚¹è¿›è¡Œè¾“å…¥ï¼Œæ­¤æ—¶éœ€è¦ä¸»åŠ¨æ¿€æ´»çª—ä½“æ‰è¡Œã€‚\n123456//è¿™ç§æ–¹å¼è®¾ç½®çš„æ— è¾¹æ¡†çª—ä½“åœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šæ— æ³•äº§ç”Ÿç„¦ç‚¹setWindowFlags(Qt::WindowStaysOnTopHint | Qt::FramelessWindowHint | Qt::X11BypassWindowManagerHint);//éœ€è¦åœ¨showä»¥åä¸»åŠ¨æ¿€æ´»çª—ä½“w-&gt;show();w-&gt;activateWindow();\n\nQStringçš„replaceå‡½æ•°ä¼šæ”¹å˜åŸå­—ç¬¦ä¸²ï¼Œåˆ‡è®°ï¼Œä»–åœ¨è¿”å›æ›¿æ¢åçš„æ–°å­—ç¬¦ä¸²çš„åŒæ—¶ä¹Ÿä¼šæ”¹å˜åŸå­—ç¬¦ä¸²ï¼Œæˆ‘çš„ä¹–ä¹–ï¼\n\nQGraphicsEffectç±»çš„ç›¸å…³æ•ˆæœå¾ˆç‚«ï¼Œå¯ä»¥å®ç°å¾ˆå¤šæ•ˆæœæ¯”å¦‚é€æ˜ã€æ¸å˜ã€é˜´å½±ç­‰ï¼Œä½†æ˜¯è¯¥ç±»å¾ˆè€—CPUï¼Œå¦‚æœä¸æ˜¯ç‰¹åˆ«éœ€è¦ä¸€èˆ¬ä¸å»ºè®®ç”¨ï¼Œå°±ç®—ç”¨ä¹Ÿæ˜¯è¦ç”¨åœ¨è¯¥éƒ¨ä»¶åæœŸä¸ä¼šå‘ç”Ÿé¢‘ç¹ç»˜åˆ¶çš„åœºæ™¯ï¼Œä¸ç„¶ä¼šè®©ä½ å“­æ™•åœ¨å•æ‰€ã€‚\n\n\n12ï¼š111-120\nåœ¨ä¸åŒçš„å¹³å°ä¸Šæ–‡ä»¶è·¯å¾„çš„æ–œæ ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚linuxç³»ç»Ÿä¸€èˆ¬éƒ½æ˜¯ &#x2F; æ–œæ ï¼Œè€Œåœ¨windowsä¸Šéƒ½æ˜¯ \\ ä¸¤ä¸ªåæ–œæ ï¼ŒQtæœ¬èº«ç¨‹åºå†…éƒ¨æ— è®ºåœ¨winè¿˜æ˜¯linuxéƒ½æ”¯æŒ &#x2F; æ–œæ çš„è·¯å¾„ï¼Œä½†æ˜¯ä¸€äº›ç¬¬ä¸‰æ–¹åº“çš„è¯å¯èƒ½éœ€è¦è½¬æ¢æˆå¯¹åº”ç³»ç»Ÿçš„è·¯å¾„ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°æ–œæ è½¬æ¢ï¼ŒQtå½“ç„¶å†…ç½®ç±»æ–¹æ³•ã€‚\n1234567QString path = &quot;C:/temp/test.txt&quot;;path = QDir::toNativeSeparators(path);//è¾“å‡º C:\\\\temp\\\\test.txtQString path = &quot;C:\\\\temp\\\\test.txt&quot;;path = QDir::toNativeSeparators(path);//è¾“å‡º C:/temp/test.txt\n\nå·§ç”¨QMetaObject::invokeMethodæ–¹æ³•å¯ä»¥å®ç°å¾ˆå¤šæ•ˆæœï¼ŒåŒ…æ‹¬åŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†è·¨çº¿ç¨‹å¤„ç†ä¿¡å·æ§½çš„é—®é¢˜ã€‚æ¯”å¦‚æœ‰ä¸ªåº”ç”¨åœºæ™¯æ˜¯åœ¨å›è°ƒä¸­ï¼Œéœ€è¦å¼‚æ­¥è°ƒç”¨ä¸€ä¸ªpublicå‡½æ•°ï¼Œå¦‚æœç›´æ¥è°ƒç”¨çš„è¯ä¼šå‘ç°ä¸æˆåŠŸï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ QMetaObject::invokeMethod(obj, â€œfunâ€, Qt::QueuedConnection); è¿™ç§æ–¹å¼æ¥å°±å¯ä»¥ã€‚\n\n\n\ninvokeMethodå‡½æ•°æœ‰å¾ˆå¤šé‡è½½å‚æ•°ï¼Œå¯ä»¥ä¼ å…¥è¿”å›å€¼å’Œæ‰§è¡Œæ–¹æ³•çš„å‚æ•°ç­‰ã€‚\ninvokeMethodå‡½æ•°ä¸ä»…æ”¯æŒæ§½å‡½æ•°è¿˜æ”¯æŒä¿¡å·ï¼Œè€Œä¸”è¿™é€¼å±…ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨çº¿ç¨‹ä¸­æ”¾å¿ƒä½¿ç”¨ï¼Œç‰›é€¼ï¼\næµ‹è¯•ä¸‹æ¥å‘ç°åªèƒ½æ‰§è¡Œsignalsæˆ–è€…slotsæ ‡è¯†çš„æ–¹æ³•ã€‚\né»˜è®¤å¯ä»¥æ‰§è¡Œprivate(protected&#x2F;public) slotsä¸‹çš„å‡½æ•°ï¼Œä½†æ˜¯ä¸èƒ½æ‰§è¡Œprivate(protected&#x2F;public)ä¸‹çš„å‡½æ•°ã€‚\næ¯›æ€»è¡¥å……ï¼šå‰æå¿…é¡»æ˜¯slotsæˆ–è€…signalsæ ‡æ³¨çš„å‡½æ•°ï¼Œä¸æ˜¯æ ‡æ³¨çš„å‡½æ•°ä¸åœ¨å…ƒä¿¡æ¯å¯¼è‡´æ— æ³•æŸ¥æ‰¾ï¼Œæ‰§è¡Œä¹‹åä¼šæç¤ºNo such methodã€‚\n2021-11-06è¡¥å……ï¼šå¦‚æœè¦æ‰§è¡Œprivate(protected&#x2F;public)ä¸‹çš„å‡½æ•°ï¼Œéœ€è¦å‡½æ•°å‰é¢åŠ ä¸Š Q_INVOKABLE å…³é”®å­—ï¼Œä»Šå¤©åˆå­¦åˆ°äº†ï¼Œå¿…é¡»åŠ é¸¡è…¿ã€‚\nå…¶å®è¿™æ ·çœ‹ä¸‹æ¥ï¼Œå°±æ˜¯ä»»ä½•æ–¹æ³•å‡½æ•°éƒ½èƒ½æ‰§è¡Œäº†ï¼Œè¿™å°±è¶…è¶Šäº†private(protected&#x2F;public)çš„æƒé™é™å®šäº†ï¼Œç›¸å½“äºä¸€ä¸ªç±»çš„ç§æœ‰å‡½æ•°ç”¨äº† Q_INVOKABLE å…³é”®å­—ä¿®é¥°ä¹Ÿå¯ä»¥è¢« invokeMethod æ‰§è¡Œï¼Œå“‡å’”å’”ã€‚123456789101112131415161718192021222324252627282930//å¤´æ–‡ä»¶å£°æ˜ä¿¡å·å’Œæ§½å‡½æ•°signals:    void sig_test(int type,double value);private slots:    void slot_test(int type, double value);private:    Q_INVOKABLE void fun_test(int type, double value);//æ„é€ å‡½æ•°å…³è”ä¿¡å·æ§½connect(this, SIGNAL(sig_test(int, double)), this, SLOT(slot_test(int, double)));//å•å‡»æŒ‰é’®è§¦å‘ä¿¡å·å’Œæ§½ï¼Œè¿™é‡Œæ˜¯åŒæ—¶ä¸¾ä¾‹ä¿¡å·æ§½éƒ½å¯ä»¥void MainWindow::on_pushButton_clicked()&#123;    QMetaObject::invokeMethod(this, &quot;sig_test&quot;, Q_ARG(int, 66), Q_ARG(double, 66.66));    QMetaObject::invokeMethod(this, &quot;slot_test&quot;, Q_ARG(int, 88), Q_ARG(double, 88.88));    QMetaObject::invokeMethod(this, &quot;fun_test&quot;, Q_ARG(int, 99), Q_ARG(double, 99.99));&#125;//ä¼šæ‰“å° 66 66.66ã€88 88.88void MainWindow::slot_test(int type, double value)&#123;    qDebug() &lt;&lt; type &lt;&lt; value;&#125;//ä¼šæ‰“å° 99 99.99void MainWindow::fun_test(int type, double value)&#123;    qDebug() &lt;&lt; type &lt;&lt; value;&#125;\n\n\nQt5ä¸­çš„ä¿¡å·æ˜¯publicçš„ï¼Œå¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹ç›´æ¥emitå³å¯ï¼Œè€Œåœ¨Qt4ä¸­ä¿¡å·æ˜¯protectedçš„ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªpublicå‡½æ•°æ¥emitã€‚\n\nQt5.15ç‰ˆæœ¬å¼€å§‹å®˜æ–¹ä¸å†æä¾›å®‰è£…åŒ…ï¼Œåªæä¾›æºç ï¼Œå¯ä»¥è‡ªè¡Œç¼–è¯‘æˆ–è€…åœ¨çº¿å®‰è£…ï¼ˆä¹Ÿå¯ä»¥å°†åœ¨çº¿å®‰è£…å¥½çš„ç¦»çº¿æ–‡ä»¶æ‰“åŒ…æ‹·è´åˆ°ç”µè„‘ä¸Šä½¿ç”¨ï¼‰ï¼Œä¼°è®¡æ¯æ¬¡ç¼–è¯‘å„ç§ç‰ˆæœ¬å¤ªéº»çƒ¦ï¼Œæ›´å¤šçš„æ˜¯ä¸ºäº†ç»Ÿè®¡æ”¶é›†ç”¨æˆ·ä½¿ç”¨ä¿¡æ¯æ¯”å¦‚é€šè¿‡åœ¨çº¿å®‰è£…ï¼ŒåæœŸå¯èƒ½ä¼šé€æ­¥åŠ å¤§å•†ä¸šåŒ–åŠ›åº¦ã€‚\n\næœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰Qtç‰ˆæœ¬æœ‰æ²¡æœ‰æŸä¸ªæ¨¡å—å¯ä»¥ä½¿ç”¨qtHaveModuleï¼ˆQt5æ–°å¼•å…¥çš„åˆ¤æ–­ï¼‰æ¥åˆ¤æ–­ï¼Œå¦‚æœè¦åˆ¤æ–­è‡ªå·±çš„é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ QT +&#x3D; çš„æ–¹å¼æ·»åŠ çš„æ¨¡å—ï¼Œå¯ä»¥ç”¨ containsæ¥åˆ¤æ–­ã€‚\n123456789101112131415qtHaveModule(webenginewidgets) &#123;message(&quot;å½“å‰Qtåº“æœ‰æ‰¾åˆ° webenginewidgets æ¨¡å—&quot;)&#125;!qtHaveModule(webkit) &#123;message(&quot;å½“å‰Qtåº“æ²¡æœ‰æ‰¾åˆ° webkit æ¨¡å—&quot;)&#125;contains(QT, network) &#123;message(&quot;å½“å‰é¡¹ç›®å·²ç»å¼•å…¥ network æ¨¡å—&quot;)&#125;!contains(QT, widgets) &#123;message(&quot;å½“å‰é¡¹ç›®æ²¡æœ‰å¼•å…¥ widgets æ¨¡å—&quot;)&#125;\n\nc++11æ–°å¼•å…¥äº†åŸå§‹å­—ç¬¦ä¸²æ ¼å¼ï¼Œç”¨æˆ·é¿å…åœ¨å­—ç¬¦ä¸²ä¸­åŠ å…¥è½¬ä¹‰å­—ç¬¦\\ï¼Œå¯ä»¥ç”¨äºè¡¨ç¤ºjsonå­—ç¬¦ä¸²ç­‰åœºæ™¯ã€‚\n1234QString s1 = R&quot;(test\\001.jpg)&quot;;s1.replace(&quot;\\\\&quot;, &quot;#&quot;);qDebug()&lt;&lt; s1;//ç»“æœ test#001.jpg\n\nå®‰å“ä¸Šæ‰“å°ä¿¡æ¯å»ºè®®ä½¿ç”¨ qInfo() è€Œä¸æ˜¯ qDebug() ï¼ŒqInfo()æ‰æœ‰æ•ˆæœã€‚\n\nQtçš„é»˜è®¤å®šæ—¶å™¨ç²¾åº¦ä¸å¤Ÿé«˜ï¼ˆæ¯”å¦‚åº”ç”¨åœºæ™¯æ˜¯1åˆ†é’Ÿä¿å­˜ä¸€æ¡è®°å½•æˆ–è€…æ–‡ä»¶ï¼Œå½“ä½ ç”¨é»˜è®¤çš„å®šæ—¶å™¨çš„æ—¶å€™ä½ ä¼šå‘ç°æœ‰äº›æ—¶å€™æ˜¯60ç§’è€Œæœ‰äº›æ˜¯59ç§’éšæœºçš„ï¼Œå¦‚æœå®¢æˆ·æœ‰è¦æ±‚è¿™å°±éœ€è¦è®¾ç½®ç²¾åº¦äº†ã€‚å½“ç„¶æˆ‘ä»¬æ‰€åšçš„ç»å¤§éƒ¨åˆ†é¡¹ç›®ä¹Ÿä¸éœ€è¦ç²¾åº¦éå¸¸é«˜çš„å®šæ—¶å™¨ï¼Œæ¯•ç«Ÿç²¾åº¦è¶Šé«˜ï¼Œå ç”¨çš„ç³»ç»Ÿèµ„æºå¯èƒ½è¶Šå¤§ï¼‰ï¼Œå¦‚æœéœ€è¦è®¾ç½®æ›´é«˜çš„ç²¾åº¦å¯ä»¥è®¾ç½® setTimerType(Qt::PreciseTimer)ã€‚Qtæœ‰ä¸¤ç§å®šæ—¶å™¨å¤„ç†ï¼Œä¸€ç§æ˜¯QTimerç±»ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯QObjectç±»å°±å†…ç½®çš„timeeventäº‹ä»¶ï¼Œå¦‚æœæ˜¯QObjectç±»çš„å®šæ—¶å™¨è¦è®¾ç½®çš„è¯è°ƒç”¨ startTimer(interval, Qt::PreciseTimer);\n\n\n\nQt::PreciseTimer ç²¾ç¡®çš„å®šæ—¶å™¨ï¼Œå°½é‡ä¿æŒæ¯«ç§’ç²¾åº¦ã€‚\nQt::CoarseTimer ç²—ç•¥çš„å®šæ—¶å™¨ï¼Œå°½é‡ä¿æŒç²¾åº¦åœ¨æ‰€éœ€çš„æ—¶é—´é—´éš”5%èŒƒå›´å†…ã€‚\nQt::VeryCoarseTimer å¾ˆç²—ç•¥çš„å®šæ—¶å™¨ï¼Œåªä¿ç•™å®Œæ•´çš„ç¬¬äºŒç²¾åº¦ã€‚\nç²¾åº¦å†é«˜ï¼Œä¹Ÿä¾èµ–å¯¹åº”çš„æ“ä½œç³»ç»Ÿä¸­æ–­ï¼Œå‡è®¾ä¸­æ–­éœ€è¦ 5msï¼Œåˆ™å®šæ—¶å™¨ç²¾åº¦ä¸å¯èƒ½é«˜äº5æ¯«ç§’ã€‚\n\n\nQGraphicsEffectç›¸å…³ç±»å¾ˆè€—CPUï¼Œç”šè‡³åœ¨ç»˜åˆ¶çš„æ—¶å€™å’ŒæŸäº›åœ°æ–¹æœ‰å†²çªå¹²æ‰°ï¼ŒåŸºæœ¬ä¸Šä¸å»ºè®®ä½¿ç”¨ï¼Œæƒ…éå¾—å·²åªå»ºè®®å°‘é‡ä½¿ç”¨å’Œéé¢‘ç¹è§¦å‘ç»˜åˆ¶çš„åœ°æ–¹ä½¿ç”¨ã€‚\n\nç”¨QSettingsè®¾ç½®æ³¨å†Œè¡¨ï¼Œå¦‚æœä¸æ˜¯ç®¡ç†å‘˜èº«ä»½è¿è¡Œä¼šæ‰“å° QSettings: failed to set subkey â€œxxxâ€ (æ‹’ç»è®¿é—®ã€‚)ï¼Œä½ éœ€è¦æ‰‹åŠ¨é¼ æ ‡å³é”®ç®¡ç†å‘˜èº«ä»½è¿è¡Œå°±å¯ä»¥ã€‚\n\n\n13ï¼š121-130\nQLineEdité™¤äº†å•çº¯çš„æ–‡æœ¬æ¡†ä»¥å¤–ï¼Œè¿˜å¯ä»¥åšå¾ˆå¤šç‰¹æ®Šçš„å¤„ç†ç”¨é€”ã€‚\n\n\né™åˆ¶è¾“å…¥åªèƒ½è¾“å…¥IPåœ°å€ã€‚\né™åˆ¶è¾“å…¥èŒƒå›´ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ QRegExpValidator æ­£åˆ™è¡¨è¾¾å¼æ¥å¤„ç†ã€‚123456789101112131415161718192021222324252627//æ­£åœ¨è¡¨è¾¾å¼é™åˆ¶è¾“å…¥QString str = &quot;\\\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\b&quot;;ui-&gt;lineEdit-&gt;setValidator(new QRegExpValidator(QRegExp(str)));//ç”¨äºå ä½ui-&gt;lineEdit-&gt;setInputMask(&quot;000.000.000.000&quot;);#if 0//ä¸‹é¢ä»£ç è®¾ç½®æµ®ç‚¹æ•°èŒƒå›´é™åˆ¶å¤±è´¥ui-&gt;lineEdit-&gt;setValidator(new QDoubleValidator(20, 50, 1));#else//ä¸‹é¢ä»£ç è®¾ç½®æµ®ç‚¹æ•°èŒƒå›´é™åˆ¶æˆåŠŸQDoubleValidator *validator = new QDoubleValidator(20, 50, 1);validator-&gt;setNotation(QDoubleValidator::StandardNotation);ui-&gt;lineEdit-&gt;setValidator(validator);#endif//ä¸‹é¢ä»£ç è®¾ç½®æ•´æ•°èŒƒå›´é™åˆ¶æˆåŠŸui-&gt;lineEdit-&gt;setValidator(new QIntValidator(10, 120));//å…¶å®ä¸Šé¢çš„ä»£ç ç¼ºé™·å¾ˆå¤šï¼Œåªèƒ½é™åˆ¶åªè¾“å…¥å°æ•°ï¼Œæ— æ³•è®¾å®šæ•°å€¼èŒƒå›´ï¼Œå¾ˆæ“è›‹//éœ€è¦æ¥ä¸ªä¸‡èƒ½çš„ç‰›é€¼çš„ QRegExpValidator//é™åˆ¶æµ®ç‚¹æ•°è¾“å…¥èŒƒå›´ä¸º[-180,180]QRegExp regexp(&quot;^-?(180|1?[0-7]?\\\\d(\\\\.\\\\d+)?)$&quot;);//é™åˆ¶æµ®ç‚¹æ•°è¾“å…¥èŒƒå›´ä¸º[-90,90]å¹¶é™å®šä¸ºå°æ•°ä½å4ä½QRegExp regexp(&quot;^-?(90|[1-8]?\\\\d(\\\\.\\\\d&#123;1,4&#125;)?)$&quot;);QRegExpValidator *validator = new QRegExpValidator(regexp, this);ui-&gt;lineEdit-&gt;setValidator(validator);\n\n\nåœ¨ç»§æ‰¿è‡ªQAbstractItemViewçš„æ§ä»¶ä¸­ï¼Œæ¯”å¦‚QTableViewã€QTableWidgetï¼Œå¦‚æœæ–‡æœ¬è¶…è¿‡å¯¹åº”itemçš„å®½åº¦ï¼Œåˆ™ä¼šè‡ªåŠ¨çœç•¥å·æ˜¾ç¤ºï¼Œæƒ³è¦å¿«é€Ÿæ˜¾ç¤ºå®Œæ•´çš„æ–‡æœ¬ï¼Œå¯ä»¥åœ¨è¯¥åˆ—å’Œä¸‹ä¸€åˆ—åˆ†å‰²çº¿ä¸­é—´åŒå‡»å³å¯ï¼Œä¼šè‡ªåŠ¨è‡ªé€‚åº”æ˜¾ç¤ºæœ€å¤§å®½åº¦ï¼Œå¦‚æœæ˜¯Qt5.14æˆ–è€…æ›´é«˜ç‰ˆæœ¬ï¼Œä½ ä¼šå‘ç°æ˜¾ç¤ºçœç•¥å·çš„è®¡ç®—è§„åˆ™å˜äº†ï¼Œå¦‚æœæ˜¯rtspã€httpä¹‹ç±»çš„å¼€å¤´çš„è‹±æ–‡å­—ç¬¦ä¸²ï¼ŒåŒæ ·çš„åˆ—å®½ä¸‹ï¼Œä¼šæå‰å°±æ˜¾ç¤ºçœç•¥å·ï¼Œæ¯”å¦‚å­—ç¬¦ä¸² rtmp:&#x2F;&#x2F;58.200.131.2:1935&#x2F;livetv&#x2F;cctv1ï¼Œä¼šæ˜¾ç¤ºæˆ rtmp:&#x2F;&#x2F;â€¦  ï¼Œè€Œåœ¨æ—§ç‰ˆæœ¬çš„Qtä¸­ä¼šæ˜¾ç¤ºæˆ rtmp:&#x2F;&#x2F;58.200.131â€¦ ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³çœ‹åˆ°çƒ¦äººçš„çœç•¥å·ï¼Œå¯ä»¥è®¾ç½®å–æ¶ˆã€‚\n1234//å–æ¶ˆè‡ªåŠ¨æ¢è¡ŒtableView-&gt;setWordWrap(false);//è¶…å‡ºæ–‡æœ¬ä¸æ˜¾ç¤ºçœç•¥å·tableView-&gt;setTextElideMode(Qt::ElideNone);\n\nQVideoWidgetæ’­æ”¾è§†é¢‘ï¼Œå¯èƒ½ä¼šé‡åˆ°ç”»é¢é—ªçƒçš„æƒ…å†µï¼Œæ’­æ”¾è§†é¢‘çš„çª—ä½“éœ€è¦è®¾ç½®ä¸ªå±æ€§ã€‚\n12QVideoWidget *videoWidget = new QVideoWidget;videoWidget-&gt;setAttribute(Qt::WA_OpaquePaintEvent);\n\nQt bugæˆåƒä¸Šä¸‡ï¼Œè¿™ä¸ªä¸ç”¨å¤§æƒŠå°æ€ªï¼Œä¹ŸåŸºæœ¬ä¸Šé‡ä¸åˆ°ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ç‰¹æ®Šæç«¯æƒ…å†µç‰¹å®šåº”ç”¨åœºæ™¯å‡ºç°ï¼Œç”šè‡³ä½ ä¼šé‡åˆ°æœ‰äº›æ˜¯debugå¯ä»¥releaseæŠ¥é”™ï¼Œæœ‰äº›releaseå¯ä»¥debugå´æŠ¥é”™çš„æƒ…å†µï¼Œæœ€ç¥å¥‡çš„è¿˜æœ‰å…ˆæ˜¯debugæŠ¥é”™ï¼Œç„¶åreleaseæ­£å¸¸ï¼Œå†è¿”å›å»ç”¨debugåˆæ­£å¸¸ï¼Œéœ€è¦ç”¨releaseæ¿€æ´»ä¸€ä¸‹ï¼å­¦ä¹ ç¼–ç¨‹çš„è·¯æœ¬æ¥å°±æ˜¯ä¸€æ¡å‘å‘æ´¼æ´¼çš„è·¯ï¼Œä¸æ–­å¡«å‘ï¼Œå°½é‡è§„é¿å‘ï¼å¾ˆå¤šæ—¶å€™å¾ˆå¤šçœ‹èµ·æ¥çš„å‘å…¶å®æ˜¯è‡ªå·±æ²¡æœ‰æ³¨æ„ç»†èŠ‚å¯¼è‡´çš„ã€‚\n\nQtè§†å›¾ä¸­é»˜è®¤æ’åºæ˜¯æŒ‰ç…§å­—ç¬¦ä¸²çš„ASCIIæ’åºçš„ï¼Œå¦‚æœæ˜¯IPåœ°å€çš„è¯ä¼šå‡ºç°192.168.1.117æ’åœ¨192.168.1.2å‰é¢çš„æƒ…å†µï¼Œå¦‚æœè¦è§„é¿è¿™ç§æƒ…å†µï¼Œä¸€ç§åšæ³•æ˜¯å–æœ«å°¾çš„åœ°å€è½¬æˆæ•´å‹å†æ¯”è¾ƒå¤§å°ï¼Œç¼ºç‚¹æ˜¯è·¨ç½‘æ®µå°±æ­‡èœäº†ï¼Œåˆä¼šå‡ºç°192.168.2.65å‡ºç°åœ¨192.168.1.70å‰é¢ï¼Œç»ˆæå¤§æ³•æ˜¯å°†IPåœ°å€è½¬æˆæ•´å‹å†æ¯”è¾ƒå¤§å°ã€‚\n12345678910111213141516171819QString QUIHelper::ipv4IntToString(quint32 ip)&#123;    QString result = QString(&quot;%1.%2.%3.%4&quot;).arg((ip &gt;&gt; 24) &amp; 0xFF).arg((ip &gt;&gt; 16) &amp; 0xFF).arg((ip &gt;&gt; 8) &amp; 0xFF).arg(ip &amp; 0xFF);    return result;&#125;quint32 QUIHelper::ipv4StringToInt(const QString &amp;ip)&#123;    int result = 0;    if (isIP(ip)) &#123;        QStringList list = ip.split(&quot;.&quot;);        int ip0 = list.at(0).toInt();        int ip1 = list.at(1).toInt();        int ip2 = list.at(2).toInt();        int ip3 = list.at(3).toInt();        result = ip3 | ip2 &lt;&lt; 8 | ip1 &lt;&lt; 16 | ip0 &lt;&lt; 24;    &#125;    return result;&#125;\n\nåœ¨ä¸»QWidgetçª—ä½“å¦‚æœç›´æ¥qssè®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„è¯ï¼Œé¢„è§ˆæ˜¯å¯è§çš„ï¼Œè¿è¡Œå¹¶æ²¡æœ‰æ•ˆæœï¼Œä½ éœ€è¦åœ¨è¿™ä¸ªä¸»widgetä¸Šå†æ”¾ä¸ªwidgetï¼Œåœ¨æ–°çš„widgetä¸Šè®¾ç½®qsså›¾ç‰‡å°±è¡Œï¼Œè€Œå¦‚æœæ˜¯Dialogæˆ–è€…QMainWindowçª—ä½“æ˜¯æ”¯æŒç›´æ¥è®¾ç½®qssèƒŒæ™¯å›¾çš„ï¼Œé¢„è§ˆå’Œè¿è¡Œæ•ˆæœä¸€è‡´ã€‚\n\nQtæä¾›äº†qDebugæœºåˆ¶ç›´æ¥è¾“å‡ºæ‰“å°ä¿¡æ¯ï¼Œè¿™ä¸ªå¼¥è¡¥äº†QtCreatorè°ƒè¯•å¾ˆé¸¡è‚‹çš„ç¼ºç‚¹ï¼Œè€Œä¸”æ— ç¼å¯¹æ¥æ—¥å¿—é’©å­ï¼Œä½¿å¾—ç°åœºè¿è¡ŒæœŸé—´æŒ‰ç…§é¢„å®šçš„æ‰“å°ä¿¡æ¯è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼Œæœ‰æ—¶å€™åœ¨å¼€å‘é˜¶æ®µï¼Œåˆä¸æƒ³è¦çœ‹åˆ°ä¸€å †å †çš„æ‰“å°ä¿¡æ¯ï¼Œæœ€ç¬¨çš„åšæ³•æ˜¯ä¸€è¡Œè¡Œæ³¨é‡Šæ‰qdebugçš„åœ°æ–¹ï¼Œå…¶å®è¿˜å¯ä»¥ç›´æ¥proä¸­åŠ ä¸Šä¸€è¡Œæ¥ç¦ç”¨æ•´ä¸ªé¡¹ç›®çš„qdebugè¾“å‡ºã€‚\n12#ç¦ç”¨qdebugæ‰“å°è¾“å‡ºDEFINES += QT_NO_DEBUG_OUTPUT\n\nåœ¨ä½¿ç”¨ QT_NO_DEBUG_OUTPUT å…³é”®å­—ç¦ç”¨äº†æ‰€æœ‰æ‰“å°ä¿¡æ¯ä»¥åï¼Œå¯ä»¥èŠ‚çº¦ä¸å°‘çš„å¼€é”€ï¼Œæœ‰æ—¶å€™åˆæƒ³åœ¨ç¦ç”¨æ‰“å°ä¿¡æ¯åï¼Œæå°‘åœ°æ–¹è¿˜éœ€è¦çœ‹åˆ°æ‰“å°ä¿¡æ¯ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å® QT_NO_DEBUG_OUTPUT ç¦ç”¨çš„ qdebug çš„è¾“å‡ºï¼ŒQtè¿˜æœ‰å…¶ä»–å‡ ç§æ‰“å°ä¿¡æ¯æ¯”å¦‚ qInfoã€qWarningã€qCriticalï¼Œè¿™äº›æ˜¯ä¸å—å½±å“çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æå°‘éƒ¨åˆ†éœ€è¦æ‰“å°çš„åœ°æ–¹ç”¨ qInfo æ¥è¾“å‡ºä¿¡æ¯å°±å¥½ã€‚ç‰¹åˆ«æ³¨æ„ï¼šqFatal æ‰“å°å®Œä¿¡æ¯ç¨‹åºä¼šè‡ªåŠ¨ç»“æŸã€‚\n12345678qDebug() &lt;&lt; &quot;qDebug&quot;;qInfo() &lt;&lt; &quot;qInfo&quot;;qWarning() &lt;&lt; &quot;qWarning&quot;;qCritical() &lt;&lt; &quot;qCritical&quot;;qDebug(&quot;qDebug&quot;);qWarning(&quot;qWarning&quot;);qCritical(&quot;qCritical&quot;);\n\nQtçš„proæ–‡ä»¶å¯ä»¥æ·»åŠ å„ç§å¤„ç†æ¥ä½¿å¾—é…ç½®æ›´æ–¹ä¾¿ï¼Œæ¯”å¦‚æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„ç­‰ï¼Œè¿™æ ·å°±ä¸ä¼šå…¨éƒ¨åœ¨ä¸€å †ç¼–è¯‘ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ä¸­æ‰¾æ¥æ‰¾å»ã€‚\n12345678910111213141516171819#ç¦ç”¨qdebugæ‰“å°è¾“å‡ºDEFINES     += QT_NO_DEBUG_OUTPUT#è‡ªå®šä¹‰defineå˜é‡ å¯ä»¥åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨#proæ–‡ä»¶å¯ä»¥è¿™æ ·åˆ¤æ–­ contains(DEFINES, videovlc) &#123;&#125;#ä»£ç æ–‡ä»¶å¯ä»¥è¿™æ ·åˆ¤æ–­ #ifdef videovlcDEFINES     += videovlc1 videoffmpeg#å…³é—­ç¼–è¯‘è­¦å‘Šæç¤º çœ¼ä¸è§ä¸ºå‡€CONFIG      += warn_off#æŒ‡å®šç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶åˆ°tempç›®å½• åˆ†é—¨åˆ«ç±»å­˜å‚¨MOC_DIR     = temp/mocRCC_DIR     = temp/rccUI_DIR      = temp/uiOBJECTS_DIR = temp/obj#æŒ‡å®šç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åˆ°binç›®å½•DESTDIR     = bin\n\nQtå¯¹æ“ä½œç³»ç»Ÿå±‚çš„æ¶ˆæ¯ä¹Ÿåšäº†å¾ˆå¤šçš„å°è£…ï¼Œå¯ä»¥ç›´æ¥æ‹¿åˆ°è¿›è¡Œå¤„ç†ï¼ˆå¦‚æœéœ€è¦æ‹¦æˆªå¤„ç†è¦ç”¨å¯¹åº”æ“ä½œç³»ç»Ÿçš„APIæ‰è¡Œæ¯”å¦‚é¼ æ ‡é”®ç›˜é’©å­ï¼‰ï¼Œæ¯”å¦‚ç³»ç»Ÿä¼‘çœ å’Œå”¤é†’åšä¸€äº›å¤„ç†ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839//ä¸»çª—ä½“å¤´æ–‡ä»¶protected:    bool nativeEvent(const QByteArray &amp;eventType, void *message, long *result);#ifdef Q_OS_WIN    bool winEvent(MSG *message, long *result);#endif//ä¸»çª—ä½“å®ç°å‡½æ•°#ifdef Q_OS_WIN#include &quot;Windows.h&quot;#endifbool frmMain::nativeEvent(const QByteArray &amp;eventType, void *message, long *result)&#123;    if (eventType == &quot;windows_generic_MSG&quot;) &#123;#ifdef Q_OS_WIN        MSG *msg = static_cast&lt;MSG *&gt;(message);        //qDebug() &lt;&lt; TIMEMS &lt;&lt; msg-&gt;message;        if (msg-&gt;wParam == PBT_APMSUSPEND &amp;&amp; msg-&gt;message == WM_POWERBROADCAST) &#123;            //ç³»ç»Ÿä¼‘çœ çš„æ—¶å€™è‡ªåŠ¨æœ€å°åŒ–å¯ä»¥è§„é¿ç¨‹åºå¯èƒ½å‡ºç°çš„é—®é¢˜            this-&gt;showMinimized();        &#125; else if (msg-&gt;wParam == PBT_APMRESUMEAUTOMATIC) &#123;            //ä¼‘çœ å”¤é†’åè‡ªåŠ¨æ‰“å¼€            this-&gt;showNormal();        &#125;#endif    &#125; else if (eventType == &quot;NSEvent&quot;) &#123;#ifdef Q_OS_MACOS#endif    &#125;    return false;&#125;#ifdef Q_OS_WINbool frmMain::winEvent(MSG *message, long *result)&#123;    return nativeEvent(&quot;windows_generic_MSG&quot;, message, result);&#125;#endif\n\nQtçš„proé¡¹ç›®ç®¡ç†é…ç½®æ–‡ä»¶ä¸­ä¹Ÿå¯æ·»åŠ å„ç§ç¼–è¯‘å‰åçš„æ“ä½œåŠé…ç½®ï¼Œä¸»è¦é€šè¿‡ QMAKE_POST_LINKå’ŒQMAKE_PRE_LINKï¼Œä»–ä»¬æ”¯æŒçš„å‡½æ•°ä»¥åŠå†™æ³•ï¼Œå¯ä»¥åœ¨QtCreatorçš„å¸®åŠ©ä¸­æœç´¢ qmake Function Reference æŸ¥çœ‹è¯¦æƒ…è¯´æ˜ã€‚\n\n\n\nQMAKE_PRE_LINK    è¡¨ç¤ºç¼–è¯‘å‰æ‰§è¡Œå†…å®¹\nQMAKE_POST_LINK   è¡¨ç¤ºç¼–è¯‘åæ‰§è¡Œå†…å®¹123456789101112srcFile1 = $$PWD/1.txtsrcFile2 = $$PWD/2.txtdstDir = $$PWD/../bin#windowsä¸Šéœ€è¦è½¬æ¢è·¯å¾„æ–œæ  å…¶ä»–ç³»ç»Ÿä¸éœ€è¦srcFile1 = $$replace(srcFile1, /, \\\\);srcFile2 = $$replace(srcFile2, /, \\\\);dstDir = $$replace(dstDir, /, \\\\);#ç¼–è¯‘å‰æ‰§è¡Œæ‹·è´ å¤šä¸ªæ‹·è´å¯ä»¥é€šè¿‡ &amp;&amp; ç¬¦å·éš”å¼€QMAKE_PRE_LINK += copy /Y $$srcFile1 $$dstDir &amp;&amp; copy /Y $$srcFile2 $$dstDir#ç¼–è¯‘åæ‰§è¡Œæ‹·è´ å¤šä¸ªæ‹·è´å¯ä»¥é€šè¿‡ &amp;&amp; ç¬¦å·éš”å¼€QMAKE_POST_LINK += copy /Y $$srcFile1 $$dstDir &amp;&amp; copy /Y $$srcFile2 $$dstDir\n\n14ï¼š131-140\nQtæ–°ç‰ˆæœ¬å¾€å¾€ä¼šå¸¦æ¥ä¸€äº›å¤´æ–‡ä»¶çš„æ›´æ–°ï¼Œæ¯”å¦‚ä»¥å‰ä½¿ç”¨QPainterç»˜åˆ¶ï¼Œä¸éœ€è¦é¢å¤–åŒ…å«QPainterPathå¤´æ–‡ä»¶ï¼Œè€Œ5.15ç‰ˆæœ¬å¼€å§‹å°±éœ€è¦æ˜¾ç¤ºä¸»åŠ¨å¼•å…¥#include â€œqpainterpath.hâ€æ‰è¡Œã€‚\n\nQt6.0å‘å¸ƒäº†ï¼Œæ˜¯ä¸ªæ¯”è¾ƒå¤§çš„æ”¹åŠ¨ç‰ˆæœ¬ï¼Œå¾ˆå¤šåŸºç¡€çš„ç±»æˆ–è€…ç»„ä»¶éƒ½æ”¾åˆ°å•ç‹¬çš„æºç åŒ…ä¸­ï¼Œéœ€è¦è‡ªè¡Œå®˜ç½‘ä¸‹è½½å¹¶ç¼–è¯‘ï¼Œé»˜è®¤ä¸æä¾›é›†æˆåœ¨å¼€å‘ç›®å½•ä¸‹ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–è¯‘å¹¶é›†æˆï¼Œæ¯”å¦‚QRegExpï¼ŒQTextCodecç±»ï¼Œéœ€è¦ç¼–è¯‘é›†æˆåproæ–‡ä»¶ QT +&#x3D; core5compat æ‰èƒ½ç”¨ï¼Œ å…·ä½“è¯´æ˜åœ¨https://doc.qt.io/qt-6/qtcore5-index.htmlã€‚\n\nqDebugè¾“å‡ºæ‰“å°ä¿¡æ¯ï¼Œé»˜è®¤ä¼šå®Œæ•´æ‰“å°è½¬ä¹‰å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š\\  &quot; \\t \\nâ€ ç­‰ï¼Œæ‰€ä»¥å½“ä½ å‘ç°ä½ æ˜æ˜è®¾ç½®äº†è½¬ä¹‰å­—ç¬¦ä»¥åæ‰“å°ç¡®è¿˜æ˜¯è½¬ä¹‰å‰çš„å­—ç¬¦ï¼Œè¿™å°±æ‡µé€¼äº†ï¼Œå…¶å®è¿™æ˜¯qdebugä¸ºäº†æ–¹ä¾¿è°ƒè¯•å°†å„ç§å­—ç¬¦éƒ½æ‰“å°è¾“å‡ºã€‚æ— å¯å¦è®¤ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬æå…¶å…´å¥‹çš„äº«å—ç€Qtå¸¦æ¥çš„å„ç§è½®å­å„ç§ä¾¿åˆ©ï¼Œä½†æ˜¯å¶å°”ï¼Œç¨ä¸ç•™æ„ï¼Œè¿™äº›ä¾¿åˆ©å¯èƒ½ä¹Ÿä¼šå‘ä½ ä¸€æŠŠã€‚è¦åšçš„å°±æ˜¯æ“¦äº®çœ¼ç›ï¼Œæ—¶åˆ»è°¨æ…ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°è¸è¸å®å®ç ä»£ç ã€‚\n12345QString s1 = R&quot;(\\:device0)&quot;;//TNNDå±…ç„¶è¾“å‡ºçš„æ˜¯ \\\\:device0qDebug() &lt;&lt; s1;//è¿™æ¬¡ç»ˆäºæ­£ç¡®çš„è¾“å‡º \\:device0qDebug().noquote() &lt;&lt; s1;\n\nå¾ˆå¤šäººæœ‰ç–‘é—®ä¸ºä½•qsså¯¹æµè§ˆå™¨æ§ä»¶ä¸­çš„ç½‘é¡µæ ·å¼æ²¡æ³•æ§åˆ¶ï¼Œå…¶å®ç”¨å±è‚¡æƒ³æƒ³ä¹ŸçŸ¥é“ï¼Œé‚£ç©æ„æ˜¯html csså»æ§åˆ¶çš„ï¼Œå’ŒQtä¸€æ¯›é’±å…³ç³»ä¹Ÿæ²¡æœ‰ï¼Œæ ¹æœ¬ç®¡ä¸ç€ï¼Œå¦‚æœæƒ³è¦å¯¹æ»šåŠ¨æ¡æ ·å¼è®¾ç½®ï¼Œå¯ä»¥åœ¨ç½‘é¡µä»£ç ä¸­è®¾ç½®æ ·å¼å°±è¡Œã€‚\n12345&lt;style type=&quot;text/css&quot;&gt;  ::-webkit-scrollbar&#123;width:0.8em;&#125;  ::-webkit-scrollbar-track&#123;background:rgb(241,241,241);&#125;  ::-webkit-scrollbar-thumb&#123;background:rgb(188,188,188);&#125;&lt;/style&gt;\n\nQtçš„inié…ç½®æ–‡ä»¶é»˜è®¤ä¸æ”¯æŒç›´æ¥è¯»å†™ä¸­æ–‡ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸‹ç¼–ç æ ¼å¼æ‰è¡Œï¼Œå¼ºçƒˆå»ºè®®ç»Ÿä¸€ç”¨utf-8ç¼–ç ï¼ŒåŒ…æ‹¬ä»£ç æ–‡ä»¶ã€‚\n1234567891011121314151617181920//è®¾ç½®äº†ç¼–ç ä»¥åé…ç½®æ–‡ä»¶å†…å®¹ä¸º Company=ä¸Šæµ·ç‰©è”ç½‘æŠ€æœ¯ç ”ç©¶ä¸­å¿ƒ//æ²¡æœ‰è®¾ç½®ç¼–ç åˆ™é…ç½®æ–‡ä»¶å†…å®¹ä¸º Company=\\xe4\\xb8\\x8a\\xe6\\xb5\\xb7\\xe7\\x89\\xa9\\xe8\\x81\\x94\\xe7\\xbd\\x91\\xe6\\x8a\\x80\\xe6\\x9c\\xaf\\xe7\\xa0\\x94\\xe7\\xa9\\xb6\\xe4\\xb8\\xad\\xe5\\xbf\\x83void App::readConfig()&#123;    QSettings set(App::ConfigFile, QSettings::IniFormat);    set.setIniCodec(&quot;utf-8&quot;);    set.beginGroup(&quot;AppConfig1&quot;);    App::Company = set.value(&quot;Company&quot;, App::Company).toString();    set.endGroup();&#125;void App::writeConfig()&#123;    QSettings set(App::ConfigFile, QSettings::IniFormat);    set.setIniCodec(&quot;utf-8&quot;);    set.beginGroup(&quot;AppConfig1&quot;);    set.setValue(&quot;Company&quot;, App::Company);    set.endGroup();&#125;\n\nç”¨Qtåšå®‰å“å¼€å‘éƒ½ä¼šé‡åˆ°æƒé™çš„é—®é¢˜ï¼Œæ—©æœŸçš„å®‰å“ç‰ˆæœ¬å¯ä»¥ç›´æ¥é€šè¿‡ AndroidManifest.xml é…ç½®æ–‡ä»¶æ¥æ·»åŠ éœ€è¦çš„æƒé™ï¼Œè¿™æ ·åœ¨å®‰è£…appçš„æ—¶å€™å°±ä¼šæç¤ºè¯¥appéœ€è¦å“ªäº›æƒé™è®©ç”¨æˆ·åŒæ„ï¼Œç°åœ¨çš„å®‰å“ç‰ˆæœ¬éƒ½æ”¹æˆäº†åŠ¨æ€æƒé™ï¼Œéœ€è¦åœ¨appè¿è¡Œçš„æ—¶å€™å¼¹å‡ºæç¤ºè®©ç”¨æˆ·ç¡®è®¤å†æœ‰æƒé™ï¼ŒQtè¿åˆäº†è¿™ç§ç­–ç•¥å†…ç½®äº†åŠ¨æ€ç”³è¯·æƒé™çš„æ–¹æ³• QtAndroid::requestPermissionsSyncã€‚\n12345678910111213141516171819202122232425262728//åŠ¨æ€è®¾ç½®æƒé™bool checkPermission(const QString &amp;permission)&#123;#ifdef Q_OS_ANDROID#if (QT_VERSION &gt;= QT_VERSION_CHECK(5, 10, 0))    QtAndroid::PermissionResult result = QtAndroid::checkPermission(permission);    if (result == QtAndroid::PermissionResult::Denied) &#123;        QtAndroid::requestPermissionsSync(QStringList() &lt;&lt; permission);        result = QtAndroid::checkPermission(permission);        if (result == QtAndroid::PermissionResult::Denied) &#123;            return false;        &#125;    &#125;#endif#endif    return true;&#125;int main(int argc, char *argv[])&#123;    QApplication a(argc, argv);       //è¯·æ±‚æƒé™    checkPermission(&quot;android.permission.READ_EXTERNAL_STORAGE&quot;);    checkPermission(&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;);       return a.exec();&#125;\n\nQté‡è½½qDebugè¾“å‡ºè‡ªå®šä¹‰çš„ä¿¡æ¯ã€‚\n123456789101112131415struct FunctionInfo &#123;    QString function;    QString name;    QString groupEnabled;    QString action;    QString group;    friend QDebug operator &lt;&lt; (QDebug debug, const FunctionInfo &amp;functionInfo) &#123;        QString info = QString(&quot;åŠŸèƒ½: %1  åç§°: %2  å¯ç”¨: %3  æ–¹æ³•: %4  åˆ†ç»„: %5&quot;)                       .arg(functionInfo.function).arg(functionInfo.name).arg(functionInfo.groupEnabled)                       .arg(functionInfo.action).arg(functionInfo.group);        debug &lt;&lt; info;        return debug;    &#125;&#125;;\n\nå¯¹é«˜åˆ†å±ä¸åŒç¼©æ”¾æ¯”ä¾‹çš„è‡ªé€‚åº”å¤„ç†æ–¹æ³•ã€‚\n123456789101112131415161718192021222324252627282930//æ–¹æ³•1ï¼šåœ¨mainå‡½æ•°çš„æœ€å‰é¢åŠ ä¸Šä¸‹é¢è¿™å¥ 5.6ç‰ˆæœ¬æ‰å¼€å§‹æœ‰è¿™ä¸ªå‡½æ•°#if (QT_VERSION &gt; QT_VERSION_CHECK(5,6,0))    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);    //å¼€å¯é«˜ç¼©æ”¾æ”¯æŒä»¥åå›¾ç‰‡å¯èƒ½å‘è™šè¿˜è¦å¼€å¯ä¸‹é¢è¿™ä¸ªå±æ€§    QCoreApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);#endif//æ–¹æ³•2ï¼šåœ¨å¯æ‰§è¡Œæ–‡ä»¶åŒç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ qt.conf å¡«å…¥ä¸‹é¢å†…å®¹[Platforms]WindowsArguments = dpiawareness=0//ä¸‹é¢è¿™è¡Œç”¨æ¥è§£å†³Qté«˜DPIä¸‹æ–‡å­—æ˜¾ç¤ºæœ‰é”¯é½¿çš„é—®é¢˜WindowsArguments = fontengine=freetype//2023-2-2 ç»è¿‡å»ºæ³¢ï¼ˆç®€ç§°JBå¤§ä½¬ï¼‰äº²æµ‹ä¸¤è¡Œåˆ†å¼€å†™æ²¡æœ‰æ•ˆæœï¼Œéœ€è¦é€—å·åˆ†å¼€WindowsArguments = dpiawareness=0, fontengine=freetype//æ–¹æ³•3ï¼šåœ¨mainå‡½æ•°æœ€å‰é¢è®¾ç½®Qtå†…éƒ¨çš„ç¯å¢ƒå˜é‡qputenv(&quot;QT_AUTO_SCREEN_SCALE_FACTOR&quot;, &quot;1.5&quot;);//æ–¹æ³•4ï¼šæ–°ç‰ˆæœ¬çš„Qtæ¯”å¦‚Qt5.14ä¿®æ­£äº†å¯¹é«˜åˆ†å±çš„å¤„ç†æ”¯æŒä¸æ˜¯æ•´æ•°çš„ç¼©æ”¾qputenv(&quot;QT_ENABLE_HIGHDPI_SCALING&quot;,Â &quot;1&quot;);QGuiApplication::setHighDpiScaleFactorRoundingPolicy(Qt::HighDpiScaleFactorRoundingPolicy::PassThrough);//ç¦ç”¨ç¼©æ”¾//æµ‹è¯•å‘ç°AA_Use96Dpiå±æ€§åœ¨Qt5.9ä»¥ä¸Šç‰ˆæœ¬å®Œå…¨æ­£å¸¸ï¼Œä»¥ä¸‹ç‰ˆæœ¬æ¯”å¦‚5.7æœ‰éƒ¨åˆ†æ§ä»¶åœ¨175%ç¼©æ”¾ä¸æ­£å¸¸æ¯”å¦‚QTextEditï¼Œéœ€è¦å¤–å±‚å¥—ä¸ªwidgetæ‰è¡Œã€‚#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    QApplication::setAttribute(Qt::AA_Use96Dpi);#endif#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,14,0))    QGuiApplication::setHighDpiScaleFactorRoundingPolicy(Qt::HighDpiScaleFactorRoundingPolicy::Floor);#endif\n\nQTabWidgeté€‰é¡¹å¡æœ‰ä¸ªè‡ªåŠ¨ç”ŸæˆæŒ‰é’®åˆ‡æ¢é€‰é¡¹å¡çš„æœºåˆ¶ï¼Œæœ‰æ—¶å€™ä¸æƒ³çœ‹åˆ°è¿™ä¸ªçƒ¦äººçš„åˆ‡æ¢æŒ‰é’®ï¼Œå¯ä»¥è®¾ç½®usesScrollButtonsä¸ºå‡ï¼Œå…¶å®QTabWidgetçš„usesScrollButtonså±æ€§æœ€ç»ˆæ˜¯åº”ç”¨åˆ°QTabWidgetçš„QTabBarå¯¹è±¡ä¸Šï¼Œæ‰€ä»¥åªè¦è®¾ç½®å…¨å±€çš„QTabBarçš„è¿™ä¸ªå±æ€§å…³é—­å³å¯ã€‚ä¸ºå•¥è¦è®¾ç½®å…¨å±€çš„å‘¢ï¼Œå› ä¸ºå¦‚æœåªæ˜¯å¯¹QTabWidgetè®¾ç½®äº†è¯¥å±æ€§ï¼Œè€Œåœ¨QMainWindowçª—ä½“ä¸­QDockWidgetåˆå¹¶è‡ªåŠ¨å½¢æˆçš„é€‰é¡¹å¡åªæœ‰QTabBarå¯¹è±¡å¯¼è‡´ä¾ç„¶æ˜¯æœ‰åˆ‡æ¢æŒ‰é’®ã€‚\n123456789101112//å¯¹tabWidgetè®¾ç½®æ— åˆ‡æ¢æŒ‰é’®ui-&gt;tabWidget-&gt;setUsesScrollButtons(false);//å¯¹tabBarè®¾ç½®æ— åˆ‡æ¢æŒ‰é’®ui-&gt;tabWidget-&gt;tabBar()-&gt;setUsesScrollButtons(false);//å¯¹æ•´ä¸ªç³»ç»Ÿçš„é€‰é¡¹å¡è®¾ç½®æ— åˆ‡æ¢æŒ‰é’®QTabBar&#123;qproperty-usesScrollButtons:false;&#125;//è®¾ç½®é€‰é¡¹å¡è‡ªåŠ¨æ‹‰ä¼¸ è¿™ç©æ„å±…ç„¶ä¹‹å‰è‡ªåŠ¨è®¡ç®—æ¥è®¾ç½®åŸæ¥å†…ç½®äº†å“‡å’”å’”QTabBar&#123;qproperty-expanding:false;&#125;//è®¾ç½®é€‰é¡¹å¡å…³é—­æŒ‰é’®å¯è§QTabBar&#123;qproperty-tabsClosable:true;&#125;//è¿˜æœ‰å…¶ä»–å±æ€§å‚è§QTabBarå¤´æ–‡ä»¶æœ‰æƒŠå–œ//ä¾æ—§æ˜¯ä¸‡èƒ½å¤§æ³•æ‰€æœ‰å¯è§†åŒ–ç±»çš„ Q_PROPERTY åŒ…å«çš„å±æ€§éƒ½å¯ä»¥è¿™æ ·è®¾ç½®\n\nQMainWindowçš„åˆ†å‰²çº¿é»˜è®¤å°ºå¯¸æ¯”è¾ƒå¤§ï¼Œæœ‰æ—¶å€™æƒ³è®¾ç½®å°ä¸€ç‚¹æˆ–è€…ä¸æƒ³è¦ï¼Œæœ€å¼€å§‹çš„æ—¶å€™ä»¥ä¸ºæ˜¯QSplitterï¼Œæ‰“å°æ‰€æœ‰å­å…ƒç´ æ‰¾éäº†ä¹Ÿæ²¡æ‰¾åˆ°å½±å­ï¼Œæœ€åå‘ç°æ ·å¼è¡¨ä¸­æœ‰å¯¹åº”è®¾ç½®çš„å†…å®¹ã€‚\n12//çœŸçš„æ˜¯åšæ¢¦ä¹Ÿæ²¡æƒ³åˆ°è¦è¿™æ ·è®¾ç½®QMainWindow::separator&#123;width:1px;height:1px;margin:1px;padding:1px;background:#FF0000;&#125;\n\n15ï¼š141-150\nQImageæ”¯æŒxpmå›¾æ ‡ï¼ŒæŸ¥çœ‹Qtå†…ç½®çš„QStyleé£æ ¼çš„ä»£ç ä¸­å¯ä»¥å‘ç°å¤§é‡çš„xpmå›¾æ ‡å®šä¹‰ï¼Œé€šè¿‡ä»£ç çš„å½¢å¼æ¥äº§ç”Ÿå›¾æ ‡ï¼Œå“‡å’”å’”å¥½ç‰›é€¼ã€‚\n12345678910111213141516171819202122232425static const char * const imgData[] = &#123;    &quot;15 11 6 1&quot;,    &quot;   c None&quot;,    &quot;+  c #979797&quot;,    &quot;@  c #C9C9C9&quot;,    &quot;$  c #C1C1C1&quot;,    &quot;b  c None&quot;,    &quot;d  c None&quot;,    &quot; $++++++++$    &quot;,    &quot;$+bbbbbbbb+$   &quot;,    &quot;+b $$      +$  &quot;,    &quot;+b $@       +$ &quot;,    &quot;+b           +$&quot;,    &quot;+b           d+&quot;,    &quot;+b          d+$&quot;,    &quot;+b $$      d+$ &quot;,    &quot;+b $@     d+$  &quot;,    &quot;$+dddddddd+$   &quot;,    &quot; $++++++++$    &quot;&#125;;//è¿™æ ·å°±èƒ½ç›´æ¥æ˜¾ç¤ºä¸€ä¸ªç®­å¤´çš„å›¾å½¢QImage img(imgData);QLabel lab;lab.setPixmap(QPixmap::fromImage(img));lab.show();\n\nåœ¨åœé çª—ä½“QDockWidgetå’ŒQOpenGLWidgetåŒæ—¶ä½¿ç”¨çš„æ—¶å€™ï¼Œä»åµŒå…¥çŠ¶æ€åˆ‡æ¢åˆ°æµ®åŠ¨çŠ¶æ€æˆ–è€…æµ®åŠ¨çŠ¶æ€åˆ‡æ¢åˆ°åµŒå…¥çŠ¶æ€ï¼ŒQOpenGLWidgetçš„ä¸Šä¸‹æ–‡ä¼šè¢«æ‰“ä¹±å¯¼è‡´ç™½å±å¤±æ•ˆï¼Œéœ€è¦åœ¨mainå‡½æ•°ä¸­å¼€å¤´ä½ç½®è®¾ç½®ä¸‹å…±äº«OpenGLä¸Šä¸‹æ–‡ã€‚\n123456789int main(int argc, char *argv[])&#123;    //éœ€è¦è®¾ç½®å…±äº«ä¸Šä¸‹æ–‡ä¸ç„¶åœé çª—ä½“ä»æ­£å¸¸åˆ°æµ®åŠ¨åQOpenGLWidgetçª—ä½“ä¼šå¤±æ•ˆ#if (QT_VERSION &gt; QT_VERSION_CHECK(5,4,0))    QCoreApplication::setAttribute(Qt::AA_ShareOpenGLContexts);#endif    QApplication a(argc, argv);    ...&#125;\n\nå…³äºQtä¸­æ–‡ä¹±ç çš„é—®é¢˜ï¼Œä¸ªäººä¹Ÿç¨å¾®æ€»ç»“äº†ä¸€ç‚¹ï¼Œåº”è¯¥å¯ä»¥è§£å†³99%ä»¥ä¸Šçš„Qtç‰ˆæœ¬çš„ä¹±ç é—®é¢˜ã€‚\n\n\n\nç¬¬ä¸€æ­¥ï¼šä»£ç æ–‡ä»¶é€‰æ‹©ç”¨utf8ç¼–ç å¸¦bomã€‚\nç¬¬äºŒæ­¥ï¼šåœ¨æœ‰ä¸­æ–‡æ±‰å­—çš„ä»£ç æ–‡ä»¶é¡¶éƒ¨åŠ ä¸€è¡Œï¼ˆä¸€èˆ¬æ˜¯cppæ–‡ä»¶ï¼‰ #pragma execution_character_set(â€œutf-8â€) å¯ä»¥è€ƒè™‘æ”¾åœ¨head.hä¸­ï¼Œç„¶åéœ€è¦çš„åœ°æ–¹å°±å¼•å…¥headå¤´æ–‡ä»¶å°±è¡Œï¼Œè€Œä¸æ˜¯è¿™è¡Œä»£ç å†™çš„åˆ°å¤„éƒ½æ˜¯ï¼›è¿™è¡Œä»£ç æ˜¯ä¸ºäº†å‘Šè¯‰msvcç¼–è¯‘å™¨å½“å‰ä»£ç æ–‡ä»¶ç”¨utf8å»ç¼–è¯‘ã€‚\nç¬¬ä¸‰æ­¥ï¼šmainå‡½æ•°ä¸­åŠ å…¥è®¾ç½®ç¼–ç çš„ä»£ç ï¼Œä»¥ä¾¿å…¼å®¹Qt4ï¼Œå¦‚æœæ²¡æœ‰Qt4çš„åœºæ™¯å¯ä»¥ä¸ç”¨ï¼Œä»Qt5å¼€å§‹é»˜è®¤å°±æ˜¯utf8ç¼–ç ã€‚12345678910111213141516void QUIHelper::setCode()&#123;#if (QT_VERSION &lt;= QT_VERSION_CHECK(5,0,0))#if _MSC_VER    QTextCodec *codec = QTextCodec::codecForName(&quot;gbk&quot;);#else    QTextCodec *codec = QTextCodec::codecForName(&quot;utf-8&quot;);#endif    QTextCodec::setCodecForLocale(codec);    QTextCodec::setCodecForCStrings(codec);    QTextCodec::setCodecForTr(codec);#else    QTextCodec *codec = QTextCodec::codecForName(&quot;utf-8&quot;);    QTextCodec::setCodecForLocale(codec);#endif&#125;\n\n\nå…³äºQtä¼—å¤šç‰ˆæœ¬ï¼ˆè‡³å°‘å‡ ç™¾ä¸ªï¼‰éƒ½ä¸å…¼å®¹çš„é—®é¢˜ï¼Œåœ¨ç»è¿‡å’ŒQtä¸­å›½çš„æ—æ–Œå¤§ç¥å’Œå…¶ä»–å¤§ç¥ï¼ˆQtéå®˜æ–¹æŠ€æœ¯äº¤æµç¾¤ï¼‰å¤´è„‘é£æš´ä»¥åï¼Œæœ€ç»ˆå¾—å‡ºä»¥ä¸‹çš„ç»“è®ºã€‚\n\n\nQtåœ¨äºŒè¿›åˆ¶å…¼å®¹è¿™å—ï¼Œå·²ç»åšäº†æœ€å¤§çš„åŠªåŠ›ï¼Œé€šè¿‡å°†å„ç§ä»£ç ç»†èŠ‚éšè—ï¼ŒQæŒ‡é’ˆ+DæŒ‡é’ˆæŠ€å·§ï¼Œå°½é‡ä¿æŒäº†æ¥å£çš„ç»Ÿä¸€ï¼›\næ˜¯å¦å…¼å®¹æœ€ä¸»è¦è€ƒè™‘ç¼–è¯‘å™¨çš„å› ç´ ï¼Œæ¯•ç«Ÿä»»ä½•Qtç‰ˆæœ¬éƒ½æ˜¯éœ€è¦é€šè¿‡ç¼–è¯‘å™¨ç¼–è¯‘æˆå¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”±ä»–è¯´äº†ç®—ã€‚å¦‚æœä¸¤ä¸ªQtç‰ˆæœ¬é‡‡ç”¨çš„ç¼–è¯‘å™¨ç‰ˆæœ¬ä¸€æ ·ï¼Œæå¤§æ¦‚ç‡å¯æ‰§è¡Œæ–‡ä»¶æ˜¯å…¼å®¹çš„ï¼Œæ¯”å¦‚ Qt5.10+msvc2015 32 ä½ å’Œ Qt5.11+msvc2015 32ä½ ç¼–è¯‘å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œéƒ½ç”¨Qt5.11çš„åº“æ˜¯å¯è¡Œçš„ï¼›\nmingwç¼–è¯‘å™¨çš„Qtç‰ˆæœ¬ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå°±æ˜¯å› ä¸ºQtå®˜æ–¹å®‰è£…åŒ…é›†æˆçš„mingwç¼–è¯‘å™¨ä¸€ç›´åœ¨æ›´æ–°ï¼ˆæå°‘é™„è¿‘ç‰ˆæœ¬æ²¡æœ‰æ›´æ–°mingwç¼–è¯‘å™¨ç‰ˆæœ¬é™¤å¤–ï¼‰ï¼Œæ¯”å¦‚5.7ç”¨çš„mingw53ï¼Œ5.12ç”¨çš„mingw73ï¼Œ5.15ç”¨çš„mingw81ï¼Œå› ä¸ºå¸¦çš„Qtåº“ä¹Ÿæ˜¯è¿™ä¸ªç¼–è¯‘å™¨ç¼–è¯‘å‡ºæ¥çš„ï¼Œæ‰€ä»¥å¯¼è‡´çœ‹èµ·æ¥å…¨éƒ¨ä¸å…¼å®¹ï¼›\nå¦‚æœæƒ³è¦å®Œå…¨å…¼å®¹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ³¨æ„è¦ç´ ï¼Œé‚£å°±æ˜¯å¯¹åº”ä»£ç ä½¿ç”¨çš„ç±»çš„å¤´æ–‡ä»¶æ¥å£æ˜¯å¦å˜äº†ï¼ŒæŒ‰é“ç†åŸæœ‰çš„æ¥å£æå°‘ä¼šå˜ï¼Œä¸€èˆ¬éƒ½æ˜¯æ–°å¢åŠ ï¼Œæˆ–è€…å¤§ç‰ˆæœ¬æ‰ä¼šæ”¹å˜ï¼Œæ¯”å¦‚Qt4-Qt5-Qt6è¿™ç§è‚¯å®šæ²¡æ³•å…¼å®¹çš„ï¼Œæ¥å£å’Œæ¨¡å—éƒ½å˜äº†ï¼›\nå¤§èƒ†çš„çŒœæµ‹ï¼šå¦‚æœQt5.6åˆ°Qt5.15ä½ å…¨éƒ¨ç”¨ä¸€ç§ç¼–è¯‘å™¨æ¯”å¦‚mingw73æˆ–è€…msvc2015é‡æ–°ç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„Qtè¿è¡Œåº“ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå¼€å‘ç¨‹åºï¼Œæœ€åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ç”¨Qt5.15çš„åº“æ˜¯éƒ½å¯ä»¥çš„ï¼Œè¿™æ ·å°±è½»æ¾è·¨è¶Šäº†å¤šä¸ªç‰ˆæœ¬å…¼å®¹ï¼›\nå¤§èƒ†çš„å»ºè®®ï¼šåœ¨é™„è¿‘çš„å‡ ä¸ªç‰ˆæœ¬ç»Ÿä¸€ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚5.6-5.12ä¹‹é—´å°±ç»Ÿä¸€ç”¨mingw53æˆ–è€…msvc2015,5.12-5.15ç»Ÿä¸€ç”¨msvc2017ï¼Œè¦å°é²œå…¶ä»–ç¼–è¯‘å™¨çš„å¯ä»¥è‡ªè¡Œæºç ç¼–è¯‘å…¶ä»–ç‰ˆæœ¬ï¼Œè¿™æ ·æœ€èµ·ç é™„è¿‘çš„ä¸€å¤§æ®µç‰ˆæœ¬ï¼ˆå¤§æ¦‚2-3å¹´çš„ç‰ˆæœ¬å‘¨æœŸï¼‰é»˜è®¤å°±å…¼å®¹äº†ã€‚\næœ¬äººæµ‹è¯•çš„æ˜¯widgetéƒ¨åˆ†ï¼Œqmlæœªåšæµ‹è¯•ï¼Œä¸æ¸…æ¥šæ˜¯å¦æœºåˆ¶ä¸€æ ·ï¼›\n\n\né€šè¿‡é…·ç å¤§å“¥ï¼ˆQtå¼€å‘è€…äº¤æµç¾¤ï¼‰çš„æŒ‡ç‚¹ï¼Œåˆ°ä»Šå¤©æ‰çŸ¥é“ï¼ŒQtè®¾ç½®æ ·å¼è¡¨æ”¯æŒç›´æ¥ä¼ å…¥æ ·å¼è¡¨æ–‡ä»¶è·¯å¾„ï¼Œäº²æµ‹4.7åˆ°5.15ä»»æ„ç‰ˆæœ¬ï¼Œé€šè¿‡æŸ¥çœ‹å¯¹åº”å‡½æ•°çš„æºç å¯ä»¥çœ‹åˆ°å†…éƒ¨ä¼šæ£€æŸ¥æ˜¯å¦æ˜¯ â€˜file:&#x2F;&#x2F;&#x2F;â€˜ å¼€å¤´ï¼Œæ˜¯çš„è¯åˆ™è‡ªåŠ¨è¯»å–æ ·å¼è¡¨æ–‡ä»¶è¿›è¡Œè®¾ç½®ï¼Œæ— éœ€æ‰‹åŠ¨è¯»å–ã€‚\n1234567891011//ä»¥å‰éƒ½æ˜¯ä¸‹é¢çš„æ–¹æ³•QFile file(&quot;:/qss/psblack.css&quot;);if (file.open(QFile::ReadOnly)) &#123;    QString qss = QLatin1String(file.readAll());    qApp-&gt;setStyleSheet(qss);    file.close();&#125;//å…¶å®ä¸€è¡Œä»£ç å°±è¡ŒqApp-&gt;setStyleSheet(&quot;file:///:/qss/psblack.css&quot;);//ç‰¹åˆ«è¯´æ˜ï¼Œåªæ”¯æŒqApp-&gt;setStyleSheet ä¸æ”¯æŒå…¶ä»–æ¯”å¦‚widget-&gt;setStyleSheet\n\nQtä¸­è‡ªå¸¦çš„å¾ˆå¤šæ§ä»¶ï¼Œå…¶å®éƒ½æ˜¯ç”±ä¸€å †åŸºç¡€æ§ä»¶ï¼ˆQLabelã€QPushButtonç­‰ï¼‰ç»„æˆçš„ï¼Œæ¯”å¦‚æ—¥å†é¢æ¿ QCalendarWidget å°±æ˜¯ QToolButton+QSpinBox+QTableView ç­‰ç»„æˆï¼Œå¦™ç”¨ findChildren å¯ä»¥æ‹¿åˆ°çˆ¶ç±»å¯¹åº”çš„å­æ§ä»¶é›†åˆï¼Œå¯ä»¥ç›´æ¥å¯¹å°è£…çš„æ§ä»¶ä¸­çš„å­æ§ä»¶è¿›è¡Œæ ·å¼çš„è®¾ç½®ï¼Œå…¶ä»–å‚æ•°çš„è®¾ç½®æ¯”å¦‚è®¾ç½®ä¸­æ–‡æ–‡æœ¬ï¼ˆé»˜è®¤å¯èƒ½æ˜¯è‹±æ–‡ï¼‰ç­‰ã€‚\n1234567891011121314151617181920212223242526//æ‰“å°å­ç±»ç±»åé›†åˆvoid printObjectChild(const QObject *obj, int spaceCount)&#123;    qDebug() &lt;&lt; QString(&quot;%1%2 : %3&quot;)             .arg(&quot;&quot;, spaceCount)             .arg(obj-&gt;metaObject()-&gt;className())             .arg(obj-&gt;objectName());    QObjectList childs = obj-&gt;children();    foreach (QObject *child, childs) &#123;        printObjectChild(child, spaceCount + 2);    &#125;&#125;//æ‹¿åˆ°å¯¹è¯æ¡†è¿›è¡Œè®¾ç½®å’Œç¾åŒ–QFileDialog *fileDialog = new QFileDialog(this);fileDialog-&gt;setOption(QFileDialog::DontUseNativeDialog, true);QLabel *lookinLabel = fileDialog-&gt;findChild&lt;QLabel*&gt;(&quot;lookInLabel&quot;);lookinLabel-&gt;setText(QString::fromLocal8Bit(&quot;æ–‡ä»¶ç›®å½•ï¼š&quot;));lookinLabel-&gt;setStyleSheet(&quot;color:red;&quot;);//è®¾ç½®æ—¥æœŸæ¡†é»˜è®¤å€¼ä¸ºç©ºQLineEdit *edit = ui-&gt;dateEdit-&gt;findChild&lt;QLineEdit *&gt;(&quot;qt_spinbox_lineedit&quot;);if (!edit-&gt;text().isEmpty()) &#123;    edit-&gt;clear();&#125;\n\nQtå†…ç½®äº†å„ç§å¯¹è¯æ¡†ï¼Œæ¯”å¦‚æ–‡ä»¶å¯¹è¯æ¡†-QFileDialog ï¼Œé¢œè‰²å¯¹è¯æ¡†-QColorDialog ï¼Œé»˜è®¤éƒ½ä¼šé‡‡ç”¨ç³»ç»Ÿçš„å¯¹è¯æ¡†é£æ ¼æ ·å¼ï¼Œè¿™æ ·å¯ä»¥ä¿æŒå’Œç³»ç»Ÿä¸€è‡´ï¼Œå¦‚æœä¸éœ€è¦çš„è¯å¯ä»¥å–æ¶ˆè¯¥ç‰¹æ€§ï¼Œå–æ¶ˆä»¥åä¼šé‡‡ç”¨Qtè‡ªèº«çš„å¯¹è¯æ¡†ï¼Œè¿™æ ·æ‰èƒ½è¿›è¡Œç¾åŒ–å’Œå…¶ä»–å¤„ç†ã€‚\n12345QFileDialog *fileDialog = new QFileDialog(this);//ä¸è®¾ç½®æ­¤å±æ€§æ ¹æœ¬æŸ¥æ‰¾ä¸åˆ°ä»»ä½•å­å…ƒç´ ,å› ä¸ºé»˜è®¤é‡‡ç”¨çš„ç³»ç»Ÿå¯¹è¯æ¡†fileDialog-&gt;setOption(QFileDialog::DontUseNativeDialog, true);qDebug() &lt;&lt; fileDialog-&gt;findChildren&lt;QLabel *&gt;();//æ‰“å°è¾“å‡º QLabel(0x17e2ff68, name=&quot;lookInLabel&quot;), QLabel(0x17e35f88, name=&quot;fileNameLabel&quot;), QLabel(0x17e35e68, name=&quot;fileTypeLabel&quot;)\n\nQtCreatoré›†æˆå¼€å‘ç¯å¢ƒï¼Œä¹Ÿå†…ç½®äº†å¯¹å¿«é€Ÿæ·»åŠ æ³¨é‡Šçš„æ”¯æŒï¼Œæ¯”å¦‚æœ€å¸¸ç”¨çš„åœ¨å¤´æ–‡ä»¶å¼€å¤´æ·»åŠ ä¸€å¤§æ®µé€šç”¨æ¨¡æ¿çš„æ³¨é‡Šï¼Œæ ‡æ³¨æ–‡ä»¶åˆ›å»ºè€…ã€æ—¶é—´ç­‰ä¿¡æ¯ã€‚\n\n\n\nèœå•-&gt;å·¥å…·-&gt;é€‰é¡¹-&gt;æ–‡æœ¬ç¼–è¾‘å™¨-&gt;å³ä¾§tabé¡µé¢ç‰‡æ®µ(snippets)ï¼›\nç»„é€‰æ‹©C++, å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢å·²ç»å†…ç½®äº†ä¸å°‘å®šä¹‰æ¯”å¦‚foreachï¼Œå¯ä»¥ä¾è‘«èŠ¦ç”»ç“¢ï¼›\næ·»åŠ ä¸€ä¸ªç‰‡æ®µ, æ¯”å¦‚åå­—æ˜¯fun, è§¦å‘ç§ç±»æ˜¯è¿™ä¸ªç‰‡æ®µçš„ç®€å•æè¿°ï¼›\nå½“æˆ‘ä»¬åœ¨ä»£ç æ–‡ä»¶ä¸­é”®å…¥funæ—¶, ä¼šè‡ªåŠ¨å¼¹å‡ºæ™ºèƒ½æé†’, é€‰æ‹©æˆ‘ä»¬çš„ä»£ç ç‰‡æ®µå›è½¦, è‡ªåŠ¨å¡«å……ä»£ç ï¼›\næŒ‰tabå¯ä»¥åœ¨å˜é‡é—´åˆ‡æ¢, è¾“å…¥å®Œæˆåå›è½¦, å®Œæˆç¼–è¾‘ï¼›12345678910/**  * @brief $name$  * @param $param$  * @author feiyangqingyun  * @date $date$  */$ret$ $name$($param$)&#123;    $$&#125;\n\n\nQt5æ—¶ä»£å¯¹ä¿¡å·æ§½è¿è¡Œæœºåˆ¶æ®è¯´æœ‰äº†å¾ˆå¤§çš„æ”¹è¿›ã€‚\n\n\nåœ¨Qt5ä¹‹å‰ï¼Œconnectä¸€èˆ¬éƒ½åªèƒ½è¿™ä¹ˆå†™connect(sender, SIGNAL(signalFunc()), receiver, SLOT(receiveFunc()))ï¼Œå°±æ˜¯è¯´åœ¨connectçš„æ—¶å€™ï¼Œå¿…é¡»æŠŠä¿¡å·ç”¨å®SIGNALåŒ…è£¹èµ·æ¥ï¼ŒæŠŠæ§½å‡½æ•°ç”¨å®SLOTåŒ…è£¹èµ·æ¥ï¼Œè¿™æ ·æ‰èƒ½è¢«Qtçš„Mocæœºåˆ¶è¯†åˆ«ï¼›\nåœ¨ç¼–è¯‘çš„æ—¶å€™å³ä½¿ä¿¡å·æˆ–æ§½ä¸å­˜åœ¨æˆ–è€…å‚æ•°ä¸æ­£ç¡®ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œçš„æ—¶å€™æ— æ•ˆï¼Œä¼šæ‰“å°æç¤ºï¼Œå¯¹äºC++è¿™ç§é™æ€è¯­è¨€æ¥è¯´ï¼Œè¿™æ˜¯ä¸å‹å¥½çš„ï¼Œä¸åˆ©äºè°ƒè¯•ï¼›\nä½†æ˜¯Qt5ä¹‹åæ›´åŠ æ¨èâ€å–åœ°å€çš„å†™æ³•â€ï¼Œé‡‡ç”¨è¿™ç§å†™æ³•ï¼Œå¦‚æœç¼–è¯‘çš„æ—¶å€™ä¿¡å·æˆ–æ§½ä¸å­˜åœ¨æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼Œç›¸å½“äºç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œä¸å®¹æ˜“å‡ºé”™ï¼›\nå¦‚æœæ²¡æœ‰å†å²é—ç•™é—®é¢˜éœ€è¦å…¼å®¹Qt4çš„è¯ï¼Œè¿˜æ˜¯æ¨èç”¨æ–°å†™æ³•ï¼Œæœ‰ç±»å‹æ£€æŸ¥æ›´ä¸¥æ ¼ï¼Œè€Œä¸”æ”¯æŒçš„å†™æ³•å¤šæ ·éå¸¸çµæ´»ï¼›\nä¸€äº›ç®€å•çš„å¤„ç†é€»è¾‘å¼ºçƒˆæ¨èç›´æ¥lambdaè¡¨è¾¾å¼ç›´æ¥å¤„ç†å®Œï¼›1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162class MainWindow : public QMainWindow&#123;    Q_OBJECTpublic: MainWindow(QWidget *parent = 0);    ~MainWindow();private:    Ui::MainWindow *ui;private:    void test_fun();private slots:    void test_slot();&#125;;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent)    , ui(new Ui::MainWindow)&#123;    ui-&gt;setupUi(this);    //æ—©æœŸå†™æ³•,é€šç”¨Qtæ‰€æœ‰ç‰ˆæœ¬,åªæ”¯æŒå®šä¹‰äº†slotså…³é”®å­—çš„å‡½æ•°    //connect(ui-&gt;pushButton, SIGNAL(clicked()), this, SLOT(test_fun()));    connect(ui-&gt;pushButton, SIGNAL(clicked()), this, SLOT(test_slot()));    //æ–°å†™æ³•,æ”¯æŒQt5åŠåæœŸæ‰€æœ‰ç‰ˆæœ¬,æ”¯æŒæ‰€æœ‰å‡½æ•°,æ— éœ€å®šä¹‰slotså…³é”®å­—ä¹Ÿè¡Œ    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, this, &amp;MainWindow::test_fun);    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, this, &amp;MainWindow::test_slot);    //å¦ç±»å†™æ³•,æ”¯æŒlambdaè¡¨è¾¾å¼,ç›´æ¥æ‰§è¡Œä»£ç     connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [this] &#123;test_fun();&#125;);    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [this] &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot;;    &#125;);    //lambdaå¸¦å‚æ•°    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [&amp;] (bool isCheck) &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot; &lt;&lt; isCheck;    &#125;);    //å¤´æ–‡ä»¶ signals:void sig_test(int i);    connect(this, &amp;MainWindow::sig_test, [] (int i) &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot; &lt;&lt; i;    &#125;);    emit sig_test(5);&#125;MainWindow::~MainWindow()&#123;    delete ui;&#125;void MainWindow::test_fun()&#123;    qDebug() &lt;&lt; &quot;test_fun&quot;;&#125;void MainWindow::test_slot()&#123;    qDebug() &lt;&lt; &quot;test_slot&quot;;&#125;\n\n\nQtæ ·å¼è¡¨æœ‰å¤šç§è¿è¡Œæœºåˆ¶ï¼Œä¸»è¦æ˜¯è€ƒè™‘åˆ°å„ç§éœ€æ±‚åœºæ™¯ï¼Œç»§æ‰¿è‡ªQWidgetçš„ç±»å’ŒqAppç±»éƒ½æ”¯æŒsetStyleSheetæ–¹æ³•ï¼Œè¿˜å¯ä»¥ç»Ÿä¸€å°†æ ·å¼è¡¨æ”¾åœ¨æ–‡ä»¶ï¼Œæˆ–è€…å°†æ ·å¼æ–‡ä»¶åŠ å…¥åˆ°èµ„æºæ–‡ä»¶ã€‚\n\n\næ–—æ°”ï¼šqsså†…å®¹å†™å¾—åˆ°å¤„éƒ½æ˜¯ï¼Œå“ªé‡Œéœ€è¦å°±å†™åœ¨å“ªé‡Œï¼Œå„ç§æ§ä»¶è°ƒç”¨ setStyleSheetæ–¹æ³•ä¼ å…¥æ ·å¼è¡¨å†…å®¹ï¼Œæˆ–è€…ç›´æ¥å¯¹åº”æ§ä»¶é¼ æ ‡å³é”®å¼¹å‡ºèœå•é€‰æ‹©æ”¹å˜æ ·å¼è¡¨å¡«å…¥å†…å®¹ï¼›\næ–—è€…ï¼šqsså†…å®¹æ”¾åœ¨æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶å†…å®¹è®¾ç½®æ ·å¼è¡¨ï¼Œç¨‹åºå‘å¸ƒçš„æ—¶å€™å¸¦ä¸Šqssæ–‡ä»¶ï¼›\næ–—å¸ˆï¼šqssæ–‡ä»¶ä½œä¸ºèµ„æºæ–‡ä»¶æ”¾åˆ°qrcæ–‡ä»¶ï¼Œç›´æ¥ç¼–è¯‘åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œé˜²æ­¢ç¯¡æ”¹ï¼›\næ–—çµï¼šåœ¨qssæ–‡ä»¶ä¸­è‡ªå®šä¹‰ä¸€äº›æ ‡å¿—å……å½“å˜é‡ä½¿ç”¨ï¼Œè¯»å–ä»¥åæ›¿æ¢å¯¹åº”çš„å˜é‡ä¸ºé¢œè‰²å€¼ï¼Œç±»ä¼¼åŠ¨æ€æ¢è‚¤ï¼›\næ–—ç‹ï¼šæ”¾åœ¨æ–‡ä»¶å®¹æ˜“è¢«ç¯¡æ”¹ï¼Œé›†æˆåˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸å¤Ÿçµæ´»ï¼Œä¸€æ—¦æ ·å¼è¡¨æ›´æ–°éœ€è¦é‡æ–°ç¼–è¯‘æ–‡ä»¶ï¼Œå¦‚ä½•åšåˆ°æ—¢èƒ½åªæ›´æ–°æ ·å¼è¡¨æ–‡ä»¶ï¼Œåˆä¸éœ€è¦é‡æ–°ç¼–è¯‘å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆèƒ½é˜²æ­¢è¢«ç¯¡æ”¹ï¼šé‡‡ç”¨rccå‘½ä»¤å°†èµ„æºæ–‡ä»¶ç¼–è¯‘ç”ŸæˆäºŒè¿›åˆ¶ï¼Œåªéœ€è¦æ›¿æ¢è¯¥äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼›\næ–—çš‡ï¼šç»§æ‰¿qstyleç±»è‡ªå·±å®ç°å®Œæˆæ‰€æœ‰æ ·å¼æ¥å£ï¼Œç»Ÿä¸€æ•´ä½“é£æ ¼ï¼Œå¤§åé¼é¼çš„UOSç³»ç»Ÿé»˜è®¤è§„åˆ™å°±æ˜¯å¦‚æ­¤ï¼Œä¸å…è®¸ç”¨æ ·å¼è¡¨ï¼Œå…¨éƒ¨painterç»˜åˆ¶ï¼›\n\n16ï¼š151-160\nå½“Qtä¸­ç¼–è¯‘èµ„æºæ–‡ä»¶å¤ªå¤§æ—¶ï¼Œæ•ˆç‡å¾ˆä½ï¼Œæˆ–è€…éœ€è¦ä¿®æ”¹èµ„æºæ–‡ä»¶ä¸­çš„æ–‡ä»¶æ¯”å¦‚å›¾ç‰‡ã€æ ·å¼è¡¨ç­‰ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™æ ·å¾ˆä¸å‹å¥½ï¼Œå½“ç„¶Qtéƒ½ç»™æˆ‘ä»¬è€ƒè™‘å¥½äº†ç­–ç•¥ï¼Œæ­¤æ—¶å¯ä»¥å°†èµ„æºæ–‡ä»¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶çš„rccæ–‡ä»¶ï¼Œè¿™æ ·å°±å°†èµ„æºæ–‡ä»¶å•ç‹¬å‡ºæ¥äº†ï¼Œå¯åœ¨éœ€è¦çš„æ—¶å€™åŠ¨æ€åŠ è½½ã€‚\n12345//Qtä¸­ä½¿ç”¨äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶æ–¹æ³•å¦‚ä¸‹//å°†qrcç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶rccï¼Œåœ¨æ§åˆ¶å°æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ rcc -binary main.qrc -o main.rcc//åœ¨åº”ç”¨ç¨‹åºä¸­æ³¨å†Œèµ„æºï¼Œä¸€èˆ¬åœ¨mainå‡½æ•°å¯åŠ¨åå°±æ³¨å†ŒQResource::registerResource(qApp-&gt;applicationDirPath() + &quot;/main.rcc&quot;);\n\nå…³äºè®¾ç½®å­—ä½“ï¼Œå¤§æ¦‚éƒ½ä¼šç»å†ä¸€ä¸ªè¯¯åŒºï¼Œæœ¬æ¥æ˜¯æ‰“ç®—è®¾ç½®æ•´ä¸ªçª—ä½“åŒ…æ‹¬å­æ§ä»¶çš„å­—ä½“å¤§å°çš„ï¼Œç»“æœå‘ç°åªæœ‰ä¸»çª—ä½“è‡ªå·±åº”ç”¨äº†å­—ä½“è€Œå­æ§ä»¶æ²¡æœ‰ã€‚\n123456789101112131415161718//å‡è®¾çª—ä½“ä¸­æœ‰å­æ§ä»¶ï¼Œé»˜è®¤å­—ä½“12pxï¼Œçˆ¶ç±»ç±»å‹æ˜¯QWidgetï¼Œçˆ¶ç±»ç±»åæ˜¯Widget//ä¸‹é¢å‡ ç§æ–¹æ³•åªä¼šè®¾ç½®ä¸»çª—ä½“çš„å­—ä½“ï¼Œå­æ§ä»¶ä¸ä¼šåº”ç”¨ï¼Œéœ€è¦æŒ‰ä¸ªè°ƒç”¨setFontQFont font;font.setPixelSize(20);this-&gt;setFont(font);this-&gt;setStyleSheet(&quot;&#123;font:26px;&#125;&quot;);this-&gt;setStyleSheet(&quot;QWidget&#123;font:26px;&#125;&quot;);this-&gt;setStyleSheet(&quot;Widget&#123;font:26px;&#125;&quot;);//ä¸‹é¢æ‰æ˜¯é€šè¿‡æ ·å¼è¡¨è®¾ç½®æ•´ä¸ªæ§ä»¶+å­æ§ä»¶çš„å­—ä½“this-&gt;setStyleSheet(&quot;font:26px;&quot;);this-&gt;setStyleSheet(&quot;*&#123;font:26px;&#125;&quot;);this-&gt;setStyleSheet(&quot;QWidget&gt;*&#123;font:26px;&#125;&quot;);this-&gt;setStyleSheet(&quot;Widget&gt;*&#123;font:26px;&#125;&quot;);//ä¸‹é¢è®¾ç½®å…¨å±€å­—ä½“qApp-&gt;setFont(font);\n\nQtä¸­å°è£…çš„QImageå¼‚å¸¸çš„å¼ºå¤§ï¼Œæä¾›äº†å„ç§å›¾ç‰‡æ ¼å¼çš„è½¬æ¢ï¼Œè¿˜å¯ä»¥å¯¹æ¯ä¸ªåƒç´ çš„é¢œè‰²å€¼è¿›è¡Œæ›¿æ¢ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å°†å•è‰²çš„å›¾ç‰‡æ¢æˆå¦å¤–ä¸€ç§é¢œè‰²ï¼Œè¦æ³¨æ„çš„æ˜¯å¦‚æœå¸¦æœ‰é€æ˜å€¼çš„é¢œè‰²éœ€è¦è¿›è¡Œæ ¼å¼è½¬åŒ–ï¼Œæ¯”å¦‚è½¬æˆFormat_ARGB32æˆ–è€…Format_RGBA8888ã€‚\n1234567891011121314151617181920//pixel      å‡½æ•°è·å–åƒç´ ç‚¹çš„é¢œè‰² setPixel      å‡½æ•°è®¾ç½®åƒç´ ç‚¹çš„é¢œè‰² æ­¤å‡½æ•°ä»»æ„Qtç‰ˆæœ¬éƒ½æœ‰//pixelColor å‡½æ•°è·å–åƒç´ ç‚¹çš„é¢œè‰² setPixelColor å‡½æ•°è®¾ç½®åƒç´ ç‚¹çš„é¢œè‰² æ­¤å‡½æ•°Qt5.6ä»¥åæ‰æœ‰//pixelå‡½æ•°å–å‡ºæ¥çš„æ˜¯QRgbæ ¼å¼éœ€è¦ç”¨ qRed qGreen qBlue qAlpha è¿›è¡Œè½¬æ¢QImage image(&quot;1.png&quot;);image = image.convertToFormat(QImage::Format_ARGB32);int width = image.width();int height = image.height();//éå†å›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ for (int x = 0; x &lt; width; ++x) &#123;    for (int y = 0; y &lt; height; ++y) &#123;        QString name = image.pixelColor(x, y).name();        //å°†ç™½è‰²ä»¥å¤–çš„é¢œè‰²å…¨éƒ¨æ›¿æ¢æˆçº¢è‰²        if (name != &quot;#ffffff&quot;) &#123;            image.setPixelColor(x, y, Qt::red);        &#125;    &#125;&#125;//ä¿å­˜æ–‡ä»¶image.save(&quot;2.png&quot;);\n\nåœ¨æ•°æ®åº“ç›¸å…³çš„åº”ç”¨ä¸­ï¼Œå¦‚æœä»…ä»…æ˜¯å•æœºç‰ˆæœ¬ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„éœ€è¦ï¼ˆæ¯”å¦‚é¢†å¯¼æŒ‡å®šï¼Œæˆ–è€…éœ€è¦è¿œç¨‹å­˜æ”¾æ•°æ®ï¼‰ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨sqliteæ•°æ®åº“ï¼Œè¿™æ˜¯æœ¬äººç»è¿‡æ— æ•°æ¬¡çš„å¯¹æ¯”æµ‹è¯•å’ŒNä¸ªå•†ä¸šé¡¹ç›®åº”ç”¨å¾—å‡ºçš„ç»“è®ºã€‚\n\n\n\nQtå¤©ç”Ÿå†…ç½®äº†sqliteæ•°æ®åº“ï¼Œåªéœ€è¦å‘å¸ƒçš„æ—¶å€™å¸¦ä¸Šæ’ä»¶å°±è¡Œï¼ˆå¯ä»¥çœ‹åˆ°æ’ä»¶åŠ¨æ€åº“æ–‡ä»¶æ¯”å…¶ä»–å‡ ç§éƒ½è¦å¤§ï¼Œé‚£æ˜¯å› ä¸ºç›´æ¥å°†æ•°æ®åº“çš„æºç éƒ½ç¼–è¯‘è¿›å»äº†ï¼Œè€Œå…¶ä»–åªç¼–è¯‘äº†ä¸­é—´é€šä¿¡äº¤äº’çš„æ’ä»¶æºç ï¼‰ï¼Œå…¶ä»–æ•°æ®åº“è¦ä¹ˆè¿˜è¦å¸¦ä¸ŠåŠ¨æ€åº“ï¼Œè¦ä¹ˆè¿˜éœ€è¦åˆ›å»ºæ•°æ®æºï¼›\né€Ÿåº¦ä¸Šï¼Œç»å¯¹æ— ä¸ä¼¦æ¯”çš„å‡ºç±»æ‹”èƒï¼ŒåŒæ ·çš„æ•°æ®åº“ç»“æ„ï¼ˆè¡¨ç»“æ„ã€ç´¢å¼•ç­‰å®Œå…¨ä¸€è‡´ï¼‰ï¼ŒæŸ¥è¯¢é€Ÿåº¦å’Œæ‰¹é‡æ›´æ–°é€Ÿåº¦ã€æ•°æ®åº“äº‹åŠ¡ç­‰ï¼Œé€Ÿåº¦éƒ½æ˜¯å…¶ä»–å‡ ç§çš„è‡³å°‘3å€ä»¥ä¸Šï¼Œè€Œä¸”éšç€æ•°æ®é‡çš„å¢å¤§å¯¹æ¯”è¶Šå‘æ˜æ˜¾ï¼›\nå‡ åƒä¸‡çš„æ•°æ®é‡å®Œå…¨æ²¡é—®é¢˜ï¼Œè€Œä¸”é€Ÿåº¦å’Œæ€§èƒ½éƒ½è¿˜å¯ä»¥ï¼Œä¸è¦ä»¥è®¹ä¼ è®¹ç½‘ä¸Šéƒ¨åˆ†èœé¸¡è¯´çš„ä¸æ”¯æŒç™¾ä¸‡ä»¥ä¸Šçš„æ•°æ®é‡ï¼Œæœ¬äººäº²æµ‹äº¿çº§åˆ«ï¼Œæ•°æ®é‡å»ºè®®åƒä¸‡çº§åˆ«ä»¥ä¸‹ï¼Œç€é‡æ³¨æ„æ•°æ®åº“è¡¨å’Œç´¢å¼•çš„è®¾è®¡ï¼›\nå…¶ä»–æ•°æ®åº“è¿˜è¦æ³¨æ„ç‰ˆæœ¬çš„åŒºåˆ«ï¼ŒODBCæ•°æ®æºå½¢å¼è¿˜å®¹æ˜“å‡ºé”™å’Œæ‰§è¡Œå¤±è´¥ï¼›\nsqliteæ•°æ®åº“ä¹Ÿæœ‰å‡ ä¸ªé‡å¤§ç¼ºç‚¹ï¼šä¸æ”¯æŒåŠ å¯†ï¼Œä¸æ”¯æŒç½‘ç»œè®¿é—®ï¼Œä¸æ”¯æŒéƒ¨åˆ†æ•°æ®åº“é«˜çº§ç‰¹æ€§ï¼Œä¸æ”¯æŒæµ·é‡æ•°æ®ï¼ˆäº¿çº§åˆ«ä»¥ä¸Šï¼‰ï¼Œä½†æ˜¯å¯¹äºç»å¤§éƒ¨åˆ†Qté¡¹ç›®è¿˜æ˜¯è¶³å¤Ÿï¼›\næ•°æ®åº“æ”¯æŒå‹å¥½åº¦å¤§è‡´æ˜¯ sqlite &gt; postgresql &gt; mysql &gt; odbc ;\nå¦‚æœé‡‡ç”¨çš„odbcæ•°æ®æºæ¨¡å¼è¿æ¥æ•°æ®åº“ï¼Œåªéœ€è¦è®¾ç½®æ•°æ®åº“åç§°ä¸ºå¯¹åº”æ–°å»ºçš„æ•°æ®æºåå­—ï¼Œç„¶åè®¾ç½®ç”¨æˆ·åå’Œå¯†ç å°±è¡Œï¼Œä¸éœ€è¦è®¾ç½®ä¸»æœºåç§°å’Œç«¯å£ï¼Œå› ä¸ºæ•°æ®æºé‚£è¾¹å·²ç»è®¾ç½®è¿‡çš„ï¼Œè¿™é‡Œåªéœ€è¦å†æ¬¡éªŒè¯ç”¨æˆ·ä¿¡æ¯å°±è¡Œã€‚\nODBCæ•°æ®æºåˆ†32&#x2F;64ä½ä¹‹åˆ†ï¼Œåœ¨æ•°æ®æºç®¡ç†å™¨ä¸­ï¼Œå¦‚æœæ·»åŠ çš„æ•°æ®æºå¯¹åº”å¹³å°æ˜¾ç¤ºçš„åªæœ‰32æˆ–è€…åªæœ‰64ä½ï¼Œé‚£ä½ çš„Qtç¨‹åºä¹Ÿåªèƒ½æ˜¯å¯¹åº”ä½æ•°çš„æ‰èƒ½è¿æ¥æˆåŠŸã€‚å¦‚æœæ˜¾ç¤ºçš„æ˜¯64ä½ï¼Œä½ ç”¨32ä½çš„ç¨‹åºå»è¿æ¥ä¼šå¤±è´¥ã€‚\n32ä½çš„Qtç¨‹åºï¼Œå¸¦å¯¹åº”32ä½çš„libmysqlåŠ¨æ€åº“ï¼Œå¯ä»¥è®¿é—®32&#x2F;64ä½çš„mysqlæ•°æ®åº“ï¼Œ64ä½çš„ä¹Ÿæ˜¯ä¸€æ ·å¯ä»¥è®¿é—®32&#x2F;64ä½çš„mysqlæ•°æ®åº“ï¼Œåªéœ€è¦å¸¦ä¸Šå¯¹åº”ä½æ•°çš„åŠ¨æ€åº“å°±è¡Œã€‚æŸ¥çœ‹mysqlæ˜¯32ä½è¿˜æ˜¯64ä½å‘½ä»¤ mysql.exe -Vã€‚\nåœ¨mysqlé©±åŠ¨å¯ç”¨ä¸”æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¿˜æ˜¯æç¤ºDriver not loaded Driver not loadedï¼Œåˆ™å¾ˆå¯èƒ½æ˜¯æ‹·è´çš„libmysqlåŠ¨æ€åº“ç‰ˆæœ¬ä¸å¯¹æˆ–è€…ä½æ•°ä¸å¯¹å¯¼è‡´çš„ã€‚\nä»¥ä¸Šéƒ½æ˜¯åœ¨Qtç¯å¢ƒä¸­ä¸ªäººæµ‹è¯•å¾—å‡ºçš„ç»“è®ºï¼Œç»“æœæœªå¿…æ­£ç¡®ï¼Œä½œä¸ºå‚è€ƒå³å¯ï¼Œå…¶ä»–ç¼–ç¨‹ç¯å¢ƒæ¯”å¦‚C#ã€JAVAè¯·å¿½ç•¥ï¼Œä¹Ÿè®¸å·®åˆ«å¯èƒ½åœ¨ä¸­é—´é€šä¿¡çš„æ•ˆç‡é€ æˆçš„ï¼›\n\n\nQt5.10ä»¥åæä¾›äº†æ–°çš„ç±» QRandomGenerator QRandomGenerator64 ç®¡ç†éšæœºæ•°ï¼Œä½¿ç”¨æ›´æ–¹ä¾¿ï¼Œå°¤å…¶æ˜¯å–æŸä¸ªåŒºé—´çš„éšæœºæ•°ã€‚\n123456789101112131415161718192021222324252627282930313233//æ—©æœŸå¤„ç†åŠæ³• å…ˆåˆå§‹åŒ–éšæœºæ•°ç§å­ç„¶åå–éšæœºæ•°qsrand(QTime::currentTime().msec());//å– 0-10 ä¹‹é—´çš„éšæœºæ•°qrand() % 10;//å– 0-1 ä¹‹é—´çš„æµ®ç‚¹æ•°qrand() / double(RAND_MAX);//æ–°ç‰ˆå¤„ç†åŠæ³• æ”¯æŒ5.10ä»¥åçš„æ‰€æœ‰ç‰ˆæœ¬åŒ…æ‹¬qt6QRandomGenerator::global()-&gt;bounded(10);      //ç”Ÿæˆä¸€ä¸ª0å’Œ10ä¹‹é—´çš„æ•´æ•°QRandomGenerator::global()-&gt;bounded(10.123);  //ç”Ÿæˆä¸€ä¸ª0å’Œ10.123ä¹‹é—´çš„æµ®ç‚¹æ•°QRandomGenerator::global()-&gt;bounded(10, 15);  //ç”Ÿæˆä¸€ä¸ª10å’Œ15ä¹‹é—´çš„æ•´æ•°//å…¼å®¹qt4-qt6åŠä»¥åæ‰€æœ‰ç‰ˆæœ¬çš„æ–¹æ³• å°±æ˜¯ç”¨æ ‡å‡†c++çš„éšæœºæ•°å‡½æ•°srand(QTime::currentTime().msec());rand() % 10;rand() / double(RAND_MAX);//é€šç”¨å…¬å¼ aæ˜¯èµ·å§‹å€¼,næ˜¯æ•´æ•°çš„èŒƒå›´int value = a + rand() % n;//(min, max)çš„éšæœºæ•°int value = min + 1 + (rand() % (max - min - 1));//(min, max]çš„éšæœºæ•°int value = min + 1 + (rand() % (max - min + 0));//[min, max)çš„éšæœºæ•°int value = min + 0 + (rand() % (max - min + 0));//[min, max]çš„éšæœºæ•°int value = min + 0 + (rand() % (max - min + 1));//å¦‚æœåœ¨çº¿ç¨‹ä¸­å–éšæœºæ•°ï¼Œçº¿ç¨‹å¯åŠ¨çš„æ—¶é—´å‡ ä¹ä¸€æ ·ï¼Œå¾ˆå¯èƒ½å‡ºç°å–åˆ°çš„éšæœºæ•°ä¸€æ ·çš„é—®é¢˜ï¼Œå°±ç®—è®¾ç½®éšæœºæ•°ä¸ºå½“å‰æ—¶é—´å•¥çš„ä¹Ÿæ²¡ç”¨ï¼Œç”µè„‘å¤ªå¿«å¾ˆå¯èƒ½è¿˜æ˜¯ä¸€æ ·çš„æ—¶é—´ï¼ŒåŒä¸€ä¸ªæ¯«ç§’ã€‚//å–å·§åŠæ³•å°±æ˜¯åœ¨runå‡½æ•°ä¹‹å‰æœ€å‰é¢å°†å½“å‰çº¿ç¨‹çš„idä½œä¸ºç§å­è®¾ç½®ã€‚æ—¶é—´ä¸å¯é ï¼Œçº¿ç¨‹çš„idæ‰æ˜¯å”¯ä¸€çš„ã€‚//åˆ‡è®° void * è½¬æ¢åˆ°æ•°å€¼å¿…é¡»ç”¨ long longï¼Œåœ¨32ä½æ˜¯å¯ä»¥intä½†æ˜¯åœ¨64ä½å¿…é¡»longï¼Œç¡®ä¿ä¸‡ä¸€ç›´æ¥ç”¨quint64æœ€å¤§srand((long long)currentThreadId());qrand((long long)currentThreadId());\n\nQtçš„UIç•Œé¢åœ¨resizeä»¥åæœ‰ä¸ªBUGï¼Œæ‚¬åœæ ·å¼æ²¡æœ‰å–æ¶ˆæ‰ï¼Œéœ€è¦ä¸»åŠ¨æ¨¡æ‹Ÿé¼ æ ‡åŠ¨ä¸€ä¸‹ã€‚\n12345678void frmMain::on_btnMenu_Max_clicked()&#123;    ......    //æœ€å¤§åŒ–ä»¥åæœ‰ä¸ªBUG,æ‚¬åœæ ·å¼æ²¡æœ‰å–æ¶ˆæ‰,éœ€è¦ä¸»åŠ¨æ¨¡æ‹Ÿé¼ æ ‡åŠ¨ä¸€ä¸‹        QEvent event(QEvent::Leave);    QApplication::sendEvent(ui-&gt;btnMenu_Max, &amp;event);    &#125;\n\né¡¹ç›®ä¸­å¯ç”¨c++11è¯­æ³•æ”¯æŒã€‚\n12greaterThan(QT_MAJOR_VERSION, 4): CONFIG += c++11lessThan(QT_MAJOR_VERSION, 5): QMAKE_CXXFLAGS += -std=c++11\n\nQtçš„æ–‡æœ¬æ§ä»¶æ¯”å¦‚QTextEdité»˜è®¤åŠ è½½å¤§æ–‡æœ¬æ¯”å¦‚10MBçš„æ–‡æœ¬ï¼Œå¾ˆå®¹æ˜“å¡æ­»ç”šè‡³å´©æºƒï¼Œé‚£æ˜¯å› ä¸ºé»˜è®¤ä¸€ä¸ªå±æ€§å¼€å¯äº†ï¼Œéœ€è¦å±è”½æ‰å°±å¥½å¾ˆå¤šã€‚\n1ui-&gt;textEdit-&gt;setUndoRedoEnabled(false);\n\nå…¶ä»–å‡ ç‚¹å¸¸è§„å°ç»éªŒï¼Œæœ¬äººåœ¨è¿™å‡ ä¸ªåœ°æ–¹æ‘”è·¤è¿‡å¾ˆå¤šæ¬¡ã€‚\n\n\n\næœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œä¸€å®šè¦ä¸»åŠ¨returnè¿”å›å€¼ï¼Œæœ‰éƒ¨åˆ†ç¼–è¯‘å™¨åœ¨æ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µä¸‹ä¹Ÿèƒ½æ­£å¸¸ç¼–è¯‘é€šè¿‡ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™ä¼šå‡ºé—®é¢˜ï¼Œå¾—ä¸åˆ°æƒ³è¦çš„ç»“æœï¼Œå› ä¸ºæ²¡æœ‰returnå¯¹åº”çš„å€¼ã€‚\nå®šä¹‰çš„å±€éƒ¨å˜é‡ï¼Œä¸»åŠ¨ç»™å®šä¸ªåˆå§‹å€¼ï¼Œæ˜¯ä¸ªå¿…é¡»å…»æˆçš„å¥½ä¹ æƒ¯ï¼Œä¸ç„¶ç¼–è¯‘å™¨ç»™çš„åˆå§‹å€¼å¾ˆå¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œæ¯”å¦‚intå˜é‡é»˜è®¤0ï¼Œæœ‰æ—¶å€™éšæœºå˜æˆä¸€ä¸ªå¾ˆå¤§çš„æ•°å€¼ï¼Œboolå˜é‡çš„åˆå§‹å€¼ä¸åŒç¼–è¯‘å™¨ä¸åŒå€¼ï¼Œæœ‰äº›æ˜¯trueæœ‰äº›æ˜¯falseï¼Œä¸»åŠ¨ç»™ä¸€ä¸ªåˆå§‹å€¼æ›´å¯é ã€‚\næŸäº›å‡½æ•°å‚æ•°å¾ˆå¤šï¼Œè€Œä¸”åæœŸå¯èƒ½è¿˜ä¼šä¿®æ”¹å’Œå¢åŠ ï¼Œè¿™å°±å¯¼è‡´äº†æºå¤´ä¿®æ”¹ä»¥åï¼Œå…³è”ä¿¡å·æ§½çš„åœ°æ–¹ä¹Ÿè¦ä¿®æ”¹ï¼Œå‚æ•°ç±»å‹å’Œä½ç½®å¿…é¡»ä¿æŒå®Œå…¨ä¸€è‡´ï¼Œå¯¹åº”æ§½å‡½æ•°å¤„ç†ä¹Ÿè¦ä¿®æ”¹ç­‰ï¼Œæ”¹åŠ¨çš„å·¥ä½œé‡éå¸¸å¤§è€Œä¸”æä¸å‹å¥½ï¼Œæ‰€ä»¥å¯¹äºéå›ºå®šå‚æ•°çš„å‡½æ•°ï¼Œå»ºè®®ç”¨ç»“æ„ä½“ï¼Œè¿™æ ·éå¸¸å®¹æ˜“å¢åŠ å…¶ä»–çš„å‚æ•°ï¼Œè€Œä¸”ä¸ç”¨ä¿®æ”¹ä¿¡å·æ§½å…³è”å’Œä¿¡å·æ§½å‡½æ•°å®šä¹‰ç­‰ï¼Œæ¯”å¦‚å­¦ç”Ÿä¿¡æ¯è¡¨ã€å•†å“ä¿¡æ¯è¡¨ä½œä¸ºå‚æ•°ä¼ è¾“ï¼Œæœ€ä½³æ–¹æ¡ˆå°±æ˜¯ç»“æ„ä½“ã€‚\n\n\nQTabWidgeté€‰é¡¹å¡æ§ä»¶ï¼Œç”Ÿæˆçš„tabbaré€‰é¡¹å¡å®½åº¦æ˜¯æŒ‰ç…§æ–‡æœ¬è‡ªåŠ¨è®¾ç½®çš„ï¼Œæ–‡æœ¬è¶Šé•¿é€‰é¡¹å¡çš„å®½åº¦è¶Šå¤§ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€æ ·çš„å®½åº¦æˆ–è€…ç­‰åˆ†å¡«å……ï¼Œ12345678910111213141516171819202122232425262728293031//æ–¹æ³•1ï¼šå­—ç¬¦ä¸²ç©ºæ ¼å¡«å……ui-&gt;tabWidget-&gt;addTab(httpClient1, &quot;æµ‹    è¯•&quot;);ui-&gt;tabWidget-&gt;addTab(httpClient1, &quot;äººå‘˜ç®¡ç†&quot;);ui-&gt;tabWidget-&gt;addTab(httpClient1, &quot;ç³»ç»Ÿè®¾ç½®&quot;);//æ–¹æ³•2ï¼šè¯†åˆ«å°ºå¯¸æ”¹å˜äº‹ä»¶è‡ªåŠ¨è®¾ç½®æœ€å°å®½åº¦void MainWindow::resizeEvent(QResizeEvent *e)&#123;    int count = ui-&gt;tabWidget-&gt;tabBar()-&gt;count();    int width = this-&gt;width() - 30;    QString qss = QString(&quot;QTabBar::tab&#123;min-width:%1px;&#125;&quot;).arg(width / count);    this-&gt;setStyleSheet(qss);&#125;//æ–¹æ³•3ï¼šè®¾ç½®å…¨å±€æ ·å¼ï¼Œä¸åŒé€‰é¡¹å¡ä¸ªæ•°çš„è®¾ç½®ä¸åŒçš„å®½åº¦QStringList list;list &lt;&lt; QString(&quot;QTabWidget[tabCount=\\&quot;2\\&quot;]&gt;QTabBar::tab&#123;min-width:%1px;&#125;&quot;).arg(100);list &lt;&lt; QString(&quot;QTabWidget[tabCount=\\&quot;3\\&quot;]&gt;QTabBar::tab&#123;min-width:%1px;&#125;&quot;).arg(70);qApp-&gt;setStyleSheet(list.join(&quot;&quot;));//è®¾ç½®äº†tabCountå¼±å±æ€§è‡ªåŠ¨å»æ‰¾å¯¹åº”çš„å®½åº¦è®¾ç½®ui-&gt;tabWidget-&gt;setProperty(&quot;tabCount&quot;, 2);ui-&gt;tabWidget-&gt;setProperty(&quot;tabCount&quot;, 3);//æ–¹æ³•4ï¼šå¼ºçƒˆæ¨è-ã€‹ä½¿ç”¨å†…ç½®çš„æ–¹æ³• setExpanding setDocumentMode ä¸¤ä¸ªå±æ€§éƒ½å¿…é¡»è®¾ç½®//Qt4çš„tabBar()æ˜¯propectedçš„ï¼Œæ‰€ä»¥å»ºè®®è¿˜æ˜¯é€šè¿‡æ ·å¼è¡¨è®¾ç½®ui-&gt;tabWidget-&gt;tabBar()-&gt;setDocumentMode(true);ui-&gt;tabWidget-&gt;tabBar()-&gt;setExpanding(true);//æ ·å¼è¡¨ä¸€æ­¥åˆ°ä½ä¸ç”¨æ¯ä¸ªéƒ½å•ç‹¬è®¾ç½®QString(&quot;QTabBar&#123;qproperty-usesScrollButtons:false;qproperty-documentMode:true;qproperty-expanding:true;&#125;&quot;);//åœ¨5.9ä»¥å‰å¼€å¯è¿™ä¸ªè®¾ç½®åï¼Œè²Œä¼¼é€‰é¡¹å¡ä¸ªæ•°æŒ‰ç…§çœŸå®ä¸ªæ•°+1è®¡ç®—å®½åº¦ï¼Œä¹Ÿå°±æ˜¯æ°¸è¿œä¼šç•™ç©ºä¸€ä¸ªtabçš„å ä½ã€‚//5.9ä»¥åè²Œä¼¼ä¿®å¤äº†è¿™ä¸ªBUGï¼ŒæŒ‰ç…§ç†æƒ³ä¸­çš„æ‹‰ä¼¸å¡«å……ç­‰åˆ†è®¾ç½®tabçš„å®½åº¦ã€‚\n\n17ï¼š161-170\nç»å¸¸æœ‰äººè¯´Qtåƒåœ¾ï¼Œè¯´ç”¨Qtåœ¨1æ¯«ç§’ç»˜åˆ¶å‡ åƒä¸ªæ•°æ®ç‚¹å¡æˆå±ã€‚å…¶å®æ˜¾ç¤ºå™¨æœ€é«˜åˆ·æ–°é¢‘ç‡ä¸€èˆ¬æ‰60å¸§ï¼Œ1æ¯«ç§’å°±ç»˜åˆ¶ä¸€æ¬¡æœ‰æ„ä¹‰å—ï¼Ÿä¸ä»…æ˜¾ç¤ºå™¨æ²¡åˆ·æ–°è¿‡æ¥ï¼Œäººè‚‰çœ¼ä¹Ÿçœ‹ä¸è¿‡æ¥ï¼ˆæœ‰äººå¯èƒ½åˆè¦æŠ¬æ è¯´è¿™æ˜¯è€æ¿è¦æ±‚çš„ï¼Œæ˜¾ç¤ºå½’æ˜¾ç¤ºï¼Œè‡³äºäººçœ‹ä¸çœ‹é‚£æ˜¯å¦å¤–ä¸€å›äº‹ï¼Œæˆ‘æƒ³è¯´çš„æ˜¯æ˜¾ç¤ºä¸å°±æ˜¯ç»™äººçœ‹çš„å—ï¼Ÿç»™ç¨‹åºçœ‹å¯ä»¥ç›´æ¥åå°ç»˜åˆ¶å›¾ç‰‡è®©ç¨‹åºè¯†åˆ«å•Šæ²¡å¿…è¦æ˜¾ç¤ºçš„ï¼‰ï¼Œç¨‹åºä¸­è¦åšçš„åº”è¯¥æ˜¯å°½é‡é™ä½ç¨‹åºçš„ç»˜åˆ¶åˆ·æ–°é¢‘ç‡åˆ°æ˜¾ç¤ºå™¨çš„é¢‘ç‡ï¼ˆå…¶å®ä¸€ç§’é’Ÿ30å¸§éƒ½è¶³å¤Ÿï¼‰ï¼Œä¸€æ¬¡æå¤šä¸€ç‚¹çš„æ•°æ®ä¸€æ¬¡æ€§ç»˜åˆ¶ï¼ˆæ•°æ®é‡å¾ˆå¤§è¿˜å¯ä»¥è€ƒè™‘é‡é‡‡æ ·ï¼Œæ¯”å¦‚å¹³å‡å€¼æ³•ç­‰ï¼Œæ¯•ç«Ÿè¦è€ƒè™‘æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡å°±é‚£ä¹ˆå¤§ï¼Œæä¸ªå‡ åä¸‡çš„æ•°æ®ç‚¹æŒ¤ä¸€å—æ²¡å•¥æ„æ€ï¼Œå¯ä»¥å°†ä¸€æ•´å—åŒºåŸŸå†…çš„æ•°æ®ç‚¹æ¢æˆä¸€ä¸ªç‚¹ï¼‰ï¼Œè€Œä¸æ˜¯ç»˜åˆ¶å¤šæ¬¡ï¼Œå°½ç®¡ä¸¤ç§åŠæ³•éƒ½å¯ä»¥å°†æ”¶åˆ°çš„æ•°æ®ç»˜åˆ¶å®Œæˆï¼Œä½†æ˜¯æ•ˆç‡ç›¸å·®çš„ä¸æ˜¯ä¸€ç‚¹ç‚¹ï¼Œä¿¡å·ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸å»ºè®®å¤ªé¢‘ç¹çš„å‘é€ä¿¡å·ï¼ŒQtå†…éƒ¨1ç§’é’Ÿå¤„ç†ä¿¡å·çš„ä¸ªæ•°ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œå¤ªé¢‘ç¹é«˜å¹¶å‘çš„ä¿¡å·ï¼Œå¾ˆå¯èƒ½ä¼šä¸¢å¤±æˆ–è€…åˆå¹¶ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚æ¥æ”¶åˆ°çš„å­¦ç”Ÿä¿¡æ¯è¡¨ï¼Œåº”è¯¥æ˜¯åœ¨è¯¥åº”ç­”æ•°æ®å†…çš„æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯è§£æå®Œä¸€æ¬¡æ€§å‘é€ï¼Œè€Œä¸æ˜¯è§£æä¸€æ¡å‘é€ä¸€æ¡ã€‚\n\nQtæä¾›äº†Nç§çª—ä½“å±æ€§æ¯”å¦‚æ— è¾¹æ¡†å±æ€§FramelessWindowHintã€ä¸åœ¨ä»»åŠ¡æ æ˜¾ç¤ºå±æ€§Toolç­‰ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹çª—å£çš„å±æ€§è¿›è¡ŒåŠ¨æ€è®¾ç½®ï¼Œæ¯”å¦‚å¢åŠ ä¸€ä¸ªå±æ€§æˆ–è€…ç§»é™¤ä¸€ä¸ªå±æ€§ï¼ŒQt5.9ä»¥å‰éœ€è¦æ‹¿åˆ°åŸæœ‰çš„çª—ä½“å±æ€§åšè¿ç®—ï¼Œåé¢å¯ä»¥ç”¨æ–°çš„æ–¹æ³•ã€‚\n12345678910//å¢åŠ ä¸€ä¸ªæ— è¾¹æ¡†å±æ€§setWindowFlags(windowFlags() | Qt::FramelessWindowHint);//ç§»é™¤æ— è¾¹æ¡†å±æ€§setWindowFlags(windowFlags() &amp; ~Qt::FramelessWindowHint);//ä¸‹é¢æ˜¯5.9ä»¥åæ–°å¢çš„æ–¹æ³•//å¢åŠ ä¸€ä¸ªæ— è¾¹æ¡†å±æ€§åˆ°çª—ä½“å±æ€§é“¾è¡¨setWindowFlag(Qt::FramelessWindowHint, true);//ä»çª—ä½“å±æ€§é“¾è¡¨ä¸­ç§»é™¤æ— è¾¹æ¡†å±æ€§setWindowFlag(Qt::FramelessWindowHint, false);\n\nå¦‚æœå¯¹çª—ä½“è®¾ç½®äº†å›ºå®šå°ºå¯¸ï¼Œçª—ä½“ä¼šå˜å¾—å¤§å°ä¸å¯æ‹‰ä¼¸ï¼Œå¦‚æœéœ€è¦é‡æ–°è¿˜åŸå¯æ‹‰ä¼¸ï¼Œå¿…é¡»é‡æ–°è®¾ç½®æœ€å°å°ºå¯¸å’Œæœ€å¤§å°ºå¯¸ã€‚\n12setMinimumSize(0, 0);setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n\nQtå†…ç½®äº†å¾ˆå¤šå…¨å±€çš„å¯¹è±¡å‚æ•°å¯ä»¥ç›´æ¥è·å–ï¼Œè¿™æ ·åœ¨ä½¿ç”¨çš„æ—¶å€™æ–¹ä¾¿çš„ä¸è¦ä¸è¦çš„ï¼Œæ¯”å¦‚åˆ¤æ–­å½“å‰é¼ æ ‡å·¦é”®è¿˜æ˜¯å³é”®å¯ä»¥ç›´æ¥ç”¨qApp-&gt;mouseButtons()ï¼Œå…¨å±€çš„é¼ æ ‡åæ ‡å¯ä»¥ç”¨QCursor::pos()ã€‚\n123456789101112131415161718192021222324//åœ¨é¼ æ ‡å³é”®çš„åœ°æ–¹å¼¹å‡ºèœå•ï¼Œå¦‚æœèœå•æ˜¯QMenuè€Œä¸æ˜¯QActionåˆ™åªèƒ½é€šè¿‡ä¸‹é¢çš„æ–¹å¼å¼¹å‡ºif (qApp-&gt;mouseButtons() == Qt::RightButton) &#123;    videoMenu-&gt;exec(QCursor::pos());&#125;//å…¨å±€å‰ªåˆ‡æ¿qApp-&gt;clipboard();//é¡¶å±‚æ§ä»¶å¯¹è±¡é›†åˆqApp-&gt;topLevelWidgets()//å½“å‰ç„¦ç‚¹æ‰€åœ¨æ§ä»¶qApp-&gt;focusWidget()//å½“å‰å¹³å°åç§°qApp-&gt;platformName()//è°ƒç”¨ç³»ç»Ÿèœ‚é¸£å™¨qApp-&gt;beep()//æ‰“å°å½“å‰Qtç‰ˆæœ¬ä¿¡æ¯qApp-&gt;aboutQt()//è®¾ç½®å…¨å±€çš„é¼ æ ‡æ ·å¼qApp-&gt;setOverrideCursor()//ä¸ä½¿ç”¨ç³»ç»Ÿçš„æ ‡å‡†é¢œè‰²å­—ä½“ç­‰QGuiApplication::setDesktopSettingsAware(bool on);QApplication app(argc, argv);//æ›´å¤šçš„å…¨å±€å¯¹è±¡å±æ€§ç­‰å¯ä»¥æŸ¥é˜… qguiapplication.h å¤´æ–‡ä»¶ï¼Œä½ ä¼šå‘ç°æ–°å¤§é™†ã€‚\n\nQtå¯¹åŒºåˆ†ä¸åŒçš„ç¼–è¯‘å™¨ä¹Ÿåšäº†éå¸¸ç»†è‡´çš„å¤„ç†ã€‚\n123456789101112131415161718192021222324#proæ–‡ä»¶å¯ä»¥è¿™æ ·åˆ¤æ–­msvc &#123;//è¦åšçš„å¤„ç†&#125;mingw &#123;//è¦åšçš„å¤„ç†&#125;//ä»£ç ä¸­å¯ä»¥è¿™æ ·åˆ¤æ–­#ifdef Q_CC_MINGW//mingwç¼–è¯‘å™¨#elif Q_CC_MSVC//msvcç¼–è¯‘å™¨#endif//åˆ¤æ–­ç¼–è¯‘å™¨å’Œç¼–è¯‘å™¨ç‰ˆæœ¬#if defined Q_CC_MSVC &amp;&amp; _MSC_VER &lt; 1300#if defined(Q_CC_GNU) &amp;&amp; (__GNUC__ &lt; 4)//ä»£ç ä¸­åˆ¤æ–­ARMå¹³å°#ifdef QT_ARCH_ARM//å¤šä¸ªæ¡ä»¶åˆ¤æ–­#if defined(QT_ARCH_ARM) || defined(QT_ARCH_WINDOWSCE)\n\næœ‰æ—¶å€™éœ€è¦æš‚æ—¶åœæ­¢æŸä¸ªæ§ä»¶å‘å°„ä¿¡å·ï¼ˆæ¯”å¦‚ä¸‹æ‹‰æ¡†comboboxæ·»åŠ æ•°æ®çš„æ—¶å€™ä¼šè§¦å‘å½“å‰å…ƒç´ æ”¹å˜ä¿¡å·ï¼‰ï¼Œæœ‰å¤šç§å¤„ç†ï¼Œæ¨èç”¨ blockSignals æ–¹æ³•ã€‚\n1234567891011121314//æ–¹æ³•1ï¼šå…ˆ disconnect æ‰ä¿¡å·ï¼Œå¤„ç†å¥½ä»¥åå† connect ä¿¡å·ï¼Œç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå¾ˆå‚»ï¼Œå¦‚æœä¿¡å·å¾ˆå¤šï¼Œæ¯ä¸ªå‹å·éƒ½è¦è¿™ä¹ˆæ¥ä¸€æ¬¡ã€‚disconnect(ui-&gt;cbox, SIGNAL(currentIndexChanged(int)), this, SLOT(on_cbox_currentIndexChanged(int)));for (int i = 0; i &lt;= 100; i++) &#123;    ui-&gt;cbox-&gt;addItem(QString::number(i));&#125;connect(ui-&gt;cbox, SIGNAL(currentIndexChanged(int)), this, SLOT(on_cbox_currentIndexChanged(int)));//æ–¹æ³•2ï¼šå…ˆè°ƒç”¨ blockSignals(true) é˜»å¡ä¿¡å·ï¼Œå¤„ç†å·ä»¥åå†è°ƒç”¨ blockSignals(false) æ¢å¤æ‰€æœ‰ä¿¡å·ã€‚//å¦‚æœéœ€è¦æŒ‡å®šæŸä¸ªä¿¡å·è¿›è¡Œæ–­å¼€é‚£å°±åªèƒ½ç”¨ disconnect æ¥å¤„ç†ã€‚ui-&gt;cbox-&gt;blockSignals(true);for (int i = 0; i &lt;= 100; i++) &#123;    ui-&gt;cbox-&gt;addItem(QString::number(i));&#125;ui-&gt;cbox-&gt;blockSignals(false);\n\né¡¹ç›®ä»£ç æ–‡ä»¶æ•°é‡å¦‚æœå¾ˆå¤šçš„è¯ï¼Œå…¨éƒ¨åŒ…å«åœ¨proé¡¹ç›®æ–‡ä»¶ä¸­ä¼šæ˜¾å¾—éå¸¸å‡Œä¹±ï¼Œç”šè‡³æ»šåŠ¨æ¡éƒ½è¦æ‹‰å¥½ä¹…ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¤„ç†çš„æ›´å¥½ï¼Œæ¨èæ–¹æ³•2ã€‚\n123456789//æ–¹æ³•1ï¼šproæ–‡ä»¶ç›´æ¥å…¨éƒ¨å¼•å…¥ï¼Œè€Œä¸æ˜¯æ¯ä¸ªéƒ½æ·»åŠ ä¸€æ¬¡ï¼Œçœå¿ƒçœåŠ›ã€‚HEADERS += *.hSOURCES += *.cpp//æ–¹æ³•2ï¼šåˆ†æ¨¡å—æ–‡ä»¶å¤¹å­˜æ”¾ï¼Œä¸åŒæ¨¡å—ç”¨priåŒ…å«ä»£ç æ–‡ä»¶ï¼Œæ¯”å¦‚ç•Œé¢å¯ä»¥æ”¾åœ¨uiæ–‡ä»¶å¤¹ï¼Œä¸‹é¢æä¸ªui.priï¼Œç„¶åproé¡¹ç›®æ–‡ä»¶åªéœ€è¦å¼•å…¥è¿™ä¸ªpriæ–‡ä»¶å³å¯ã€‚include($$PWD/ui/ui.pri)//è¿˜å¯ä»¥åŠ ä¸Šä¸€å¥åŒ…å«è·¯å¾„è¿™æ ·å¯ä»¥çœå»åœ¨ä½¿ç”¨ä»£ç çš„æ—¶å€™ä¸ç”¨å†™æ–‡ä»¶å¤¹INCLUDEPATH += $$PWD/ui//åŠ ä¸Šä¸Šé¢è¿™è¡Œï¼Œåœ¨ä½¿ç”¨å¤´æ–‡ä»¶çš„æ—¶å€™å¯ä»¥ç›´æ¥ include &quot;form.h&quot;ï¼Œæ²¡æœ‰åŠ åˆ™éœ€è¦ include &quot;ui/form.h&quot;ã€‚\n\nåœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œæ— è®ºæ˜¯tcpå®¢æˆ·ç«¯è¿˜æ˜¯udpå®¢æˆ·ç«¯ï¼Œå…¶å®éƒ½æ˜¯å¯ä»¥ç»‘å®šç½‘å¡IPå’Œç«¯å£çš„ï¼Œå¾ˆå¤šäººåªçŸ¥é“æœåŠ¡ç«¯å¯ä»¥æŒ‡å®šç½‘å¡ç›‘å¬ç«¯å£ã€‚å®¢æˆ·ç«¯å¦‚æœæ²¡æœ‰ç»‘å®šé€šä¿¡ç«¯å£åˆ™ç”±å®¢æˆ·ç«¯æ‰€åœ¨çš„æ“ä½œç³»ç»Ÿéšæœºé€’å¢åˆ†é…çš„ï¼Œè¿™é‡Œä¸ºå•¥è¿™ä¹ˆå¼ºè°ƒï¼Œå› ä¸ºæ— æ•°äººï¼Œç”šè‡³ä¸ä¹ä¸€äº›å¤šå¹´ç»éªŒçš„æ–°æ—¶ä»£å†œæ°‘å·¥ï¼Œä»¥ä¸ºå®¢æˆ·ç«¯çš„ç«¯å£æ˜¯æœåŠ¡ç«¯åˆ†é…çš„ï¼Œå› ä¸ºä»–ä»¬çœ‹åˆ°åœ¨æœåŠ¡ç«¯å»ºç«‹è¿æ¥åå¯ä»¥æ‰“å°å‡ºä¸åŒçš„ç«¯å£å·ã€‚ç½‘ç»œé€šä¿¡çš„åŒæ–¹è‡ªå·±å†³å®šè‡ªå·±è¦ç”¨ä»€ä¹ˆç«¯å£ï¼ŒæœåŠ¡å™¨ç«¯åªèƒ½å†³å®šè‡ªå·±ç›‘å¬çš„æ˜¯å“ªä¸ªç«¯å£ï¼Œä¸èƒ½å†³å®šå®¢æˆ·ç«¯çš„ç«¯å£ï¼ŒåŒç†å®¢æˆ·ç«¯ä¹Ÿåªèƒ½å†³å®šè‡ªå·±çš„ç«¯å£ã€‚ç«¯å£éšæœºåˆ†é…ä¸€èˆ¬æ˜¯æŒ‰ç…§é¡ºåºé€’å¢çš„ï¼Œæ¯”å¦‚å…ˆæ˜¯45110ç«¯å£ï¼Œè¿æ¥é‡æ–°å»ºç«‹å°±ç”¨45111ç«¯å£ï¼Œåªè¦ç«¯å£æ²¡è¢«å ç”¨å°±è¿™æ ·é€’å¢ä¸‹å»ï¼Œæ‰€ä»¥å¾ˆå¤šäººä¼šé—®æ˜¯å¦å¯ä»¥å¤ç”¨ä¸€äº›ç«¯å£ï¼Œä¸ç„¶ç«¯å£ä¸€ç›´è¿™æ ·é¢‘ç¹çš„åˆ†é…ä¸‹å»ä¸å¦¥ï¼Œç”šè‡³æœ‰äº›ç‰¹å®šçš„åœºæ™¯å’Œéœ€æ±‚ä¹Ÿæ˜¯ä¼šè¦æ±‚å®¢æˆ·ç«¯ç»‘å®šç½‘å¡å’Œç«¯å£æ¥å’ŒæœåŠ¡å™¨é€šä¿¡çš„ã€‚\n123456789101112131415161718192021222324252627282930//tcpå®¢æˆ·ç«¯QTcpSocket *socket = new QTcpSocket(this);//æ–­å¼€æ‰€æœ‰è¿æ¥å’Œæ“ä½œsocket-&gt;abort();//ç»‘å®šç½‘å¡å’Œç«¯å£socket-&gt;bind(QHostAddress(&quot;192.168.1.2&quot;), 6005);//è¿æ¥æœåŠ¡å™¨socket-&gt;connectToHost(&quot;192.168.1.3&quot;, 6000);//æ‰“å°é€šä¿¡ç”¨çš„æœ¬åœ°ç»‘å®šåœ°å€å’Œç«¯å£qDebug() &lt;&lt; socket-&gt;localAddress() &lt;&lt; socket-&gt;localPort();//æ‰“å°é€šä¿¡æœåŠ¡å™¨å¯¹æ–¹çš„åœ°å€å’Œç«¯å£qDebug() &lt;&lt; socket-&gt;peerAddress() &lt;&lt; socket-&gt;peerPort() &lt;&lt; socket-&gt;peerName();//udpå®¢æˆ·ç«¯QUdpSocket *socket = new QUdpSocket(this);//ç»‘å®šç½‘å¡å’Œç«¯å£,æ²¡æœ‰ç»‘å®šè¿‡æ‰éœ€è¦ç»‘å®š//é‡‡ç”¨ç«¯å£æ˜¯å¦ä¸€æ ·æ¥åˆ¤æ–­æ˜¯ä¸ºäº†æ–¹ä¾¿å¯ä»¥ç›´æ¥åŠ¨æ€ç»‘å®šåˆ‡æ¢ç«¯å£if (socket-&gt;localPort() != 6005) &#123;    socket-&gt;abort();    socket-&gt;bind(QHostAddress(&quot;192.168.1.2&quot;), 6005);&#125;//æŒ‡å®šåœ°å€å’Œç«¯å£å‘é€æ•°æ®socket-&gt;writeDatagram(buffer, QHostAddress(&quot;192.168.1.3&quot;), 6000);//ä¸Šé¢æ˜¯Qt5å¯ä»¥ä½¿ç”¨bindï¼ŒQt4ä¸­çš„QTcpSocketçš„å¯¹åº”æ¥å£æ˜¯protectedçš„æ²¡æ³•ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦ç»§æ‰¿ç±»é‡æ–°å®ç°æŠŠæ¥å£æ”¾å‡ºæ¥ã€‚//Qt4ä¸­çš„QUdpSocketæœ‰bindå‡½æ•°æ˜¯å¼€æ”¾çš„ï¼Œå¥‡æ€ªäº†ï¼Œä¸ºä½•Qt4ä¸­ç‹¬ç‹¬QTcpSocketä¸å¼€æ”¾ã€‚TcpSocket *socket = new TcpSocket(this);socket-&gt;setLocalAddress(QHostAddress(&quot;192.168.1.2&quot;));socket-&gt;setLocalPort(6005);\n\nå…³äºç½‘ç»œé€šä¿¡ï¼Œtcpå’Œudpæ˜¯ä¸¤ç§ä¸åŒçš„åº•å±‚çš„ç½‘ç»œé€šä¿¡åè®®ï¼Œä¸¤è€…ç›‘å¬å’Œé€šä¿¡çš„ç«¯å£äº’ä¸ç›¸å¹²çš„ï¼Œä¸åŒçš„åè®®æˆ–è€…ä¸åŒçš„ç½‘å¡IPåœ°å€å¯ä»¥ç”¨ç›¸åŒçš„ç«¯å£ã€‚ä¹‹å‰æœ‰ä¸ªäººè¯´ä»–çš„ç”µè„‘å±…ç„¶å¯ä»¥ç›‘å¬ä¸€æ ·çš„ç«¯å£è¿›è¡Œé€šä¿¡ï¼Œé¢ è¦†äº†ä»–ä»¥å‰çš„è®¤çŸ¥ï¼Œä¹¦ä¸Šè¯´çš„æ˜æ˜æ˜¯ä¸å¯ä»¥ç›¸åŒç«¯å£çš„ï¼Œåé¢è¿œç¨‹ä¸€çœ‹åŸæ¥é€‰æ‹©çš„ä¸åŒçš„ç½‘å¡IPåœ°å€ï¼Œå½“ç„¶å¯ä»¥çš„å’¯ã€‚\n\n\n\ntcpå¯¹ç½‘å¡1ç›‘å¬äº†ç«¯å£6000ï¼Œè¿˜å¯ä»¥å¯¹ç½‘å¡2ç›‘å¬ç«¯å£6000ã€‚\ntcpå¯¹ç½‘å¡1ç›‘å¬äº†ç«¯å£6000ï¼Œudpå¯¹ç½‘å¡1è¿˜å¯ä»¥ç»§ç»­ç›‘å¬ç«¯å£6000ã€‚\ntcpå¯¹ç½‘å¡1ç›‘å¬äº†ç«¯å£6000ï¼Œåœ¨ç½‘å¡1ä¸Šå…¶ä»–tcpåªèƒ½ç›‘å¬6000ä»¥å¤–çš„ç«¯å£ã€‚\nudpåè®®ä¹Ÿæ˜¯ä¸Šé¢çš„é€»è¾‘ã€‚\n\n\nå¼€æºçš„å›¾è¡¨æ§ä»¶QCustomPlotå¾ˆç»å…¸ï¼Œä½œè€…è‡³å°‘æ˜¯å…«æ˜Ÿæ–—åœ£çº§åˆ«ï¼Œåœ¨æ›²çº¿æ•°æ®å±•ç¤ºè¿™å—æ€§èƒ½å½ªæ‚ï¼Œæ€»ç»“äº†ä¸€äº›å®¹æ˜“å¿½ç•¥çš„ç»éªŒè¦ç‚¹ã€‚\n\n\nå¯ä»¥å°†XYè½´å¯¹è°ƒï¼Œç„¶åå½¢æˆæ¨ªå‘çš„æ•ˆæœï¼Œæ— è®ºæ˜¯æ›²çº¿å›¾è¿˜æ˜¯æŸ±çŠ¶å›¾ï¼Œåˆ†ç»„å›¾ã€å †ç§¯å›¾ç­‰ï¼Œéƒ½æ”¯æŒè¿™ä¸ªç‰¹æ€§ã€‚\nä¸éœ€è¦çš„æç¤ºå›¾ä¾‹å¯ä»¥è°ƒç”¨ legend-&gt;removeItem è¿›è¡Œç§»é™¤ã€‚\nä¸¤æ¡æ›²çº¿å¯ä»¥è°ƒç”¨ setChannelFillGraph è®¾ç½®åˆå¹¶ä¸ºä¸€ä¸ªé¢ç§¯åŒºåŸŸã€‚\nå¯ä»¥å…³é—­æŠ—é”¯é½¿ setAntialiased åŠ å¿«ç»˜åˆ¶é€Ÿåº¦ã€‚\nå¯ä»¥è®¾ç½®ä¸åŒçš„çº¿æ¡æ ·å¼ï¼ˆsetLineStyleï¼‰ã€æ•°æ®æ ·å¼ï¼ˆsetScatterStyleï¼‰ã€‚\nåæ ‡è½´çš„ç®­å¤´æ ·å¼å¯æ›´æ¢ setUpperEndingã€‚\nå¯ä»¥ç”¨ QCPBarsGroup å®ç°æŸ±çŠ¶åˆ†ç»„å›¾ï¼Œè¿™ä¸ªç±»åœ¨å®˜æ–¹demoä¸­æ²¡æœ‰ï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“å¿½ç•¥ã€‚\nV2.0å¼€å§‹æ”¯æŒæ•°æ®æ’åºè®¾ç½®ï¼Œé»˜è®¤æ˜¯äº¤ç»™QCustomPlotæ’åºï¼Œä¹Ÿå¯ä»¥è®¾ç½®setDataç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºtrueè¡¨ç¤ºå·²ç»æ’åºè¿‡ï¼Œè¿™æ ·å¯ä»¥ç»˜åˆ¶å¾€å›èµ°çš„æ›²çº¿ã€‚\né¢‘ç¹ç»˜åˆ¶æ•°æ®å¯ä»¥è®¾ç½®æ’é˜Ÿç»˜åˆ¶å‚æ•° replot(QCustomPlot::rpQueuedReplot)ï¼Œå¯ä»¥é¿å…é‡å¤çš„replotå’Œæé«˜æ€§èƒ½ã€‚å¦‚æœä¸å¼€å¯å¾ˆå¯èƒ½ç»˜åˆ¶å‡ºé”™ã€‚\nå¯ä»¥å°†å¤šä¸ªplotå›¾è¡¨åˆå¹¶åˆ°ä¸€ä¸ªQCustomPlotæ§ä»¶ä¸­ï¼Œæå¤§æå‡ç»˜åˆ¶æ•ˆç‡ï¼Œè€Œä¸æ˜¯å®ä¾‹åŒ–å¤šä¸ªQCustomPlotæ§ä»¶ã€‚åˆå¹¶åä¹Ÿæ˜¯åˆ†å¼€å¯¹åº”ä¸åŒçš„åæ ‡è½´ä¸åŒä½ç½®æ’åˆ—æ˜¾ç¤ºï¼Œå’Œå¤šä¸ªQCustomPlotæ§ä»¶æ•ˆæœä¸€æ ·å¹¶ä¸”æå¤§æå‡æ€§èƒ½ã€‚\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394//å¯¹è°ƒXYè½´ï¼Œåœ¨æœ€å‰é¢è®¾ç½®QCPAxis *yAxis = customPlot-&gt;yAxis;QCPAxis *xAxis = customPlot-&gt;xAxis;customPlot-&gt;xAxis = yAxis;customPlot-&gt;yAxis = xAxis;//ç§»é™¤å›¾ä¾‹customPlot-&gt;legend-&gt;removeItem(1);//åˆå¹¶ä¸¤ä¸ªæ›²çº¿ç”»å¸ƒå½¢æˆå°é—­åŒºåŸŸcustomPlot-&gt;graph(0)-&gt;setChannelFillGraph(customPlot-&gt;graph(1));//å…³é—­æŠ—é”¯é½¿ä»¥åŠè®¾ç½®æ‹–åŠ¨çš„æ—¶å€™ä¸å¯ç”¨æŠ—é”¯é½¿customPlot-&gt;setNoAntialiasingOnDrag(true);customPlot-&gt;graph()-&gt;setAntialiased(false);customPlot-&gt;graph()-&gt;setAntialiasedFill(false);customPlot-&gt;graph()-&gt;setAntialiasedScatters(false);//è®¾ç½®å¿«é€Ÿç»˜åˆ¶å¯ä»¥å¤§å¤§åŠ å¿«ç”»ç¬”å®½åº¦å¤§äº1çš„çº¿æ¡customPlot-&gt;setPlottingHint(QCP::phFastPolylines);//å¤šç§è®¾ç½®æ•°æ®çš„æ–¹æ³•customPlot-&gt;graph(0)-&gt;setData();customPlot-&gt;graph(0)-&gt;data()-&gt;set();//è®¾ç½®ä¸åŒçš„çº¿æ¡æ ·å¼ã€æ•°æ®æ ·å¼customPlot-&gt;graph()-&gt;setLineStyle(QCPGraph::lsLine);customPlot-&gt;graph()-&gt;setScatterStyle(QCPScatterStyle::ssDot);customPlot-&gt;graph()-&gt;setScatterStyle(QCPScatterStyle(shapes.at(i), 10));//è¿˜å¯ä»¥è®¾ç½®ä¸ºå›¾ç‰‡æˆ–è€…è‡ªå®šä¹‰å½¢çŠ¶customPlot-&gt;graph()-&gt;setScatterStyle(QCPScatterStyle(QPixmap(&quot;./sun.png&quot;)));QPainterPath customScatterPath;for (int i = 0; i &lt; 3; ++i) &#123;    customScatterPath.cubicTo(qCos(2 * M_PI * i / 3.0) * 9, qSin(2 * M_PI * i / 3.0) * 9, qCos(2 * M_PI * (i + 0.9) / 3.0) * 9, qSin(2 * M_PI * (i + 0.9) / 3.0) * 9, 0, 0);&#125;customPlot-&gt;graph()-&gt;setScatterStyle(QCPScatterStyle(customScatterPath, QPen(Qt::black, 0), QColor(40, 70, 255, 50), 10));//æ›´æ¢åæ ‡è½´çš„ç®­å¤´æ ·å¼customPlot-&gt;xAxis-&gt;setUpperEnding(QCPLineEnding::esSpikeArrow);customPlot-&gt;yAxis-&gt;setUpperEnding(QCPLineEnding::esSpikeArrow);//è®¾ç½®èƒŒæ™¯å›¾ç‰‡customPlot-&gt;axisRect()-&gt;setBackground(QPixmap(&quot;./solarpanels.jpg&quot;));//ç”»å¸ƒä¹Ÿå¯ä»¥è®¾ç½®èƒŒæ™¯å›¾ç‰‡customPlot-&gt;graph(0)-&gt;setBrush(QBrush(QPixmap(&quot;./balboa.jpg&quot;)));//æ•´ä½“å¯ä»¥è®¾ç½®å¡«å……é¢œè‰²æˆ–è€…å›¾ç‰‡customPlot-&gt;setBackground(QBrush(gradient));//è®¾ç½®é›¶ç‚¹çº¿æ¡é¢œè‰²customPlot-&gt;xAxis-&gt;grid()-&gt;setZeroLinePen(Qt::NoPen);//æ§åˆ¶æ˜¯å¦é¼ æ ‡æ»šè½®ç¼©æ”¾æ‹–åŠ¨ç­‰äº¤äº’å½¢å¼customPlot-&gt;setInteractions(QCP::iRangeDrag | QCP::iRangeZoom | QCP::iSelectPlottables);//æŸ±çŠ¶åˆ†ç»„å›¾QCPBarsGroup *group = new QCPBarsGroup(customPlot);QList&lt;QCPBars*&gt; bars;bars &lt;&lt; fossil &lt;&lt; nuclear &lt;&lt; regen;foreach (QCPBars *bar, bars) &#123;    //è®¾ç½®æŸ±çŠ¶å›¾çš„å®½åº¦å¤§å°    bar-&gt;setWidth(bar-&gt;width() / bars.size());    group-&gt;append(bar);&#125;//è®¾ç½®åˆ†ç»„ä¹‹é—´çš„é—´éš”group-&gt;setSpacing(2);//ç»˜åˆ¶å¾€å›èµ°çš„æ›²çº¿QVector&lt;double&gt; keys, values;keys &lt;&lt; 0 &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3 &lt;&lt; 4 &lt;&lt; 5 &lt;&lt; 4 &lt;&lt; 3;values &lt;&lt; 5 &lt;&lt; 4 &lt;&lt; 6 &lt;&lt; 7 &lt;&lt; 7 &lt;&lt; 6 &lt;&lt; 5 &lt;&lt; 4;customPlot-&gt;graph(0)-&gt;setData(keys, values, true);//é¢‘ç¹ç»˜åˆ¶æ•°æ®å¼€å¯æ’é˜Ÿç»˜åˆ¶å¯ä»¥æé«˜æ€§èƒ½customPlot-&gt;replot(QCustomPlot::rpQueuedReplot);QCPAxis *axis = customPlot-&gt;xAxis;double lower = axis-&gt;range().lower;double upper = axis-&gt;range().upper;double origin = (upper - lower) / 2;//è®¾ç½®åˆ»åº¦çº¿æŒ‰ç…§è®¾ç½®ä¼˜å…ˆè€Œä¸æ˜¯å¯è¯»æ€§ä¼˜å…ˆaxis-&gt;ticker()-&gt;setTickStepStrategy(QCPAxisTicker::tssMeetTickCount);//è®¾ç½®åŸç‚¹å€¼ä¸ºèŒƒå›´å€¼çš„ä¸­å¿ƒç‚¹axis-&gt;ticker()-&gt;setTickOrigin(origin);//ä¸‹é¢æ¼”ç¤ºå¦‚ä½•åœ¨ä¸€ä¸ªæ§ä»¶ä¸­å¤šä¸ªä¸åŒçš„æ›²çº¿å¯¹åº”ä¸åŒåæ ‡è½´//æ‹¿åˆ°å›¾è¡¨å¸ƒå±€å¯¹è±¡QCPLayoutGrid *layout = customPlot-&gt;plotLayout();//å®ä¾‹åŒ–åæ ‡è½´åŒºåŸŸQCPAxisRect *axisRect = new QCPAxisRect(customPlot);//æ‹¿åˆ°XYåæ ‡è½´å¯¹è±¡QCPAxis *xAxis = axisRect-&gt;axis(QCPAxis::atBottom);QCPAxis *yAxis = axisRect-&gt;axis(QCPAxis::atLeft);//å°†åæ ‡è½´æŒ‡å®šè¡Œåˆ—ä½ç½®æ·»åŠ åˆ°å¸ƒå±€ä¸­layout-&gt;addElement(i, 0, axisRect);//æ·»åŠ å¯¹åº”çš„ç”»å¸ƒåˆ°æŒ‡å®šåæ ‡è½´QCPGraph *graph = customPlot-&gt;addGraph(xAxis, yAxis);\n\n18ï¼š171-180\nåœ¨Qtç¼–ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°ç¼–ç çš„é—®é¢˜ï¼Œç”±äºè·¨å¹³å°çš„è€ƒè™‘å…¼å®¹å„ç§ç³»ç»Ÿï¼Œè€Œwindowsç³»ç»Ÿé»˜è®¤æ˜¯gbkæˆ–è€…gb2312ç¼–ç ï¼Œå½“ç„¶åæœŸå¯èƒ½msvcç¼–è¯‘å™¨éƒ½æ”¯æŒutf8ç¼–ç ï¼Œæ‰€ä»¥åœ¨éƒ¨åˆ†ç¨‹åºä¸­ä¼ å…¥ä¸­æ–‡ç›®å½•æ–‡ä»¶åç§°çš„æ—¶å€™ä¼šå‘ç°å¤±è´¥ï¼Œå› ä¸ºå¯èƒ½å¯¹åº”çš„æ¥å£ç”¨äº†æ—©æœŸçš„fopenå‡½æ•°è€Œä¸æ˜¯fopen_så‡½æ•°ï¼Œæ¯”å¦‚fmodä¸­ä¹Ÿæ˜¯è¿™ä¸ªæƒ…å†µã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦è½¬ç å¤„ç†ã€‚\n12345678910111213141516171819202122232425QString fileName = &quot;c:/æµ‹è¯•ç›®å½•/1.txt&quot;;//å¦‚æœåº”ç”¨ç¨‹åºmainå‡½æ•°ä¸­æ²¡æœ‰è®¾ç½®ç¼–ç åˆ™é»˜è®¤é‡‡ç”¨ç³»ç»Ÿçš„ç¼–ç ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡toLocal8Bitè½¬æˆæ­£ç¡®çš„æ•°æ®const char *name = fileName.toLocal8Bit().constData();//å¦‚æœè®¾ç½®è¿‡äº†ä¸‹é¢ä¸¤å¥åˆ™éœ€è¦ä¸»åŠ¨è½¬ç QTextCodec *codec = QTextCodec::codecForName(&quot;utf-8&quot;);QTextCodec::setCodecForLocale(codec);QTextCodec *code = QTextCodec::codecForName(&quot;gbk&quot;);const char *name = code-&gt;fromUnicode(fileName).constData();//æ¨èæ–¹å¼2ä»¥é˜²ä¸‡ä¸€ä¿è¯ç»å¯¹çš„æ­£ç¡®ï¼Œå“ªæ€•æ˜¯è®¾ç½®è¿‡ä¸»ç¨‹åºçš„ç¼–ç //åˆ‡è®°ä¸€æ—¦è®¾ç½®è¿‡QTextCodec::setCodecForLocaleä¼šå½±å“toLocal8Bit//æœ‰æ—¶å€™å¯èƒ½è¿˜æœ‰ä¸‹é¢è¿™ç§æƒ…å†µ#ifdef Q_OS_WIN#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1400)    QTextCodec *code = QTextCodec::codecForName(&quot;utf-8&quot;);#else    QTextCodec *code = QTextCodec::codecForName(&quot;gbk&quot;);#endif    const char *name = code-&gt;fromUnicode(fileName).constData();#else    const char *name = fileName.toUtf8().constData();#endif\n\nåœ¨æŸ¥é˜…å’Œå­¦ä¹ Qtæºç çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†ä¸€äº›è¶‹åŠ¿å’Œæ”¹å˜ã€‚\n\n\n\næ•°æ®ç±»å‹è¿™å—å°½é‡ç”¨Qtå†…éƒ¨çš„æ•°æ®ç±»å‹ï¼Œå“ªæ€•æ˜¯é‡å®šä¹‰è¿‡çš„æ¯”å¦‚quint8å…¶å®unsigned charï¼Œqrealå°±æ˜¯doubleï¼Œä»¥å‰ç¿»çœ‹æºç çš„æ—¶å€™å¯èƒ½è¿˜æœ‰äº›æ˜¯doubleï¼Œç°åœ¨æ…¢æ…¢æ”¹æˆäº†qrealã€‚\nå¾ªç¯ç»“æ„ç”¨ for(;;) æ›¿ä»£ while(1)ï¼Œå› ä¸ºè½¬æˆæ±‡ç¼–æŒ‡ä»¤å for(;;) åªæœ‰ä¸€æ¡æŒ‡ä»¤è€Œ while(1) ç¡®æœ‰4æ¡ï¼ŒæŒ‡ä»¤å°‘ä¸å ç”¨å¯„å­˜å™¨è€Œä¸”ä¸ç”¨è·³è½¬ï¼Œç†è®ºä¸Šé€Ÿåº¦è¦æ›´å¿«ã€‚\nå…¶å®Qtä¸­å°±é‡å®šä¹‰äº† forever å…³é”®å­—è¡¨ç¤º for(;;) ï¼Œæˆ‘çš„ä¹–ä¹–ï¼Œæƒ³çš„çœŸå‘¨åˆ°ã€‚\nè‡ªåŠ¨c++11ä»¥åŠåç»­çš„æ ‡å‡†éƒ½æ”¯æŒautoä¸‡èƒ½æ•°æ®ç±»å‹ï¼Œå‘ç°Qtçš„æºç ä¸­ä¹Ÿæ…¢æ…¢çš„æ”¹æˆäº†autoï¼Œè¿™æ ·åŠ å¿«äº†ç¼–å†™ä»£ç çš„æ•ˆç‡ï¼Œä¸ç”¨è‡ªå·±å»æŒ‡å®šæ•°æ®ç±»å‹è€Œæ˜¯è®©ç¼–è¯‘å™¨è‡ªå·±æ¨å¯¼æ•°æ®ç±»å‹ã€‚è€Œä¸”å…¶å®ä¹Ÿä¸å½±å“ç¼–è¯‘å™¨ç¼–è¯‘çš„é€Ÿåº¦ï¼Œå› ä¸ºæ— è®ºæŒ‡å®šå’Œæ²¡æœ‰æŒ‡å®šæ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨éƒ½è¦æ¨å¯¼å³ä¾§çš„æ•°æ®ç±»å‹è¿›è¡Œåˆ¤æ–­ã€‚ä¸è¿‡æœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å½±å“äº†é˜…è¯»ä»£ç çš„æˆæœ¬ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦è‡ªå·±å»ç†è§£æ¨å¯¼ã€‚\n\n\n\nQtä¸­è®¾ç½®æˆ–è€…æ‰“å¼€åŠ è½½æœ¬åœ°æ–‡ä»¶éœ€è¦ç”¨åˆ°QUrlç±»ï¼Œæœ¬åœ°æ–‡ä»¶å»ºè®®åŠ ä¸Š file:&#x2F;&#x2F;&#x2F; å‰ç¼€ã€‚\n123456QString url = &quot;file:///c:/1.html&quot;;//æµè§ˆå™¨æ§ä»¶æ‰“å¼€æœ¬åœ°ç½‘é¡µæ–‡ä»¶webView-&gt;setUrl(QUrl(url));//æ‰“å¼€æœ¬åœ°ç½‘é¡µæ–‡ä»¶ï¼Œä¸‹é¢ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥QDesktopServices::openUrl(QUrl::fromLocalFile(url));QDesktopServices::openUrl(QUrl(url, QUrl::TolerantMode));\n\nåœ¨ç½‘ç»œè¯·æ±‚ä¸­ç»å¸¸æ¶‰åŠåˆ°è¶…æ—¶æ—¶é—´çš„é—®é¢˜ï¼Œå› ä¸ºé»˜è®¤æ˜¯30ç§’é’Ÿï¼Œä¸€æ—¦é‡åˆ°ç½‘ç»œæ•…éšœçš„æ—¶å€™è¦ç­‰å¥½ä¹…æ‰èƒ½ååº”è¿‡æ¥ï¼Œæ‰€ä»¥éœ€è¦ä¸»åŠ¨è®¾ç½®ä¸‹è¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡äº†å°±ç›´æ¥ä¸­æ–­ç»“æŸè¯·æ±‚ã€‚ä»Qt5.15å¼€å§‹å†…ç½®äº†setTransferTimeoutæ¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œéå¸¸å¥½ç”¨ã€‚\n1234567891011121314151617181920212223242526//å±€éƒ¨çš„äº‹ä»¶å¾ªç¯,ä¸å¡ä¸»ç•Œé¢QEventLoop eventLoop;//è®¾ç½®è¶…æ—¶ 5.15å¼€å§‹è‡ªå¸¦äº†è¶…æ—¶æ—¶é—´å‡½æ•° é»˜è®¤30ç§’#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,15,0))manager-&gt;setTransferTimeout(timeout);#elseQTimer timer;connect(&amp;timer, SIGNAL(timeout()), &amp;eventLoop, SLOT(quit()));timer.setSingleShot(true);timer.start(timeout);#endifQNetworkReply *reply = manager-&gt;get(QNetworkRequest(QUrl(url)));connect(reply, SIGNAL(finished()), &amp;eventLoop, SLOT(quit()));eventLoop.exec();if (reply-&gt;bytesAvailable() &gt; 0 &amp;&amp; reply-&gt;error() == QNetworkReply::NoError) &#123;    //è¯»å–æ‰€æœ‰æ•°æ®ä¿å­˜æˆæ–‡ä»¶    QByteArray data = reply-&gt;readAll();    QFile file(dirName + fileName);    if (file.open(QFile::WriteOnly | QFile::Truncate)) &#123;        file.write(data);        file.close();    &#125;&#125;\n\nQtä¸­åŸºæœ¬ä¸Šæœ‰ä¸‰å¤§ç±»å‹çš„é¡¹ç›®ï¼Œæ§åˆ¶å°é¡¹ç›®å¯¹åº”QCoreApplicationã€ä¼ ç»ŸQWidgetç•Œé¢ç¨‹åºå¯¹åº”QApplicationã€quick&#x2F;qmlé¡¹ç›®ç¨‹åºå¯¹åº”QGuiApplicationã€‚æœ‰å¾ˆå¤šå±æ€§çš„å¼€å¯éœ€è¦åœ¨mainå‡½æ•°çš„æœ€å‰é¢æ‰§è¡Œæ‰æœ‰æ•ˆæœï¼Œæ¯”å¦‚å¼€å¯é«˜åˆ†å±æ”¯æŒã€è®¾ç½®openglæ¨¡å¼ç­‰ã€‚ä¸åŒç±»å‹çš„é¡¹ç›®éœ€è¦å¯¹åº”çš„QApplicationã€‚\n1234567891011121314151617181920212223242526272829303132333435//å¦‚æœæ˜¯æ§åˆ¶å°ç¨‹åºåˆ™ä¸‹é¢çš„QApplicationæ¢æˆQCoreApplication//å¦‚æœæ˜¯quick/qmlç¨‹åºåˆ™ä¸‹é¢çš„QApplicationæ¢æˆQGuiApplicationint main(int argc, char *argv[])&#123;    //å¯ä»¥ç”¨ä¸‹é¢è¿™è¡Œæµ‹è¯•Qtè‡ªå¸¦çš„è¾“å…¥æ³• qtvirtualkeyboard    qputenv(&quot;QT_IM_MODULE&quot;, QByteArray(&quot;qtvirtualkeyboard&quot;));        //è®¾ç½®ä¸åº”ç”¨æ“ä½œç³»ç»Ÿè®¾ç½®æ¯”å¦‚å­—ä½“    QApplication::setDesktopSettingsAware(false);#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    //è®¾ç½®é«˜åˆ†å±ç¼©æ”¾èˆå…¥ç­–ç•¥    QApplication::setHighDpiScaleFactorRoundingPolicy(Qt::HighDpiScaleFactorRoundingPolicy::Floor);#endif#if (QT_VERSION &gt; QT_VERSION_CHECK(5,6,0))    //è®¾ç½®å¯ç”¨é«˜åˆ†å±ç¼©æ”¾æ”¯æŒ    //è¦æ³¨æ„å¼€å¯åè®¡ç®—åˆ°çš„æ§ä»¶æˆ–ç•Œé¢å®½åº¦é«˜åº¦å¯èƒ½éƒ½ä¸å¯¹,å…¨éƒ¨éœ€è¦ç”¨ç¼©æ”¾æ¯”ä¾‹è¿ç®—ä¸‹    QApplication::setAttribute(Qt::AA_EnableHighDpiScaling);    //è®¾ç½®å¯ç”¨é«˜åˆ†å±å›¾ç‰‡æ”¯æŒ    QApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);#endif#if (QT_VERSION &gt; QT_VERSION_CHECK(5,4,0))    //è®¾ç½®openglæ¨¡å¼ AA_UseDesktopOpenGL(é»˜è®¤) AA_UseOpenGLES AA_UseSoftwareOpenGL    //åœ¨ä¸€äº›å¾ˆæ—§çš„è®¾å¤‡ä¸Šæˆ–è€…å¯¹openglæ”¯æŒå¾ˆä½çš„è®¾å¤‡ä¸Šéœ€è¦ä½¿ç”¨AA_UseOpenGLESè¡¨ç¤ºç¦ç”¨ç¡¬ä»¶åŠ é€Ÿ    //å¦‚æœå¼€å¯çš„æ˜¯AA_UseOpenGLESåˆ™æ— æ³•ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿæ¯”å¦‚ffmpegçš„dxva2    //QApplication::setAttribute(Qt::AA_UseOpenGLES);    //è®¾ç½®openglå…±äº«ä¸Šä¸‹æ–‡    QApplication::setAttribute(Qt::AA_ShareOpenGLContexts);#endif    QApplication a(argc, argv);    QWidget w;    w.show();    return a.exec();&#125;\n\nQCameraä¸­è·å–è®¾å¤‡çš„é…ç½®å‚æ•°æ¯”å¦‚æ”¯æŒçš„åˆ†è¾¨ç‡é›†åˆç­‰ï¼Œéœ€è¦å…ˆè°ƒç”¨loadåæ‰èƒ½æ­£ç¡®è·å–ï¼Œæˆ–è€…å…³è”stateChangedä¿¡å·ä¸­åˆ¤æ–­çŠ¶æ€æ˜¯å¦æ˜¯ActiveStateï¼Œç„¶åå†è¯»å–ã€‚\n1234567891011121314151617181920212223242526272829303132333435//æ–¹æ³•1ï¼šè°ƒç”¨loadåè·å–camera = new QCamera(this);//å…ˆéœ€è¦è½½å…¥æ‰èƒ½è·å–åˆ°å¯¹åº”å‚æ•°camera-&gt;load();//è¾“å‡ºå½“å‰è®¾å¤‡æ”¯æŒçš„åˆ†è¾¨ç‡QList&lt;QSize&gt; sizes = camera-&gt;supportedViewfinderResolutions();emit resolutions(sizes);//é‡æ–°è®¾ç½®åˆ†è¾¨ç‡QCameraViewfinderSettings set;set.setResolution(cameraWidth, cameraHeight);camera-&gt;setViewfinderSettings(set);//è·å–å®Œæˆåå¸è½½camera-&gt;unload();//æ–¹æ³•2ï¼šé€šè¿‡äº‹ä»¶ä¿¡å·è·å–camera = new QCamera(this);connect(camera, SIGNAL(stateChanged(QCamera::State)), this, SLOT(stateChanged(QCamera::State)));void CameraThread::stateChanged(QCamera::State state)&#123;    if (state == QCamera::ActiveState) &#123;        //è¾“å‡ºå½“å‰è®¾å¤‡æ”¯æŒçš„åˆ†è¾¨ç‡        QList&lt;QSize&gt; sizes = camera-&gt;supportedViewfinderResolutions();        emit resolutions(sizes);        //é‡æ–°è®¾ç½®åˆ†è¾¨ç‡        QCameraViewfinderSettings set;        set.setResolution(cameraWidth, cameraHeight);        camera-&gt;setViewfinderSettings(set);    &#125;&#125;//QCameraæ²¡æœ‰æŒ‡å®šè®¾å¤‡åç§°çš„æ—¶å€™åˆ™é‡‡ç”¨é»˜è®¤çš„æ‘„åƒæœºcamera = new QCamera(this);//cameraName = @device:pnp:\\\\\\\\?\\\\usb#vid_046d&amp;pid_0825&amp;mi_00#6&amp;212eebd3&amp;0&amp;0000#&#123;65e8773d-8f56-11d0-a3b9-00a0c9223196&#125;\\\\global//å¯ä»¥é€šè¿‡è®¾å¤‡æè¿°ç¬¦æ¥æŸ¥æ‰¾è®¾å¤‡åç§°(å”¯ä¸€æ ‡è¯†)camera = new QCamera(cameraName.toUtf8(), this);\n\nå¾ˆå¤šæ—¶å€™éœ€è¦åœ¨çª—ä½“é¦–æ¬¡æ˜¾ç¤ºçš„æ—¶å€™åŠ è½½ä¸€äº›ä¸œè¥¿ï¼Œè€Œä¸”åªåŠ è½½ä¸€æ¬¡ï¼Œå½“çª—ä½“å†æ¬¡æ˜¾ç¤ºçš„æ—¶å€™ä¸åŠ è½½ã€‚ä¸ºä»€ä¹ˆä¸æ˜¯åœ¨æ„é€ å‡½æ•°å‘¢ï¼Ÿå› ä¸ºå¾ˆå¤šç©æ„éƒ½æ˜¯è¦åœ¨æ˜¾ç¤ºåæ‰èƒ½ç¡®å®šï¼Œæ¯”å¦‚æ§ä»¶çš„å°ºå¯¸ï¼Œéƒ¨åˆ†æ ·å¼è¡¨çš„åº”ç”¨ã€‚\n123456789void Widget::showEvent(QShowEvent *)&#123;    //è¿™é‡Œä¸ºäº†æ¼”ç¤ºä»£ç æ–¹ä¾¿ç›´æ¥å†™çš„staticï¼Œå¦‚æœnewå¤šä¸ªçª—ä½“åˆ™éœ€è¦å®šä¹‰åœ¨å¤´æ–‡ä»¶ä¸­ã€‚    static bool isLoad = false;    if (!isLoad) &#123;        isLoad = true;        //æ‰§è¡Œå¯¹åº”çš„å¤„ç†    &#125;&#125;\n\nQtè·å–å½“å‰æ‰€ç”¨çš„Qtç‰ˆæœ¬ã€ç¼–è¯‘å™¨ã€ä½æ•°ç­‰ä¿¡æ¯ã€‚\n12345678910111213141516171819202122232425262728293031323334353637//è¯¦ç»†çš„Qtç‰ˆæœ¬+ç¼–è¯‘å™¨+ä½æ•°QString compilerString = &quot;&lt;unknown&gt;&quot;;&#123;#if defined(Q_CC_CLANG)    QString isAppleString;#if defined(__apple_build_version__)    isAppleString = QLatin1String(&quot; (Apple)&quot;);#endif    compilerString = QLatin1String(&quot;Clang &quot;) + QString::number(__clang_major__) + QLatin1Char(&#x27;.&#x27;) + QString::number(__clang_minor__) + isAppleString;#elif defined(Q_CC_GNU)    compilerString = QLatin1String(&quot;GCC &quot;) + QLatin1String(__VERSION__);#elif defined(Q_CC_MSVC)    if (_MSC_VER &gt; 1999) &#123;        compilerString = QLatin1String(&quot;MSVC &lt;unknown&gt;&quot;);    &#125; else if (_MSC_VER &gt;= 1930) &#123;        compilerString = QLatin1String(&quot;MSVC 2022&quot;);    &#125; else if (_MSC_VER &gt;= 1920) &#123;        compilerString = QLatin1String(&quot;MSVC 2019&quot;);    &#125; else if (_MSC_VER &gt;= 1910) &#123;        compilerString = QLatin1String(&quot;MSVC 2017&quot;);    &#125; else if (_MSC_VER &gt;= 1900) &#123;        compilerString = QLatin1String(&quot;MSVC 2015&quot;);    &#125; else if (_MSC_VER &gt;= 1800) &#123;        compilerString = QLatin1String(&quot;MSVC 2013&quot;);    &#125; else if (_MSC_VER &gt;= 1700) &#123;        compilerString = QLatin1String(&quot;MSVC 2012&quot;);    &#125; else if (_MSC_VER &gt;= 1600) &#123;        compilerString = QLatin1String(&quot;MSVC 2010&quot;);    &#125; else &#123;        compilerString = QLatin1String(&quot;MSVC &lt;old&gt;&quot;);    &#125;#endif&#125;//æ‹“å±•çŸ¥è¯† æŸ¥çœ‹ QSysInfo ç±»ä¸‹é¢æœ‰å¾ˆå¤šå¥½ä¸œè¥¿// qVersion() = QT_VERSION_STRQString version = QString(&quot;%1 %2 %3&quot;).arg(qVersion()).arg(compilerString).arg(QString::number(QSysInfo::WordSize));\n\nQDateTimeå¯ä»¥ç›´æ¥æ ¼å¼åŒ–è¾“å‡ºæ˜ŸæœŸå‡ å‘¨å‡ ï¼ŒQt6é»˜è®¤æŒ‰ç…§è‹±æ–‡è¾“å‡ºæ¯”å¦‚ ddd &#x3D; å‘¨äºŒ Tue  dddd &#x3D; æ˜ŸæœŸäºŒ Tuesday ï¼Œæ­¤æ—¶å¦‚æœåªæƒ³æ°¸è¿œæ˜¯ä¸­æ–‡å°±éœ€è¦ç”¨åˆ°QLocaleè¿›è¡Œè½¬æ¢ã€‚\n12345678910111213141516171819202122232425//æ ¼å¼åŒ–è¾“å‡ºå—åˆ°æœ¬åœ°æ“ä½œç³»ç»Ÿè¯­è¨€çš„å½±å“//è‹±æ–‡æ“ä½œç³»ç»Ÿ//è¿™æ ·è·å–åˆ°çš„æ˜¯Monåˆ°Sunï¼Œè‹±æ–‡æ˜ŸæœŸçš„3ä¸ªå­—æ¯çš„ç¼©å†™ã€‚QDateTime::currentDateTime().toString(&quot;ddd&quot;);//è¿™æ ·è·å–åˆ°çš„æ˜¯Mondayåˆ°Sundayï¼Œè‹±æ–‡æ˜ŸæœŸå®Œæ•´å•è¯ã€‚QDateTime::currentDateTime().toString(&quot;dddd&quot;);//ä¸­æ–‡æ“ä½œç³»ç»Ÿ//è¿™æ ·è·å–åˆ°çš„æ˜¯å‘¨ä¸€åˆ°å‘¨æ—¥ã€‚QDateTime::currentDateTime().toString(&quot;ddd&quot;);//è¿™æ ·è·å–åˆ°çš„æ˜¯æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸæ—¥ã€‚QDateTime::currentDateTime().toString(&quot;dddd&quot;);//ä¸»åŠ¨æŒ‡å®šè¯­è¨€è½¬æ¢//å¦‚æœæ²¡æœ‰æŒ‡å®šæœ¬åœ°è¯­è¨€åˆ™é»˜è®¤é‡‡ç”¨ç³»ç»Ÿçš„è¯­è¨€ç¯å¢ƒã€‚QLocale locale;//QLocale locale = QLocale::Chinese;//QLocale locale = QLocale::English;//QLocale locale = QLocale::Japanese;//ä¸‹é¢æ°¸è¿œè¾“å‡ºä¸­æ–‡çš„å‘¨ä¸€åˆ°å‘¨æ—¥locale.toString(QDateTime::currentDateTime(), &quot;ddd&quot;);//ä¸‹é¢æ°¸è¿œè¾“å‡ºä¸­æ–‡çš„æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸæ—¥locale.toString(QDateTime::currentDateTime(), &quot;dddd&quot;);\n\nQSqlTableModelå¤§å¤§ç®€åŒ–äº†å¯¹æ•°æ®åº“è¡¨çš„æ˜¾ç¤ºã€æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ç­‰ï¼Œå”¯ç‹¬å¯¹æ•°æ®åº“åˆ†é¡µæ“ä½œæœ‰ç‚¹ç»•å¼¯ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950//å®ä¾‹åŒ–æ•°æ®åº“è¡¨æ¨¡å‹QSqlTableModel *model = new QSqlTableModel(this);//æŒ‡å®šè¡¨åmodel-&gt;setTable(&quot;table&quot;);//è®¾ç½®åˆ—æ’åºmodel-&gt;setSort(0, Qt::AscendingOrder);//è®¾ç½®æäº¤æ¨¡å¼model-&gt;setEditStrategy(QSqlTableModel::OnManualSubmit);//ç«‹å³æŸ¥è¯¢ä¸€æ¬¡model-&gt;select();//å°†æ•°æ®åº“è¡¨æ¨¡å‹è®¾ç½®åˆ°è¡¨æ ¼ä¸Šui-&gt;tableView-&gt;setModel(model);//æµ‹è¯•å‘ç°è¿‡æ»¤æ¡ä»¶ä¸­é™¤äº†å¯ä»¥å¸¦whereè¯­å¥è¿˜å¯ä»¥å¸¦æ’åºåŠlimitç­‰model-&gt;setFilter(&quot;1=1 order by id desc limit 100&quot;);//å¦‚æœåœ¨è¿‡æ»¤æ¡ä»¶ä¸­è®¾ç½®äº†æ’åºè¯­å¥åˆ™ä¸å¯ä»¥å†ä½¿ç”¨setSortæ–¹æ³•//ä¸‹é¢çš„ä»£ç ç»“æœæ˜¯æ‰§è¡Œå‡ºé”™ï¼Œå¯èƒ½å› ä¸ºsetSortåˆé‡æ–°å¢åŠ äº†order byè¯­å¥å¯¼è‡´å¤šä¸ªorder byè¯­å¥å†²çªäº†ã€‚model-&gt;setSort(0, Qt::AscendingOrder);model-&gt;setFilter(&quot;1=1 order by id desc limit 100&quot;);//é€šè¿‡setFilterè®¾ç½®å•çº¯çš„whereè¯­å¥å¯ä»¥ä¸ç”¨åŠ 1=1model-&gt;setFilter(&quot;name=&#x27;å¼ ä¸‰&#x27;&quot;);//å¦‚æœè¿˜æœ‰å…¶ä»–è¯­å¥æ¯”å¦‚æ’åºæˆ–è€…limitç­‰åˆ™éœ€è¦æœ€å‰é¢åŠ ä¸Š1=1//ä¸‹é¢è¡¨ç¤ºæŒ‰ç…§idå‡åºæ’åºï¼ŒæŸ¥è¯¢ç»“æœæ˜¾ç¤ºç¬¬5-15æ¡è®°å½•ã€‚model-&gt;setFilter(&quot;1=1 order by id asc limit 5,10&quot;);//å¤šä¸ªæ¡ä»¶ç”¨andè¿æ¥//å»ºè®®ä»»ä½•æ—¶å€™ç”¨äº†setFilteråˆ™æœ€å‰é¢å†™1=1æœ€æœ«å°¾åŠ ä¸Š ; é˜²æ­¢æœ‰äº›åœ°æ–¹æ— æ³•æ­£ç¡®æ‰§è¡Œã€‚model-&gt;setFilter(&quot;1=1 and name=&#x27;å¼ ä¸‰&#x27; and result&gt;=70;&quot;);//ä¸‹é¢è¡¨ç¤ºæŸ¥è¯¢å§“åæ˜¯å¼ ä¸‰çš„è®°å½•ï¼ŒæŒ‰ç…§idå­—æ®µé™åºæ’åºï¼Œç»“æœä»ç¬¬10æ¡å¼€å§‹100æ¡ï¼Œç›¸å½“äºä»ç¬¬10æ¡åˆ°110æ¡è®°å½•ã€‚model-&gt;setFilter(&quot;1=1 and name=&#x27;å¼ ä¸‰&#x27; order by id desc limit 10,100;&quot;);//åœ¨ç¬¬3è¡Œå¼€å§‹æ·»åŠ ä¸€æ¡è®°å½•model-&gt;insertRow(2);//ç«‹å³å¡«å……åˆšåˆšæ–°å¢åŠ çš„è¡Œï¼Œé»˜è®¤ä¸ºç©ºéœ€è¦ç”¨æˆ·æ‰‹åŠ¨åœ¨è¡¨æ ¼ä¸­è¾“å…¥ã€‚model-&gt;setData(model-&gt;index(2, 0), 100);model-&gt;setData(model-&gt;index(2, 1), &quot;å¼ ä¸‰&quot;);//æäº¤æ›´æ–°model-&gt;submitAll();//åˆ é™¤ç¬¬4è¡Œmodel-&gt;removeRow(3);model-&gt;submitAll();//æ€»ä¹‹æœ‰å¢åˆ æ”¹æ“ä½œåéƒ½éœ€è¦è°ƒç”¨model-&gt;submitAll();æ¥çœŸæ­£æ‰§è¡Œï¼Œå¦åˆ™ä»…ä»…æ˜¯æ•°æ®æ¨¡å‹æ›´æ–°äº†æ•°æ®ï¼Œå¹¶ä¸ä¼šæ›´æ–°åˆ°æ•°æ®åº“ä¸­ã€‚//æ’¤é”€æ›´æ”¹model-&gt;revertAll();\n\n19ï¼š181-190\nQtå¤©ç”Ÿå°±æ˜¯linuxçš„ï¼Œä»linuxå¼€å§‹å‘å±•èµ·æ¥çš„ï¼Œæ‰€ä»¥ä¸å°‘Qtç¨‹åºå‘˜ç»å¸¸çš„å¼€å‘ç¯å¢ƒæ˜¯linuxï¼Œæ¯”å¦‚å¸¸ç”¨çš„ubuntuç­‰ç³»ç»Ÿï¼Œæ•´ç†äº†ä¸€ç‚¹å¸¸ç”¨çš„linuxå‘½ä»¤ã€‚\n\n\n\n\nå‘½ä»¤\nåŠŸèƒ½\n\n\n\nsudo -s\nåˆ‡æ¢åˆ°ç®¡ç†å‘˜ï¼Œå¦‚æœæ˜¯ sudo -i åˆ‡æ¢åä¼šæ”¹å˜å½“å‰ç›®å½•ã€‚\n\n\napt install g++\nå®‰è£…è½¯ä»¶åŒ…ï¼ˆè¦ç®¡ç†å‘˜æƒé™ï¼‰ï¼Œå¦ä¸€ä¸ªæ´¾ç³»çš„æ˜¯ yum installã€‚\n\n\ncd &#x2F;home\nè¿›å…¥homeç›®å½•ã€‚\n\n\nls\nç½—åˆ—å½“å‰æ‰€åœ¨ç›®å½•æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ã€‚\n\n\nifconfig\næŸ¥çœ‹ç½‘å¡ä¿¡æ¯åŒ…æ‹¬IPåœ°å€ï¼Œwindowsä¸Šæ˜¯ ipconfigã€‚\n\n\ntar -zxvf bin.tar.gz\nè§£å‹æ–‡ä»¶åˆ°å½“å‰ç›®å½•ã€‚\n\n\ntar -jxvf bin.tar.xz\nè§£å‹æ–‡ä»¶åˆ°å½“å‰ç›®å½•ã€‚\n\n\ntar -zxvf bin.tar.gz -C &#x2F;home\nè§£å‹æ–‡ä»¶åˆ°&#x2F;homeç›®å½•ï¼Œè®°ä½æ˜¯å¤§å†™çš„Cã€‚\n\n\ntar -zcvf bin.tar.gz bin\nå°†binç›®å½•å‹ç¼©æˆtar.gzæ ¼å¼æ–‡ä»¶ï¼ˆå‹ç¼©æ¯”ä¸€èˆ¬ï¼‰ã€‚\n\n\ntar -jcvf bin.tar.xz bin\nå°†binç›®å½•å‹ç¼©æˆtar.xzæ ¼å¼æ–‡ä»¶ï¼ˆå‹ç¼©æ¯”é«˜ï¼Œæ¨èï¼‰ã€‚\n\n\ntar -â€¦\nj z è¡¨ç¤ºä¸åŒçš„å‹ç¼©æ–¹æ³•ï¼Œxè¡¨ç¤ºè§£å‹ï¼Œcè¡¨ç¤ºå‹ç¼©ã€‚\n\n\ngedit 1.txt\nç”¨è®°äº‹æœ¬æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ã€‚\n\n\nvim 1.txt\nç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œå¾ˆå¤šæ—¶å€™å¯ä»¥ç¼©å†™ç”¨viã€‚\n\n\n.&#x2F;configure  make -j4  make install\né€šç”¨ç¼–è¯‘æºç å‘½ä»¤ï¼Œç¬¬ä¸€æ­¥.&#x2F;configureæ‰§è¡Œé…ç½®è„šæœ¬ï¼Œç¬¬äºŒæ­¥make -j4å¯ç”¨å¤šçº¿ç¨‹ç¼–è¯‘ï¼Œç¬¬ä¸‰æ­¥make installå®‰è£…ç¼–è¯‘å¥½çš„æ–‡ä»¶ã€‚\n\n\n.&#x2F;configure -prefix &#x2F;home&#x2F;liu&#x2F;Qt-5.9.3-static -static -sql-sqlite -qt-zlib -qt-xcb -qt-libpng -qt-libjpeg -fontconfig -system-freetype -iconv -nomake tests -nomake examples -skip qt3d -skip qtdoc\nQté€šç”¨ç¼–è¯‘å‘½ä»¤ã€‚\n\n\n.&#x2F;configure -static -release -fontconfig -system-freetype -qt-xcb -qt-sql-sqlite -qt-zlib -qt-libpng -qt-libjpeg -nomake tests -nomake examples -prefix &#x2F;home&#x2F;liu&#x2F;qt&#x2F;Qt5.6.3\nQté™æ€å¸¦ä¸­æ–‡ã€‚\n\n\n.&#x2F;configure -prefix &#x2F;home&#x2F;liu&#x2F;Qt-5.9.3-static -static -release -nomake examples -nomake tests -skip qt3d\nç²¾ç®€ç¼–è¯‘å‘½ä»¤ã€‚\n\n\n.&#x2F;configure â€“prefix&#x3D;host â€“enable-static â€“disable-shared â€“disable-doc\nffmpegç¼–è¯‘å‘½ä»¤ã€‚\n\n\n\nQtè‡ªå¸¦çš„æ—¥å¿—é‡å®šå‘æœºåˆ¶éå¸¸ç®€å•å¥½ç”¨ï¼Œè‡ªä»ç”¨äº†ä»¥åå†ä¹Ÿä¸ç”¨ä»€ä¹ˆæ–­ç‚¹è°ƒè¯•å•¥çš„äº†ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹æ”¯æŒqdebugè¾“å‡ºå¯¹åº”çš„ä¿¡æ¯ï¼Œè€Œä¸”å‘å¸ƒç¨‹åºä»¥åä¹Ÿå¯ä»¥å¼€å¯è°ƒè¯•æ—¥å¿—å°†å…¶è¾“å‡ºæŸ¥çœ‹ç­‰ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374//Qt5å¼€å§‹æä¾›äº†æ—¥å¿—ä¸Šä¸‹æ–‡ä¿¡æ¯è¾“å‡ºï¼Œæ¯”å¦‚è¾“å‡ºå½“å‰æ‰“å°æ¶ˆæ¯æ‰€åœ¨çš„ä»£ç æ–‡ä»¶ã€è¡Œå·ã€å‡½æ•°åç­‰ã€‚//å¦‚æœæ˜¯releaseè¿˜éœ€è¦åœ¨proä¸­åŠ ä¸Š DEFINES += QT_MESSAGELOGCONTEXT æ‰èƒ½è¾“å‡ºä¸Šä¸‹æ–‡ï¼Œé»˜è®¤releaseå…³é—­çš„ã€‚//åˆ‡è®°ä¸è¦åœ¨æ—¥å¿—é’©å­å‡½æ•°ä¸­å†å†™qdebugä¹‹ç±»çš„ï¼Œé‚£æ ·å°±æ­»å¾ªç¯äº†ã€‚//æ—¥å¿—é‡å®šå‘ä¸€èˆ¬å°±ä¸‰ç§å¤„ç†//1: è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶æ¯”å¦‚txtæ–‡æœ¬æ–‡ä»¶ã€‚//2: å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œå¯ä»¥åˆ†ç±»å­˜å‚¨ï¼Œä»¥ä¾¿ç›¸å…³äººå‘˜æŸ¥è¯¢åˆ†æã€‚//3: é‡å®šå‘åˆ°ç½‘ç»œï¼Œå¯¹æ–¹ç”¨å°å·¥å…·è¿æ¥ç¨‹åºåï¼Œæ‰€æœ‰æ‰“å°ä¿¡æ¯é€šè¿‡tcpå‘è¿‡å»ã€‚//æ—¥å¿—é‡å®šå‘#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))void Log(QtMsgType type, const QMessageLogContext &amp;context, const QString &amp;msg)#elsevoid Log(QtMsgType type, const char *msg)#endif&#123;    //åŠ é”,é˜²æ­¢å¤šçº¿ç¨‹ä¸­qdebugå¤ªé¢‘ç¹å¯¼è‡´å´©æºƒ    static QMutex mutex;    QMutexLocker locker(&amp;mutex);    QString content;    //è¿™é‡Œå¯ä»¥æ ¹æ®ä¸åŒçš„ç±»å‹åŠ ä¸Šä¸åŒçš„å¤´éƒ¨ç”¨äºåŒºåˆ†    switch (type) &#123;        case QtDebugMsg:            content = QString(&quot;%1&quot;).arg(msg);            break;        case QtWarningMsg:            content = QString(&quot;%1&quot;).arg(msg);            break;        case QtCriticalMsg:            content = QString(&quot;%1&quot;).arg(msg);            break;        case QtFatalMsg:            content = QString(&quot;%1&quot;).arg(msg);            break;    &#125;    //åŠ ä¸Šæ‰“å°ä»£ç æ‰€åœ¨ä»£ç æ–‡ä»¶ã€è¡Œå·ã€å‡½æ•°å#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    if (SaveLog::Instance()-&gt;getUseContext()) &#123;        int line = context.line;        QString file = context.file;        QString function = context.function;        if (line &gt; 0) &#123;            content = QString(&quot;è¡Œå·: %1  æ–‡ä»¶: %2  å‡½æ•°: %3\\n%4&quot;).arg(line).arg(file).arg(function).arg(content);        &#125;    &#125;#endif    //å°†å†…å®¹ä¼ ç»™å‡½æ•°è¿›è¡Œå¤„ç†    SaveLog::Instance()-&gt;save(content);&#125;//å®‰è£…æ—¥å¿—é’©å­,è¾“å‡ºè°ƒè¯•ä¿¡æ¯åˆ°æ–‡ä»¶,ä¾¿äºè°ƒè¯•void SaveLog::start()&#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    qInstallMessageHandler(Log);#else    qInstallMsgHandler(Log);#endif&#125;//å¸è½½æ—¥å¿—é’©å­void SaveLog::stop()&#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    qInstallMessageHandler(0);#else    qInstallMsgHandler(0);#endif&#125;\n\nè‡ªä»c++11æ ‡å‡†ä»¥åï¼Œå„ç§è¯­æ³•ç³–å±‚å‡ºä¸ç©·ï¼Œå…¶ä¸­lambdaè¡¨è¾¾å¼ç”¨çš„æœ€å¹¿ï¼ŒåŸºæœ¬ä¸Šä»Qt5ä»¥åå°±æ”¯æŒlambdaè¡¨è¾¾å¼ã€‚å¯¹äºä¹ æƒ¯äº†c99çš„è€ä¸€è¾ˆçš„ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ç©æ„æ˜¯ä¸ªæ–°é²œäº‹ç‰©ï¼Œè¿™é‡Œç‰¹æ„åšä¸ªå°ç†è§£ç¬”è®°ã€‚\n\n\n\nä»£ç æ ¼å¼ï¼šcapture mutable -&gt;return-type {statement}\n[capture]ï¼šæ•æ‰åˆ—è¡¨ï¼Œæ•æ‰åˆ—è¡¨æ€»æ˜¯å‡ºç°åœ¨Lambdaå‡½æ•°çš„å¼€å§‹å¤„ï¼Œå®é™…ä¸Šï¼Œ[]æ˜¯Lambdaå¼•å‡ºç¬¦ï¼Œç¼–è¯‘å™¨æ ¹æ®è¯¥å¼•å‡ºç¬¦åˆ¤æ–­æ¥ä¸‹æ¥çš„ä»£ç æ˜¯å¦æ˜¯Lambdaå‡½æ•°ï¼Œæ•æ‰åˆ—è¡¨èƒ½å¤Ÿæ•æ‰ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä»¥ä¾›Lambdaå‡½æ•°ä½¿ç”¨ã€‚\n(parameters)ï¼šå‚æ•°åˆ—è¡¨ï¼Œä¸æ™®é€šå‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸€è‡´ï¼Œå¦‚æœä¸éœ€è¦å‚æ•°ä¼ é€’ï¼Œåˆ™å¯ä»¥è¿åŒæ‹¬å· () ä¸€èµ·çœç•¥ã€‚\nmutableï¼šmutableä¿®é¥°ç¬¦ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒLambdaå‡½æ•°æ€»æ˜¯ä¸€ä¸ªconstå‡½æ•°ï¼Œmutableå¯ä»¥å–æ¶ˆå…¶å¸¸é‡æ€§ã€‚åœ¨ä½¿ç”¨è¯¥ä¿®é¥°ç¬¦æ—¶ï¼Œå‚æ•°åˆ—è¡¨ä¸å¯çœç•¥ï¼ˆå³ä½¿å‚æ•°ä¸ºç©ºï¼‰ã€‚\n-&gt;return-typeï¼šè¿”å›ç±»å‹ï¼Œç”¨è¿½è¸ªè¿”å›ç±»å‹å½¢å¼å£°æ˜å‡½æ•°çš„è¿”å›ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦è¿”å›å€¼çš„æ—¶å€™ä¹Ÿå¯ä»¥è¿åŒç¬¦å· -&gt; ä¸€èµ·çœç•¥ã€‚æ­¤å¤–ï¼Œåœ¨è¿”å›ç±»å‹æ˜ç¡®çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥çœç•¥è¯¥éƒ¨åˆ†ï¼Œè®©ç¼–è¯‘å™¨å¯¹è¿”å›ç±»å‹è¿›è¡Œæ¨å¯¼ã€‚\n{statement}ï¼šå‡½æ•°ä½“ï¼Œå†…å®¹ä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œä¸è¿‡é™¤äº†å¯ä»¥ä½¿ç”¨å‚æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ‰€æœ‰æ•è·çš„å˜é‡ã€‚\n\næ•æ‰åˆ—è¡¨æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š\n\n[var]è¡¨ç¤ºå€¼ä¼ é€’æ–¹å¼æ•æ‰å˜é‡varã€‚\n[&#x3D;]è¡¨ç¤ºå€¼ä¼ é€’æ–¹å¼æ•æ‰æ‰€æœ‰çˆ¶ä½œç”¨åŸŸçš„å˜é‡ï¼ˆåŒ…æ‹¬thisï¼‰ã€‚\n[&amp;var]è¡¨ç¤ºå¼•ç”¨ä¼ é€’æ•æ‰å˜é‡varã€‚\n[&amp;]è¡¨ç¤ºå¼•ç”¨ä¼ é€’æ–¹å¼æ•æ‰æ‰€æœ‰çˆ¶ä½œç”¨åŸŸçš„å˜é‡ï¼ˆåŒ…æ‹¬thisï¼‰ã€‚\n[this]è¡¨ç¤ºå€¼ä¼ é€’æ–¹å¼æ•æ‰å½“å‰çš„thisæŒ‡é’ˆã€‚\n\n1234567891011121314151617181920212223MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent)    , ui(new Ui::MainWindow)&#123;    ui-&gt;setupUi(this);    //æŒ‰é’®å•å‡»ä¸å¸¦å‚æ•°    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [] &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot;;    &#125;);    //æŒ‰é’®å•å‡»å¸¦å‚æ•°    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [] (bool isCheck) &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot; &lt;&lt; isCheck;    &#125;);    //è‡ªå®šä¹‰ä¿¡å·å¸¦å‚æ•°    connect(this, &amp;MainWindow::sig_test, [] (int i, int j) &#123;        qDebug() &lt;&lt; &quot;hello lambda&quot; &lt;&lt; i &lt;&lt; j;    &#125;);    emit sig_test(5, 8);&#125;\n\n\nç”±äºQtç‰ˆæœ¬ä¼—å¤šï¼Œæœ‰æ—¶å€™ä¸ºäº†å…¼å®¹å¤šä¸ªç‰ˆæœ¬ç”šè‡³è·¨åº¦Qt4&#x2F;Qt5&#x2F;Qt6çš„å…¼å®¹ï¼Œæœ‰äº›å¤´æ–‡ä»¶æˆ–è€…ç±»åç­‰å˜äº†æˆ–è€…æ–°å¢äº†ï¼Œéœ€è¦ç”¨åˆ°Qtç‰ˆæœ¬çš„åˆ¤æ–­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœåœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨ QT_VERSION_CHECK éœ€è¦å…ˆå¼•å…¥#include â€œqglobal.hâ€ä¸ç„¶ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸º QT_VERSION_CHECK è¿™ä¸ªå‡½æ•°åœ¨ qglobal.h å¤´æ–‡ä»¶ä¸­ã€‚\n1234567//è‡³å°‘è¦åŒ…å« qglobal.hï¼Œç†è®ºä¸ŠQtæ‰€æœ‰çš„ç±»éƒ½åŒ…å«äº†è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œæ‰€ä»¥ä½ å¼•å…¥Qtçš„å…¶ä»–å¤´æ–‡ä»¶ä¹Ÿè¡Œæ¯”å¦‚ qobject.h#include &quot;qglobal.h&quot;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))#include &quot;qscreen.h&quot;#else#include &quot;qdesktopwidget.h&quot;#endif\n\nåœ¨ä½¿ç”¨QStringè½¬æ¢åˆ°char *æˆ–è€…const char *çš„æ—¶å€™ï¼ŒåŠ¡å¿…è®°å¾—åˆ†ä¸¤æ­¥æ¥å®Œæˆï¼Œè¡€çš„æ•™è®­ï¼Œåœ¨ä¸€ä¸ªåœºæ™¯ä¸­ï¼Œå°±å› ä¸ºæ²¡æœ‰åˆ†ä¸¤æ­¥èµ°ï¼Œç°è±¡æ˜¯msvcçš„debugå¼‚å¸¸releaseæ­£å¸¸ï¼Œmingwå’Œgccçš„debugå’Œreleaseéƒ½æ­£å¸¸ï¼Œè¿™å°±å¾ˆæ— è¯­äº†ï¼Œæ‰¾é—®é¢˜æ‰¾åŠå¤©ï¼Œå¯¹æ¯”æ³•æ’é™¤æ³•æŒ‰é“ç†è¦ä¹ˆéƒ½æœ‰é—®é¢˜æ‰å¯¹ã€‚\n\n\n\nè½¬æ¢å‰QStringçš„å†…å®¹æ— å…³ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ï¼Œè¦å‡ºé—®é¢˜éƒ½ä¸€æ ·ã€‚\nè½¬æ¢ä¸­QByteArrayæ— å…³å…·ä½“ç±»å‹ï¼ŒtoUtf8ã€toLatin1ã€toLocal8Bitã€toStdStringç­‰æ–¹æ³•ï¼Œè¦å‡ºé—®é¢˜éƒ½ä¸€æ ·ã€‚\nè½¬æ¢åæ— å…³char *è¿˜æ˜¯const char *ï¼Œè¦å‡ºé—®é¢˜éƒ½ä¸€æ ·ã€‚\nå‡ºé—®é¢˜çš„éšæœºæ€§çš„ï¼Œæ¦‚ç‡å‡ºç°ï¼Œç†è®ºä¸Šdebugçš„æ¦‚ç‡æ›´å¤§ã€‚\næ ¹æ®é…·ç å¤§ä½¬åˆ†æå¯èƒ½çš„åŸå› (ä¸ç¡®å®š)æ˜¯msvcä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œdebugä¼šåœ¨å†…å­˜é‡Šæ”¾ååšå¡«å……ï¼Œreleaseåˆ™ä¸ä¼šã€‚1234567QString text = &quot;xxxxx&quot;;//ä¸‹é¢è¿™æ ·è½¬æ¢å¾ˆå¯èƒ½ä¼šæœ‰é—®é¢˜char *data = text.toUtf8().data();//åˆ†ä¸¤æ­¥è½¬æ¢è‚¯å®šä¸ä¼šæœ‰é—®é¢˜QByteArray buffer = text.toUtf8();char *data = buffer.data();const char *data = buffer.constData();\n\n\nå…³äºæ˜¯ä½¿ç”¨QListè¿˜æ˜¯QVectorçš„é—®é¢˜ï¼Œä¸€ç›´æ˜¯ä¼—å¤šQterçš„é€‰æ‹©é—®é¢˜ï¼Œä¸»è¦æ˜¯è¿™ä¸¤ä¸ªç©æ„æä¾›çš„çš„æ¥å£å‡½æ•°åŸºæœ¬ä¸€è‡´ï¼Œæ¯”å¦‚æ’å…¥ã€åˆ é™¤ã€å–å€¼ç­‰ã€‚\n\n\nå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç”¨QListã€‚åƒappendã€prependã€insertè¿™ç§æ“ä½œï¼Œé€šå¸¸QListæ¯”QVectorå¿«çš„å¤šã€‚\nQListæ˜¯åŸºäºindexæ ‡ç­¾å­˜å‚¨å®ƒçš„å…ƒç´ é¡¹åœ¨å†…å­˜ä¸­ï¼Œæ¯”é‚£ç§ä¾èµ–iteratorè¿­ä»£çš„æ›´å¿«æ·ï¼Œè€Œä¸”ä½ çš„ä»£ç ä¹Ÿæ›´å°‘ã€‚\nå¦‚æœä½ éœ€è¦ä¸€ä¸ªçœŸæ­£çš„è¿æ¥ç€çš„listï¼Œä¸”éœ€è¦ä¿è¯ä¸€ä¸ªå›ºå®šæ’å…¥è€—æ—¶ã€‚é‚£å°±ç”¨è¿­ä»£å™¨ï¼Œè€Œä¸æ˜¯æ ‡ç­¾ã€‚ä½¿ç”¨QLinkedList()ã€‚\nå¦‚æœä½ éœ€è¦å¼€è¾Ÿè¿ç»­çš„å†…å­˜ç©ºé—´å­˜å‚¨ï¼Œæˆ–è€…ä½ çš„å…ƒç´ è¿œæ¯”ä¸€ä¸ªæŒ‡é’ˆå¤§ï¼Œè¿™æ—¶ä½ éœ€è¦é¿å…ä¸ªåˆ«æ’å…¥æ“ä½œï¼Œå‡ºç°å †æ ˆæº¢å‡ºï¼Œè¿™æ—¶å€™ç”¨QVectorã€‚\nå¦‚æœæ›´åœ¨æ„å–å€¼çš„é€Ÿåº¦åˆ™ç”¨QVectorï¼ŒQCustomPlotç”¨çš„å°±æ˜¯QVectorï¼Œéœ€è¦é¢‘ç¹å¤§é‡çš„å–å‡ºæ•°æ®è¿›è¡Œç»˜åˆ¶ã€‚\nå¦‚æœæ›´åœ¨æ„æ›´æ–°æ•°æ®ï¼ˆæ·»åŠ ã€åˆ é™¤ç­‰ï¼‰çš„é€Ÿåº¦åˆ™ç”¨QListï¼ˆå¯¹åº”æ“ä½œæ˜¯[]&#x3D;å€¼ï¼‰ï¼Œä½†æ˜¯å› ä¸ºQChartä¸»è¦ç”¨çš„æ˜¯QListè®¿é—®æ•°æ®ï¼ˆå¯¹åº”æ“ä½œæ˜¯at()ï¼‰ï¼Œä¹Ÿæ˜¯å¯¼è‡´å¤§æ•°æ®é‡å¡é¡¿çš„åŸå› ä¹‹ä¸€ï¼Œä¸€ç›´è¢«è¯Ÿç—…ã€‚\næ›²çº¿å›¾è¡¨è¿™ç±»çš„åŸºæœ¬ä¸Šç»å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯åœ¨è®¿é—®æ•°æ®ï¼Œæ‹¿åˆ°è®¾ç½®å¥½çš„æ•°æ®è¿›è¡Œç»˜åˆ¶ã€‚\næ€»ä¹‹ï¼šQListæ›´æ–°ï¼ˆæ’å…¥ã€è¿½åŠ ç­‰ï¼‰æ•°æ®é€Ÿåº¦å¿«ï¼ŒQVectorå–æ•°æ®é€Ÿåº¦å¿«ã€‚\nåœ¨æ•°æ®é‡å¾ˆå°çš„æƒ…å†µä¸‹ä¸¤è€…å‡ ä¹æ²¡å•¥æ€§èƒ½åŒºåˆ«ã€‚\nè²Œä¼¼Qt6å¯¹è¿™ä¸¤ä¸ªç±»åˆå¹¶äº†ï¼ˆé€‰æ‹©å›°éš¾ç—‡çš„Qterè§£æ”¾äº†ï¼‰ï¼ŒQVector&#x3D;QListå³QVectoræ˜¯QListçš„åˆ«åï¼Œå¯èƒ½åº•å±‚æ”¹äº†ä»£ç ä»¥ä¾¿å‘æŒ¥ä¸¤è€…çš„ä¼˜åŠ¿ã€‚\n\n\nå…³äºmouseTrackingé¼ æ ‡è¿½è¸ªå’ŒtabletTrackingå¹³æ¿è¿½è¸ªçš„å‡ ç‚¹å®˜æ–¹è¯´æ˜ã€‚\n\n\nmouseTrackingå±æ€§ç”¨äºä¿å­˜æ˜¯å¦å¯ç”¨é¼ æ ‡è·Ÿè¸ªï¼Œç¼ºçœæƒ…å†µæ˜¯ä¸å¯ç”¨çš„ã€‚\næ²¡å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå¯¹åº”éƒ¨ä»¶åªæ¥æ”¶åœ¨é¼ æ ‡ç§»åŠ¨åŒæ—¶è‡³å°‘ä¸€ä¸ªé¼ æ ‡æŒ‰é”®æŒ‰ä¸‹æ—¶çš„é¼ æ ‡ç§»åŠ¨äº‹ä»¶ã€‚\nå¯ç”¨é¼ æ ‡è·Ÿè¸ªçš„æƒ…å†µä¸‹ï¼Œä»»ä½•é¼ æ ‡ç§»åŠ¨äº‹ä»¶éƒ¨ä»¶éƒ½ä¼šæ¥æ”¶ã€‚\néƒ¨ä»¶æ–¹æ³•hasMouseTracking()ç”¨äºè¿”å›å½“å‰æ˜¯å¦å¯ç”¨é¼ æ ‡è·Ÿè¸ªã€‚\nsetMouseTracking(bool enable)ç”¨äºè®¾ç½®æ˜¯å¦å¯ç”¨é¼ æ ‡è·Ÿè¸ªã€‚\nä¸é¼ æ ‡è·Ÿè¸ªç›¸å…³çš„å‡½æ•°ä¸»è¦æ˜¯mouseMoveEvent()ã€‚\ntabletTrackingå±æ€§ä¿å­˜æ˜¯å¦å¯ç”¨éƒ¨ä»¶çš„å¹³æ¿è·Ÿè¸ªï¼Œç¼ºçœæ˜¯ä¸èµ·ç”¨çš„ã€‚\næ²¡æœ‰å¯ç”¨å¹³æ¿è·Ÿè¸ªçš„æƒ…å†µä¸‹ï¼Œéƒ¨ä»¶ä»…æ¥æ”¶è§¦æ§ç¬”ä¸å¹³æ¿æ¥è§¦æˆ–è‡³å°‘æœ‰ä¸ªè§¦æ§ç¬”æŒ‰é”®æŒ‰ä¸‹æ—¶çš„è§¦æ§ç¬”ç§»åŠ¨äº‹ä»¶ã€‚\nå¦‚æœéƒ¨ä»¶å¯ç”¨äº†å¹³æ¿è·Ÿè¸ªåŠŸèƒ½ï¼Œéƒ¨ä»¶èƒ½æ¥æ”¶è§¦æ§ç¬”é è¿‘ä½†æœªçœŸæ­£æ¥è§¦å¹³æ¿æ—¶çš„è§¦æ§ç¬”ç§»åŠ¨äº‹ä»¶ã€‚\nè¿™å¯ä»¥ç”¨äºç›‘è§†æ“ä½œä½ç½®ä»¥åŠéƒ¨ä»¶çš„è¾…åŠ©æ“ä½œåŠŸèƒ½ï¼ˆå¦‚æ—‹è½¬å’Œå€¾æ–œï¼‰ï¼Œå¹¶ä¸ºå›¾å½¢ç•Œé¢æä¾›è¿™äº›æ“ä½œçš„ä¿¡æ¯æ¥å£ã€‚\néƒ¨ä»¶æ–¹æ³•hasTabletTracking()ç”¨äºè¿”å›å½“å‰æ˜¯å¦å¯ç”¨å¹³æ¿è·Ÿè¸ªã€‚\nsetTabletTracking(bool enable)ç”¨äºè®¾ç½®æ˜¯å¦å¯ç”¨å¹³æ¿è·Ÿè¸ªã€‚\nä¸å¹³æ¿è·Ÿè¸ªç›¸å…³çš„å‡½æ•°ä¸»è¦æ˜¯tabletEvent()ã€‚\n\n\nå…³äºQTableWidgetç­‰æ§ä»¶è°ƒç”¨è‡ªå¸¦çš„removeRowã€clearContentsã€clearå‡½æ•°åˆ é™¤äº†é‡Œé¢çš„itemå’Œå†…å®¹ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨itemæˆ–è€…cellwidgetçš„ææ„å‡½æ•°è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œä¸ç”¨è‡ªå·±æ‰‹åŠ¨å†å»é‡Šæ”¾ã€‚\n1234567//æ¯æ¬¡è°ƒç”¨ clearContents éƒ½ä¼šè‡ªåŠ¨æ¸…ç†ä¹‹å‰çš„itemui-&gt;tableWidget-&gt;clearContents();for (int i = 0; i &lt; count; ++i) &#123;    ui-&gt;tableWidget-&gt;setItem(i, 0, new QTableWidgetItem(&quot;aaa&quot;));    ui-&gt;tableWidget-&gt;setItem(i, 1, new QTableWidgetItem(&quot;bbb&quot;));    ui-&gt;tableWidget-&gt;setCellWidget(i, 2, new QPushButton(&quot;ccc&quot;));&#125;\n\nå¯¹äºQListViewï¼ˆQListWidgetï¼‰ã€QTreeViewï¼ˆQTreeWidgetï¼‰ã€QTableViewï¼ˆQTableWidgetï¼‰è¿™ç§ç±»å‹çš„æ§ä»¶ï¼Œå¯ä»¥é€šè¿‡setCheckedæ¥è®©å¯¹åº”çš„itemäº§ç”Ÿå¤é€‰æ¡†æ•ˆæœï¼Œå¾ˆå¤šäººï¼ˆåŒ…æ‹¬æ›¾ç»çš„è‡ªå·±ï¼‰è¯¯ä»¥ä¸ºè¿™å°±æ˜¯å¤é€‰æ¡†æ§ä»¶ï¼Œå…¶å®ä¸æ˜¯çš„ï¼Œä»–æ˜¯å¯¹åº”æ§ä»¶çš„indicatoræŒ‡ç¤ºå™¨ï¼Œæ‰€ä»¥æƒ³è¦æ›´æ¢æ ·å¼ï¼Œä¸èƒ½è¯´è®¾ç½®äº†QCheckBoxçš„æ ·å¼å°±æœ‰æ•ˆæœï¼Œè€Œè¦å•ç‹¬å¯¹é½indicatoræŒ‡ç¤ºå™¨è®¾ç½®æ ·å¼æ‰è¡Œã€‚\n12345678910111213141516171819202122232425262728QCheckBox::indicator,QGroupBox::indicator,QTreeWidget::indicator,QListWidget::indicator&#123;width:13px;height:13px;&#125;QCheckBox::indicator:unchecked,QGroupBox::indicator:unchecked,QTreeWidget::indicator:unchecked,QListWidget::indicator:unchecked&#123;image:url(:/qss/flatwhite/checkbox_unchecked.png);&#125;QCheckBox::indicator:unchecked:disabled,QGroupBox::indicator:unchecked:disabled,QTreeWidget::indicator:unchecked:disabled,QListWidget::indicator:disabled&#123;image:url(:/qss/flatwhite/checkbox_unchecked_disable.png);&#125;QCheckBox::indicator:checked,QGroupBox::indicator:checked,QTreeWidget::indicator:checked,QListWidget::indicator:checked&#123;image:url(:/qss/flatwhite/checkbox_checked.png);&#125;QCheckBox::indicator:checked:disabled,QGroupBox::indicator:checked:disabled,QTreeWidget::indicator:checked:disabled,QListWidget::indicator:checked:disabled&#123;image:url(:/qss/flatwhite/checkbox_checked_disable.png);&#125;QCheckBox::indicator:indeterminate,QGroupBox::indicator:indeterminate,QTreeWidget::indicator:indeterminate,QListWidget::indicator:indeterminate&#123;image:url(:/qss/flatwhite/checkbox_parcial.png);&#125;QCheckBox::indicator:indeterminate:disabled,QGroupBox::indicator:indeterminate:disabled,QTreeWidget::indicator:indeterminate:disabled,QListWidget::indicator:indeterminate:disabled&#123;image:url(:/qss/flatwhite/checkbox_parcial_disable.png);&#125;\n\nå…³äºQTableViewï¼ˆé‡‡ç”¨modelæ•°æ®æºï¼‰ã€QTableWidgetåˆ—ååˆ—å®½è®¾ç½®ï¼Œæœ‰æ—¶å€™å‘ç°æ²¡æœ‰èµ·ä½œç”¨ï¼ŒåŸæ¥æ˜¯å¯¹ä»£ç è®¾ç½®çš„é¡ºåºæœ‰è¦æ±‚ï¼Œæ¯”å¦‚setColumnWidthå‰å¿…é¡»å…ˆsetColumnCountï¼Œä¸ç„¶åˆ—æ•°éƒ½æ²¡æœ‰ï¼Œå“ªæ¥çš„åˆ—å®½ï¼ŒåŒ…æ‹¬setHorizontalHeaderLabelsè®¾ç½®åˆ—æ ‡é¢˜é›†åˆä¹Ÿæ˜¯ï¼Œå‰æéƒ½è¦å…ˆæœ‰åˆ—ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071void frmSimple::initForm()&#123;    //å®ä¾‹åŒ–æ•°æ®æ¨¡å‹    model = new QStandardItemModel(this);    //è®¾ç½®è¡Œæ•°åˆ—æ•°    row = 100;    column = 10;    //è®¾ç½®åˆ—ååˆ—å®½    for (int i = 0; i &lt; column; ++i) &#123;        columnNames &lt;&lt; QString(&quot;åˆ—%1&quot;).arg(i + 1);        columnWidths &lt;&lt; 60;    &#125;&#125;void frmSimple::on_btnLoad1_clicked()&#123;    //å…ˆè®¾ç½®æ•°æ®æ¨¡å‹,å¦åˆ™ setColumnWidth ä¸èµ·ä½œç”¨    ui-&gt;tableView-&gt;setModel(model);    //è®¾ç½®åˆ—æ•°åŠåˆ—æ ‡é¢˜å’Œåˆ—å®½    model-&gt;setColumnCount(column);    //ç®€ä¾¿æ–¹æ³•è®¾ç½®åˆ—æ ‡é¢˜é›†åˆ    model-&gt;setHorizontalHeaderLabels(columnNames);    for (int i = 0; i &lt; column; ++i) &#123;        ui-&gt;tableView-&gt;setColumnWidth(i, columnWidths.at(i));    &#125;    //å¾ªç¯æ·»åŠ è¡Œæ•°æ®    QDateTime now = QDateTime::currentDateTime();    model-&gt;setRowCount(row);    for (int i = 0; i &lt; row; ++i) &#123;        for (int j = 0; j &lt; column; ++j) &#123;            QStandardItem *item = new QStandardItem;            //æœ€åä¸€åˆ—æ˜¾ç¤ºæ—¶é—´åŒºåˆ«å¼€æ¥            if (j == column - 1) &#123;                item-&gt;setText(now.addSecs(i).toString(&quot;yyyy-MM-dd HH:mm:ss&quot;));            &#125; else &#123;                item-&gt;setText(QString(&quot;%1_%2&quot;).arg(i + 1).arg(j + 1));            &#125;            model-&gt;setItem(i, j, item);        &#125;    &#125;&#125;void frmSimple::on_btnLoad2_clicked()&#123;    //è®¾ç½®åˆ—æ ‡é¢˜å’Œåˆ—æ•°åŠåˆ—å®½    ui-&gt;tableWidget-&gt;setColumnCount(column);    //ç®€ä¾¿æ–¹æ³•è®¾ç½®åˆ—æ ‡é¢˜é›†åˆ    ui-&gt;tableWidget-&gt;setHorizontalHeaderLabels(columnNames);    for (int i = 0; i &lt; column; ++i) &#123;        ui-&gt;tableWidget-&gt;setColumnWidth(i, columnWidths.at(i));    &#125;    //æ·»åŠ æ•°æ®    QDateTime now = QDateTime::currentDateTime();    ui-&gt;tableWidget-&gt;setRowCount(row);    for (int i = 0; i &lt; row; ++i) &#123;        for (int j = 0; j &lt; column; ++j) &#123;            QTableWidgetItem *item = new QTableWidgetItem;            //æœ€åä¸€åˆ—æ˜¾ç¤ºæ—¶é—´åŒºåˆ«å¼€æ¥            if (j == column - 1) &#123;                item-&gt;setText(now.addSecs(i).toString(&quot;yyyy-MM-dd HH:mm:ss&quot;));            &#125; else &#123;                item-&gt;setText(QString(&quot;%1_%2&quot;).arg(i + 1).arg(j + 1));            &#125;            ui-&gt;tableWidget-&gt;setItem(i, j, item);        &#125;    &#125;&#125;\n\n20ï¼š191-200\nå…³äºQListé˜Ÿåˆ—çš„å¤„ç†ä¸­ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯è°ƒç”¨appendå‡½æ•°æ·»åŠ itemï¼Œå¾€å‰æ’å…¥itemå¾ˆå¤šäººç¬¬ä¸€å°è±¡å°±æ˜¯è°ƒç”¨insert(0,xxx)æ¥æ’å…¥ï¼Œå…¶å®QListå®Œå…¨æä¾›äº†å¾€å‰è¿½åŠ itemçš„å‡½æ•°prependã€push_frontã€‚\n123456789101112131415161718QStringList list;list &lt;&lt; &quot;aaa&quot; &lt;&lt; &quot;bbb&quot; &lt;&lt; &quot;ccc&quot;;//å¾€åè¿½åŠ  ç­‰ä»·äº appendlist.push_back(&quot;ddd&quot;);//å¾€å‰è¿½åŠ  ç­‰ä»·äº prependlist.push_front(&quot;xxx&quot;);//å¾€åè¿½åŠ list.append(&quot;ddd&quot;);//å¾€å‰è¿½åŠ list.prepend(&quot;xxx&quot;);//æŒ‡å®šç¬¬ä¸€ä¸ªä½ç½®æ’å…¥ ç­‰ä»·äº prependlist.insert(0, &quot;xxx&quot;);//è¾“å‡º QList(&quot;xxx&quot;, &quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;, &quot;ddd&quot;)qDebug() &lt;&lt; list;\n\nQtå†…ç½®äº†ä¸€äº›QListã€QMapã€QHashç›¸å…³çš„ç±»å‹ï¼Œå¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨è‡ªå·±å†™ä¸ªé•¿é•¿çš„ç±»å‹ã€‚\n1234567891011//qwindowdefs.htypedef QList&lt;QWidget *&gt; QWidgetList;typedef QList&lt;QWindow *&gt; QWindowList;typedef QHash&lt;WId, QWidget *&gt; QWidgetMapper;typedef QSet&lt;QWidget *&gt; QWidgetSet;//qmetatype.htypedef QList&lt;QVariant&gt; QVariantList;typedef QMap&lt;QString, QVariant&gt; QVariantMap;typedef QHash&lt;QString, QVariant&gt; QVariantHash;typedef QList&lt;QByteArray&gt; QByteArrayList;\n\nQtçš„å¸ƒå±€çš„è¾¹è·é—´éš”ï¼Œå¦‚æœåœ¨æ²¡æœ‰æ”¹åŠ¨è¿‡çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¼šæ ¹æ®ç³»ç»Ÿåˆ†è¾¨ç‡ä»¥åŠç¼©æ”¾æ¯”æ¥å†³å®šå¯¹åº”çš„é»˜è®¤å€¼ï¼Œæ˜¯å˜åŒ–çš„ï¼Œæ¯”å¦‚åœ¨1080Påˆ†è¾¨ç‡æ˜¯9pxï¼Œåœ¨2Kåˆ†è¾¨ç‡åˆå˜æˆäº†11pxï¼Œæ‰€æœ‰ä½ ä¼šå‘ç°ä½ åœ¨1080Pç”µè„‘ç¼–è¯‘çš„ç¨‹åºï¼Œæ˜æ˜çœ‹åˆ°çš„æ˜¯6pxã€9pxï¼Œæ€ä¹ˆåˆ°2Kã€4Kåˆ†è¾¨ç‡ä¸‹é—´éš”å’Œè¾¹è·å°±å˜å¾—å¥½å¤§ï¼Œå¦‚æœè¦ä¿æŒæ— è®ºä½•ç§åˆ†è¾¨ç‡éƒ½ä¸€æ ·ï¼Œä½ éœ€è¦æ‰‹åŠ¨é‡æ–°è®¾ç½®è¿™äº›å€¼ï¼Œè¿™é‡Œæœ‰ä¸ªå‘ï¼Œæ¯”å¦‚é»˜è®¤æ˜¯æ˜¯9ï¼Œä½ æƒ³å…¶ä»–åˆ†è¾¨ç‡ä¹Ÿæ˜¯9ï¼Œä½ å¿…é¡»å…ˆæŠŠ9æ”¹æˆå…¶ä»–å€¼æ¯”å¦‚10ï¼Œç„¶åå†æ”¹æˆ9ï¼Œè¿™æ ·æ‰è¡¨ç¤ºçœŸçš„æ”¹åŠ¨ï¼Œä½ ç›´æ¥9æ”¹æˆ9æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œåœ¨å±æ€§è®¾è®¡å™¨ä¸­å³ä¾§æœ‰ä¸ªå°ç®­å¤´æ¢å¤å€¼çš„ï¼Œä¹Ÿæ˜¯ç°è‰²ï¼Œåªæœ‰åŠ æ·±æ˜¾ç¤ºï¼Œå¹¶ä¸”å‡ºç°äº†æ¢å¤é»˜è®¤å€¼ç®­å¤´ï¼Œæ‰è¡¨ç¤ºä½ ç¡®å®æ˜¯æ”¹è¿‡äº†å€¼ã€‚\n\nQtå¯¹é«˜åˆ†å±ä»¥åŠdpiç¼©æ”¾çš„æ”¯æŒè¶Šæ¥è¶Šæˆç†Ÿï¼Œåœ¨Qt4æ—¶ä»£é»˜è®¤çš„ç­–ç•¥å°±æ˜¯è·Ÿéšç³»ç»Ÿçš„ç¼©æ”¾ï¼Œä»Qt5.6å¼€å§‹æä¾›äº† AA_EnableHighDpiScaling çš„å±æ€§è®¾ç½®å¼€å¯é«˜åˆ†å±ï¼Œåˆ°äº†5.14ä»¥åè¿˜å¯ä»¥æŒ‡å®šç¼©æ”¾çš„ç­–ç•¥ HighDpiScaleFactorRoundingPolicy æ¯”å¦‚æ”¯æŒæµ®ç‚¹æ•°çš„ç¼©æ”¾æ¯”è€Œä¸æ˜¯ä¹‹å‰çš„æ•´æ•°å€ï¼Œä»Qt6å¼€å§‹é»˜è®¤æ°¸è¿œå¼€å¯äº† AA_EnableHighDpiScaling å±æ€§ï¼Œæ²¡æ³•å–æ¶ˆã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§å°±æ˜¯æ°¸è¿œä¸åº”ç”¨é«˜åˆ†å±åŠç¼©æ”¾ï¼Œä¸€ç§å°±æ˜¯è‡ªåŠ¨åº”ç”¨é«˜åˆ†å±åŠç¼©æ”¾ã€‚\n12345678910111213141516171819202122//æ°¸è¿œä¸åº”ç”¨é«˜åˆ†å±åŠç¼©æ”¾int main(int argc, char *argv[])&#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    QApplication::setAttribute(Qt::AA_Use96Dpi);#endif#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,14,0))    QApplication::setHighDpiScaleFactorRoundingPolicy(Qt::HighDpiScaleFactorRoundingPolicy::Floor);#endif    QApplication a(argc, argv);    ....    return a.exec();&#125;//è‡ªåŠ¨åº”ç”¨é«˜åˆ†å±åŠç¼©æ”¾//æ–¹æ³•å¾ˆå¤šï¼Œç»¼åˆå¯¹æ¯”ä¸‹æ¥è¿˜æ˜¯é‡‡ç”¨é…ç½®æ–‡ä»¶æŒ‡å®šç¼©æ”¾ç­–ç•¥æœ€é€‚ä¸­ã€‚//æ–°å»ºqt.confæ–‡ä»¶æ”¾åˆ°å¯æ‰§è¡Œæ–‡ä»¶åŒä¸€ç›®å½•[Platforms]WindowsArguments = dpiawareness=0//æœ‰æ—¶å€™æƒ³è®©ç”¨æˆ·å»é€‰æ‹©ä½•ç§ç­–ç•¥ï¼Œéœ€è¦å¼€å¯é«˜åˆ†å±çš„ä¹‹ååªéœ€è¦å°†qt.confæ–‡ä»¶æ”¾åˆ°å¯æ‰§è¡Œæ–‡ä»¶åŒä¸€ç›®å½•å³å¯ï¼Œå°±ç®—ä»£ç ä¸­è®¾ç½®äº†ä¸åº”ç”¨é«˜åˆ†å±åŠç¼©æ”¾ï¼Œä¹Ÿæ— æ•ˆï¼Œä¹Ÿæ˜¯ä¼˜å…ˆå–qt.confæ–‡ä»¶çš„ç­–ç•¥ã€‚\n\nå…³äºQSSè¦æ³¨æ„çš„å‘ã€‚\n\n\n\nqssæºè‡ªcssï¼Œç›¸å½“äºcssçš„ä¸€ä¸ªå­é›†ï¼Œä¸»è¦æ”¯æŒçš„æ˜¯css2æ ‡å‡†ï¼Œå¾ˆå¤šç½‘ä¸Šçš„css3çš„æ ‡å‡†çš„å†™æ³•åœ¨qssè¿™é‡Œæ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥ä¸è¦å¤§æƒŠå°æ€ªã€‚\nqssä¹Ÿä¸æ˜¯å®Œå…¨æ”¯æŒæ‰€æœ‰çš„css2ï¼Œæ¯”å¦‚text-alignå®˜æ–¹æ–‡æ¡£å°±æœ‰è¯´æ˜ï¼Œåªæ”¯æŒ QPushButton and QProgressBarï¼ŒåŠ¡å¿…çœ‹æ¸…æ¥šã€‚\næœ‰æ—¶å€™å·æ‡’ç›´æ¥æ¥ä¸€å¥ *{xxx}ï¼Œä½ ä¼šå‘ç°å¤§éƒ¨åˆ†æ˜¯åº”ç”¨äº†ï¼Œä¹Ÿæœ‰å°éƒ¨åˆ†æˆ–è€…æä¸ªåˆ«æ²¡æœ‰åº”ç”¨ï¼Œä½ å¯èƒ½éœ€è¦åœ¨å¯¹åº”çš„çª—ä½“ä¸­ this-&gt;setStyleSheet() æ¥è®¾ç½®ã€‚\nqssçš„æ‰§è¡Œæ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçˆ¶å¯¹è±¡ï¼Œåˆ™å¯¹æ‰€æœ‰çš„åº”ç”¨ï¼Œæ¯”å¦‚åœ¨çª—ä½“widgetä¸­ {color:#ff0000;} è¿™æ ·ä¼šå¯¹widgetä»¥åŠwidgetçš„æ‰€æœ‰å­å¯¹è±¡åº”ç”¨è¯¥æ ·å¼ï¼Œè¿™ç§é—®é¢˜å„å¤§ç¾¤æ¯å‘¨éƒ½æœ‰äººé—®ï¼Œä½ ä¼šå‘ç°å„ç§å¥‡å¥‡æ€ªæ€ªçš„å¼‚æ ·ä¸æ­£å¸¸ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œä½ éœ€è¦æŒ‡å®šç±»åæˆ–è€…å¯¹è±¡åï¼Œæ¯”å¦‚ #widget{color:#ff0000;} è¿™æ ·å°±åªä¼šå¯¹widgetå¯¹è±¡åº”ç”¨è¯¥æ ·å¼ï¼Œå¦ä¸€ç§å†™æ³• QWidget#widget{color:#ff0000;}ï¼Œåªæƒ³å¯¹çª—ä½“æœ¬èº«è€Œä¸æ˜¯å­æ§ä»¶æŒ‰é’®æ ‡ç­¾ç­‰ .QWidget{color:#ff0000;} ï¼Œå…·ä½“è¯¦ç»†è§„åˆ™å‚è§å®˜æ–¹è¯´æ˜ã€‚\nqssæ•´ä½“æ¥è¯´è¿˜æ˜¯å¯ä»¥çš„ï¼Œè§£æé€Ÿåº¦æ€§èƒ½åœ¨Qt5é«˜ç‰ˆæœ¬åæœŸæ¯”Qt4å¥½å¾ˆå¤šï¼Œå°¤å…¶æ˜¯ä¿®å¤äº†ä¸å°‘qssä¸­çš„è§£æç»˜åˆ¶BUGã€‚å°½ç®¡æœ‰è¿™æ ·é‚£æ ·çš„BUGï¼Œæ€€ç€åŒ…å®¹çš„å¿ƒå¯¹å¾…å®ƒã€‚\nqsså®˜æ–¹å­¦ä¹ åœ°å€1ï¼šhttp://47.100.39.100/qtwidgets/stylesheet-reference.html\nqsså®˜æ–¹å­¦ä¹ åœ°å€2ï¼šhttp://47.100.39.100/qtwidgets/stylesheet-examples.html\n\n\nå…³äºQtå»¶æ—¶çš„å‡ ç§æ–¹æ³•ã€‚\n123456789101112131415161718192021222324void QUIHelperCore::sleep(int msec)&#123;    if (msec &lt;= 0) &#123;        return;    &#125;#if 1    //éé˜»å¡æ–¹å¼å»¶æ—¶,ç°åœ¨å¾ˆå¤šäººæ¨èçš„æ–¹æ³•    QEventLoop loop;    QTimer::singleShot(msec, &amp;loop, SLOT(quit()));    loop.exec();#else#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    //é˜»å¡æ–¹å¼å»¶æ—¶,å¦‚æœåœ¨ä¸»çº¿ç¨‹ä¼šå¡ä½ä¸»ç•Œé¢    QThread::msleep(msec);#else    //éé˜»å¡æ–¹å¼å»¶æ—¶,ä¸ä¼šå¡ä½ä¸»ç•Œé¢,æ®è¯´å¯èƒ½æœ‰é—®é¢˜    QTime endTime = QTime::currentTime().addMSecs(msec);    while (QTime::currentTime() &lt; endTime) &#123;        QCoreApplication::processEvents(QEventLoop::AllEvents, 100);    &#125;#endif#endif&#125;\n\néšç€å›½äº§åŒ–çš„å…´èµ·ï¼Œå„ç§å›½äº§ç³»ç»Ÿå’Œå›½äº§æ•°æ®åº“ç­‰é€æ¸è¿›å…¥å¼€å‘è€…çš„ä¸–ç•Œï¼Œç½—åˆ—å‡ ä¸ªè¦ç‚¹ã€‚\n\n\n\nä¸­æ ‡éº’éºŸneokylinåŸºäºcentosã€‚\né“¶æ²³éº’éºŸkylinæ—©æœŸç‰ˆæœ¬æ¯”å¦‚V2åŸºäºfreebsdï¼Œæ–°ç‰ˆæœ¬V4ã€V10åŸºäºubuntuã€‚\nä¼˜éº’éºŸubuntukylinå°±æ˜¯ubuntuçš„æ±‰åŒ–ç‰ˆæœ¬ï¼ŒåŠ äº†ç‚¹å†œå†æ§ä»¶å•¥çš„ã€‚\ndeepinåŸºäºdebianã€‚\nuosåŸºäºdeepinæˆ–è€…è¯´æ˜¯deepinçš„å•†ä¸šåˆ†æ”¯ã€‚\nubuntuåŸºäºdebianã€‚\nlinuxç•Œä¸»è¦åˆ†ä¸¤ç§å‘è¡Œç‰ˆæœ¬ï¼Œdebianï¼ˆubuntuã€deepinã€uosã€é“¶æ²³éº’éºŸkylinç­‰ï¼‰å’Œredhatï¼ˆfedoraã€centosã€ä¸­æ ‡éº’éºŸneokylinã€ä¸­å…´æ–°æ”¯ç‚¹newstartç­‰ï¼‰ï¼Œåˆ†åˆ«å¯¹åº”apt-getå’Œyumå®‰è£…å‘½ä»¤ã€‚ç»å¤§éƒ¨åˆ†çš„linuxç³»ç»Ÿéƒ½åŸºäºæˆ–è€…è¡ç”Ÿè‡ªè¿™ä¸¤ç§å‘è¡Œç‰ˆæœ¬ã€‚\nç†è®ºä¸ŠåŸºäºåŒä¸€ç§ç³»ç»Ÿå†…æ ¸çš„ï¼Œåœ¨å…¶ä¸Šç¼–è¯‘çš„ç¨‹åºå¯ä»¥æ¢åˆ°å¦å¤–çš„ç³»ç»Ÿè¿è¡Œï¼Œå‰ææ˜¯ç¼–è¯‘å™¨ç‰ˆæœ¬ä¸€è‡´ï¼Œæ¯”å¦‚éƒ½æ˜¯gcc4.9ï¼Œåœ¨ubuntu14.04 64ä½ç”¨gcc4.9ç¼–è¯‘çš„Qtç¨‹åºï¼Œæ˜¯èƒ½å¤Ÿåœ¨uos 64ä½ä¸Šè¿è¡Œçš„ã€‚\né«˜ç‰ˆæœ¬ç¼–è¯‘å™¨çš„ç³»ç»Ÿä¸€èˆ¬èƒ½å¤Ÿå…¼å®¹ä½ç‰ˆæœ¬çš„ï¼Œæ¯”å¦‚ä½ ç”¨gcc4.9ç¼–è¯‘çš„ç¨‹åºæ˜¯èƒ½å¤Ÿåœ¨gcc7.0ä¸Šè¿è¡Œï¼Œåè¿‡æ¥ä¸è¡Œã€‚\næ„å‘³ç€å¦‚æœä½ æƒ³å°½å¯èƒ½å…¼å®¹æ›´å¤šçš„ç³»ç»Ÿï¼Œå°½é‡ç”¨ä½ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ç¼–è¯‘ä½ çš„ç¨‹åºï¼Œå½“ç„¶è¦ä½ çš„ç¨‹åºä»£ç è¯­æ³•æ”¯æŒï¼Œæ¯”å¦‚c++11å°±è¦ä»gcc4.7å¼€å§‹æ‰æ”¯æŒï¼Œå¦‚æœä½ çš„ä»£ç ç”¨äº†c++11åˆ™å¿…é¡»è‡³å°‘é€‰æ‹©gcc4.7ç‰ˆæœ¬åŠä»¥ä¸Šã€‚\nç”¨Qtç¼–å†™linuxç¨‹åºä¸ºäº†å‘å¸ƒåçš„å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥å…¼å®¹å„ç§linuxç³»ç»Ÿï¼Œåªè¦åœ¨è¿™ä¸¤ç§å†…æ ¸ï¼ˆdebianã€redhatï¼‰çš„ç³»ç»Ÿä¸Šç”¨ä½ç‰ˆæœ¬çš„ç¼–è¯‘å™¨æ¯”å¦‚gcc4.7ç¼–è¯‘qtç¨‹åºå‘å¸ƒå³å¯ã€‚\n2022-01-27è¡¥å……ï¼šæ ¹æ®Qtå®˜æ–¹å®‰è£…åŒ…ï¼ˆå…³äºå¯¹è¯æ¡†ï¼‰ï¼Œå‘ç°åŸºäºredhatå’Œgcc4.9ï¼ˆåé¢Qt5.14&#x2F;5.15å¸¦çš„qtcé‡‡ç”¨gcc5.3ï¼‰ç¼–è¯‘å™¨å‘å¸ƒçš„ï¼Œé€šç”¨å„ç§linuxç³»ç»Ÿï¼ˆäº²æµ‹ubuntuå„ä¸ªç‰ˆæœ¬ã€fedoraã€centosã€deepinã€uosã€é“¶æ²³éº’éºŸkylinã€ä¸­æ ‡éº’éºŸneokylinã€ä¸­å…´æ–°æ”¯ç‚¹newstartç­‰ï¼‰ï¼Œè‡ªå·±æŒ‰ç…§è¿™ä¸ªç‰ˆæœ¬ä¹Ÿäº²æµ‹æ‰“åŒ…å‘å¸ƒäº†ï¼Œäº²æµ‹å¯ç”¨ï¼Œæˆ‘æ“¦ï¼Œredhatç³»ç»Ÿçš„ä¹Ÿå¯ä»¥åœ¨debianç³»ç»Ÿè·‘ã€‚\n2022-02-10è¡¥å……ï¼šdebianä¸Šé™æ€ç¼–è¯‘çš„ç¨‹åºä¹Ÿå¯ä»¥åœ¨redhatç³»ç»Ÿè·‘ï¼Œå¯èƒ½é™æ€ç¼–è¯‘å»æ‰äº†å¾ˆå¤šä¾èµ–å§ã€‚\n2022-03-01è¡¥å……ï¼šä½è°ƒå¤§ä½¬è¡¥å……ï¼Œå¦‚æœæ²¡æœ‰ç‰¹å®šçš„ä¾èµ–å…³ç³»ï¼Œé«˜ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ç¼–è¯‘çš„ç¨‹åºä¹Ÿå¯ä»¥åœ¨ä½ç‰ˆæœ¬ç¼–è¯‘å™¨çš„ç³»ç»Ÿè¿è¡Œï¼Œæ¯”å¦‚alpine Linuxä¸‹ç”¨gcc11&#x2F;clang13ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡ŒäºŒè¿›åˆ¶ï¼Œä¾ç„¶å¯ä»¥åœ¨cenos5&#x2F;ubuntu10ä¸Šè¿è¡Œã€‚å¹¶ä¸æ˜¯ç¼–è¯‘å™¨ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä¹Ÿä¸æ˜¯C++11ç‰¹æ€§çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°å¤ªå¤šï¼Œå†…æ ¸ç‰ˆæœ¬ã€gnu libcã€ABIå…¼å®¹ç­‰ç­‰ï¼Œä¸¤å¥è¯è¯´ä¸æ¸…ã€‚\næŒ‰ç…§QtCreatorè½¯ä»¶é‡‡ç”¨çš„ç¼–è¯‘å™¨ç¯å¢ƒè§„åˆ™ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯ä½ç‰ˆæœ¬çš„å¯ä»¥åœ¨é«˜ç‰ˆæœ¬è¿è¡Œï¼Œæ¯”å¦‚Qt5å¯ä»¥åœ¨ubuntu14&#x2F;16&#x2F;18&#x2F;20è¿è¡Œï¼Œä½†æ˜¯é«˜ç‰ˆæœ¬ç¼–è¯‘å™¨ç¼–è¯‘çš„å°±æ— æ³•åœ¨ä½ç‰ˆæœ¬ç¼–è¯‘å™¨ç³»ç»Ÿè¿è¡Œï¼Œä¼šæç¤ºç¼ºå°‘GLBCã€LIBCXXã€symbol xxxxxxç­‰ï¼Œæ¯”å¦‚Qt6å¯ä»¥åœ¨ubuntu20è¿è¡Œè€Œæ— æ³•åœ¨ubuntu18&#x2F;16&#x2F;14ç­‰è¿è¡Œã€‚\nåœ¨uosä¸Šåšå¼€å‘ï¼Œå»ºè®®é‡‡ç”¨ç³»ç»Ÿè‡ªå¸¦çš„Qtåº“ç¯å¢ƒå¼€å‘ï¼Œä»¥åŠå‘½ä»¤è¡Œå®‰è£…å¼€å‘ç¯å¢ƒï¼Œä¸å»ºè®®ä½¿ç”¨Qtå®˜æ–¹çš„å®‰è£…åŒ…æ­å»ºç¯å¢ƒï¼Œå› ä¸ºuosçš„Qtæ˜¯é­”æ”¹è¿‡çš„ï¼Œç”¨Qtå®˜æ–¹çš„æ ‡å‡†å®‰è£…åŒ…çš„ç¯å¢ƒå¼€å‘å‡ºæ¥çš„ç¨‹åºï¼Œæ‰“åŒ…å‘å¸ƒå¾ˆå¯èƒ½ä¼šæœ‰ä¾èµ–é—®é¢˜è€Œæ— æ³•è¿è¡Œï¼Œè€Œç”¨ç³»ç»Ÿè‡ªå¸¦çš„å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚\nå›½äº§äººå¤§é‡‘ä»“æ•°æ®åº“ç”¨çš„æ˜¯postgresqlæ•°æ®åº“æ”¹çš„ï¼Œæ„å‘³ç€ä½ åœ¨Qtä¸­ç”¨postgresqlæ•°æ®åº“æ’ä»¶ä¹Ÿæ˜¯èƒ½å¤Ÿè¿æ¥åˆ°äººå¤§é‡‘ä»“æ•°æ®åº“çš„ã€‚\nä»¥ä¸Šæœªå¿…å®Œå…¨æ­£ç¡®ï¼Œæ¬¢è¿å„ä½æŒ‡æ­£ã€‚\n\n\nçºµè§‚Qtçš„å‘å±•å†å²ï¼Œä¹Ÿå‡ ä¹ç»å†ç€åˆä¹…å¿…åˆ†ã€åˆ†ä¹…å¿…åˆçš„é€»è¾‘ï¼Œæ¯”å¦‚æœ€å¼€å§‹QPushButtonç­‰UIæ§ä»¶ç±»éƒ½æ˜¯åœ¨QtGuiæ¨¡å—ä¸­ï¼Œåé¢è¶Šå‘è‡ƒè‚¿ä¸æ–¹ä¾¿ç®¡ç†å’Œå‡çº§è¿­ä»£ï¼Œåˆåˆ†ç¦»å‡ºä¸€ä¸ªQtWidgetsæ¨¡å—ï¼›åˆ°Qt6åˆå°†QListå’ŒQVectoråˆå¹¶äº†æˆäº†ä¸€ä¸ªç±»ï¼Œæå¾—åƒåˆ†ä¹…å¿…åˆï¼›è€Œä¸”ä¸€äº›æ•°å­¦å‡½æ•°ä»¥åŠå°è£…çš„c++æ ‡å‡†å‡½æ•°åº“çš„æ–¹æ³•ï¼Œé€æ¸æ”¾å¼ƒäº†Qtè‡ªå·±çš„å°è£…æ”¹ç”¨c++æ ‡å‡†å‡½æ•°åº“ï¼Œä»å¼€å§‹çš„åˆ†åˆ°ç°åœ¨çš„åˆç»Ÿä¸€ã€‚\n\nQtä¸€ç›´åœ¨æŒç»­å‡çº§è¿­ä»£ï¼Œå°½ç®¡æ–°å¢åŠ çš„ä»£ç è´¨é‡æ˜æ˜¾ä¸å¦‚è¯ºåŸºäºšæ—¶ä»£ï¼Œä½†æœ€èµ·ç æœ‰è¡ŒåŠ¨ï¼Œæ…¢æ…¢å®Œå–„ã€‚ç›®å‰ä¸»è¦çš„å‡çº§æ”¹å–„åœ¨qmlæ¨¡å—ï¼Œåº•å±‚ä¹Ÿæœ‰å®Œå–„ï¼Œæ¯•ç«Ÿæ— è®ºæ˜¯widgetè¿˜æ˜¯qmléƒ½æ˜¯å…¬ç”¨ä¸€å¥—åº•å±‚é€»è¾‘ç±»ï¼Œåº•å±‚åŸºç¡€ä¸€å®šè¦æ‰å®ç¨³å›ºï¼Œä¸ªäººè¿™å‡ å¹´ä¸€ç›´å¯¹æ¯”æµ‹è¯•è¿‡ä¸åŒQtç‰ˆæœ¬ï¼ˆä»æ—§ç‰ˆæœ¬åˆ°æ–°ç‰ˆæœ¬ï¼‰å¾ˆå¤šç±»å’Œå‡½æ•°çš„æ€§èƒ½ï¼Œå‘ç°å®˜ç½‘åˆ—å‡ºæ¥çš„æ–°ç‰ˆæœ¬å¯¹åº”ç±»å’Œæ–¹æ³•çš„æ€§èƒ½æå‡æ”¹å–„ï¼Œç¡®å®æ²¡æœ‰è¯´è°ï¼Œè‡³äºæå‡äº†å¤šå°‘è¿™å—æœ‰æ²¡æœ‰å¹ç‰›é€¼é‚£å°±ä¸æ¸…æ¥šã€‚\n\n\n\nbase64ç®—æ³•æ€§èƒ½æå‡å¾ˆå¤§ã€‚\nQStringListç­‰å‡¡æ˜¯ä½¿ç”¨äº†QListç›¸å…³çš„ç±»ï¼Œæ€§èƒ½æå‡å·¨å¤§ã€‚\nå¯¹æ¯”æµ‹è¯•å¤§æ¦‚ä»5.12ç‰ˆæœ¬å¼€å§‹QStringListå’ŒQMapæ€§èƒ½ç›¸å½“ã€‚\næ—©æœŸç‰ˆæœ¬QStringListå¦‚æœæŸ¥æ‰¾çš„å€¼å…ˆæ’å…¥åˆ™æ—¶é—´è¶ŠçŸ­ï¼ŒQMapåˆ™æ²¡æœ‰è¿™ä¸ªåŒºåˆ«ã€‚12345678910111213141516171819202122232425262728293031QStringList list1, list2;QMap&lt;QString, QString&gt; map;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent)    , ui(new Ui::MainWindow)&#123;    ui-&gt;setupUi(this);    for (int i = 0; i &lt; 100000; ++i) &#123;        QString s1 = QString(&quot;%1&quot;).arg(i);        QString s2 = QString(&quot;A%1&quot;).arg(i);        list1 &lt;&lt; s1;        list2 &lt;&lt; s2;        map.insert(s1, s2);    &#125;&#125;void MainWindow::on_pushButton_clicked()&#123;    QElapsedTimer time;    time.start();    qDebug() &lt;&lt; &quot;111&quot; &lt;&lt; time.nsecsElapsed() &lt;&lt; list2.at(list1.indexOf(&quot;9999&quot;));&#125;void MainWindow::on_pushButton_2_clicked()&#123;    QElapsedTimer time;    time.start();    qDebug() &lt;&lt; &quot;222&quot; &lt;&lt; time.nsecsElapsed() &lt;&lt; map.value(&quot;9999&quot;);&#125;\n\n\nå…³äºQtCreatorä¸­ä¸‰ç§ä¸åŒç¼–è¯‘ç‰ˆæœ¬ debugã€releaseã€profile çš„åŒºåˆ«ã€‚\n\n\ndebugè°ƒè¯•æ¨¡å¼ï¼Œç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶å¾ˆå¤§ï¼Œå¸¦äº†å¾ˆå¤šè°ƒè¯•ç¬¦å·ä¿¡æ¯ç­‰ï¼Œæ–¹ä¾¿å¼€å‘é˜¶æ®µè°ƒè¯•çš„æ—¶å€™è¿›å…¥å…·ä½“çš„å †æ ˆæŸ¥çœ‹å€¼ã€‚ä¼šæ‰“å¼€æ‰€æœ‰çš„æ–­è¨€ï¼Œè¿è¡Œé˜¶æ®µæ€§èƒ½å·®é€Ÿåº¦æ…¢ï¼Œå¯èƒ½ä¼šæœ‰å¡é¡¿æ„Ÿè§‰ã€‚\nreleaseå‘å¸ƒæ¨¡å¼ï¼Œç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶å¾ˆå°ï¼Œä¸å¸¦ä»»ä½•è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œä¸€èˆ¬ç”¨äºæ‰“åŒ…å‘å¸ƒç¨‹åºã€‚ç”±äºç»è¿‡äº†å„ç§ä¼˜åŒ–ï¼Œä¼šå…³é—­æ‰€æœ‰æ–­è¨€ï¼Œè¿è¡Œé˜¶æ®µæ€§èƒ½æœ€å¥½ï¼Œå¦‚æœæœ‰å¡é¡¿é‚£è‚¯å®šæ˜¯ä½ çš„ç¨‹åºé—®é¢˜ã€‚\nprofileæ¦‚è¿°æ¨¡å¼ï¼Œç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶æ¯”debugå°å¾ˆå¤šæ¯”releaseå¤§ä¸€ç‚¹ï¼Œå¸¦æœ‰éƒ¨åˆ†è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œåœ¨debugå’Œreleaseä¹‹é—´å–ä¸€ä¸ªå¹³è¡¡ï¼Œå…¼é¡¾æ€§èƒ½å’Œè°ƒè¯•ï¼Œæ€§èƒ½æ›´ä¼˜ä½†æ˜¯åˆæ–¹ä¾¿è°ƒè¯•ã€‚\nä½¿ç”¨Qt5.7ç‰ˆæœ¬å¯¹åº”ä¸‰ç§æ¨¡å¼ç¼–è¯‘çš„ç©ºç™½çª—ä½“ç¨‹åºå¤§å°ï¼šdebugï¼ˆ1319kbï¼‰ã€releaseï¼ˆ24kbï¼‰ã€profileï¼ˆ90kbï¼‰ã€‚\ndebugé“¾æ¥çš„åº“æ˜¯å¸¦dç»“å°¾çš„ï¼Œreleaseå’Œprofileé“¾æ¥çš„åº“æ˜¯ä¸å¸¦dç»“å°¾çš„ï¼Œå¾ˆå¤šäººä»¥ä¸ºprofileé“¾æ¥çš„æ˜¯å¸¦dç»“å°¾çš„å…¶å®æ˜¯é”™è¯¯çš„ã€‚\næ–°çš„Qtåœ¨çº¿å®‰è£…ç¨‹åºåœ¨å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥å‹¾é€‰æ˜¯å¦å®‰è£…debugè°ƒè¯•åº“ï¼ˆå¯¹åº”libç›®å½•ä¸‹ä¸€å †å¸¦dç»“å°¾çš„æ–‡ä»¶ï¼‰ï¼Œä»¥å‰çš„ç‰ˆæœ¬æ˜¯é»˜è®¤éƒ½å®‰è£…ï¼Œç°åœ¨å¯é€‰å®‰è£…ä»¥ä¾¿å‡å°‘ä½“ç§¯ã€‚\næ— è®ºæ˜¯å¦å®‰è£…äº†debugè°ƒè¯•åº“ï¼Œä½ éƒ½å¯ä»¥é€‰æ‹©debugæ¨¡å¼ç”Ÿæˆå¯¹åº”debugçš„æ–‡ä»¶ï¼Œè¿™ä¸ªä¸çŸ¥é“æ€ä¹ˆåšåˆ°çš„ã€‚\næ— è®ºæ˜¯å“ªç§æ¨¡å¼ï¼Œéƒ½å¯ä»¥åœ¨ç¨‹åºä¸­å¼€å¯æ—¥å¿—é’©å­è¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼Œæ–¹ä¾¿æ”¶é›†è¿è¡Œé˜¶æ®µçš„å„ç§ä¿¡æ¯åé¦ˆç»™å¼€å‘äººå‘˜æŸ¥çœ‹é—®é¢˜ã€‚\næœ€åˆçš„å¼€å‘å·¥å…·ä¸€èˆ¬æ˜¯å…·æœ‰debugå’Œreleaseä¸¤ç§æ¨¡å¼ï¼Œéšç€ç”¨æˆ·éœ€æ±‚çš„å¢åŠ å’Œåœºæ™¯çš„éœ€è¦ï¼Œéƒ¨åˆ†å¼€å‘å·¥å…·è¡ç”Ÿå‡ºäº†profileæ¨¡å¼ï¼Œæ›´æœ‰ç”šè€…æ¯”å¦‚flutterè¿˜æœ‰ç¬¬å››ç§testæ¨¡å¼ã€‚\n\n21ï¼š201-210\nç¼–è¯‘ç”Ÿæˆdebugç‰ˆæœ¬åŠ¨æ€åº“ï¼Œæ–‡ä»¶æœ«å°¾è‡ªåŠ¨åŠ ä¸Šdç»“å°¾ã€‚\n12345CONFIG(debug, debug|release) &#123;    win32:      TARGET = $$join(TARGET,,,d)    mac:        TARGET = $$join(TARGET,,,_debug)    unix:!mac:  TARGET = $$join(TARGET,,,d)&#125;\n\nQtCreatorä¸­proé¡¹ç›®æ–‡ä»¶æ ¼å¼è¯´æ˜ã€‚\n\n\n\n\n\nåç§°\nè¯´æ˜\n\n\n\nQT +&#x3D; core gui\næ·»åŠ æœ¬é¡¹ç›®ä¸­éœ€è¦çš„æ¨¡å—ï¼Œå½±å“åé¢ä»£ç æ–‡ä»¶includeçš„æ—¶å€™è‡ªåŠ¨å¼¹å‡ºä¸‹æ‹‰é€‰æ‹©ï¼Œå¦‚æœproæ–‡ä»¶æ²¡æœ‰å¼•å…¥è¯¥æ¨¡å—åˆ™æ— æ³•è‡ªåŠ¨è¯­æ³•æç¤ºï¼Œä¸€èˆ¬æ‰“åŒ…å‘å¸ƒçš„æ—¶å€™å¯¹åº”åŠ¨æ€åº“æ–‡ä»¶æ¯”å¦‚ Qt5Core.dllã€‚\n\n\nTARGET &#x3D; xxx\nç”Ÿæˆæœ€åç›®æ ‡æ–‡ä»¶çš„åå­—ï¼Œå¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…åº“æ–‡ä»¶ã€‚\n\n\nTEMPLATE &#x3D; app\né¡¹ç›®ç¨‹åºçš„ç”Ÿæˆæ¨¡å¼ï¼Œé»˜è®¤æ˜¯appè¡¨ç¤ºç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ç¨‹åºï¼Œå¦‚æœæ˜¯åŠ¨æ€åº“é¡¹ç›®å°±æ˜¯ TEMPLATE &#x3D; libã€‚\n\n\nCONFIG +&#x3D; qaxcontainer\nå¼•å…¥ä¸€äº›é…ç½®ï¼Œåœ¨Qt4çš„æ—¶å€™è¿˜ç”¨æ¥å¼•å…¥ä¸€äº›æ¨¡å—ï¼Œå…¶ä¸­æœ‰éƒ¨åˆ†æ”¹æˆäº†QT +&#x3D; æ–¹å¼å¼•å…¥ï¼Œæ¯”å¦‚Qt5å¼•å…¥æœ¬åœ°activexæ§ä»¶æ”¯æŒæ”¹æˆäº†QT +&#x3D; qaxcontainerã€‚\n\n\nDEFINES +&#x3D; xxx\né¡¹ç›®ä¸­è‡ªå®šä¹‰çš„ä¸€äº›å®šä¹‰ï¼Œå¯ä»¥åœ¨ä»£ç æ–‡ä»¶ä¸­è¯†åˆ«ï¼Œé€šå¸¸ç”¨æ¥å®šä¹‰ä¸€äº›ä¸åŒå¹³å°çš„å¤„ç†ï¼Œæ ¹æ®é¡¹ç›®éœ€è¦è‡ªå·±å®šä¹‰ä»»ä½•æ ‡è¯†ã€‚\n\n\nHEADERS +&#x3D; head.h\né¡¹ç›®ä¸­ç”¨åˆ°çš„å¤´æ–‡ä»¶ï¼Œä¸€èˆ¬æ‹“å±•åæ˜¯.hï¼Œå¯ä»¥å†™åœ¨ä¸€è¡Œä¹Ÿå¯ä»¥åˆ†è¡Œå†™ï¼Œåˆ†è¡Œè¦ç”¨ \\ æ–œæ ç»“æŸã€‚\n\n\nSOURCES +&#x3D; main.cpp\né¡¹ç›®ä¸­ç”¨åˆ°çš„å®ç°æ–‡ä»¶ï¼Œä¸€èˆ¬æ‹“å±•åæ˜¯.cppï¼Œå¯ä»¥å†™åœ¨ä¸€è¡Œä¹Ÿå¯ä»¥åˆ†è¡Œå†™ï¼Œåˆ†è¡Œè¦ç”¨ \\ æ–œæ ç»“æŸã€‚\n\n\nFORMS +&#x3D; Form.ui\né¡¹ç›®ä¸­ç”¨åˆ°çš„UIæ–‡ä»¶ï¼Œä¸€èˆ¬æ‹“å±•åæ˜¯.uiï¼Œå¯ä»¥å†™åœ¨ä¸€è¡Œä¹Ÿå¯ä»¥åˆ†è¡Œå†™ï¼Œåˆ†è¡Œè¦ç”¨ \\ æ–œæ ç»“æŸã€‚\n\n\nRESOURCES +&#x3D; main.qrc\né¡¹ç›®ä¸­ç”¨åˆ°çš„èµ„æºæ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªï¼Œå†™ä»£ç ä½¿ç”¨å¯¹åº”èµ„æºæ–‡ä»¶ä¸­çš„æ–‡ä»¶æ—¶å€™åŠ¡å¿…è®°å¾—èµ„æºæ–‡ä»¶ä¸­çš„å‰ç¼€ã€‚\n\n\nLIBS +&#x3D; -L$$PWD&#x2F; -lavformat -lavcodec\né¡¹ç›®ä¸­ç¼–è¯‘æ—¶å€™é“¾æ¥ä¾èµ–çš„åº“ï¼Œä¸€èˆ¬æ˜¯ .lib .a .dylib æ–‡ä»¶ï¼Œå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œçœç•¥æ–‡ä»¶åçš„libæ‰“å¤´éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥åˆ†å¤šè¡Œç»å¯¹è·¯å¾„å’Œå…¨åç§°ã€‚\n\n\nDESTDIR +&#x3D; $$PWD&#x2F;bin\nç›®æ ‡ç”Ÿæˆè·¯å¾„ï¼Œ$$PWDè¡¨ç¤ºå½“å‰ç›®å½•ï¼Œä¸€èˆ¬å»ºè®®ç”Ÿæˆçš„æœ€ç»ˆæ–‡ä»¶é‡å®šå‘åˆ°å¦å¤–ç›®å½•å­˜æ”¾ï¼Œå¥½æ‰¾ï¼Œä¸ç„¶ä¸€å †ä¸´æ—¶æ–‡ä»¶åœ¨é‡Œé¢æœ‰æ—¶å€™æ–‡ä»¶å¤ªå¤šå¥½éš¾æ‰¾ã€‚\n\n\nINCLUDEPATH +&#x3D; $$PWD&#x2F;include\nå·¥ç¨‹éœ€è¦çš„å¤´æ–‡ä»¶ï¼ŒæŒ‡å®šæ•´ä¸ªç›®å½•ï¼Œå†™ä»£ç çš„æ—¶å€™æ‰¾åˆ°çš„è¯ä¼šè‡ªåŠ¨ä¸‹æ‹‰ã€‚\n\n\nDEPENDPATH +&#x3D;\nå·¥ç¨‹çš„ä¾èµ–è·¯å¾„ï¼Œç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¸€èˆ¬æ¶‰åŠåˆ°å¼•å…¥é“¾æ¥åº“çš„æ—¶å€™å¯èƒ½éœ€è¦ã€‚\n\n\ninclude($$PWD&#x2F;3rd.pri)\nå¼•å…¥priæ¨¡å—æ–‡ä»¶ï¼Œpriæœ€å¤§çš„å¥½å¤„å°±æ˜¯åˆ†ç›®å½•ç®¡ç†æ–‡ä»¶ï¼Œé€šç”¨çš„è½®å­æ¨¡å—å¯ä»¥æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶åç”¨priç»Ÿä¸€ç®¡ç†ï¼Œå¯ä»¥ç»™å¤šä¸ªé¡¹ç›®å…¬ç”¨ã€‚\n\n\nå®˜æ–¹è¯¦ç»†åœ°å€https://doc.qt.io/qt-5/qmake-variable-reference.html\n\nå¦‚æœå‘ç°ä¹‹å‰ç¼–è¯‘æ­£å¸¸ï¼Œçªç„¶ä¹‹é—´å†ç¼–è¯‘å°±ä¸€ç›´æ­»å¾ªç¯çš„æ ·å­ï¼Œåœç•™åœ¨ä¸€è¡Œæç¤ºå¹¶ç–¯ç‹‚ä¸åœçš„æ‰“å°ï¼Œæˆ–è€…æç¤ºæ–‡ä»¶æ—¶é—´åœ¨æœªæ¥ï¼Œè¿™è¯´æ˜ä½ å¾ˆå¯èƒ½æ”¹è¿‡å¼€å‘ç¯å¢ƒçš„æ—¶é—´ï¼ˆæ¯”å¦‚æµ‹è¯•æŸä¸ªæˆæƒæ–‡ä»¶å¤±æ•ˆï¼‰ï¼Œå¯¼è‡´æœ‰ä¿®æ”¹è¿‡æ–‡ä»¶çš„ä¿å­˜æ—¶é—´åœ¨æœªæ¥ï¼Œä½ åªéœ€è¦å°†æ—¶é—´è°ƒæ•´å›æ¥ï¼Œå°†æœ€åæ›´æ–°æ—¶é—´ä¸æ­£ç¡®çš„ä»£ç æ–‡ä»¶é‡æ–°ä¿å­˜ä¸‹å°±è¡Œã€‚Qtçš„å¢é‡ç¼–è¯‘æ˜¯æ ¹æ®æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´æ¥åˆ¤å®šçš„ï¼Œæœ€åçš„ä¿®æ”¹æ—¶é—´æ¯”ä¸Šä¸€æ¬¡çš„ä¿®æ”¹æ—¶é—´è¿˜è¦æ–°åˆ™è®¤ä¸ºè¯¥æ–‡ä»¶è¢«ä¿®æ”¹è¿‡ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘è¯¥æ–‡ä»¶ã€‚\n\nQtçš„æ„å»ºå¥—ä»¶ä¸€èˆ¬æ˜¯åœ¨å®‰è£…Qtå¼€å‘ç¯å¢ƒçš„æ—¶å€™è‡ªåŠ¨è®¾ç½®çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼Œæ‰‹åŠ¨è®¾ç½®çš„æ—¶å€™åƒä¸‡è¦æ³¨æ„ç¼–è¯‘å™¨å’ŒQtåº“å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™è¯¥æ„å»ºå¥—ä»¶æ˜¯æœ‰é—®é¢˜çš„ï¼Œåƒä¸‡ä¸èƒ½ä¹±è®¾ç½®ï¼Œå°¤å…¶æ˜¯å¯¹æ„å»ºå¥—ä»¶å‘½åçš„æ—¶å€™æœ€å¥½æ ‡æ˜qtç‰ˆæœ¬å’Œç¼–è¯‘å™¨ç‰ˆæœ¬ï¼Œæœ€å¥½ä¹Ÿè¦ä¸€è‡´ï¼Œä¸è¦è¯´åç§°å«msvcè€Œç¼–è¯‘å™¨é€‰æ‹©çš„ç¡®æ˜¯mingwï¼Œè¿™æ ·å°½ç®¡èƒ½æ­£å¸¸ä½¿ç”¨è¯¥æ„å»ºå¥—ä»¶ï¼Œä½†æ˜¯ä¼šé€ æˆä¸€ç§è¯¯è§£ï¼Œè¿˜ä»¥ä¸ºè¯¥å¥—ä»¶æ˜¯msvcçš„ï¼Œå…¶å®é‡Œé¢æ˜¯mingwçš„ã€‚æœ‰ä¸ªqterè¯´ä»–çš„qtåäº†ï¼Œæ­»æ´»ç¼–è¯‘å¤±è´¥ï¼Œè¿œç¨‹ä¸€çœ‹ï¼Œå°¼ç›ï¼Œæ„å»ºå¥—ä»¶åç§°å†™çš„qt_msvc2019 ç¼–è¯‘å™¨é€‰æ‹©çš„msvc2015ï¼ˆä»–ç”µè„‘åªå®‰è£…äº†vs2015ï¼‰ï¼Œqtåº“é€‰æ‹©çš„mingwï¼å·®ç‚¹ç‹‚æ‰‡è‡ªå·±å…«ä¸ªè€³å…‰ï¼Œå¤ªç¦»è°±äº†ï¼\n\nå½“ä½ ç¼–è¯‘Qtç¨‹åºå‘ç°ç¼–è¯‘é€šä¸è¿‡æç¤ºæŠ¥é”™ï¼Œè€Œä¸”æŠ¥é”™æç¤ºåœ¨Qtçš„å¤´æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸è¦å»å°è¯•ç€ä¿®æ”¹Qtå¤´æ–‡ä»¶æ¥ç¼–è¯‘é€šè¿‡ï¼Œé‚£æ ·æ²¡ç”¨çš„ï¼Œä½ ä½¿ç”¨çš„Qtçš„åº“æ˜¯å·²ç»æ ¹æ®åŸå§‹çš„å¤´æ–‡ä»¶ç¼–è¯‘å¥½çš„ã€‚å¦‚æœæŠ¥é”™æç¤ºåœ¨ç¼–è¯‘ç”Ÿæˆçš„ä¸´æ—¶çš„mocç­‰æ–‡ä»¶ï¼Œä½ ä¹Ÿä¸è¦å°è¯•å»ä¿®æ”¹ä»–ï¼Œé‚£ä¸ªæ˜¯ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™æ¬¡ä½ æ”¹å¥½äº†ä¹Ÿè®¸ç¼–è¯‘é€šè¿‡äº†ï¼Œä½ é‡æ–°ç¼–ä¸€ä¸‹åˆè¦†ç›–äº†è¿˜æ˜¯æ—§çš„é”™è¯¯ã€‚æ€»ä¹‹ä½ è¦ä»æºå¤´ï¼ˆä½ çš„ä»£ç ï¼‰æ‰¾é—®é¢˜ã€‚\n\næœ‰æ—¶å€™éœ€è¦å¯¹æ–‡æœ¬è¿›è¡Œåˆ†æ•£å¯¹é½æ˜¾ç¤ºï¼Œç›¸å½“äºæ— è®ºæ–‡å­—å¤šå°‘ï¼Œå°½å¯èƒ½å æ»¡æ•´ä¸ªç©ºé—´å¹³æ‘Šå ä½å®½åº¦ï¼Œä½†æ˜¯åœ¨å¯¹æ”¯æŒå¯¹é½æ–¹å¼çš„æ§ä»¶æ¯”å¦‚QLabelè°ƒç”¨ setAlignment(Qt::AlignJustify | Qt::AlignVCenter) è®¾ç½®åˆ†æ•£å¯¹é½ä¼šå‘ç°æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œè¿™ä¸ªæ—¶å€™å°±è¦è€ƒè™‘å¦å¤–çš„æ–¹å¼æ¯”å¦‚é€šè¿‡æ§åˆ¶å­—ä½“çš„é—´è·æ¥å®ç°åˆ†æ•£å¯¹é½æ•ˆæœã€‚\n1234567891011121314QString text = &quot;æµ‹è¯•åˆ†æ•£å¯¹é½å†…å®¹&quot;;//è®¡ç®—å½“å‰æ–‡æœ¬åœ¨å½“å‰å­—ä½“ä¸‹å ç”¨çš„å®½åº¦QFont font = ui-&gt;label-&gt;font();int textWidth = ui-&gt;label-&gt;fontMetrics().width(text);//æ˜¾ç¤ºæ–‡æœ¬çš„åŒºåŸŸå®½åº¦=æ ‡ç­¾çš„å®½åº¦-ä¸¤è¾¹çš„è¾¹è·int width = ui-&gt;label-&gt;width() - 12;//éœ€è¦-1ç›¸å½“äºä¸­é—´æœ‰å‡ ä¸ªé—´éš”int count = text.count() - 1;//è®¡ç®—æ¯ä¸ªé—´è·å¤šå°‘qreal space = qreal(width - textWidth) / count;//è®¾ç½®å›ºå®šé—´è·font.setLetterSpacing(QFont::AbsoluteSpacing, space);ui-&gt;label-&gt;setFont(font);ui-&gt;label-&gt;setText(text);\n\néšç€éœ€æ±‚çš„ä¸æ–­å¢åŠ ï¼Œç¨‹åºä¸æ–­å˜å¤§ï¼Œç”¨åˆ°çš„åŠ¨æ€åº“ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œåˆ°äº†å‘å¸ƒç¨‹åºçš„æ—¶å€™ä½ ä¼šå‘ç°å’Œå¯æ‰§è¡Œæ–‡ä»¶åŒä¸€ç›®å½•ä¸‹æ–‡ä»¶æ•°é‡çœŸå¤šï¼Œæ­¤æ—¶å¯èƒ½ä¼šè€ƒè™‘å¦‚ä½•å°†ä¸€äº›åº“æ–‡ä»¶åˆ†é—¨åˆ«ç±»çš„å­˜æ”¾ï¼Œè¿™æ ·æ–¹ä¾¿ç®¡ç†ã€‚\n\n\n\nQtæä¾›çš„è®¾ç½®åŠ¨æ€åº“è·¯å¾„çš„æ–¹æ³•setLibraryPathsæ˜¯ç”¨æ¥æœç´¢æ’ä»¶åŠ¨æ€åº“çš„ï¼Œè€Œä¸æ˜¯ç¨‹åºç›´æ¥ä¾èµ–çš„åŠ¨æ€åº“ã€‚\nå¾ˆå¤šäººä»¥ä¸ºè¿™ä¸ªå¯ä»¥è®¾ç½®Qtçš„åº“æˆ–è€…ç¨‹åºä¸­ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“çš„è·¯å¾„ï¼Œå…¶å®æƒ³æƒ³ä¹ŸçŸ¥é“ï¼Œå› ä¸ºç¨‹åºä¾èµ–è¿™ä¸ªåº“ï¼Œæ‰¾ä¸åˆ°çš„è¯æ ¹æœ¬è·‘ä¸èµ·æ¥ï¼Œç¨‹åºè·‘ä¸èµ·æ¥æ€ä¹ˆåº”ç”¨æ‰§è¡Œè¿™ä¸ªä»£ç å‘¢ï¼Ÿ\nQté»˜è®¤æ˜¯å¯ç”¨é€šè¿‡setLibraryPathsçš„æ–¹å¼è®¾ç½®Qtæ’ä»¶çš„åŠ¨æ€åº“ç›®å½•ä½ç½®ï¼Œæ¯”å¦‚æ•°æ®åº“æ’ä»¶sqldriversï¼Œå› ä¸ºè¿™äº›åº“æ–‡ä»¶æ˜¯çœŸæ­£åœ¨Qtç¨‹åºè·‘èµ·æ¥ä»¥åé€šè¿‡æ’ä»¶å½¢å¼å»åŠ è½½çš„ã€‚\nè¿˜å¯ä»¥é€šè¿‡qt.confæ–‡ä»¶è®¾ç½® Plugins&#x3D;â€configâ€ æŒ‡å®šæ‰€æœ‰æ’ä»¶åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸‹çš„configç›®å½•ä¸‹ã€‚\nè¦æƒ³è®¾ç½®ç¨‹åºç›´æ¥ä¾èµ–çš„åŠ¨æ€åº“åœ¨å…¶ä»–ç›®å½•ï¼Œæ‰¾éå…¨å®‡å®™ä¹Ÿåªæœ‰ä¸€ä¸ªåŠæ³•ï¼Œé‚£å°±æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œé™¤æ­¤åˆ«æ— ä»–æ³•ã€‚\nè‡³äºå¦‚ä½•è®¾ç½®ç¯å¢ƒå˜é‡æ–¹å¼å¾ˆå¤šï¼Œæ¯”å¦‚æ‰‹åŠ¨åœ¨ç”µè„‘ä¸Šè®¾ç½®ï¼Œæˆ–è€…æä¸ªæ‰¹å¤„ç†æ–‡ä»¶æ‰§è¡Œå‘½ä»¤è¡Œï¼Œåœ¨ç¨‹åºå®‰è£…çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œï¼Œæˆ–è€…ç¨‹åºæ‰“åŒ…ç›®å½•ä¸‹ç”¨æˆ·æ‰‹åŠ¨è¿è¡Œè¿™ä¸ªæ‰¹å¤„ç†ã€‚\nå¤§ç¥è¡¥å……ï¼šè®¾ç½®æ’ä»¶çš„ç›®å½•è¿˜å¯ä»¥é€šè¿‡åœ¨mainå‡½æ•°æœ€å‰é¢å†™ qputenv(â€œPATHâ€, QString(â€œ%1;%2â€).arg(qgetenv(â€œPATHâ€), pluginFileInfo.path()).toLocal8Bit()); æ¥å®ç°ã€‚\nç½‘å‹è¡¥å……ï¼šæœ€ç»ˆæ‰¾æ’ä»¶çš„è·¯å¾„å…¶å®å°±æ˜¯è¿™ä¸ª QT_PLUGIN_PATH ç¯å¢ƒå˜é‡ã€‚\n\n\nè¿›åº¦æ¡æ§ä»¶å¦‚æœè®¾ç½®çš„å‚ç›´æ–¹å‘ï¼Œå°±ç®—ä½ è®¾ç½®äº†æ–‡æœ¬å¯è§ï¼Œä¼šå‘ç°æ ¹æœ¬çœ‹ä¸åˆ°è¿›åº¦æ–‡æœ¬ï¼Œç»è¿‡å¤šæ–¹ç™¾æŠ˜ä¸æŒ çš„è¯•æ¢ï¼Œä»¥åŠå’Œé…·ç å¤§ä½¬æ·±å…¥çš„æ¢è®¨ï¼Œå‘ç°åªè¦è®¾ç½®ä¸‹borderæ ·å¼ï¼ˆborder:1px solid #ff0000ã€border:noneã€border-style:solidã€border-radius:0px ä»»æ„ä¸€ç§ï¼‰å°±è¡Œï¼Œå°±å¯ä»¥æŠŠæ–‡æœ¬æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™TMå°±ä¸çŸ¥é“Qtä¸ºä»€ä¹ˆæ€»æ˜¯ä¸ç»Ÿä¸€è§„åˆ™ï¼Œè¿™ä¸ªBUGé€šç”¨äºä»»ä½•ç‰ˆæœ¬ï¼Œè¿™ä¸ªå¯èƒ½æ˜¯å› ä¸ºè¾¹æ¡†çš„solidæ ·å¼å†²çªäº†å¯¼è‡´æ— æ³•ç»§ç»­ç»˜åˆ¶ï¼Œç¡®åˆ‡çš„è¯´è¿™å¿…é¡»æ˜¯BUGï¼Œè¿™ä¸ªé”…Qtå¿…é¡»èƒŒã€‚\n\næˆ‘ä»¬åœ¨ä½¿ç”¨QFileDialog::getOpenFileNameã€QFileDialog::getExistingDirectoryç­‰æ–¹æ³•æ—¶ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°é¦–æ¬¡æ‰“å¼€å¾ˆå¡ï¼Œå°¤å…¶æ˜¯åœ¨é»˜è®¤ç›®å½•å¾ˆå¤šæ–‡ä»¶çš„æ—¶å€™ï¼Œæ­¤æ—¶ä½ å¯ä»¥è€ƒè™‘è®¾ç½®è¿™äº›å‡½æ•°æœ€æœ«å°¾çš„å‚æ•°ä¸ºQFileDialog::DontUseNativeDialogï¼Œè¡¨ç¤ºä¸é‡‡ç”¨æœ¬åœ°ç³»ç»Ÿå¯¹è¯æ¡†ï¼Œè¿™æ ·çš„è¯ä¼šé‡‡ç”¨Qtçš„å¯¹è¯æ¡†ï¼Œé€Ÿåº¦å¿«å¾ˆå¤šï¼Œä¼°è®¡ç³»ç»Ÿçš„å¯¹è¯æ¡†åœ¨æ‰“å¼€çš„æ—¶å€™ä¼šåšå¾ˆå¤šåˆå§‹åŒ–åŠ è½½å¤„ç†ã€‚\n12QFileDialog::getOpenFileName(this, &quot;&quot;, &quot;&quot;, &quot;&quot;, 0, QFileDialog::DontUseNativeDialog);QFileDialog::getExistingDirectory(this, &quot;&quot;, &quot;&quot;, QFileDialog::DontUseNativeDialog);\n\næ»‘å—æ§ä»¶QSliderï¼Œå¦‚æœè®¾ç½®çš„å‚ç›´æ ·å¼ï¼Œå…¶è¿›åº¦é¢œè‰²å’Œå‰©ä½™é¢œè‰²ï¼Œåˆšå¥½å’Œæ¨ªå‘æ ·å¼çš„é¢œè‰²ç›¸åçš„ï¼Œä¸ç¡®å®šè¿™ä¸ªæ˜¯å¦æ˜¯Qtçš„BUGï¼ŒQt456éƒ½æ˜¯è¿™ä¸ªç°è±¡ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839QSlider::groove:horizontal&#123;height:8px;background:#FF0000;&#125;QSlider::add-page:horizontal&#123;height:8px;background:#FF0000;&#125;QSlider::sub-page:horizontal&#123;height:8px;background:#00FF00;&#125;QSlider::handle:horizontal&#123;width:10px;background:#0000FF;&#125;QSlider::groove:vertical&#123;width:8px;background:#FF0000;&#125;QSlider::add-page:vertical&#123;width:8px;background:#00FF00;&#125;QSlider::sub-page:vertical&#123;width:8px;background:#FF0000;&#125;QSlider::handle:vertical&#123;height:10px;background:#0000FF;&#125;\n\n22ï¼š211-220\nQMainWindow åœ¨å¯¹åœé çª—ä½“è¿›è¡Œæ’åˆ—çš„æ—¶å€™ï¼Œæœ‰äº›ä¸å¸¸ç”¨çš„è®¾ç½®å®¹æ˜“é—å¿˜ï¼Œå»ºè®®å°† QMainWindow çš„å¤´æ–‡ä»¶å‡½æ•°è¿‡ä¸€éä¸€ç›®äº†ç„¶ã€‚è¯¦ç»†ä»‹ç»å„ç§åœé å‚æ•°æ–‡ç« å‚è§ https://zhuanlan.zhihu.com/p/388544168ã€‚\n12345678910//è®¾ç½®å…è®¸å„ç§åµŒå¥—æ¯”å¦‚ä¸Šä¸‹æ’åˆ—å·¦å³æ’åˆ—éå¸¸çµæ´»//æ­¤è®¾ç½®ä¼šå’Œä¸‹é¢çš„ setDockOptions ä¸­çš„å‚æ•°è¦†ç›–æ‰€ä»¥è¦æ³¨æ„é¡ºåº//this-&gt;setDockNestingEnabled(true);//è®¾ç½®åœé å‚æ•°,ä¸å…è®¸é‡å ,åªå…è®¸æ‹–åŠ¨å’ŒåµŒå¥—this-&gt;setDockOptions(AnimatedDocks | AllowNestedDocks);//å°†åº•éƒ¨å·¦ä¾§ä½œä¸ºå·¦ä¾§åŒºåŸŸï¼Œåº•éƒ¨å³ä¾§ä½œä¸ºå³ä¾§åŒºåŸŸï¼Œå¦åˆ™åº•éƒ¨åŒºåŸŸä¼šå¡«å……æ‹‰ä¼¸this-&gt;setCorner(Qt::BottomLeftCorner, Qt::LeftDockWidgetArea);this-&gt;setCorner(Qt::BottomRightCorner, Qt::RightDockWidgetArea);\n\nå½“æˆ‘ä»¬åœ¨å¯¹QModelIndexå–æ•°æ®çš„æ—¶å€™ï¼Œå¸¸è§„çš„è§’è‰²çš„æ•°æ®ï¼ˆQVariantç±»å‹æ”¯æŒtoçš„æ¯”å¦‚toStringã€toIntã€toDoubleç­‰ï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿çš„å–å‡ºæ¥ï¼Œç‰¹å®šçš„æ•°æ®ç±»å‹éœ€è¦ç”¨çš„ä¸‡èƒ½å–å€¼æ¨¡æ¿å‡½æ•° T value() å–å‡ºæ¥ã€‚\n12345678910//æ˜¾ç¤ºæ–‡æœ¬QString text = index.data(Qt::DisplayRole).toString();//æ–‡æœ¬å¯¹é½int align = index.data(Qt::TextAlignmentRole).toInt();//æ–‡å­—å­—ä½“QFont font = index.data(Qt::FontRole).value&lt;QFont&gt;();//å‰æ™¯è‰²QColor color = index.data(Qt::ForegroundRole).value&lt;QColor&gt;();//èƒŒæ™¯è‰²QColor color = index.data(Qt::BackgroundRole).value&lt;QColor&gt;();\n\nå¾ˆå¤šäººä»¥ä¸ºæ‹–æ›³åªè¦åœ¨dropEventäº‹ä»¶å°±å¯ä»¥äº†ï¼Œå…¶å®ä¸è¡Œçš„ï¼Œæ²¡æœ‰æ•ˆæœçš„ï¼Œéœ€è¦å…ˆåœ¨dragEnterEventäº‹ä»¶ä¸­æ‰§è¡Œevent-&gt;accept()æ‰è¡Œï¼Œä¸ç„¶æ ¹æœ¬æ²¡æœ‰æ•ˆæœï¼Œå¾ˆå¤šäººå°¤å…¶æ˜¯åˆå­¦è€…éƒ½æŒ‚åœ¨è¿™é‡Œï¼Œæˆ‘å°±æ˜¯åœ¨è¿™é‡Œæ‘”äº†ä¸€è·¤ï¼Œå¥½ç–¼ï¼\n1234567891011121314void frmMain::dropEvent(QDropEvent *event)&#123;    QList&lt;QUrl&gt; urls = event-&gt;mimeData()-&gt;urls();&#125;void frmMain::dragEnterEvent(QDragEnterEvent *event)&#123;    if(event-&gt;mimeData()-&gt;hasFormat(&quot;application/x-qabstractitemmodeldatalist&quot;)) &#123;        event-&gt;setDropAction(Qt::MoveAction);        event-&gt;accept();    &#125; else &#123;        event-&gt;ignore();    &#125;&#125;\n\nQt5.6ä»¥åå†…ç½®çš„æ˜¯webengineæµè§ˆå™¨å†…æ ¸ï¼Œå¦‚æœéœ€è¦åšwebäº¤äº’çš„è¯å¿…é¡»ç”¨åˆ° qwebchannel.js è¿™ä¸ªæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶æ˜¯Qtå®˜æ–¹æä¾›çš„ï¼Œæ‰€ä»¥ä¸å»ºè®®å»æ”¹åŠ¨å…¶ä¸­çš„æºç ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºå®˜æ–¹å¯¹webengineçš„æ”¯æŒåœ¨ä¸æ–­æ›´æ–°ï¼Œæ‰€ä»¥å®˜æ–¹æä¾›çš„å¯¹åº”Qtç‰ˆæœ¬çš„ qwebchannel.js æ–‡ä»¶ä¹Ÿä¸åŒï¼Œæ„å‘³ç€ä½ è¦ç”¨å¯¹åº”æä¾›çš„ç‰ˆæœ¬çš„ qwebchannel.js æ–‡ä»¶æ‰okï¼Œè¯¥æ–‡ä»¶é»˜è®¤åœ¨ C:\\Qt\\Qt5.12.11\\Examples\\Qt-5.12.11\\webchannel\\shared ç›®å½•ä¸‹ã€‚ç»è¿‡å‡ åä¸ªQtç‰ˆæœ¬çš„æµ‹è¯•å‘ç°ï¼Œç”¨é«˜ç‰ˆæœ¬çš„ qwebchannel.js æ”¾åˆ°ä½ç‰ˆæœ¬è¿è¡Œä¸è¡Œï¼Œä½ç‰ˆæœ¬æ”¾åˆ°é«˜ç‰ˆæœ¬å¯ä»¥ï¼Œä¸ºäº†ä¸‡æ— ä¸€å¤±è¿˜æ˜¯å»ºè®®ç›´æ¥ç”¨å¯¹åº”ç‰ˆæœ¬çš„ã€‚\n\nå¯¹äºQStringå»é™¤ç©ºæ ¼ï¼Œæœ‰å¤šç§åœºæ™¯ï¼Œå¯èƒ½éœ€è¦å»é™¤å·¦ä¾§ã€å³ä¾§ã€æ‰€æœ‰ç­‰ä½ç½®çš„ç©ºæ ¼ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142//å­—ç¬¦ä¸²å»ç©ºæ ¼ -1=ç§»é™¤å·¦ä¾§ç©ºæ ¼ 0=ç§»é™¤æ‰€æœ‰ç©ºæ ¼ 1=ç§»é™¤å³ä¾§ç©ºæ ¼ 2=ç§»é™¤é¦–å°¾ç©ºæ ¼ 3=é¦–å°¾æ¸…é™¤ä¸­é—´ç•™ä¸€ä¸ªç©ºæ ¼QString QUIHelperData::trimmed(const QString &amp;text, int type)&#123;    QString temp = text;    QString pattern;    if (type == -1) &#123;        pattern = &quot;^ +\\\\s*&quot;;    &#125; else if (type == 0) &#123;        pattern = &quot;\\\\s&quot;;        //temp.replace(&quot; &quot;, &quot;&quot;);    &#125; else if (type == 1) &#123;        pattern = &quot;\\\\s* +$&quot;;    &#125; else if (type == 2) &#123;        temp = temp.trimmed();    &#125; else if (type == 3) &#123;        temp = temp.simplified();    &#125;    //è°ƒç”¨æ­£åˆ™è¡¨è¾¾å¼ç§»é™¤ç©ºæ ¼    if (!pattern.isEmpty()) &#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))        temp.remove(QRegularExpression(pattern));#else        temp.remove(QRegExp(pattern));#endif    &#125;    return temp;&#125;//æµ‹è¯•ä»£ç QString text = &quot;  a  b  c d  &quot;;//ç»“æœï¼ša  b  c d  QUIHelper::trimmed(text, -1);//ç»“æœï¼šabcd  QUIHelper::trimmed(text, 0);//ç»“æœï¼š  a  b  c dQUIHelper::trimmed(text, 1);//ç»“æœï¼ša  b  c dQUIHelper::trimmed(text, 2);//ç»“æœï¼ša b c dQUIHelper::trimmed(text, 3);\n\nQtçš„ç½‘ç»œåº“æ”¯æŒudpå¹¿æ’­æœç´¢å’Œç»„æ’­æœç´¢ï¼Œå…¶ä¸­ç»„æ’­æœç´¢å¯ä»¥è·¨ç½‘æ®µæœç´¢ï¼Œæœ‰æ—¶å€™ä½ ä¼šå‘ç°å¤±çµï¼Œæ­¤æ—¶ä½ å¯ä»¥å°è¯•æŠŠæœ¬åœ°çš„è™šæ‹Ÿæœºçš„ç½‘å¡ç¦ç”¨è¯•è¯•ï¼Œä¼°è®¡å°±å¥½äº†ã€‚è¿˜æœ‰å°±æ˜¯åœ¨æœ¬åœ°å¼€å¯äº†ä»£ç†å•¥çš„ï¼Œå…ˆå…³æ‰è¯•è¯•ã€‚è¿‘æœŸåœ¨ä½¿ç”¨tcpsocketè¿æ¥çš„æ—¶å€™ï¼Œå‘ç°åœ¨Qt4å’ŒQt5ä¸­æ­£å¸¸çš„ç¨‹åºï¼Œåˆ°äº†Qt6ä¸­å°±ä¸è¡Œäº†ï¼ŒæŠ¥é”™æç¤º The proxy type is invalid for this operation ï¼ŒåŸæ¥æ˜¯æœ¬åœ°è®¾ç½®äº†ä»£ç†å¯¼è‡´çš„ï¼Œå¯èƒ½åœ¨Qt6ä»¥å‰ä¼šé»˜è®¤è·³è¿‡å»ä¸å¤„ç†ã€‚\n12345678//ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç è®¾ç½®è·³è¿‡ä»£ç†#include &lt;QNetworkProxy&gt;QNetworkProxyFactory::setUseSystemConfiguration(false);//ä¸‹é¢è¿™æ ·æ¯æ¬¡è®¾ç½®ä¹Ÿå¯ä»¥tcpSocket-&gt;setProxy(QNetworkProxy::NoProxy);//æŸ¥é˜…åˆ°æ–‡ç«  https://www.cnblogs.com/cppskill/p/11730452.html//ä»5.8å¼€å§‹socketé»˜è®¤ä»£ç†ç±»å‹æ˜¯DefaultProxyè€Œä¸æ˜¯NoProxyï¼Œä¸çŸ¥é“å‡ºäºä»€ä¹ˆè€ƒè™‘ã€‚\n\nå…³äºäº¤å‰ç¼–è¯‘ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´æ˜¯ä¸ªæéš¾è·¨è¿‡å»çš„ç ï¼ˆä¸€æ—¦è·¨è¿‡å»äº†ï¼Œä»¥åé‡åˆ°éœ€è¦äº¤å‰ç¼–è¯‘çš„æ—¶å€™éƒ½æ˜¯é¡ºæ°´æ¨èˆŸã€ä¿¡æ‰‹æ‹ˆæ¥ã€‚ï¼‰ï¼Œå› ä¸ºéœ€è¦æ­å»ºäº¤å‰ç¼–è¯‘ç¯å¢ƒï¼Œå¥½åœ¨ç°åœ¨å‚å®¶æä¾›çš„æ¿å­åŸºæœ¬ä¸Šéƒ½æ˜¯æµ‹è¯•å¥½çš„ç¯å¢ƒï¼Œå°¤å…¶æ˜¯æä¾›çš„ç¼–è¯‘å™¨ï¼Œä¸ç”¨è‡ªå·±å†å»æŠ˜è…¾ï¼ŒæŒ‰ç…§å®˜æ–¹æ‰‹å†Œæ¥åŸºæœ¬ä¸Šä¸ä¼šæœ‰å•¥çš„çš„é—®é¢˜ã€‚\n\n\n\nåœ¨linuxç³»ç»Ÿä¸Šç¼–è¯‘ffmpegå’Œqtéƒ½æ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ï¼Œåˆå­¦è€…ä¹Ÿä¼šï¼Œå‰æåªè¦æœ¬åœ°çš„gcc g++ç¼–è¯‘å™¨æ­£å¸¸ã€‚\nä»»ä½•ç¼–è¯‘å™¨åŒ…æ‹¬åµŒå…¥å¼ç¼–è¯‘å™¨ï¼Œä¸ºäº†ç¡®ä¿ç¯å¢ƒæ­£å¸¸ï¼Œä½ å¯ä»¥å…ˆæŸ¥çœ‹å¯¹åº”çš„ç¼–è¯‘å™¨ç‰ˆæœ¬æ˜¯å¦okï¼Œg++ -v  arm-linux-g++ -vã€‚\näº¤å‰ç¼–è¯‘å™¨æŸ¥çœ‹ç‰ˆæœ¬ &#x2F;opt&#x2F;FriendlyARM&#x2F;toolschain&#x2F;4.5.1&#x2F;bin&#x2F;arm-linux-g++ -v ã€‚\nç¼–è¯‘å™¨ä½æ•°å’Œæ“ä½œç³»ç»Ÿä½æ•°æœ‰å…³ï¼Œä¸€èˆ¬32ä½çš„ç¼–è¯‘å™¨è¦åœ¨32ä½çš„ç³»ç»Ÿä¸Šåšäº¤å‰ç¼–è¯‘ï¼Œè™½ç„¶32ä½ä¹Ÿå¯ä»¥åœ¨å®‰è£…ä¾èµ–åï¼Œåœ¨64ä½ç³»ç»Ÿåšäº¤å‰ç¼–è¯‘ï¼Œä½†æ˜¯ä¸ªäººä¸å»ºè®®ï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ã€‚64ä½çš„ç¼–è¯‘å™¨åªèƒ½åœ¨64ä½çš„ç³»ç»Ÿã€‚\nè®¾ç½®äº†ç¯å¢ƒå˜é‡åˆ™å¯ä»¥çœç•¥æ‰é•¿é•¿çš„è·¯å¾„ï¼Œç›´æ¥æ‰“å¯æ‰§è¡Œæ–‡ä»¶åç§°å³å¯ï¼Œæ²¡æœ‰è®¾ç½®ç¯å¢ƒå˜é‡åˆ™éœ€è¦æ‰“å®Œæ•´è·¯å¾„ã€‚\nè®¾ç½®ç¯å¢ƒå˜é‡åªæ˜¯ä¸ºäº†ç¼–è¯‘çš„æ—¶å€™è®©è‡ªåŠ¨å¯»æ‰¾ç¼–è¯‘å™¨ï¼Œå…¶å®ä¹Ÿå®Œå…¨å¯ä»¥ä¸ç”¨è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„æŒ‡å®šç¼–è¯‘å™¨ä½ç½®å³å¯ã€‚\nåœ¨linuxä¸Šç¼–è¯‘ï¼Œæ— è®ºæ˜¯ffmpegè¿˜æ˜¯qtè¿˜æ˜¯å…¶ä»–ï¼Œéƒ½æ˜¯é€šç”¨çš„æ­¥éª¤ï¼Œç¬¬ä¸€æ­¥ï¼š.&#x2F;configure  ç¬¬äºŒæ­¥ï¼šmake  ç¬¬ä¸‰æ­¥ï¼šmake install ã€‚\nè‡³äºå…·ä½“configureåé¢æœ‰å“ªäº›å‚æ•°ï¼Œå‚ç…§å¯¹åº”æºç åŒ…çš„æ‰‹å†Œå°±è¡Œï¼Œæœç´¢ä¹Ÿä¸€å¤§å †ã€‚å½“ç„¶ä½ ç”¨é»˜è®¤çš„å°±ä¸å¸¦ä»»ä½•å‚æ•°ä¸€èˆ¬ä¹Ÿå¯ä»¥ï¼Œè‡ªåŠ¨é‡‡ç”¨é»˜è®¤å‚æ•°è¿›è¡Œç¼–è¯‘ã€‚\näº¤å‰ç¼–è¯‘ffmpegå‘½ä»¤ï¼š.&#x2F;configure â€“prefix&#x3D;host â€“enable-static â€“disable-shared â€“disable-doc â€“cross-prefix&#x3D;&#x2F;opt&#x2F;FriendlyARM&#x2F;toolschain&#x2F;4.5.1&#x2F;bin&#x2F;arm-linux- â€“arch&#x3D;arm â€“target-os&#x3D;linux\näº¤å‰ç¼–è¯‘qtå‰æï¼šä¿®æ”¹mkspecs&#x2F;qws&#x2F;linux-arm-g++ä¸‹é¢çš„qmake.confï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ç¯å¢ƒå˜é‡åˆ™è®¾ç½®å¯¹åº”ç¼–è¯‘å™¨çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶å°†ç¼–è¯‘å™¨çš„åå­—æ”¹æˆä½ éœ€è¦çš„ã€‚\næ¯”å¦‚ä¿®æ”¹gccç¼–è¯‘å™¨ï¼šQMAKE_CC &#x3D; &#x2F;opt&#x2F;FriendlyARM&#x2F;toolschain&#x2F;4.5.1&#x2F;bin&#x2F;arm-linux-gcc\näº¤å‰ç¼–è¯‘qt4.8.5å‘½ä»¤ï¼š.&#x2F;configure -prefix host -embedded arm -xplatform qws&#x2F;linux-arm-g++ -release -opensource -confirm-license -qt-sql-sqlite -qt-gfx-linuxfb -plugin-sql-sqlit -no-qt3support -no-phonon -no-svg -no-webkit -no-javascript-jit -no-script -no-scripttools -no-declarative -no-declarative-debug -qt-zlib -no-gif -qt-libtiff -qt-libpng -no-libmng -qt-libjpeg -no-rpath -no-pch -no-3dnow -no-avx -no-neon -no-openssl -no-nis -no-cups -no-dbus -little-endian -qt-freetype -no-opengl -no-glib -nomake demos -nomake examples -nomake docs -nomake tools\näº¤å‰ç¼–è¯‘qt5.9.8å‘½ä»¤ï¼š.&#x2F;configure -prefix host -xplatform linux-arm-g++ -recheck-all -opensource -confirm-license -optimized-qmake -release -no-separate-debug-info -strip -shared -static -c++std c++1z -no-sse2 -pch -compile-examples -gui -widgets -no-dbus -no-openssl -no-cups -no-opengl -linuxfb -qt-zlib -qt-libpng -qt-libjpeg -qt-freetype\nç»¼ä¸Šæ‰€è¿°äº¤å‰ç¼–è¯‘å’Œå¸¸è§„çš„ç¼–è¯‘å°±ä¸€ä¸ªåŒºåˆ«ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šäº¤å‰ç¼–è¯‘å™¨è·¯å¾„ã€‚ffmpegæ˜¯é€šè¿‡â€“cross-prefix&#x3D;æŒ‡å®šï¼Œqtæ¯”è¾ƒåºå¤§æ˜¯é€šè¿‡æ›´æ”¹é…ç½®æ–‡ä»¶æœ€åé€šè¿‡-xplatformæŒ‡å®šé…ç½®æ–‡ä»¶åç§°ã€‚\nQt6çš„ç¼–è¯‘æ¯”è¾ƒç¹çï¼Œé»˜è®¤ç”¨cmakeç¼–è¯‘ï¼Œåœ¨linuxä¸Šå…ˆç”¨cmake3.19ä»¥ä¸Šç‰ˆæœ¬çš„æºç ï¼Œç”¨makeç¼–è¯‘ç”Ÿæˆcmakeï¼Œç„¶åå†ç”¨cmakeç¼–è¯‘qtç”Ÿæˆqmakeï¼Œæœ€åè°ƒç”¨qmakeæ¥ç¼–è¯‘ä½ çš„qté¡¹ç›®ã€‚\nç¼–è¯‘Qtå…¶å®åªæ˜¯æƒ³ç”¨å…¶ä¸­çš„åº“ï¼Œè‡³äºdemoã€docã€toolã€exampleç­‰ç»Ÿç»Ÿä¸ç”¨ï¼Œè´¹æ—¶è´¹åŠ›ã€‚æ‰€ä»¥å¼ºçƒˆå»ºè®®ç¼–è¯‘çš„æ—¶å€™å»æ‰ï¼Œå¤§å¤§åŠ å¿«ç¼–è¯‘é€Ÿåº¦ã€‚\nç¼–è¯‘å»ºè®®ç”¨æ™®é€šç”¨æˆ·ç¼–è¯‘å³å¯ï¼ŒåŒ…æ‹¬è§£å‹æºç ï¼Œå› ä¸ºè¿™æ ·ç¼–è¯‘å‡ºæ¥çš„åº“æ™®é€šç”¨æˆ·å°±èƒ½ç”¨ï¼Œå¦‚æœæ˜¯rootç®¡ç†å‘˜ç¼–è¯‘çš„åˆ™ä»¥åéƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æ‰è¡Œã€‚\nå¾ˆå¤šç³»ç»Ÿéƒ½æä¾›äº†ç›´æ¥é¼ æ ‡å³é”®è§£å‹ï¼Œå…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå°±æ˜¯é€Ÿåº¦æ…¢ï¼Œå»ºè®®ç”¨å‘½ä»¤è¡Œè§£å‹å’Œåˆ é™¤ç›®å½•ã€‚\nQtçš„ç¼–è¯‘å‚æ•°æ¯ä¸ªç‰ˆæœ¬éƒ½å¯èƒ½æœ‰å‡ºå…¥ï¼Œæ¯•ç«Ÿä¸€ç›´åœ¨æ›´æ–°ä»£ç ï¼Œç”šè‡³æœ‰äº›åˆ†ç±»æè¿°å˜äº†ï¼Œæ¯”å¦‚ä¹‹å‰-qt-xcbåˆ°äº†5.15æ”¹æˆäº†-xcbï¼Œä¹‹å‰-qt-sql-sqliteæ”¹æˆäº†-qt-sqliteï¼Œä¸€å®šè¦çœ‹æºç ä¸‹çš„readmeï¼Œé‡Œé¢çº¦å®šäº†ç¼–è¯‘ç¯å¢ƒè¦æ±‚çš„æœ€ä½ç‰ˆæœ¬ï¼Œåé¢qt5å¼€å§‹å…·ä½“çš„é…ç½®å‚æ•°æœ‰å“ªäº›æ”¾åˆ°äº†qtbaseç›®å½•ä¸‹çš„configè¯´æ˜ã€‚\nç¼–è¯‘å®Œæˆä½¿ç”¨å¦‚æœé‡åˆ°æç¤º GL&#x2F;gl.h é”™è¯¯ï¼Œéœ€è¦å®‰è£… apt install libgl1-mesa-dev libglu1-mesa-dev  æˆ–è€… yum install mesa-libGL-devel mesa-libGLU-devel ã€‚\nç¼–è¯‘å‚æ•°è¯´æ˜å¯å‚è€ƒ https://blog.csdn.net/xi_gua_gua&#x2F;article&#x2F;details&#x2F;53413930ã€‚\n\n\nåœ¨Qtä¸­è®¾ç½®å›¾ç‰‡æœ‰æ—¶å€™ä¼šå‘ç°ä¸æˆåŠŸï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸ºæ–‡ä»¶çš„æ‹“å±•åä¸æ­£ç¡®å¯¼è‡´çš„ï¼Œæ¯”å¦‚jpgçš„å›¾ç‰‡æ‹“å±•åæ˜¯pngï¼Œbmpçš„å›¾ç‰‡æ‹“å±•åæ”¹æˆäº†jpgï¼ŒQImageã€QPixmapä¼ å…¥æ–‡ä»¶è·¯å¾„åŠ è½½å›¾ç‰‡ï¼Œæ˜¯é€šè¿‡æ‹“å±•åå»è°ƒç”¨å¯¹åº”çš„å›¾ç‰‡è§£æç®—æ³•ï¼Œæ¯”è¾ƒå‚»ï¼Œä½†æ˜¯é€Ÿåº¦å¿«ï¼Œä¸ç”¨ç»è¿‡åˆ†æå…·ä½“å†…éƒ¨æ˜¯ä½•ç§å›¾ç‰‡æ ¼å¼ã€‚å¦‚æœæƒ³è¦ä¸ç®¡æ‹“å±•åéƒ½èƒ½ä¿è¯åŠ è½½æˆåŠŸï¼Œåˆ™å¿…é¡»è¯»å–å›¾ç‰‡æ–‡ä»¶æ•°æ®åŠ è½½çš„æ–¹å¼å¤„ç†ã€‚\n1234567891011121314151617181920212223//å¯ä»¥æ˜¯èµ„æºæ–‡ä»¶ä¸­çš„å›¾ç‰‡ä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶QString fileName = &quot;:/test.png&quot;;//æ­¤æ–¹å¼æŒ‰ç…§æ‹“å±•åæ¥åŒºåˆ†å…·ä½“æ ¼å¼ä¸å‡†ç¡®//å¦‚æœæ‹“å±•åä¸æ­£ç¡®å°±æ— æ³•åŠ è½½æˆåŠŸui-&gt;label-&gt;setPixmap(QPixmap(fileName));//é€šè¿‡ç›´æ¥è¯»å–å›¾ç‰‡æ•°æ®åŠ è½½ä¿è¯æˆåŠŸQFile file(fileName);file.open(QIODevice::ReadOnly);QByteArray data = file.readAll();//é€šè¿‡ QImage å¤„ç†QImage img;img.loadFromData(data);//ä¸‹é¢è¿™ç§æ–¹å¼ä¹Ÿè¡Œ//QImage img = QImage::fromData(data);ui-&gt;label-&gt;setPixmap(QPixmap::fromImage(img));//é€šè¿‡ QPixmap å¤„ç†QPixmap pix;pix.loadFromData(data);ui-&gt;label-&gt;setPixmap(pix);\n\næ€»ç»“å‡ ä¸ªQtç‰ˆæœ¬çš„å†·çŸ¥è¯†ã€‚\n\n\n\nQt4.8.7æ˜¯Qt4çš„ç»ˆç»“ç‰ˆæœ¬ï¼Œæ˜¯Qt4ç³»åˆ—ç‰ˆæœ¬ä¸­æœ€ç¨³å®šæœ€ç»å…¸çš„ï¼ˆå¾ˆå¤šåµŒå…¥å¼æ¿å­è¿˜æ˜¯ç”¨Qt4.8ï¼‰ï¼Œå…¶å®è¯¥ç‰ˆæœ¬æ˜¯å’ŒQt5.5å·®ä¸å¤šæ—¶é—´å‘å¸ƒçš„ã€‚å‚è€ƒé“¾æ¥ https://www.qt.io/blog/2015/05/26/qt-4-8-7-released https://blog.qt.io/blog/2015/07/01/qt-5-5-released/\nQt5.6.3æœ€æœ€åæ”¯æŒxpç³»ç»Ÿçš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼ŒQt5.7.0æ˜¯æœ€åæ”¯æŒxpç³»ç»Ÿçš„éé•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼ˆæœ‰å¯èƒ½æœ‰æå°‘æ•°å‡½æ•°ä¸æ”¯æŒï¼Œä¸ªäººæ²¡é‡åˆ°è¿‡ï¼‰ã€‚\nQt5.12.3æ˜¯æœ€åæä¾›mysqlæ•°æ®åº“æ’ä»¶çš„ç‰ˆæœ¬ï¼Œå¾€åçš„ç‰ˆæœ¬éœ€è¦è‡ªè¡Œç¼–è¯‘å¯¹åº”çš„mysqlæ•°æ®åº“æ’ä»¶ï¼Œå®˜æ–¹å®‰è£…åŒ…ä¸å†æä¾›ã€‚\nQt5.12.5æ˜¯æœ€åæ ·å¼è¡¨æ€§èƒ½æœ€é«˜çš„ç‰ˆæœ¬ï¼Œç»è¿‡é…·ç å¤§ä½¬æŸ¥é˜…ä»£ç å‘ç°æ­¤åç‰ˆæœ¬çš„æ ·å¼è¡¨æºç ä¸­ä¸ºäº†ä¿®å¤ä¸€ä¸ªbugåšäº†å¾ªç¯åµŒå¥—è®¾ç½®ï¼Œå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œç•Œé¢è¶Šå¤šæ€§èƒ½æš´é™10å€ä»¥ä¸Šã€‚\nQt5.14.2æ˜¯æœ€åæä¾›äºŒè¿›åˆ¶å®‰è£…åŒ…çš„ç‰ˆæœ¬ï¼Œåé¢çš„ç‰ˆæœ¬éƒ½éœ€è¦åœ¨çº¿å®‰è£…ã€‚\nQt5.15ç³»åˆ—æ˜¯æœ€åæ”¯æŒwin7çš„ç‰ˆæœ¬ï¼Œåé¢çš„Qt6ç³»åˆ—ç‰ˆæœ¬éœ€è¦æ›´æ”¹æºç ç¼–è¯‘æ‰èƒ½æ”¯æŒwin7ï¼Œè¿™å¯¹äºå°ç™½æ¥è¯´éš¾äºä¸Šé’å¤©ã€‚\nQt6.0&#x2F;6.1ç‰ˆæœ¬å…¶å®ä¹Ÿæ˜¯æ”¯æŒwin7çš„ï¼Œä½†æ˜¯å› ä¸ºç¼ºå¤±å¤ªå¤šæ¨¡å—ï¼Œè€Œä¸”BUGæˆå±±ï¼Œå¤§ä½¬è¯´äº†ç‹—éƒ½ä¸ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨æ­¤ç‰ˆæœ¬æ²¡æ„ä¹‰ã€‚\nQt6ä¸æ”¯æŒwin7ï¼Œæ˜¯è¯´å¼€å‘é˜¶æ®µå’Œè¿è¡Œé˜¶æ®µéƒ½ä¸æ”¯æŒï¼Œæ— è®ºå¼€å‘é˜¶æ®µè¿˜æ˜¯è¿è¡Œé˜¶æ®µä½ éƒ½éœ€è¦Qtçš„åº“ï¼Œåªè¦æ˜¯Qtçš„åº“ä¸æ”¯æŒï¼Œåˆ°å“ªé‡Œä¹Ÿä¸æ”¯æŒã€‚\næ–°ç‰ˆçš„qtc7ç”±äºé‡‡ç”¨Qt6ç¼–è¯‘ï¼Œæ‰€ä»¥ä¹Ÿåªèƒ½åœ¨win10åŠä»¥ä¸Šè¿è¡Œï¼Œæ„å‘³ç€ä½ è¦ç”¨æ–°çš„qtc7+Qt5åšå¼€å‘ä¹Ÿå¿…é¡»ç”¨win10åŠä»¥ä¸Šã€‚\næ¬¢è¿å„ä½è¡¥å……ï¼Œæ¯”å¦‚å“ªä¸ªç‰ˆæœ¬ä»¥åå•†ç”¨éœ€è¦æ”¶è´¹ä¹‹ç±»çš„ï¼Œè²Œä¼¼ç”¨Qt4ï¼Œåœ¨ä¸æ›´æ”¹Qtæœ¬èº«æºç ï¼ŒåŠ¨æ€åº“å‘å¸ƒç¨‹åºï¼Œæ³•å¾‹é£é™©å°ä¸€äº›ï¼Ÿ\n\n\nQtå®˜æ–¹é™¤äº†Qtåº“ä¸€ç›´åœ¨å‡çº§å¤–ï¼Œå¯¹åº”çš„é›†æˆå¼€å‘ç¯å¢ƒä¹Ÿåœ¨æ›´æ–°å‡çº§ï¼Œä¸€èˆ¬ä¼šé€‰ç”¨æœ€æ–°çš„Qtåº“ç¼–è¯‘æ–°ç‰ˆæœ¬ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰äº›äººå®‰è£…çš„æ—§ç‰ˆæœ¬çš„qtcï¼ŒåŠ è½½æ¯”è¾ƒé«˜ç‰ˆæœ¬çš„Qtåº“ï¼Œå¾ˆå®¹æ˜“å‡ºç°æŠ¥é”™æç¤º Project ERROR: Cannot run compiler â€˜g++â€™. Maybe you forgot to setup the environment? ä¹‹ç±»çš„ï¼Œä¸€èˆ¬æ˜¯ç‰ˆæœ¬è·¨åº¦è¿‡å¤§ï¼Œæ¯”å¦‚ç”¨Qt5.5é™„å¸¦çš„qtcåŠ è½½Qt5.9çš„åº“ï¼Œå¯¼è‡´æœ‰äº›ç¯å¢ƒè¯†åˆ«ä¸åˆ°ï¼Œå¯èƒ½æ˜¯qtcåœ¨æ–°ç‰ˆæœ¬ä¸­å¯¹æŸäº›è¯†åˆ«å¤„ç†è§„åˆ™æœ‰å˜åŠ¨ã€‚æ‰€ä»¥ä¸€èˆ¬å»ºè®®å¯ä»¥ç”¨æ–°çš„qtcåŠ è½½æ—§çš„Qtåº“ï¼Œä¸å»ºè®®æ—§çš„qtcåŠ è½½æ–°çš„Qtåº“ã€‚\n\n23ï¼š221-230\nåœ¨å¯¹è¡¨æ ¼æ•°æ®æ¨¡å‹æ“ä½œçš„æ—¶å€™ï¼Œç»å¸¸é‡åˆ°ä¸€ç§åœºæ™¯å°±æ˜¯ï¼Œåˆ é™¤æŸæ¡è®°å½•åï¼Œå¸Œæœ›é‡æ–°é€‰ä¸­æŸä¸€è¡Œã€‚QTableViewã€QTableWidgetæœ¬èº«å°±æ”¯æŒå¤šé€‰å…¨é€‰ç­‰æ“ä½œï¼Œæ¯”å¦‚æ‰¹é‡åˆ é™¤å¯ä»¥å¤šé€‰ã€‚\n1234567891011121314151617181920212223242526//æ‹¿åˆ°è¡¨æ ¼æ•°æ®æ¨¡å‹QAbstractItemModel *model = ui-&gt;tableView-&gt;model();//ä¸»åŠ¨å®šä½åˆ°ç¬¬ä¸‰è¡Œui-&gt;tableView-&gt;setCurrentIndex(model-&gt;index(3, 0));//ä¸»åŠ¨å®šä½åˆ°æœ€åä¸€è¡Œui-&gt;tableView-&gt;setCurrentIndex(model-&gt;index(model-&gt;rowCount() - 1, 0));//è®¾ç½®é€‰æ‹©æ¨¡å¼æ”¯æŒå¤šé€‰ï¼Œå…¶ä»–å‡ ä¸ªæšä¸¾å€¼è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£ã€‚ui-&gt;tableView-&gt;setSelectionMode(QAbstractItemView::MultiSelection);//é€‰æ‹©å…¨éƒ¨ui-&gt;tableView-&gt;selectAll();//å–æ¶ˆæ‰€æœ‰é€‰ä¸­ui-&gt;tableView-&gt;clearSelection();//é€‰ä¸­è¡Œï¼Œæ³¨æ„å¦‚æœè¯¥è¡Œé€‰ä¸­åˆ™æ‰§è¡Œåå–æ¶ˆé€‰ä¸­ï¼Œå¦‚æ­¤å¾€å¤ã€‚è¿™ä¸ªè®¾è®¡å¾ˆå·§å¦™ï¼ŒæŒå£°ã€‚ui-&gt;tableView-&gt;selectRow(row);//é€‰ä¸­åˆ—ï¼Œæ³¨æ„å¦‚æœè¯¥åˆ—é€‰ä¸­åˆ™æ‰§è¡Œåå–æ¶ˆé€‰ä¸­ï¼Œå¦‚æ­¤å¾€å¤ã€‚è¿™ä¸ªè®¾è®¡å¾ˆå·§å¦™ï¼ŒæŒå£°ã€‚ui-&gt;tableView-&gt;selectColumn(column);//è·å–é€‰ä¸­è¡Œçš„å†…å®¹QItemSelectionModel *selections = ui-&gt;tableView-&gt;selectionModel();QModelIndexList selected = selections-&gt;selectedIndexes();foreach (QModelIndex index, selected) &#123;    qDebug() &lt;&lt; index.row() &lt;&lt; index.column() &lt;&lt; index.data();   &#125;\n\nåœ¨è¯»å–æ–‡æœ¬æ–‡ä»¶çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°è¯»å–å‡ºæ¥çš„ä¸­æ–‡ä¹±ç ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¯†åˆ«æ–‡ä»¶ç¼–ç æ ¼å¼ï¼Œç„¶åä¸»åŠ¨è®¾ç½®å¯¹åº”çš„ç¼–ç å»è¯»å–å°±ä¸ä¼šä¹±ç ã€‚\n123456789101112131415161718192021222324252627282930313233//æ£€æŸ¥æ–‡ä»¶ç¼–ç  0=ANSI 1=UTF-16LE 2=UTF-16BE 3=UTF-8 4=UTF-8BOMint DataCsv::findCode(const QString &amp;fileName)&#123;    //å‡å®šé»˜è®¤ç¼–ç utf8    int code = 3;    QFile file(fileName);    if (file.open(QIODevice::ReadOnly)) &#123;        //è¯»å–3å­—èŠ‚ç”¨äºåˆ¤æ–­        QByteArray buffer = file.read(3);        quint8 b1 = buffer.at(0);        quint8 b2 = buffer.at(1);        quint8 b3 = buffer.at(2);        if (b1 == 0xFF &amp;&amp; b2 == 0xFE) &#123;            code = 1;        &#125; else if (b1 == 0xFE &amp;&amp; b2 == 0xFF) &#123;            code = 2;        &#125; else if (b1 == 0xEF &amp;&amp; b2 == 0xBB &amp;&amp; b3 == 0xBF) &#123;            code = 4;        &#125; else &#123;            //å°è¯•ç”¨utf8è½¬æ¢,å¦‚æœå¯ç”¨å­—ç¬¦æ•°å¤§äº0,åˆ™è¡¨ç¤ºæ˜¯ansiç¼–ç             QTextCodec::ConverterState state;            QTextCodec *codec = QTextCodec::codecForName(&quot;utf-8&quot;);            codec-&gt;toUnicode(buffer.constData(), buffer.size(), &amp;state);            if (state.invalidChars &gt; 0) &#123;                code = 0;            &#125;        &#125;        file.close();    &#125;    return code;&#125;\n\nåœ¨è¿æ¥è¿œç¨‹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢æ•°æ®çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°å¾ˆæ…¢ï¼Œå°¤å…¶æ˜¯è¡¨æ•°æ®é‡è¶Šå¤šè¶Šæ…¢ï¼Œæœ¬åœ°çš„è¯åŒç­‰æ•°æ®é‡å¿«å¾ˆå¤šï¼Œå¯ä»¥å°è¯•å¼€å¯åªå‰è¿›å±æ€§ï¼Œquery.setForwardOnly(true);è¿™æ ·çš„è¯åªä¼šç¼“å­˜ä¸€æ¬¡çš„æ•°æ®ï¼Œå¤§å¤§æé«˜è¿œç¨‹æ•°æ®åº“çš„æŸ¥è¯¢æ•ˆç‡ï¼Œæ®è¯´å¯ä»¥æé«˜å‡ åå€ç™¾å€çš„é€Ÿåº¦ã€‚å½“ç„¶å‰ææ˜¯å¯¹æŸ¥è¯¢çš„æ•°æ®ä¹‹å‰å‘å‰å–æ•°æ®çš„éœ€æ±‚ï¼Œå¦‚æœè¿˜è¦å¾€åå–æ•°æ®æˆ–è€…åœ¨æ•°æ®æ¨¡å‹QSqlQueryModelä¸­ä½¿ç”¨ï¼Œåˆ™ä¸èƒ½å¼€å¯æ­¤å±æ€§ã€‚åŸå› åœ¨æ¯æ¬¡åˆ©ç”¨QSqlQueryè·å–ä¸‹ä¸€æ¡è®°å½•æ—¶ï¼Œè‹¥ä¸å¼€å¯isForwardOnlyå±æ€§ï¼ˆå¾ˆé—æ†¾é»˜è®¤å°±æ˜¯ä¸å¼€å¯ï¼‰ï¼Œåˆ™æ¯æ¬¡éƒ½å¼€è¾Ÿæ–°çš„å†…å­˜ç©ºé—´ï¼Œæ¥å­˜å‚¨å·²ç»è®¿é—®åŠæœªè®¿é—®çš„è®°å½•ï¼Œè¿™æ ·ï¼Œæ¯æ¬¡éƒ½ä¼šæµªè´¹å¥½å¤šå­˜å‚¨ç©ºé—´ã€‚\n\nQtä¸­çš„painterç»˜åˆ¶éå¸¸çµæ´»å¼ºå¤§ï¼Œæ¥å£ä¸°å¯Œï¼Œä½†æ˜¯å¯¹äºå¾ˆå¤šåˆå­¦è€…æ¥è¯´è¿˜æ˜¯æœ‰ä¸€å®šçš„éš¾åº¦ï¼Œå°¤å…¶æ˜¯å„ç§å¥‡å¥‡æ€ªæ€ªçš„å¤æ‚æ ¼å¼ï¼Œè€Œè¿™äº›æ ¼å¼ç”¨htmlç¡®å¾ˆå¥½æè¿°ï¼Œæ¯”å¦‚æ§åˆ¶è¡Œé—´è·ã€å­—ç¬¦é—´è·ç­‰ï¼Œæ­¤æ—¶å¯ä»¥ç”¨QTextDocumentä¼ å…¥htmlæ ¼å¼å†…å®¹äº¤ç»™QPainterç»˜åˆ¶ï¼Œéå¸¸å®Œç¾ã€ç®€å•ã€å¼ºå¤§ï¼ŒåŒ…æ‹¬ä¸€äº›æ•°å­¦å…¬å¼å•¥çš„ã€‚\n12345678910void Form::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);    QTextDocument doc;    doc.setHtml(html);    //è®¾ç½®æ–‡æœ¬å®½åº¦    doc.setTextWidth(200);    //æŒ‡å®šç»˜åˆ¶åŒºåŸŸ    doc.drawContents(&amp;painter, QRect(0, 0, 200, 70));&#125;\n\nQtä¸­æ ·å¼è¡¨å¯¹é€‰ä¸­é¢œè‰²å’Œæ‚¬åœé¢œè‰²æ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼Œæ ¹æ®å¯¹æ“ä½œç³»ç»Ÿé»˜è®¤æ ·å¼çš„è§‚å¯Ÿï¼Œå½“å¤„äºé€‰ä¸­çŠ¶æ€+æ‚¬åœçŠ¶æ€çš„æ—¶å€™ï¼Œé»˜è®¤å–æ‚¬åœçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯é¼ æ ‡ç§»åŠ¨åˆ°é€‰ä¸­çš„åˆ—è¡¨itemä¸Šï¼Œé¢œè‰²å–æ‚¬åœçŠ¶æ€é¢œè‰²ã€‚è€ŒQtä¸­å¦‚æœä¸¤ç§é¢œè‰²éƒ½è®¾ç½®äº†ï¼Œæ ¹æ®è®¾ç½®çš„é¡ºåºæ¥ï¼Œå–æœ€åçš„ä¸ºå‡†ï¼Œå¦‚æœæœ€åè®¾ç½®çš„é€‰ä¸­çŠ¶æ€é¢œè‰²ï¼Œåˆ™å½“itemå¤„äºé€‰ä¸­çŠ¶æ€+æ‚¬åœçŠ¶æ€çš„æ—¶å€™ï¼Œå–é€‰ä¸­çŠ¶æ€é¢œè‰²è€Œä¸æ˜¯æ‚¬åœçŠ¶æ€é¢œè‰²ï¼Œåˆ‡è®°ï¼\n12345678910//ä¸‹é¢è¿™æ ·è®¾ç½®åˆ™å½“é¼ æ ‡åœç•™åœ¨é€‰ä¸­çš„itemä¸Šæ—¶èƒŒæ™¯é¢œè‰²=#00FF00QTableView::item:selected&#123;background:#FF0000;&#125;QTableView::item:hover&#123;background:#00FF00;&#125;//ä¸‹é¢è¿™æ ·è®¾ç½®åˆ™å½“é¼ æ ‡åœç•™åœ¨é€‰ä¸­çš„itemä¸Šæ—¶èƒŒæ™¯é¢œè‰²=#FF0000QTableView::item:hover&#123;background:#00FF00;&#125;QTableView::item:selected&#123;background:#FF0000;&#125;//å·¦ä¸Šè§’æ ·å¼å¾ˆå®¹æ˜“å¿½ç•¥QTableCornerButton:section&#123;background:#FF0000;&#125;\n\nqtcå¼€å‘å·¥å…·å†…ç½®äº†ä¸å°‘çš„å‡½æ•°ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œä¸€äº›åˆ¤æ–­å’Œå¤„ç†ã€‚\n12345//æœ€å°ç‰ˆæœ¬è¦æ±‚!minQtVersion(5, 15, 2) &#123;    message(&quot;Cannot build Qt Installer Framework with Qt version $$&#123;QT_VERSION&#125;.&quot;)    error(&quot;Use at least Qt 5.15.2.&quot;)&#125;\n\næœ‰æ—¶å€™æ–‡æœ¬æ¡†ä¸­çš„å†…å®¹è¿‡é•¿ï¼Œè€Œæ–‡æœ¬æ¡†é»˜è®¤å…‰æ ‡åœ¨å°¾éƒ¨ï¼Œæ‰€ä»¥è¦ä¸»åŠ¨è®¾ç½®ä¸‹å°†å…‰æ ‡ç§»åˆ°æœ€å‰é¢\n12345//ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥ui-&gt;lineEdit-&gt;setSelection(0, 0);ui-&gt;lineEdit-&gt;setCursorPosition(0);//æ ·å¼è¡¨æ–¹å¼&quot;QLineEdit&#123;qproperty-cursorPosition:0;&#125;\n\nå…³äºQtæµè§ˆå™¨æ¨¡å—çš„å‡ ç‚¹è¯´æ˜ã€‚\n\n\n\nQt5.6ä»¥å‰ç”¨çš„æ˜¯webkitï¼ŒQt5.6ç‰ˆæœ¬ä»¥ååˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯mingwç¼–è¯‘å™¨ï¼ˆwindowsç³»ç»Ÿï¼‰å¯¹åº”çš„Qtåº“ä¸å†æä¾›æµè§ˆå™¨æ¨¡å—ã€‚\nQt5.6ä»¥åçš„ç‰ˆæœ¬åœ¨linuxç³»ç»Ÿå’Œmacç­‰ç³»ç»Ÿï¼Œéƒ½ä¸å­˜åœ¨æ²¡æœ‰æµè§ˆå™¨æ§ä»¶çš„æƒ…å†µï¼Œéƒ½ä½¿ç”¨çš„æ˜¯webengineã€‚\nä»…ä»…æ˜¯windowsä¸Šçš„mingwç¼–è¯‘å™¨çš„Qtç‰ˆæœ¬æ²¡æœ‰ï¼Œå…¶ä»–ç³»ç»Ÿå…¶å®éƒ½æœ‰çš„ã€‚å¾ˆå¤šäººåœ¨è¿™ä¸ªåœ°æ–¹éƒ½æœ‰ç–‘é—®ï¼Œéƒ½ä»¥ä¸ºåªæœ‰msvcç¼–è¯‘å™¨æœ‰æµè§ˆå™¨æ§ä»¶ï¼Œå…¶å®ç¡®åˆ‡çš„è¯´æ˜¯åœ¨windowsä¸Šmsvcçš„Qtåº“å¸¦æµè§ˆå™¨æ§ä»¶ã€‚\nå®‰è£…Qtçš„æ—¶å€™webengineæ¨¡å—é»˜è®¤ä¸å‹¾é€‰ï¼Œéœ€è¦ä¸»åŠ¨å‹¾é€‰æ‰ä¼šå®‰è£…ã€‚\nä¹Ÿä¸æ˜¯æ‰€æœ‰çš„msvcçš„Qtç‰ˆæœ¬éƒ½æœ‰webengineæµè§ˆå™¨æ¨¡å—ï¼Œå“ªæ€•ä½ å‹¾é€‰äº†ä¹Ÿæ²¡ç”¨ï¼Œæœ‰äº›ç‰ˆæœ¬å®˜æ–¹å¹¶æ²¡æœ‰ç¼–è¯‘ï¼Œéœ€è¦è‡ªè¡Œç¼–è¯‘ã€‚éœ€è¦åˆ°å¯¹åº”çš„Qtå®‰è£…ç›®å½•æŸ¥çœ‹æ˜¯å¦æœ‰ Qt5WebEngine.dll æ–‡ä»¶ã€‚\nå¦‚æœä»…ä»…æ˜¯ä¸ºäº†å¼¥è¡¥mingwç‰ˆæœ¬ç¼ºå¤±æµè§ˆå™¨æ¨¡å—çš„é—æ†¾ï¼Œæ¨èç”¨miniblinkã€‚\nå¦‚æœä¸ºäº†ç»Ÿä¸€å…¼å®¹å„ç§ç‰ˆæœ¬å’Œç³»ç»Ÿï¼Œæ¨èç”¨cefã€‚\nå¦‚æœæ²¡æœ‰å†å²åŒ…è¢±ï¼Œæ¨èç”¨webengineï¼Œä¸Qtçš„é›†æˆåº¦é«˜ã€‚\nwebkitå’Œminiblinké»˜è®¤éƒ½ä¸æ”¯æŒgpuï¼Œwebengineé»˜è®¤èµ°gpuã€‚\nqwebengineé»˜è®¤ä¸æ”¯æŒMP4ï¼Œéœ€è¦è‡ªå·±é‡æ–°ç¼–è¯‘ã€‚\n\n\nå…³äºç¼–è¯‘æ•°æ®åº“æ’ä»¶çš„å‡ ä¸ªç»éªŒæ€»ç»“ã€‚\n\n\nå®‰è£…å¯¹åº”çš„æ•°æ®åº“ï¼Œå®‰è£…åä¼šæœ‰includeå¤´æ–‡ä»¶å’Œlibé“¾æ¥åº“æ–‡ä»¶ï¼Œè¿™æ˜¯åŸºæœ¬çš„å‰æï¼Œç¼–è¯‘æ•°æ®åº“æ’ä»¶å¿…é¡»è¦æœ‰è¿™ä¸¤ä¸ªä¸œè¥¿ã€‚åŠ¡å¿…æ³¨æ„ï¼Œ32ä½çš„Qtå¿…é¡»å®‰è£…32ä½çš„æ•°æ®åº“æ‰èƒ½æ­£å¸¸ç¼–è¯‘æˆåŠŸï¼Œä½æ•°è¦ä¸€è‡´ã€‚\nå‡†å¤‡å¥½æ•°æ®åº“æ’ä»¶æºç ï¼Œæ¯”å¦‚qt-everywhere-src-5.14.2\\qtbase\\src\\plugins\\sqldrivers\\mysqlï¼Œå¯ä»¥åœ¨å®‰è£…Qtçš„æ—¶å€™å‹¾é€‰srcï¼Œæˆ–è€…åæœŸç›´æ¥å®˜ç½‘é‡æ–°ä¸‹è½½æºç è§£å‹å‡ºæ¥ã€‚\næ‰“å¼€ä½ è¦ç¼–è¯‘çš„æ•°æ®åº“æ’ä»¶æºç ï¼Œæ¯”å¦‚mysqlå°±æ‰“å¼€mysql.proï¼Œoracleå°±æ‰“å¼€oci.proã€‚\nåœ¨proä¸­æ³¨é‡Šæ‰ä¸€è¡Œ #QMAKE_USE +&#x3D; mysqlï¼Œå¦‚æœæ˜¯ocié¡¹ç›®åˆ™æ˜¯#QMAKE_USE +&#x3D; ociã€‚\nqsqldriverbase.priæ–‡ä»¶ä¸­æ³¨é‡Šæ‰ #include(..shadowed(..PWD)&#x2F;qtsqldrivers-config.pri)ã€‚\nmysql.proæ–‡ä»¶å†…å®¹ä¸‹é¢åŠ ä¸Šå¦‚ä¸‹ä»£ç ã€‚123path = C:/Qt/mysql-5.7.30-winx64INCLUDEPATH += $$path/includewin32:LIBS += -L$$path/lib -llibmysql\noci.proæ–‡ä»¶å†…å®¹ä¸‹é¢åŠ ä¸Šå¦‚ä¸‹ä»£ç ã€‚123path = C:/app/Administrator/product/11.2.0/client_1INCLUDEPATH += $$path/oci/includewin32:LIBS += -L$$path/oci/lib/msvc -loci\npsql.proæ–‡ä»¶å†…å®¹ä¸‹é¢åŠ ä¸Šå¦‚ä¸‹ä»£ç ã€‚123path = &quot;C:/Program Files/PostgreSQL/13&quot;INCLUDEPATH += $$path/includewin32:LIBS += -L$$path/lib -llibpq\nä»¥ä¸Šå†™æ³•åŒæ—¶æ”¯æŒmingwå’Œmsvcï¼Œå…¶ä»–ç³»ç»Ÿç¼–è¯‘è¿‡ç¨‹ä¹Ÿæ˜¯ç±»ä¼¼ã€‚ç¼–è¯‘å®Œæˆåé»˜è®¤ä¼šåœ¨ä½ å½“å‰æºç æ‰€åœ¨ç›˜ç¬¦çš„æ ¹ç›®å½•ä¸‹ï¼Œä¼šå‡ºç°pluginsç›®å½•ï¼Œé‡Œé¢sqldriversç›®å½•ä¸‹å°±æ˜¯å¯¹åº”ç¼–è¯‘ç”Ÿæˆå¥½çš„æ’ä»¶åŠ¨æ€åº“ã€‚\né»˜è®¤oracleçš„æ’ä»¶é©±åŠ¨ä»£ç æ˜¯æŒ‰ç…§oracle12çš„å‡½æ•°å†™çš„ï¼Œå¦‚æœé“¾æ¥çš„æ˜¯oracle11ï¼Œåˆ™éœ€è¦æ”¹åŠ¨ä¸¤è¡Œä»£ç æ‰èƒ½ç¼–è¯‘æˆåŠŸã€‚æ‰“å¼€qsql_oci.cppæ–‡ä»¶å¤§æ¦‚åœ¨1559è¡Œä»£ç å·¦å³ï¼Œæœ‰ä¸ªOCIBindByPos2å‡½æ•°æ”¹æˆOCIBindByPosï¼Œä¸‹é¢è¿˜æœ‰ä¸€è¡ŒbindColumn.lengthsæ”¹æˆ(ub2*)bindColumn.lengthsã€‚\n\n\nå…³äºQtæ•°æ®åº“å¼€å‘çš„ä¸€äº›å†·çŸ¥è¯†ã€‚\n\n\nQtå³æ”¯æŒåº“çš„å½¢å¼ç›´æ¥å’Œæ•°æ®åº“é€šä¿¡ï¼Œä¹Ÿæ”¯æŒODBCæ•°æ®æºçš„å½¢å¼å’Œå„ç§æ•°æ®åº“é€šä¿¡ï¼Œè¿™æ ·å°±æ¶µç›–äº†æ‰€æœ‰çš„æƒ…å†µã€‚\nQtæ•°æ®åº“ç¨‹åºæ‰“åŒ…å‘å¸ƒï¼Œæ‰€æœ‰å‰æï¼šæ³¨æ„åŒºåˆ†32&#x2F;64ä½ï¼Œä½ çš„ç¨‹åºæ˜¯32ä½çš„å°±å¿…é¡»å¸¦ä¸Š32ä½çš„åº“ï¼Œ64ä½çš„å¿…é¡»å¸¦ä¸Š64ä½çš„åº“ï¼Œè¿™ç‚¹Qtçš„åº“ä¹Ÿæ˜¯è¿™ä¸ªè¦æ±‚ã€‚mysqlå‘å¸ƒæœ€ç®€å•ï¼Œå¸¦ä¸Šä¸€ä¸ªmysqlçš„åŠ¨æ€åº“æ–‡ä»¶å°±è¡Œï¼ˆwindowsä¸Šçš„æ˜¯libmysql.dllï¼‰ï¼Œéå¸¸ç®€å•ã€‚sqlserverä¸ç”¨å¸¦ï¼Œå› ä¸ºæ˜¯å¾®è½¯çš„äº²å„¿å­ï¼Œä¸€èˆ¬æ“ä½œç³»ç»Ÿè‡ªå¸¦ã€‚postgreséœ€è¦å¸¦ä¸Šlibpq.dllã€libintl-8.dllã€libiconv-2.dllã€libeay32.dllã€ssleay32.dllè¿™å‡ ä¸ªæ–‡ä»¶å°±è¡Œã€‚oracleéœ€è¦å¸¦ä¸Šoci.dllã€oraociei11.dllï¼ˆè¿™ä¸ªæ–‡ä»¶å¾ˆå¤§æœ‰130MB+ï¼‰ï¼Œå¦‚æœä¸è¡Œå»ºè®®ç›´æ¥å®‰è£…ä¸ªoracle clientå®¢æˆ·ç«¯è½¯ä»¶ï¼Œç„¶åå¯¹åº”binç›®å½•è®¾ç½®åˆ°ç¯å¢ƒå˜é‡å°±å¥½ã€‚\næ‰“åŒ…å‘å¸ƒåæµ‹è¯•ä¸‹æ¥ï¼Œå‘ç°32ä½çš„ç¨‹åºä¹Ÿå¯ä»¥æ­£å¸¸è¿æ¥64ä½çš„mysqlï¼Œ64ä½çš„ç¨‹åºä¹Ÿå¯ä»¥æ­£å¸¸è¿æ¥32ä½çš„mysqlï¼Œå› æ­¤åˆ¤æ–­åªè¦å’Œç¨‹åºçš„åº“çš„ä½æ•°ä¸€è‡´å°±è¡Œï¼ˆç¼–è¯‘çš„æ—¶å€™ä¹Ÿæ˜¯è¿™ä¸ªè§„åˆ™ï¼Œ32ä½çš„Qtç¨‹åºç¼–è¯‘æ•°æ®åº“æ’ä»¶ä¹Ÿè¦ç”¨32ä½çš„æ•°æ®åº“é“¾æ¥åº“ã€‚ï¼‰ï¼Œä¸éœ€è¦å’Œå…·ä½“çš„æ•°æ®åº“çš„ä½æ•°ä¸€è‡´ï¼Œæµ‹è¯•è¿‡mysqlã€sqlserverã€postgresqlæ•°æ®åº“éƒ½æ˜¯ç±»ä¼¼è§„åˆ™ã€‚\nå¤§é‡æµ‹è¯•å¯¹æ¯”ä¸‹æ¥ï¼Œé€šè¿‡odbcæ•°æ®æºçš„æ–¹å¼å’Œç›´è¿æ•°æ®åº“çš„æ–¹å¼æ‰¹é‡æ’å…¥å¤§é‡æ•°æ®è®°å½•ï¼Œç›´è¿æ–¹å¼é€Ÿåº¦æ›´å¿«ï¼Œçº¦5%å·¦å³ï¼Œæ‰€ä»¥å»ºè®®å°½é‡é‡‡ç”¨æ­¤æ–¹å¼ï¼Œæ˜¯åœ¨æ²¡æœ‰æ­¤æ–¹å¼çš„ç¯å¢ƒæ‰é‡‡ç”¨odbcæ•°æ®æºçš„æ–¹å¼ï¼ŒQté»˜è®¤è‡ªå¸¦odbcæ•°æ®åº“æ’ä»¶ã€‚\nä¸åŒæ•°æ®åº“åœ¨æ‰§è¡Œsqlè„šæœ¬çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å°†è¡¨åæˆ–è€…å­—æ®µåè½¬æˆå¤§å†™æˆ–å°å†™ï¼Œmysqlä¼šå°†è¡¨åè½¬æˆå°å†™ã€postgresqlä¼šå°†è¡¨åå’Œå­—æ®µåè½¬æˆå°å†™ã€oracleä¼šå°†è¡¨åå’Œå­—æ®µåè½¬æˆå¤§å†™ã€‚è¿™å°±å¯¼è‡´ä½¿ç”¨QSqlTableModelè°ƒç”¨setTableè®¾ç½®æ•°æ®åº“è¡¨åçš„æ—¶å€™ï¼Œä¸€å®šè¦å’Œæ•°æ®åº“ä¸­çš„è¡¨åä¸€è‡´ï¼ŒåŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å°±æ˜¯åœ¨å¯¹postgresqlå’Œoracleæ•°æ®åº“çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ï¼Œæœ¬äººå°±æ˜¯åœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œå·®ç‚¹è¦æŠŠè¿™å·¨å¤§çš„å±ç›†æ‰£åœ¨Qtçš„BUGä¸Šã€‚123456789101112void DbHelper::bindTable(const QString &amp;dbType, QSqlTableModel *model, const QString &amp;table)&#123;    //postgresqlå…¨éƒ¨å°å†™,oracleå…¨éƒ¨å¤§å†™,è¿™ä¸¤ä¸ªæ•°æ®åº“ä¸¥æ ¼åŒºåˆ†è¡¨åå­—æ®µåçš„å¤§å°å†™å§æ§½    QString flag = dbType.toUpper();    if (flag == &quot;POSTGRESQL&quot;) &#123;        model-&gt;setTable(table.toLower());    &#125; else if (flag == &quot;ORACLE&quot;) &#123;        model-&gt;setTable(table.toUpper());    &#125; else &#123;        model-&gt;setTable(table);    &#125;&#125;\nQtæ”¯æŒä¸æŒ‡å®šæ•°æ®åº“åæ‰“å¼€æ•°æ®åº“ï¼Œå› ä¸ºæœ‰æ—¶å€™æ˜¯è¦åœ¨è¿æ¥æ•°æ®åº“æœåŠ¡å™¨åï¼Œæ‰§è¡Œsqlè¯­å¥åˆ›å»ºæ•°æ®åº“ã€‚æ•°æ®åº“éƒ½è¿˜æ²¡å­˜åœ¨æ€ä¹ˆè¿æ¥å‘¢ï¼Œæµ‹è¯•å‘ç°sqliteã€mysqlã€sqlserverã€postgresqléƒ½æ”¯æŒè¿™ä¸ªç‰¹æ€§ã€‚åœ¨åˆ é™¤å’Œåˆ›å»ºæ•°æ®åº“çš„å‰ææ˜¯è¯¥æ•°æ®åº“æ²¡æœ‰è¢«å…¶ä»–ç¨‹åºå ç”¨ï¼Œæ¯”å¦‚å…¶ä»–ç¨‹åºå·²ç»æ‰“å¼€äº†è¯¥æ•°æ®åº“åˆ™ä¼šæ‰§è¡Œå¤±è´¥ã€‚è¿™é‡Œæˆ‘å°±æŠ˜ç£¨è¿‡å¾ˆå¤šæ¬¡ï¼Œä¸ºä»€ä¹ˆæ‰§è¡Œå¤±è´¥å‘¢ï¼Ÿåé¢å‘ç°ç¬¬ä¸‰æ–¹æ•°æ®åº“å·¥å…·å·²ç»æ‰“å¼€äº†è¯¥æ•°æ®åº“ï¼ŒæŠŠå·¥å…·å…³æ‰å°±okäº†ã€‚12345678910111213141516171819QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QMYSQL&quot;);//database.setDatabaseName(&quot;dbtool&quot;);database.setHostName(&quot;127.0.0.1&quot;);database.setPort(3306);database.setUserName(&quot;root&quot;);database.setPassword(&quot;root&quot;);if (database.open()) &#123;    QSqlQuery query(database);    qDebug() &lt;&lt; &quot;åˆ é™¤æ•°æ®åº“&quot; &lt;&lt; query.exec(&quot;drop database dbtool&quot;);    qDebug() &lt;&lt; &quot;åˆ›å»ºæ•°æ®åº“&quot; &lt;&lt; query.exec(&quot;create database dbtool&quot;);    if (query.exec(&quot;select * from userinfo&quot;)) &#123;        while (query.next()) &#123;            qDebug() &lt;&lt; &quot;æŸ¥è¯¢æ•°æ®åº“&quot; &lt;&lt; query.value(0);        &#125;    &#125;&#125; else &#123;     qDebug() &lt;&lt; &quot;æ‰“å¼€æ•°æ®åº“&quot; &lt;&lt; database.lastError().text();&#125;\nç”¨QSqlQueryModel+QTableViewæ˜¾ç¤ºæ•°æ®ï¼Œintç±»å‹çš„æ•°æ®ï¼Œå¦‚æœè¶…è¿‡100ä¸‡ï¼Œä¼šå˜æˆç§‘å­¦è®¡æ•°æ˜¾ç¤ºï¼Œè¿™å°±å¾ˆæ¼ç«äº†ï¼Œè‚¯å®šä¸æ˜¯è‡ªå·±æƒ³è¦çš„ç»“æœã€‚æ‰¾éç½‘ç»œæœç´¢ï¼Œç»ˆäºæ‰¾åˆ°ä¸€ä¸ªåŒæ ·é—®é¢˜çš„å“¥ä»¬ï¼Œéœ€è¦å¯¹è¿™ä¸€åˆ—åŠ ä¸ªç©ºçš„å§”æ‰˜å°±è¡Œã€‚åé¢å‘ç°ç©ºå§”æ‰˜ä¹Ÿä¸è¡Œï¼Œè¶…è¿‡1000ä¸‡æ¡åˆå±Œæ ·äº†ï¼Œéœ€è¦ç»ˆæå¤§æ³•é‡è½½æ•°æ®æ¨¡å‹æ˜¾ç¤ºã€‚123456789101112131415ui-&gt;tableView-&gt;setItemDelegateForColumn(0, new QItemDelegate);//ä¸‹é¢æ˜¯ç»ˆæå¤§æ³•QVariant SqlQueryModel::data(const QModelIndex &amp;index, int role) const&#123;    QVariant value = QSqlQueryModel::data(index, role);    //è¶…è¿‡100ä¸‡çš„æ•°å€¼ä¼šè¢«ç§‘å­¦è®¡æ•°æ˜¾ç¤ºéœ€è¦è¿™é‡Œè½¬æˆå­—ç¬¦ä¸²æ˜¾ç¤º    if (role == Qt::DisplayRole) &#123;        int result = value.toInt();        if (result &gt;= 1000000) &#123;            value = QString::number(result);        &#125;    &#125;    return value&#125;\nmysqlæ•°æ®åº“æœ‰å¤šç§æ•°æ®åº“å¼•æ“ï¼Œå…¶ä¸­MyIsamä¸æ”¯æŒæ•°æ®åº“äº‹åŠ¡ï¼Œé»˜è®¤ä¸€èˆ¬æ˜¯è¿™ä¸ªå¼•æ“ï¼Œæ‰€ä»¥å½“ä½ ä½¿ç”¨Qtä¸­çš„transactionæ–¹æ³•åcommitæäº¤æ—¶å€™ï¼Œä¼šå‘ç°ä¸æˆåŠŸï¼Œå…¶å®äº‹å®ä¸Šåˆæ˜¯æˆåŠŸçš„ï¼Œå»æ•°æ®åº“é‡Œé¢æŸ¥çœ‹å¯¹åº”çš„ç»“æœåˆæ˜¯æ­£ç¡®çš„ã€‚æœ‰ä¸¤ä¸ªåŠæ³•ï¼Œç¬¬ä¸€å°±æ˜¯å°†æ•°æ®åº“å¼•æ“æ”¹æˆInnoDBï¼Œç¬¬äºŒå°±æ˜¯åœ¨æäº¤ååšä¸ªé”™è¯¯åˆ¤æ–­ if (database.commit() || !database.lastError().isValid()) ï¼Œé”™è¯¯ä¸å¯ç”¨ä¹Ÿè¯´æ˜æ˜¯æˆåŠŸçš„ã€‚\nå¦‚æœé‡‡ç”¨odbcæ•°æ®æºé€šä¿¡ï¼Œåˆ™åªéœ€è®¾ç½®æ•°æ®åº“åç§°setDatabaseNameã€è®¾ç½®ç”¨æˆ·åç§°setUserNameã€è®¾ç½®ç”¨æˆ·å¯†ç setPasswordè¿™ä¸‰ä¸ªå‚æ•°å³å¯ï¼Œå› ä¸ºæ•°æ®æºé…ç½®çš„æ—¶å€™å°±å·²ç»è®¾ç½®å¥½å¯¹åº”çš„ä¸»æœºåœ°å€å’Œç«¯å£ä»¥åŠå…³è”çš„æ•°æ®åº“åç§°ï¼Œæ‰€ä»¥åœ¨ç”¨odbcæ•°æ®æºé€šä¿¡çš„æ—¶å€™åªéœ€è¦å†æ¬¡éªŒè¯ç”¨æˆ·ä¿¡æ¯å³å¯ã€‚è¿™é‡Œç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯setDatabaseNameè®¾ç½®æ•°æ®åº“åç§°è¦å¡«å†™æ•°æ®æºé…ç½®çš„åç§°ã€‚\nç»è¿‡å¤§é‡çš„å¯¹æ¯”æµ‹è¯•ï¼ŒåŒ…æ‹¬æ’å…¥ã€åˆ é™¤ã€æ‰¹é‡ã€æŸ¥è¯¢ã€åˆ†é¡µç­‰æ“ä½œï¼Œåƒä¸‡é‡çº§æ•°æ®ï¼Œåœ¨Qtæ•°æ®åº“éƒ¨åˆ†å“åº”é€Ÿåº¦è¿™å—ï¼Œå‹å¥½åº¦æ’åä¾æ¬¡æ˜¯ sqlite &gt; postgresql &gt; oracle &gt; mysql &gt; odbc ã€‚åƒä¸‡é‡çº§ä»¥ä¸Šæ˜¯ postgresql &gt; oracle &gt; mysql &gt; sqlite &gt; odbc ã€‚äº¿çº§åˆ«ä»¥ä¸Šæ˜¯ oracle &gt; postgresql &gt; å…¶ä»–ã€‚ä»¥ä¸Šæµ‹è¯•å‡å»ºç«‹åœ¨åˆå­¦è€…æ°´å¹³åŸºç¡€ä¸Šï¼Œè‡³äºåˆ†åº“åˆ†è¡¨ã€è”åˆæŸ¥è¯¢ã€ç¼“å­˜ã€å†…å­˜æ•°æ®åº“ç­‰å„ç§é«˜çº§çŸ¥è¯†ç‚¹æ²¡ç”¨ä¸Šã€‚\nmysqlä¸»è¦æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œmysql5.7å’Œmysql8ï¼Œå®˜æ–¹è¯´æ˜¯8æ¯”5è¦å¿«å¾ˆå¤šï¼Œä¸ªäººæµ‹è¯•ä¸‹æ¥ï¼Œ5.7æ¯”8è¦å¿«å¾ˆå¤šï¼Œæ— è®ºæ˜¯æŸ¥è¯¢ï¼Œè¿˜æ˜¯æ‰¹é‡æ’å…¥æ•°æ®ï¼Œä¸çŸ¥é“ä¸ºä½•ï¼Œç½‘ä¸Šæœç´¢çš„ä¹Ÿæ˜¯è¿™ä¸ªç»“æœï¼ˆhttps://www.coder4.com/archives/7596ï¼‰ï¼Œå¤§å®¶éƒ½è¯´8æ…¢äº†å¾ˆå¤šã€‚\nmysqlæœ‰ä¸ªåˆ†æ”¯å«mariadbï¼Œæ¯”mysqlæ›´çº¯æ­£ï¼Œæ®è¯´å„æ–¹é¢éƒ½åŠæ‰“mysqlï¼ˆhttps://blog.csdn.net/x275920/article/details/123847792ï¼‰ï¼Œä¸ªäººå¯¹æ¯”æµ‹è¯•ä¸‹æ¥ä¹Ÿæ˜¯ç¡®å®æ‰¹é‡æ’å…¥å’ŒæŸ¥è¯¢æ€§èƒ½è¦å¥½ä¸å°‘ï¼Œå¹¶ä¸”å®Œå…¨å…¼å®¹mysqlï¼Œç”šè‡³åº“æ–‡ä»¶ç›´æ¥é‡å‘½åä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚å°†libmariadb.dllæ”¹æˆlibmysql.dllå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè€Œä¸”ä½“ç§¯è¿˜å°äº†å…«å€ï¼Œè¿™ä¸ªå¥½ï¼Œå‘å¸ƒçš„æ—¶å€™åˆå°‘äº†å¥½å‡ å…†ã€‚\nå¦‚æœæ˜¯Qt+mysqlç¨‹åºï¼Œå‘å¸ƒçš„æ—¶å€™å¸¦çš„åº“ç‰ˆæœ¬è¦å’Œæ’ä»¶å¯¹åº”æ•°æ®åº“ç‰ˆæœ¬ä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½æ²¡æœ‰æ•°æ®åº“äº‹åŠ¡ç‰¹æ€§ï¼Œdatabase.driver()-&gt;hasFeature(QSqlDriver::Transactions)ä¸ºå‡ã€‚\nQSqlTableModelå°è£…çš„éå¸¸å¥½ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®ï¼Œè€Œæ˜¯éšç€æ»šåŠ¨æ¡çš„æ‹‰åŠ¨åŠ è½½éœ€è¦çš„æ•°æ®ï¼Œæµ‹è¯•ä¸€äº¿æ¡çš„è¡¨ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œå’Œå‡ åƒæ¡çš„è¡¨é€Ÿåº¦ä¸€æ ·ã€‚\nåœ¨è¿æ¥ç½‘ç»œæ•°æ®åº“çš„æ—¶å€™ï¼Œå¦‚æœä½ æœ¬åœ°ç½‘ç»œè®¾ç½®äº†ä»£ç†ï¼Œæ¯”å¦‚ä½¿ç”¨äº†ä»£ç†ä¸Šgithubç­‰ç½‘ç«™ï¼Œå°±ä¼šå‘ç°Qtçš„æ•°æ®åº“ç¨‹åºè¿ä¸ä¸Šï¼Œä½ éœ€è¦è®¾ç½®ä¸‹ä¸ä½¿ç”¨æœ¬åœ°ä»£ç†è®¾ç½® QNetworkProxyFactory::setUseSystemConfiguration(false) ã€‚è¿™ä¸ªåœ°æ–¹å¦‚æœä¸ä»”ç»†ä¼šæ‰¾é—®é¢˜æ‰¾åˆ°ä½ æ€€ç–‘äººç”Ÿã€‚\n\n24ï¼š231-240\nå…³äºc++ä¸­ç»§æ‰¿å¤šæ€virtualå’Œoverrideçš„å‡ ç‚¹æ€»ç»“ã€‚\n\n\nå­ç±»å¯ä»¥ç›´æ¥ä½¿ç”¨åŸºç±»ä¸­çš„protectedä¸‹çš„å˜é‡å’Œå‡½æ•°ã€‚\nåŸºç±»å‡½æ•°æ²¡åŠ virtualï¼Œå­ç±»æœ‰ç›¸åŒå‡½æ•°ï¼Œå®ç°çš„æ˜¯è¦†ç›–ã€‚ç”¨åŸºç±»æŒ‡é’ˆè°ƒç”¨æ—¶ï¼Œè°ƒç”¨åˆ°çš„æ˜¯åŸºç±»çš„å‡½æ•°ï¼›ç”¨å­ç±»æŒ‡é’ˆè°ƒç”¨æ—¶ï¼Œè°ƒç”¨åˆ°çš„æ˜¯å­ç±»çš„å‡½æ•°ã€‚\nåŸºç±»å‡½æ•°åŠ äº†virtualï¼Œå­ç±»æœ‰ç›¸åŒå‡½æ•°ï¼Œå®ç°çš„æ˜¯é‡å†™ã€‚ç”¨åŸºç±»æŒ‡é’ˆæˆ–å­ç±»æŒ‡é’ˆè°ƒç”¨æ—¶ï¼Œè°ƒç”¨åˆ°çš„éƒ½æ˜¯å­ç±»çš„å‡½æ•°ã€‚\nå‡½æ•°åŠ ä¸Šoverrideï¼Œå¼ºåˆ¶è¦æ±‚å­ç±»ç›¸åŒå‡½æ•°éœ€è¦æ˜¯è™šå‡½æ•°ï¼Œè€Œä¸”å¿…é¡»é‡æ–°å®ç°ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™ã€‚\nå­ç±»çš„virtualå¯åŠ å¯ä¸åŠ ï¼Œå»ºè®®åŠ overrideä¸åŠ virtualã€‚\nåŸºç±»ä¸­çš„çº¯è™šå‡½æ•°ï¼ˆvirtual void play() &#x3D; 0;ï¼‰åœ¨åŸºç±»ä¸­æ— éœ€åœ¨cppä¸­å®ç°ï¼Œä½†æ˜¯å¿…é¡»åœ¨å­ç±»å®ç°ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™ã€‚\nç»§æ‰¿å¤šæ€æœ€å¤§çš„å¥½å¤„å°±æ˜¯æç‚¼å…±æ€§ï¼Œå°†é€šç”¨çš„å˜é‡å’Œæ–¹æ³•ä¿¡å·ç­‰ï¼Œå…¨éƒ¨æ”¾åœ¨åŸºç±»ï¼Œå­ç±»è´Ÿè´£å®ç°è‡ªå·±éœ€è¦çš„ç‰¹æ®Šçš„éƒ¨åˆ†å³å¯ã€‚\n\n\nå…³äº QTableViewã€QTableWidget æ‚¬åœæ•´è¡Œé€‰ä¸­æ•ˆæœï¼Œç½‘ä¸Šå¤§å¤šæ•°éƒ½æ˜¯é’ˆå¯¹ QTableWidget çš„å®ç°ï¼Œé’ˆå¯¹ QTableView çš„ä¹Ÿéƒ½æ˜¯é€šè¿‡å§”æ‰˜æˆ–è€…é‡æ–°painterå®ç°ã€‚\n\n\nå‰æï¼šè®¾ç½®é€‰ä¸­å•å…ƒæ ¼è‡ªåŠ¨é€‰ä¸­æ•´è¡Œï¼ŒtableView-&gt;setSelectionBehavior(QAbstractItemView::SelectRows);\nå®‰è£…äº‹ä»¶è¿‡æ»¤å™¨ï¼Œè¯†åˆ«åˆ°å½“å‰åæ ‡å¤„çš„æ•°æ®æ¨¡å‹ï¼Œç„¶åè®¾ç½®å½“å‰æ¨¡å‹ä¸ºé¼ æ ‡æ‚¬åœå¤„çš„æ¨¡å‹å³å¯ã€‚è¿™ä¸ªå–å·§çš„åŠæ³•å¯ä»¥èŠ‚çœå¤§é‡çš„å·¥ä½œã€‚\næ— è®º QTableViewã€QTableWidget éƒ½ç”¨æ­¤æ–¹æ³•éƒ½å¯ä»¥ã€‚\n\n\nQtä¸­å¦‚ä½•é¿å…å’Œç¬¬ä¸‰æ–¹çš„signalsã€slotsç­‰å…³é”®å­—å†²çªã€‚\n\n\nç¬¬ä¸€æ­¥ï¼šåœ¨proä¸­åŠ ä¸Š CONFIG +&#x3D; no_keywords ã€‚\nç¬¬äºŒæ­¥ï¼šé¡¹ç›®ä¸­ä¹‹å‰æ‰€æœ‰çš„ signals æ”¹æˆ Q_SIGNALSï¼Œslots æ”¹æˆ Q_SLOTS ç­‰ã€‚\nç¬¬ä¸‰æ­¥ï¼šå½»åº•é‡æ–°ç¼–è¯‘é¡¹ç›®ï¼Œè¿™æ ·å°±å…³é”®å­—ä¸å†²çªäº†ã€‚\n\n\nproä¸­åŒºåˆ†ä¸åŒçš„æ“ä½œç³»ç»ŸåŠç¡¬ä»¶å¹³å°ã€‚\n123456789101112131415win32 &#123;&#125;unix &#123;&#125;//Qt5å¯ä»¥ç›´æ¥ç”¨ linux&#123;&#125; Qt4åˆ‡è®°éœ€è¦ç”¨ unix:!maxc&#123;&#125;unix:!maxc&#123;&#125;linux &#123;&#125;maxc &#123;&#125;android &#123;&#125;wasm &#123;&#125;//è¡¨ç¤º64ä½å¹³å°contains(QT_ARCH, x86_64) &#123;&#125;//è¡¨ç¤ºarmå¹³å°contains(QT_ARCH, arm) || contains(QT_ARCH, arm64) &#123;&#125;//ä¸‡èƒ½åŠæ³•ç›´æ¥åˆ‡æ¢åˆ°å¥—ä»¶æ‰“å°ä¸‹ QT_ARCH çœ‹ä¸‹ä»€ä¹ˆå­—ç¬¦message($$QT_ARCH)\n\nåœ¨æ˜¾ç¤ºè§†é¢‘ç”»é¢ä½ç½®çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæœ‰ä¸‰ç§æœºåˆ¶ä½œä¸ºå‚è€ƒï¼Œè‡ªåŠ¨æ¨¡å¼(è¶…è¿‡åˆ™ç­‰æ¯”ä¾‹ç¼©æ”¾å¦åˆ™åŸå›¾)ã€æ™®é€šæ¨¡å¼(ä»»ä½•å°ºå¯¸éƒ½ç­‰æ¯”ä¾‹ç¼©æ”¾)ã€å¡«å……æ¨¡å¼(ä»»ä½•å°ºå¯¸éƒ½æ‹‰ä¼¸å¡«å……)ã€‚Qtä¸­å›¾ç‰‡ç±»QImageéƒ½æä¾›äº†ç¼©æ”¾ç­–ç•¥çš„å‚æ•°è®¾ç½®ï¼Œæ¯”å¦‚Qt::KeepAspectRatioè¡¨ç¤ºç­‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ˜¯è®¾ç½®æ§ä»¶çš„å¤§å°ï¼Œå…¶å®QSizeç±»å°±æä¾›äº†å¯¹åº”çš„æ–¹æ³•scaleä¸“é—¨è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªæ–¹æ³•å¾ˆå®¹æ˜“è¢«å¿½è§†ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445//ç¼©æ”¾æ˜¾ç¤ºæ¨¡å¼enum ScaleMode &#123;    //è‡ªåŠ¨æ¨¡å¼(è¶…è¿‡åˆ™ç­‰æ¯”ä¾‹ç¼©æ”¾å¦åˆ™åŸå›¾)    ScaleMode_auto = 0,    //æ™®é€šæ¨¡å¼(ä»»ä½•å°ºå¯¸éƒ½ç­‰æ¯”ä¾‹ç¼©æ”¾)    ScaleMode_normal = 1,    //å¡«å……æ¨¡å¼(ä»»ä½•å°ºå¯¸éƒ½æ‹‰ä¼¸å¡«å……)    ScaleMode_fill = 2&#125;;//ä¼ å…¥å›¾ç‰‡å°ºå¯¸å’Œçª—ä½“åŒºåŸŸåŠè¾¹æ¡†å¤§å°è¿”å›å±…ä¸­åŒºåŸŸstatic QRect getCenterRect(const QSize &amp;imageSize, const QRect &amp;widgetRect, int borderWidth = 2, const ScaleMode &amp;scaleMode = ScaleMode_auto)&#123;    QSize newSize = imageSize;    QSize widgetSize = widgetRect.size() - QSize(borderWidth * 2, borderWidth * 2);    if (scaleMode == ScaleMode_auto) &#123;        if (newSize.width() &gt; widgetSize.width() || newSize.height() &gt; widgetSize.height()) &#123;            newSize.scale(widgetSize, Qt::KeepAspectRatio);        &#125;    &#125; else if (scaleMode == ScaleMode_normal) &#123;        newSize.scale(widgetSize, Qt::KeepAspectRatio);    &#125; else &#123;        newSize = widgetSize;    &#125;    int x = widgetRect.center().x() - newSize.width() / 2;    int y = widgetRect.center().y() - newSize.height() / 2;    return QRect(x, y, newSize.width(), newSize.height());&#125;//ä¼ å…¥å›¾ç‰‡å°ºå¯¸å’Œçª—ä½“å°ºå¯¸åŠç¼©æ”¾ç­–ç•¥è¿”å›åˆé€‚å°ºå¯¸çš„å›¾ç‰‡static void getScaledImage(QImage &amp;image, const QSize &amp;widgetSize, const ScaleMode &amp;scaleMode = ScaleMode_auto, bool fast = true)&#123;    Qt::TransformationMode mode = fast ? Qt::FastTransformation : Qt::SmoothTransformation;    if (scaleMode == ScaleMode_auto) &#123;        if (image.width() &gt; widgetSize.width() || image.height() &gt; widgetSize.height()) &#123;            image = image.scaled(widgetSize, Qt::KeepAspectRatio, mode);        &#125;    &#125; else if (scaleMode == ScaleMode_normal) &#123;        image = image.scaled(widgetSize, Qt::KeepAspectRatio, mode);    &#125; else &#123;        image = image.scaled(widgetSize, Qt::IgnoreAspectRatio, mode);    &#125;&#125;\n\nå…³äºåœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰å‡½æ•°ä½¿ç”¨staticå…³é”®å­—çš„è¡€çš„æ•™è®­ã€‚\n\n\n\næœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å°†ä¸€äº›å¸¸ç”¨å‡½æ•°å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ä¾›å¾ˆå¤šåœ°æ–¹è°ƒç”¨ï¼Œå¦‚æœå†™çš„æ˜¯ int doxxx{} è¿™ç§ï¼Œåœ¨ä½ å¤šä¸ªåœ°æ–¹å¼•ç”¨çš„æ—¶å€™ï¼Œè‚¯å®šä¼šç¼–è¯‘æŠ¥é”™æç¤º â€œé‡å¤å®šä¹‰â€ çš„é”™è¯¯ã€‚\næ­¤æ—¶ä½ éœ€è¦åœ¨å‡½æ•°å‰é¢åŠ ä¸Šstaticå…³é”®å­—ï¼Œå˜æˆ static int doxxx{} è¿™ç§ï¼Œèƒ½å¤Ÿæ­£å¸¸ç¼–è¯‘å’Œè¿è¡Œï¼Œä»¥ä¸ºä¸€åˆ‡ä¸‡äº‹å¤§å‰ï¼Œè¿˜æ˜¯æˆ‘å¤ªå¹´è½»ã€‚\nå¦‚æœä»…ä»…æ˜¯ä¸€ä¸ªç±»ä¸­åœ¨ä½¿ç”¨ï¼Œæˆ–è€…å‡½æ•°ä¸­æ²¡æœ‰é™æ€å˜é‡ï¼Œä¹Ÿä¸ä¼šå‡ºé—®é¢˜ï¼Œé—®é¢˜å°±åœ¨staticä¿®é¥°çš„å‡½æ•°åœ¨æ¯ä¸ªå¼•å…¥å¤´æ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šæ‹·è´ä¸€ä»½ï¼Œå¯¼è‡´å‡½æ•°é‡Œé¢çš„staticé™æ€å˜é‡ä¼šé‡å¤åˆå§‹åŒ–ï¼Œè¿™æ ·å°±ä¸æ­£ç¡®äº†ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç»ˆæåŠæ³•å°±æ˜¯åœ¨å¤–é¢å¥—ä¸ªç±»ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œå˜é‡æ”¾åˆ°ç±»ä¸­ï¼Œå®Œç¾ï¼Œå†ä¹Ÿä¸ä¼šç¡ä¸ç€äº†ï¼ŒçœŸé¦™ã€‚\nå…³äºC&#x2F;C++ ä¸­çš„staticå…³é”®å­—ï¼Œå»ºè®®å¤§å®¶å‚è€ƒè¿™ç¯‡æ–‡ç« å†™å¾— https://zhuanlan.zhihu.com/p/37439983ï¼Œé†é†çŒé¡¶ã€‚12345678910111213141516171819//æ–‡ä»¶å test.h//ä¸‹é¢è¿™ä¸ªå‡½æ•° ç¼–è¯‘æŠ¥é”™æç¤º â€œé‡å¤å®šä¹‰â€void test() &#123;&#125;//ä¸‹é¢4ä¸ªå‡½æ•°åœ¨æ¯ä¸ªå¼•å…¥å¤´æ–‡ä»¶çš„æ—¶å€™éƒ½ä¼šè¢«æ‹·è´ä¸€ä»½static void test1() &#123;&#125;inline void test2() &#123;&#125;static inline void test3() &#123;&#125;inline static void test4() &#123;&#125;//ä¿è¯æ²¡é—®é¢˜çš„å†™æ³•class tt &#123;    void test() &#123;&#125;    static void test1() &#123;&#125;    inline void test2() &#123;&#125;    static inline void test3() &#123;&#125;    inline static void test4() &#123;&#125;&#125;\n\n\nåœ¨æ•°æ®åº“æŸ¥è¯¢ä¸­ï¼Œä¸€èˆ¬ä¼šå»ºç«‹ç´¢å¼•ä»¥ä¾¿åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œæ¯”å¦‚å¸¸ç”¨çš„æ¡ä»¶å­—æ®µä½œä¸ºç´¢å¼•å­—æ®µã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™å¦‚æœæŸ¥è¯¢è¯­å¥æ²¡å†™å¥½ï¼Œå°±ç®—whereä¸­æœ‰ç´¢å¼•å­—æ®µä¹Ÿä¼šå¼•èµ·å…¨è¡¨æ‰«æï¼Œä¹Ÿå°±æ˜¯è¯´æ ¹æœ¬æ²¡ç”¨ä¸Šç´¢å¼•ï¼Œè¿™ç‚¹è¦ç§¯æçš„é¿å…ã€‚\n\n\næ¨¡ç³ŠæŸ¥è¯¢likeï¼Œå…¨æ¨¡ç³Š like â€˜%â€¦%â€™ å’Œå·¦æ¨¡ç³Š like â€˜%â€¦â€™ æ— æ³•ç›´æ¥ä½¿ç”¨ç´¢å¼•ï¼Œå³æ¨¡ç³ŠæŸ¥è¯¢ like â€˜â€¦%â€™ ä¼šä½¿ç”¨ç´¢å¼•ã€‚\næŸ¥è¯¢æ¡ä»¶ä¸­å«æœ‰is nullçš„selectè¯­å¥æ‰§è¡Œæ…¢ï¼Œis not null æ—¶æ°¸è¿œä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œä¸€èˆ¬æ•°æ®é‡å¤§çš„è¡¨ä¸è¦ç”¨is nullæŸ¥è¯¢ã€‚\nä¸ç­‰äºæ“ä½œç¬¦ &lt;&gt; å’Œ !&#x3D; ä¼šé™åˆ¶ç´¢å¼•ï¼Œå¼•èµ·å…¨è¡¨æ‰«æï¼Œå³ä½¿æ¯”è¾ƒçš„å­—æ®µä¸Šæœ‰ç´¢å¼•ã€‚\nwhereå­å¥ä¸­æ¯”è¾ƒçš„ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€ä¸ªæœ‰ç´¢å¼•ï¼Œä¸€ä¸ªæ²¡ç´¢å¼•ï¼Œä½¿ç”¨oråˆ™ä¼šå¼•èµ·å…¨è¡¨æ‰«æã€‚\nselect count(*) from table è¿™æ ·ä¸å¸¦ä»»ä½•æ¡ä»¶çš„countä¼šå¼•èµ·å…¨è¡¨æ‰«æã€‚\nin å’Œ not in ä¹Ÿè¦æ…ç”¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´å…¨è¡¨æ‰«æï¼Œèƒ½ç”¨ between å°±ä¸è¦ç”¨ inã€‚\nç”¨ &gt;&#x3D; æ›¿ä»£ &gt;ï¼Œæ¯”å¦‚ é«˜æ•ˆå†™æ³•ï¼šselect * from table where id &gt;&#x3D; 4ï¼Œä½æ•ˆå†™æ³•ï¼šselect * from table where id &gt; 3ã€‚\nå¦‚æœè¡¨æ•°æ®é‡å¾ˆå°ï¼Œæ¯”å¦‚å°±å‡ åƒè¡Œï¼Œè¯·å¿½ç•¥ä¸Šè¿°è­¦å‘Šï¼ŒåŠ ä¸åŠ ç´¢å¼•é—®é¢˜ä¸å¤§ï¼Œç”šè‡³æŸäº›æ—¶å€™åŠ ç´¢å¼•åè€Œå¤§å¤§å¢åŠ äº†æ•°æ®åº“æ–‡ä»¶çš„ä½“ç§¯ï¼Œå½±å“æ›´æ–°æ•°æ®åº“çš„é€Ÿåº¦ã€‚\n\n\nç”±äºQtåœ¨ä¸æ–­çš„æ›´æ–°æ¢ä»£ï¼Œå„ç§ç»„ä»¶è½®å­ä¹Ÿåœ¨å¢åŠ ã€æ‹†åˆ†ã€è°ƒæ•´ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–å†™é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ç‰ˆæœ¬å…¼å®¹çš„é—®é¢˜ï¼Œå°±éœ€è¦åœ¨proé¡¹ç›®æ–‡ä»¶å’Œä»£ç æ–‡ä»¶ä¸­åšå¯¹åº”çš„åˆ¤æ–­å¤„ç†ã€‚æ ¹æ®å¤šå¹´çš„ç»éªŒæ€»ç»“ï¼Œä¸€ä¸ªä¸‡èƒ½çš„åŠæ³•å°±æ˜¯åœ¨proä¸­å¢åŠ ä¸€ä¸ªDEFINESæ ‡è¯†ï¼Œç„¶åæ ¹æ®è¿™ä¸ªDEFINESæ ‡è¯†å¼•å…¥å¯¹åº”æ¨¡å—ï¼Œæœ€ååœ¨ä»£ç ä¸­é€šè¿‡#ifdefåˆ¤æ–­æ ‡è¯†æ‰§è¡Œå¯¹åº”ä»£ç ã€‚ç»è¿‡è¿™æ ·å€’è…¾å‡ ä¸‹ä½ çš„ä»£ç å¯ä»¥åœ¨ä½ç‰ˆæœ¬å’Œé«˜ç‰ˆæœ¬ç¼–è¯‘è¿è¡Œã€‚\n12345678910111213141516171819202122//pro pri æ–‡ä»¶//ä¸‹é¢è¡¨ç¤ºä¸»ç‰ˆæœ¬&gt;4å­ç‰ˆæœ¬&gt;6 å³ç‰ˆæœ¬&gt;=5.7greaterThan(QT_MAJOR_VERSION, 4) &#123;greaterThan(QT_MINOR_VERSION, 6) &#123;DEFINES += qchart&#125;&#125;//ç”±äºQt6çš„å‘å¸ƒä»¥åŠä»¥åQt7ã€Qt8ç­‰ï¼Œå…‰æœ‰ä¸Šé¢è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸å¤Ÿçš„çš„//ä¸‹é¢è¡¨ç¤ºQtä¸»ç‰ˆæœ¬&gt;5 å³ç‰ˆæœ¬&gt;=6.0greaterThan(QT_MAJOR_VERSION, 5) &#123;DEFINES += qchart&#125;//åˆ¤æ–­æœ‰å®šä¹‰åˆ™å¯¼å…¥å¯¹åº”æ¨¡å—contains(DEFINES, qchart) &#123;QT += charts&#125;//ä»£ç æ–‡ä»¶#ifdef qchart//è¦æ‰§è¡Œçš„ä»£ç #endif\n\nåœ¨ä½¿ç”¨QChartå›¾è¡¨æ§ä»¶çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°é»˜è®¤çš„è¾¹è·å¥½å¤§ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›èƒ½æ˜¾ç¤ºæ›´å¤šçš„ä¿¡æ¯ï¼Œç´§å‡‘å‹çš„ç•Œé¢ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®è¾¹è·ã€‚\n123456//è®¾ç½®èƒŒæ™¯åŒºåŸŸåœ†è§’è§’åº¦chart-&gt;setBackgroundRoundness(0);//è®¾ç½®å†…è¾¹ç•Œè¾¹è·chart-&gt;setMargins(QMargins(0, 0, 0, 0));//è®¾ç½®å¤–è¾¹ç•Œè¾¹è·chart-&gt;layout()-&gt;setContentsMargins(0, 0, 0, 0);\n\nQtå†…ç½®äº†æ•°æ®å‹ç¼©å’Œè§£å‹çš„åŠŸèƒ½ï¼Œå¦‚æœé‡åˆ°å›¾ç‰‡ã€éŸ³é¢‘æ•°æ®ã€æ–‡ä»¶ç­‰è½¬base64ä¼ è¾“è¿™ç§ï¼Œé‡‡ç”¨qCompresså‹ç¼©åå¤§æ¦‚å¯ä»¥èŠ‚çœ30%çš„æ•°æ®ä¼ è¾“é‡ï¼Œå‹ç¼©æ€§èƒ½å¯è§‚ã€‚å‰ææ˜¯åŒæ–¹éƒ½æ˜¯Qtç¨‹åºï¼Œå› ä¸ºæ”¶åˆ°æ•°æ®çš„æ—¶å€™è¿˜è¦ç”¨qUncompressè§£å‹å‡ºæ¥ï¼Œæˆå¯¹å‡ºç°çš„ã€‚\n12345678//å‘é€çš„æ—¶å€™å‹ç¼©ä¸‹æ•°æ®QByteArray buffer = &quot;...&quot;;buffer = qCompress(buffer);socket-&gt;write(buffer);//æ”¶åˆ°æ•°æ®ååŠ¡å¿…è®°å¾—å…ˆè§£å‹å†ä½¿ç”¨QByteArray data = socket-&gt;readAll();data = qUncompress(data);\n\n25ï¼š241-250\nQStringç±»æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºQtæ‰€æœ‰ç±»ä¸­çš„ç²¾åï¼Œå°è£…çš„æ— å¯æŒ‘å‰”ã€‚å†…ç½®äº†å„ç§è¿›åˆ¶æ•°æ®çš„è½¬æ¢ï¼Œæ¯”å¦‚å°†æ•°æ®è½¬æˆ10è¿›åˆ¶ã€16è¿›åˆ¶æ˜¾ç¤ºï¼Œæˆ–è€…å°†10è¿›åˆ¶ã€16è¿›åˆ¶æ•°æ®è½¬æˆå­—ç¬¦ä¸²æ˜¾ç¤ºã€‚è¿™é‡Œå¾ˆå®¹æ˜“å¿½ç•¥çš„ä¸€ç‚¹å°±æ˜¯ï¼Œå¾ˆå¤šäººä»¥ä¸ºå°±æ˜¯æ”¯æŒ2è¿›åˆ¶ã€10è¿›åˆ¶ã€16è¿›åˆ¶ä¹‹ç±»çš„ï¼Œå…¶å®ä¸æ˜¯çš„ï¼Œé‡Œé¢å®ç°äº† 2-36 ä¹‹é—´çš„ä»»æ„è¿›åˆ¶è½¬æ¢ï¼Œå¯ä»¥è‡ªè¡Œç¿»é˜…æºç æŸ¥çœ‹å®ç°ã€‚\n123456789101112char data[2];data[0] = 0x10;data[1] = 25;//è¾“å‡º 2è¿›åˆ¶æ˜¾ç¤º &quot;10000&quot; &quot;11001&quot;qDebug() &lt;&lt; &quot;2è¿›åˆ¶æ˜¾ç¤º&quot; &lt;&lt; QString::number(data[0], 2) &lt;&lt; QString::number(data[1], 2);//è¾“å‡º 5è¿›åˆ¶æ˜¾ç¤º &quot;31&quot; &quot;100&quot;qDebug() &lt;&lt; &quot;5è¿›åˆ¶æ˜¾ç¤º&quot; &lt;&lt; QString::number(data[0], 5) &lt;&lt; QString::number(data[1], 5);//è¾“å‡º 10è¿›åˆ¶æ˜¾ç¤º &quot;16&quot; &quot;25&quot;qDebug() &lt;&lt; &quot;10è¿›åˆ¶æ˜¾ç¤º&quot; &lt;&lt; QString::number(data[0]) &lt;&lt; QString::number(data[1]);//è¾“å‡º 16è¿›åˆ¶æ˜¾ç¤º &quot;10&quot; &quot;19&quot;qDebug() &lt;&lt; &quot;16è¿›åˆ¶æ˜¾ç¤º&quot; &lt;&lt; QString::number(data[0], 16) &lt;&lt; QString::number(data[1], 16);\n\nQtSqlæ¨¡å—å°è£…äº†å„ç§æ•°æ®åº“æ“ä½œï¼Œä½¿å¾—Qtæ“ä½œå„ç§æ•°æ®åº“éå¸¸çš„ç®€å•ï¼Œæ”¯æŒå„ç§å„æ ·çš„æ•°æ®åº“ï¼Œæœ€åŸºç¡€çš„ODBCæ–¹å¼ä¹Ÿæ”¯æŒè¿æ¥åˆ°å„ç§æ•°æ®åº“ã€‚æœ‰ä¸ªå¾ˆå®¹æ˜“å¿½è§†çš„è¦ç‚¹å°±æ˜¯åœ¨è¿æ¥sqlserveræ•°æ®åº“çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°ç¬¬ä¸‰æ–¹çš„æ•°æ®åº“å·¥å…·ä¹Ÿæ²¡æœ‰é…ç½®æ•°æ®åº“ï¼Œä½†æ˜¯å¯ä»¥è¿æ¥æˆåŠŸï¼Œè€Œåœ¨Qtä¸­çš„å¸¸è§„æ•°æ®åº“è¿æ¥å†™æ³•å´ä¸è¡Œï¼Œé‚£æ˜¯å› ä¸ºä½ ä»£ç å†™é”™äº†ï¼Œè¦ç”¨å¦å¤–ä¸€ç§å†™æ³•ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859//è¿æ¥sqliteæ•°æ®åº“QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);//åªéœ€è¦æŒ‡å®šæ•°æ®åº“æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å³å¯database.setDatabaseName(&quot;d:/test.db&quot;);//è¿æ¥mysqlæ•°æ®åº“QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QMYSQL&quot;);database.setDatabaseName(&quot;test&quot;);database.setHostName(&quot;127.0.0.1&quot;);database.setPort(3306);database.setUserName(&quot;root&quot;);database.setPassword(&quot;root&quot;);//è¿æ¥åˆ°sqlserveræ•°æ®åº“//æ–¹å¼ä¸€é€šè¿‡odbcæ•°æ®æºï¼Œå‰ææ˜¯å¿…é¡»é…ç½®å¥½æ•°æ®æºã€‚QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QODBC&quot;);database.setDatabaseName(&quot;æ•°æ®æºåç§°&quot;);database.setUserName(&quot;sa&quot;);database.setPassword(&quot;123456&quot;);//æ–¹å¼äºŒé€šè¿‡é©±åŠ¨å­—ç¬¦ä¸²ï¼Œæ— éœ€é…ç½®æ•°æ®æºã€‚è®¾ç½®æ•°æ®åº“åç§°å°±å¸¦äº†ä¸»æœºåœ°å€ç«¯å£å’Œç”¨æˆ·ä¿¡æ¯æ‰€æœ‰åé¢è¿™äº›è®¾ç½®ä¸éœ€è¦ï¼Œå¼ºçƒˆå»ºè®®æ¨èæ­¤æ–¹æ³•ã€‚QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QODBC&quot;);QStringList list;list &lt;&lt; QString(&quot;DRIVER=&#123;%1&#125;&quot;).arg(&quot;SQL SERVER&quot;);list &lt;&lt; QString(&quot;SERVER=%1,%2&quot;).arg(&quot;127.0.0.1&quot;).arg(1433);list &lt;&lt; QString(&quot;DATABASE=%1&quot;).arg(&quot;test&quot;);list &lt;&lt; QString(&quot;UID=%1&quot;).arg(&quot;sa&quot;);list &lt;&lt; QString(&quot;PWD=%1&quot;).arg(&quot;123456&quot;);database.setDatabaseName(list.join(&quot;;&quot;));//è¿æ¥åˆ°postgresqlæ•°æ®åº“QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QPSQL&quot;);database.setDatabaseName(&quot;test&quot;);database.setHostName(&quot;127.0.0.1&quot;);database.setPort(5432);database.setUserName(&quot;postgres&quot;);database.setPassword(&quot;123456&quot;);//è¿æ¥åˆ°oracleæ•°æ®åº“QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QOCI&quot;);database.setDatabaseName(&quot;test&quot;);database.setHostName(&quot;127.0.0.1&quot;);database.setPort(1521);database.setUserName(&quot;system&quot;);database.setPassword(&quot;123456&quot;);//è¿æ¥åˆ°äººå¤§é‡‘ä»“kingbaseæ•°æ®åº“ï¼ˆå†…æ ¸å°±æ˜¯postgresqlï¼‰QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QPSQL&quot;);database.setDatabaseName(&quot;test&quot;);database.setHostName(&quot;127.0.0.1&quot;);database.setPort(54321);database.setUserName(&quot;SYSTEM&quot;);database.setPassword(&quot;123456&quot;);//é€šè¿‡odbcæ•°æ®æºè¿æ¥åˆ°å„ç§æ•°æ®åº“ï¼Œå‰ææ˜¯å¿…é¡»é…ç½®å¥½æ•°æ®æºï¼Œåªéœ€è¦è®¾ç½®æ•°æ®åº“åç§°ä¸ºæ•°æ®æºçš„åç§°ï¼Œå¡«å†™ç”¨æˆ·åå’Œå¯†ç å°±è¡Œï¼Œå…¶ä»–çš„ä¸»æœºåœ°å€å’Œç«¯å£ä¸éœ€è¦ã€‚QSqlDatabase database = QSqlDatabase::addDatabase(&quot;QODBC&quot;);database.setDatabaseName(&quot;æ•°æ®æºåç§°&quot;);database.setUserName(&quot;system&quot;);database.setPassword(&quot;123456&quot;);\n\nå¦‚æœä¿¡å·æ§½å…³è”å‡½æ•° connect(obj, SIGNAL(), this, SLOT()); æ‰§è¡Œå¤šæ¬¡åˆ™ä¼šé‡å¤å…³è”ï¼ˆæ„å‘³ç€ä¼šæ‰§è¡Œå¤šæ¬¡ï¼‰ï¼Œè€Œå–æ¶ˆä¿¡å·æ§½å…³è”å‡½æ•° disconnect(obj, SIGNAL(), this, SLOT()); åªéœ€è¦æ‰§è¡Œä¸€æ¬¡å°±å¯ä»¥å°†ä¹‹å‰å…³è”çš„ï¼ˆå“ªæ€•æ˜¯é‡å¤å…³è”è¿‡ï¼‰å…¨éƒ¨æ¸…é™¤ã€‚å¾ˆå¤šåˆå­¦è€…ä¼šé‡åˆ°ä¸ºä»€ä¹ˆç‚¹ä¸€ä¸‹å±…ç„¶æ‰§è¡Œå¤šæ¬¡çš„åŸå› å°±åœ¨è¿™é‡Œï¼Œå¾ˆå¯èƒ½ä»£ç ä¸­å†™äº† on_objName_clicked(); è¿™ç§Qtå†…ç½®è‡ªåŠ¨ç”Ÿæˆå…³è”çš„æ§½å‡½æ•°ï¼Œç„¶åè‡ªå·±åˆåœ¨ä»£ç ä¸­è°ƒç”¨ connect ç»‘å®šäº†ä¸€æ¬¡ï¼Œå¯¼è‡´é‡å¤ç»‘å®šã€‚æä¸ªå»ºè®®ï¼šå…¶å®Qtå¯ä»¥è¿‡æ»¤ä¸‹å¦‚æœæ˜¯å®Œå…¨ä¸€æ ·çš„ç»‘å®šåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªè€Œä¸æ˜¯å¤šä¸ªã€‚\n123456//ä¸ºäº†ä¿è¯æ°¸è¿œåªæœ‰ä¸€ä¸ªå…³è”å¯ä»¥åœ¨å…³è”å‰é¢æ‰§è¡Œä¸€æ¬¡å–æ¶ˆå…³è”disconnect(obj, SIGNAL(), this, SLOT());connect(obj, SIGNAL(), this, SLOT());//ç»è¿‡ç¾¤é‡Œå¤§ä½¬æç¤ºï¼ŒåŸæ¥connectç¬¬äº”ä¸ªå‚æ•°å¡« UniqueConnection å°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£è¯´æ˜è¿™ä¸ªå‚æ•°ä¼šè¿‡æ»¤é‡å¤çš„ä¿¡å·ã€‚connect(obj, SIGNAL(), this, SLOT(), Qt::UniqueConnection);\n\né€šè¿‡å¯¹Qtè‡ªå¸¦Examplesçš„æºç ç ”ç©¶ä½ ä¼šå‘ç°ï¼Œè¶Šå¾€åçš„ç‰ˆæœ¬ï¼Œè¶Šå–œæ¬¢ç”¨æ™ºèƒ½æŒ‡é’ˆQScopedPointeræ¥å®šä¹‰å¯¹è±¡ï¼Œè¿™æ ·æœ‰ä¸ªå¥½å¤„å°±æ˜¯ç”¨çš„åœ°æ–¹åªç®¡newå°±è¡Œï¼Œä¸€ç›´newä¸‹å»ï¼Œä¸ç”¨æ‹…å¿ƒèµ„æºé‡Šæ”¾é—®é¢˜ï¼Œæ™ºèƒ½æŒ‡é’ˆä¼šç»™ä½ åœ¨åˆé€‚çš„æ—¶æœºé‡Šæ”¾ï¼Œç›¸å½“äºå¯ä»¥å°‘äº›ä¸€è¡Œä»£ç  xxx-&gt;deleteLater(); ï¼Œè€Œä¸”é¿å…ä¸å¿…è¦çš„éº»çƒ¦ï¼Œä¸ç„¶å¾ˆå¤šåœ°æ–¹ä½ è¦åˆ¤æ–­ if (!xxx) çœ‹ä¸‹å¯¹è±¡æ˜¯å¦okã€‚\n12345678910QWidget *widget;//ç”¨çš„åœ°æ–¹å…ˆnewwidget = new QWidget;//ç”¨å®Œé‡Šæ”¾å¯¹è±¡widget-&gt;deleteLater();      //æ™ºèƒ½æŒ‡é’ˆå†™æ³•QScopedPointer&lt;QWidget&gt; widget;//åªç®¡newå°½ç®¡newä¸ç”¨ç®¡é‡Šæ”¾widget.reset(new QWidget);\n\nå¦‚æœæ§ä»¶ä¸­å­˜åœ¨å¸ƒå±€ï¼Œåœ¨è°ƒç”¨setLayouté‡æ–°è®¾ç½®å¸ƒå±€çš„æ—¶å€™ï¼Œä¼šæç¤º QWidget::setLayout: Attempting to set QLayout â€¦ ä¹‹ç±»çš„ä¿¡æ¯ï¼Œè¯´æ˜¯å·²ç»å­˜åœ¨äº†å¸ƒå±€ï¼Œéœ€è¦åˆ é™¤ä¹‹å‰çš„å¸ƒå±€æ‰èƒ½é‡æ–°è®¾ç½®å¸ƒå±€ï¼ŒæŒ‰é“ç†Qtæ¨èçš„æ˜¯è°ƒç”¨ layout()-&gt;deleteLater() æ–¹æ³•å»åˆ é™¤å¯¹è±¡ï¼Œæ›´å®‰å…¨ï¼Œä½†æ˜¯åœ¨è¿™é‡Œä¸èµ·ä½œç”¨ï¼Œä½ éœ€è¦ç”¨ delete layout() æ¥åˆ é™¤ï¼Œç€å®å¥‡æ€ªã€‚\n\nåœ¨ç¼–å†™ç±»ä¸­æœ‰æ—¶å€™éœ€è¦å¯¹å˜é‡è¿›è¡Œèµ‹å€¼å’Œå–å€¼ï¼Œè¿™æ—¶å€™ä¸€èˆ¬ç”¨ setxxxã€getxxx ä¹‹ç±»çš„å‡½æ•°è¿›è¡Œå¤„ç†ï¼Œè€Œä¸”å¾€å¾€é‡Œé¢å°±ä¸€è¡Œä»£ç ï¼Œè¿™æ—¶å€™ä½ å¯èƒ½ä¼šæ€è€ƒä¸ºä½•ä¸ç›´æ¥å°†å˜é‡æ”¹æˆpublicæš´éœ²å‡ºæ¥ä½¿ç”¨ï¼Œè¿˜å¯ä»¥çœä¸¤ä¸ªå‡½æ•°å‡ è¡Œä»£ç ã€‚å…¶å®ç”¨set getè¿™æ ·å¤„ç†ä¸»è¦è¿˜æ˜¯ä¸ºäº†æ‹“å±•æ€§ï¼Œæ¯”å¦‚åæœŸå¦‚æœéœ€è¦å¯¹èµ‹å€¼è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œæˆ–è€…è¯¥å˜é‡åªå…è®¸è¯»å†™ä¸­çš„ä¸€ä¸ªï¼Œå¦‚æœä¹‹å‰æ˜¯ç›´æ¥ä½¿ç”¨çš„å˜é‡å¤–ï¼Œåˆ™ä½¿ç”¨çš„åœ°æ–¹éƒ½è¦å»ä¿®æ”¹è§„åˆ™ï¼Œåè€Œå˜å¾—å¾ˆç³Ÿç³•ã€‚ å‚è€ƒæ–‡ç«  https://blog.csdn.net/ChineseSoftware/article/details/122923485 ã€‚\n\nå…³äºå¦‚ä½•å¿«é€Ÿç»“æŸçº¿ç¨‹ï¼Œè°ƒç”¨terminateæš´åŠ›ç»“æŸå®¹æ˜“å‡ºé—®é¢˜ã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬éƒ½æ˜¯é‡‡ç”¨æ ‡å¿—ä½æ¥ç»“æŸçº¿ç¨‹ï¼Œä½†æ˜¯å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å‡½æ•°å¾ˆè€—æ—¶ï¼Œæˆ–è€…åœ¨runä¸­msleepä¼‘æ¯çš„æ—¶é—´è¿‡ä¹…ï¼Œå®¹æ˜“å¯¼è‡´è¦å¾ˆé•¿ä¸€æ®µæ—¶é—´æ‰èƒ½æ­£ç¡®åœæ­¢ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘ä¸€ä¸ªç­–ç•¥å°±æ˜¯åˆ†å‰²çº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¦‚æœæ˜¯å‡½æ•°ä½“è€—æ—¶å¯ä»¥åœ¨è€—æ—¶çš„å‡½æ•°ä½“ä¸­å¢åŠ åœæ­¢æ ‡å¿—ä½çš„åˆ¤æ–­ï¼Œä½¿å…¶å¿«é€Ÿè·³å‡ºï¼›å¦‚æœæ˜¯å»¶æ—¶æ—¶é—´è¿‡ä¹…å¯ä»¥å°†å»¶æ—¶æ—¶é—´æ‹†åˆ†æˆå¤šä¸ªå°çš„æ—¶é—´è½®ç‰‡ï¼Œæ¯ä¸ªå°çš„ä¼‘æ¯é—´éš”éƒ½åˆ¤æ–­åœæ­¢æ ‡å¿—ä½ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å¤§å¤§åŠ å¿«çº¿ç¨‹æ­£å¸¸é€€å‡ºçš„é€Ÿåº¦è€Œä¸ç”¨ç­‰å¾…å¤ªä¹…ã€‚\n123456789101112131415161718192021222324252627282930313233void Thread::run()&#123;    while (!stopped) &#123;        doTask();        //ä¸‹é¢è¿™ä¸ªå»¶æ—¶å¤ªä¹…å¯¼è‡´é€€å‡ºå¾ˆæ…¢        //msleep(3000);        //ç‰¹æ„æ¯æ¬¡åšä¸ªå°å»¶æ—¶æ¯æ¬¡éƒ½å»åˆ¤æ–­æ ‡å¿—ä½ç­‰å¯ä»¥å¤§å¤§åŠ å¿«å…³é—­é€Ÿåº¦        int count = 0;        while (!stopped) &#123;            msleep(100);            count++;            //å¦‚æœåˆ°äº†30æ¬¡=30*100=3000æ¯«ç§’ä¹Ÿè·³å‡º            if (count == 30) &#123;                break;            &#125;        &#125;      &#125;         stopped = false;    &#125;void Thread::doTask()&#123;    while(1) &#123;        if (stopped) &#123;            return;        &#125;        doTask1();        doTask2();    &#125;    &#125;\n\nQtä¸­å¦‚æœæŒ‡å®šäº†åŒä¸€ä¸ªçˆ¶ç±»çª—ä½“ï¼Œåˆ™æ§ä»¶éƒ½ä¼šè¦†ç›–åœ¨è¯¥çˆ¶ç±»çª—ä½“ä¸­ï¼Œè¿™å°±éœ€è¦è®¾ç½®çª—å£å°éƒ¨ä»¶è¦†ç›–é®æŒ¡ä¸å±‚å é¡ºåºã€‚\n1234567891011121314//Qtå¯¹æœ‰å…±åŒçˆ¶ç±»çª—ä½“çš„æ§ä»¶ä¼˜åŒ–åˆ°äº†æè‡´ï¼Œä¸‹é¢ç”Ÿæˆäº†1000ä¸ªwidgetæ‰æ–°å¢ä¸åˆ°3mbçš„å†…å­˜ã€‚for (int i = 0; i &lt; 1000; ++i) &#123;    QWidget *w = new QWidget(this);    w-&gt;setGeometry(0, 0, 100, 100);    w-&gt;show();&#125;QWidget *w1, *w2, *w3;//å°†w1æ§ä»¶ç§»åˆ°æœ€å‰é¢ç›¸å½“äºåœ¨è¯¥çˆ¶çª—ä½“ä¸­ç½®é¡¶w1-&gt;raise();//å°†w1æ§ä»¶ç§»åˆ°æœ€åé¢ç›¸å½“äºåœ¨è¯¥çˆ¶çª—ä½“ä¸­ç½®åº•w1-&gt;lower();//å°†w1æ§ä»¶ç§»åˆ°w2æ§ä»¶ä¸‹é¢w1-&gt;stackUnder(w2);\n\nå½“æˆ‘ä»¬å…³é—­çª—ä½“çš„æ—¶å€™ï¼ŒæŒ‰é“ç†æ¥è¯´éƒ½ä¼šæ‰§è¡Œå¯¹åº”çª—ä½“çš„ææ„å‡½æ•° ~MainWindow() ä¹‹ç±»çš„ï¼Œè¿™æ˜¯ç†æƒ³çŠ¶æ€ï¼Œå½“ä½ çš„çª—ä½“è¿˜å¼¹å‡ºäº†å­çª—ä½“ï¼Œå°±ç®—ä½ å…³é—­äº†ä¸»çª—ä½“ï¼Œä¼šå‘ç°å­çª—ä½“ä¾ç„¶åœ¨ï¼Œè€Œä¸”æ ¹æœ¬æ²¡æœ‰å»ææ„ä¸»çª—ä½“ï¼Œå¯¹åº”çš„å­çª—ä½“ä¹Ÿæ²¡æœ‰è®¾ç½® setParent ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯å¸Œæœ›å…³é—­äº†ä¸»çª—ä½“ï¼Œå¯¹åº”å­çª—ä½“è‡ªåŠ¨å…³é—­ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿä½ éœ€è¦é‡è½½ closeEvent æ‹¿åˆ°å…³é—­æ¶ˆæ¯ï¼Œä¸»åŠ¨å»æŠŠå­çª—ä½“é‡Šæ”¾ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041class MainWindow : public QMainWindow&#123;    Q_OBJECTpublic:    MainWindow(QWidget *parent = 0);    ~MainWindow();protected:    void closeEvent(QCloseEvent *);private slots:    void on_pushButton_clicked();private:    Ui::MainWindow *ui;    QLabel *lab;&#125;;MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent), ui(new Ui::MainWindow)&#123;    ui-&gt;setupUi(this);    lab = new QLabel;    lab-&gt;resize(400, 300);&#125;MainWindow::~MainWindow()&#123;    delete ui;&#125;void MainWindow::closeEvent(QCloseEvent *)&#123;    //å…ˆæŠŠå­çª—ä½“é‡Šæ”¾    lab-&gt;deleteLater();&#125;void MainWindow::on_pushButton_clicked()&#123;    lab-&gt;show();&#125;\n\nå…³äºQtä¸­ sendEvent å’Œ postEvent ä¸»åŠ¨æ¨¡æ‹Ÿå‘é€é¼ æ ‡é”®ç›˜äº‹ä»¶çš„å‡ ç‚¹è¯´æ˜ã€‚\n\n\n\nsendEventæ˜¯é˜»å¡å¼ï¼Œä»£ç ä¼šç«‹å³æ‰§è¡Œï¼Œæ”¯æŒæ ˆç©ºé—´å’Œå †ç©ºé—´äº‹ä»¶å¯¹è±¡çš„å‘é€ï¼ˆå±€éƒ¨å¯¹è±¡å’Œnewåˆ†é…çš„å¯¹è±¡ï¼‰ã€‚\npostEventæ˜¯éé˜»å¡å¼ï¼Œä¼šå‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…å¤„ç†ï¼Œåªæ”¯æŒæ ˆå †ç©ºé—´äº‹ä»¶å¯¹è±¡çš„å‘é€ï¼ˆnewåˆ†é…çš„å¯¹è±¡ï¼‰ã€‚\nnewåˆ†é…çš„äº‹ä»¶å¯¹è±¡è¢«å¤„ç†åï¼Œä¼šç”±Qtå†…éƒ¨è‡ªåŠ¨æ‘§æ¯ï¼Œä¸ç”¨æ‹…å¿ƒã€‚\nçŸ­æ—¶é—´å†…å¯†é›†é¢‘ç¹çš„è°ƒç”¨ï¼Œæ¨èç”¨postEventï¼Œæ”¾å…¥äº‹ä»¶é˜Ÿåˆ—éå¸¸å®‰å…¨ã€‚å¦åˆ™ç”¨sendEventå¾ˆå®¹æ˜“å¯¼è‡´å´©æºƒã€‚123456789101112131415//ä¸‹é¢è¿™ä¸ªä¼šç«‹å³æ‰§è¡ŒQResizeEvent event(size(), size());QApplication::sendEvent(this, &amp;event);//ä¸‹é¢è¿™ä¸ªä¼šç«‹å³æ‰§è¡ŒQResizeEvent *event = new QResizeEvent(size(), size());QApplication::sendEvent(this, event);//ä¸‹é¢è¿™ä¸ªä¸ä¼šæŠ¥é”™ä½†æ˜¯ä¹Ÿä¸ä¼šæ‰§è¡Œå› ä¸ºäº‹ä»¶å¯¹è±¡æ˜¯å±€éƒ¨å˜é‡QResizeEvent event(size(), size());QApplication::postEvent(this, &amp;event);//ä¸‹é¢çš„æ–¹å¼éå¸¸å®‰å…¨QResizeEvent *event = new QResizeEvent(size(), size());QApplication::postEvent(this, event);\n\n26ï¼š251-260\nä»Šå¤©åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­ï¼Œå‘ç° #ifdef Q_OS_WIN #ifdef Q_CC_MSVC ä¹‹ç±»çš„éƒ½å¤±æ•ˆäº†ï¼Œæå¾—å·®ç‚¹æ€€ç–‘äººç”Ÿäº†ã€‚ç»å†è¿‡ä¹‹å‰ç±»ä¼¼çš„æ•™è®­åï¼Œæ’æŸ¥åŸæ¥æ˜¯æ²¡æœ‰æå‰å¼•å…¥ qglobal.h å¤´æ–‡ä»¶å¯¼è‡´çš„ã€‚åˆ‡è®°å¦‚æœè¦ä½¿ç”¨Qtçš„ä¸œè¥¿ï¼Œå“ªæ€•æ˜¯æœ€åŸºç¡€çš„æ ‡è¯†å®å®šä¹‰ Q_OS_WIN ä¹‹ç±»çš„ï¼Œéƒ½è¦ä¿è¯è¯¥å‰é¢è‡³å°‘åŒ…å«äº† qglobal.h ï¼Œå¦åˆ™éƒ½æ˜¯å¤±è´¥çš„ã€‚å¾ˆå¤šäººå’Œæˆ‘ä¸€æ ·å¤©çœŸçš„ä»¥ä¸ºç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†ã€‚\n123456789101112//å¿…é¡»è¦å…ˆå¼•å…¥è¿™ä¸ªå¤´æ–‡ä»¶#include &quot;qglobal.h&quot;#ifdef Q_OS_WIN...#else...#endif#ifdef Q_CC_MSVC#pragma execution_character_set(&quot;utf-8&quot;)#endif\n\næœ‰ä¸€ä¸ªåœºæ™¯ç»å¸¸é‡åˆ°ï¼Œé‚£å°±æ˜¯åœ¨ç¬¦åˆæŸä¸ªæ¡ä»¶ä¸‹ï¼Œå»¶æ—¶ä¸€æ®µæ—¶é—´å»æ‰§è¡Œä¸€æ®µä»£ç ï¼Œå¦‚æœçŸ­æ—¶é—´å†…è§¦å‘å¤šæ¬¡åˆä¸éœ€è¦é¢‘ç¹æ‰§è¡Œï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¬¡å°±è¡Œã€‚å¦‚æœé€‰æ‹©ç”¨QTimer::singleShotæ— æ³•ç»ˆæ­¢å·²ç»è§¦å‘çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä¸»åŠ¨å®ä¾‹åŒ–ä¸€ä¸ªå•æ¬¡å®šæ—¶å™¨ï¼Œæ¯æ¬¡è°ƒç”¨å‰éƒ½åœæ­¢ä¹‹å‰çš„ï¼ˆåªè¦æ˜¯è¿˜æ²¡æ‰§è¡Œéƒ½ä¼šå–æ¶ˆï¼‰ï¼Œå®Œç¾è§£å†³ã€‚\n1234567891011//QTimer::singleShot(1000, thread, SLOT(xxx()));static QTimer *timer = NULL;if (!timer) &#123;    timer = new QTimer;    QObject::connect(timer, SIGNAL(timeout()), thread, SLOT(xxx()));    timer-&gt;setSingleShot(true);    timer-&gt;setInterval(1000);&#125;timer-&gt;stop();timer-&gt;start();\n\næœ‰æ—¶å€™æˆ‘ä»¬å‘ç°æ§ä»¶è®¾ç½®é€æ˜åèƒŒæ™¯å˜æˆé»‘è‰²ï¼Œä½ å¯ä»¥å°è¯•è®¾ç½®é€æ˜åº¦å€¼1è€Œä¸æ˜¯å®Œå…¨é€æ˜0ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯é€æ˜çš„ä½†æ˜¯åˆä¿ç•™äº†çª—ä½“çš„ç‰¹æ€§ã€‚å¦‚æœæƒ³è¦ä¸åº”ç”¨ç³»ç»Ÿé˜´å½±è¾¹æ¡†å¯ä»¥è®¾ç½®å±æ€§ w.setWindowFlags(w.windowFlags() | Qt::NoDropShadowWindowHint); \n\nQtä¸­çš„äº‹ä»¶è¿‡æ»¤å™¨ç›¸å½“äºä¸‡èƒ½å¤§æ³•ï¼ˆç»ˆæç§˜å¯†æ­¦å™¨ï¼‰ï¼Œå°¤å…¶æ˜¯å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºå®‰è£…äº‹ä»¶è¿‡æ»¤å™¨ï¼Œåˆ™å¯ä»¥æ‹¿åˆ°æ‰€æœ‰çš„äº‹ä»¶ã€‚æ¯”å¦‚å¯ä»¥æ‹¿åˆ°ç³»ç»Ÿæ ‡é¢˜æ é¼ æ ‡æŒ‰ä¸‹æ¾å¼€ï¼Œå¯¹æ‰€æœ‰éœ€è¦ç§»åŠ¨çš„æ— è¾¹æ¡†çª—ä½“ç»Ÿä¸€æ‹¦æˆªè¿›è¡Œç§»åŠ¨å¤„ç†ã€‚ä¸ªäººå»ºè®®ä¸åˆ°ä¸‡ä¸å¾—å·²ä¸å»ºè®®ä½¿ç”¨ï¼Œæœ‰ä¸€å®šæ€§èƒ½æŸè€—ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ˜¯ä»æœ€åˆæºå¤´æ‹¦æˆªäº‹ä»¶ï¼Œæ„å‘³ç€æ‰€æœ‰çš„äº‹ä»¶éƒ½ä¼šåˆ°è¿™é‡Œè¿‡ä¸€éã€‚å¦‚æœä½ åœ¨æ”¶åˆ°å¯¹åº”äº‹ä»¶åè¿˜åšäº†ä¸€å®šè€—æ—¶çš„å¤„ç†ï¼Œå¾ˆå®¹æ˜“å°±å¡ä¸»äº†UIä¸»çº¿ç¨‹ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738void AppInit::start()&#123;    qApp-&gt;installEventFilter(this);&#125;bool AppInit::eventFilter(QObject *watched, QEvent *event)&#123;    if (event-&gt;type() == QEvent::NonClientAreaMouseButtonPress) &#123;        qDebug() &lt;&lt; &quot;ç³»ç»Ÿæ ‡é¢˜æ æŒ‰ä¸‹&quot;;    &#125; else if (event-&gt;type() == QEvent::NonClientAreaMouseButtonRelease) &#123;        qDebug() &lt;&lt; &quot;ç³»ç»Ÿæ ‡é¢˜æ æ¾å¼€&quot;;    &#125;        QWidget *w = (QWidget *)watched;    if (!w-&gt;property(&quot;canMove&quot;).toBool()) &#123;        return QObject::eventFilter(watched, event);    &#125;    static QPoint mousePoint;    static bool mousePressed = false;    QMouseEvent *mouseEvent = static_cast&lt;QMouseEvent *&gt;(event);    if (mouseEvent-&gt;type() == QEvent::MouseButtonPress) &#123;        if (mouseEvent-&gt;button() == Qt::LeftButton) &#123;            mousePressed = true;            mousePoint = mouseEvent-&gt;globalPos() - w-&gt;pos();        &#125;    &#125; else if (mouseEvent-&gt;type() == QEvent::MouseButtonRelease) &#123;        mousePressed = false;    &#125; else if (mouseEvent-&gt;type() == QEvent::MouseMove) &#123;        if (mousePressed) &#123;            w-&gt;move(mouseEvent-&gt;globalPos() - mousePoint);            return true;        &#125;    &#125;    return QObject::eventFilter(watched, event);&#125;\n\nlinuxä¸Šå¯æ‰§è¡Œæ–‡ä»¶é»˜è®¤ä»ç³»ç»Ÿç¯å¢ƒå˜é‡æŸ¥æ‰¾åŠ¨æ€åº“ï¼Œè€Œwindowsä¸Šé»˜è®¤æ˜¯ä»å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•æŸ¥æ‰¾ï¼Œæ‰€ä»¥æœ‰æ—¶å€™ä¸ºäº†ç»Ÿä¸€ï¼Œå¸Œæœ›åŠ¨æ€åº“å°±æŒ‡å®šæ”¾åœ¨å¯æ‰§è¡Œæ–‡ä»¶åŒä¸€ç›®å½•ä¸‹æˆ–è€…ç›¸å¯¹ç›®å½•æ¯”å¦‚libæ–‡ä»¶å¤¹ï¼Œè¿™å°±éœ€è¦ç¼–è¯‘çš„æ—¶å€™åšç‰¹æ®Šè®¾ç½®ï¼Œåœ¨proé¡¹ç›®æ–‡ä»¶ä¸­æŒ‡å®šrpathï¼ˆä¹Ÿå¯ä»¥ç”¨å‘½ä»¤æˆ–è€…ç¬¬ä¸‰æ–¹å·¥å…·è¿›è¡Œè®¾ç½®ï¼‰ï¼ŒæŒ‡å®šå¥½ä»¥åé»˜è®¤å…ˆä»æŒ‡å®šçš„rpathæŸ¥æ‰¾åŠ¨æ€åº“æ˜¯å¦åœ¨ï¼Œä¸åœ¨ç„¶åå†å»ç¯å¢ƒå˜é‡ä¸­çš„è·¯å¾„æŸ¥æ‰¾ã€‚\n12345linux &#123;QMAKE_LFLAGS += &quot;-Wl,-rpath,\\&#x27;\\$$ORIGIN\\&#x27;&quot;QMAKE_LFLAGS += &quot;-Wl,-rpath,\\&#x27;\\$$ORIGIN/lib\\&#x27;&quot;QMAKE_LFLAGS += &quot;-Wl,-rpath,\\&#x27;\\$$ORIGIN/../lib\\&#x27;&quot;&#125;\n\né»˜è®¤QDialogçª—ä½“å³ä¸‹è§’æœ‰ä¸ªæ‹‰ä¼¸å°ºå¯¸çš„æ‰‹æŸ„ï¼Œé€šè¿‡å®ƒå¯ä»¥å¯¹çª—ä½“æ‹‰ä¼¸å¤§å°ï¼Œè¿™ä¸ªæ§ä»¶å¾ˆå®¹æ˜“è¢«é—å¿˜ä½†æ˜¯åˆç»å¸¸å¯ä»¥çœ‹åˆ°ï¼Œä»–çš„åå­—å«QSizeGripï¼Œå¯ä»¥é€šè¿‡setSizeGripEnabledæ¥å¯ç”¨æˆ–è€…ç¦ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨qsså¯¹å¤–è§‚è¿›è¡Œè®¾ç½®ã€‚\n12345QSizeGrip &#123;\timage:url(:/image/sizegrip.png);\twidth:10px;\theight:10px;&#125;\n\nåœ¨æœ‰äº›æ²¡æœ‰openglç¯å¢ƒçš„Qtå¼€å‘ä¸­ï¼Œæ¯”å¦‚ä¸€äº›åµŒå…¥å¼æ¿å­ä¸ºäº†èŠ‚çœèµ„æºæ²¡æœ‰ç¼–è¯‘openglæ‰€ä»¥ä¸ä¼šæœ‰openglç›¸å…³çš„å¤´æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘é¡¹ç›®è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°æç¤º GLES3&#x2F;gl3.h: No such file or directoryï¼Œå°½ç®¡ä½ çš„é¡¹ç›®ä¸­ä¹Ÿæ²¡æœ‰ç”¨åˆ°openglçš„ä»»ä½•ä¸œè¥¿ï¼Œé‚£æ˜¯å› ä¸ºä½ åŒ…å«äº†ä¸€ä¸ªå¤§æ¨¡å— #include  ï¼Œè€Œè¿™ä¸ªå¤§æ¨¡å—ä¸­åŒ…å«äº† #include â€œqopenglwidget.hâ€ ï¼Œä½ éœ€è¦åšçš„æ˜¯åœ¨å¼•å…¥å¤§æ¨¡å—å‰é¢åŠ ä¸€è¡Œã€‚\n1234//ä¸‹é¢ä¸¤ä¸ªå®šä¹‰çœ‹å…·ä½“éœ€æ±‚è°ƒæ•´#define QT_NO_OPENGL#define QT_NO_OPENGL_ES_3#include &lt;QtWidgets&gt;\n\nå¯ä»¥é€šè¿‡è®¾ç½®è¿‡æ»¤æœºåˆ¶ï¼Œå°†ä»£ç ä¸­çš„éƒ¨åˆ†æ‰“å°ç±»åˆ«å±è”½æ‰ï¼Œæ¯”å¦‚åªä¿ç•™qdebugæ‰“å°çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å°†Qtå†…éƒ¨ç±»çš„è­¦å‘Šä¿¡æ¯å±è”½ï¼Œåªä¿ç•™è‡ªå·±ç¨‹åºå†™çš„æ‰“å°ä¿¡æ¯ã€‚\n123456789101112131415161718192021//ä»£ç å†™åœ¨mainå‡½æ•°æœ€å‰é¢int main(int argc, char *argv[])&#123;\tQLoggingCategory::setFilterRules(&quot;*.critical=false&quot;);\tQApplication a(argc, argv);&#125;//ä¸‹é¢è¡¨ç¤ºå°†æ‰€æœ‰çš„debugæ‰“å°ä¿¡æ¯å±è”½QLoggingCategory::setFilterRules(&quot;*.debug=false&quot;);//ä¸‹é¢æœ€ç»ˆæ‰“å° 222qDebug() &lt;&lt; &quot;111&quot;;qInfo() &lt;&lt; &quot;222&quot;;//ä¸‹é¢è¡¨ç¤ºå°†æ‰€æœ‰çš„æ‰“å°ä¿¡æ¯å±è”½QLoggingCategory::setFilterRules(&quot;*=false&quot;);//ä¸‹é¢å¯ä»¥å°†æ‰€æœ‰è­¦å‘Šæç¤ºå±è”½(Qtå†…éƒ¨ç±»ä¸­å‡ºç°çš„è­¦å‘Šä¿¡æ¯éƒ½ç”¨çš„è¿™ä¸ªqErrnoWarningå¯¹åº”çš„å°±æ˜¯critical)QLoggingCategory::setFilterRules(&quot;*.critical=false&quot;);//æ”¯æŒå¤šä¸ªè§„åˆ™å†™æ³•(æœ‰éƒ¨åˆ†è­¦å‘Šä¿¡æ¯ç”¨çš„qWarningæ‰€ä»¥ä¹Ÿè¦åŠ è¿›å»)QLoggingCategory::setFilterRules(&quot;*.critical=false\\n*.warning=false&quot;);\n\nå®˜æ–¹çš„Qtå®‰è£…åŒ…åŸºæœ¬ä¸Šéƒ½å¸¦äº†å„ç§é«˜çº§æ¨¡å—æ¯”å¦‚æµè§ˆå™¨æ¨¡å—webengineä»¥åŠå¤šåª’ä½“æ¨¡å—qï¼Œæœ‰äº›åµŒå…¥å¼çš„ç¯å¢ƒæˆ–è€…å‚å®¶æä¾›å¥½çš„Qtç¯å¢ƒï¼Œæœªå¿…æœ‰è¿™äº›æ¨¡å—ï¼Œéœ€è¦å•ç‹¬æ‰“å‘½ä»¤å®‰è£…ã€‚\n123456//å¦‚æœæ‰¾ä¸åˆ°éŸ³é¢‘è¾“å…¥è¾“å‡ºè®¾å¤‡éœ€è¦æ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤sudo apt-get install libqt5multimedia5-plugins//å®‰è£…æµè§ˆå™¨æ¨¡å—sudo apt-get install libqt5web*//ä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰sudo apt-get install libqt5*\n\né¡¹ç›®å¤§äº†ä»¥åï¼Œç»å¸¸éœ€è¦å°†æŸäº›ç±»åšæˆå•ä¾‹ç±»ï¼Œåœ¨æ•´ä¸ªé¡¹ç›®ä¸­å”¯ä¸€å­˜åœ¨ï¼Œä¾›å¤šä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œå¦‚æœä¸€ä¸ªå°±ä¸€ä¸ªç±»éœ€è¦å†™æˆå•ä¾‹æ¨¡å¼ï¼Œé‚£ç›´æ¥å†™åœ¨é‚£ä¸ªç±»ä¸­å³å¯ï¼Œå¦‚æœç±»å¤šäº†çš„è¯ï¼Œä¼šå‘ç°éƒ½æ˜¯ä¸€äº›é‡å¤çš„å®šä¹‰ä»£ç ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘ç”¨ä¸ªå®å®šä¹‰ï¼Œä¼ å…¥ç±»åå³å¯ï¼Œä»£ç é‡è™½ç„¶å°‘äº†å¯èƒ½ç»©æ•ˆä½äº†ï¼Œä½†æ˜¯æ°´å¹³æå‡äº†ã€‚\n12345678910111213141516171819202122232425262728293031323334353637383940#ifndef QUISINGLETON_H#define QUISINGLETON_H#include &lt;QScopedPointer&gt;#include &lt;QMutex&gt;#define SINGLETON_DECL(Class) \\    public: \\        static Class *Instance(); \\    private: \\        Q_DISABLE_COPY(Class) \\        static QScopedPointer&lt;Class&gt; self;#define SINGLETON_IMPL(Class) \\    QScopedPointer&lt;Class&gt; Class::self; \\    Class *Class::Instance() &#123; \\        if (self.isNull()) &#123; \\            static QMutex mutex; \\            QMutexLocker locker(&amp;mutex); \\            if (self.isNull()) &#123; \\                self.reset(new Class); \\            &#125; \\        &#125; \\        return self.data(); \\    &#125;#endif // QUISINGLETON_H//ä½¿ç”¨çš„æ—¶å€™åœ¨å¤´æ–‡ä»¶å’Œå®ç°æ–‡ä»¶å„åŠ ä¸€è¡Œä»£ç å³å¯#include &quot;quisingleton.h&quot;class Form : public QWidget&#123;    Q_OBJECT SINGLETON_DECL(Form)&#125;SINGLETON_IMPL(Form)Form::Form(QWidget *parent) : QWidget(parent), ui(new Ui::Form)&#123;    ui-&gt;setupUi(this);&#125;\n\n27ï¼š261-270\nä»£ç ä¸­åˆ¤æ–­å½“å‰Qtåº“æ˜¯32ä½è¿˜æ˜¯64ä½ï¼Œç”¨QSysInfo::WordSize&#x3D;32&#x2F;64ã€‚\n\nQTreeViewæ§ä»¶è®¾ç½®å·¦ä¾§branch å›¾æ ‡å¤§å°ï¼Œæ— æ³•é€šè¿‡qssè®¾ç½®ï¼Œä¸‡èƒ½å¤§æ³•æŸ¥çœ‹æºç å¾—çŸ¥æ§åˆ¶å®½åº¦æœ€åå–å†³äºindentationå‚æ•°ï¼Œindentationçš„é»˜è®¤å€¼æ ¹æ®ç³»ç»Ÿç¯å¢ƒä¸åŒè€Œä¸åŒï¼Œæ¯”å¦‚1080Påˆ†è¾¨ç‡ä¸‹æ˜¯20ï¼Œä½ è¦æ”¾å¤§å¯ä»¥é€šè¿‡ setIndentation(30) æ¥è®¾ç½®ã€‚\n\nåœ¨å¯¹é€‰é¡¹å¡æ§ä»¶QTabWidgetè®¾ç½®æ ·å¼è¡¨çš„æ—¶å€™ï¼Œå¾ˆå¤šäººå¸Œæœ›èƒ½åšæˆç±»ä¼¼æµè§ˆå™¨æˆ–è€…èµ„æºç®¡ç†å™¨ä¸­ä¸Šé¢é€‰é¡¹å¡çš„æ ·å­ï¼Œå°±æ˜¯é€‰ä¸­çš„tabä¸Šè¾¹å·¦å³ä¸¤è¾¹æœ‰åŠ ç²—çº¿æ¡ï¼Œåº•éƒ¨ç©ºç™½çš„å’Œé¢æ¿å½¢æˆä¸€ä½“ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ–¹æ³•ä¸€å°±æ˜¯æŠŠåº•è¾¹å®½åº¦ä¸º0ï¼Œæ–¹æ³•äºŒå°†åº•è¾¹é¢œè‰²è®¾ç½®æˆå’Œé¢æ¿é¢œè‰²ä¸€æ ·ï¼Œæ–¹æ³•ä¸‰å°†tabçš„åº•è¾¹è¾¹è·è®¾ç½®æˆè¾¹æ¡†çš„è´Ÿæ•°ï¼ˆmargin-bottom:-3pxï¼‰ï¼Œè¿™æ ·çœ‹èµ·æ¥å°±æ˜¯å’Œé¢æ¿èä¸ºä¸€ä½“äº†ã€‚\n123456//ä¸‹é¢å‡ ç§åˆ†åˆ«å¯¹åº”é€‰é¡¹å¡ä¸åŒä½ç½®çš„æ•ˆæœ//æ³¨æ„Qt5.12ç‰ˆæœ¬åtabbaré€‰é¡¹å¡å·¦å³åè¿‡æ¥çš„QTabWidget::pane:top&#123;top:-1px;&#125;QTabWidget::pane:bottom&#123;bottom:-1px;&#125;QTabWidget::pane:left&#123;right:-1px;&#125;QTabWidget::pane:right&#123;left:-1px;&#125;\n\nåœ¨linuxä¸Šç¼–è¯‘åŠ¨æ€åº“æ–‡ä»¶ï¼Œå¯èƒ½ä¼šç”Ÿæˆä¸€å †è½¯è¿æ¥æ–‡ä»¶ï¼ˆå›¾æ ‡ä¸Šæœ‰ä¸ªå°ç®­å¤´&#x2F;libuntitled.so&#x2F;libuntitled.so.1&#x2F;libuntitled.so.1.0libuntitled.so.1.0.0ï¼‰ï¼Œå¾ˆå¤šæ—¶å€™çœ‹èµ·æ¥å¾ˆçƒ¦ï¼Œä¹ æƒ¯äº†windowsä¸Šå°±ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œä½ åªéœ€è¦åœ¨ä½ çš„proæˆ–è€…priä¸­åŠ ä¸Šä¸€è¡Œ CONFIG +&#x3D; plugin å³å¯ï¼Œè¿™æ ·åªä¼šç”Ÿæˆä¸€ä¸ªlibuntitled.soæ–‡ä»¶ã€‚2023-4-2è¡¥å……ï¼šè¿˜å¯ä»¥ä½¿ç”¨ CONFIG +&#x3D; unversioned_libname unversioned_soname æ¥å®ç°ï¼Œunversioned_libnameç”¨æ¥å»æ‰libçš„å„ä¸ªç‰ˆæœ¬å·ï¼Œunversioned_sonameç”¨æ¥å»æ‰é“¾æ¥é‡Œçš„ç‰ˆæœ¬å·ï¼ˆä¸åŠ è¿™ä¸ªçš„è¯å°½ç®¡ç”Ÿæˆçš„æ˜¯libuntitled.soï¼Œä½†æ˜¯é“¾æ¥ç¼–è¯‘çš„æ—¶å€™è¿˜ä¼šæŠ¥é”™æç¤ºä¾èµ–å¸¦ç‰ˆæœ¬å·çš„ï¼‰ã€‚å…·ä½“æ–‡ç« å¯ä»¥å‚è€ƒ https://blog.csdn.net/gongjianbo1992/article/details/129889588 ã€‚\n\nå…³äºQtåœ¨çº¿å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°æŠ¥é”™æç¤ºï¼šä¸‹è½½â€œhttp://mirrors.aliyun.com...â€œæ—¶å‡ºç°ç½‘ç»œé”™è¯¯ çš„è§£å†³æ–¹æ³•ï¼Œæ‰“å¼€å‘½ä»¤è¡Œè¿è¡Œå®‰è£…ç¨‹åºï¼Œæ¯”å¦‚C:\\Users\\Administrator&gt;D:\\Qt\\Qt6\\MaintenanceTool.exeï¼Œåé¢ä¸»åŠ¨åŠ ä¸Šå‚æ•° â€“mirror https://mirrors.aliyun.com/qtï¼Œå®Œæ•´å‘½ä»¤è¡Œæ˜¯ C:\\Users\\Administrator&gt;D:\\Qt\\Qt6\\MaintenanceTool.exe â€“mirror https://mirrors.aliyun.com/qtï¼Œå›è½¦è¿è¡Œå³å¯ã€‚åŒç†ä¹Ÿå¯ä»¥æ¢æˆå›½å†…å…¶ä»–çš„é•œåƒåœ°å€ã€‚\n\nä»Qt6.4ç‰ˆæœ¬å¼€å§‹å¤šåª’ä½“æ¨¡å—æä¾›äº†ffmpegä½œä¸ºåç«¯è§£ç ä½¿ç”¨ï¼ˆ6.5ç‰ˆæœ¬é»˜è®¤å°±æ˜¯ffmpegï¼‰ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥æ›´æ”¹ä½¿ç”¨å“ªç§åç«¯è§£ç ï¼Œåœ¨mainå‡½æ•°çš„ç¬¬ä¸€è¡Œ qputenv(â€œQT_MEDIA_BACKENDâ€, â€œffmpegâ€); ç›®å‰å·²çŸ¥çš„é—®é¢˜æ˜¯å¦‚æœé€‰ç”¨ffmpegåˆ™æš‚æ—¶ä¸æ”¯æŒä¸­æ–‡ç›®å½•ä»¥åŠä¸­æ–‡åç§°ï¼Œå¦‚æœä¸€å®šè¦æ”¯æŒä¸­æ–‡åˆ™éœ€è¦æ”¹æˆwindowsã€‚\n12345678910//è®¾ç½®åç«¯è§£ç ä¸ºffmpeg/æ‰€æœ‰ç³»ç»Ÿéƒ½æ”¯æŒqputenv(&quot;QT_MEDIA_BACKEND&quot;, &quot;ffmpeg&quot;);//windowsç³»ç»Ÿä¸“ç”¨qputenv(&quot;QT_MEDIA_BACKEND&quot;, &quot;windows&quot;);//linuxç³»ç»Ÿä¸“ç”¨qputenv(&quot;QT_MEDIA_BACKEND&quot;, &quot;gstreamer&quot;);//macç³»ç»Ÿä¸“ç”¨qputenv(&quot;QT_MEDIA_BACKEND&quot;, &quot;darwin&quot;);//androidç³»ç»Ÿä¸“ç”¨qputenv(&quot;QT_MEDIA_BACKEND&quot;, &quot;android&quot;);\n\n2 å‡çº§åˆ°Qt600ï¼šç›´è§‚æ€»ç»“\nå¢åŠ äº†å¾ˆå¤šè½®å­ï¼ŒåŒæ—¶åŸæœ‰æ¨¡å—æ‹†åˆ†çš„ä¹Ÿæ›´ç»†è‡´ï¼Œä¼°è®¡ä¸ºäº†æ–¹ä¾¿æ‹“å±•ä¸ªç®¡ç†ã€‚\næŠŠä¸€äº›è¿‡åº¦å°è£…çš„ä¸œè¥¿ç§»é™¤äº†ï¼ˆæ¯”å¦‚åŒæ ·çš„åŠŸèƒ½æœ‰å¤šä¸ªå‡½æ•°ï¼‰ï¼Œä¿è¯äº†åªæœ‰ä¸€ä¸ªå‡½æ•°æ‰§è¡Œè¯¥åŠŸèƒ½ã€‚\næŠŠä¸€äº›Qt5ä¸­å…¼å®¹Qt4çš„æ–¹æ³•åºŸå¼ƒäº†ï¼Œå¿…é¡»ç”¨Qt5ä¸­å¯¹åº”çš„æ–°çš„å‡½æ•°ã€‚\nè·Ÿéšæ—¶ä»£è„šæ­¥ï¼Œå¢åŠ äº†ä¸å°‘æ–°ç‰¹æ€§ä»¥æ»¡è¶³æ—¥ç›Šå¢é•¿çš„å®¢æˆ·éœ€æ±‚ã€‚\nå¯¹æŸäº›æ¨¡å—å’Œç±»å‹åŠå¤„ç†è¿›è¡Œäº†é©å‘½æ€§çš„é‡å†™ï¼Œè¿è¡Œæ•ˆç‡æé«˜ä¸å°‘ã€‚\næœ‰å‚æ•°ç±»å‹çš„å˜åŒ–ï¼Œæ¯”å¦‚ long * åˆ° qintptr * ç­‰ï¼Œæ›´åŠ é€‚åº”åç»­çš„æ‹“å±•ä»¥åŠåŒæ—¶å¯¹32 64ä½ä¸åŒç³»ç»Ÿçš„å…¼å®¹ã€‚\næºç ä¸­çš„doubleæ•°æ®ç±»å‹å…¨éƒ¨æ¢æˆäº†qrealï¼Œå’ŒQtå†…éƒ¨æ•°æ®ç±»å‹é«˜åº¦ä¸€è‡´å’Œç»Ÿä¸€ã€‚\næˆ‘æµ‹è¯•çš„éƒ½æ˜¯QWidgetéƒ¨åˆ†ï¼Œquickéƒ¨åˆ†æ²¡æœ‰æµ‹è¯•ï¼Œä¼°è®¡quickéƒ¨åˆ†æ›´æ–°å¯èƒ½ä¼šæ›´å¤šã€‚\nå¼ºçƒˆå»ºè®®æš‚æ—¶ä¸è¦ç”¨Qt6.0åˆ°Qt6.2ä¹‹é—´çš„ç‰ˆæœ¬ï¼Œä¸€äº›æ¨¡å—è¿˜ç¼ºå¤±ï¼Œç›¸å¯¹æ¥è¯´BUGä¹Ÿæ¯”è¾ƒå¤šï¼Œæ¨è6.2.2ç‰ˆæœ¬å¼€å§‹æ­£å¼è¿ç§»ã€‚\n\n01ï¼š01-10\nä¸‡èƒ½æ–¹æ³•ï¼šå®‰è£…5.15ç‰ˆæœ¬ï¼Œå®šä½åˆ°æŠ¥é”™çš„å‡½æ•°ï¼Œåˆ‡æ¢åˆ°æºç å¤´æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”æç¤ºå­—æ · QT_DEPRECATED_X(â€œUse sizeInBytesâ€) å’Œæ–°å‡½æ•°ã€‚æŒ‰ç…§è¿™ä¸ªæç¤ºç±»ä¿®æ”¹å°±æ²¡é”™ï¼Œä¸€äº›å‡½æ•°æ˜¯ä»Qt5.7 5.9 5.10ç­‰ç‰ˆæœ¬æ–°å¢åŠ çš„ï¼Œå¯èƒ½ä½ çš„é¡¹ç›®è¿˜ç”¨çš„Qt4çš„æ–¹æ³•ï¼Œä½†æ˜¯Qt6ä»¥å‰éƒ½å…¼å®¹è¿™äº›æ—§æ–¹æ³•ï¼Œåˆ°äº†Qt6å°±å½»åº•éœ€è¦ç”¨æ–°æ–¹æ³•äº†ã€‚PSï¼šå¦‚æœæœ¬èº«å°±æ˜¯Qt6æ–°å¢çš„åŠŸèƒ½å‡½æ•°åˆ™æ­¤æ–¹æ³•æ— æ•ˆ\n\nQt6å¯¹coreè¿™ä¸ªæ ¸å¿ƒç±»è¿›è¡Œäº†æ‹†åˆ†ï¼Œå¤šå‡ºæ¥core5compatï¼Œå› æ­¤ä½ éœ€è¦åœ¨proå¢åŠ å¯¹åº”çš„æ¨¡å—å·²ç»ä»£ç ä¸­å¼•å…¥å¯¹åº”çš„å¤´æ–‡ä»¶ã€‚\n1234567891011//proæ–‡ä»¶å¼•å…¥æ¨¡å—greaterThan(QT_MAJOR_VERSION, 4): QT += widgetsgreaterThan(QT_MAJOR_VERSION, 5): QT += core5compat//ä»£ç ä¸­å¼•å…¥å¤´æ–‡ä»¶#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))#include &lt;QtWidgets&gt;#endif#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))#include &lt;QtCore5Compat&gt;#endif\n\né»˜è®¤Qt6å¼€å¯äº†é«˜åˆ†å±æ”¯æŒï¼Œç•Œé¢ä¼šå˜å¾—å¾ˆå¤§ï¼Œç”šè‡³å­—ä½“å‘è™šï¼Œå¾ˆå¤šäººä¼šä¸ä¹ æƒ¯ï¼Œå› ä¸ºè¿™ç§æ¨¡å¼å¦‚æœç¨‹åºå¾ˆå¤šåæ ‡è®¡ç®—æ²¡æœ‰é‡‡ç”¨devicePixelRatioè¿›è¡Œè¿ç®—çš„è¯ï¼Œ100%ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œå› ä¸ºåæ ‡ä¸å‡†ç¡®äº†ã€‚è¦å–æ¶ˆè¿™ç§æ•ˆæœå¯ä»¥è®¾ç½®é«˜åˆ†å±ç¼©æ”¾å› å­ã€‚\n123#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    QGuiApplication::setHighDpiScaleFactorRoundingPolicy(Qt::HighDpiScaleFactorRoundingPolicy::Floor);#endif\n\nåŸæœ‰çš„éšæœºæ•°å‡½æ•°æç¤ºç”¨QRandomGeneratoræ›¿ä»£ï¼Œä¸ºäº†å…¼å®¹æ‰€æœ‰qtç‰ˆæœ¬ï¼Œæ”¹åŠ¨æœ€å°çš„åŠæ³•æ˜¯ç›´æ¥ç”¨c++ä¸­çš„éšæœºæ•°ï¼Œæ¯”å¦‚qsrandå‡½æ•°æ¢æˆsrandï¼Œqrandå‡½æ•°æ¢æˆrandï¼ŒæŸ¥çœ‹è¿‡æºä»£ç ï¼Œå…¶å®å°è£…çš„å°±æ˜¯c++ä¸­çš„éšæœºæ•°ï¼Œå¾ˆå¤šç±»ä¼¼çš„å°è£…æ¯”å¦‚qSinå°è£…çš„sinã€‚\n\nQColorçš„ light æ”¹æˆ lighter ï¼Œdark æ”¹æˆ darkerï¼Œå…¶å® lighterã€darker è¿™ä¸¤ä¸ªæ–¹æ³•ä»¥å‰ä¸€ç›´æœ‰ã€‚\n\nQFontMetricsF ä¸­çš„ fm.width æ¢æˆ fm.horizontalAdvance ï¼Œä»5.11å¼€å§‹ç”¨æ–°å‡½æ•°ã€‚\n\nQPaletteè°ƒè‰²æ¿æšä¸¾å€¼ï¼ŒForeground &#x3D; WindowText, Background &#x3D; Windowï¼Œå…¶ä¸­ Foreground å’Œ Background æ²¡æœ‰äº†ï¼Œè¦ç”¨ WindowText å’Œ Window æ›¿ä»£ï¼Œä»¥å‰å°±æœ‰ã€‚ç±»ä¼¼çš„è¿˜æœ‰ setTextColor æ”¹æˆäº† setForeground ã€‚\n\nQWheelEventçš„ delta() æ”¹æˆ angleDelta().y()ï¼Œpos() æ”¹æˆ position() ã€‚\n\nsvgæ¨¡å—æ‹†åˆ†å‡ºæ¥äº†svgwidgetsï¼Œå¦‚æœç”¨åˆ°äº†è¯¥æ¨¡å—åˆ™éœ€è¦åœ¨proå¢åŠ  QT +&#x3D; svgwidgets ï¼ŒåŒç†openglæ¨¡å—æ‹†åˆ†å‡ºæ¥äº†openglwidgetsã€‚\n\nqlayoutä¸­çš„ margin() å‡½æ•°æ¢æˆ contentsMargins().left()ï¼ŒæŸ¥çœ‹æºç å¾—çŸ¥ä»¥å‰çš„ margin() è¿”å›çš„å°±æ˜¯ contentsMargins().left()ï¼Œåœ¨å››ä¸ªæ•°å€¼ä¸€æ ·çš„æ—¶å€™ï¼Œé»˜è®¤å››ä¸ªæ•°å€¼å°±æ˜¯ä¸€æ ·ã€‚ç±»ä¼¼çš„è¿˜æœ‰setMarginç§»é™¤äº†ï¼Œç»Ÿç»Ÿç”¨setContentsMarginsã€‚\n\n\n02ï¼š11-20\nä¹‹å‰ QChar c &#x3D; 0xf105 å…¨éƒ¨è¦æ”¹æˆå¼ºåˆ¶è½¬æ¢ QChar c &#x3D; (QChar)0xf105ï¼Œä¸å†æœ‰éšå¼è½¬æ¢ï¼Œä¸ç„¶ç¼–è¯‘æŠ¥é”™æç¤ºerror: conversion from â€˜intâ€™ to â€˜QCharâ€™ is ambiguous ã€‚\n\nqSortç­‰ä¸€äº›å‡½æ•°ç”¨å›c++çš„ std::sort ã€‚\n12345#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    std::sort(ipv4s.begin(), ipv4s.end());#else    qSort(ipv4s);#endif\n\nQt::WA_NoBackground æ”¹æˆ Qt::WA_OpaquePaintEvent ã€‚\n\nQMatrix ç±»åºŸå¼ƒäº†æ²¡æœ‰äº†ï¼Œæ¢æˆ QTransform ï¼Œå‡½æ•°åŠŸèƒ½åŸºæœ¬ä¸€è‡´ï¼ŒQTransform ç±»åœ¨Qt4å°±ä¸€ç›´æœ‰ã€‚\n\nQTime è®¡æ—¶å»æ‰äº†ï¼Œéœ€è¦æ”¹æˆ QElapsedTimer ï¼ŒQElapsedTimer ç±»åœ¨Qt4å°±ä¸€ç›´æœ‰ã€‚\n\nQApplication::desktop()åºŸå¼ƒäº†ï¼Œ æ¢æˆäº† QApplication::primaryScreen()ã€‚\n123456789#if (QT_VERSION &gt; QT_VERSION_CHECK(5,0,0))#include &quot;qscreen.h&quot;#define deskGeometry qApp-&gt;primaryScreen()-&gt;geometry()#define deskGeometry2 qApp-&gt;primaryScreen()-&gt;availableGeometry()#else#include &quot;qdesktopwidget.h&quot;#define deskGeometry qApp-&gt;desktop()-&gt;geometry()#define deskGeometry2 qApp-&gt;desktop()-&gt;availableGeometry()#endif\n\nè·å–å½“å‰å±å¹•ç´¢å¼•ä»¥åŠå°ºå¯¸éœ€è¦åˆ†åˆ«å¤„ç†ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//è·å–å½“å‰å±å¹•ç´¢å¼•int QUIHelper::getScreenIndex()&#123;    //éœ€è¦å¯¹å¤šä¸ªå±å¹•è¿›è¡Œå¤„ç†    int screenIndex = 0;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    int screenCount = qApp-&gt;screens().count();#else    int screenCount = qApp-&gt;desktop()-&gt;screenCount();#endif    if (screenCount &gt; 1) &#123;        //æ‰¾åˆ°å½“å‰é¼ æ ‡æ‰€åœ¨å±å¹•        QPoint pos = QCursor::pos();        for (int i = 0; i &lt; screenCount; ++i) &#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))            if (qApp-&gt;screens().at(i)-&gt;geometry().contains(pos)) &#123;#else            if (qApp-&gt;desktop()-&gt;screenGeometry(i).contains(pos)) &#123;#endif                screenIndex = i;                break;            &#125;        &#125;    &#125;    return screenIndex;&#125;//è·å–å½“å‰å±å¹•å°ºå¯¸åŒºåŸŸQRect QUIHelper::getScreenRect(bool available)&#123;    QRect rect;    int screenIndex = QUIHelper::getScreenIndex();    if (available) &#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))        rect = qApp-&gt;screens().at(screenIndex)-&gt;availableGeometry();#else        rect = qApp-&gt;desktop()-&gt;availableGeometry(screenIndex);#endif    &#125; else &#123;#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))        rect = qApp-&gt;screens().at(screenIndex)-&gt;geometry();#else        rect = qApp-&gt;desktop()-&gt;screenGeometry(screenIndex);#endif    &#125;    return rect;&#125;\n\nQRegExpç±»ç§»åˆ°äº†core5compatæ¨¡å—ï¼Œéœ€è¦ä¸»åŠ¨å¼•å…¥å¤´æ–‡ä»¶ #include ã€‚\n1234567891011121314    //è®¾ç½®é™åˆ¶åªèƒ½è¾“å…¥æ•°å­—+å°æ•°ä½    QString pattern = &quot;^-?[0-9]+([.]&#123;1&#125;[0-9]+)&#123;0,1&#125;$&quot;;    //è®¾ç½®IPåœ°å€æ ¡éªŒè¿‡æ»¤    QString pattern = &quot;(2[0-5]&#123;2&#125;|2[0-4][0-9]|1?[0-9]&#123;1,2&#125;)&quot;;    //ç¡®åˆ‡çš„è¯´ QRegularExpression QRegularExpressionValidator ä»5.0 5.1å¼€å§‹å°±æœ‰#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    QRegularExpression regExp(pattern);    QRegularExpressionValidator *validator = new QRegularExpressionValidator(regExp, this);#else    QRegExp regExp(pattern);    QRegExpValidator *validator = new QRegExpValidator(regExp, this);#endif    lineEdit-&gt;setValidator(validator);\n\nQWheelEventæ„é€ å‚æ•°å’Œå¯¹åº”çš„è®¡ç®—æ–¹ä½å‡½æ•°å˜äº†ã€‚\n123456789101112131415161718//æ¨¡æ‹Ÿé¼ æ ‡æ»šè½®#if (QT_VERSION &lt; QT_VERSION_CHECK(6,0,0))QWheelEvent wheelEvent(QPoint(0, 0), -scal, Qt::LeftButton, Qt::NoModifier);#elseQWheelEvent wheelEvent(QPointF(0, 0), QPointF(0, 0), QPoint(0, 0), QPoint(0, -scal), Qt::LeftButton, Qt::NoModifier, Qt::ScrollBegin, false);#endifQApplication::sendEvent(widget, &amp;wheelEvent);//é¼ æ ‡æ»šè½®ç›´æ¥ä¿®æ”¹å€¼QWheelEvent *whellEvent = (QWheelEvent *)event;//æ»šåŠ¨çš„è§’åº¦,*8å°±æ˜¯é¼ æ ‡æ»šåŠ¨çš„è·ç¦»#if (QT_VERSION &lt; QT_VERSION_CHECK(6,0,0))int degrees = whellEvent-&gt;delta() / 8;#elseint degrees = whellEvent-&gt;angleDelta().x() / 8;#endif//æ»šåŠ¨çš„æ­¥æ•°,*15å°±æ˜¯é¼ æ ‡æ»šåŠ¨çš„è§’åº¦int steps = degrees / 15;\n\nqVariantValue æ”¹æˆ qvariant_cast ï¼ŒqVariantSetValue(v, value) æ”¹æˆäº† v.setValue(val)ã€‚ç›¸å½“äºé€€å›åˆ°æœ€åŸå§‹çš„æ–¹æ³•ï¼ŒæŸ¥çœ‹qVariantValueæºç å°è£…çš„å°±æ˜¯qvariant_castã€‚\n\n\n03ï¼š21-30\nQStyleOptionçš„initæ”¹æˆäº†initFromã€‚\n\nQVariant::Type æ¢æˆäº† QMetaType::Type ï¼Œæœ¬èº«ä»¥å‰çš„ QVariant::Type å°è£…çš„å°±æ˜¯ QMetaType::Type ã€‚\n\nQStyleOptionViewItemV2 V3 V4 ä¹‹ç±»çš„å…¨éƒ¨æ²¡æœ‰äº†ï¼Œæš‚æ—¶å¯ä»¥ç”¨ QStyleOptionViewItem æ›¿ä»£ã€‚\n\nQFontçš„ resolve çš„ä¸€ä¸ªé‡è½½å‡½æ•°æ¢æˆäº† resolveMaskã€‚\n\nQSettingsçš„ setIniCodec æ–¹æ³•ç§»é™¤äº†ï¼Œé»˜è®¤å°±æ˜¯utf8ï¼Œä¸éœ€è¦è®¾ç½®ã€‚\n\nqcombobox çš„ activated(QString) å’Œ currentIndexChanged(QString) ä¿¡å·åˆ é™¤äº†ï¼Œç”¨intç´¢å¼•å‚æ•°çš„é‚£ä¸ªï¼Œç„¶åè‡ªå·±é€šè¿‡ç´¢å¼•è·å–å€¼ã€‚ä¸ªäººè§‰å¾—è¿™ä¸ªæ²¡å¿…è¦åˆ é™¤ã€‚\n\nqtscriptæ¨¡å—å½»åº•æ²¡æœ‰äº†ï¼Œå°½ç®¡ä»Qt5æ—¶ä»£çš„åæœŸç‰ˆæœ¬å°±æç¤ºä¸ºåºŸå¼ƒæ¨¡å—ï¼Œä¸€è‡´åšæŒåˆ°Qt6æ‰æ­£å¼åºŸå¼ƒï¼Œå„ç§jsonæ•°æ®è§£æå…¨éƒ¨æ¢æˆqjsonç±»è§£æã€‚\n\nQByteArray çš„ append indexOf lastIndexOf ç­‰ä¼—å¤šæ–¹æ³•çš„QStringå‚æ•°é‡è½½å‡½æ•°åºŸå¼ƒäº†ï¼Œè¦ç›´æ¥ä¼  QByteArrayï¼Œå°±åœ¨åŸæ¥å‚æ•°åŸºç¡€ä¸ŠåŠ ä¸Š .toUtf8() ã€‚æŸ¥çœ‹æºç ä¹Ÿçœ‹å¾—åˆ°ä»¥å‰çš„QStringå‚æ•°ä¹Ÿæ˜¯è½¬æˆ.toUtf8()å†å»æ¯”è¾ƒã€‚\n\nQDateTimeçš„æ—¶é—´è½¬æ¢å‡½æ•° toTime_t + setTime_t åå­—æ”¹äº†ï¼Œå¯¹åº”æ”¹æˆäº† toSecsSinceEpoch + setSecsSinceEpoch ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨Qt5.8æ—¶å€™æ–°å¢åŠ çš„ã€‚\n\nQLabelçš„ pixmap å‡½æ•°ä¹‹å‰æ˜¯æŒ‡é’ˆ *pixmap() ç°åœ¨æ¢æˆäº†å¼•ç”¨ pixmap()ã€‚\n\n\n04ï¼š31-40\nQTableWidgetçš„ sortByColumn æ–¹æ³•ç§»é™¤äº†é»˜è®¤å‡åºçš„æ–¹æ³•ï¼Œå¿…é¡»è¦å¡«å…¥ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå‡åºè¿˜æ˜¯é™åºã€‚\n\nqtnetworkæ¨¡å—ä¸­ï¼ˆTCP&#x2F;UDPç›¸å…³çš„socketï¼‰çš„é”™è¯¯ä¿¡å·erroræ¢æˆäº†errorOccurredï¼Œå°±æ”¹äº†ä¸ªåå­—ï¼Œæ³¨æ„websocketé‚£å—å±…ç„¶æ²¡ç»Ÿä¸€æ”¹è¿‡æ¥ä¾ç„¶æ˜¯å«errorã€‚\n12345678910#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    connect(udpSocket, SIGNAL(errorOccurred(QAbstractSocket::SocketError)), this, SLOT(error()));    connect(tcpSocket, SIGNAL(errorOccurred(QAbstractSocket::SocketError)), this, SLOT(error()));#else    connect(udpSocket, SIGNAL(error(QAbstractSocket::SocketError)), this, SLOT(error()));    connect(tcpSocket, SIGNAL(error(QAbstractSocket::SocketError)), this, SLOT(error()));#endif//ç‰¹åˆ«æ³¨æ„websocketä¸­ä¾ç„¶è¿˜æ˜¯ç”¨errorconnect(webSocket, SIGNAL(error(QAbstractSocket::SocketError)), this, SLOT(error()));\n\nXmlPatternsæ¨¡å—æœ¨æœ‰äº†ï¼Œå…¨éƒ¨ç”¨xmlæ¨¡å—é‡æ–°è§£æã€‚\n\nnativeEventçš„å‚æ•°ç±»å‹å˜äº†ã€‚\n12345#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))bool nativeEvent(const QByteArray &amp;eventType, void *message, qintptr *result);#elsebool nativeEvent(const QByteArray &amp;eventType, void *message, long *result);#endif\n\nQButtonGroupçš„buttonClickedä¿¡å·ä¸­intå‚æ•°çš„å‡½æ•°å…¨éƒ¨æ”¹åå­—å«idClickedã€‚\n123456    QButtonGroup *btnGroup = new QButtonGroup(this);#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    connect(btnGroup, SIGNAL(idClicked(int)), ui-&gt;xstackWidget, SLOT(setCurrentIndex(int)));#else    connect(btnGroup, SIGNAL(buttonClicked(int)), ui-&gt;xstackWidget, SLOT(setCurrentIndex(int)));#endif\n\nQWebEngineSettingsä¹‹å‰æ˜¯QWebEngineSettings::defaultSettings();ç°åœ¨æ”¹æˆäº†QWebEngineProfile::defaultProfile()-&gt;settings();é€šè¿‡æŸ¥çœ‹ä¹‹å‰çš„æºç å¾—çŸ¥QWebEngineSettings::defaultSettings();å°è£…çš„å°±æ˜¯QWebEngineProfile::defaultProfile()-&gt;settings();å› ä¸ºQt6å»é™¤äº†Nå¤šè¿‡åº¦å°è£…çš„å‡½æ•°ã€‚\n12345#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    QWebEngineSettings *webSetting = QWebEngineProfile::defaultProfile()-&gt;settings();#else    QWebEngineSettings *webSetting = QWebEngineSettings::defaultSettings();#endif\n\nQt6å°†enterEventçš„å‚æ•°QEventæ”¹æˆäº†QEnterEventä¹Ÿä¸æ‰“ä¸ªæ‹›å‘¼ã€‚è¿™ç§æ”¹å˜ç¼–è¯‘ä¹Ÿä¸ä¼šæç¤ºçš„ã€‚\n12345678910111213#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,0,0))    void enterEvent(QEnterEvent *);#else    void enterEvent(QEvent *);#endif//åé¢ç»è¿‡JasonWongå¤§ä½¬çš„æŒ‡ç‚¹ï¼Œä»çˆ¶ç±»é‡æ–°å®ç°çš„virtualä¿®é¥°çš„å‡½æ•°ï¼Œå»ºè®®éƒ½åŠ ä¸Šoverrideå…³é”®å­—ã€‚//è¿™æ ·çš„è¯ä¸€æ—¦çˆ¶ç±»çš„å‡½æ•°æˆ–è€…å‚æ•°å˜äº†åˆ™ä¼šæç¤ºç¼–è¯‘æŠ¥é”™ï¼Œè€Œä¸æ˜¯ç¼–è¯‘é€šè¿‡ä½†æ˜¯è¿è¡Œä¸æ­£å¸¸ä¼šä¸€è„¸æ‡µé€¼èŒ«ç„¶ï¼Œä»è€ŒæŠŠé”…æ‰£ç»™Qtã€‚//ä¸‹é¢æ˜¯çˆ¶ç±»å‡½æ•°virtual void enterEvent(QEvent *event);//å­ç±»å»ºè®®åŠ ä¸Šoverridevoid enterEvent(QEvent *event) override;\n\nQt6ä¸­å¤šä¸ªç±»è¿›è¡Œäº†åˆå¹¶ï¼Œæ¯”å¦‚ç°åœ¨QVectorå°±æˆäº†QListçš„åˆ«åï¼Œæ„å‘³ç€è¿™ä¸¤ä¸ªç±»æ˜¯åŒä¸€ä¸ªç±»æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå¯èƒ½Qtå†…éƒ¨å¯¹ä¸¤ç§çš„ä¼˜ç‚¹éƒ½é›†ä¸­åœ¨ä¸€èµ·ï¼Œå¹¶å°½é‡é‡å†™ç®—æ³•æˆ–è€…å…¶ä»–å¤„ç†è§„é¿ç¼ºç‚¹ã€‚åŒç†QStringListç°åœ¨ä¹Ÿæˆäº† QList&lt;QString&gt; çš„åˆ«åï¼Œæ˜¯åŒä¸€ä¸ªç±»ï¼Œæ²¡æœ‰å•ç‹¬çš„ç±»ã€‚\n\nåœ¨Qt4æ—¶ä»£é»˜è®¤QWidgetæ„é€ å‡½æ•°çˆ¶ç±»æ˜¯0ï¼Œåˆ°äº†Qt5å˜æˆäº†Q_NULLPTRï¼Œåˆ°äº†Qt6å±…ç„¶ç”¨çš„æ˜¯é»˜è®¤çš„c++æ ‡å‡†ä¸­çš„nullptrè€Œä¸æ˜¯Qtè‡ªå®šä¹‰å®šä¹‰çš„Q_NULLPTRï¼ˆåŒæ ·çš„è¿˜æœ‰Q_DECL_OVERRIDEæ¢æˆäº†ç”¨overrideç­‰ï¼‰ï¼Œå¯èƒ½æ˜¯ä¸ºäº†å½»åº•æŠ›å¼ƒå†å²åŒ…è¢±æ‹¥æŠ±æœªæ¥ã€‚\n12345678910111213//ä¸‹é¢ä¾æ¬¡æ˜¯Qt4/5/6çš„å†™æ³•MainWindow(QWidget *parent = 0);MainWindow(QWidget *parent = Q_NULLPTR);MainWindow(QWidget *parent = nullptr);//æŸ¥é˜…Qtæºç æŸ¥çœ‹Q_NULLPTRåŸæ¥æ˜¯æ ¹æ®ç¼–è¯‘å™¨å®šä¹‰æ¥é€‰æ‹©#ifdef Q_COMPILER_NULLPTR# define Q_NULLPTR         nullptr#else# define Q_NULLPTR         NULL#endif//Qté«˜ç‰ˆæœ¬å…¼å®¹ä½ç‰ˆæœ¬å†™æ³•æ¯”å¦‚Qt5/6éƒ½æ”¯æŒ *parent = 0 è¿™ç§å†™æ³•ã€‚\n\nå¯¹äºå§”æ‰˜çš„è¿›åº¦æ¡æ ·å¼QStyleOptionProgressBarç±»çš„å±æ€§ï¼Œåœ¨Qt4çš„æ—¶å€™ä¸èƒ½è®¾ç½®æ¨ªå‘è¿˜æ˜¯å‚ç›´æ ·å¼ï¼Œé»˜è®¤æ¨ªå‘æ ·å¼ï¼Œè¦è®¾ç½®orientationéœ€è¦ç”¨å¦å¤–çš„QStyleOptionProgressBarV2ã€‚ä»Qt5å¼€å§‹æ–°å¢äº†orientationå’ŒbottomToTopå±æ€§è®¾ç½®ã€‚åœ¨Qt6çš„æ—¶å€™å½»åº•ç§»é™¤äº†orientationå±æ€§ï¼Œåªæœ‰bottomToTopå±æ€§ï¼Œè€Œä¸”é»˜è®¤è¿›åº¦æ˜¯å‚ç›´çš„ï¼Œå¾ˆæ“è›‹ï¼Œç†è®ºä¸Šé»˜è®¤åº”è¯¥æ˜¯æ¨ªå‘çš„æ‰å¯¹ï¼Œç»å¤§éƒ¨åˆ†è¿›åº¦æ¡åœºæ™¯éƒ½æ˜¯æ¨ªå‘çš„ã€‚è¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼ŒåŸæ¥ç°åœ¨çš„å¤„ç†é€»è¾‘æ”¹äº†ï¼Œé»˜è®¤å‚ç›´çš„ï¼Œå¦‚æœè¦è®¾ç½®æ¨ªå‘çš„ç›´æ¥è®¾ç½® styleOption.state |&#x3D; QStyle::State_Horizontal è¿™ç§æ–¹å¼è®¾ç½®æ‰è¡Œï¼Œè€ŒQt6ä»¥å‰é»˜è®¤æ–¹å‘æ˜¯é€šè¿‡ orientation å€¼å–å¾—ï¼Œè¿™ä¸ªState_Horizontalä»Qt4å°±ä¸€ç›´æœ‰ï¼ŒQt6ä»¥åè¦ä¸»åŠ¨è®¾ç½®ä¸‹æ‰æ˜¯æ¨ªå‘çš„å°±æ˜¯ã€‚\n\n\n05ï¼š41-50\nQt6.2ç‰ˆæœ¬å¼€å§‹å¢åŠ äº†å¯¹å¤šåª’ä½“æ¨¡å—çš„æ”¯æŒï¼Œä½†æ˜¯åœ¨mingwç¼–è¯‘å™¨ä¸‹è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œç›´åˆ°6.2.2æ‰ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå®˜ç½‘è§£é‡Šæ˜¯å› ä¸ºmingwç¼–è¯‘å™¨ç‰ˆæœ¬ä¸æ”¯æŒï¼Œåˆ°6.2.2é‡‡ç”¨äº†æ–°çš„mingw900_64ï¼Œè¿™ä¸ªç¼–è¯‘å™¨ç‰ˆæœ¬æ‰æ”¯æŒã€‚æ‰€ä»¥ç†è®ºä¸Šæ¨èä»6.2.2å¼€å§‹ä½¿ç”¨æ–°çš„Qt6ã€‚\n\nQTextStreamä¸­çš„setCodecæ–¹æ³•æ”¹æˆäº†setEncodingï¼Œå‚æ•°å˜äº†ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚\n12345678QTextStream stream(&amp;file);#if (QT_VERSION &lt; QT_VERSION_CHECK(6,0,0))stream.setCodec(&quot;utf-8&quot;);stream.setCodec(&quot;gbk&quot;);#elsestream.setEncoding(QStringConverter::Utf8);stream.setEncoding(QStringConverter::System);#endif\n\nQModelIndexçš„æŸ¥æ‰¾å­èŠ‚ç‚¹childå‡½æ•°å»æ‰äº†ï¼Œä½†æ˜¯æŸ¥æ‰¾çˆ¶èŠ‚ç‚¹parentå‡½æ•°ä¿ç•™ï¼ŒæŸ¥é˜…ä»£ç å¾—çŸ¥ä¹‹å‰çš„childå‡½æ•°å°±æ˜¯å°è£…çš„model-&gt;index(row, column, QModelIndex)å‡½æ•°ã€‚\n1234567//ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ç­‰ä»· å¦‚æœè¦å…¼å®¹Qt456åˆ™ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•QModelIndex index = indexParent.child(i, 0);QModelIndex index = model-&gt;index(i, 0, indexParent);//ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ç­‰ä»· å¦‚æœè¦å…¼å®¹Qt456åˆ™ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•QModelIndex indexChild = index.child(i, 0);QModelIndex indexChild = model-&gt;index(i, 0, index);\n\nä¹‹å‰QPixmapç±»ä¸­çš„é™æ€å‡½æ•°grabWindowå’ŒgrabWidgetå½»åº•åºŸå¼ƒäº†ï¼Œæ”¹æˆäº†ç”¨QApplication::primaryScreen()-&gt;grabWindowï¼Œå…¶å®è¿™ä¸ªä»Qt5å¼€å§‹å°±å»ºè®®ç”¨è¿™ä¸ªã€‚\n12345#if (QT_VERSION &gt;= QT_VERSION_CHECK(5,0,0))    QPixmap pixmap = QApplication::primaryScreen()-&gt;grabWindow(widget-&gt;winId());#else    QPixmap pixmap = QPixmap::grabWidget(widget-&gt;winId());#endif\n\nQProcessä¸­çš„startæ–¹æ³•ä»¥å‰ç›´æ¥æ”¯æŒä¼ å…¥å®Œæ•´çš„å‘½ä»¤ï¼Œåˆ°äº†Qt6ä¸¥æ ¼è¦æ±‚å¿…é¡»æ‹†åˆ†åé¢çš„å‚æ•°ã€‚\n12345//Qt6ä»¥å‰æ”¯æŒæ‰§è¡Œå®Œæ•´å‘½ä»¤QProcess p;p.start(&quot;wmic cpu get Name&quot;);//Qt6éœ€è¦æ”¹æˆä¸‹é¢çš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¹Ÿå…¼å®¹Qt4ã€5ã€6p.start(&quot;wmic&quot;, QStringList() &lt;&lt; &quot;cpu&quot; &lt;&lt; &quot;get&quot; &lt;&lt; &quot;Name&quot;);\n\nåœ¨qssä¸­å¯¹å±æ€§çš„æšä¸¾å€¼å†™æ³•åˆ°äº†Qt6æ¢æˆäº†æ•°å€¼è¡¨ç¤ºï¼ˆéœ€è¦ç¿»é˜…æšä¸¾å€¼çš„å®šä¹‰æ‰¾åˆ°å¯¹åº”çš„å€¼ï¼‰ï¼Œè¿™ä¸ªæ”¹åŠ¨æŒºå¤§ï¼Œåˆ‡è®°éœ€è¦åˆ‡æ¢è¿‡æ¥ï¼Œè€Œä¸”è¿™ç§å†™æ³•ä¸å…¼å®¹Qt5ã€‚\n123456789//Qt4/5 é€šè¿‡æ ·å¼è¡¨è®¾ç½®æ ‡ç­¾å³ä¸Šè§’å¯¹é½ui-&gt;label-&gt;setStyleSheet(&quot;qproperty-alignment:AlignRight;&quot;);//Qt4/5 é€šè¿‡æ ·å¼è¡¨è®¾ç½®æ ‡ç­¾å±…ä¸­å¯¹é½ui-&gt;label-&gt;setStyleSheet(&quot;qproperty-alignment:AlignHCenter|AlignVCenter;&quot;);//Qt6 é€šè¿‡æ ·å¼è¡¨è®¾ç½®æ ‡ç­¾å³ä¸Šè§’å¯¹é½ ç¿»é˜… AlignRight çš„æšä¸¾å€¼=2ui-&gt;label-&gt;setStyleSheet(&quot;qproperty-alignment:2;&quot;);//Qt6 é€šè¿‡æ ·å¼è¡¨è®¾ç½®æ ‡ç­¾å±…ä¸­å¯¹é½ ç¿»é˜… AlignHCenter|AlignVCenter çš„æšä¸¾å€¼=0x04|0x80=0x84=132ui-&gt;label-&gt;setStyleSheet(&quot;qproperty-alignment:132;&quot;);\n\nQt6ä¸­å¤šåª’ä½“æ¨¡å—çš„ç±»åšäº†å·¨å¤§è°ƒæ•´æ”¹åŠ¨ï¼Œæœ‰äº›æ˜¯ç±»åçš„å˜åŒ–ï¼Œæ¯”å¦‚éŸ³é¢‘è¾“å‡ºï¼ˆä¹Ÿå«æ’­æ”¾ï¼‰ä¹‹å‰æ˜¯ QAudioOutput ç°åœ¨æ˜¯ QAudioSink ï¼ŒéŸ³é¢‘è¾“å…¥ï¼ˆä¹Ÿå«å½•éŸ³ï¼‰ä¹‹å‰æ˜¯ QAudioInput ç°åœ¨æ˜¯ QAudioSource ï¼Œé»˜è®¤éŸ³é¢‘è¾“å…¥è¾“å‡ºè®¾å¤‡é›†åˆä¹‹å‰æ˜¯ QAudioDeviceInfo::defaultInputDevice()ã€QAudioDeviceInfo::defaultOutputDevice()ï¼Œç°åœ¨æ˜¯ QMediaDevices::defaultAudioInput()ã€QMediaDevices::defaultAudioOutput()ã€‚æ„Ÿè§‰è¿™ä¸ªåå­—æ”¹çš„æ²¡æœ‰ä»¥å‰è´´åˆ‡ã€‚\n12345678910111213141516#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,2,0))#define AudioInput QAudioSource#define AudioOutput QAudioSink#else#define AudioInput QAudioInput#define AudioOutput QAudioOutput#endif//ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦newå°±è¡ŒAudioInput *input = new AudioInput(format, this);#if (QT_VERSION &gt;= QT_VERSION_CHECK(6,2,0))#define QAudioInput QAudioSource#define QAudioOutput QAudioSink#endif//ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦newå°±è¡ŒQAudioInput *input = new QAudioInput(format, this);\n\nQt6å¼€å§‹é»˜è®¤ç”¨cmakeï¼Œæ‰€ä»¥ç°åœ¨æ–°ç‰ˆçš„qtcreatoråœ¨æ–°å»ºé¡¹ç›®çš„æ—¶å€™é»˜è®¤é€‰æ‹©çš„å°±æ˜¯cmakeï¼Œå¾ˆå¤šåˆå­¦è€…é¦–æ¬¡ç”¨çš„æ—¶å€™ä¼šå‘ç°ï¼Œæ€ä¹ˆçªç„¶ä¹‹é—´ç”Ÿæˆçš„é¡¹ç›®ï¼Œç»“æ„éƒ½ä¸ä¸€æ ·ï¼Œçªç„¶ä¹‹é—´æ‡µé€¼äº†ï¼Œæ‰€ä»¥è¦åœ¨æ–°å»ºé¡¹ç›®çš„è¿‡ç¨‹ä¸­é€‰æ‹©qmakeï¼Œé€‰æ‹©ä¸€æ¬¡ä»¥åå°±é»˜è®¤qmakeäº†ã€‚\n\nQt6.4å¼€å§‹å¯¹åº”ç±»QString&#x2F;QByteArrayçš„countå‡½æ•°åºŸå¼ƒäº†ï¼Œæ”¹ç”¨size&#x2F;lengthå‡½æ•°ï¼Œä¼°è®¡å¯èƒ½æè¿°æ›´å‡†ç¡®å§ã€‚\n\nQt6.4.1æ–°å¢äº†Nå¤šBUGï¼Œå¼ºçƒˆä¸å»ºè®®ä½¿ç”¨ï¼Œæ¯”å¦‚QAudioSinkæ’­æ”¾å£°éŸ³æ²¡æœ‰å£°éŸ³ https://bugreports.qt.io/browse/QTBUG-108383ï¼ŒDPIç¼©æ”¾ä¸¥é‡å˜å½¢ https://bugreports.qt.io/browse/QTBUG-108593ã€‚è¿™äº›BUGåœ¨6.4.0&#x2F;6.5.0æ˜¯ä¸å­˜åœ¨çš„ï¼ŒKPIå®³æ­»äººå•Šã€‚\n\nQt6.5ç‰ˆæœ¬å¼€å§‹å–æ¶ˆäº†QVariantçš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œä¹‹å‰return QVariant() ç°åœ¨å¿…é¡»æ”¹æˆ QVariant(QVariant::Invalid) æ‰ä¸ä¼šæœ‰è­¦å‘Šæç¤ºã€‚é€šè¿‡æ‰“å°å€¼å‘ç°QVariant()æœ¬èº«å°±&#x3D;QVariant(QVariant::Invalid)ï¼Œæ‰€ä»¥ç»Ÿä¸€å†™æˆQVariant(QVariant::Invalid)å…¼å®¹Qt456ã€‚\n\n\n3 Qtå®‰å“ç»éªŒ01ï¼š01-05\nproä¸­å¼•å…¥å®‰å“æ‹“å±•æ¨¡å— QT +&#x3D; androidextras ã€‚\nproä¸­æŒ‡å®šå®‰å“æ‰“åŒ…ç›®å½• ANDROID_PACKAGE_SOURCE_DIR &#x3D; $$PWD&#x2F;android æŒ‡å®šå¼•å…¥å®‰å“ç‰¹å®šç›®å½•æ¯”å¦‚ç¨‹åºå›¾æ ‡ã€å˜é‡ã€é¢œè‰²ã€javaä»£ç æ–‡ä»¶ã€jaråº“æ–‡ä»¶ç­‰ã€‚\n\n\nAndroidManifest.xml æ¯ä¸ªç¨‹åºå”¯ä¸€çš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢xmlæ ¼å¼çš„æ•°æ®ï¼Œæ ‡æ˜æ”¯æŒçš„å®‰å“ç‰ˆæœ¬ã€å›¾æ ‡ä½ç½®ã€æ¨ªå±ç«–å±ã€æƒé™ç­‰ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯æœ€å…³é”®çš„ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶åˆ™Qtä¼šé»˜è®¤ç”Ÿæˆä¸€ä¸ªã€‚\nandroid&#x2F;res&#x2F;drawable-hdpi drawable-xxxhdpi ç­‰ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯åº”ç”¨ç¨‹åºå›¾æ ‡ã€‚\nandroid&#x2F;res&#x2F;layout ç›®å½•ä¸‹å­˜æ”¾çš„å¸ƒå±€æ–‡ä»¶ã€‚\nandroid&#x2F;res&#x2F;values&#x2F;libs.xml å­˜å‚¨çš„ä¸€äº›å˜é‡å€¼ã€‚\nandroid&#x2F;libs ç›®å½•ä¸‹å­˜æ”¾çš„jaråº“æ–‡ä»¶ã€‚\nandroid&#x2F;src ç›®å½•ä¸‹å­˜æ”¾çš„javaä»£ç æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯æ ¹æ®åŒ…åå»ºç«‹çš„ä¸€å±‚å±‚å­ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨srcç›®å½•ä¸‹ã€‚\nå…¶ä»–ç›®å½•è‡ªè¡Œæœç´¢å®‰å“ç›®å½•è§„èŒƒã€‚\nåé¢çš„è¯´æ˜ç»Ÿä¸€ç”¨çš„androidç›®å½•ä¸¾ä¾‹ï¼Œå…¶å®ä½ å¯ä»¥æ”¹æˆä»»æ„ç›®å½•ï¼Œæ¯”å¦‚ä½ çš„ä»£ç ç›®å½•ä¸‹æ˜¯xxooå­˜æ”¾çš„å®‰å“ç›¸å…³çš„æ‰“åŒ…æ–‡ä»¶ï¼Œä½ å°±å†™æˆ ANDROID_PACKAGE_SOURCE_DIR &#x3D; $$PWD&#x2F;xxoo ã€‚\n\n\njavaç±»åå¿…é¡»å’Œæ–‡ä»¶åå®Œå…¨ä¸€è‡´ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚\njavaç±»å¿…é¡»åœ¨android&#x2F;srcç›®å½•ä¸‹ä¸ç„¶ä¸ä¼šæ‰“åŒ…åˆ°apkæ–‡ä»¶ï¼Œå¯ä»¥æ˜¯å­ç›®å½•æ¯”å¦‚ android&#x2F;src&#x2F;com&#x2F;qt ã€‚\nQtä»£ç ä¸­çš„QAndroidJniObjectæŒ‡å®šä¼ å…¥çš„javaåŒ…åï¼Œå¿…é¡»ä¸¥æ ¼å’Œjavaæ–‡ä»¶packageå®Œå…¨ä¸€è‡´ï¼Œä¸ç„¶ç¨‹åºæ‰§è¡Œåˆ°æ­¤å¤„ä¼šå› ä¸ºæ‰¾ä¸åˆ°è€Œå´©æºƒã€‚\n\n\nandroid&#x2F;scr&#x2F;MainActivity.java é¡¶éƒ¨ æ²¡æœ‰ package åˆ™ä»£ç ä¸­å¿…é¡»æ˜¯ QAndroidJniObject javaClass(â€œMainActivityâ€);\nandroid&#x2F;scr&#x2F;MainActivity.java é¡¶éƒ¨ package com.qandroid; åˆ™ä»£ç ä¸­å¿…é¡»æ˜¯ QAndroidJniObject javaClass(â€œcom&#x2F;qandroid&#x2F;MainActivityâ€);\nandroid&#x2F;scr&#x2F;com&#x2F;example&#x2F;MainActivity.java é¡¶éƒ¨ package com.qandroid; åˆ™ä»£ç ä¸­å¿…é¡»æ˜¯ QAndroidJniObject javaClass(â€œcom&#x2F;qandroid&#x2F;MainActivityâ€);\nandroid&#x2F;scr&#x2F;com&#x2F;example&#x2F;MainActivity.java é¡¶éƒ¨ package com.example.qandroid; åˆ™ä»£ç ä¸­å¿…é¡»æ˜¯ QAndroidJniObject javaClass(â€œcom&#x2F;qandroid&#x2F;example&#x2F;MainActivityâ€);\næ€»ä¹‹è¿™ä¸ªåŒ…åæ˜¯å’Œä»£ç ä¸­çš„packageåé¢ä¸€æ®µå»åˆï¼Œè€Œä¸æ˜¯ç›®å½•è·¯å¾„ã€‚ä¸ºäº†ç»Ÿä¸€ç®¡ç†æ–¹ä¾¿æŸ¥æ‰¾æ–‡ä»¶ï¼Œå»ºè®®åŒ…åå’Œç›®å½•è·¯å¾„ä¸€è‡´ã€‚\n\n02ï¼š06-10\nQtåªèƒ½å¹²Qtå†…éƒ¨ç±»çš„äº‹æƒ…ï¼Œåšä¸€äº›ç®€å•çš„UIäº¤äº’è¿˜æ˜¯éå¸¸æ–¹ä¾¿ï¼Œå¦‚æœæ¶‰åŠåˆ°åº•å±‚æ“ä½œï¼Œè¿˜æ˜¯éœ€è¦ç†Ÿæ‚‰javaä¼šå¦‚è™æ·»ç¿¼ï¼Œä¸€èˆ¬çš„åšæ³•å°±æ˜¯å†™å¥½javaæ–‡ä»¶è°ƒè¯•å¥½ï¼Œæä¾›é™æ€æ–¹æ³•ç»™Qtè°ƒç”¨ï¼Œè¿™æ ·é€šè¿‡QAndroidJniObjectè¿™ä¸ªä¸‡èƒ½èƒ¶æ°´å¯ä»¥åšåˆ°Qtç¨‹åºè°ƒç”¨javaä¸­çš„å‡½æ•°å¹¶æ‹¿åˆ°æ‰§è¡Œç»“æœï¼Œä¹Ÿå¯ä»¥æ¥æ”¶javaä¸­çš„å‡½æ•°ã€‚\nproä¸­é€šè¿‡ OTHER_FILES +&#x3D; android&#x2F;AndroidManifest.xml OTHER_FILES +&#x3D; android&#x2F;src&#x2F;JniMessenger.java å¼•å…¥æ–‡ä»¶å…¶å®å¯¹æ•´ä¸ªç¨‹åºçš„ç¼–è¯‘æ‰“åŒ…æ²¡æœ‰ä»»ä½•å½±å“ï¼Œå°±æ˜¯ä¸ºäº†æ–¹ä¾¿åœ¨QtCreatorä¸­æŸ¥çœ‹å’Œç¼–è¾‘ã€‚\nåœ¨Qtä¸­ä¸å®‰å“çš„javaæ–‡ä»¶äº¤äº’éƒ½æ˜¯ç”¨ä¸‡èƒ½çš„QAndroidJniObjectï¼Œå¯ä»¥æ‰§è¡Œjavaç±»ä¸­çš„æ™®é€šå‡½æ•°ã€é™æ€å‡½æ•°ï¼Œå¯ä»¥ä¼ ç±»å¯¹è±¡jclassã€ç±»åclassNameã€æ–¹æ³•methodNameã€å‚æ•°ï¼Œä¹Ÿå¯ä»¥æ‹¿åˆ°æ‰§è¡Œç»“æœè¿”å›å€¼ã€‚ (I)Væ‹¬å·ä¸­çš„æ˜¯å‚æ•°ç±»å‹ï¼Œæ‹¬å·åé¢çš„æ˜¯è¿”å›å€¼ç±»å‹ï¼Œvoidè¿”å›å€¼å¯¹åº”Vï¼Œç”±äºStringåœ¨javaä¸­ä¸æ˜¯æ•°æ®ç±»å‹è€Œæ˜¯ç±»ï¼Œæ‰€ä»¥è¦ç”¨Ljava&#x2F;lang&#x2F;String;è¡¨ç¤ºï¼Œå…¶ä»–ç±»ä½œä¸ºå‚æ•°ä¹Ÿæ˜¯è¿™æ ·å¤„ç†ã€‚\n\n\nè°ƒç”¨å®ä¾‹æ–¹æ³•ï¼šcallMethodã€callObjectMethodã€‚\nè°ƒç”¨é™æ€æ–¹æ³•ï¼šcallStaticMethodã€callStaticObjectMethodã€‚\nä¸å¸¦Objectçš„å‡½æ•°åç”¨æ¥æ‰§è¡Œæ— è¿”å›å€¼æˆ–è€…å¸¸è§„è¿”å›å€¼intã€floatç­‰çš„æ–¹æ³•ã€‚\nå¦‚æœè¿”å›å€¼æ˜¯Stringæˆ–è€…ç±»åˆ™éœ€è¦ç”¨å¸¦Objectçš„å‡½æ•°åæ¥æ‰§è¡Œï¼Œè¿”å›QAndroidJniObjectç±»å‹å†è½¬æ¢å¤„ç†æ‹¿åˆ°ç»“æœï¼Œæ¯”å¦‚toStringæ‹¿åˆ°å­—ç¬¦ä¸²ã€‚\n\n\nå„ç§å‚æ•°å’Œè¿”å›å€¼ç¤ºä¾‹ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061package org.qt;import org.qt.QtAndroidData;public class QtAndroidTest&#123;    //éœ€è¦é€šè¿‡å®ä¾‹æ¥è°ƒç”¨ æµ‹è¯•å‘ç°ä¸è®º private public æˆ–è€…ä¸å†™éƒ½å¯ä»¥è°ƒç”¨ æˆ‘æ“¦    private void printText()    &#123;        System.out.println(&quot;printText&quot;);    &#125;    public static void printMsg()    &#123;        System.out.println(&quot;printMsg&quot;);    &#125;    public static void printValue(int value)    &#123;        System.out.println(&quot;printValue:&quot; + value);    &#125;    public static void setValue(float value1, double value2, char value3)    &#123;        System.out.println(&quot;value1:&quot; + value1 + &quot; value2:&quot; + value2 + &quot; value3:&quot; + value3);    &#125;    public static int getValue()    &#123;        return 65536;    &#125;    public static int getValue(int value)    &#123;        return value + 1;    &#125;    public static void setMsg(String message)    &#123;        System.out.println(&quot;setMsg:&quot; + message);    &#125;    public static String getMsg()    &#123;        return &quot;hello from java&quot;;    &#125;    public static void setText(int value1, float value2, boolean value3, String message)    &#123;        System.out.println(&quot;value1:&quot; + value1 + &quot; value2:&quot; + value2 + &quot; value3:&quot; + value3 + &quot; message:&quot; + message);    &#125;    public static String getText(int value1, float value2, boolean value3, String message)    &#123;        //åŒæ—¶æ¼”ç¤ºè§¦å‘é™æ€å‡½æ•°å‘ç»™Qt        QtAndroidData.receiveData(&quot;message&quot;, &quot;ä½ å¥½å•Š java&quot;);        //ä¸‹é¢ä¸¤ç§åŠæ³•éƒ½å¯ä»¥æ‹¼å­—ç¬¦ä¸²        return &quot;value1:&quot; + value1 + &quot; value2:&quot; + value2 + &quot; value3:&quot; + value3 + &quot; message:&quot; + message;        //return &quot;value1:&quot; + String.valueOf(value1) + &quot; value2:&quot; + String.valueOf(value2) + &quot; value3:&quot; + String.valueOf(value3) + &quot; message:&quot; + message;    &#125;&#125;\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182#include &quot;androidtest.h&quot;//javaç±»å¯¹åº”çš„åŒ…å+ç±»å#define className &quot;org/qt/QtAndroidTest&quot;void AndroidTest::test()&#123;    jint a = 12;    jint b = 4;    //å¯ä»¥ç›´æ¥è°ƒç”¨javaå†…ç½®ç±»ä¸­çš„æ–¹æ³•    jint max = QAndroidJniObject::callStaticMethod&lt;jint&gt;(&quot;java/lang/Math&quot;, &quot;max&quot;, &quot;(II)I&quot;, a, b);    //jclass javaMathClass = &quot;java/lang/Math&quot;;    jdouble value = QAndroidJniObject::callStaticMethod&lt;jdouble&gt;(&quot;java/lang/Math&quot;, &quot;random&quot;);    qDebug() &lt;&lt; &quot;111&quot; &lt;&lt; max &lt;&lt; value;&#125;void AndroidTest::printText()&#123;    QAndroidJniEnvironment env;    jclass clazz = env.findClass(className);    QAndroidJniObject obj(clazz);    obj.callMethod&lt;void&gt;(&quot;printText&quot;);&#125;void AndroidTest::printMsg()&#123;#if 0    //æŸ¥çœ‹æºç å¾—çŸ¥ä¸ä¼ å…¥jclassç±»çš„å‡½æ•°ä¸­å†…éƒ¨ä¼šè‡ªåŠ¨æ ¹æ®ç±»åæŸ¥æ‰¾jclass    QAndroidJniEnvironment env;    jclass clazz = env.findClass(className);    QAndroidJniObject::callStaticMethod&lt;void&gt;(clazz, &quot;printMsg&quot;);#else    //æ²¡æœ‰å‚æ•°å’Œè¿”å›å€¼å¯ä»¥å¿½ç•¥ç¬¬ä¸‰ä¸ªå‚æ•°    QAndroidJniObject::callStaticMethod&lt;void&gt;(className, &quot;printMsg&quot;);    //QAndroidJniObject::callStaticMethod&lt;void&gt;(classNameTest, &quot;printMsg&quot;, &quot;()V&quot;);#endif&#125;void AndroidTest::printValue(int value)&#123;    QAndroidJniObject::callStaticMethod&lt;jint&gt;(className, &quot;printValue&quot;, &quot;(I)I&quot;, (jint)value);&#125;void AndroidTest::setValue(float value1, double value2, char value3)&#123;    QAndroidJniObject::callStaticMethod&lt;void&gt;(className, &quot;setValue&quot;, &quot;(FDC)V&quot;, (jfloat)value1, (jdouble)value2, (jchar)value3);&#125;int AndroidTest::getValue(int value)&#123;    //javaç±»ä¸­æœ‰ä¸¤ä¸ª getValue å‡½æ•° ä¸€ä¸ªéœ€è¦ä¼ å‚æ•°    //jint result = QAndroidJniObject::callStaticMethod&lt;jint&gt;(className, &quot;getValue&quot;);    jint result = QAndroidJniObject::callStaticMethod&lt;jint&gt;(className, &quot;getValue&quot;, &quot;(I)I&quot;, (jint)value);    return result;&#125;void AndroidTest::setMsg(const QString &amp;msg)&#123;    QAndroidJniObject jmsg = QAndroidJniObject::fromString(msg);    QAndroidJniObject::callStaticMethod&lt;void&gt;(className, &quot;setMsg&quot;, &quot;(Ljava/lang/String;)V&quot;, jmsg.object&lt;jstring&gt;());&#125;QString AndroidTest::getMsg()&#123;    QAndroidJniObject result = QAndroidJniObject::callStaticObjectMethod(className, &quot;getMsg&quot;, &quot;()Ljava/lang/String;&quot;);    return result.toString();&#125;void AndroidTest::setText(int value1, float value2, bool value3, const QString &amp;msg)&#123;    QAndroidJniObject jmsg = QAndroidJniObject::fromString(msg);    QAndroidJniObject::callStaticMethod&lt;void&gt;(className, &quot;setText&quot;, &quot;(IFZLjava/lang/String;)V&quot;, (jint)value1, (jfloat)value2, (jboolean)value3, jmsg.object&lt;jstring&gt;());&#125;QString AndroidTest::getText(int value1, float value2, bool value3, const QString &amp;msg)&#123;    QAndroidJniObject jmsg = QAndroidJniObject::fromString(msg);    QAndroidJniObject result = QAndroidJniObject::callStaticObjectMethod(className, &quot;getText&quot;, &quot;(IFZLjava/lang/String;)Ljava/lang/String;&quot;, (jint)value1, (jfloat)value2, (jboolean)value3, jmsg.object&lt;jstring&gt;());    return result.toString();&#125;\n\n\nåœ¨åŸç”ŸAndroidå¼€å‘ä¸­ï¼Œä¸åŒé¡µé¢ä¼šå®šä¹‰ä¸åŒçš„Activityã€‚ä½†ä½¿ç”¨Qt Quickã€Flutterç­‰é‡‡ç”¨Direct UIæ–¹å¼å®ç°çš„ç¬¬ä¸‰æ–¹å¼€å‘æ¡†æ¶åˆ™åªå®šä¹‰äº†ä¸€ä¸ªActivityã€‚é‡Œé¢ä¸åŒé¡µé¢å®é™…éƒ½æ˜¯ä½¿ç”¨OpenGLç­‰ç›´æ¥ç»˜åˆ¶çš„ã€‚https://blog.csdn.net/LCSENs/article/details/100182235\n\n03ï¼š11-15\nå®‰å“ä¸­ä¸€ä¸ªç•Œé¢çª—ä½“å¯¹åº”ä¸€ä¸ªActivityï¼Œå¤šä¸ªç•Œé¢å°±æœ‰å¤šä¸ªActivityï¼Œè€Œåœ¨Qtå®‰å“ç¨‹åºä¸­ï¼ŒQtè¿™è¾¹åªæœ‰ä¸€ä¸ªActivityé‚£å°±æ˜¯QtActivityï¼ˆåŒ…åå…¨è·¯å¾„ org.qtproject.qt5.android.bindings.QtActivityï¼‰ï¼Œè¿™ä¸ªQtActivityæ˜¯å›ºå®šçš„å†™å¥½çš„ï¼Œæ•´ä¸ªQtç¨‹åºéƒ½æ˜¯åœ¨è¿™ä¸ªQtActivityç•Œé¢ä¸­ã€‚ä½ æ‰“å¼€AndroidManifest.xmlæ–‡ä»¶å¯ä»¥çœ‹åˆ°å¯¹åº”èŠ‚ç‚¹æœ‰ä¸ªname&#x3D;org.qtproject.qt5.android.bindings.QtActivityï¼Œæ‰€ä»¥å¦‚æœè¦è®©Qtç¨‹åºèƒ½å¤Ÿæ›´æ–¹ä¾¿é€šç•…çš„ä¸å¯¹åº”çš„javaç±»è¿›è¡Œäº¤äº’ï¼ˆéœ€è¦ä¸Šä¸‹æ–‡ä¼ é€’Activityçš„ï¼Œæ¯”å¦‚éœ‡åŠ¨ï¼Œæ¶ˆæ¯æç¤ºç­‰ï¼‰ï¼Œå»ºè®®æ–°å»ºä¸€ä¸ªjavaç±»ï¼Œç»§æ‰¿è‡ªQtActivityå³å¯ï¼Œè¿™æ ·ç›¸å½“äºé»˜è®¤Qtå¯åŠ¨çš„å°±æ˜¯ä½ javaç±»ä¸­å®šä¹‰çš„Activityï¼Œå¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å’Œäº¤äº’ã€‚\n\nç”±äºAndroidManifest.xmlæ–‡ä»¶æ¯ä¸ªç¨‹åºéƒ½å¯èƒ½ä¸ä¸€æ ·ï¼Œä¸ºäº†åšæˆé€šç”¨çš„ç»„ä»¶ï¼Œè¿™å°±è¦æ±‚å¯èƒ½ä¸èƒ½å¸¦ä¸ŠAndroidManifest.xmlæ–‡ä»¶ï¼Œè¿™æ ·çš„è¯æ¯ä¸ªQtå®‰å“ç¨‹åºéƒ½å¯åŠ¨é»˜è®¤å†…ç½®çš„Activityï¼Œå¦‚æœä¾èµ–Activityä¸Šä¸‹æ–‡çš„æ‰§è¡Œå‡½æ•°éœ€è¦ä¼ å…¥Qtçš„Activityæ‰è¡Œï¼Œè¿™é‡Œåˆ‡è®°Qtçš„ActivityåŒ…åæ˜¯ Lorg&#x2F;qtproject&#x2F;qt5&#x2F;android&#x2F;bindings&#x2F;QtActivity; ä¹‹å‰é¡ºæ‰‹æƒ³å½“ç„¶çš„å†™çš„ Landroid&#x2F;app&#x2F;Activity; å‘ç°æ­»æ´»ä¸è¡Œï¼ŒåŸæ¥æ˜¯åŒ…åé”™äº†ã€‚\n\nä¸€ä¸ªQtå®‰å“ç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªJavaç±»ï¼ŒåŒ…æ‹¬ç»§æ‰¿è‡ªActivityçš„ç±»ï¼ˆè¿™æ ·çš„Activityå¯ä»¥é€šè¿‡QtAndroid::startActivityå‡½æ•°æ¥è°ƒç”¨ï¼‰ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªé€šè¿‡AndroidManifest.xmlæ–‡ä»¶æŒ‡å®šçš„Activityï¼Œä¸æŒ‡å®šä¼šé»˜è®¤ä¸€ä¸ªã€‚å¦‚æœjavaç±»ä¸­ä¸éœ€è¦æ‹¿åˆ°Qtçš„Activityè¿›è¡Œå¤„ç†çš„ï¼Œå¯ä»¥ä¸éœ€è¦ç»§æ‰¿ä»»ä½•Activityï¼Œæ¯”å¦‚å…¨éƒ¨æ˜¯è¿ç®—çš„é™æ€å‡½æ•°ã€‚\n\nåœ¨javaç±»ä¸­å¦‚æœä¸Šé¢æ²¡æœ‰ä¸»åŠ¨å¼•å…¥åŒ…åï¼Œåˆ™ä¸‹é¢éœ€è¦å†™å…¨è·¯å¾„ï¼Œå¼•å…¥äº†åˆ™ä¸éœ€è¦å…¨è·¯å¾„å¯ä»¥ç›´æ¥ç”¨ï¼ˆåŒ…æ‹¬æšä¸¾å€¼éƒ½å¯ä»¥ç›´æ¥å†™ï¼Œæ¯”å¦‚ VIBRATOR_SERVICE è¿™ç§æšä¸¾å€¼å¼•å…¥äº†åŒ…ååä¸éœ€è¦å†™android.content.Context.VIBRATOR_SERVICEï¼‰ï¼Œå»ºè®®å¼•å…¥åŒ…åï¼Œæ¯”å¦‚ä¸Šé¢å†™äº† import org.qtproject.qt5.android.bindings.QtActivity; åˆ™ä¸‹é¢ç»§æ‰¿ç±»å¯ä»¥ç›´æ¥å†™ public class QtAndroidActivity extends QtActivityï¼Œå¦‚æœæ²¡æœ‰å¼•å…¥åˆ™éœ€è¦å†™æˆ public class QtAndroidActivity extends org.qtproject.qt5.android.bindings.QtActivity ã€‚\n\nå»ºè®®æ­é… android studio å·¥å…·å¼€å‘ï¼Œå› ä¸ºåœ¨ android studio ä¸­å†™ä»£ç éƒ½æœ‰è‡ªåŠ¨è¯­æ³•æç¤ºï¼ŒåŒ…åä¼šæç¤ºè‡ªåŠ¨å¼•å…¥ï¼Œå¯ä»¥æŸ¥çœ‹æœ‰é‚£äº›å‡½æ•°æ–¹æ³•ç­‰ï¼Œè¿˜å¯ä»¥æ ¡éªŒä»£ç æ˜¯å¦æ­£ç¡®ï¼Œè€Œå¦‚æœåœ¨QtCreatorä¸­æ‰‹å†™æœ‰æ—¶å€™å¯èƒ½ä¼šå†™é”™ï¼Œå°¤å…¶æ˜¯æŸä¸ªå­—æ¯å†™é”™ï¼Œå½“ç„¶è¿™ç§é”™è¯¯æ˜¯ç¼–è¯‘é€šä¸è¿‡çš„ï¼Œä¼šæç¤ºé”™è¯¯åœ¨å“ªè¡Œã€‚\n\n\n04ï¼š16-20\nç”¨Qtåšå®‰å“å¼€å‘æœ€å¤§éš¾ç‚¹ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯ä¼ å‚æ•°è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦ï¼ˆLjava&#x2F;lang&#x2F;String;ï¼‰å•¥æ„æ€ï¼Œå¦‚ä½•å¯¹åº”ï¼Œè¿™ä¹Ÿä¸æ˜¯Qtæ•…æ„ä¸ºéš¾åˆå­¦è€…å•¥çš„ï¼Œå› ä¸ºè¿™å¥—å®šä¹‰æœºåˆ¶æ˜¯å®‰å“ç³»ç»Ÿåº•å±‚è¦æ±‚çš„ï¼Œç³»ç»Ÿå±‚é¢å®šä¹‰çš„ä¸€å¥—è§„èŒƒï¼Œå…¶å®è¿™ä¸ªåœ¨å¸®åŠ©æ–‡æ¡£ä¸­å†™çš„å¾ˆæ¸…æ¥šï¼Œéƒ½æœ‰æ•°æ®ç±»å‹å¯¹ç…§è¡¨ï¼Œç”¨ç†Ÿæ‚‰äº†å‡ æ¬¡å°±å¾ˆç®€å•äº†ã€‚ç¬¬äºŒä¸ªéš¾ç‚¹å°±æ˜¯ç”¨javaå†™å¯¹åº”çš„ç±»ï¼Œå¦‚æœæ˜¯ä¼šå®‰å“å¼€å‘çš„äººæ¥è¯´é‚£ä¸è¦å¤ªç®€å•ï¼Œå°¤å…¶æ˜¯æœç´¢é‚£ä¹ˆæ–¹ä¾¿ä¸€å¤§å †ï¼Œæ²¡æœ‰æè¿‡å®‰å“å¼€å‘çš„äººæ¥è¯´å°±éœ€è¦å­¦ä¹ ä¸‹ï¼Œè¿™ä¸ªæ²¡æœ‰æ·å¾„ï¼Œåªæ˜¯å¸Œæœ›Qtèƒ½å¤Ÿå°½å¯èƒ½æœ€å¤§åŒ–çš„å°è£…ä¸€äº›å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ç±»ï¼Œæ¯”å¦‚åæœŸç‰ˆæœ¬å°±æä¾›äº†æƒé™ç”³è¯·çš„ç±» QtAndroid::requestPermissionsSync ä¹‹ç±»çš„ï¼Œç”¨èµ·æ¥å°±éå¸¸çš„çˆ½ï¼Œä¸ç”¨è‡ªå·±å†™ä¸ªjavaç±»è°ƒæ¥è°ƒå»çš„ã€‚\n\nç†è®ºä¸Šæ¥è¯´æŒ‰ç…§Qtæä¾›çš„ä¸‡èƒ½å¤§æ³•ç±»QAndroidJniObjectï¼Œå¯ä»¥ä¸ç”¨å†™javaç±»ä¹Ÿèƒ½æ‰§è¡Œå„ç§å¤„ç†ï¼Œæ‹¿åˆ°å®‰å“åº“ä¸­çš„å±æ€§å’Œæ‰§è¡Œæ–¹æ³•ï¼Œå°±æ˜¯å†™èµ·æ¥å¤ªç»•å¤ªè´¹åŠ²ï¼Œåœ¨javaç±»ä¸­ä¸€è¡Œä»£ç ï¼Œè¿™é‡Œèµ·ç ä¸‰è¡Œï¼Œæ‰€ä»¥ç»ˆæå¤§æ³•å°±æ˜¯ç†Ÿæ‚‰å®‰å“å¼€å‘ï¼Œç›´æ¥å°è£…å¥½javaç±»è¿›è¡Œè°ƒç”¨ã€‚\n\næµ‹è¯•å‘ç°GetStringUTFCharsæ–¹æ³•å¯¹åº”çš„æ•°æ®å­—ç¬¦ä¸²ä¸­ä¸èƒ½å¸¦æœ‰tempå­—æ ·ï¼Œå¦åˆ™è§£ææœ‰é—®é¢˜ï¼Œä¸çŸ¥ä»€ä¹ˆåŸå› ã€‚\n\næ•°æ®ç±»å‹å‚æ•°å’Œè¿”å›å€¼ç±»å‹å¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œå¦åˆ™æ‰§è¡Œä¼šæç¤ºæ‰¾ä¸åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œæœ‰è¿”å›å€¼ä¸€å®šè¦å†™ä¸Šè¿”å›å€¼ã€‚\n\njaræ–‡ä»¶å¯¹åŒ…åçš„å‘½åæ²¡æœ‰è¦æ±‚ï¼Œåªè¦æ”¾åœ¨android&#x2F;libsç›®å½•ä¸‹å³å¯ï¼Œå®‰å“åº•å±‚æ˜¯é€šè¿‡åŒ…åå»æŸ¥æ‰¾ï¼Œè€Œä¸æ˜¯é€šè¿‡æ–‡ä»¶åï¼Œä½ ç”šè‡³å¯ä»¥å°†åŸæ¥çš„åŒ…åé‡æ–°æ”¹æˆä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚classes.jaræ”¹æˆtest.jarä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ã€‚\n\n\n05ï¼š21-25\nå…³äºæƒé™è®¾ç½®ï¼Œåœ¨æ—©æœŸçš„å®‰å“ç‰ˆæœ¬ï¼Œæ‰€æœ‰æƒé™éƒ½å†™åœ¨å…¨å±€é…ç½®æ–‡ä»¶AndroidManifest.xmlä¸­ï¼Œè¿™ç§å«å®‰è£…æ—¶æƒé™ï¼Œå°±æ˜¯å®‰è£…çš„æ—¶å€™å‘Šè¯‰å®‰å“ç³»ç»Ÿå½“å‰appéœ€è¦å“ªäº›æƒé™ã€‚å¤§æ¦‚ä»å®‰å“6å¼€å§‹ï¼Œéƒ¨åˆ†æƒé™éœ€è¦åŠ¨æ€ç”³è¯·ï¼Œè¿™ç§å«åŠ¨æ€æƒé™ï¼Œè¿™ç§ç”³è¯·åˆ°çš„æƒé™ä¹Ÿå¯ä»¥åŠ¨æ€æ’¤é”€ï¼Œå°±æ˜¯è¦æ±‚ç¨‹åºå†æ¬¡æ‰§è¡Œä»£ç å»å‘ç³»ç»Ÿç”³è¯·æƒé™ï¼Œæ¯”å¦‚æ‹ç…§ã€å­˜å‚¨è¯»å†™ç­‰ã€‚ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„æƒé™éƒ½æ”¹æˆäº†åŠ¨æ€ç”³è¯·ï¼Œæ„å‘³ç€å…¼å®¹å®‰å“6ä»¥ä¸Šçš„ç³»ç»Ÿä½ æ—¢è¦åœ¨AndroidManifest.xmlä¸­å†™ä¸Šè¦æ±‚çš„æƒé™ï¼Œä¹Ÿè¦é€šè¿‡checkPermissionç”³è¯·ä½ éœ€è¦çš„æƒé™ã€‚\n\nandroid studio æ–°å»ºå¹¶ç”Ÿäº§jaråŒ…æ­¥éª¤ã€‚\n\n\n\nç¬¬ä¸€æ­¥ï¼šæ–‡ä»¶ï¼ˆFileï¼‰-ã€‹æ–°å»ºï¼ˆnewï¼‰-ã€‹é¡¹ç›®ï¼ˆnew projectï¼‰-ã€‹ç©ºç™½çª—ä½“ï¼ˆempty activityï¼‰ã€‚\nç¬¬äºŒæ­¥ï¼šåˆšæ‰æ–°å»ºå¥½çš„é¡¹ç›®é¼ æ ‡å³é”®æ–°å»ºï¼ˆnewï¼‰-ã€‹æ¨¡å—ï¼ˆnew moduleï¼‰-ã€‹å®‰å“åº“ï¼ˆandroid libraryï¼‰ã€‚\nè¯´æ˜ï¼šå¦‚æœé€‰æ‹©çš„ä¸æ˜¯å®‰å“åº“ï¼ˆandroid libraryï¼‰è€Œæ˜¯javaåº“ï¼ˆJava Libraryï¼‰ï¼Œåˆ™ç›´æ¥ç¼–è¯‘å‡ºæ¥çš„å°±æ˜¯jaræ–‡ä»¶ï¼Œé»˜è®¤åŒ…å com.example.lib.MyClassã€‚æ¨èé€‰æ‹©javaåº“ï¼Œç¼–è¯‘åä¸ç”¨å»ä¸€å †æ–‡ä»¶ä¸­æ‰¾jaræ–‡ä»¶ã€‚\nç¬¬ä¸‰æ­¥ï¼šå†™å¥½åº“åå­—ï¼Œæ ¹æ®é¡¹ç›®éœ€è¦é€‰æ‹©å¥½æœ€ä½sdkç‰ˆæœ¬-ã€‹å®Œæˆã€‚\nç¬¬å››æ­¥ï¼šåœ¨åˆšæ‰æ–°å»ºå¥½çš„åº“é¡¹ç›®mylibraryï¼Œä¾æ¬¡æ‰¾åˆ°å­èŠ‚ç‚¹src&#x2F;main&#x2F;java&#x2F;com.example.mylibraryä¸Šé¼ æ ‡å³é”®æ–°å»º-ã€‹classç±»ã€‚åˆ‡è®°æ˜¯è¿™ä¸ªèŠ‚ç‚¹ä¸æ˜¯javaèŠ‚ç‚¹æˆ–è€…å…¶ä»–èŠ‚ç‚¹ã€‚\nç¬¬äº”æ­¥ï¼šå†™å¥½ä½ çš„ç±»æ–¹æ³•å‡½æ•°ç­‰ã€‚123456package com.example.mylibrary;public class Test &#123;    public static int add(int a, int b) &#123;        return a + b;    &#125;&#125;\nç¬¬å…­æ­¥ï¼šé€‰ä¸­åº“é¡¹ç›®mylibraryï¼Œèœå•æ‰§è¡Œç¼–è¯‘ï¼ˆbuildï¼‰-ã€‹ç¼–è¯‘åº“ï¼ˆmake module xxxï¼‰ã€‚\nç¬¬ä¸ƒæ­¥ï¼šæ­¤æ—¶åœ¨mylibrary&#x2F;buildç›®å½•ä¸‹æœ‰outputsç›®å½•å’Œintermediatesç›®å½•ï¼Œå…¶ä¸­outputs&#x2F;aarç›®å½•ä¸‹æ˜¯ç”Ÿæˆçš„Androidåº“é¡¹ç›®çš„äºŒè¿›åˆ¶å½’æ¡£æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰èµ„æºï¼Œclassä»¥åŠresèµ„æºæ–‡ä»¶å…¨éƒ¨åŒ…å«ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ä»…ä»…éœ€è¦jaræ–‡ä»¶ï¼ŒåªåŒ…å«äº†classæ–‡ä»¶ä¸æ¸…å•æ–‡ä»¶ ï¼Œä¸åŒ…å«èµ„æºæ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ç­‰æ‰€æœ‰resä¸­çš„æ–‡ä»¶ã€‚éœ€è¦åˆ°intermediates&#x2F;aar_main_jar&#x2F;debugç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°classes.jarï¼Œå°†è¿™ä¸ªæ‹·è´å‡ºæ¥ä½¿ç”¨å³å¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¯¹åˆšæ‰çš„aaræ–‡ä»¶ç”¨è§£å‹ç¼©è½¯ä»¶è§£å‹å‡ºæ¥ä¹Ÿèƒ½çœ‹åˆ°classes.jarï¼Œæ˜¯åŒä¸€ä¸ªæ–‡ä»¶ã€‚\nå…¶ä»–ï¼šè°ƒç”¨jaråŒ…éå¸¸ç®€å•ï¼Œåªéœ€è¦å°†jaræ–‡ä»¶æ”¾åœ¨ä½ çš„é¡¹ç›®çš„libsç›®å½•ä¸‹å³å¯ï¼Œå¯¹åº”çš„åŒ…åå’Œå‡½æ•°ä¸€èˆ¬jaråŒ…æä¾›è€…ä¼šæä¾›ï¼Œæ²¡æœ‰æä¾›çš„è¯ï¼Œå¯ä»¥åœ¨android studioä¸­æ–°å»ºç©ºç™½é¡¹ç›®ï¼Œåˆ‡æ¢åˆ°projectè§†å›¾ï¼Œæ‰¾åˆ°libsç›®å½•ï¼Œé¼ æ ‡å³é”®æœ€ä¸‹é¢ä½œä¸ºåŒ…åŠ¨æ€åº“æ·»åŠ åˆ°é¡¹ç›®ï¼Œå¯¼å…¥åŒ…å®Œæˆä»¥åä¼šè‡ªåŠ¨åœ¨libsç›®å½•åˆ—å‡ºï¼ŒåŒå‡»åˆšåˆšå¯¼å…¥çš„åŒ…ç„¶åå°±è‡ªåŠ¨åˆ—å‡ºå¯¹åº”çš„ç±»å’Œå‡½æ•°ã€‚\n\n\nQtå®‰å“ä½¿ç”¨jaråŒ…æ­¥éª¤ã€‚\n\n\nç¬¬ä¸€æ­¥ï¼šå°†classes.jaræ”¾åˆ°android&#x2F;libsç›®å½•ä¸‹ï¼Œä¸ºå•¥æ˜¯è¿™ä¸ªç›®å½•ï¼Ÿå› ä¸ºè¿™æ˜¯å®‰å“çš„è§„åˆ™çº¦å®šï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯æ”¾åº“æ–‡ä»¶ï¼Œæ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè‡ªåŠ¨æ‰“åŒ…ç¼–è¯‘åˆ°apkæ–‡ä»¶ä¸­ã€‚\nç¬¬äºŒæ­¥ï¼šè°ƒç”¨jaræ–‡ä»¶ä¹‹å‰ï¼Œå‰ææ˜¯ä½ çŸ¥é“jaræ–‡ä»¶ä¸­çš„å‡½æ•°è¯¦ç»†ä¿¡æ¯ï¼Œè¿™ä¸ªä¸€èˆ¬jaræä¾›è€…ä¼šæä¾›å¥½æ‰‹å†Œï¼Œå¦‚æœä»£ç æ²¡æœ‰æ··è‚´çš„è¯ï¼Œä½ å¯ä»¥åœ¨android studioä¸­åŒå‡»æ‰“å¼€æŸ¥é˜…å…·ä½“çš„å‡½æ•°ã€‚\nç¬¬ä¸‰æ­¥ï¼šå¦‚æœjaræ–‡ä»¶ä¸­çš„å‡½æ•°ç®€å•ï¼Œç›´æ¥æ‹¿åˆ°ç»“æœä¸éœ€è¦ç»•æ¥ç»•å»ï¼Œå¯ä»¥ç›´æ¥å†™Qtç±»æ¥è°ƒç”¨ï¼›å¦‚æœè¿˜æ˜¯å¾ˆå¤æ‚ï¼Œå»ºè®®å†å»æ–°å»ºjavaç±»å¤„ç†å®Œå†äº¤ç»™Qtï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è®©jarçš„ä½œè€…å°½å¯èƒ½å°è£…å‡½æ•°çš„æ—¶å€™å°±åšå¥½ï¼Œå°½é‡æä¾›æœ€ç®€å•çš„æ¥å£è¿”å›éœ€è¦çš„æ•°æ®ã€‚æ¯”å¦‚è¿”å›å›¾ç‰‡æ•°æ®å¯ä»¥åšæˆjarå†…éƒ¨å­˜å‚¨å¥½å›¾ç‰‡ï¼Œç„¶åè¿”å›å›¾ç‰‡è·¯å¾„å³å¯ï¼Œä¸ç„¶æœ‰äº›æ•°æ®è½¬æ¢ä¹ŸæŒºçƒ¦ã€‚\nç¬¬å››æ­¥ï¼šç¼–å†™æœ€ç»ˆçš„è°ƒç”¨å‡½æ•°ã€‚12345678int AndroidJar::add(int a, int b)&#123;#ifdef Q_OS_ANDROID    const char *className = &quot;com/example/mylibrary/Test&quot;;    jint result = QAndroidJniObject::callStaticMethod&lt;jint&gt;(className, &quot;add&quot;, &quot;(II)I&quot;, (jint)a, (jint)b);    return result;#endif&#125;\n\n\nQt6ä¸­å¯¹å®‰å“æ”¯æŒéƒ¨åˆ†åšäº†å¤§çš„æ”¹åŠ¨ï¼Œç›®å‰è¿˜ä¸å®Œå–„ï¼Œå¦‚æœæ˜¯ä¸æ¶‰åŠåˆ°ä¸javaäº¤äº’çš„çº¯Qté¡¹ç›®ï¼Œå¯ä»¥æ­£å¸¸ç§»æ¤ï¼Œæ¶‰åŠåˆ°çš„æš‚æ—¶ä¸å»ºè®®ç§»æ¤åˆ°Qt6ï¼Œç­‰æ‰€æœ‰ç±»å®Œå–„äº†å†è¯´ã€‚\n\n\nç§»é™¤äº†å®‰å“æ’ä»¶androidextrasï¼Œå°†å…¶ä¸­éƒ¨åˆ†åŠŸèƒ½ç±»ç§»åˆ°coreæ¨¡å—ä¸­ï¼Œä¸éœ€è¦é¢å¤–å¼•å…¥ã€‚\nç±»åå‘ç”Ÿäº†å˜åŒ–ï¼Œæ¯”å¦‚QAndroidJniObjectæ”¹æˆäº†QJniObjectã€QAndroidJniEnvironmentæ”¹æˆäº†QJniEnvironmentï¼Œå¯èƒ½æ˜¯ä¸ºäº†ç»Ÿä¸€ç§»åŠ¨å¼€å‘å¹³å°ç±»ï¼Œå¼±åŒ–å®‰å“çš„å½±å“ã€‚\nå¯¹åº”çš„å®‰å“jdkè¦ç”¨jdk11è€Œä¸æ˜¯jdk1.8ï¼ŒQt5.15ä¸¤ä¸ªéƒ½æ”¯æŒï¼Œå»ºè®®å°±ç»Ÿä¸€ç”¨jdk11ã€‚\nå¯¹åº”å°è£…çš„javaç±»åŒ…åå»æ‰äº†qt5æ ‡è¯†ï¼Œorg.qtproject.qt5.android.bindings.QtActivityæ”¹æˆäº†org.qtproject.qt.android.bindings.QtActivityã€org.qtproject.qt5.android.bindings.QtApplicationæ”¹æˆäº†org.qtproject.qt.android.bindings.QtApplicationã€‚\nå¯¹å®‰å“æœ€ä½sdkæœ‰è¦æ±‚ï¼Œæ‰€ä»¥å»ºè®®åœ¨é…ç½®AndroidManifest.xmlæ–‡ä»¶çš„æ—¶å€™ä¸è¦å¸¦ä¸Šæœ€ä½ç‰ˆæœ¬è¦æ±‚ã€‚\nå¯¹AndroidManifest.xmlæ–‡ä»¶å†…å®¹æœ‰è¦æ±‚ï¼Œä¹‹å‰Qt5å®‰å“çš„ä¸èƒ½åœ¨Qt6å®‰å“ä¸‹ä½¿ç”¨ï¼Œå…·ä½“å†…å®¹å‚è§ç¤ºä¾‹ä¸‹çš„æ–‡ä»¶ã€‚\nå¯¹åº”ç¤ºä¾‹demoåœ¨ C:\\Qt\\Examples\\Qt-6.3.0\\corelib\\platform ç›®å½•ä¸‹ï¼Œä¹‹å‰æ˜¯ C:\\Qt\\Examples\\Qt-5.15.2\\androidextras ï¼Œç›®å‰å°±ä¸€ä¸ªç¤ºä¾‹ï¼Œå¯èƒ½å› ä¸ºå…¶ä»–ç±»è¿˜æ²¡æœ‰ç§»æ¤å¥½ã€‚\nQt6ä¸­å®‰å“æ¨¡å—ä»‹ç»åœ¨è¿™é‡Œ https://doc.qt.io/qt-6/qtandroidprivate.html\n\n\nå¦‚æœæƒ³è¦å®‰å“å…¨å±é®æŒ¡ä½é¡¶éƒ¨çŠ¶æ€æ ï¼Œå¯ä»¥åœ¨mainå‡½æ•°ä¸­å°†showæ”¹æˆshowFullScreenå³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨javaçš„æ–¹å¼åœ¨onCreateå‡½æ•°ä¸­åŠ ä¸€è¡Œ getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\n\n06ï¼š25-30\næ¨ªç«–å±åˆ‡æ¢çš„è¯†åˆ«ï¼Œåœ¨Qtä¸­ä¼šåŒæ—¶åæ˜ åˆ°resizeEventäº‹ä»¶ä¸­ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªæ˜¯å°ºå¯¸å˜åŒ–åè¯»å–ä¸‹å½“å‰å±å¹•æ˜¯æ¨ªå±è¿˜æ˜¯ç«–å±ï¼Œç„¶åç•Œé¢ä¸Šåšå‡ºè°ƒæ•´ï¼Œæ¯”å¦‚ä¸Šä¸‹æ’åˆ—æ”¹æˆå·¦å³æ’åˆ—ã€‚\n\nç”±äºä¸åŒQtç‰ˆæœ¬å¯¹åº”çš„å®‰å“é…ç½®æ–‡ä»¶ AndroidManifest.xml å†…å®¹æ ¼å¼ä¸ä¸€æ ·ï¼Œé«˜ç‰ˆæœ¬å’Œä½ç‰ˆæœ¬æ¨¡æ¿æ ¼å¼äº’ä¸å…¼å®¹ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨è‡ªå·±çš„Qtç‰ˆæœ¬åˆ›å»ºçš„ AndroidManifest.xml æ–‡ä»¶ï¼Œåˆ›å»ºå¥½ä»¥åå¦‚æœä½¿ç”¨çš„æ˜¯è‡ªå·±é‡æ–°å®šä¹‰çš„javaæ–‡ä»¶çš„å¯åŠ¨çª—ä½“åˆ™éœ€è¦å°† AndroidManifest.xml æ–‡ä»¶ä¸­çš„ android:name&#x3D;â€org.qtproject.qt5.android.bindings.QtActivityâ€ æ¢æ‰å°±è¡Œã€‚\n\nå¦‚æœè‡ªå·±ç”¨android studioç¼–è¯‘çš„jaræ–‡ä»¶æ”¾åˆ°Qté¡¹ç›®çš„libsç›®å½•ä¸‹ï¼Œå¯¼è‡´ç¼–è¯‘é€šä¸è¿‡ï¼Œæç¤º com.android.dx.cf.iface.ParseException: bad class file magic ä¹‹ç±»çš„ï¼Œé‚£æ˜¯å› ä¸ºjdkç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„ï¼Œä½ å¯èƒ½éœ€è¦åœ¨android studioé¡¹ç›®ä¸­æ‰¾åˆ°æ¨¡å—ç¼–jdkç‰ˆæœ¬è®¾ç½®çš„åœ°æ–¹é™ä½ç‰ˆæœ¬ï¼Œæ¯”å¦‚ä½ ç”¨çš„ndkæ˜¯r14ï¼Œåˆ™éœ€è¦é€‰æ‹©jdk1.6æˆ–è€…jdk1.7ã€‚ä¸€èˆ¬æ¥è¯´é«˜ç‰ˆæœ¬å…¼å®¹ä½ç‰ˆæœ¬ï¼Œå› ä¸ºndkç‰ˆæœ¬å¤ªä½æ— æ³•å…¼å®¹jdk1.8ã€‚åé¢å‘ç°å¦‚æœç›´æ¥æ–°å»ºçš„æ˜¯javaåº“ï¼ˆJava Libraryï¼‰åˆ™ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœé€‰æ‹©çš„æ˜¯å®‰å“åº“ï¼ˆandroid libraryï¼‰å°±å¯èƒ½æœ‰è¿™ä¸ªé—®é¢˜ã€‚\n\nå®‰å“é¡¹ç›®é…ç½®æ–‡ä»¶æ˜¯å›ºå®šçš„åå­— AndroidManifest.xml ï¼Œæ”¹æˆå…¶ä»–åå­—å°±ä¸è®¤è¯†ï¼Œä¸è¦æƒ³å½“ç„¶æ”¹æˆå…¶ä»–åå­—å¯¼è‡´æ— æ³•æ­£å¸¸è¯†åˆ«ã€‚\n\nAndroidManifest.xmlæ–‡ä»¶ä¸­çš„package&#x3D;â€org.qtproject.exampleâ€æ˜¯åŒ…åï¼Œä¹Ÿæ˜¯æ•´ä¸ªapkç¨‹åºçš„å†…éƒ¨å”¯ä¸€æ ‡è¯†ï¼Œå¦‚æœå¤šä¸ªapkè¿™ä¸ªåŒ…åä¸€æ ·ï¼Œåˆ™ä¼šè¦†ç›–ï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ä¸åŒçš„ç¨‹åºè®°å¾—æŠŠè¿™ä¸ªåŒ…åæ”¹æˆä½ è‡ªå·±çš„ã€‚è¿™ä¸ªåŒ…åä¹Ÿå†³å®šäº†javaæ–‡ä»¶ä¸­éœ€è¦ä½¿ç”¨èµ„æºæ–‡ä»¶æ—¶å€™çš„å¼•å…¥åŒ…å import org.qtproject.example.R; å¦‚æœåŒ…åä¸ä¸€æ ·åˆ™ç¼–è¯‘éƒ½é€šä¸è¿‡ã€‚\n\n\n4 Qtè®¾è®¡æ¨¡å¼è¯»ã€Šc++ Qtè®¾è®¡æ¨¡å¼ã€‹ä¹¦ç±æ•´ç†çš„ä¸€ç‚¹ç»éªŒã€‚æ­¤ä¹¦å’Œå®˜æ–¹çš„ã€ŠC++ GUI Qt4ç¼–ç¨‹ã€‹ä¸€èµ·çš„ã€‚\n\né€šå¸¸è€Œè¨€ï¼Œå¥½çš„åšæ³•æ˜¯åœ¨åŒ…å«äº†Qtå¤´æ–‡ä»¶ä¹‹åå†åŒ…å«éQtå¤´æ–‡ä»¶ï¼Œç”±äºQtï¼ˆä¸ºç¼–è¯‘å™¨å’Œé¢„å¤„ç†å™¨ï¼‰å®šä¹‰äº†è®¸å¤šç¬¦å·ï¼Œè¿™ä½¿å¾—é¿å…åç§°å†²çªå˜å¾—æ›´å®¹æ˜“ï¼Œä¹Ÿæ›´å®¹æ˜“æ‰¾åˆ°æ–‡ä»¶ã€‚\n12345678#include &quot;frminput2019.h&quot;#include &quot;ui_frminput2019.h&quot;#include &quot;qdatetime.h&quot;#include &quot;qdebug.h&quot;#include &quot;input2019.h&quot;#include &quot;inputnumber.h&quot;\n\nä¸€ç§å¥½çš„ç¼–ç¨‹å®è·µæ˜¯åœ¨ä»£ç ä¸­ä½¿ç”¨constå®ä½“è€Œä¸æ˜¯åµŒå…¥æ•°å­—å‹å¸¸é‡ï¼ˆæœ‰æ—¶ç§°ä»–ä»¬ä¸ºâ€œå¹»æ•°â€ï¼‰ã€‚å¦‚æœä»¥åéœ€è¦ä¿®æ”¹ä»–çš„å€¼æ—¶ï¼Œå°±å¯ä»¥è·å¾—è¿™ç§çµæ´»æ€§ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå°†å¸¸é‡â€œå­¤ç«‹â€å‡ºæ¥ï¼Œå¯æé«˜ç¨‹åºçš„å¯ç»´æŠ¤æ€§ã€‚\n12345678910//ä¸æ¨èå†™æ³•for (int i = 0; i &lt; 100; ++i) &#123;    ...&#125;//æ¨èä¸‹é¢çš„å†™æ³•const int count = 100;for (int i = 0; i &lt; count; ++i) &#123;    ...&#125;\n\nå†…å­˜ç®¡ç†ä½¿ç¨‹åºå‘˜è·å¾—äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œä½†æ˜¯ï¼Œâ€œæƒåŠ›è¶Šå¤§ï¼Œè´£ä»»è¶Šå¤§â€ã€‚\n\nåªè¦æœ‰å¯èƒ½ï¼Œå°±åº”å½“ä½¿ç”¨åˆ—è¡¨è€Œä¸æ˜¯æ•°ç»„ï¼Œæ¯”å¦‚åº”è¯¥ä½¿ç”¨ QList ä»£æ›¿ int [] ï¼Œåœ¨c++ä¸­æ•°ç»„è¢«çœ‹æˆæ˜¯â€œé‚ªæ¶çš„â€ã€‚\n\nåœ¨åˆ©ç”¨Qtç¼–å†™ç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºQtçš„çˆ¶å­æ‰€æœ‰æƒç»§æ‰¿å…³ç³»ï¼Œå¾ˆå°‘ä¼šç”¨åˆ°æ™ºèƒ½æŒ‡é’ˆï¼Œå› ä¸ºéœ€è¦è°ƒç”¨deleteçš„æƒ…å†µå¾ˆå°‘ã€‚ä»»ä½•æ—¶å€™åªè¦æˆ‘ä»¬éœ€è¦è°ƒç”¨deleteï¼Œæˆ–è€…æ˜¯éœ€è¦å°†æŸä¸ªæŒ‡é’ˆè®¾å®šä¸º0æ—¶ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆã€‚\n\nå®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½å®Œå…¨ç¡®å®šä½¿ç”¨å¤šçº¿ç¨‹å°±ä¸€å®šèƒ½å¤ŸçœŸæ­£æ”¹å–„ç¨‹åºçš„æ€§èƒ½ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå¢åŠ ä½¿ç”¨çº¿ç¨‹çš„æ•°é‡ï¼Œä½¿ä»–ä¸ç³»ç»Ÿå¯ç”¨çš„å†…æ ¸æ•°é‡æˆæ­£æ¯”ï¼Œè¿™æ ·åšæˆ–è®¸è¿˜ä¼šé™ä½ç¨‹åºçš„æ€§èƒ½ï¼Œå› ä¸ºæ‰€è·å¾—çš„æ”¶ç›Šä¼šå› çº¿ç¨‹ç«äº‰çš„å‰§å¢è€Œæ¶ˆå¤±æ®†å°½ã€‚æœ‰æ—¶å€™ï¼Œå•çº¿ç¨‹ä¸­æœ€æœ‰æ•ˆçš„ç®—æ³•åœ¨å¤šçº¿ç¨‹ä¸­å´ä¸ä¸€å®šæœ‰æ•ˆã€‚å› æ­¤ï¼Œå¦‚æœçœŸçš„æ˜¯æƒ³æ”¹è¿›ç¨‹åºçš„æ€§èƒ½ï¼Œç†æƒ³çš„åšæ³•æ˜¯ï¼Œä½¿ç”¨ä¸åŒçš„å®ç°æ–¹æ³•ï¼Œå¹¶ä¸ä»–ä»¬çš„æ€§èƒ½è¿›è¡Œæ¯”è¾ƒååŠ ä»¥åˆ†ç±»ï¼Œå½“ç„¶æµ‹è¯•å¯¹æ¯”çš„å‰ææ˜¯ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ä»¶å’Œè½¯ä»¶é…ç½®ç¯å¢ƒã€‚\n\nåœ¨æºä»£ç ä¸­å…³äºæ–‡ä»¶è·¯å¾„ï¼Œä½¿ç”¨ &#x2F; ä¼šæ›´æ–¹ä¾¿ä¸€äº›ï¼Œå› ä¸ºæ— è®ºæ˜¯åœ¨ä½•ç§å¹³å°ä¸Šï¼ŒQtéƒ½èƒ½ç†è§£ä»–ï¼Œä¸éœ€è¦å¯¹ä»–è¿›è¡Œè½¬æ¢ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æƒ³ä¸ºç”¨æˆ·æ˜¾ç¤ºè·¯å¾„æ—¶ï¼Œæœ€å¥½è¿˜æ˜¯æ ¹æ®åº”ç”¨ç¨‹åºæ‰€åœ¨å¹³å°çš„æ­£ç¡®å½¢å¼æ¥æ˜¾ç¤ºä»–ã€‚\n\nå½“æˆ‘ä»¬æœ‰å¾ˆå¤šé¡¹æ•°æ®éœ€è¦å¤„ç†æ—¶ï¼Œæ¯”å¦‚æˆåƒä¸Šä¸‡æˆ–è€…æ›´å¤šï¼Œé‚£ä¹ˆä¸ºæ¯ä¸ªå¤„ç†éƒ½åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¯¼è‡´å¤§é‡çš„å¼€é”€ï¼Œè¿™æ ·æ¥ä¾æ¬¡å¤„ç†æ•°æ®æˆ–è®¸æ›´å¿«äº›ã€‚ä¸€ç§è§£å†³åŠæ³•å°±æ˜¯åˆ›å»ºå°‘é‡çš„è¾…åŠ©çº¿ç¨‹ï¼Œå¹¶è®©æ¯ä¸ªçº¿ç¨‹åªå¤„ç†ä¸€ç»„æ•°æ®ã€‚\n\n\n\n5 Qtå¤§ä½¬ä¸“åŒº5.1 é…·ç å¤§ä½¬å¾®ä¿¡ï¼šKuma-NPC\n\nå…³äºQtäº‹ä»¶ä¼ é€’çš„ä¸€ä¸ªè¯´æ˜ï¼š\n\n\né€šå¸¸å†™win32ç¨‹åºï¼Œé¼ æ ‡æ¶ˆæ¯åº”è¯¥æ˜¯ç›´æ¥å‘ç»™æŒ‡å®šçª—å£å¥æŸ„çš„ï¼ŒæŒ‡å®šçª—å£æ²¡æœ‰å¤„ç†å°±ä¼šè½¬åŒ–æˆé€ä¼ æ¶ˆæ¯ï¼Œäº¤ç»™çˆ¶çª—å£å¤„ç†ã€‚ä½ åœ¨ä¸€ä¸ªæ™®é€šæ–‡å­—labelä¸Šç‚¹å‡»ï¼Œçˆ¶çª—å£ä¹Ÿèƒ½æ”¶åˆ°é¼ æ ‡äº‹ä»¶ã€‚\nQtåº”è¯¥æ˜¯æ‰€æœ‰æ¶ˆæ¯éƒ½å‘ç»™äº†é¡¶å±‚çª—å£ï¼Œæ‰€ä»¥äº‹ä»¶åˆ†å‘é€»è¾‘æ˜¯è‡ªå·±å¤„ç†ï¼Œä¸»çª—å£æ”¶åˆ°é¼ æ ‡äº‹ä»¶ç„¶åQtè‡ªå·±åˆ†å‘ç»™æŒ‡å®šå­æ§ä»¶ï¼ŒQEventä¼šæœ‰ignoreæˆ–è€…acceptè¡¨ç¤ºè‡ªå·±å¤„ç†äº†æ²¡æœ‰ï¼Œä¾‹å¦‚é¼ æ ‡ç‚¹å‡»äº‹ä»¶ï¼Œäº‹ä»¶åˆ†å‘å™¨å‘ç°æ²¡æœ‰è¢«å¤„ç†ï¼Œæ•°æ®é‡æ–°è®¡ç®—ç„¶ååˆ†å‘ç»™çˆ¶çª—å£ã€‚è¿™æ ·çˆ¶çª—å£æ”¶åˆ°çš„äº‹ä»¶åæ ‡å°±æ˜¯åŸºäºè‡ªå·±çª—å£å†…çš„ã€‚ç”¨eventFilterå°±éœ€è¦è‡ªå·±è®¡ç®—åæ ‡ã€‚\nå†æ¯”å¦‚ï¼Œå½“ä½¿ç”¨QDialogï¼Œæ”¾ä¸€ä¸ªQLineEditå¹¶è®¾ç½®ç„¦ç‚¹ï¼ŒæŒ‰Escæ—¶QDialogä¹Ÿä¼šè‡ªåŠ¨å…³é—­ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å› ä¸ºQLineEditå¹¶ä¸å¤„ç†Escçš„æŒ‰é”®äº‹ä»¶ï¼Œé€ä¼ ç»™äº†QDialogã€‚\n\n5.2 å°è±†å›\næ— è®ºä½ æ˜¯å­¦Qtï¼ŒJavaï¼ŒPythonæˆ–å…¶å®ƒï¼Œéƒ½éœ€è¦æ˜ç™½ä¸€ä¸ªé“ç†ï¼šæ‘’å¼ƒæ‰ä½ çš„å¥½å¥‡å¿ƒï¼Œåƒä¸‡ä¸è¦å»è¿½æ±‚ç¬¬ä¸‰æ–¹ç±»æˆ–å·¥å…·æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œè¿™å¾€å¾€ä¼šè®©ä½ æ”¶æ•ˆç”šå¾®ï¼Œå…¶å®ï¼Œä½ åªéœ€è¦ç†Ÿç»ƒæŒæ¡å®ƒçš„æ¥å£ï¼ŒçŸ¥é“ç±»çš„ç›®çš„å³å¯ï¼Œä¸å¯çŠ¯é¢å‘è¿‡ç¨‹çš„æ¯›ç—…ï¼Œåˆ¨æ ¹é—®åº•ã€‚è®°ä½ï¼Œä½ çš„ç›®æ ‡æ˜¯è®©å…¶å®ƒå·¥å…·ä¸ºä½ æœåŠ¡ï¼Œä½ è¦è¸©åœ¨å·¨äººçš„è‚©è†€ä¸Šåˆ›é€ ä¸–ç•Œã€‚\n\nQtçœŸæ­£çš„æ ¸å¿ƒï¼šå…ƒå¯¹è±¡ç³»ç»Ÿã€å±æ€§ç³»ç»Ÿã€å¯¹è±¡æ¨¡å‹ã€å¯¹è±¡æ ‘ã€ä¿¡å·æ§½ã€‚å¾€æ­»é‡Œå•ƒè¿™äº”å¤§ç‰¹æ€§ï¼Œåœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œé€æ¸çš„è®¾æ³•åŠ å…¥è¿™äº›ç‰¹æ€§ï¼Œå¤šå¤šç»ƒä¹ ä½¿ç”¨å®ƒä»¬ï¼Œé•¿æ­¤ä»¥å¾€ä½ ä¼šæ”¶è·æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚\n\nä¸€è¾¹è¯·æ•™åˆ«äººï¼Œä¸€è¾¹å¤šå¤šé‡æ„ï¼Œå…¶å®ç¼–ç è¿™æ¡è·¯è™½ç„¶æœ‰äººç»™ä½ æŒ‡è·¯ï¼Œä½†çœŸæ­£èµ°ä¸‹å»çš„æ˜¯ä½ è‡ªå·±ï¼Œå½“ä½ çœŸæ­£èµ°å®Œæ—¶ï¼Œä½ çš„ç¼–ç æ°´å¹³ä¸€å®šä¼šæœ‰éå¸¸å¤§çš„æå‡ã€‚ä¹Ÿè®¸åˆ«äºº1000è¡Œçš„ä»£ç ï¼Œåœ¨ä½ è¿™é‡Œå‡ åè¡Œå°±æå®šäº†ï¼Œè¿™ä¹Ÿæ­£äº‹Qtçš„é­…åŠ›ã€‚\n\nåœ¨é˜…è¯»Qtçš„å¸®åŠ©æ–‡æ¡£æ—¶ï¼Œè¦é™ä¸‹å¿ƒæ¥ï¼Œä¸è¦æ”¾è¿‡æ¯ä¸€å¥ï¼Œè®°ä½åœ¨æ–‡æ¡£ä¸­æ²¡æœ‰åºŸè¯ï¼Œå°¤å…¶æ˜¯æ¯æ®µçš„å¼€å¤´ã€‚\n\n\n6 å…¶ä»–ç»éªŒ\nQtç•Œçš„ä¸­æ–‡ä¹±ç é—®é¢˜ï¼Œç‰ˆæœ¬ä¼—å¤šå¯¼è‡´çš„å¦‚ä½•é€‰æ‹©å®‰è£…åŒ…é—®é¢˜ï¼Œå¦‚ä½•æ‰“åŒ…å‘å¸ƒç¨‹åºçš„é—®é¢˜ï¼Œå ªç§°Qtç•Œçš„ä¸‰åº§å¤§å±±ï¼\n\nåœ¨Qtçš„å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå­¦ä¼šæŸ¥çœ‹å¯¹åº”ç±»çš„å¤´æ–‡ä»¶æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¦‚æœåœ¨è¯¥ç±»çš„å¤´æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œå¯ä»¥å»ä»–çš„çˆ¶ç±»ä¸­æ‰¾æ‰¾ï¼Œå®åœ¨ä¸è¡Œè¿˜æœ‰çˆ·çˆ·ç±»ï¼Œè‚¯å®šèƒ½æ‰¾åˆ°çš„ã€‚é€šè¿‡å¤´æ–‡ä»¶ä½ ä¼šå‘ç°å¾ˆå¤šå‡½æ•°æ¥å£å…¶å®Qtå·²ç»å¸®æˆ‘ä»¬å°è£…å¥½äº†ï¼Œæœ‰ç©ºè¿˜å¯ä»¥é˜…è¯»ä¸‹ä»–çš„å®ç°ä»£ç ã€‚\n\nQtå®‰è£…ç›®å½•ä¸‹çš„Examplesç›®å½•ä¸‹çš„ä¾‹å­ï¼Œçœ‹å®Œå­¦å®Œï¼Œæœˆè–ª20Kèµ·æ­¥ï¼›Qtå¸¸ç”¨ç±»çš„å¤´æ–‡ä»¶çš„å‡½æ•°çœ‹å®Œå­¦å®Œä½¿ç”¨ä¸€éå¹¶åŠ ä»¥èä¼šè´¯é€šï¼Œæœˆè–ª30Kèµ·æ­¥ã€‚\n\nQtåœ¨å¼€å‘é˜¶æ®µä¸æ”¯æŒä¸­æ–‡ç›®å½•ï¼ˆè¿è¡Œé˜¶æ®µå¯ä»¥ï¼Œæ¯”å¦‚æ‰“åŒ…å‘å¸ƒçš„ç¨‹åºæ”¾åˆ°ä¸­æ–‡ç›®å½•è¿è¡Œæ˜¯okçš„ï¼‰ï¼Œåˆ‡è®°ï¼Œè¿™æ˜¯æ— æ•°äººå¯èƒ½çŠ¯çš„é”™è¯¯ï¼Œåœ¨å®‰è£…Qté›†æˆå¼€å‘ç¯å¢ƒä»¥åŠç¼–è¯‘å™¨çš„æ—¶å€™ï¼ŒåŠ¡å¿…è®°å¾—ç›®å½•å¿…é¡»è‹±æ–‡ï¼ŒQté¡¹ç›®æºç ä¹Ÿå¿…é¡»æ˜¯è‹±æ–‡ç›®å½•ï¼Œå¦åˆ™å¾ˆå¯èƒ½ä¸æ­£å¸¸ï¼Œå»ºè®®å°½é‡ç”¨é»˜è®¤çš„å®‰è£…ä½ç½®ã€‚\n\nå¦‚æœå‡ºç°å´©æºƒå’Œæ®µé”™è¯¯ï¼Œ80%éƒ½æ˜¯å› ä¸ºè¦ä¹ˆè¶Šç•Œï¼Œè¦ä¹ˆæœªåˆå§‹åŒ–ï¼Œæ­»æ‰£è¿™ä¸¤ç‚¹ï¼Œ80%çš„é—®é¢˜è§£å†³äº†ã€‚\n\nQtä¸€å…±æœ‰å‡ ç™¾ä¸ªç‰ˆæœ¬ï¼Œå…³äºå¦‚ä½•é€‰æ‹©Qtç‰ˆæœ¬çš„é—®é¢˜ï¼Œæˆ‘ä¸€èˆ¬ä¿ç•™å››ä¸ªç‰ˆæœ¬ï¼Œä¸ºäº†å…¼å®¹Qt4ç”¨4.8.7ï¼Œæœ€åçš„æ”¯æŒXPçš„ç‰ˆæœ¬5.7.0ï¼Œæœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬æ¯”å¦‚5.15ï¼Œæœ€é«˜çš„æ–°ç‰ˆæœ¬æ¯”å¦‚5.15.2ã€‚å¼ºçƒˆä¸å»ºè®®ä½¿ç”¨4.7ä»¥å‰å’Œ5.0åˆ°5.3ä¹‹é—´çš„ç‰ˆæœ¬ï¼ˆQt6.0åˆ°Qt6.2ä¹‹é—´ã€ä¸å«6.2çš„ç‰ˆæœ¬ä¹Ÿä¸å»ºè®®ï¼Œå¾ˆå¤šæ¨¡å—è¿˜æ²¡æœ‰é›†æˆï¼‰ï¼Œå¤ªå¤šbugå’Œå‘ï¼Œç¨³å®šæ€§å’Œå…¼å®¹æ€§ç›¸æ¯”äºä¹‹åçš„ç‰ˆæœ¬ç›¸å½“å·®ï¼Œèƒ½æ¢å°±æ¢ï¼Œä¸èƒ½æ¢ç¡æœé¢†å¯¼ä¹Ÿè¦æ¢ã€‚å¦‚æœæ²¡æœ‰å†å²åŒ…è¢±å»ºè®®ç”¨5.15.2ï¼Œç›®å‰æ–°æ¨å‡ºçš„6.0ç‰ˆæœ¬ä¹Ÿå¼ºçƒˆä¸å»ºè®®ä½¿ç”¨ï¼Œå®˜æ–¹è¿˜åœ¨æ•´åˆå½“ä¸­ï¼Œå¥½å¤šç±»å’Œæ¨¡å—æš‚æ—¶æ²¡æœ‰æ•´åˆï¼Œéœ€è¦ç­‰åˆ°6.2.2ç‰ˆæœ¬å†ç”¨ã€‚è€ƒè™‘åˆ°qssæ€§èƒ½ä»¥åŠè‡ªå¸¦mysqlé©±åŠ¨çš„å› ç´ ï¼Œæœ€ç»ˆQt5é€‰ç”¨5.12.3ï¼ŒQt4é€‰ç”¨4.8.7ï¼ŒQt6é€‰ç”¨6.5.xã€‚\n\nQtå’Œmsvcç¼–è¯‘å™¨å¸¸è§æ­é…æ˜¯Qt5.7+VS2013ã€Qt5.9+VS2015ã€Qt5.12+VS2017ã€Qt5.15+VS2019ã€Qt6.2+VS2019ï¼ŒæŒ‰ç…§è¿™äº›æ­é…æ¥ï¼ŒåŸºæœ¬ä¸Šå¸¸ç”¨çš„æ¨¡å—éƒ½ä¼šæœ‰ï¼Œæ¯”å¦‚webengineæ¨¡å—ï¼Œå¦‚æœé€‰ç”¨çš„Qt5.12+msvc2015ï¼Œåˆ™å¾ˆå¯èƒ½å®˜æ–¹æ²¡æœ‰ç¼–è¯‘è¿™ä¸ªæ¨¡å—ï¼Œåªæ˜¯ç¼–è¯‘äº†Qt5.12+msvc2017çš„ï¼Œå¦‚æœä¸€å®šè¦ç”¨msvc2015ä¸æƒ³æ¢msvc2017åˆ™åªèƒ½é€‰æ‹©Qt5.9+msvc2015å¥—ä»¶ï¼Œæˆ–è€…è‡ªè¡Œæºç é‡æ–°ç¼–è¯‘ï¼ˆè¿™ä¸ªéš¾åº¦è¶…å¤§ï¼Œåˆå­¦è€…ç»•è¿‡ï¼‰ã€‚\n\nQté»˜è®¤æœ‰å¯¹åº”VSç‰ˆæœ¬ï¼Œåœ¨ä¸‹è½½å¯¹åº”VSæ’ä»¶çš„æ—¶å€™å¿ƒé‡Œè¦æœ‰ä¸ªæ•°ï¼Œå®˜æ–¹é»˜è®¤æä¾›çš„æ˜¯åŸé…çš„æ’ä»¶ï¼Œå¦‚æœæƒ³è¦Qt4.8+VS2015çš„æ’ä»¶ï¼Œéœ€è¦è‡ªè¡Œç¼–è¯‘ã€‚ä¸€èˆ¬æ¥è¯´æ˜¯Qt4.8åŸé…VS2010ï¼ŒQt5.6åŸé…VS2013ï¼ŒQt5.9åŸé…VS2015ï¼ŒQt5.12åŸé…VS2017ï¼ŒQt5.15åŸé…VS2019ï¼Œåˆ‡è®°ï¼šåŸé…æœ€å¥½ã€‚\n\nç”¨Qtåšå¼€å‘æœºå™¨å»ºè®®ç”¨win10ï¼Œå°¤å…¶æ˜¯2021å¹´ä»¥åæ–°å‘å¸ƒçš„Qtç‰ˆæœ¬ï¼Œæ¯”å¦‚Qt5.12.12ã€Qt5.15.2ã€Qt6.2.2ç­‰ï¼Œå› ä¸ºå¾ˆå¯èƒ½è‡ªå¸¦çš„QtCreatorç”¨çš„æœ€æ–°çš„ç‰ˆæœ¬ï¼ŒQt6å¼€å§‹ä¸å†æ”¯æŒwin7ï¼Œæˆ–è€…ç”±äºå…¶ä»–çš„åŸå› ï¼Œå¯¹win7çš„æ”¯æŒä¸å‹å¥½ï¼Œä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ç­‰ï¼Œæ‰€ä»¥åˆæ˜¯æ²¡å¾—é€‰å¿…é¡»ç”¨win10ã€‚å»ºè®®å„ä½æ‹¥æŠ±æ–°æ—¶ä»£çš„å˜åŒ–ï¼Œè¿™ä¸–ä¸Šå”¯ä¸€ä¸å˜çš„åªæœ‰å˜åŒ–ã€‚\n\næ–°ç‰ˆæœ¬Qtå®‰è£…åŒ…å®‰è£…çš„æ—¶å€™éœ€è¦å¡«å†™æ³¨å†Œä¿¡æ¯ï¼Œå¦‚æœä¸æƒ³å¡«å†™ï¼Œå…ˆç¦ç”¨ç½‘å¡ï¼Œåœ¨è¿è¡Œå®‰è£…åŒ…ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡è¿™ä¸€æ­¥è¿›è¡Œå®‰è£…ã€‚ä»Qt5.15å¼€å§‹ä¸å†æä¾›ç¦»çº¿å®‰è£…åŒ…ï¼Œæ„å‘³ç€å¿…é¡»ä½¿ç”¨åœ¨çº¿å®‰è£…å™¨å®‰è£…Qtçš„åç»­ç‰ˆæœ¬ï¼Œå¿…é¡»å¡«å†™ç”¨æˆ·ä¿¡æ¯ï¼Œæ²¡å¾—é€‰ã€‚\n\nç»ˆæç§˜ç±ï¼šå¦‚æœé‡åˆ°é—®é¢˜æœç´¢Qtæ–¹é¢æ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œè¯•ç€å°†å…³é”®å­—ç”¨JAVA C# androidæ‰“å¤´ï¼Œä½ ä¼šå‘ç°åˆ«æœ‰ä¸€ç•ªå¤©åœ°ï¼Œå…¶ä»–äººå…¶ä»–è¯­è¨€å…¶ä»–é¢†åŸŸå¾ˆå¯èƒ½åšè¿‡ï¼\n\nå¦‚æœQtèƒ½ä»ä¸‹é¢å‡ ä¸ªæ–¹é¢åŠªåŠ›ï¼Œç›¸ä¿¡ä¼šæ›´æœ‰å‘å±•å‰æ™¯ã€‚\n\n\n\nQWidgetæ”¯æŒCSS3ï¼Œå…·æœ‰è¯¸å¤šçš„ç‰›é€¼çš„æ•ˆæœï¼Œç›®å‰æ”¯æŒçš„æ˜¯CSS2ã€‚\nQWidgetæ”¯æŒGPUç»˜åˆ¶ï¼Œå¯é€‰åˆ‡æ¢CPUæˆ–è€…GPUï¼Œæå‡ç»˜åˆ¶æ•ˆç‡ï¼Œåˆ©ç”¨ç°åœ¨å¼ºå¤§çš„ç¡¬ä»¶ã€‚\nQmlæ— ç¼æ”¯æŒjsï¼Œå¯ä»¥åˆ©ç”¨ç°åœ¨å„ç§jsè½®å­ï¼ŒæŒ‡æ•°çº§æå‡qmlçš„é¡¹ç›®èŒƒå›´ã€‚\næ”¯æŒå°†ç¨‹åºè½¬æˆwebè¿è¡Œï¼Œæ¯”å¦‚è½¬æˆcgiä¹‹ç±»çš„ç¨‹åºï¼Œç›®å‰Qt for WebAssemblyå¾ˆé¸¡è‚‹ï¼ŒåŠŸèƒ½æå…¶æœ‰é™ï¼Œsql&#x2F;network&#x2F;æœ¬åœ°è®¿é—®ç­‰éƒ½ä¸æ”¯æŒï¼Œé¦–æ¬¡åŠ è½½é€Ÿåº¦è¶…æ…¢ï¼Œå¤§éƒ¨åˆ†Qtç±»è¿˜ä¸æ”¯æŒã€‚\n\n\nQtè‡ªä»4.7ä»¥åå¼•å…¥çš„QMLã€‚ä»æ­¤ä»¥åï¼ŒQtå¼€å‘å°±åˆ†æˆäº†ä¸¤ç§æµæ´¾ï¼Œä¸€è€…ä½¿ç”¨åŸæ¥çš„C++ è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œå¦å¤–ä¸€ç§ä½¿ç”¨QMLè¯­è¨€è¿›è¡Œå¼€å‘ã€‚è¿™ä¸‹æå¾—å˜ï¼Œç»å¸¸åµåµä¸äº¦ä¹ä¹ï¼Œåœ¨Qtç•Œä»æ­¤å°±æœ‰ä¸¤å¤§é˜µè¥äº§ç”Ÿæ¿€çƒˆçš„çº·äº‰ï¼Œé‚£å°±æ˜¯é€‰ç”¨qmlè¿˜æ˜¯widgetå¥½ï¼Œå¤§é‡åˆå­¦è€…ä¹Ÿä¼šé—®è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹æ€»ç»“ã€‚\n\n\nwidgetå±äºä¼ ç»Ÿç•Œé¢å¼€å‘ï¼Œå’ŒVB&#x2F;VC&#x2F;Delphiç­‰æ‹–æ›³æ§ä»¶å¼€å‘ç±»ä¼¼ï¼Œèµ°CPUç»˜åˆ¶ï¼Œèƒ½æœ€å¤§åŒ–çš„å…¼å®¹ç°æœ‰çš„ç¡¬ä»¶å’Œè¿‡å»çš„ç›¸å¯¹åä½æ€§èƒ½çš„ç¡¬ä»¶ã€‚\nqmlå±äºæ–°æ—¶ä»£çš„äº§ç‰©ï¼Œå¤§æ¦‚ä»2010å¹´å¼€å§‹ï¼Œå’Œflutter&#x2F;Electronç­‰webå¼€å‘æ¡†æ¶åŠç§»åŠ¨å¼€å‘æ¡†æ¶ç±»ä¼¼ï¼Œä¸ºäº†é€‚åº”å„ç§ç§»åŠ¨ç«¯å¼€å‘åŠåŠ¨ç”»æµç•…æ€§è§¦æ‘¸ä¸æ»‘ä½“éªŒã€å……åˆ†åˆ©ç”¨å’Œâ€œæ¦¨å¹²â€ç°åœ¨çš„GPUæ€§èƒ½ï¼ŒæŠŠCPUç•™å‡ºæ¥ç»™ç”¨æˆ·æœ€å¤§åŒ–å‘æŒ¥ã€‚\nç¡¬ä»¶æ€§èƒ½è¶Šå¥½ï¼ŒGPUè¶Šæ˜¯å¼ºåŠ²ï¼Œqmlçš„ç»¼åˆæ€§èƒ½è¶Šæ˜¯å®Œçˆ†widgetï¼Œåä¹‹å¯¹æ¯”ä¹Ÿæ˜¯æŒ‡æ•°çº§çš„ã€‚é™¤äº†æå…¶çœæˆæœ¬çš„åµŒå…¥å¼ç¡¬ä»¶é¢†åŸŸæˆ–è€…å›½äº§CPUç­‰ï¼Œå…¶ä»–é¢†åŸŸçš„ç¡¬ä»¶æ€§èƒ½éƒ½æ˜¯æš´å¢ã€‚\nwidgetä¸»è¦é›†ä¸­åœ¨é‡‘èã€å†›å·¥ã€å®‰é˜²ã€èˆªå¤©ã€èˆ¹èˆ¶ã€æ•™è‚²ç­‰é¢†åŸŸï¼Œqmlä¸»è¦é›†ä¸­åœ¨æ±½è½¦ä»ªè¡¨ã€è½¦æœºã€ç›´æ’­ç­‰é¢†åŸŸã€‚\nç›®å‰å›½å†…widgetå¤šäºqmlï¼Œå›½å¤–å¯èƒ½åå‘qmlï¼Œè¿™ä¸ªä¸éš¾çœ‹å‡ºï¼Œæµè¡Œçš„ç§»åŠ¨ç«¯å¼€å‘æ¡†æ¶éƒ½æ˜¯å›½å¤–å¼€å‘è€…å±…å¤šã€‚\nå¯é¢„è§çš„åå¹´å†…ï¼Œè¿™ä¸¤è€…å°†é•¿æœŸå¹¶å­˜ï¼Œå®˜æ–¹åŸºæœ¬ä¸å†æ›´æ–°widgetè€Œæ˜¯ä¸»æ¨qmlï¼Œæ„å‘³ç€å°†æ¥å¯¹qmlçš„æ€§èƒ½ä¼˜åŒ–åªå¢ä¸å‡ï¼Œæœªæ¥è¶‹åŠ¿æ˜¯qmlã€‚\næ²¡æœ‰ç¼–ç¨‹ç»éªŒçš„æ–°æ‰‹qmlå­¦ä¹ æˆæœ¬æ›´ä½ï¼Œè€Œä»VB&#x2F;VCç­‰ä¼ ç»Ÿè½¯ä»¶å¼€å‘è½¬è¿‡æ¥çš„ä»ä¸šè€…æ›´é€‚åˆå­¦ä¹ widgetã€‚\næœ‰çš„æ—¶å€™ä¸ç¦è¦é—®ï¼Œæ—¢ç”Ÿwidgetä½•ç”Ÿqmlï¼Œå­¦ä¹ æˆæœ¬å’Œé€‰æ‹©åˆå¤šäº†ï¼Œå…¶å®è¿™æ­£æ˜¯å’Œè¿™ä¸ªä¸–ç•Œçš„å“²å­¦ä¸€æ ·ï¼šä¸–ç•Œæ˜¯ç®€å•çš„åˆæ˜¯å¤æ‚çš„ã€‚ä¸ºäº†é€‚åº”å„ç§éœ€æ±‚å’Œæ»¡è¶³éœ€è¦ã€‚\næ€»ä¹‹ï¼Œæ— è®ºqmlè¿˜æ˜¯widgetï¼Œå’Œæ‰¾è€å©†ä¸€æ ·ï¼Œé€‚åˆè‡ªå·±çš„å°±æ˜¯æœ€å¥½çš„ï¼Œè‡ªå·±æ“…é•¿å“ªä¸ªå°±ç”¨å“ªä¸ªã€‚\nå¦‚æœè¿˜ä¸çŸ¥é“æ“…é•¿å“ªä¸ªï¼Œæœ‰ç©ºå°±ä¸¤ä¸ªéƒ½å­¦ï¼Œå­¦ä¹ è¿‡ç¨‹ä¸­è‡ªå·±å°±ä¼šæœ‰åˆ‡èº«æ„Ÿå—å’Œå¯¹æ¯”ï¼Œèƒ½è€…å¤šåŠ³å¤šå¤šç›Šå–„ã€‚èƒ½å¤Ÿé¡ºåˆ©çš„æœ€å¿«çš„å®Œæˆè€æ¿çš„ä»»åŠ¡ç»™è€æ¿èµšé’±æ‰æ˜¯ç‹é“ã€‚\nç½‘å‹è¡¥å……ï¼šå¦‚æœä½ çš„è½¯ä»¶æœ€ç»ˆæ˜¯æ‰‹æŒ‡æ“ä½œçš„å¤šï¼Œå°±ç”¨qmlï¼Œå¦‚æœæ˜¯é¼ æ ‡æ“ä½œçš„å¤šï¼Œå°±é€‰æ‹©widgetã€‚\n\n\nå†™ç¨‹åºè¿‡ç¨‹ä¸­å‘ç°é—®é¢˜ï¼Œæ¯”å¦‚æœ‰äº›é—®é¢˜æ˜¯æç«¯ç‰¹æ®Šæƒ…å†µä¸‹å‡ºç°ï¼Œæœ€å¥½æ‰¾åˆ°é—®é¢˜çš„æ ¹æºï¼Œæœ‰æ—¶å€™è‚¯å®šå¤šå¤šå°‘å°‘ä¼šæ€€ç–‘æ˜¯ä¸æ˜¯Qtæœ¬èº«çš„é—®é¢˜ï¼Œæ€€ç–‘æ˜¯å¯¹çš„ï¼Œä½†æ˜¯99.9%çš„é—®é¢˜æœ€ç»ˆè¯å®ä¸‹æ¥è¿˜æ˜¯è‡ªå·±çš„ä»£ç å†™çš„ä¸å¤Ÿå¥½å¯¼è‡´çš„ï¼Œå¦‚æœä¸ºäº†èµ¶æ—¶é—´è€æ¿å‚¬çš„æ€¥ï¼Œå®åœ¨ä¸è¡Œå†ç”¨é‡å¯æˆ–è€…å¤ä½å¤§æ³•ï¼Œæ¯”å¦‚æä¸ªå®šæ—¶å™¨ã€çº¿ç¨‹ã€ç½‘ç»œé€šä¿¡å•¥çš„å»æ£€æµ‹ç¨‹åºæ˜¯å¦æ­£å¸¸ï¼Œç¨‹åºä¸­æŸä¸ªæ¨¡å—æˆ–è€…åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œä¸æ­£å¸¸å°±å¤ä½ç¨‹åºæˆ–è€…é‡å¯ç¨‹åºï¼Œåœ¨åµŒå…¥å¼ä¸Šè¿˜å¯ä»¥æ›´æš´åŠ›ä¸€ç‚¹å°±æ˜¯ç³»ç»Ÿé‡å¯å’Œæ–­ç”µé‡å¯ã€‚\n\nå†™ç¨‹åºè¿‡ç¨‹ä¸­å°¤å…¶è¦æ³¨æ„32ä½çš„åº“å’Œ64ä½çš„åº“äº’ä¸å…¼å®¹ï¼Œæ¯”å¦‚32ä½çš„ç¨‹åºå¼•ç”¨64ä½çš„åº“ï¼Œ64ä½çš„ç¨‹åºå¼•ç”¨32ä½çš„åº“ï¼Œéƒ½æ˜¯ç¼–è¯‘é€šä¸è¿‡çš„ï¼Œè€Œåœ¨windows64ä½ç³»ç»Ÿä¸­æ˜¯èƒ½å¤Ÿè¿è¡Œ32ä½ç¨‹åºçš„ï¼Œå› ä¸º64ä½çš„ç³»ç»Ÿæä¾›äº†32ä½çš„è¿è¡Œç¯å¢ƒï¼Œä¸€èˆ¬ç›®å½•åœ¨Program Files(x86)ï¼Œ32ä½çš„ç¨‹åºåœ¨64ä½çš„ç¯å¢ƒä¸­æœ€ç»ˆå¼•ç”¨çš„è¿˜æ˜¯32ä½çš„åº“ã€‚å…³äºå¦‚ä½•åˆ¤æ–­è‡ªå·±çš„Qtåº“æ˜¯å¤šå°‘ä½ï¼Œæœ‰ä¸ªè¯¯åŒºå°±æ˜¯å¾ˆå¤šäººè¦ä¹ˆçœ‹æˆäº†QtCreatorçš„å…³äºä¿¡æ¯ä¸­åˆ—å‡ºçš„ä½æ•°ï¼Œè¦ä¹ˆä»¥ä¸ºè‡ªå·±æ˜¯64ä½çš„ç³»ç»Ÿå°±è®¤ä¸ºæ˜¯64ä½çš„Qtï¼Œæœ€ç»ˆè¦åœ¨Qtæ„å»ºå¥—ä»¶ä¸­æŸ¥çœ‹å…·ä½“ä½æ•°ï¼Œå¤§æ¦‚ä»Qt5.14å¼€å§‹åŸºæœ¬ä¸Šå¾ˆå°‘æä¾›32ä½çš„åº“ï¼Œå°¤å…¶æ˜¯Qt6.0ä»¥ååŸºæœ¬ä¸Šé»˜è®¤å°±æ˜¯åªæœ‰64ä½çš„åº“äº†ï¼Œè¿™ä¹Ÿæ˜¯é¡ºåº”æ—¶ä»£æ½®æµï¼Œæ¯•ç«Ÿä¸ä¹…çš„å°†æ¥ï¼ˆä¸ªäººé¢„è®¡2030å¹´ä»¥å‰ï¼‰åŸºæœ¬ä¸Š32ä½çš„ç³»ç»Ÿå æ¯”ä¸è¶…è¿‡1%ï¼Œæ”¾å¿ƒå¤§èƒ†çš„ç”¨64ä½çš„åº“å§ï¼ŒæŠ›å¼ƒçƒ¦äººçš„32ä½ä»¥åŠXPç³»ç»Ÿã€‚\n\nå…³äºç¨‹åºä¸­åŠ¨æ€å’Œé™æ€çš„ä¸€ç‚¹ä¸ªäººç†è§£ï¼š\n\n\n\nåœ¨Qtç¨‹åºä¸­ï¼Œåˆ†åŠ¨æ€åº“ç‰ˆæœ¬çš„Qtå’Œé™æ€åº“ç‰ˆæœ¬çš„Qtã€‚\nå®˜æ–¹é»˜è®¤æä¾›çš„äºŒè¿›åˆ¶åŒ…å°±æ˜¯åŠ¨æ€åº“ç‰ˆæœ¬çš„Qtï¼Œå¦‚æœè‡ªè¡Œç¼–è¯‘åˆ™ç¼–è¯‘çš„æ—¶å€™å¯¹åº”å‚æ•° -sharedã€‚\né™æ€åº“ç‰ˆæœ¬çš„Qtéœ€è¦è‡ªè¡Œç¼–è¯‘ï¼Œç¼–è¯‘çš„æ—¶å€™å¯¹åº”å‚æ•° -staticï¼Œï¼ˆç†è®ºä¸Šæ— è®ºå•†ä¸šéå•†ä¸šä½¿ç”¨Qté™æ€åº“éœ€è¦æ”¶è´¹ï¼Œå› ä¸ºé™æ€ç¼–è¯‘åéƒ½çœ‹ä¸åˆ°Qtçš„ç›¸å…³åº“æ–‡ä»¶ï¼‰ã€‚\nä½¿ç”¨åŠ¨æ€åº“çš„Qtæ”¯æŒç¼–è¯‘ç”ŸæˆåŠ¨æ€åº“å’Œé™æ€åº“ï¼ˆCONFIG +&#x3D; staticlibï¼‰çš„ç¨‹åºã€‚\nä½¿ç”¨åŠ¨æ€åº“çš„Qtç¨‹åºæ”¯æŒåŠ¨æ€åº“çš„å¼•ç”¨ï¼ˆå¼•ç”¨çš„æ—¶å€™ LIB +&#x3D; ï¼Œè¿è¡Œçš„æ—¶å€™éœ€è¦åŠ¨æ€åº“æ–‡ä»¶æ¯”å¦‚ .dll .so æ–‡ä»¶æ”¯æŒï¼‰ã€‚\nä½¿ç”¨åŠ¨æ€åº“çš„Qtç¨‹åºæ”¯æŒé™æ€åº“çš„å¼•ç”¨ï¼ˆå¼•ç”¨çš„æ—¶å€™ LIB +&#x3D; ï¼Œè¿è¡Œçš„æ—¶å€™æ— éœ€åº“æ–‡ä»¶æ”¯æŒï¼Œå¯ä»¥ç†è§£ä¸ºè¯¥æ–‡ä»¶å·²ç»å’Œå¯æ‰§è¡Œæ–‡ä»¶åˆäºŒä¸ºä¸€ï¼Œç¼ºç‚¹æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯å˜å¤§ï¼‰ã€‚\né€šè¿‡ç”Ÿæˆæ–‡ä»¶çš„ä¸ªæ•°å’Œå¤§å°å¯ä»¥å‘ç°ï¼Œé™æ€åº“ç›¸å½“äºæŠŠè¿è¡Œæ—¶éœ€è¦çš„æ–‡ä»¶ä¹Ÿä¸€å¹¶åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶äº†ï¼Œè€ŒåŠ¨æ€åº“æ˜¯æ‹†åˆ†æˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªç”¨äºç¼–è¯‘ï¼Œä¸€ä¸ªç”¨äºè¿è¡Œã€‚\nä¸Šè¿°åŠ¨æ€åº“çš„è§„åˆ™ä¹Ÿé€šç”¨äºé™æ€åº“ã€‚\næ­¤è§„åˆ™åº”è¯¥æ˜¯é€šç”¨äºå…¶ä»–è¯­è¨€æ¡†æ¶ã€‚\nå¾ˆå¤šäººæœ‰ä¸ªè¯¯åŒºåŒ…æ‹¬å‡ å¹´å‰çš„æˆ‘ï¼Œä»¥ä¸ºè¦ç”¨Qtç¼–å†™é™æ€åº“å°±å¿…é¡»ç”¨é™æ€çš„Qtåº“ï¼Œå…¶å®åŠ¨æ€åº“çš„Qtä¹Ÿå¯ä»¥ç¼–å†™é™æ€çš„åº“ï¼Œåªæ˜¯è¯¥åº“ä¸ä¼šç”ŸæˆåŠ¨æ€åº“æ–‡ä»¶ã€‚\nå¦‚æœè¦å°†Qtç¨‹åºç¼–è¯‘æˆé™æ€çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå•ä¸ªæ–‡ä»¶æ— ä¾èµ–ï¼‰ï¼Œå‰ææ˜¯æ‰€ç”¨çš„Qtåº“å¿…é¡»é™æ€çš„ã€‚\n\n\nåæœŸçš„Qtç‰ˆæœ¬ï¼Œå¤§è‡´ä»5.15å¼€å§‹ï¼Œå°±ä¸åœ¨æä¾›ç¦»çº¿ç‰ˆæœ¬ä¸‹è½½ï¼Œéœ€è¦è‡ªè¡Œé€šè¿‡åœ¨çº¿å®‰è£…å™¨å®‰è£…ï¼Œç”±äºé»˜è®¤æœåŠ¡å™¨åœ¨å›½å¤–ï¼Œå¾ˆå¤šäººåæ˜ ä¸‹è½½çš„æ—¶å€™å¾ˆæ…¢ï¼Œæˆ–è€…é€‰æ‹©æ™šä¸Šçš„æ—¶å€™ä¸‹è½½è¦å¿«å¾ˆå¤šï¼Œä¸ºäº†è§£å†³è¿™ä¸ªçƒ¦äººçš„é—®é¢˜ï¼Œä¸è‡³äºæ—¶é—´éƒ½æµªè´¹åœ¨æ²¡æœ‰æ„ä¹‰çš„ç­‰å¾…ä¸Šï¼Œæœ‰ä¸ªæå…¶ç®€å•çš„æ–¹æ³•å¯ä»¥å°†é€Ÿåº¦æå‡å‡ ä¸‡å€ï¼Œç”šè‡³å†²åä½ çš„ç¡¬ç›˜ã€‚å…ˆä¸‹è½½ Fiddler5ï¼ˆå°½é‡é€‰æ‹©ä¸­æ–‡ç‰ˆæœ¬ä¸ç„¶å°ç™½çœ‹ä¸æ‡‚ï¼‰ï¼ŒåŒå‡»æ‰“å¼€ç¨‹åºåï¼ˆå¯èƒ½win10è‡ªå¸¦çš„æ€æ¯’è½¯ä»¶ä¼šæŠ¥æ¯’åˆ é™¤ï¼Œä¸´æ—¶åœç”¨æ€æ¯’è½¯ä»¶æˆ–è€…æ¢å¤å¯ä¿¡ä»»æ–‡ä»¶å³å¯ï¼‰ï¼Œåœ¨åº•éƒ¨çš„è¾“å…¥æ ä¸­è¾“å…¥ urlreplace download.qt.io mirrors.ustc.edu.cn&#x2F;qtproject&#x2F; å›è½¦åº”ç”¨ï¼Œç„¶åå†å»æ‰“å¼€å®‰è£…å™¨åœ¨çº¿å®‰è£…ï¼Œä¸–ç•Œçªç„¶å˜å¾—éå¸¸ç¾å¥½ã€‚\n\nQtç»å¯¹æ˜¯ä¸ªéå¸¸ç‰›é€¼çš„é¡¹ç›®ï¼Œæºç éå¸¸åºå¤§ï¼Œè€Œä¸”åˆ†æ¨¡å—è®¾è®¡ï¼Œå¯¹äºæœ‰è¶³å¤Ÿç²¾åŠ›çš„å¯ä»¥èŠ±æ—¶é—´å­¦ä¹ æºç ä¸­çš„å…·ä½“å®ç°ï¼Œå¦‚æœæ—¶é—´ä¸å¤šï¼Œä¸ªäººæ¨èçœ‹ QObjectã€QWidgetã€QPainterã€QStringã€QColorã€QListã€QVariantã€QAbstractButtonã€QAbstractItemModelã€qnamespace.hï¼ˆæ•´ä¸ªQtä¸­æ‰€æœ‰çš„å…¨å±€çš„æšä¸¾å€¼ï¼‰ã€è¿™äº›ç±»çš„æºç å³å¯ï¼Œçœ‹çœ‹ä»–ä»¬æœ‰å“ªäº›æ–¹æ³•å’Œå±æ€§ï¼Œå¯¹è‡ªå·±çš„ç¼–ç¨‹ä¼šæœ‰è«å¤§çš„å¸®åŠ©ã€‚\n\næœ€åä¸€æ¡ï¼šççˆ±ç”Ÿå‘½ï¼Œè¿œç¦»ç¼–ç¨‹ã€‚ç¥å¤§å®¶å¤´å‘æµ“å¯†ï¼Œç¡çœ è‰¯å¥½ï¼Œæƒ…ç»ªç¨³å®šï¼Œè´¢å¯Œè‡ªç”±ï¼\n\n\n7 æ‚ä¸ƒæ‚å…«7.1 æ¨èå¼€æºä¸»é¡µ\n\n\nåç§°\nç½‘å€\n\n\n\nQt&#x2F;C++å­¦ä¹ é«˜çº§ç¾¤\n751439350\n\n\nQtWidgetå¼€æºdemoé›†åˆ\nhttps://gitee.com/feiyangqingyun/QWidgetDemo\n\n\nQtQuick&#x2F;Qmlå¼€æºdemoé›†åˆ\nhttps://gitee.com/jaredtao/TaoQuick\n\n\nQtQuick&#x2F;Qmlå¼€æºdemoé›†åˆ\nhttps://gitee.com/zhengtianzuo/QtQuickExamples\n\n\n7.2 æ¨èç½‘ç«™ä¸»é¡µ\n\n\nåç§°\nç½‘å€\n\n\n\nqtcn\nhttp://www.qtcn.org\n\n\nè±†å­çš„ç©ºé—´\nhttps://www.devbean.net\n\n\nyafeilinux\nhttp://www.qter.org\n\n\nfeiyangqingyun\nhttps://blog.csdn.net/feiyangqingyun\n\n\nQtä½œå“å¤§å…¨\nhttps://qtchina.blog.csdn.net/article/details/97565652\n\n\né¾šå»ºæ³¢\nhttps://gongjianbo1992.blog.csdn.net/\n\n\nä¹Œæ‰˜é‚¦2å·\nhttp://blog.csdn.net/taiyang1987912\n\n\nforuok\nhttp://blog.csdn.net/foruok\n\n\njason\nhttp://blog.csdn.net/wsj18808050\n\n\næœåæ™šå…«\nhttp://www.cnblogs.com/swarmbees\n\n\nBIG_C_GOD\nhttp://blog.csdn.net/big_c_god\n\n\nå…¬å­™äºŒç‹—\nhttps://qtdebug.com/qtbook\n\n\né›¨ç”°å“¥\nhttps://blog.csdn.net/ly305750665\n\n\néƒ‘å¤©ä½\nhttps://blog.csdn.net/zhengtianzuo06\n\n\nå¯’å±±-å±…å£«\nhttps://blog.csdn.net/esonpo\n\n\nå‰è¡Œä¸­å°çŒª\nhttp://blog.csdn.net/goforwardtostep\n\n\næ¶›å“¥çš„çŸ¥ä¹ä¸“æ \nhttps://zhuanlan.zhihu.com/TaoQt\n\n\nQtå›\nhttps://blog.csdn.net/nicai_xiaoqinxi\n\n\n7.3 æ¨èå­¦ä¹ ç½‘ç«™\n\n\nåç§°\nç½‘å€\n\n\n\nQtè€å¤–è§†é¢‘æ•™ç¨‹\nhttp://space.bilibili.com/2592237/#!&#x2F;index\n\n\nQtç»´åŸºè¡¥å……æ–‡æ¡£\nhttps://wiki.qt.io/Main\n\n\nQtæºç æŸ¥çœ‹ç½‘ç«™\nhttps://code.woboq.org/qt5\n\n\nQtå®˜æ–¹ä¸‹è½½åœ°å€\nhttps://download.qt.io\n\n\nQtå®˜æ–¹ä¸‹è½½æ–°åœ°å€\nhttps://download.qt.io/new_archive&#x2F;qt&#x2F;\n\n\nQtå›½å†…é•œåƒä¸‹è½½åœ°å€\nhttps://mirrors.cloud.tencent.com/qt\n\n\nQtå®‰è£…åŒ…ä¸‹è½½åœ°å€\nhttp://qthub.com/download/\n\n\nQtæœ€æ–°ç‰ˆäºŒè¿›åˆ¶åŒ…\nhttps://build-qt.fsu0413.me/\n\n\nQtç‰ˆæœ¬æ›´æ–°å†…å®¹\nhttps://doc-snapshots.qt.io/qt6-6.2/whatsnew62.html\n\n\nQtä¸­qmakeå˜é‡è¯´æ˜\nhttps://doc.qt.io/qt-5/qmake-variable-reference.html\n\n\nQtå…¥é—¨æœ€ç®€å•æ•™ç¨‹\nhttp://c.biancheng.net/qt/\n\n\nqsså­¦ä¹ åœ°å€1\nhttp://47.100.39.100/qtwidgets/stylesheet-reference.html\n\n\nqsså­¦ä¹ åœ°å€2\nhttp://47.100.39.100/qtwidgets/stylesheet-examples.html\n\n\nqsså­¦ä¹ åœ°å€3\nhttps://doc.qt.io/qt-6/qstyle.html\n\n\nç²¾ç¾å›¾è¡¨æ§ä»¶QWT\nhttp://qwt.sourceforge.net/\n\n\nç²¾ç¾å›¾è¡¨æ§ä»¶QCustomPlot\nhttps://www.qcustomplot.com/\n\n\nå…è´¹å›¾æ ‡ä¸‹è½½\nhttp://www.easyicon.net/\n\n\nå›¾å½¢å­—ä½“ä¸‹è½½\nhttps://www.iconfont.cn/\n\n\næ¼‚äº®ç•Œé¢ç½‘ç«™\nhttps://www.ui.cn/\n\n\nå¾®ä¿¡å…¬ä¼—å·\nå®˜æ–¹å…¬ä¼—å·ï¼šQtè½¯ä»¶  äº®å“¥å…¬ä¼—å·ï¼šé«˜æ•ˆç¨‹åºå‘˜\n\n\n8 ä¹¦ç±æ¨è\nC++å…¥é—¨ä¹¦ç±æ¨èã€ŠC++ primer plusã€‹ï¼Œè¿›é˜¶ä¹¦ç±æ¨èã€ŠC++ primerã€‹ã€‚\nQtå…¥é—¨ä¹¦ç±æ¨èéœäºšé£çš„ã€ŠQt Creatorå¿«é€Ÿå…¥é—¨ã€‹ï¼ŒQtè¿›é˜¶ä¹¦ç±æ¨èå®˜æ–¹çš„ã€ŠC++ GUI Qt4ç¼–ç¨‹ã€‹ï¼Œqmlä¹¦ç±æ¨èã€ŠQt5ç¼–ç¨‹å…¥é—¨ã€‹ï¼ŒQtç”µå­ä¹¦å¼ºçƒˆæ¨èã€ŠQt5.10 GUIå®Œå…¨å‚è€ƒæ‰‹å†Œã€‹ã€‚\nå¼ºçƒˆæ¨èç¨‹åºå‘˜è‡ªæˆ‘æå‡ã€ä¿®å…»ã€è§„åˆ’ç³»åˆ—ä¹¦ã€Šèµ°å‡ºè½¯ä»¶ä½œåŠã€‹ã€Šå¤§è¯ç¨‹åºå‘˜ã€‹ã€Šç¨‹åºå‘˜çš„æˆé•¿è¯¾ã€‹ã€Šè§£å¿§ç¨‹åºå‘˜ã€‹ï¼Œå—ç›ŠåŒªæµ…ï¼Œå—ç›Šç»ˆç”Ÿï¼\n\n","slug":"è½¬è½½/Qt/Qtå¼€å‘ç»éªŒ","date":"2023-05-08T02:27:52.000Z","categories_index":"è½¬è½½","tags_index":"Qt,c++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"01d9802911dc5e780502cf79cbe9f782","title":"Qtå®ç°æ—¥å†è¡Œç¨‹è½¯ä»¶","content":"DailyAssistğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°æ—¥å†è¡Œç¨‹è½¯ä»¶ã€‚\n\næ—¥å†æ˜¾ç¤ºã€å¢åŠ &#x2F;åˆ é™¤è¡Œç¨‹\nå¢åŠ åˆ é™¤å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒå…³æœºï¼Œé‡å¯ï¼Œé”å±ï¼Œæ³¨é”€ç­‰æ“ä½œ\næ”¯æŒåŠ¨æ€å¤šè¯­è¨€\næ”¯æŒåˆ‡æ¢å¸ƒå±€\næ”¯æŒå¯åŠ¨å¯†ç è®¾ç½®\næ”¯æŒå¼€æœºè‡ªå¯åŠ¨\nåŠ¨æ€åˆ‡æ¢æ•ˆæœ\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šmsvcç¼–è¯‘å™¨éƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nsqlite\nå­˜å‚¨æ•°æ®åº“\n\n\nğŸ—ºï¸è½¯ä»¶å±•ç¤º \n\næ—¥å†è¡Œç¨‹\næ–°å»ºæ—¥ç¨‹\nå®šæ—¶æé†’\næ–°å»ºæé†’\nç³»ç»Ÿè®¾ç½®\nè‹±æ–‡ç•Œé¢\nå¸ƒå±€2\nå¸ƒå±€3\nå›¾å½¢å¯†ç \nè‹±æ–‡ç•Œé¢\næ—¥å†è¡Œç¨‹\nå®šæ—¶æé†’\nç³»ç»Ÿè®¾ç½®\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°æ—¥å†è¡Œç¨‹è½¯ä»¶","date":"2023-05-04T11:44:09.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"bfad628bb7933d4e69a2d0dc8ebc5a5c","title":"QtAvç¼–è¯‘-windowså¹³å°","content":"\nç®€ä»‹\nQtAVæ˜¯åŸºäºQtå’ŒFFmpegçš„å¤šåª’ä½“æ’­æ”¾åº“ã€‚å®ƒå¯ä»¥å¸®åŠ©æ‚¨ä»¥å‰æ‰€æœªæœ‰çš„ç²¾åŠ›ç¼–å†™æ’­æ”¾å™¨ã€‚\n\nQtAVå¼ºå¤§çš„åŠŸèƒ½\nQtAVå¯ä»¥æ»¡è¶³æ‚¨çš„æœ€å¤§éœ€æ±‚\n\nç¡¬ä»¶è§£ç æ”¯æŒï¼šDXVA2ï¼ŒVAAPIï¼ŒVDA &#x2F; VideoToolboxï¼ŒCedarXï¼ŒCUDAï¼ˆç¬¬ä¸€ä¸ªæ’­æ”¾å™¨åœ¨Linuxä¸Šæ”¯æŒCUDAå—ï¼Ÿï¼‰\nOpenGLå’ŒES2æ”¯æŒå‡ ä¹æ‰€æœ‰æ ¼å¼ï¼ŒåŒ…æ‹¬Hi10Pè§†é¢‘ï¼ˆç¬¬ä¸€ä¸ªæ’­æ”¾å™¨&#x2F;åº“åœ¨ES2ä¸­æ”¯æŒ10bitï¼ŸVLCï¼ŒXBMCï¼Œmplayerç°åœ¨ä¸æ”¯æŒï¼‰\nå®æ—¶é¢„è§ˆ\nRGBå’ŒYUVæ ¼å¼çš„è§†é¢‘æ•è·\nOSDå’Œè‡ªå®šä¹‰è¿‡æ»¤å™¨\nlibavfilterä¸­çš„è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚stero3dï¼Œæ¨¡ç³Š\nå­—å¹•è½¨é“é€‰æ‹©ã€‚åŠ¨æ€æ›´æ”¹FFmpegå’Œlibasså¼•æ“\né€å¸§æ’­æ”¾\næ’­æ”¾é€Ÿåº¦æ§åˆ¶\nå„ç§æµï¼šåŒºåŸŸè®¾ç½®æ–‡ä»¶ï¼Œhttpï¼Œrtspç­‰ä»¥åŠæ‚¨çš„è‡ªå®šä¹‰æµ\néŸ³é¢‘é€šé“ï¼Œè½¨é“å’Œå¤–éƒ¨éŸ³é¢‘è½¨é“\næ’­æ”¾æ—¶åŠ¨æ€æ›´æ”¹æ¸²æŸ“å¼•æ“ã€‚\nåŠ¨æ€æ›´æ”¹è§†é¢‘è§£ç å™¨\n1ä¸ªæ’­æ”¾å™¨çš„å¤šä¸ªè§†é¢‘è¾“å‡º\nè§†é¢‘å‡è¡¡å™¨ï¼ˆè½¯ä»¶å’ŒOpenGLï¼‰ï¼šäº®åº¦ï¼Œå¯¹æ¯”åº¦ï¼Œé¥±å’Œåº¦ï¼Œè‰²ç›¸\nQMLæ”¯æŒã€‚å¤§å¤šæ•°æ’­æ”¾APIä¸QtMultimediaæ¨¡å—å…¼å®¹\nå…¼å®¹æ€§ï¼šQtAVå¯ä»¥åŒæ—¶ä½¿ç”¨Qt4å’ŒQt5ï¼ŒFFmpegï¼ˆ&gt; &#x3D; 1.0ï¼‰å’ŒLibavï¼ˆ&gt; &#x3D; 9.0ï¼‰æ¥æ„å»ºã€‚å»ºè®®ä½¿ç”¨æœ€æ–°çš„FFmpegç‰ˆæœ¬ã€‚\n\n\n\nç¼–è¯‘å‡†å¤‡ä½œè€…ç›®å‰æ‰€ä½¿ç”¨çš„çš„ç¯å¢ƒä¸ºQt5.9.3 + vs2015ç¼–è¯‘å™¨\nä¸‹è½½FFmpegç›´æ¥ä¸‹è½½å®˜æ–¹æä¾›çš„å¼€å‘åº“ä¸‹è½½åœ°å€ï¼š    - https://ffmpeg.zeranoe.com/builds/win64/dev/ffmpeg-3.4.2-win64-dev.zip    - https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-3.4.2-win64-shared.zip\nä½¿ç”¨QtAvæä¾›çš„å¼€å‘åº“ï¼ˆæ¨èï¼‰txt- æ–‡ä»¶åï¼šQtAV-depends-windows-x86+x64.7z\n- http://sourceforge.net/projects/qtav/files/depends/QtAV-depends-windows-x86+x64.7z/download\n- æœ¬æ•™ç¨‹é‡‡ç”¨æ­¤ç§æ–¹å¼ç¼–è¯‘QtAvè‡ªè¡Œç¼–è¯‘FFmpegtxt- è‡ªè¡Œç¼–è¯‘æ¯”è¾ƒéº»çƒ¦ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œå°è¯•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ä¸‹è½½QtAvæºç txt- è®¿é—®QtAv githubåœ°å€ï¼šhttps://github.com/wang-bin/QtAV/\n- å¯ä»¥ä½¿ç”¨git cloneæˆ–è€…ç›´æ¥ä¸‹è½½æºä»£ç é…ç½®ç¯å¢ƒ\nè¿›å…¥QtAvä»£ç æ ¹ç›®å½•\nåˆ›å»ºffmpeg&#x2F;winç›®å½•\nè§£å‹ä¸Šé¢ä¸‹è½½çš„FFmpegä¾èµ–åº“ï¼šQtAV-depends-windows-x86+x64.7zï¼Œè§£å‹åˆ°ä¸Šé¢åˆ›å»ºffmpeg&#x2F;winç›®å½•\nç›®å½•ç»“æ„å¦‚ä¸‹\nä¿®æ”¹QtAv&#x2F;.qmake.confæ–‡ä»¶\nåœ¨æœ€ååŠ ä¸Šä¸‹é¢ä¸¤è¡Œï¼Œå³è®¾ç½®FFmpegçš„åŠ¨æ€åº“è·¯å¾„åŠå¤´æ–‡ä»¶è·¯å¾„12INCLUDEPATH += $$PWD/ffmpeg/win/includeLIBS +=  -L$$PWD/ffmpeg/win/lib\nå®Œæ•´æ–‡ä»¶å¦‚ä¸‹123456789101112131415161718QTAV_MAJOR_VERSION = 1QTAV_MINOR_VERSION = 13QTAV_PATCH_VERSION = 0QTAV_VERSION = $$&#123;QTAV_MAJOR_VERSION&#125;.$$&#123;QTAV_MINOR_VERSION&#125;.$$&#123;QTAV_PATCH_VERSION&#125;#MODULE_VERSION = $$QTAV_VERSION# set runpath instead of rpath for gcc for elf targets. Qt&gt;=5.5CONFIG *= enable_new_dtags# OSX10.6 is not supported in Qt5.4macx:isEqual(QT_MAJOR_VERSION,5):greaterThan(QT_MINOR_VERSION, 3): CONFIG *= c++11android: CONFIG*=c++11QMAKE_MACOSX_DEPLOYMENT_TARGET = 10.8QMAKE_IOS_DEPLOYMENT_TARGET = 6.0# é˜¿æœ¨å¤§å”INCLUDEPATH += $$PWD/ffmpeg/win/includeLIBS +=  -L$$PWD/ffmpeg/win/lib\n\nå¼€å§‹ç¼–è¯‘\nä½¿ç”¨QtCreatoræ‰“å¼€QtAv.proæ–‡ä»¶\nè¿›è¡Œç¼–è¯‘å³å¯\n\nè¿è¡Œ&amp;æµ‹è¯•\nå°†QtAV\\ffmpeg\\win\\binä¸‹é¢çš„æ‰€æœ‰dllæ–‡ä»¶æ‹·è´åˆ°QtAV\\binç›®å½•\né€‰æ‹©simpleplayeré¡¹ç›®ï¼Œç‚¹å‡»è¿è¡Œå³å¯\nå¯ä»¥çœ‹è§ä¸€ä¸ªç®€æ˜“çš„è§†é¢‘æ’­æ”¾å™¨å°±å‡ºç°äº†ï¼Œå¯ä»¥å»æ’­æ”¾æµ‹è¯•äº†\n\nä½¿ç”¨QtAvåŠ¨æ€åº“\nåœ¨QtAV\\lib_win_x86ç›®å½•ä¸‹æœ‰ç”Ÿæˆçš„QmlAV.dllåŠQmlAV.libï¼ŒQtAVWidgets1.libï¼ŒQtAVWidgets1.libï¼Œè¿™å››ä¸ªæ–‡ä»¶å³æˆ‘ä»¬éœ€è¦çš„åŠ¨æ€åº“æ–‡ä»¶\nQtAV\\src\\QtAVå’ŒQtAV\\widgets\\QtAVWidgetsä¸¤ä¸ªç›®å½•ä¸ºä¸Šé¢ä¸¤ä¸ªåŠ¨æ€åº“çš„å¤´æ–‡ä»¶\næœ‰äº†ä¸Šé¢è¿™äº›æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥é›†æˆåˆ°è‡ªå·±çš„ç¨‹åºé‡Œï¼Œå¼€å‘è‡ªå·±çš„æ’­æ”¾å™¨äº†ï¼Œå…·ä½“å¼€å‘è¿‡ç¨‹è¿™é‡Œå°±ä¸å†è¯´æ˜äº†ï¼Œæœ‰æœºä¼šå¯ä»¥å†å†™ä¸€ç¯‡æ•™ç¨‹ï¼Œå…·ä½“å¯ä»¥çœ‹å®˜æ–¹ç¤ºä¾‹å°±è¡Œ\n\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QtAvç¼–è¯‘-windows","date":"2022-11-02T05:57:29.000Z","categories_index":"Qtå…¥é—¨æŒ‡å—,QtAvä½¿ç”¨æ•™ç¨‹","tags_index":"Qt,QtAv","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e715a1b3be6463ce11c263a306ec455e","title":"Qtç¼–è¯‘æŠ¥é”™ Parse error at â€œstdâ€œçš„è§£å†³åŠæ³•","content":"\næ­£æ–‡\nQtç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹æŠ¥é”™\n\n\n&#x2F;usr&#x2F;local&#x2F;Qt-5.10.0&#x2F;bin&#x2F;moc -DLINUX -DQT_DEPRECATED_WARNINGS -DQT_NO_DEBUG -DQT_NETWORK_LIB -DQT_CORE_LIB â€“include .&#x2F;moc_predefs.h -I&#x2F;usr&#x2F;local&#x2F;Qt-5.10.0&#x2F;mkspecs&#x2F;linux-g++ -I&#x2F;root&#x2F;hz3000v2.5&#x2F;trunk&#x2F;source&#x2F;dts&#x2F;debug_info_srv -I&#x2F;root&#x2F;hz3000v2.5&#x2F;trunk&#x2F;source&#x2F;dts&#x2F;common -I&#x2F;root&#x2F;hz3000v2.5&#x2F;trunk&#x2F;include&#x2F;hnstd -I&#x2F;root&#x2F;hz3000v2.5&#x2F;trunk&#x2F;include&#x2F;boost_include -I&#x2F;root&#x2F;hz3000v2.5&#x2F;trunk&#x2F;source&#x2F;dts&#x2F;debug_info_srv -I&#x2F;usr&#x2F;local&#x2F;Qt-5.10.0&#x2F;include -I&#x2F;usr&#x2F;local&#x2F;Qt-5.10.0&#x2F;include&#x2F;QtNetwork -I&#x2F;usr&#x2F;local&#x2F;Qt-5.10.0&#x2F;include&#x2F;QtCore -I&#x2F;usr&#x2F;include&#x2F;c++&#x2F;4.9 -I&#x2F;usr&#x2F;include&#x2F;i386-linux-gnu&#x2F;c++&#x2F;4.9 -I&#x2F;usr&#x2F;include&#x2F;c++&#x2F;4.9&#x2F;backward -I&#x2F;usr&#x2F;lib&#x2F;gcc&#x2F;i586-linux-gnu&#x2F;4.9&#x2F;include -I&#x2F;usr&#x2F;local&#x2F;include -I&#x2F;usr&#x2F;lib&#x2F;gcc&#x2F;i586-linux-gnu&#x2F;4.9&#x2F;include-fixed -I&#x2F;usr&#x2F;include&#x2F;i386-linux-gnu -I&#x2F;usr&#x2F;include tcp_server.h -o moc_tcp_server.cppusr&#x2F;include&#x2F;c++&#x2F;4.9&#x2F;bits&#x2F;stl_relops.:67: Parse error at â€œstdâ€Makefile:579: recipe for target â€˜moc_tcp_server.cppâ€™ failedmake: *** [moc_tcp_server.cpp] Error 1\n\nè§£å†³æ–¹æ¡ˆäºæ˜¯ï¼Œä¸€é€šgoogleä¹‹åå‘ç°ï¼Œqmakeä¼šåœ¨å·¥ç¨‹ç›®å½•ä¸‹ç”Ÿæˆ.qmake.stashï¼Œåˆ æ‰è¿™ä¸ªæ–‡ä»¶ï¼Œé‡æ–°qmake myproject.proï¼Œä¼šé‡æ–°ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶\n\nqmake myproject.proInfo: creating stash file &#x2F;root&#x2F;myproject&#x2F;.qmake.stash\n\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/å›½äº§åŒ–ç³»ç»ŸQtç¼–è¯‘æŠ¥é”™01","date":"2022-11-02T05:42:51.000Z","categories_index":"Qtå…¥é—¨æŒ‡å—,å›½äº§åŒ–æ“ä½œç³»ç»Ÿ","tags_index":"Qt,å›½äº§åŒ–","author_index":"é˜¿æœ¨å¤§å”"},{"id":"a6c3990ea6d4db0cb6f4530662b613f2","title":"VUEå‰ç«¯è§£å†³webå‡çº§åéœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨é—®é¢˜","content":"é—®é¢˜æè¿°\nvueé¡¹ç›®åç«¯å‡çº§æ–°çš„index.htmlåŠç›¸åº”js&#x2F;cssåï¼Œå‰ç«¯å·²æ‰“å¼€webæ˜¯ä¸æ„ŸçŸ¥çš„ï¼Œæ‰€ä»¥åœ¨ä¸åˆ·æ–°æµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼Œå‰ç«¯çš„index.htmlæ˜¯ä¸ä¼šä¸»åŠ¨æ›´æ–°ï¼Œä»è€Œé€ æˆå‰åç«¯ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n\nå‰ç«¯æ–¹æ¡ˆ\nwebæ¯æ¬¡ç¼–è¯‘æ—¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå¹¶ä¸”å†™å…¥çš„é…ç½®æ–‡ä»¶ä¸­\næ¯æ¬¡æ‰“åŒ…é…ç½®æ–‡ä»¶ä¸€èµ·å‘å¸ƒ\nwebåœ¨éœ€è¦çš„åœ°æ–¹æ£€æµ‹æœåŠ¡å™¨ä¸Šçš„é…ç½®æ–‡ä»¶å’Œå½“å‰webçš„ç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´ï¼Œè‹¥ä¸ä¸€è‡´åˆ™ä¸»åŠ¨åˆ·æ–°ä¸€ä¸‹ç•Œé¢ï¼Œæˆ–è€…æç¤ºç”¨æˆ·åˆ·æ–°ç­‰\n\nå…·ä½“æ­¥éª¤\nä¿®æ”¹vue.config.js, ç”Ÿæˆç‰ˆæœ¬å·ï¼Œå¹¶æ³¨å…¥é¡¹ç›®ä¸­\n\nä¿®æ”¹vue.config.js, ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œversion.json\n\nå®Œæ•´ä»£ç \n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253const path = require(&#x27;path&#x27;)Date.prototype.Format = function (fmt) &#123;    var o = &#123;        &quot;M+&quot;: this.getMonth() + 1,  // æœˆä»½        &quot;d+&quot;: this.getDate(),       // æ—¥        &quot;h+&quot;: this.getHours(),      // å°æ—¶        &quot;m+&quot;: this.getMinutes(),    // åˆ†        &quot;s+&quot;: this.getSeconds(),    // ç§’        &quot;q+&quot;: Math.floor((this.getMonth() + 3) / 3), // å­£åº¦        &quot;S&quot;: this.getMilliseconds() // æ¯«ç§’    &#125;;    if (/(y+)/.test(fmt))        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + &quot;&quot;).substr(4 - RegExp.$1.length));    for (var k in o)        if (new RegExp(&quot;(&quot; + k + &quot;)&quot;).test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((&quot;00&quot; + o[k]).substr((&quot;&quot; + o[k]).length)));        return fmt;&#125;let myVersion = new Date().Format(&#x27;yyyy-MM-dd hh:mm:ss&#x27;);module.exports = &#123;    chainWebpack: config =&gt; &#123;        config.resolve.alias        .set(&#x27;vue-i18n&#x27;, &#x27;vue-i18n/dist/vue-i18n.cjs.js&#x27;)        .set(&#x27;@&#x27;, path.join(__dirname,&#x27;src&#x27;))        config.plugin(&#x27;define&#x27;)        .tap(args =&gt; &#123;             args[0][&#x27;process.env&#x27;].API_CONFIG = JSON.stringify(&#123;                WEB_VERSION: myVersion  //è‡ªå®šä¹‰é…ç½®webç‰ˆæœ¬å·            &#125;)            return args        &#125;)    &#125;&#125;// å¯¼å…¥fsæ¨¡å—const fs = require(&#x27;fs&#x27;)// è°ƒç”¨writeFile()å†™å…¥å†…å®¹ï¼Œå¦‚æœå†™å…¥è·¯å¾„çš„æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œè·¯å¾„æ­£ç¡®ä¼šè‡ªåŠ¨åˆ›å»ºæ–‡ä»¶// æ³¨æ„ï¼šwriteFile()ä¸ä¼šè‡ªåŠ¨åˆ›å»ºè·¯å¾„// åˆ¤æ–­æ˜¯å¦å†™å…¥æˆåŠŸlet ver = &#123;    version: myVersion&#125;fs.writeFile(__dirname + &#x27;/public/version.json&#x27;, JSON.stringify(ver), &#x27;utf-8&#x27;, function(err) &#123;    if (err) &#123;        return console.log(&#x27;å†™å…¥æ–‡ä»¶å¤±è´¥&#x27;, err.message)    &#125; else &#123;        console.log(&#x27;å†™å…¥æˆåŠŸ&#x27;)    &#125;&#125;)\n\nåœ¨éœ€è¦çš„åœ°æ–¹è¯·æ±‚é…ç½®æ–‡ä»¶ï¼Œå¹¶æ ¡éªŒ\n12345678910async function checkWebVersion() &#123;    const ver = await request.get(`/version.json?t=$&#123;new Date().getTime()&#125;`);    console.log(ver);    let serverVersion = ver.version;    let localWebVersion = process.env.API_CONFIG.WEB_VERSION;    if (localWebVersion &amp;&amp; serverVersion != localWebVersion) &#123;        window.location.reload();        return;    &#125;&#125;\n\næ­¤å¤„ä¸ºç¤ºä¾‹ï¼Œå¯æ ¹æ®éœ€æ±‚ä¿®æ”¹\nåŸç†ä¸Šå°±æ˜¯è·å–ä¸€ä¸‹æœåŠ¡å™¨ä¸Šçš„webç‰ˆæœ¬å·ï¼Œæ³¨æ„åé¢åŠ ä¸Šæ—¶é—´æˆ³\nç„¶åå¯¹æ¯”å½“å‰webç‰ˆæœ¬å’ŒæœåŠ¡å™¨ä¸Šwebç‰ˆæœ¬çš„å´åˆ«\nè‹¥æœ‰åŒºåˆ«åˆ™åˆ·æ–°ç•Œé¢ï¼Œé‡æ–°åŠ è½½web\næ­¤æ®µä»£ç å¯ä»¥åŠ åˆ°axioçš„å‘é€æ‹¦æˆªå™¨ä¸­ï¼Œæ¯æ¡è¯·æ±‚éƒ½æ ¡éªŒä¸€æ¬¡ï¼Œä¹Ÿå¯ä»¥å¢åŠ å®šæ—¶å™¨ï¼Œé—´éš”ä¸€å®šæ—¶é—´å»æ£€æµ‹ï¼Œå…·ä½“æ ¹æ®å®é™…ä¸šåŠ¡æ¥å¤„ç†\n\n\n\n","slug":"WEB/VUEå‰ç«¯è§£å†³webå‡çº§åéœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨é—®é¢˜","date":"2022-11-01T08:52:25.000Z","categories_index":"å‰ç«¯æ¡†æ¶","tags_index":"vue","author_index":"é˜¿æœ¨å¤§å”"},{"id":"cb8a46bc06540e3038f7697e934b72dc","title":"TCPå››æ¬¡æŒ¥æ‰‹","content":"\nå››æ¬¡æŒ¥æ‰‹æ˜¯æ–­å¼€è¿æ¥çš„è¿‡ç¨‹ï¼Œéœ€è¦åŒå‘æ–­å¼€ï¼Œå…³äºç”±å“ªä¸€ç«¯å…ˆæ–­å¼€è¿æ¥æ˜¯æ²¡æœ‰è¦æ±‚çš„ã€‚é€šä¿¡çš„ä¸¤ç«¯å¦‚æœæƒ³è¦æ–­å¼€è¿æ¥å°±éœ€è¦è°ƒç”¨ close() å‡½æ•°ï¼Œå½“ä¸¤ç«¯éƒ½è°ƒç”¨äº†è¯¥å‡½æ•°ï¼Œå››æ¬¡æŒ¥æ‰‹ä¹Ÿå°±å®Œæˆäº†ã€‚\n\n\nå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ–­å¼€è¿æ¥ -&gt; å•å‘æ–­å¼€\næœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ–­å¼€è¿æ¥ -&gt; å•å‘æ–­å¼€\nè¿›è¡Œäº†ä¸¤æ¬¡å•å‘æ–­å¼€ï¼ŒåŒå‘æ–­å¼€å°±å®Œæˆäº†ï¼Œæ¯è¿›è¡Œä¸€æ¬¡å•å‘æ–­å¼€ï¼Œå°±ä¼šå®Œæˆä¸¤æ¬¡æŒ¥æ‰‹çš„åŠ¨ä½œã€‚\n\n\n\n\nåœ¨ Tcp åè®®ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„å­—æ®µæœ‰ï¼š\næºç«¯å£ï¼šè¡¨ç¤ºå‘é€ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ 16 ä½ï¼Œ2 ä¸ªå­—èŠ‚\n\nç›®çš„ç«¯å£ï¼šè¡¨ç¤ºæ¥æ”¶ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ 16 ä½ï¼Œ2 ä¸ªå­—èŠ‚\n\nåºå·ï¼ˆsequence numberï¼‰ï¼šå­—æ®µé•¿ 32 ä½ï¼Œå  4 ä¸ªå­—èŠ‚ï¼Œåºå·çš„èŒƒå›´ä¸º [0ï¼Œ4284967296]ã€‚\n\nç”±äº TCP æ˜¯é¢å‘å­—èŠ‚æµçš„ï¼Œåœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­ä¼ é€çš„å­—èŠ‚æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æŒ‰é¡ºåºç¼–å·  é¦–éƒ¨ä¸­çš„åºå·å­—æ®µåˆ™æ˜¯æŒ‡æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œè¿™æ˜¯éšæœºç”Ÿæˆçš„ã€‚  åºå·æ˜¯å¾ªç¯ä½¿ç”¨çš„ï¼Œå½“åºå·å¢åŠ åˆ°æœ€å¤§å€¼æ—¶ï¼Œä¸‹ä¸€ä¸ªåºå·å°±åˆå›åˆ°äº† 0  ç¡®è®¤åºå·ï¼ˆacknowledgement numberï¼‰ï¼šå  32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰ï¼Œè¡¨ç¤ºæ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·ï¼Œå¦‚æœç¡®è®¤åºå·ä¸º Nï¼Œåºå·ä¸º Sï¼Œåˆ™è¡¨æ˜åˆ°åºå· N-S ä¸ºæ­¢çš„æ‰€æœ‰æ•°æ®å­—èŠ‚éƒ½å·²ç»è¢«æ­£ç¡®åœ°æ¥æ”¶åˆ°äº†ã€‚\n\n\n8 ä¸ªæ ‡å¿—ä½ï¼ˆFlagï¼‰:\n\nCWRï¼šCWR æ ‡å¿—ä¸åé¢çš„ ECE æ ‡å¿—éƒ½ç”¨äº IP é¦–éƒ¨çš„ ECN å­—æ®µï¼ŒECE æ ‡å¿—ä¸º 1 æ—¶ï¼Œåˆ™é€šçŸ¥å¯¹æ–¹å·²å°†æ‹¥å¡çª—å£ç¼©å°ï¼›\nECEï¼šè‹¥å…¶å€¼ä¸º 1 åˆ™ä¼šé€šçŸ¥å¯¹æ–¹ï¼Œä»å¯¹æ–¹åˆ°è¿™è¾¹çš„ç½‘ç»œæœ‰é˜»å¡ã€‚åœ¨æ”¶åˆ°æ•°æ®åŒ…çš„ IP é¦–éƒ¨ä¸­ ECN ä¸º 1 æ—¶å°† TCP é¦–éƒ¨ä¸­çš„ ECE è®¾ä¸º 1.ï¼›\nURGï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºåŒ…ä¸­æœ‰éœ€è¦ç´§æ€¥å¤„ç†çš„æ•°æ®ï¼Œå¯¹äºéœ€è¦ç´§æ€¥å¤„ç†çš„æ•°æ®ï¼Œä¸åé¢çš„ç´§æ€¥æŒ‡é’ˆæœ‰å…³ï¼›\nACKï¼šè¯¥ä½è®¾ä¸º 1ï¼Œç¡®è®¤åº”ç­”çš„å­—æ®µæœ‰æ•ˆï¼ŒTCP è§„å®šé™¤äº†æœ€åˆå»ºç«‹è¿æ¥æ—¶çš„ SYN åŒ…ä¹‹å¤–è¯¥ä½å¿…é¡»è®¾ä¸º 1ï¼›\nPSHï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºéœ€è¦å°†æ”¶åˆ°çš„æ•°æ®ç«‹åˆ»ä¼ ç»™ä¸Šå±‚åº”ç”¨åè®®ï¼Œè‹¥è®¾ä¸º 0ï¼Œåˆ™å…ˆå°†æ•°æ®è¿›è¡Œç¼“å­˜ï¼›\nRSTï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤º TCP è¿æ¥å‡ºç°å¼‚å¸¸å¿…é¡»å¼ºåˆ¶æ–­å¼€è¿æ¥ï¼›\nSYNï¼šç”¨äºå»ºç«‹è¿æ¥ï¼Œè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨å…¶åºåˆ—å·çš„å­—æ®µè¿›è¡Œåºåˆ—å·åˆå€¼è®¾å®šï¼›\nFINï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºä»Šåä¸å†æœ‰æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€è¿æ¥ã€‚\n\n\nçª—å£å¤§å°ï¼šè¯¥å­—æ®µé•¿ 16 ä½ï¼Œè¡¨ç¤ºä»ç¡®è®¤åºå·æ‰€æŒ‡ä½ç½®å¼€å§‹èƒ½å¤Ÿæ¥æ”¶çš„æ•°æ®å¤§å°ï¼ŒTCP ä¸å…è®¸å‘é€è¶…è¿‡è¯¥çª—å£å¤§å°çš„æ•°æ®ã€‚\n\n\n\n\n\næ ‡å¿—ä½\nè§£é‡Š\n\n\n\nSYN\nsynchronouså»ºç«‹è”æœº\n\n\nACK\nacknowledgement ç¡®è®¤\n\n\nPSH\npushä¼ é€\n\n\nPSH\npushä¼ é€\n\n\nURG\nurgentç´§æ€¥\n\n\nRST\nreseté‡ç½®\n\n\nFIN\nfinishç»“æŸ\n\n\nseq\nSequence number(é¡ºåºå·ç )\n\n\nack\nAcknowledge number(ç¡®è®¤å·ç )\n\n\nTCPå››æ¬¡æŒ¥æ‰‹å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š1234567sequenceDiagram    participant Client    participant Server    Client-&gt;&gt;Server: FIN,Seq=x,Ack=y    Server--&gt;&gt;Client: ACK,Ack=y+1,Seq=z    Server-&gt;&gt;Client: FIN,Seq=w,Ack=y+1    Client--&gt;&gt;Server: ACK,Ack=w+1,Seq=x+1\n\nç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š\nå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘èµ·è¿æ¥è¯·æ±‚å°†æŠ¥æ–‡ä¸­çš„ SYN å­—æ®µç½®ä¸º 1ï¼Œç”Ÿæˆéšæœºåºå· xï¼Œseq&#x3D;x\næœåŠ¡å™¨ç«¯ï¼šæ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ•°æ®ï¼Œè§£æ tcp åè®®ï¼Œæ ¡éªŒ SYN æ ‡å¿—ä½æ˜¯å¦ä¸º 1ï¼Œå¹¶å¾—åˆ°åºå· x\n\nç¬¬ä¸€æ¬¡æŒ¥æ‰‹:\nä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šå‘é€æ–­å¼€è¿æ¥çš„è¯·æ±‚\nå°† tcp åè®®ä¸­ FIN æ ‡å¿—ä½è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºè¯·æ±‚æ–­å¼€è¿æ¥\nå‘é€åºå· x ç»™å¯¹ç«¯ï¼Œseq&#x3D;xï¼ŒåŸºäºè¿™ä¸ªåºå·ç”¨äºå®¢æˆ·ç«¯æ•°æ®æ ¡éªŒçš„è®¡ç®—\n\n\nè¢«åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šæ¥æ”¶è¯·æ±‚æ•°æ®ï¼Œå¹¶è§£æ TCP åè®®\næ ¡éªŒ FIN æ ‡å¿—ä½æ˜¯å¦ä¸º 1\næ”¶åˆ°äº†åºå· xï¼ŒåŸºäºè¿™ä¸ªæ•°æ®è®¡ç®—å›å¤çš„ç¡®è®¤åºå· ack çš„å€¼\n\n\n\nç¬¬äºŒæ¬¡æŒ¥æ‰‹:\nè¢«åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šå›å¤æ•°æ®\nåŒæ„äº†å¯¹æ–¹æ–­å¼€è¿æ¥çš„è¯·æ±‚ï¼Œå°† ACK æ ‡å¿—ä½è®¾ç½®ä¸º 1\nå›å¤ ack&#x3D;x+1ï¼Œè¡¨ç¤ºæˆåŠŸæ¥å—äº†å®¢æˆ·ç«¯å‘é€çš„ä¸€ä¸ªå­—èŠ‚æ•°æ®\nå‘å®¢æˆ·ç«¯å‘é€åºå· seq&#x3D;yï¼ŒåŸºäºè¿™ä¸ªåºå·ç”¨äºæœåŠ¡å™¨ç«¯æ•°æ®æ ¡éªŒçš„è®¡ç®—\n\n\nä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šæ¥æ”¶å›å¤æ•°æ®ï¼Œå¹¶è§£æ TCP åè®®\næ ¡éªŒ ACK æ ‡å¿—ä½ï¼Œå¦‚æœä¸º 1 è¡¨ç¤ºæ–­å¼€è¿æ¥çš„è¯·æ±‚å¯¹æ–¹å·²ç»åŒæ„äº†\næ ¡éªŒ ack ç¡®è®¤å‘é€çš„æ•°æ®æœåŠ¡å™¨æ˜¯å¦æ”¶åˆ°äº†ï¼Œå‘é€çš„æ•°æ® &#x3D; ack - x &#x3D; x + 1 -x &#x3D; 1\n\n\n\nç¬¬ä¸‰æ¬¡æŒ¥æ‰‹:\nè¢«åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šå°† tcp åè®®ä¸­ FIN æ ‡å¿—ä½è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºè¯·æ±‚æ–­å¼€è¿æ¥\nä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šæ¥æ”¶è¯·æ±‚æ•°æ®ï¼Œå¹¶è§£æ TCP åè®®ï¼Œæ ¡éªŒ FIN æ ‡å¿—ä½æ˜¯å¦ä¸º 1\n\nç¬¬å››æ¬¡æŒ¥æ‰‹:\nä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šå›å¤æ•°æ®\nå°† tcp åè®®ä¸­ ACK å¯¹åº”çš„æ ‡å¿—ä½è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºåŒæ„äº†æ–­å¼€è¿æ¥çš„è¯·æ±‚\nack&#x3D;y+1ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„ä¸€ä¸ªå­—èŠ‚å®¢æˆ·ç«¯æ¥æ”¶åˆ°äº†\nåºå· seq&#x3D;hï¼Œæ­¤æ—¶çš„ h åº”è¯¥ç­‰äº x+1ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹æ—¶æœåŠ¡å™¨å›å¤çš„ç¡®è®¤åºå· ack çš„å€¼\n\n\nè¢«åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼šæ”¶åˆ°å›å¤çš„ ACK, æ­¤æ—¶åŒå‘è¿æ¥åŒå‘æ–­å¼€ï¼Œé€šä¿¡çš„ä¸¤ç«¯æ²¡æœ‰ä»»ä½•å…³ç³»äº†\n\nwirsharkæŠ“åŒ…åˆ†æTCPå››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ï¼Œæ­¤æŠ“åŒ…ä¸ºæœåŠ¡ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥\n\nç¬¬ä¸€æ¬¡æŒ¥æ‰‹\n\nFINè¯·æ±‚ï¼Œå³æœåŠ¡ç«¯è¯·æ±‚æ–­å¼€è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°seq&#x3D;1ï¼Œ è¿™é‡Œçš„ASKæ ‡å¿—ï¼ŒåŠask&#x3D;1è¯´æ˜æ–­å¼€çš„æ—¶å€™å¯¹ä¹‹å‰æ”¶åˆ°çš„æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤  \n\n\nç¬¬äºŒæ¬¡æŒ¥æ‰‹\n\n[ACK]è¯·æ±‚ï¼Œå³å®¢æˆ·ç«¯åŒæ„æ–­å¼€è¿æ¥ï¼ŒACKè¯´æ˜å®¢æˆ·ç«¯å·²ç»åŒæ„äº†æœåŠ¡ç«¯çš„è¯·æ±‚  \n\n\nç¬¬ä¸‰æ¬¡æŒ¥æ‰‹\n\nFINè¯·æ±‚ï¼Œå³å®¢æˆ·ç«¯è¯·æ±‚æ–­å¼€è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°seq&#x3D;1ï¼Œ è¿™é‡Œçš„ASKæ ‡å¿—ï¼ŒåŠask&#x3D;2è¯´æ˜æ–­å¼€çš„æ—¶å€™å¯¹ä¹‹å‰æ”¶åˆ°çš„æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤è¿‡æ¥çš„seq+1)  \n\n\nç¬¬å››æ¬¡æŒ¥æ‰‹\n\n[ACK]è¯·æ±‚ï¼Œå³æœåŠ¡ç«¯åŒæ„æ–­å¼€è¿æ¥ï¼ŒACKè¯´æ˜æœåŠ¡ç«¯å·²ç»åŒæ„äº†å®¢æˆ·ç«¯çš„è¯·æ±‚  \n\n\n\næ€»ç»“\nTCPå››æ¬¡æŒ¥æ‰‹å¯ä»¥ç”±ä»»æ„ä¸€æ–¹å‘èµ·\n\nå‘èµ·æ–¹å…ˆå‘é€FINæ ‡å¿—æ¥è¯·æ±‚æ–­å¼€è¿æ¥ï¼Œç„¶åæ¥æ”¶æ–¹å›å¤ASKæ¥ç¡®è®¤å…³é—­è¿æ¥\næ¥ç€æ¥æ”¶æ–¹å‘é€FINæ¥è¯·æ±‚æ–­å¼€è¿æ¥ï¼Œç„¶åå‘èµ·æ–¹å›å¤ASKæ¥ç¡®è®¤å…³é—­è¿æ¥\n\n\n","slug":"å…¶ä»–/TCPå››æ¬¡æŒ¥æ‰‹","date":"2022-11-01T06:59:51.000Z","categories_index":"ç½‘ç»œç›¸å…³","tags_index":"tcp,socket","author_index":"é˜¿æœ¨å¤§å”"},{"id":"178906d428a0d6cc1b23477e81172dad","title":"TCPä¸‰æ¬¡æ¡æ‰‹","content":"\nTCP åè®®æ˜¯ä¸€ä¸ªå®‰å…¨çš„ã€é¢å‘è¿æ¥çš„ã€æµå¼ä¼ è¾“åè®®ï¼Œæ‰€è°“çš„é¢å‘è¿æ¥å°±æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¯¹äºç¨‹åºçŒ¿æ¥è¯´åªéœ€è¦åœ¨å®¢æˆ·ç«¯è°ƒç”¨ connect() å‡½æ•°ï¼Œä¸‰æ¬¡æ¡æ‰‹å°±è‡ªåŠ¨è¿›è¡Œäº†ã€‚å…ˆé€šè¿‡ä¸‹å›¾çœ‹ä¸€ä¸‹ TCP åè®®çš„æ ¼å¼ï¼Œç„¶åå†ä»‹ç»ä¸‰æ¬¡æ¡æ‰‹çš„å…·ä½“æµç¨‹ã€‚\n\n\nåœ¨ Tcp åè®®ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„å­—æ®µæœ‰ï¼š\næºç«¯å£ï¼šè¡¨ç¤ºå‘é€ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ 16 ä½ï¼Œ2 ä¸ªå­—èŠ‚\n\nç›®çš„ç«¯å£ï¼šè¡¨ç¤ºæ¥æ”¶ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ 16 ä½ï¼Œ2 ä¸ªå­—èŠ‚\n\nåºå·ï¼ˆsequence numberï¼‰ï¼šå­—æ®µé•¿ 32 ä½ï¼Œå  4 ä¸ªå­—èŠ‚ï¼Œåºå·çš„èŒƒå›´ä¸º [0ï¼Œ4284967296]ã€‚\n\nç”±äº TCP æ˜¯é¢å‘å­—èŠ‚æµçš„ï¼Œåœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­ä¼ é€çš„å­—èŠ‚æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æŒ‰é¡ºåºç¼–å·  é¦–éƒ¨ä¸­çš„åºå·å­—æ®µåˆ™æ˜¯æŒ‡æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œè¿™æ˜¯éšæœºç”Ÿæˆçš„ã€‚  åºå·æ˜¯å¾ªç¯ä½¿ç”¨çš„ï¼Œå½“åºå·å¢åŠ åˆ°æœ€å¤§å€¼æ—¶ï¼Œä¸‹ä¸€ä¸ªåºå·å°±åˆå›åˆ°äº† 0  ç¡®è®¤åºå·ï¼ˆacknowledgement numberï¼‰ï¼šå  32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰ï¼Œè¡¨ç¤ºæ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·ï¼Œå¦‚æœç¡®è®¤åºå·ä¸º Nï¼Œåºå·ä¸º Sï¼Œåˆ™è¡¨æ˜åˆ°åºå· N-S ä¸ºæ­¢çš„æ‰€æœ‰æ•°æ®å­—èŠ‚éƒ½å·²ç»è¢«æ­£ç¡®åœ°æ¥æ”¶åˆ°äº†ã€‚\n\n\n8 ä¸ªæ ‡å¿—ä½ï¼ˆFlagï¼‰:\n\nCWRï¼šCWR æ ‡å¿—ä¸åé¢çš„ ECE æ ‡å¿—éƒ½ç”¨äº IP é¦–éƒ¨çš„ ECN å­—æ®µï¼ŒECE æ ‡å¿—ä¸º 1 æ—¶ï¼Œåˆ™é€šçŸ¥å¯¹æ–¹å·²å°†æ‹¥å¡çª—å£ç¼©å°ï¼›\nECEï¼šè‹¥å…¶å€¼ä¸º 1 åˆ™ä¼šé€šçŸ¥å¯¹æ–¹ï¼Œä»å¯¹æ–¹åˆ°è¿™è¾¹çš„ç½‘ç»œæœ‰é˜»å¡ã€‚åœ¨æ”¶åˆ°æ•°æ®åŒ…çš„ IP é¦–éƒ¨ä¸­ ECN ä¸º 1 æ—¶å°† TCP é¦–éƒ¨ä¸­çš„ ECE è®¾ä¸º 1.ï¼›\nURGï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºåŒ…ä¸­æœ‰éœ€è¦ç´§æ€¥å¤„ç†çš„æ•°æ®ï¼Œå¯¹äºéœ€è¦ç´§æ€¥å¤„ç†çš„æ•°æ®ï¼Œä¸åé¢çš„ç´§æ€¥æŒ‡é’ˆæœ‰å…³ï¼›\nACKï¼šè¯¥ä½è®¾ä¸º 1ï¼Œç¡®è®¤åº”ç­”çš„å­—æ®µæœ‰æ•ˆï¼ŒTCP è§„å®šé™¤äº†æœ€åˆå»ºç«‹è¿æ¥æ—¶çš„ SYN åŒ…ä¹‹å¤–è¯¥ä½å¿…é¡»è®¾ä¸º 1ï¼›\nPSHï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºéœ€è¦å°†æ”¶åˆ°çš„æ•°æ®ç«‹åˆ»ä¼ ç»™ä¸Šå±‚åº”ç”¨åè®®ï¼Œè‹¥è®¾ä¸º 0ï¼Œåˆ™å…ˆå°†æ•°æ®è¿›è¡Œç¼“å­˜ï¼›\nRSTï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤º TCP è¿æ¥å‡ºç°å¼‚å¸¸å¿…é¡»å¼ºåˆ¶æ–­å¼€è¿æ¥ï¼›\nSYNï¼šç”¨äºå»ºç«‹è¿æ¥ï¼Œè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨å…¶åºåˆ—å·çš„å­—æ®µè¿›è¡Œåºåˆ—å·åˆå€¼è®¾å®šï¼›\nFINï¼šè¯¥ä½è®¾ä¸º 1ï¼Œè¡¨ç¤ºä»Šåä¸å†æœ‰æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€è¿æ¥ã€‚\n\n\nçª—å£å¤§å°ï¼šè¯¥å­—æ®µé•¿ 16 ä½ï¼Œè¡¨ç¤ºä»ç¡®è®¤åºå·æ‰€æŒ‡ä½ç½®å¼€å§‹èƒ½å¤Ÿæ¥æ”¶çš„æ•°æ®å¤§å°ï¼ŒTCP ä¸å…è®¸å‘é€è¶…è¿‡è¯¥çª—å£å¤§å°çš„æ•°æ®ã€‚\n\n\n\n\n\næ ‡å¿—ä½\nè§£é‡Š\n\n\n\nSYN\nsynchronouså»ºç«‹è”æœº\n\n\nACK\nacknowledgement ç¡®è®¤\n\n\nPSH\npushä¼ é€\n\n\nPSH\npushä¼ é€\n\n\nURG\nurgentç´§æ€¥\n\n\nRST\nreseté‡ç½®\n\n\nFIN\nfinishç»“æŸ\n\n\nseq\nSequence number(é¡ºåºå·ç )\n\n\nack\nAcknowledge number(ç¡®è®¤å·ç )\n\n\nä¸‰æ¬¡æ¡æ‰‹å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š\nç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š\nå®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘èµ·è¿æ¥è¯·æ±‚å°†æŠ¥æ–‡ä¸­çš„ SYN å­—æ®µç½®ä¸º 1ï¼Œç”Ÿæˆéšæœºåºå· xï¼Œseq&#x3D;x\næœåŠ¡å™¨ç«¯ï¼šæ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ•°æ®ï¼Œè§£æ tcp åè®®ï¼Œæ ¡éªŒ SYN æ ‡å¿—ä½æ˜¯å¦ä¸º 1ï¼Œå¹¶å¾—åˆ°åºå· x\n\nç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š\næœåŠ¡å™¨ç«¯ï¼šç»™å®¢æˆ·ç«¯å›å¤æ•°æ®\nå›å¤ ACK, å°† tcp åè®® ACK å¯¹åº”çš„æ ‡å¿—ä½è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºåŒæ„äº†å®¢æˆ·ç«¯å»ºç«‹è¿æ¥çš„è¯·æ±‚\nå›å¤äº† ack&#x3D;x+1, è¿™æ˜¯ç¡®è®¤åºå·\nx: å®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºåºå·\n1: å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€çš„æ•°æ®çš„é‡ï¼ŒSYN æ ‡å¿—ä½å­˜å‚¨åˆ°æŸä¸€ä¸ªå­—èŠ‚ä¸­ï¼Œå› æ­¤æŒ‰ç…§ä¸€ä¸ªå­—èŠ‚è®¡ç®—ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€çš„ 1 ä¸ªå­—èŠ‚æœåŠ¡å™¨æ”¶åˆ°äº†ã€‚\n\n\nå°† tcp åè®®ä¸­çš„ SYN å¯¹åº”çš„æ ‡å¿—ä½è®¾ç½®ä¸º 1, æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘èµ·äº†è¿æ¥è¯·æ±‚\næœåŠ¡å™¨ç«¯ç”Ÿæˆäº†ä¸€ä¸ªéšæœºåºå· y, å‘é€ç»™äº†å®¢æˆ·ç«¯\n\n\nå®¢æˆ·ç«¯ï¼šæ¥æ”¶å›å¤çš„æ•°æ®ï¼Œå¹¶è§£æ tcp åè®®\næ ¡éªŒ ACK æ ‡å¿—ä½ï¼Œä¸º 1 è¡¨ç¤ºæœåŠ¡å™¨æ¥æ”¶äº†å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚\næ•°æ®æ ¡éªŒï¼Œç¡®è®¤å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®æœåŠ¡å™¨æ”¶åˆ°äº†æ²¡æœ‰ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š\nå‘é€çš„æ•°æ®çš„é‡ &#x3D; ä½¿ç”¨æœåŠ¡å™¨å›å¤çš„ç¡®è®¤åºå· - å®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºåºå· &#x3D;&#x3D;&#x3D;&gt; 1&#x3D;x+1-x\næ ¡éªŒ SYN æ ‡å¿—ä½ï¼Œä¸º 1 è¡¨ç¤ºæœåŠ¡å™¨è¯·æ±‚å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥\nå¾—åˆ°æœåŠ¡å™¨ç”Ÿæˆçš„éšæœºåºå·: y\n\n\n\nç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š\nå®¢æˆ·ç«¯ï¼šå‘é€æ•°æ®ç»™æœåŠ¡å™¨\nå°† tcp åè®®ä¸­ ACK æ ‡å¿—ä½è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºåŒæ„äº†æœåŠ¡å™¨çš„è¿æ¥è¯·æ±‚\nç»™æœåŠ¡å™¨å›å¤äº†ä¸€ä¸ªç¡®è®¤åºå· ack &#x3D; y+1\nyï¼šæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„éšæœºåºå·\n1ï¼šæœåŠ¡å™¨ç»™å®¢æˆ·ç«¯å‘é€çš„æ•°æ®é‡ï¼ŒæœåŠ¡å™¨ç»™å®¢æˆ·ç«¯å‘é€äº† ACK å’Œ SYN, éƒ½å­˜å‚¨åœ¨è¿™ä¸€ä¸ªå­—èŠ‚ä¸­\n\n\nå‘é€ç»™æœåŠ¡å™¨çš„åºå·å°±æ˜¯ä¸Šä¸€æ¬¡ä»æœåŠ¡å™¨ç«¯æ”¶çš„ç¡®è®¤åºå·å› æ­¤ seq &#x3D; x+1\n\n\næœåŠ¡å™¨ç«¯ï¼šæ¥æ”¶æ•°æ®ï¼Œå¹¶è§£æ tcp åè®®\næŸ¥çœ‹ ACK å¯¹åº”çš„æ ‡å¿—ä½æ˜¯å¦ä¸º 1, å¦‚æœæ˜¯ 1 ä»£è¡¨ï¼Œå®¢æˆ·ç«¯åŒæ„äº†æœåŠ¡å™¨çš„è¿æ¥è¯·æ±‚\næ•°æ®æ ¡éªŒï¼Œç¡®è®¤å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®å®¢æˆ·ç«¯æ”¶åˆ°äº†æ²¡æœ‰ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š\nç»™å®¢æˆ·ç«¯å‘é€çš„æ•°æ®é‡ &#x3D; ç¡®è®¤åºå· - æœåŠ¡å™¨ç”Ÿæˆçš„éšæœºåºå· &#x3D;&#x3D;&#x3D;&gt; 1&#x3D;y+1-y\nå¾—åˆ°å®¢æˆ·ç«¯å‘é€çš„åºå·ï¼šx+1\n\n\n\nwirsharkæŠ“åŒ…åˆ†æ\næœåŠ¡ç«¯ç›‘å¬9999\n\nä¸Šå›¾ä¸ºTCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹\n\nç¬¬ä¸€æ¬¡æ¡æ‰‹\n\nSYNè¯·æ±‚ï¼Œå³å®¢æˆ·ç«¯è¯·æ±‚å»ºç«‹è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°SYN&#x3D;1,seq&#x3D;0  \n\n\nç¬¬äºŒæ¬¡æ¡æ‰‹\n\n[SYN,ACK]è¯·æ±‚ï¼ŒACKè¯´æ˜æœåŠ¡ç«¯å·²ç»åŒæ„äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒSYNè¯´æ˜æœåŠ¡ç«¯è¯·æ±‚å»ºç«‹è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°ACK&#x3D;1,SYN&#x3D;1,seq&#x3D;0,ack&#x3D;1 (ackä¸ºç¡®è®¤åºå·ï¼Œå€¼ä¸ºå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„seq+1ï¼›è¿™é‡Œçš„seqä¸ºæœåŠ¡ç«¯éšæœºç”Ÿæˆçš„åºå·)  \n\n\nç¬¬ä¸‰æ¬¡æ¡æ‰‹\n\n[ACK]è¯·æ±‚ï¼ŒACKè¯´æ˜å®¢æˆ·ç«¯å·²ç»åŒæ„äº†æœåŠ¡ç«¯çš„è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°ACK&#x3D;1,seq&#x3D;0,ack&#x3D;1 (ackä¸ºç¡®è®¤åºå·ï¼Œå€¼ä¸ºæœåŠ¡ç«¯æˆ·ç«¯å‘é€è¿‡æ¥çš„seq+1)  \n\n\n\n","slug":"å…¶ä»–/TCPä¸‰æ¬¡æ¡æ‰‹","date":"2022-11-01T02:29:52.000Z","categories_index":"ç½‘ç»œç›¸å…³","tags_index":"tcp,socket","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e314d67fa76866251074a4c5605dc64d","title":"åŸºäºQtAvåŠffmpegå¼€å‘çš„è§†é¢‘æ’­æ”¾å™¨","content":"åŸºäºQtAvåŠffmpegå¼€å‘çš„è§†é¢‘æ’­æ”¾å™¨ä¸»è¦åŠŸèƒ½ï¼š\næœ¬åœ°åª’ä½“æ–‡ä»¶æ’­æ”¾ï¼Œæ”¯æŒåˆ‡æ¢ä¸Šä¸€ä¸ªä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œæš‚åœ&#x2F;æ¢å¤ï¼Œå¿«æ”¾&#x2F;æ…¢æ”¾ï¼ŒéŸ³é‡æ§åˆ¶\nå…¨å±&#x2F;å–æ¶ˆå…¨å±\næ’­æ”¾åˆ—è¡¨ï¼Œåˆ—è¡¨ç¼©ç•¥å›¾\næ’­æ”¾è¿›åº¦ï¼Œè¿›åº¦æ¡å±•ç¤ºç¼©ç•¥å›¾\nåœ¨çº¿ç”µè§†å°åˆ—è¡¨ï¼Œæ”¯æŒæ‰“å¼€.m3uæ–‡ä»¶ï¼ŒåŠ è½½åœ¨çº¿è§†é¢‘æºåˆ—è¡¨\næ”¯æŒå¤šç”»é¢æ’­æ”¾ï¼Œæ”¯æŒ1,4,6,8,9,16,25,36,49,64ç”»é¢é£æ ¼\næ”¯æŒå¼€å¯æˆ–å…³é—­GPUåŠ é€Ÿ\næ”¯æŒæŠ“æ‹\næ”¯æŒæ”¹å˜ç”»é¢æ¯”ä¾‹\næ”¯æŒæŸ¥çœ‹è§†é¢‘åª’ä½“ä¿¡æ¯\n\n\nä½“éªŒåœ°å€ï¼šhttps://gitee.com/hudejie/QtDemoExe/tree/master/HSYPlayer\n\nç•Œé¢å±•ç¤ºä¸»ç•Œé¢\næ’­æ”¾ç•Œé¢\næ’­æ”¾åˆ—è¡¨\nåœ¨çº¿ç”µè§†å°\nå¤šç”»é¢æ’­æ”¾\næ’­æ”¾ç•Œé¢\nå…¨å±\nGPUåŠ é€Ÿ&amp;æŠ“æ‹\nç”»é¢é£æ ¼åˆ‡æ¢\næ’­æ”¾åˆ—è¡¨ç¼©ç•¥å›¾\nè¿›åº¦æ¡ç¼©ç•¥å›¾\nå¿«æ”¾&amp;æ…¢æ”¾\néŸ³é‡æ§åˆ¶\nåª’ä½“ä¿¡æ¯\n","slug":"Qt/ä½œå“å±•/åŸºäºQtAvåŠffmpegå¼€å‘çš„è§†é¢‘æ’­æ”¾å™¨","date":"2022-10-31T11:37:32.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3fa7b6b4e7b63ef887d3676dae872298","title":"ç¬¬ä¸€ä¸ªQté¡¹ç›®","content":"\nå†™åœ¨å‰é¢\nç›¸å…³åšæ–‡\nä¸ªäººåšå®¢é¦–é¡µ\næ³¨ï¼šå­¦ä¹ äº¤æµä½¿ç”¨ï¼\n\n\næ­£æ–‡\nQt [1]  æ˜¯ä¸€ä¸ª1991å¹´ç”±Qt Companyå¼€å‘çš„è·¨å¹³å°C++å›¾å½¢ç”¨æˆ·ç•Œé¢åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚å®ƒæ—¢å¯ä»¥å¼€å‘GUIç¨‹åºï¼Œä¹Ÿå¯ç”¨äºå¼€å‘éGUIç¨‹åºï¼Œæ¯”å¦‚æ§åˆ¶å°å·¥å…·å’ŒæœåŠ¡å™¨ã€‚Qtæ˜¯é¢å‘å¯¹è±¡çš„æ¡†æ¶ï¼Œä½¿ç”¨ç‰¹æ®Šçš„ä»£ç ç”Ÿæˆæ‰©å±•ï¼ˆç§°ä¸ºå…ƒå¯¹è±¡ç¼–è¯‘å™¨(Meta Object Compiler, moc)ï¼‰ä»¥åŠä¸€äº›å®ï¼ŒQtå¾ˆå®¹æ˜“æ‰©å±•ï¼Œå¹¶ä¸”å…è®¸çœŸæ­£åœ°ç»„ä»¶ç¼–ç¨‹ã€‚2008å¹´ï¼ŒQt Companyç§‘æŠ€è¢«è¯ºåŸºäºšå…¬å¸æ”¶è´­ï¼ŒQtä¹Ÿå› æ­¤æˆä¸ºè¯ºåŸºäºšæ——ä¸‹çš„ç¼–ç¨‹è¯­è¨€å·¥å…·ã€‚2012å¹´ï¼ŒQtè¢«Digiaæ”¶è´­ã€‚2014å¹´4æœˆï¼Œè·¨å¹³å°é›†æˆå¼€å‘ç¯å¢ƒQt Creator 3.1.0æ­£å¼å‘å¸ƒï¼Œå®ç°äº†å¯¹äºiOSçš„å®Œå…¨æ”¯æŒï¼Œæ–°å¢WinRTã€Beautifierç­‰æ’ä»¶ï¼ŒåºŸå¼ƒäº†æ— Pythonæ¥å£çš„GDBè°ƒè¯•æ”¯æŒï¼Œé›†æˆäº†åŸºäºClangçš„C&#x2F;C++ä»£ç æ¨¡å—ï¼Œå¹¶å¯¹Androidæ”¯æŒåšå‡ºäº†è°ƒæ•´ï¼Œè‡³æ­¤å®ç°äº†å…¨é¢æ”¯æŒiOSã€Androidã€WP,å®ƒæä¾›ç»™åº”ç”¨ç¨‹åºå¼€å‘è€…å»ºç«‹è‰ºæœ¯çº§çš„å›¾å½¢ç”¨æˆ·ç•Œé¢æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ã€‚åŸºæœ¬ä¸Šï¼ŒQt åŒ X Window ä¸Šçš„ Motifï¼ŒOpenwinï¼ŒGTK ç­‰å›¾å½¢ç•Œé¢åº“å’Œ Windows å¹³å°ä¸Šçš„ MFCï¼ŒOWLï¼ŒVCLï¼ŒATL æ˜¯åŒç±»å‹çš„ä¸œè¥¿ã€‚ â€“ ç™¾åº¦ç™¾ç§‘\n\næ–°å»ºé¡¹ç›®\né€‰æ‹©æ–°å»ºé¡¹ç›®\n\né€‰æ‹©Qt Widgets Application\n\né€‰æ‹©é¡¹ç›®åç§°åŠé¡¹ç›®è·¯å¾„\n\né€‰æ‹©æ„å»ºå¥—ä»¶ï¼Œå³é‡‡ç”¨é‚£ç§ç¼–è¯‘å™¨ï¼Œwindowsä¸€èˆ¬æœ‰MiniGwä»¥åŠmsvcï¼ŒLinuxä¸‹ä¸€èˆ¬ä¸ºGCC\n\né€‰æ‹©åˆ›å»ºçš„ä¸»çª—å£ç±»ååŠç»§æ‰¿çš„ç±»å‹ï¼Œå¯ä»¥ä¸ºQMainWindowï¼ŒQDialogï¼ŒQWidget\n\nå¯ä»¥é€‰æ‹©éœ€ä¸éœ€è¦åˆ›å»ºuiæ–‡ä»¶ï¼Œuiæ–‡ä»¶å³å¯ä½¿ç”¨Qt Uiå·¥å…·ç›´æ¥ç¼–è¾‘ç•Œé¢ï¼Œå‰æœŸå¯ä»¥ä½¿ç”¨æ­¤ç§\n\nåˆ›å»ºå®Œæˆçš„é¡¹ç›®\n\n\nç¼–è¯‘è¿è¡Œ\nä½¿ç”¨å·¦ä¸‹è§’ä¸‰ä¸ªæŒ‰é’®å³å¯ç¼–è¯‘è¿è¡Œé¡¹ç›®ï¼Œåˆ†åˆ«ä¸ºè¿è¡Œï¼Œè°ƒè¯•ï¼Œç¼–è¯‘\n\nè¿è¡Œå®Œæˆç•Œé¢\n\n\nç®€å•å±•ç¤ºHello World\nåŒå‡»mainwindow.uiæ–‡ä»¶ï¼Œæ‰“å¼€è®¾è®¡æ¨¡å¼\n\næ‹–åŠ¨ä¸€ä¸ªlabelåˆ°ç•Œé¢ï¼Œç„¶ååŒå‡»å¯ä¿®æ”¹æ–‡å­—å†…å®¹\n\nç¼–è¯‘ï¼Œè¿è¡Œå®Œæˆç•Œé¢\n\nè‡³æ­¤ç¬¬ä¸€ä¸ªQtç¨‹åºåˆ›å»ºå®Œæˆï¼Œæ­å–œä½ å·²ç»è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ï¼Œæ¥ä¸‹æ¥ä¸€èµ·å­¦ä¹ Qtçš„å„ç§é«˜çº§ç”¨æ³•å§ã€‚\n\n\n\näº¤ä¸ªæœ‹å‹\nGiteeé¦–é¡µ\n\n\nç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œé˜¿æœ¨å¤§å”ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/ç¬¬ä¸€ä¸ªQté¡¹ç›®","date":"2022-10-28T08:09:33.000Z","categories_index":"Qtå…¥é—¨æŒ‡å—","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"61b7d43740d88aadb9a85687e42c152b","title":"libcurlç¼–è¯‘åŠä½¿ç”¨","content":"","slug":"å…¶ä»–/libcurlç¼–è¯‘åŠä½¿ç”¨","date":"2022-10-28T03:31:25.000Z","categories_index":"","tags_index":"","author_index":"é˜¿æœ¨å¤§å”"},{"id":"8577172d587822c13c6c2f341014a5ff","title":"Markdownè¯­æ³•","content":"å½“ä¸‹ï¼ŒMarkdown æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„è½»é‡çº§æ ‡è®°è¯­è¨€ï¼Œç”¨äºåœ¨Webä¸­ä¹¦å†™æ–‡æ¡£ï¼ŒåŒæ—¶åº”ç”¨äºè®¸å¤šä¸åŒçš„åœºæ™¯ã€‚å®ƒæ—¨åœ¨ç®€åŒ–å‘å¸ƒæ–‡æœ¬å†…å®¹çš„è¿‡ç¨‹ï¼Œå¹¶å‡å°‘åœ¨æ’°å†™æ–‡æ¡£æ—¶çš„æ ¼å¼è½¬æ¢çš„éœ€è¦ã€‚Markdown ä¼˜ç‚¹å¾ˆå¤šï¼ŒåŒ…æ‹¬æ˜“å­¦æ˜“ç”¨ã€æ˜“äºæŒæ¡å’Œäº¤æµã€è·¨å¹³å°å¯ç”¨æ€§ç­‰ç­‰ã€‚\nMarkdown æ ¸å¿ƒè¯­æ³•\næ ‡é¢˜ï¼šé€šè¿‡ä½¿ç”¨ # ç¬¦å·å³å¯åˆ›å»ºæ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š\n\n1234# ä¸€çº§æ ‡é¢˜## äºŒçº§æ ‡é¢˜### ä¸‰çº§æ ‡é¢˜...\n\n\næ–œä½“å’ŒåŠ ç²—ï¼šå¯ä»¥ä½¿ç”¨ * æˆ– _ ç¬¦å·å°†æ–‡æœ¬åŒ…è£¹èµ·æ¥å®ç°ï¼Œä¾‹å¦‚ï¼š\n\n12*æ–œä½“* æˆ–è€… _æ–œä½“_**åŠ ç²—** æˆ–è€… __åŠ ç²—__\n\n\nå¼•ç”¨ï¼šå¯ä»¥ä½¿ç”¨ &gt; ç¬¦å·å¼•ç”¨æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š\n\n1&gt; è¿™æ˜¯å¼•ç”¨çš„æ–‡æœ¬ã€‚\n\n\nåˆ—è¡¨ï¼šå¯ä»¥é€šè¿‡ç¬¦å· *, -, + æ¥åˆ›å»ºæ— åºåˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­—æ¥åˆ›å»ºæœ‰åºåˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š\n\n1234- æ— åºåˆ—è¡¨é¡¹1- æ— åºåˆ—è¡¨é¡¹21. æœ‰åºåˆ—è¡¨é¡¹12. æœ‰åºåˆ—è¡¨é¡¹2\n\n\né“¾æ¥å’Œå›¾ç‰‡ï¼šå¯ä»¥ä½¿ç”¨ [] å’Œ () æ¥åˆ›å»ºé“¾æ¥å’Œå›¾ç‰‡ã€‚ä¾‹å¦‚ï¼š\n\n12[é“¾æ¥æ–‡å­—](é“¾æ¥åœ°å€)![å›¾ç‰‡æè¿°](å›¾ç‰‡åœ°å€)\n\n\nä»£ç å—ï¼šå¯ä»¥ç”¨ &#96;&#96;&#96; åŒ…è£¹ä¸€æ®µä»£ç åˆ›å»ºä»£ç å—ï¼Œä¾‹å¦‚ï¼š\n\n123â€‹```javascriptconsole.log(&#x27;Hello, world!&#x27;);â€‹```\n\nMarkdown æ‰©å±•è¯­æ³•é™¤äº†æ ¸å¿ƒè¯­æ³•ï¼ŒMarkdown è¿˜æœ‰ä¸€äº›æ‰©å±•è¯­æ³•æ¥ä¸°å¯Œæ–‡æœ¬æ ¼å¼ã€‚\n\nè¡¨æ ¼ï¼šå¯ä»¥ä½¿ç”¨ç«–çº¿ | å’Œè¿å­—ç¬¦ - æ¥åˆ›å»ºè¡¨æ ¼ï¼Œä¾‹å¦‚ï¼š\n\n1234| å§“å | å¹´é¾„ || ---- | ---- || å¼ ä¸‰ | 20   || æå›› | 22   |\n\n\nåˆ†å‰²çº¿ï¼šä½¿ç”¨3ä¸ªæˆ–3ä¸ªä»¥ä¸Šçš„-ã€*ã€_å¯ä»¥åˆ›å»ºåˆ†å‰²çº¿ã€‚\n\n1---\n\n\nè„šæ³¨ï¼šå¯ä»¥ä½¿ç”¨[^]æ¥åˆ›å»ºè„šæ³¨ï¼Œä¾‹å¦‚ï¼š\n\n12è¿™æ˜¯ä¸€ä¸ªè„šæ³¨[^1][^1]: è¿™æ˜¯è„šæ³¨çš„æ–‡æœ¬ã€‚\n\n\nåˆ é™¤çº¿ï¼šå¯ä»¥ä½¿ç”¨ ~~ æ ‡è®°åˆ’æ‰çš„æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š\n\n1~~åˆ é™¤çš„æ–‡æœ¬~~\n\nä»¥ä¸Šå°±æ˜¯å¸¸ç”¨çš„ Markdown è¯­æ³•å’Œæ‰©å±•è¯­æ³•ï¼ŒæŒæ¡è¿™äº›åŸºç¡€çŸ¥è¯†åå°±å¯ä»¥å¼€å§‹ä¹¦å†™ Markdown æ–‡æ¡£å•¦ï¼\n","slug":"å…¶ä»–/Markdownè¯­æ³•","date":"2022-10-04T03:34:06.000Z","categories_index":"å…¶ä»–æ•™ç¨‹","tags_index":"Markdown","author_index":"é˜¿æœ¨å¤§å”"},{"id":"f8bc6db07820d29668bd8d1363592c13","title":"Qtå¼€å‘åŠ è§£å¯†è½¯ä»¶","content":"Qtå¼€å‘åŠ è§£å¯†è½¯ä»¶Qtå¼€å‘çš„æç®€çš„ï¼Œè·¨å¹³å°çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹åŠ å¯†å·¥å…·ï¼Œé‡‡ç”¨AES-256åŠ å¯†ç®—æ³•ã€‚ç•Œé¢æ¨¡ä»¿çš„Encryptoï¼Œé‡‡ç”¨æç®€é£æ ¼ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n   å‰è¨€ä¾‹å¦‚ï¼šéšç€äººå·¥æ™ºèƒ½çš„ä¸æ–­å‘å±•ï¼Œæœºå™¨å­¦ä¹ è¿™é—¨æŠ€æœ¯ä¹Ÿè¶Šæ¥è¶Šé‡è¦ï¼Œå¾ˆå¤šäººéƒ½å¼€å¯äº†å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Œæœ¬æ–‡å°±ä»‹ç»äº†æœºå™¨å­¦ä¹ çš„åŸºç¡€å†…å®¹ã€‚\n\nä¸€ã€FileEncrypteræ˜¯ä»€ä¹ˆï¼ŸFileEncrypteræ˜¯ä¸€ä¸ªå…è´¹çš„ï¼Œæç®€çš„ï¼Œè·¨å¹³å°çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹åŠ å¯†å·¥å…·ï¼Œæ”¯æŒWindowsï¼ŒLinuxç­‰ç³»ç»Ÿã€‚ä½¿ç”¨è¯¥å·¥å…·å¯ä»¥è½»æ¾çš„å¯¹æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹è¿›è¡ŒåŠ å¯†ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œè·å–åˆ°åŠ å¯†æ–‡ä»¶ä¹‹åï¼Œä½¿ç”¨å¯¹åº”çš„å¯†ç å³å¯å¯¹æ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œå¹¶æŸ¥çœ‹æ–‡ä»¶å†…å®¹ã€‚\nEncryptoåº”ç”¨ç¨‹åºä½¿ç”¨AES-256åŠ å¯†ï¼Œå…è®¸æ‚¨å‘å…¶ä»–äººå‘é€éå¸¸ç§äººçš„æ¶ˆæ¯å’Œæ–‡ä»¶ã€‚è¯¥å·¥å…·æœ€åˆæ˜¯ä¸ºè‹¹æœè®¾å¤‡å¼€å‘çš„ï¼Œä½†è¯¥è½¯ä»¶åœ¨Macå’ŒWindowsè®¾å¤‡ä¸Šè¿è¡Œè‰¯å¥½ã€‚åˆ›å»ºæ­¤åº”ç”¨ç¨‹åºæ˜¯ä¸ºäº†å¸®åŠ©äººä»¬åœ¨å‘é€æ–‡ä»¶ä¹‹å‰å¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼Œä½†æ‚¨ä¸å¿…å°†æ–‡ä»¶å‘é€åˆ°ä»»ä½•åœ°æ–¹ã€‚ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ å¯†ä½ çš„æ–‡ä»¶å¹¶æŠŠå®ƒä»¬ç•™åœ¨ä½ çš„è®¡ç®—æœºä¸Šã€‚\nFileEncrypteråŠ å¯†åé™¤äº†æœ¬èº«å¯†ç è§£å¯†å¤–ï¼Œæ— ä»»ä½•å…¶ä»–æ–¹å¼èƒ½è§£å¯†ï¼Œæ‰€ä»¥è¯·ç‰¢è®°å¯†ç ï¼Œå¦‚å¿˜è®°å¯†ç ï¼Œå¯å‚è€ƒåŠ å¯†æ—¶å¡«å†™çš„æç¤ºä¿¡æ¯ã€‚\näºŒã€ä½¿ç”¨æ­¥éª¤1.ç•Œé¢å±•ç¤ºè¯¦æƒ…è§CSDNåšå®¢\n\næ€»ç»“ä¾‹å¦‚ï¼šä»¥ä¸Šå°±æ˜¯ä»Šå¤©è¦è®²çš„å†…å®¹ï¼Œæœ¬æ–‡ä»…ä»…ç®€å•ä»‹ç»äº†FileEncrypterçš„ä½¿ç”¨ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç§èŠæˆ‘ã€‚\næ›´å¤šå¼€æºé¡¹ç›®è§CSDN\n","slug":"Qt/ä½œå“å±•/Qtå¼€å‘åŠ è§£å¯†è½¯ä»¶","date":"2022-06-20T08:40:04.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"9f7b90ca802128164406072bd8f29e21","title":"ä»€ä¹ˆæ˜¯QWebEngineViewå’ŒQWebChannelï¼Ÿ","content":"å½“æ‚¨å‡†å¤‡å¼€å‘ä¸€ä¸ªç°ä»£åŒ–çš„Webåº”ç”¨ç¨‹åºæ—¶ï¼ŒQWebEngineViewå’ŒQWebChannelæ˜¯ä¸¤ä¸ªé‡è¦çš„Qtç»„ä»¶ã€‚è¿™ç¯‡åšå®¢å°†ä¼šç»™æ‚¨ä»‹ç»å®ƒä»¬çš„ç”¨é€”ï¼Œä»¥åŠå¦‚ä½•åœ¨æ‚¨çš„Qtä»£ç ä¸­ä½¿ç”¨å®ƒä»¬ã€‚\nQWebEngineViewæ˜¯ä»€ä¹ˆï¼ŸQWebEngineViewæ˜¯ä¸€ä¸ªåŸºäºChromiumå¼•æ“çš„Qtç»„ä»¶ï¼Œç”¨äºå‘ˆç°å’Œäº¤äº’Webé¡µé¢ã€‚å½“æ‚¨éœ€è¦åœ¨Qtåº”ç”¨ç¨‹åºä¸­åµŒå…¥Webå†…å®¹æ—¶ï¼ŒQWebEngineViewä¼šå¾ˆæœ‰ç”¨ã€‚å®ƒæä¾›äº†ä¸€äº›ä¾¿åˆ©çš„æ–¹æ³•æ¥åŠ è½½ã€å¯¼èˆªå’Œæ“ä½œWebé¡µé¢ï¼Œæ¯”å¦‚ï¼š\n12QWebEngineView *view = new QWebEngineView(this);view-&gt;load(QUrl(&quot;https://www.example.com&quot;));\n\nä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªQWebEngineViewå¯¹è±¡ï¼Œå¹¶é€šè¿‡loadæ–¹æ³•å°†å…¶è½½å…¥æŒ‡å®šçš„URLã€‚å¦‚æœæ‚¨å¸Œæœ›æ•è·Webé¡µé¢çš„æˆªå›¾æˆ–è¾“å‡ºHTMLæºä»£ç ç­‰æ“ä½œï¼ŒQWebEngineViewä¹Ÿæä¾›äº†ç›¸åº”çš„APIå®ç°ã€‚\nQWebChannelæ˜¯ä»€ä¹ˆï¼ŸQWebChannelæ˜¯å¦ä¸€ä¸ªQtç»„ä»¶ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•çš„æœºåˆ¶æ¥åœ¨Webé¡µé¢å’ŒQtåº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚åœ¨ä½¿ç”¨QWebChannelæ—¶ï¼Œæ‚¨å¯ä»¥ä»JavaScriptä»£ç ä¸­è°ƒç”¨Qtå¯¹è±¡çš„æ–¹æ³•ï¼Œæˆ–è€…é€šè¿‡Qtå¯¹è±¡æ¥æ”¶æ¥è‡ªWebé¡µé¢çš„äº‹ä»¶å’Œæ•°æ®ã€‚\nä¸ºäº†ä½¿ç”¨QWebChannelï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n\nå°†ä¸€ä¸ªQWebChannelå¯¹è±¡é™„åŠ åˆ°QWebEngineViewä¸Šã€‚\nåœ¨Qtä»£ç ä¸­å£°æ˜ä¸€ä¸ªQObjectæ´¾ç”Ÿç±»ï¼Œå¹¶ä½¿ç”¨QWebChannel::registerObjectæ–¹æ³•å°†å…¶æ³¨å†Œåˆ°QWebChannelå¯¹è±¡ä¸­ã€‚\nåœ¨Webé¡µé¢ä¸­ï¼Œä½¿ç”¨qt.webChannelTransportå¯¹è±¡æ¥è¿æ¥åˆ°QWebChannelï¼Œå¹¶é€šè¿‡qt.webChannel.objectsæ•°ç»„è®¿é—®å·²æ³¨å†Œçš„Qtå¯¹è±¡ã€‚\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨Qtåº”ç”¨ç¨‹åºå’ŒWebé¡µé¢ä¹‹é—´äº¤æ¢æ•°æ®ï¼š\nmain.cpp\n1234567891011121314151617181920212223242526272829303132333435363738#include &lt;QApplication&gt;#include &lt;QDebug&gt;#include &lt;QObject&gt;#include &lt;QWebEngineView&gt;#include &lt;QWebChannel&gt;class MyObject : public QObject&#123;    Q_OBJECTpublic slots:    void onMessage(const QString &amp;message)    &#123;        qDebug() &lt;&lt; &quot;Received message from web page:&quot; &lt;&lt; message;    &#125;&#125;;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    // åˆ›å»ºQWebEngineViewå¯¹è±¡å¹¶æ·»åŠ åˆ°ä¸»çª—å£ä¸­    QWebEngineView *view = new QWebEngineView();    view-&gt;setUrl(QUrl(&quot;qrc:///index.html&quot;));    // åˆ›å»ºQWebChannelå¯¹è±¡å¹¶é™„åŠ åˆ°QWebEngineViewå¯¹è±¡ä¸Š    QWebChannel *channel = new QWebChannel(view);    view-&gt;page()-&gt;setWebChannel(channel);    // åœ¨Qtä»£ç ä¸­åˆ›å»ºMyObjectå¯¹è±¡ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°QWebChannelå¯¹è±¡ä¸­    MyObject myObject;    channel-&gt;registerObject(QStringLiteral(&quot;myObject&quot;), &amp;myObject);    view-&gt;show();    return app.exec();&#125;#include &quot;main.moc&quot;\n\nindex.html\n1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;QWebChannel Example&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;QWebChannel Example&lt;/h1&gt;    &lt;button onclick=&quot;sendMessage()&quot;&gt;Send Message to Qt&lt;/button&gt;    &lt;script type=&quot;text/javascript&quot; src=&quot;qrc:///qtwebchannel/qwebchannel.js&quot;&gt;&lt;/script&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        // è¿æ¥åˆ°QWebChannelå¹¶è·å–å·²æ³¨å†Œçš„Qtå¯¹è±¡        var webChannel = new QWebChannel(qt.webChannelTransport, function(channel) &#123;            var myObject = channel.objects.myObject;            // åœ¨ç‚¹å‡»æŒ‰é’®æ—¶è°ƒç”¨MyObjectå¯¹è±¡çš„onMessageæ–¹æ³•            function sendMessage() &#123;                myObject.onMessage(&quot;Hello from Web&quot;);            &#125;        &#125;);    &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºMyObjectçš„QObjectæ´¾ç”Ÿç±»ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°äº†ä¸€ä¸ªåä¸ºmyObjectçš„å¯¹è±¡åä¸Šã€‚Webé¡µé¢ä¸­çš„JavaScriptä»£ç ä½¿ç”¨qt.webChannelTransportè¿æ¥åˆ°äº†QWebChannelï¼Œç„¶åé€šè¿‡qt.webChannel.objects.myObjectè®¿é—®äº†å·²æ³¨å†Œçš„Qtå¯¹è±¡ã€‚å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒWebé¡µé¢ä¸Šçš„JavaScriptè°ƒç”¨äº†myObject.onMessage(&quot;Hello from Web&quot;)ï¼Œè¿™ä¸ªè°ƒç”¨ä¼šè§¦å‘Qtå¯¹è±¡ä¸­çš„onMessageæ–¹æ³•ï¼Œå¹¶è¾“å‡ºä¸€æ¡æ¶ˆæ¯åˆ°æ§åˆ¶å°ã€‚\nåœ¨QWebEngineViewä¸­ä½¿ç”¨QWebChannelåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨QWebChannelåœ¨Qtåº”ç”¨ç¨‹åºå’ŒWebé¡µé¢ä¹‹é—´äº¤æ¢æ•°æ®ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨QWebEngineViewä¸­ä½¿ç”¨QWebChannelæ¥æ§åˆ¶Webé¡µé¢çš„è¡Œä¸ºã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„QObjectæ´¾ç”Ÿç±»ï¼Œä»¥ä¾¿å°†å…¶æ³¨å†Œåˆ°QWebChannelä¸­ï¼š\n1234567891011class WebController : public QObject&#123;    Q_OBJECTpublic slots:    void setButtonStyle(const QString &amp;style);    void setLabelStyle(const QString &amp;style);private:    QWebEnginePage *m_page;&#125;;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸¤ä¸ªæ§½å‡½æ•°ï¼šsetButtonStyleå’ŒsetLabelStyleã€‚è¿™äº›æ§½å‡½æ•°å°†é€šè¿‡QWebChannelæš´éœ²ç»™Webé¡µé¢çš„JavaScriptä»£ç ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€ä¸ªæŒ‡å‘QWebEnginePageå¯¹è±¡çš„æŒ‡é’ˆï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»æ§½å‡½æ•°ä¸­ç›´æ¥æ“ä½œWebé¡µé¢äº†ã€‚\næˆ‘ä»¬çš„ä¸‹ä¸€æ­¥æ˜¯å°†è¿™ä¸ªæ–°å¯¹è±¡æ³¨å†Œåˆ°QWebChannelä¸­ï¼š\n1234QWebChannel *channel = new QWebChannel(view-&gt;page());WebController *controller = new WebController();controller-&gt;setPage(view-&gt;page());channel-&gt;registerObject(QStringLiteral(&quot;webController&quot;), controller);\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†WebControllerå¯¹è±¡æ³¨å†Œä¸ºwebControllerå¯¹è±¡ï¼Œç„¶åå°†å…¶é™„åŠ åˆ°äº†QWebChannelå¯¹è±¡ä¸­ã€‚\nç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Webé¡µé¢ä¸­æ·»åŠ ä¸€äº›JavaScriptä»£ç æ¥è¿æ¥åˆ°QWebChannelï¼Œå¹¶ä½¿ç”¨webControllerå¯¹è±¡ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­ï¼š\n12345new QWebChannel(qt.webChannelTransport, function (channel) &#123;    var webController = channel.objects.webController;    webController.setButtonStyle(&quot;background-color: blue; color: white;&quot;);    webController.setLabelStyle(&quot;font-weight: bold;&quot;);&#125;);\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨QWebChannelå¯¹è±¡ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„JavaScriptå¯¹è±¡ï¼Œå¹¶é€šè¿‡channel.objects.webControllerè®¿é—®äº†å·²ç»æ³¨å†Œçš„WebControllerå¯¹è±¡ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨äº†setButtonStyleå’ŒsetLabelStyleæ§½å‡½æ•°ï¼Œä»è€Œæ”¹å˜äº†Webé¡µé¢ä¸Šçš„æŒ‰é’®å’Œæ ‡ç­¾æ ·å¼ã€‚\nç»“è®ºåœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†Qtæ¡†æ¶ä¸­ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„ç»„ä»¶ï¼šQWebEngineViewå’ŒQWebChannelã€‚QWebEngineViewå¯ä»¥å¸®åŠ©æ‚¨å°†Webå†…å®¹åµŒå…¥åˆ°æ‚¨çš„Qtåº”ç”¨ç¨‹åºä¸­ï¼Œè€ŒQWebChannelåˆ™å…è®¸æ‚¨åœ¨Qtä»£ç å’ŒWebé¡µé¢ä¹‹é—´äº¤æ¢æ•°æ®ã€‚è¿™äº›ç»„ä»¶éå¸¸å®¹æ˜“ä½¿ç”¨ï¼Œè€Œä¸”å¯ä»¥å¸®åŠ©æ‚¨æ„å»ºå‡ºæ›´åŠ ç°ä»£åŒ–ã€åŠŸèƒ½æ›´åŠ å¼ºå¤§çš„Qtåº”ç”¨ç¨‹åºã€‚\né™¤äº†ä¸Šè¿°æåˆ°çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼ŒQWebEngineViewå’ŒQWebChannelè¿˜æœ‰è®¸å¤šå…¶ä»–ä½¿ç”¨æŠ€å·§å’Œæ³¨æ„äº‹é¡¹ã€‚ä¸‹é¢æ˜¯ä¸€äº›éœ€è¦ç‰¹åˆ«æ³¨æ„çš„é—®é¢˜ï¼š\n\nåœ¨Qt5.6åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼ŒQWebChannelå·²ç»è¢«ç§»åŠ¨åˆ°äº†QtWebChannelåº“ä¸­ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨QWebChannelæ—¶ï¼Œéœ€è¦åœ¨.proæ–‡ä»¶ä¸­æ·»åŠ QT += webchannelã€‚\n\nå»ºè®®ä¸è¦å°†QWebEngineViewå¯¹è±¡å’ŒQWebChannelå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç›´æ¥ç»‘å®šåœ¨æŸä¸ªç‰¹å®šçš„QWidgetæˆ–QObjectå¯¹è±¡ä¸Šã€‚å¦‚æœå¿…é¡»è¿™æ ·åšï¼Œè¯·ç¡®ä¿åœ¨é”€æ¯çˆ¶å¯¹è±¡ä¹‹å‰å…ˆé”€æ¯QWebEngineViewå’ŒQWebChannelå¯¹è±¡ã€‚\n\nå¯ä»¥è€ƒè™‘ä½¿ç”¨JavaScript Promise APIæ¥ç®¡ç†å¤æ‚çš„å¼‚æ­¥æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨åŠ è½½Webé¡µé¢æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Promise APIæ¥ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆåå†æ‰§è¡Œåç»­æ“ä½œã€‚\n\nå¦‚æœWebé¡µé¢éœ€è¦ä¸å¤–éƒ¨æœåŠ¡è¿›è¡Œäº¤äº’ï¼ˆä¾‹å¦‚é€šè¿‡AJAXè¯·æ±‚æ•°æ®ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨Qtæ¡†æ¶ä¸­æä¾›çš„ç½‘ç»œAPIæ¥å®ç°ã€‚\n\nå¦‚æœéœ€è¦åœ¨Webé¡µé¢ä¸­ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹JavaScriptåº“ï¼ˆä¾‹å¦‚jQueryã€Reactç­‰ï¼‰ï¼Œåˆ™å¯ä»¥å°†è¿™äº›åº“ä½œä¸ºé™æ€èµ„æºæ‰“åŒ…åˆ°Qtåº”ç”¨ç¨‹åºä¸­ï¼Œå¹¶ä½¿ç”¨qrc: URLæ¥å¼•ç”¨ã€‚\n\n\næ€»è€Œè¨€ä¹‹ï¼ŒQWebEngineViewå’ŒQWebChannelä¸ºå¼€å‘äººå‘˜æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„å·¥å…·æ¥æ„å»ºç°ä»£åŒ–çš„Qtåº”ç”¨ç¨‹åºã€‚æ— è®ºæ‚¨æ˜¯æƒ³è¦åµŒå…¥Webå†…å®¹ï¼Œè¿˜æ˜¯éœ€è¦åœ¨Qtä»£ç å’ŒWebé¡µé¢ä¹‹é—´äº¤æ¢æ•°æ®ï¼ŒQWebEngineViewå’ŒQWebChanneléƒ½å¯ä»¥å¸®åŠ©æ‚¨è½»æ¾å®ç°ã€‚\nå®Œæ•´ä»£ç ç¤ºä¾‹æœ€åï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•åœ¨Qtåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨QWebEngineViewå’ŒQWebChannelã€‚è¿™ä¸ªä¾‹å­åŒ…å«äº†ä¸‰ä¸ªæ–‡ä»¶ï¼š\n\nmain.cppï¼šåº”ç”¨ç¨‹åºå…¥å£ï¼Œåˆ›å»ºä¸»çª—å£å¹¶åŠ è½½Webé¡µé¢ã€‚\nwebcontroller.hå’Œwebcontroller.cppï¼šå®šä¹‰äº†WebControllerç±»ï¼Œå®ƒæ˜¯æˆ‘ä»¬å‘QWebChannelæ³¨å†Œçš„QObjectæ´¾ç”Ÿç±»ã€‚\n\nmain.cpp\n1234567891011121314151617181920212223242526#include &lt;QApplication&gt;#include &lt;QDebug&gt;#include &lt;QObject&gt;#include &lt;QWebEngineView&gt;#include &lt;QWebChannel&gt;#include &quot;webcontroller.h&quot;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    // åˆ›å»ºQWebEngineViewå¯¹è±¡å¹¶æ·»åŠ åˆ°ä¸»çª—å£ä¸­    QWebEngineView *view = new QWebEngineView();    view-&gt;setUrl(QUrl(&quot;qrc:///index.html&quot;));    // åˆ›å»ºQWebChannelå¯¹è±¡å¹¶é™„åŠ åˆ°QWebEngineViewå¯¹è±¡ä¸Š    QWebChannel *channel = new QWebChannel(view-&gt;page());    WebController *controller = new WebController();    controller-&gt;setPage(view-&gt;page());    channel-&gt;registerObject(QStringLiteral(&quot;webController&quot;), controller);    view-&gt;page()-&gt;setWebChannel(channel);    view-&gt;show();    return app.exec();&#125;\n\nwebcontroller.h\n12345678910111213141516171819#ifndef WEBCONTROLLER_H#define WEBCONTROLLER_H#include &lt;QObject&gt;#include &lt;QWebEnginePage&gt;class WebController : public QObject&#123;    Q_OBJECTpublic slots:    void setButtonStyle(const QString &amp;style);    void setLabelStyle(const QString &amp;style);private:    QWebEnginePage *m_page;&#125;;#endif // WEBCONTROLLER_H\n\nwebcontroller.cpp\n12345678910111213141516#include &quot;webcontroller.h&quot;void WebController::setButtonStyle(const QString &amp;style)&#123;    m_page-&gt;runJavaScript(QString(&quot;document.getElementById(&#x27;myButton&#x27;).style=&#x27;%1&#x27;&quot;).arg(style));&#125;void WebController::setLabelStyle(const QString &amp;style)&#123;    m_page-&gt;runJavaScript(QString(&quot;document.getElementById(&#x27;myLabel&#x27;).style=&#x27;%1&#x27;&quot;).arg(style));&#125;void WebController::setPage(QWebEnginePage *page)&#123;    m_page = page;&#125;\n\nindex.html\n12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;QWebChannel Example&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;QWebChannel Example&lt;/h1&gt;    &lt;button id=&quot;myButton&quot; onclick=&quot;sendMessage()&quot;&gt;Send Message to Qt&lt;/button&gt;    &lt;br&gt;&lt;br&gt;    &lt;label id=&quot;myLabel&quot;&gt;This is a label&lt;/label&gt;    &lt;br&gt;&lt;br&gt;    &lt;input type=&quot;text&quot; id=&quot;myInput&quot;&gt;    &lt;br&gt;&lt;br&gt;    &lt;script type=&quot;text/javascript&quot; src=&quot;qrc:///qtwebchannel/qwebchannel.js&quot;&gt;&lt;/script&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        // è¿æ¥åˆ°QWebChannelå¹¶è·å–å·²æ³¨å†Œçš„Qtå¯¹è±¡        new QWebChannel(qt.webChannelTransport, function (channel) &#123;            var webController = channel.objects.webController;            webController.setButtonStyle(&quot;background-color: blue; color: white;&quot;);            webController.setLabelStyle(&quot;font-weight: bold;&quot;);            // å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œè°ƒç”¨MyObjectå¯¹è±¡çš„onMessageæ–¹æ³•            function sendMessage() &#123;                var inputValue = document.getElementById(&quot;myInput&quot;).value;                alert(&quot;You entered: &quot; + inputValue);            &#125;        &#125;);    &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„Webé¡µé¢ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæŒ‰é’®ã€ä¸€ä¸ªæ ‡ç­¾å’Œä¸€ä¸ªæ–‡æœ¬æ¡†ã€‚å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒJavaScriptä»£ç ä¼šé€šè¿‡QWebChannelå¯¹è±¡è°ƒç”¨setButtonStyleå’ŒsetLabelStyleæ–¹æ³•ï¼Œä»è€Œæ”¹å˜æŒ‰é’®å’Œæ ‡ç­¾çš„æ ·å¼ã€‚åŒæ—¶ï¼ŒJavaScriptä»£ç è¿˜ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæ˜¾ç¤ºç”¨æˆ·åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥çš„å†…å®¹ã€‚\næ€»ä¹‹ï¼ŒQWebEngineViewå’ŒQWebChannelæ˜¯éå¸¸æœ‰ç”¨çš„Qtç»„ä»¶ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æ‚¨æ„å»ºå‡ºç°ä»£åŒ–ã€åŠŸèƒ½ä¸°å¯Œçš„Qtåº”ç”¨ç¨‹åºï¼Œè®©æ‚¨çš„åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»ã€å¯æ‰©å±•ã€‚\nå‚è€ƒèµ„æ–™å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºQWebEngineViewå’ŒQWebChannelçš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å®˜æ–¹æ–‡æ¡£ï¼š\n\nQt WebEngine\nQt WebChannel\n\næ­¤å¤–ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…¶ä»–æœ‰ç”¨çš„èµ„æºï¼š\n\nQWebEngineViewå®ç°Qtä¸Webçš„äº¤äº’\nUsing QWebChannel to expose C++ objects to JavaScript\nCreating a simple browser with QtWebEngine\nIntegrating HTML and QML Using the Qt WebEngine\n\né€šè¿‡è¿™äº›èµ„æ–™ï¼Œæ‚¨å¯ä»¥æ·±å…¥äº†è§£å¦‚ä½•åœ¨Qtåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨QWebEngineViewå’ŒQWebChannelï¼Œå¹¶å­¦ä¹ å¦‚ä½•æ„å»ºå‡ºç°ä»£åŒ–ã€åŠŸèƒ½ä¸°å¯Œçš„Qtåº”ç”¨ç¨‹åºã€‚\næ€»ç»“åœ¨æœ¬ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†Qtæ¡†æ¶ä¸­ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„ç»„ä»¶ï¼šQWebEngineViewå’ŒQWebChannelã€‚QWebEngineViewå¯ä»¥å¸®åŠ©æ‚¨å°†Webå†…å®¹åµŒå…¥åˆ°æ‚¨çš„Qtåº”ç”¨ç¨‹åºä¸­ï¼Œè€ŒQWebChannelåˆ™å…è®¸æ‚¨åœ¨Qtä»£ç å’ŒWebé¡µé¢ä¹‹é—´äº¤æ¢æ•°æ®ã€‚\næˆ‘ä»¬é¦–å…ˆæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨QWebEngineViewåœ¨Qtåº”ç”¨ç¨‹åºä¸­åŠ è½½Webé¡µé¢ï¼Œå¹¶ä¸”å¦‚ä½•åˆ©ç”¨JavaScriptä»£ç ä¸é¡µé¢è¿›è¡Œäº¤äº’ã€‚ç„¶åï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨QWebChannelå®ç°Qtä»£ç ä¸Webé¡µé¢ä¹‹é—´çš„åŒå‘é€šä¿¡ï¼Œä»è€Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»ã€å¯æ‰©å±•ã€‚\næœ€åï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•åœ¨Qtåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨QWebEngineViewå’ŒQWebChannelã€‚é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæ‚¨å¯ä»¥æ·±å…¥äº†è§£QWebEngineViewå’ŒQWebChannelçš„ä½¿ç”¨æ–¹æ³•ï¼Œå¹¶å­¦ä¹ å¦‚ä½•æ„å»ºå‡ºç°ä»£åŒ–ã€åŠŸèƒ½ä¸°å¯Œçš„Qtåº”ç”¨ç¨‹åºã€‚\nå¸Œæœ›æœ¬ç¯‡åšå®¢èƒ½å¤Ÿå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä»€ä¹ˆæ˜¯QWebEngineViewå’ŒQWebChannelï¼Ÿ","date":"2021-11-24T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"03e99f8ee62e69d3f5234649fa8dbb9f","title":"Qt çº¿ç¨‹æ± ","content":"Qt çº¿ç¨‹æ± Qt çº¿ç¨‹æ± æ˜¯ Qt åº“ä¸­ç”¨äºä»»åŠ¡å¼‚æ­¥æ‰§è¡Œçš„å·¥å…·ç±»ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•æ–¹ä¾¿çš„æ–¹å¼æ¥ç®¡ç†å¤šçº¿ç¨‹å¹¶å‘å¤„ç†ã€‚æœ¬ç¯‡æ–‡ç« å°†ä¼šä»‹ç» Qt çº¿ç¨‹æ± çš„æ¦‚å¿µåŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚\nä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿçº¿ç¨‹æ± æ˜¯ä¸€ä¸ªé¢„å…ˆåˆ›å»ºå¥½ä¸€ç»„çº¿ç¨‹ï¼Œå°†å¯ç”¨çº¿ç¨‹ä¿å­˜åœ¨å†…å­˜æ± ä¸­ï¼Œç­‰å¾…æ¥è‡ªä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡è¯·æ±‚ï¼Œä¸€æ—¦æœ‰ä»»åŠ¡åˆ°è¾¾å°±ä¼šè‡ªåŠ¨åˆ†é…ç©ºé—²çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡åå¹¶ä¸ä¼šè¢«ç«‹å³é”€æ¯è€Œæ˜¯é‡æ–°è¿”å›çº¿ç¨‹æ± ä¸­ç­‰å¾…ä¸‹æ¬¡ä»»åŠ¡è°ƒåº¦ã€‚\nçº¿ç¨‹æ± åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å¹¿æ³›åº”ç”¨ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ§åˆ¶çº¿ç¨‹åˆ›å»ºå’Œçº¿ç¨‹é”€æ¯çš„é¢‘ç‡ï¼Œé¿å…ç”±äºåˆ›å»ºè¿‡å¤šçº¿ç¨‹å¯¼è‡´ç³»ç»Ÿèµ„æºæµªè´¹å’Œè¿è¡Œæ•ˆç‡é™ä½çš„é—®é¢˜ã€‚\nQt çº¿ç¨‹æ± çš„ä½¿ç”¨å¼•å…¥å¤´æ–‡ä»¶ä¸ºäº†ä½¿ç”¨ Qt çº¿ç¨‹æ± ï¼Œéœ€è¦å¼•å…¥ QtConcurrent/QtConcurrentRun å¤´æ–‡ä»¶ï¼Œå®ç°å¦‚ä¸‹ï¼š\n1#include &lt;QtConcurrent/QtConcurrentRun&gt;\n\nåˆ›å»ºçº¿ç¨‹æ± è¦ä½¿ç”¨ Qt çº¿ç¨‹æ± ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª QThreadPool å¯¹è±¡ã€‚ Qt çº¿ç¨‹æ± é»˜è®¤ä½¿ç”¨çº¿ç¨‹æ•°ç­‰äº CPU æ ¸å¿ƒæ•°çš„ä¸¤å€ï¼Œä½†æ˜¯ä½ å¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹æ•°ã€‚åˆ›å»ºçº¿ç¨‹æ± çš„ä»£ç å¦‚ä¸‹ï¼š\n123QThreadPool *threadPool = QThreadPool::globalInstance();// or QThreadPool *threadPool = new QThreadPool(parent);\n\nå®šä¹‰ä»»åŠ¡å‡½æ•°éœ€è¦æ‰§è¡Œåœ¨çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡å¿…é¡»æ˜¯é™æ€æˆ–å…¨å±€çš„ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åœ¨çº¿ç¨‹æ± ä¸­æ­£ç¡®æ‰§è¡Œã€‚ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä¸‹é¢ä»£ç ç‰‡æ®µä¸­ä½¿ç”¨ lambda è¡¨è¾¾å¼ä½œä¸ºä»»åŠ¡å‡½æ•°ï¼š\n1234auto task = []()&#123;    QThread::sleep(1); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ    qDebug() &lt;&lt; &quot;ä»»åŠ¡æ‰§è¡Œå®Œæ¯•&quot;;&#125;;\n\næäº¤ä»»åŠ¡å°†ä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ä¸­è¿›è¡Œå¤„ç†ï¼Œä½¿ç”¨ QtConcurrent::run() å‡½æ•°å³å¯ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å¯å°† task ä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ä¸­ï¼š\n1QtConcurrent::run(threadPool, task);\n\næ§åˆ¶çº¿ç¨‹æ± QThreadPool å¯¹è±¡æœ‰å‡ ä¸ªæ§åˆ¶çº¿ç¨‹æ± è¡Œä¸ºçš„å±æ€§å’Œæ–¹æ³•ï¼š\n\nsetMaxThreadCount(int maxThreadCount)ï¼šè®¾ç½®çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ã€‚\nactiveThreadCount()ï¼šè¿”å›æ´»è·ƒçº¿ç¨‹ä¸ªæ•°ã€‚\nreserveThread()ï¼šåˆ†é…ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œç›¸å½“äºå¢åŠ ä¸€ä¸ªå·²æœ‰çº¿ç¨‹çš„æ•°é‡ã€‚\nreleaseThread()ï¼šé‡Šæ”¾ä¸€ä¸ªçº¿ç¨‹ï¼Œç›¸å½“äºå‡å°‘ä¸€ä¸ªçº¿ç¨‹çš„æ•°é‡ã€‚\n\nç­‰å¾…ä»»åŠ¡å®Œæˆè¿è¡Œæ—¶ï¼Œä»»åŠ¡è¢«æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œã€‚æƒ³è¦ç­‰å¾…æ‰€æœ‰çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆæ‰ç»§ç»­åé¢çš„ä»£ç æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ QThreadPool::waitForDone() æ–¹æ³•ï¼š\n1threadPool-&gt;waitForDone();\n\næ€»ç»“Qt çº¿ç¨‹æ± æä¾›äº†ä¸€ç§ç®€å•æ–¹ä¾¿çš„æ–¹å¼æ¥æ‰§è¡Œå¤šçº¿ç¨‹å¹¶å‘æ“ä½œï¼Œé¿å…ç”±äºåˆ›å»ºè¿‡å¤šçº¿ç¨‹å¯¼è‡´ç³»ç»Ÿèµ„æºæµªè´¹å’Œè¿è¡Œæ•ˆç‡é™ä½çš„é—®é¢˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿›è¡Œå¤šçº¿ç¨‹å¹¶å‘å¤„ç†æ—¶ï¼Œå¿…é¡»ä¿è¯ä»£ç çš„çº¿ç¨‹å®‰å…¨æ€§ã€‚å¸Œæœ›æœ¬æ–‡å¯¹ Qt çº¿ç¨‹æ± çš„æ¦‚å¿µåŠä½¿ç”¨æ–¹æ³•æœ‰æ‰€å¸®åŠ©ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qt çº¿ç¨‹æ± ","date":"2021-11-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"93a101a48c8aea63429499c894498199","title":"QtCustomPlot ç»˜åˆ¶å›¾è¡¨","content":"ä½¿ç”¨ QtCustomPlot ç»˜åˆ¶å›¾è¡¨ä»‹ç»QtCustomPlot æ˜¯ä¸€ä¸ªåŸºäº Qt çš„å›¾è¡¨åº“ï¼Œç”¨äºåˆ›å»ºæ•°æ®å¯è§†åŒ–å›¾è¡¨ã€‚å®ƒæ”¯æŒå¤šç§ç±»å‹çš„å›¾è¡¨ï¼ŒåŒ…æ‹¬æŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ã€æŸ±çŠ¶å›¾ç­‰ï¼Œå¹¶æä¾›äº†å¤šç§è‡ªå®šä¹‰é€‰é¡¹ï¼Œä»¥ä¾¿ç”¨æˆ·å¯¹å…¶å¤–è§‚å’Œè¡Œä¸ºè¿›è¡Œä¼˜åŒ–ã€‚\nåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ QtCustomPlot æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æŠ˜çº¿å›¾æ¥å¯è§†åŒ–æ•°æ®ã€‚\nå‡†å¤‡å·¥ä½œåœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š\n\nå®‰è£…äº† Qt 5 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚\nä¸‹è½½å¹¶å®‰è£…äº† QtCustomPlot åº“ã€‚\næ‚¨å¯ä»¥åœ¨æ­¤å¤„ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„åº“ã€‚\n\n\nåˆ›å»ºä¸€ä¸ªæ–°çš„ Qt é¡¹ç›®ï¼Œåœ¨ .pro æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œä»¥å¼•ç”¨ QtCustomPlot åº“ï¼š1include(path/to/qtcustomplot.pri)\n\næ­¥éª¤\nå®šä¹‰ä¸€ä¸ª QCustomPlot å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†æ‰¿è½½æˆ‘ä»¬çš„å›¾è¡¨ã€‚1QCustomPlot *customPlot = new QCustomPlot(this);\nåˆ›å»ºä¸€ä¸ªç§°ä¸ºâ€œå›¾å½¢â€ï¼ˆgraphï¼‰çš„å¯¹è±¡ï¼Œç”¨äºåœ¨å›¾è¡¨ä¸­æ˜¾ç¤ºæ•°æ®ã€‚1QCPGraph *graph = customPlot-&gt;addGraph();\nå°†æ•°æ®æ·»åŠ åˆ°å›¾å½¢å¯¹è±¡ä¸­ï¼Œä»¥ä¾¿åœ¨å›¾è¡¨ä¸­æ˜¾ç¤ºã€‚123QVector&lt;double&gt; xData, yData;// æ·»åŠ æ‚¨çš„æ•°æ®åˆ° xData å’Œ yData å‘é‡ä¸­graph-&gt;setData(xData, yData);\nï¼ˆå¯é€‰ï¼‰ è®¾ç½®è½´çš„æ ‡ç­¾å’ŒèŒƒå›´ã€‚1234customPlot-&gt;xAxis-&gt;setLabel(&quot;X Axis&quot;);customPlot-&gt;yAxis-&gt;setLabel(&quot;Y Axis&quot;);customPlot-&gt;xAxis-&gt;setRange(0, 10);customPlot-&gt;yAxis-&gt;setRange(0, 100);\næ˜¾ç¤ºå›¾è¡¨ã€‚1customPlot-&gt;replot();\n\nç¤ºä¾‹ä»£ç å®Œæ•´ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n1234567891011121314151617#include &lt;QtCustomPlot/QCustomPlot&gt;QCustomPlot *customPlot = new QCustomPlot(this);QCPGraph *graph = customPlot-&gt;addGraph();QVector&lt;double&gt; xData, yData;// æ·»åŠ æ‚¨çš„æ•°æ®åˆ° xData å’Œ yData å‘é‡ä¸­graph-&gt;setData(xData, yData);customPlot-&gt;xAxis-&gt;setLabel(&quot;X Axis&quot;);customPlot-&gt;yAxis-&gt;setLabel(&quot;Y Axis&quot;);customPlot-&gt;xAxis-&gt;setRange(0, 10);customPlot-&gt;yAxis-&gt;setRange(0, 100);customPlot-&gt;replot();\n\nä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ QtCustomPlot ç»˜åˆ¶å›¾è¡¨çš„åŸºæœ¬æ­¥éª¤ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰æ›´å¤šæ ·å¼å’Œå¤–è§‚é€‰é¡¹ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QtCustomPlot ç»˜åˆ¶å›¾è¡¨","date":"2021-11-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"de5d17019a62106c24ae84eccced9caf","title":"Qtäº‹ä»¶å¤„ç†æœºåˆ¶æµç¨‹","content":"Qtäº‹ä»¶å¤„ç†æœºåˆ¶æµç¨‹Qtäº‹ä»¶å¤„ç†æœºåˆ¶æ˜¯å®ç°GUIç¨‹åºçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åœ¨Qtä¸­ï¼Œæ‰€æœ‰çš„ç”¨æˆ·æ“ä½œï¼ˆä¾‹å¦‚é¼ æ ‡ç‚¹å‡»ã€é”®ç›˜è¾“å…¥ç­‰ï¼‰éƒ½ä¼šè¢«è½¬æ¢ä¸ºäº‹ä»¶ï¼Œç„¶åäº¤ç»™ç›¸åº”çš„å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚å› æ­¤ï¼Œäº†è§£Qtäº‹ä»¶å¤„ç†æœºåˆ¶å¯¹äºç†è§£Qtç¼–ç¨‹è‡³å…³é‡è¦ã€‚\näº‹ä»¶å¤„ç†å‡½æ•°åœ¨Qtä¸­ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°æ˜¯æŒ‡é‡è½½QObjectç±»çš„event()å‡½æ•°æˆ–QWidgetç±»çš„paintEvent()å‡½æ•°ç­‰ä¸€ç³»åˆ—äº‹ä»¶å¤„ç†å‡½æ•°ã€‚äº‹ä»¶å¤„ç†å‡½æ•°å¯ä»¥æ¥æ”¶åˆ°Qtå„ç§äº‹ä»¶ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›å‡½æ•°æ¥å¤„ç†äº‹ä»¶å¹¶å†³å®šå¦‚ä½•å“åº”è¿™äº›äº‹ä»¶ã€‚\nåœ¨Qtä¸­ï¼Œæ¯ä¸ªQObjectå¯¹è±¡éƒ½å¯ä»¥æœ‰è‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä¾‹å¦‚ï¼š\n1234567class MyObject : public QObject&#123;    Q_OBJECTprotected:    bool event(QEvent *event);&#125;;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒMyObjectç±»ç»§æ‰¿è‡ªQObjectï¼Œå¹¶é‡è½½äº†event()å‡½æ•°ã€‚å½“è¯¥ç±»æ¥æ”¶åˆ°äº‹ä»¶æ—¶ï¼Œä¼šè°ƒç”¨event()å‡½æ•°è¿›è¡Œäº‹ä»¶å¤„ç†ã€‚\näº‹ä»¶å¾ªç¯Qtäº‹ä»¶å¾ªç¯æ˜¯æŒ‡ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œåœ¨è¯¥å¾ªç¯ä¸­ï¼ŒQtä¼šä¸æ–­åœ°ä»æ“ä½œç³»ç»Ÿå–å‡ºäº‹ä»¶å¹¶å°†å…¶å‘é€ç»™ç›¸åº”çš„æ¥æ”¶è€…ï¼ˆå³äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ã€‚Qtäº‹ä»¶å¾ªç¯çš„å®ç°ç”±QCoreApplicationç±»å®Œæˆã€‚åœ¨Qtåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦åˆ›å»ºä¸€ä¸ªQApplicationæˆ–QGuiApplicationå¯¹è±¡æ¥åˆå§‹åŒ–Qtäº‹ä»¶å¾ªç¯ã€‚\näº‹ä»¶å¾ªç¯çš„ä»£ç å¦‚ä¸‹ï¼š\n123456while (true) &#123;    if (!QCoreApplication::hasPendingEvents())        QCoreApplication::processEvents(QEventLoop::WaitForMoreEvents);    else        QCoreApplication::processEvents(QEventLoop::AllEvents);&#125;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒQCoreApplicationä¼šä¸æ–­åœ°è°ƒç”¨processEvents()å‡½æ•°æ¥å¤„ç†äº‹ä»¶ã€‚å½“æœ‰æ–°çš„äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œè¯¥å‡½æ•°ä¼šå°†äº‹ä»¶å‘é€ç»™ç›¸åº”çš„å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚\näº‹ä»¶è¿‡æ»¤å™¨åœ¨Qtä¸­ï¼Œäº‹ä»¶è¿‡æ»¤å™¨æ˜¯æŒ‡é€šè¿‡é‡è½½QObjectç±»çš„eventFilter()å‡½æ•°æ¥å®ç°å¯¹äº‹ä»¶çš„æ‹¦æˆªå’Œå¤„ç†ã€‚é€šè¿‡äº‹ä»¶è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›‘è§†æ‰€æœ‰QObjectå¯¹è±¡çš„äº‹ä»¶ï¼Œå¹¶åšå‡ºç›¸åº”çš„å“åº”ã€‚\nä¾‹å¦‚ï¼š\n1234567class MyFilter : public QObject&#123;    Q_OBJECTpublic:    bool eventFilter(QObject *obj, QEvent *event);&#125;;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒMyFilterç±»ç»§æ‰¿è‡ªQObjectï¼Œå¹¶é‡è½½äº†eventFilter()å‡½æ•°ã€‚å½“ä¸€ä¸ªQObjectå¯¹è±¡æ¥æ”¶åˆ°äº‹ä»¶æ—¶ï¼Œä¼šé¦–å…ˆå°†äº‹ä»¶å‘é€ç»™MyFilterå¯¹è±¡è¿›è¡Œå¤„ç†ã€‚å¦‚æœMyFilterå¯¹è±¡éœ€è¦æ‹¦æˆªè¯¥äº‹ä»¶ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseï¼Œè®©è¯¥äº‹ä»¶è¢«ä¼ é€’åˆ°åŸæœ¬çš„äº‹ä»¶å¤„ç†å‡½æ•°è¿›è¡Œå¤„ç†ã€‚\näº‹ä»¶åˆ†å‘åœ¨Qtäº‹ä»¶å¤„ç†æœºåˆ¶ä¸­ï¼Œäº‹ä»¶åˆ†å‘æ˜¯æŒ‡å°†äº‹ä»¶åˆ†å‘ç»™ç›¸åº”çš„æ¥æ”¶è€…è¿›è¡Œå¤„ç†ã€‚é€šè¿‡äº‹ä»¶åˆ†å‘ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯æ¯ä¸ªäº‹ä»¶éƒ½èƒ½æ­£ç¡®åœ°è¢«å¤„ç†ã€‚\nåœ¨Qtä¸­ï¼Œäº‹ä»¶åˆ†å‘ç”±QCoreApplication::sendEvent()å‡½æ•°å®Œæˆã€‚è¯¥å‡½æ•°è´Ÿè´£å°†äº‹ä»¶åˆ†å‘ç»™ç›¸åº”çš„æ¥æ”¶è€…ï¼ˆå³äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰è¿›è¡Œå¤„ç†ã€‚å¦‚æœäº‹ä»¶å¤„ç†å‡½æ•°è¿”å›trueï¼Œåˆ™è¯´æ˜è¯¥äº‹ä»¶å·²è¢«å¤„ç†ï¼›å¦åˆ™ï¼Œè¯¥äº‹ä»¶ä¼šè¢«ä¼ é€’ç»™çˆ¶å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚\næµç¨‹å›¾ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨mermaidè¯­æ³•ç»˜åˆ¶çš„Qtäº‹ä»¶å¤„ç†æœºåˆ¶æµç¨‹å›¾ï¼š\n12345678graph LRA[äº‹ä»¶] --&gt; B&#123;äº‹ä»¶åˆ†å‘&#125;B --&gt; C1[äº‹ä»¶è¿‡æ»¤å™¨1]B --&gt; C2[äº‹ä»¶è¿‡æ»¤å™¨2]B --&gt; C3[äº‹ä»¶è¿‡æ»¤å™¨3]C1 --&gt; D1[äº‹ä»¶å¤„ç†å‡½æ•°1]C2 --&gt; D2[äº‹ä»¶å¤„ç†å‡½æ•°2]C3 --&gt; D3[äº‹ä»¶å¤„ç†å‡½æ•°3]\n\nåœ¨ä¸Šè¿°æµç¨‹å›¾ä¸­ï¼Œäº‹ä»¶é¦–å…ˆé€šè¿‡äº‹ä»¶åˆ†å‘å™¨ï¼ˆå³BèŠ‚ç‚¹ï¼‰è¿›è¡Œåˆ†å‘ã€‚ç„¶åï¼Œäº‹ä»¶å¯èƒ½ä¼šè¢«ä¼ é€’ç»™ä¸€ç³»åˆ—äº‹ä»¶è¿‡æ»¤å™¨ï¼ˆå³C1ã€C2å’ŒC3èŠ‚ç‚¹ï¼‰ï¼Œè¿™äº›äº‹ä»¶è¿‡æ»¤å™¨å¯ä»¥æ‹¦æˆªå¹¶å¤„ç†äº‹ä»¶ã€‚æœ€ç»ˆï¼Œäº‹ä»¶ä¼šè¢«ä¼ é€’ç»™å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆå³D1ã€D2å’ŒD3èŠ‚ç‚¹ï¼‰è¿›è¡Œå¤„ç†ã€‚\næ€»ç»“Qtäº‹ä»¶å¤„ç†æœºåˆ¶æ˜¯ä¸€ç§é«˜æ•ˆè€Œå¯é çš„æœºåˆ¶ï¼Œå®ƒèƒ½å¤Ÿç¡®ä¿GUIç¨‹åºèƒ½å¤Ÿæ­£ç¡®åœ°å“åº”ç”¨æˆ·çš„æ“ä½œã€‚é€šè¿‡äº†è§£Qtäº‹ä»¶å¤„ç†æœºåˆ¶çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç†è§£Qtç¼–ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæ›´åŠ çµæ´»åœ°æ§åˆ¶ç¨‹åºçš„è¡Œä¸ºã€‚\nä»¥ä¸Šæ˜¯å…³äºQtäº‹ä»¶å¤„ç†æœºåˆ¶æµç¨‹çš„è¯¦ç»†ä»‹ç»ï¼Œå¦‚æœ‰ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿æŒ‡æ­£ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qtäº‹ä»¶å¤„ç†æœºåˆ¶æµç¨‹","date":"2021-11-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5b703c364468afe9449fdcd6becdc305","title":"Qtå†…ç½®å®åŠå…¶å«ä¹‰","content":"Qtå†…ç½®å®åŠå…¶å«ä¹‰å½“æ‚¨å¼€å§‹ä½¿ç”¨Qtç¼–ç¨‹æ—¶ï¼Œä¼šå‘ç°åœ¨Qtä»£ç ä¸­é¢‘ç¹å‡ºç°äº†å„ç§å¥‡æ€ªçš„å®å®šä¹‰ã€‚å®ƒä»¬æ˜¯ç”¨äºæ‰§è¡Œä¸åŒåŠŸèƒ½çš„ç‰¹æ®ŠæŒ‡ä»¤ã€‚åœ¨Qtä¸­æœ‰è®¸å¤šè¿™æ ·çš„å®å®šä¹‰ã€‚åœ¨æœ¬ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è¿™äº›å®çš„å«ä¹‰å’Œç”¨æ³•ã€‚\nQ_OBJECTQ_OBJECT æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å®ã€‚å®ƒå¿…é¡»å‡ºç°åœ¨ Qt ç±»å£°æ˜çš„ç§æœ‰éƒ¨åˆ†ä¸­ã€‚è¯¥å®å‘Šè¯‰ Qt å…ƒå¯¹è±¡ç¼–è¯‘å™¨åœ¨ MOC (Meta-Object Compiler) ä¸­ä¸ºè¯¥ç±»ç”Ÿæˆå…ƒå¯¹è±¡ã€‚è¿™ä½¿å¾—ä¿¡å·å’Œæ§½ã€å…ƒæ•°æ®ç­‰ç‰¹æ€§å¾—ä»¥ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š\n12345678910111213class MyWidget : public QWidget&#123;    Q_OBJECTpublic:    explicit MyWidget(QWidget *parent = nullptr);signals:    void buttonClicked();private slots:    void handleButton();&#125;;\n\næ³¨æ„ï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„ IDE ä¸æ”¯æŒè‡ªåŠ¨è¿è¡Œ MOCï¼Œæ‚¨éœ€è¦ç¡®ä¿åœ¨æ¯æ¬¡æ›´æ”¹åŒ…å« Q_OBJECT çš„å¤´æ–‡ä»¶ä¹‹åæ‰‹åŠ¨è¿è¡Œ MOCã€‚\nQ_PROPERTYQ_PROPERTY å®ç”¨äºå£°æ˜å±æ€§ã€‚å®ƒä¸è®¿é—®å™¨æ–¹æ³•ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¾¿æ›´æ–¹ä¾¿åœ°æŸ¥è¯¢å’Œè®¾ç½®å±æ€§å€¼ã€‚ä¾‹å¦‚ï¼š\n123456789101112131415161718192021222324252627282930class MyWidget : public QWidget&#123;    Q_OBJECT    Q_PROPERTY(QString text READ text WRITE setText NOTIFY textChanged)public:    explicit MyWidget(QWidget *parent = nullptr);    QString text() const;    void setText(const QString &amp;text);signals:    void textChanged();private:    QString m_text;&#125;;QString MyWidget::text() const&#123;    return m_text;&#125;void MyWidget::setText(const QString &amp;text)&#123;    if (text != m_text) &#123;        m_text = text;        emit textChanged();    &#125;&#125;\n\næ­¤ç¤ºä¾‹ä¸­å£°æ˜äº†ä¸€ä¸ªå…·æœ‰ text å±æ€§çš„ MyWidget ç±»ã€‚ä½¿ç”¨ Q_PROPERTY å£°æ˜ä¸ºåªè¯»æˆ–è¯»&#x2F;å†™å±æ€§ã€‚è®¾ç½®å™¨æ–¹æ³•åº”è¯¥åœ¨ä¿®æ”¹å±æ€§æ—¶å‘å‡ºå¯¹åº”çš„ä¿¡å·ã€‚\nQ_SIGNALS å’Œ Q_SLOTSQ_SIGNALS å’Œ Q_SLOTS å®åˆ†åˆ«ç”¨äºå£°æ˜ä¿¡å·å’Œæ§½ã€‚è¿™ä½¿å¾—ç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨å…ƒå¯¹è±¡ä¸­æ³¨å†Œå®ƒä»¬ä»¥è¿›è¡Œè¿è¡Œæ—¶è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š\n12345678910111213class MyWidget : public QWidget&#123;    Q_OBJECTpublic:    explicit MyWidget(QWidget *parent = nullptr);signals:    void buttonClicked();private slots:    void handleButton();&#125;;\n\nåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒMyWidget çš„ buttonClicked() ä¿¡å·å’Œ handleButton() æ§½è¢«å£°æ˜ä¸º Q_SIGNALS å’Œ Q_SLOTSã€‚\nQ_EMITQ_EMIT å®ç”¨äºå‘å°„ä¿¡å·ã€‚\n12345void MyWidget::handleButton()&#123;    // do something    Q_EMIT buttonClicked();&#125;\n\nQT_VERSION_CHECKQT_VERSION_CHECK(major, minor, patch) ç”¨äºåœ¨é¢„å¤„ç†æœŸé—´æ£€æŸ¥ Qt åº“ç‰ˆæœ¬ã€‚\n12345#if QT_VERSION_CHECK(5, 14, 0)// code for Qt 5.14.0 and later#else// code for earlier versions of Qt#endif\n\nQ_DECL_OVERRIDE å’Œ Q_DECL_FINALQ_DECL_OVERRIDE å’Œ Q_DECL_FINAL å®åˆ†åˆ«ç”¨äºè¦†ç›–å’Œç¦æ­¢è¦†ç›–è™šå‡½æ•°ã€‚\n1234567891011class MyWidget : public QWidget&#123;    Q_OBJECTpublic:    explicit MyWidget(QWidget *parent = nullptr) &#123;&#125;    virtual void paintEvent(QPaintEvent *event) Q_DECL_OVERRIDE;    virtual void mousePressEvent(QMouseEvent *event) Q_DECL_FINAL;&#125;;\n\nQ_DISABLE_COPY å’Œ Q_DISABLE_MOVEQ_DISABLE_COPY å’Œ Q_DISABLE_MOVE å®ç”¨äºç¦ç”¨ç±»çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢ä»£ç å¤åˆ¶å’Œæ„å¤–ä½¿ç”¨ä¸å®‰å…¨çš„æ‹·è´å’Œç§»åŠ¨å‡½æ•°ã€‚\n12345678class MyWidget : public QWidget&#123;    Q_DISABLE_COPY(MyWidget)    Q_DISABLE_MOVE(MyWidget)public:    explicit MyWidget(QWidget *parent = nullptr);&#125;;\n\nä»¥ä¸Šæ˜¯å¸¸ç”¨çš„ Qt å†…ç½®å®ï¼Œå®ƒä»¬å¯ä»¥ä½¿ Qt ç¼–ç¨‹æ›´åŠ ç®€æ´å’Œé«˜æ•ˆã€‚å¸Œæœ›æœ¬ç¯‡æ•™ç¨‹èƒ½å¤Ÿå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qtå†…ç½®å®åŠå…¶å«ä¹‰","date":"2021-11-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"cb41401ee69235767505fab37433a483","title":"ä»€ä¹ˆæ˜¯Qt proæ–‡ä»¶ï¼Ÿ","content":"ä»€ä¹ˆæ˜¯Qt proæ–‡ä»¶ï¼ŸQt proæ–‡ä»¶æ˜¯QTé¡¹ç›®ç®¡ç†å™¨ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚å®ƒä»¬åœ¨Qtåˆ›å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆï¼Œå¹¶ä¸”åŒ…å«æœ‰å…³å·¥ç¨‹çš„ä¿¡æ¯ï¼Œå¦‚æºæ–‡ä»¶ã€åº“å’Œç¼–è¯‘é€‰é¡¹ç­‰ã€‚\nå¦‚ä½•åˆ›å»ºQt proæ–‡ä»¶ï¼Ÿå¯ä»¥ä½¿ç”¨Qt Creatoråˆ›å»ºäº¤äº’å¼å·¥ç¨‹å‘å¯¼æ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®å¹¶è‡ªåŠ¨ç”Ÿæˆproæ–‡ä»¶ã€‚ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºproæ–‡ä»¶å¹¶å°†å…¶æ·»åŠ åˆ°Qt Creatoré¡¹ç›®ä¸­ã€‚ \nproæ–‡ä»¶çš„åŸºæœ¬è¯­æ³•ç»“æ„1234567891011CONFIG += &lt;é…ç½®é€‰é¡¹&gt;TARGET = &lt;ç›®æ ‡å&gt;TEMPLATE = &lt;æ¨¡æ¿&gt;&lt;å…¶ä»–å˜é‡&gt;SOURCES += &lt;æºæ–‡ä»¶åˆ—è¡¨&gt;HEADERS += &lt;å¤´æ–‡ä»¶åˆ—è¡¨&gt;FORMS += &lt;è¡¨å•æ–‡ä»¶åˆ—è¡¨&gt;RESOURCES += &lt;èµ„æºæ–‡ä»¶åˆ—è¡¨&gt;LIBS += &lt;é“¾æ¥åº“åˆ—è¡¨&gt;\n\nå…¶ä¸­ï¼ŒCONFIG æŒ‡å®šä¸€ç³»åˆ—çš„é…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚è®¾ç½®ç¼–è¯‘ç±»å‹ï¼šdebug æˆ– releaseï¼›TEMPLATE æŒ‡å®šä½¿ç”¨ä»€ä¹ˆæ ·çš„æ„å»ºæ¨¡æ¿ï¼Œä¾‹å¦‚ app æˆ– libï¼› TARGET æ˜¯ç”Ÿæˆçš„æœ€ç»ˆç›®æ ‡ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé™æ€&#x2F;å…±äº«åº“ï¼‰çš„åç§°ï¼›SOURCESã€HEADERSã€FORMS å’ŒRESOURCES åˆ†åˆ«æŒ‡å®šæºæ–‡ä»¶ã€å¤´æ–‡ä»¶ã€è¡¨å•å’Œèµ„æºæ–‡ä»¶çš„åˆ—è¡¨ï¼›LIBS å®šä¹‰æ‰€éœ€çš„åº“æ–‡ä»¶ã€‚ \nQt proæ–‡ä»¶ç¤ºä¾‹123456789101112131415161718192021# é…ç½®debug/releaseä¸‹çš„ç¼–è¯‘é€‰é¡¹ CONFIG += debug_and_release# æŒ‡å®šç”Ÿæˆçš„ç›®æ ‡ä¸ºå¯æ‰§è¡Œæ–‡ä»¶TEMPLATE = app# å®šä¹‰å¯æ‰§è¡Œæ–‡ä»¶å TARGET = myapp# å£°æ˜æºæ–‡ä»¶ç›®å½• SOURCES += main.cpp \\           mywindow.cpp# å£°æ˜å¤´æ–‡ä»¶ç›®å½•HEADERS += mywindow.h # é…ç½®Qtåº“ï¼ˆç¤ºä¾‹ä¸­ä½¿ç”¨äº† Widgetsï¼‰ QT += widgets# æ·»åŠ å¤–éƒ¨åº“ LIBS += -lmylib\n\nä»¥ä¸Šç¤ºä¾‹å°†ç”Ÿæˆä¸€ä¸ªåä¸º myapp çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒ…å« main.cpp å’Œ mywindow.cpp æ–‡ä»¶ã€‚å…¶ä¸­æ‰€éœ€çš„å¤´æ–‡ä»¶ mywindow.h å°†è¢«åŒ…å«åœ¨ç¼–è¯‘ä¸­ã€‚è¯¥åº”ç”¨ç¨‹åºå°†é“¾æ¥åˆ°åä¸º mylib çš„å¤–éƒ¨åº“ï¼Œå¹¶ä¸”å®ƒå°†ä½¿ç”¨ Qt åº“ä¸­çš„ä¸€ä¸ªåº“ï¼ˆwidgetsï¼‰ã€‚ \nè¿™æ˜¯ä¸€ä¸ªç®€å•çš„Qt proæ–‡ä»¶çš„ä¾‹å­ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦å’Œå®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹å’Œæ‰©å±•ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä»€ä¹ˆæ˜¯Qt proæ–‡ä»¶ï¼Ÿ","date":"2021-10-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"b5f40241243dd23db9b5a3b73e4d29d8","title":"åœ¨Qtä¸­ä½¿ç”¨æ¸å˜è‰²","content":"åœ¨Qtä¸­ä½¿ç”¨æ¸å˜è‰²Qtæ˜¯ä¸€ä¸ªè·¨å¹³å°å¼€å‘æ¡†æ¶ï¼Œåœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰è®¾è®¡ä¸­éå¸¸å¸¸ç”¨ã€‚æ¸å˜è‰²èƒ½å¤Ÿä¸ºGUIæ·»åŠ è§†è§‰æ•ˆæœå¹¶æé«˜ç”¨æˆ·ä½“éªŒã€‚æœ¬æ–‡å°†ä»‹ç»åœ¨Qtä¸­å¦‚ä½•ä½¿ç”¨æ¸å˜è‰²ã€‚\nå®‰è£…å’Œè®¾ç½®åœ¨Qtä¸­ä½¿ç”¨æ¸å˜è‰²éœ€è¦åœ¨é¡¹ç›®æ–‡ä»¶ä¸­æ·»åŠ  QT += widgetsï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨QPainterç­‰ç›¸å…³APIç»˜åˆ¶æ¸å˜è‰²ã€‚\nå‚ç›´æ¸å˜é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç»˜åˆ¶ä¸€æ¡å‚ç›´çš„æ¸å˜è‰²ã€‚\n1234567QLinearGradient gradient(0, 0, 0, height());gradient.setColorAt(0, Qt::white);gradient.setColorAt(1, Qt::black);QPainter painter(this);painter.setBrush(gradient);painter.drawRect(rect());\n\nä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ªä»é¡¶éƒ¨åˆ°åº•éƒ¨æ¸å˜çš„QLinearGradientå¯¹è±¡ï¼Œç„¶åé€šè¿‡setColorAt()å‡½æ•°è®¾ç½®é¢œè‰²ã€‚æœ€åï¼Œå°†è¯¥æ¸å˜å¯¹è±¡è®¾ä¸ºç”»åˆ·(setBrush())å¹¶ç”¨drawRect()å‡½æ•°ç»˜åˆ¶å‡ºæ¥ã€‚\næ°´å¹³æ¸å˜ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç»˜åˆ¶æ°´å¹³æ–¹å‘ä¸Šçš„æ¸å˜è‰²ï¼š\n1234567QLinearGradient gradient(0, 0, width(), 0);gradient.setColorAt(0, Qt::white);gradient.setColorAt(1, Qt::black);QPainter painter(this);painter.setBrush(gradient);painter.drawRect(rect());\n\nä¸å‚ç›´æ¸å˜ç›¸ä¼¼ï¼Œåªéœ€è¦å°†QLinearGradientå¯¹è±¡ä¸­çš„èµ·ç‚¹å’Œç»ˆç‚¹æ”¹ä¸º(0, 0)å’Œ(width(), 0)å³å¯ã€‚\nè¾å°„æ¸å˜é™¤äº†çº¿æ€§æ¸å˜å¤–ï¼ŒQtè¿˜æ”¯æŒè¾å°„æ¸å˜ã€‚ç›¸å¯¹äºçº¿æ€§æ¸å˜ï¼Œè¾å°„æ¸å˜é€šå¸¸ç”¨äºç»˜åˆ¶åœ†å½¢çš„æ¸å˜è‰²å¡«å……æ•ˆæœã€‚\n1234567QRadialGradient gradient(QPointF(width()/2, height()/2), qMax(width(), height())/2);gradient.setColorAt(0, Qt::white);gradient.setColorAt(1, Qt::black);QPainter painter(this);painter.setBrush(gradient);painter.drawEllipse(rect());\n\nä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ªä»ä¸­å¿ƒåˆ°å„ä¸ªè§’çš„æ¸å˜çš„QRadialGradientå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨setColorAt()å‡½æ•°è®¾ç½®é¢œè‰²ã€‚æœ€åï¼Œå°†è¯¥æ¸å˜å¯¹è±¡è®¾ä¸ºç”»åˆ·å¹¶åœ¨å±å¹•ä¸Šç”¨drawEllipse()å‡½æ•°ç»˜åˆ¶å‡ºæ¥ã€‚\næ€»ç»“åœ¨Qtä¸­ä½¿ç”¨æ¸å˜è‰²éå¸¸ç®€å•ã€‚é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ä»£ç ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿäº†è§£å¦‚ä½•åœ¨Qtä¸­ä½¿ç”¨å‚ç›´ã€æ°´å¹³å’Œè¾å°„æ¸å˜ã€‚ä½¿ç”¨æ¸å˜è‰²ä¸ä»…èƒ½å¤Ÿå¾ˆå¥½åœ°æå‡ç”¨æˆ·ä½“éªŒï¼Œè¿˜å¯ä»¥ä¸ºGUIè®¾è®¡å¢æ·»ä¸€äº›åä¸½çš„åŠ¨æ€æ•ˆæœã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/åœ¨Qtä¸­ä½¿ç”¨æ¸å˜è‰²","date":"2021-10-22T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5c952a910652e5178fb110ec12dbdb02","title":"ä½¿ç”¨Qtå¼€å‘è‡ªå®šä¹‰å§”æ‰˜çš„è¡¨æ ¼æ§ä»¶","content":"ä½¿ç”¨Qtå¼€å‘è‡ªå®šä¹‰å§”æ‰˜çš„è¡¨æ ¼æ§ä»¶åœ¨Qtä¸­ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å§”æ‰˜ï¼ˆQStyledItemDelegateï¼‰æ¥å®ç°è‡ªå®šä¹‰çš„è¡¨æ ¼æ§ä»¶ï¼Œè¿™ä¸ªæœºåˆ¶å¯ä»¥è®©å¼€å‘è€…å®Œå…¨æŒæ¡è¡¨æ ¼å•å…ƒæ ¼UIçš„æ˜¾ç¤ºæ–¹å¼å’Œç”¨æˆ·äº¤äº’æ–¹å¼ã€‚\næ­¥éª¤ä¸€ï¼šè®¾ç½®è¡¨æ ¼æ¨¡å‹åœ¨åˆ›å»ºè¡¨æ ¼å‰ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªè¡¨æ ¼æ¨¡å‹æ¥å­˜å‚¨æ•°æ®ã€‚Qtä¸­æä¾›äº†QAbstractTableModelå¯¹è±¡ï¼Œå…¶æ´¾ç”Ÿç±»å¯ç”¨äºåˆ›å»ºå„ç§ç±»å‹çš„è¡¨æ ¼æ¨¡å‹ï¼Œå¦‚åˆ—è¡¨ã€æ ‘çŠ¶ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„åˆ—è¡¨ä¸ºä¾‹ã€‚\n12345678910111213class CustomTableModel : public QAbstractTableModel &#123;    Q_OBJECTpublic:    explicit CustomTableModel(QObject *parent = nullptr);    int rowCount(const QModelIndex &amp;parent) const override;    int columnCount(const QModelIndex &amp;parent) const override;    QVariant data(const QModelIndex &amp;index, int role) const override;    bool setData(const QModelIndex &amp;index, const QVariant &amp;value, int role) override;private:    QList&lt;QString&gt; m_dataList;&#125;;\n\nä»¥ä¸Šä»£ç å®šä¹‰äº†ä¸€ä¸ªCustomTableModelç±»ï¼Œä¸ºäº†å±•ç¤ºæ–‡ç« é‡ç‚¹åœ¨å§”æ‰˜ä¸Šï¼Œå…·ä½“å®ç°ç•¥å»ã€‚\næ­¥éª¤äºŒï¼šè‡ªå®šä¹‰å§”æ‰˜è‡ªå®šä¹‰å§”æ‰˜æ˜¯å®ç°è¡¨æ ¼æ§ä»¶çš„æ ¸å¿ƒï¼Œè€ŒQtä¸­æä¾›äº†QStyledItemDelegateå¯¹è±¡ä½œä¸ºå®ç°åŸºç±»ï¼Œå¼€å‘è€…é€šè¿‡ç»§æ‰¿ç›´æ¥æ´¾ç”Ÿæ­¤ç±»å¹¶å®ç°å…¶ä¸­çš„å››ä¸ªè™šå‡½æ•°ä»¥å®Œæˆè‡ªå®šä¹‰ï¼špaint()ã€createEditor()ã€setEditorData() å’Œ setModelData()ã€‚\nä¾‹å¦‚ï¼Œä»¥ç»˜åˆ¶è‡ªå®šä¹‰å§”æ‰˜ä¸ºä¾‹ï¼š\n1234567class ColorDelegate : public QStyledItemDelegate &#123;public:    explicit ColorDelegate(QObject *parent = nullptr);private:    void paint(QPainter *painter, const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const override;&#125;;\n\né€šè¿‡paint()æ–¹æ³•ï¼Œå¯ä»¥å®ç°å¯¹å•å…ƒæ ¼çš„ç»˜åˆ¶æ–¹å¼ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š\n12345678910void ColorDelegate::paint(QPainter *painter, const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const&#123;    painter-&gt;save();    painter-&gt;setRenderHint(QPainter::Antialiasing);    painter-&gt;setPen(Qt::NoPen);    painter-&gt;setBrush(QColor(&quot;#FF0000&quot;));    painter-&gt;drawRect(option.rect);    painter-&gt;restore();&#125;\n\nä¸Šè¿°ä»£ç çš„ä½œç”¨æ˜¯ï¼šå°†å•å…ƒæ ¼ç»˜åˆ¶æˆçº¢è‰²çŸ©å½¢ã€‚\næ­¥éª¤ä¸‰ï¼šè®¾ç½®å§”æ‰˜ä¸€æ—¦åˆ›å»ºäº†è‡ªå®šä¹‰å§”æ‰˜å¯¹è±¡ä»¥åï¼Œéœ€è¦å°†å§”æ‰˜å¯¹è±¡è®¾ç½®åˆ°è¡¨æ ¼æ§ä»¶ä¸­ï¼Œä»è€Œç»‘å®šè‡ªå®šä¹‰å•å…ƒæ ¼çš„æ˜¾ç¤ºæ–¹å¼å’Œç”¨æˆ·äº¤äº’æ–¹å¼ã€‚\nåœ¨Qtä¸­ï¼Œé€šè¿‡è¡¨æ ¼æ¨¡å‹çš„setItemDelegate()æ–¹æ³•å³å¯å°†è‡ªå®šä¹‰å§”æ‰˜è®¾ç½®åˆ°è¡¨æ ¼ä¸­ï¼š\n1ui-&gt;tableView-&gt;setItemDelegate(new ColorDelegate(this));\n\nä»¥ä¸Šä»£ç å°†åˆšåˆšåˆ›å»ºçš„çº¢è‰²å•å…ƒæ ¼æ ·å¼ä»£ç†è¨­ç½®ç»™è¡¨æ ¼ã€‚\næ€»ç»“ä½¿ç”¨è‡ªå®šä¹‰å§”æ‰˜æ¥å®ç°è¡¨æ ¼æ§ä»¶å¯ä»¥è®©å¼€å‘è€…å®Œå…¨æŒæ¡å•å…ƒæ ¼UIçš„æ˜¾ç¤ºæ–¹å¼å’Œç”¨æˆ·äº¤äº’æ–¹å¼ã€‚åœ¨å…·ä½“å®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦äº†è§£è¡¨æ ¼æ¨¡å‹å’Œå§”æ‰˜ç±»çš„å…·ä½“ç”¨æ³•ï¼Œå¹¶é‡è½½QStyledItemDelegateçš„å››ä¸ªè™šå‡½æ•°ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä½¿ç”¨Qtå¼€å‘è‡ªå®šä¹‰å§”æ‰˜çš„è¡¨æ ¼æ§ä»¶","date":"2021-10-20T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e00bfb303760f43313b1eb86fecbfba9","title":"QStyleçš„ä»‹ç»","content":"QStyleçš„ä»‹ç»QStyleæ˜¯Qtä¸­ä¸€ä¸ªç”¨äºè‡ªå®šä¹‰GUIå¤–è§‚çš„ç±»ï¼Œå¯ä»¥é€šè¿‡é‡å†™å®ç°å„ç§æ§ä»¶çš„æ˜¾ç¤ºæ•ˆæœã€‚ä¸åŒçš„Widgetç±»æœ‰ä¸åŒçš„é»˜è®¤æ ·å¼ï¼Œè€Œé€šè¿‡QStyleï¼Œå¼€å‘äººå‘˜å¯ä»¥è‡ªå®šä¹‰æ•´ä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¤§å°ã€é¢œè‰²ã€å­—ä½“å’Œå„ç§åŸå§‹çŸ¢é‡å›¾æ ‡ã€‚\nåŸºæœ¬ç”¨æ³•æ ·å¼è®¾ç½®é€šè¿‡è°ƒç”¨QWidgetæˆ–QApplicationä¸Šçš„setStyle()å‡½æ•°é€‰æ‹©ç‰¹å®šçš„æ ·å¼ã€‚\n123QApplication a(argc, argv);QStyle* myStyle = new MyCustomStyle();a.setStyle(myStyle);\n\nè‡ªå®šä¹‰æ ·å¼é€šè¿‡ç»§æ‰¿QStyleå¹¶å®ç°å…¶ä¸­çš„è™šå‡½æ•°æ¥å®ç°GUIæ§ä»¶å’Œçª—å£éƒ¨ä»¶çš„è‡ªå®šä¹‰æ¸²æŸ“æ ·å¼ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ ·å¼å­ç±»å®šä¹‰ç¤ºä¾‹ï¼š\n12345678910111213141516171819202122class CustomStyle : public QStyle&#123;public:    void drawPrimitive(PrimitiveElement element, const QStyleOption *option,                        QPainter *painter, const QWidget *widget) const override;&#125;;void CustomStyle::drawPrimitive(PrimitiveElement element, const QStyleOption *option,                                QPainter *painter, const QWidget *widget) const&#123;    switch (element) &#123;        case PE_FrameFocusRect: &#123;            QPen pen(Qt::blue, 2, Qt::SolidLine, Qt::SquareCap, Qt::MiterJoin);            painter-&gt;setPen(pen);            painter-&gt;drawRect(option-&gt;rect.adjusted(0, 0, -1, -1));            break;        &#125;        default:            QStyle::drawPrimitive(element, option, painter, widget);            break;    &#125;&#125;\n\nå¸¸ç”¨å‡½æ•°QStyleæä¾›äº†è®¸å¤šå¸¸è§çš„æ–¹æ³•ä»¥ä¾¿å¯¹GUIæ§ä»¶è¿›è¡Œè®¾ç½®å’Œç®¡ç†ï¼Œä¾‹å¦‚ï¼š\n\npolish()ï¼šåˆå§‹åŒ–QStyleå¯¹è±¡ï¼ˆæ ¹æ®ä¸»é¢˜æ–‡ä»¶ç­‰ä¼˜åŒ–æ ·å¼ï¼‰ã€‚\nunpolish()ï¼šæ’¤é”€QStyleå¯¹è±¡çš„åˆå§‹åŒ–ã€‚\ndrawControl()ï¼šä¸ºæŒ‡å®šçš„GUIæ§ä»¶ç»˜åˆ¶æ ·å¼ã€‚\nstyleHint()ï¼šæ£€ç´¢æŒ‡å®šGUIæ ·å¼çš„æç¤ºä¿¡æ¯ã€‚\npixelMetric()ï¼šæ£€æŸ¥ç‰¹å®šçš„åƒç´ åº¦é‡å€¼ã€‚\n\nä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ¼”ç¤ºå¦‚ä½•å°†åŸç”Ÿé£æ ¼çš„æŒ‰é’®æ”¹æˆçº¢è‰²èƒŒæ™¯ï¼š\n12345678910111213141516171819202122232425class RedButtonStyle : public QProxyStyle&#123;public:    QRect subElementRect(SubElement element, const QStyleOption *option, const QWidget *widget) const override    &#123;        if (element == SE_PushButtonContents)            return option-&gt;rect;        else            return QProxyStyle::subElementRect(element, option, widget);    &#125;    void drawPrimitive(PrimitiveElement element, const QStyleOption *option, QPainter *painter, const QWidget *widget) const override    &#123;        if (element == PE_PanelButtonCommand) &#123;            QBrush brush(QColor(Qt::red));            painter-&gt;fillRect(option-&gt;rect, brush);        &#125;        else &#123;            QProxyStyle::drawPrimitive(element, option, painter, widget);        &#125;    &#125;&#125;;QPushButton* redButton = new QPushButton(&quot;Red Button&quot;);redButton-&gt;setStyle(new RedButtonStyle);\n\nç»“è®ºæ€»ä¹‹ï¼ŒQStyleå¯ä»¥å¸®åŠ©Qtåº”ç”¨ç¨‹åºè‡ªå®šä¹‰å¤–è§‚é£æ ¼å¹¶å®ç°å„ç§æ§ä»¶çš„æ¸²æŸ“æ•ˆæœã€‚QStyleå…è®¸å¼€å‘äººå‘˜è‡ªå®šä¹‰çª—å£éƒ¨ä»¶å’Œæ§ä»¶çš„æ ·å¼ä»¥åŠå¤§å°ã€é¢œè‰²ã€å­—ä½“å’ŒçŸ¢é‡å›¾æ ‡ç­‰å±æ€§ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•ç»§æ‰¿å¹¶é‡å†™å¯¹åº”çš„å‡½æ•°ï¼Œè‡ªå®šä¹‰Qtåº”ç”¨ç¨‹åºçš„å¤–è§‚å’Œè§†è§‰æ•ˆæœã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QStyleçš„ä»‹ç»","date":"2021-10-18T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"9e97b4c65e3bc73c141685e2a659e85b","title":"QMetaObject::invokeMethod()çš„ä»‹ç»","content":"QMetaObject::invokeMethod()çš„ä»‹ç»åœ¨Qtæ¡†æ¶ä¸­ï¼ŒQMetaObjectç±»æä¾›äº†ä¸€äº›åå°„æœºåˆ¶å¯ä»¥å®ç°ç±»ä¼¼äºJavaåå°„æœºåˆ¶çš„åŠŸèƒ½ã€‚å…¶ä¸­ä¸€ä¸ªå‡½æ•°å°±æ˜¯QMetaObject::invokeMethod()ï¼Œå®ƒå¯ä»¥é€šè¿‡å­—ç¬¦ä¸²è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æ”¯æŒå¼‚æ­¥æ‰§è¡Œå’Œè·¨çº¿ç¨‹æ“ä½œç­‰ç‰¹æ€§ã€‚\nä½¿ç”¨æ–¹æ³•QMetaObject::invokeMethod()æ–¹æ³•æœ‰å¤šä¸ªé‡è½½ï¼Œæœ€å¸¸ç”¨çš„æ ¼å¼å¦‚ä¸‹ï¼š\n12345678910111213bool QMetaObject::invokeMethod(QObject *obj, const char *method,        Qt::ConnectionType type = Qt::AutoConnection,        QGenericReturnArgument ret = QGenericReturnArgument(),        QGenericArgument val0 = QGenericArgument(),        QGenericArgument val1 = QGenericArgument(),        QGenericArgument val2 = QGenericArgument(),        QGenericArgument val3 = QGenericArgument(),        QGenericArgument val4 = QGenericArgument(),        QGenericArgument val5 = QGenericArgument(),        QGenericArgument val6 = QGenericArgument(),        QGenericArgument val7 = QGenericArgument(),        QGenericArgument val8 = QGenericArgument(),        QGenericArgument val9 = QGenericArgument());\n\n\nobjï¼šè¦è°ƒç”¨æ–¹æ³•çš„QObjectå¯¹è±¡æŒ‡é’ˆã€‚\nmethodï¼šéœ€è¦è°ƒç”¨çš„æ–¹æ³•åå­—ç¬¦ä¸²ã€‚\ntypeï¼šè¿æ¥ç±»å‹ï¼Œå†³å®šè°ƒç”¨æ–¹æ³•çš„çº¿ç¨‹ä»¥åŠè°ƒç”¨å½¢å¼ã€‚å…¶å€¼å¯ä»¥æ˜¯Qt::DirectConnectionï¼ˆåŒæ­¥ç›´æ¥è°ƒç”¨ï¼‰ã€Qt::QueuedConnectionï¼ˆå¼‚æ­¥æ’é˜Ÿè°ƒç”¨ï¼‰å’ŒQt::AutoConnectionï¼ˆæ ¹æ®çº¿ç¨‹è‡ªåŠ¨é€‰æ‹©åŒæ­¥ç›´æ¥è°ƒç”¨æˆ–å¼‚æ­¥æ’é˜Ÿè°ƒç”¨ï¼‰ã€‚\nretï¼šè¿”å›å€¼ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨QGenericReturnArgumentåˆ†åˆ«ä¼ å…¥ä¸åŒçš„è¿”å›ç±»å‹ï¼Œé€šå¸¸ä¸ºvoidã€‚\nval0ï½val9ï¼šå¯é€‰çš„åä¸ªå‚æ•°å€¼ï¼Œæ ¹æ®éœ€è¦ä¼ é€’ã€‚\n\nä½¿ç”¨ç¤ºä¾‹ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨QMetaObject::invokeMethod()æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡å‡½æ•°çš„ä¾‹å­ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#include &lt;QThread&gt;#include &lt;QDebug&gt;class MyWorker : public QObject&#123;    Q_OBJECTpublic:    explicit MyWorker(QObject *parent = nullptr) : QObject(parent) &#123;&#125;signals:    void finished();    void progressMade(int value);public slots:    void doWork()    &#123;        for (int i = 0; i &lt;= 100; ++i) &#123;            emit progressMade(i);            QThread::msleep(50);        &#125;        emit finished();    &#125;&#125;;class MyObject : public QObject&#123;    Q_OBJECTpublic:    explicit MyObject(QObject *parent = nullptr) : QObject(parent) &#123;&#125;public slots:    void onWorkerFinished()    &#123;        qDebug() &lt;&lt; &quot;Worker finished.&quot;;    &#125;    void onWorkerProgressMade(int value)    &#123;        qDebug() &lt;&lt; &quot;Progress made:&quot; &lt;&lt; value;    &#125;&#125;;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    MyWorker worker;    MyObject obj;    QObject::connect(&amp;worker, &amp;MyWorker::finished,                     &amp;a, &amp;QCoreApplication::quit);    QObject::connect(&amp;worker, &amp;MyWorker::progressMade,                     &amp;obj, &quot;onWorkerProgressMade&quot;);    QMetaObject::invokeMethod(&amp;worker, &quot;doWork&quot;);    return a.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªMyWorkerç±»å’Œä¸€ä¸ªMyObjectç±»ã€‚å…¶ä¸­MyWorkerç±»æ˜¯ä¸€ä¸ªè®¡æ—¶å™¨ç±»ï¼Œé€šè¿‡å‘å°„ä¿¡å·å‘Šè¯‰å¤–éƒ¨å·¥ä½œè¿›åº¦æƒ…å†µã€‚å¦ä¸€æ–¹é¢ï¼ŒMyObjectç±»æä¾›äº†ä¸¤ä¸ªæ§½å‡½æ•°onWorkerFinished()å’ŒonWorkerProgressMade()ï¼Œç”¨äºå¤„ç†MyWorkerç±»çš„ä¿¡å·ã€‚\nåœ¨mainå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†workerå’Œobjå¯¹è±¡ï¼Œç„¶åä½¿ç”¨&amp;worker, &quot;doWork&quot;è¿™ç§æ–¹å¼ï¼ˆå³å­—ç¬¦ä¸²è°ƒç”¨ï¼‰æ¥è°ƒç”¨MyWorkerç±»ä¸­çš„doWork()æ–¹æ³•ï¼Œå®ç°å¼‚æ­¥æ“ä½œå¹¶æ‰§è¡Œworkerå¯¹è±¡çš„è®¡æ—¶å™¨æ“ä½œã€‚\næ³¨æ„äº‹é¡¹\næ–¹æ³•åå­—ç¬¦ä¸²å¿…é¡»ä¸æ§½å‡½æ•°åæˆ–è€…ä¿¡å·åå­—åŒ¹é…ã€‚\nåªæœ‰å…¬å…±æ§½å‡½æ•°æ‰èƒ½ä½¿ç”¨è¯¥æ–¹æ³•è°ƒç”¨ï¼Œæ— æ³•è°ƒç”¨ç§æœ‰ã€ä¿æŠ¤æ§½å‡½æ•°åŠä»»ä½•é™æ€å‡½æ•°ã€‚\nå‚æ•°æ ¹æ®è°ƒç”¨çš„å‡½æ•°éœ€è¦è‡ªè¡Œé…ç½®ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„å‚æ•°é¡ºåºå’Œæ•°æ®ç±»å‹ã€‚\nè°ƒç”¨æ—¶éœ€è¦ä¿è¯ç›®æ ‡å¯¹è±¡å·²ç»å®Œæˆæ„é€ ï¼Œå¹¶ä¸”å¤„äºåˆæ³•çŠ¶æ€ã€‚\n\nç»“è®ºæ€»ä¹‹ï¼ŒQMetaObject::invokeMethod()å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åå°„è°ƒç”¨æ–¹æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬é¿å…åœ¨è·¨çº¿ç¨‹ä¿¡å·è¿æ¥ä¸­é¢‘ç¹è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œç®€åŒ–ä»£ç æµç¨‹ï¼Œå¸¦æ¥æ›´å¥½çš„ç¼–ç¨‹ä½“éªŒã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/invokeMethodçš„ä»‹ç»","date":"2021-10-18T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ce4d369535f0325ae64c13ca955fe4c5","title":"ä½¿ç”¨Qtå®ç°HTTPä¸­GETã€POSTã€PUTã€DELETE","content":"ä½¿ç”¨Qtå®ç°HTTPä¸­GETã€POSTã€PUTã€DELETEåœ¨ç°ä»£çš„åº”ç”¨ç¨‹åºä¸­ï¼Œç½‘ç»œè¿æ¥å·²æˆä¸ºä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚è¿™å°±æ„å‘³ç€æ‚¨å¿…é¡»ç¼–å†™ä»£ç æ¥æ‰§è¡Œå„ç§è¯·æ±‚å’Œå“åº”æ“ä½œã€‚æœ¬æ–‡å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨Qtåº“æ¥å®ç°HTTPä¸­GETã€POSTã€PUTã€DELETEç­‰åŸºæœ¬è¯·æ±‚ï¼Œå¹¶è§£é‡Šæ¯ä¸ªè¯·æ±‚è¡ŒåŠ¨èƒŒåçš„é‡è¦ç»†èŠ‚å’Œé€‰é¡¹ã€‚\nå‰ç½®æ¡ä»¶é¦–å…ˆï¼Œç¡®ä¿æ‚¨çš„é¡¹ç›®å·²æ­£ç¡®é“¾æ¥Qtç½‘ç»œæ¨¡å—å¹¶åŒ…å«å®ƒæ‰€éœ€çš„å¤´æ–‡ä»¶ï¼š\n123#include &lt;QNetworkAccessManager&gt;#include &lt;QNetworkRequest&gt;#include &lt;QNetworkReply&gt;\n\nGETè¯·æ±‚GETè¯·æ±‚æ˜¯æœ€å¸¸è§çš„HTTPè¯·æ±‚ç±»å‹ä¹‹ä¸€ã€‚æ­¤è¯·æ±‚ç±»å‹ä»æœåŠ¡å™¨è¯·æ±‚æŒ‡å®šçš„èµ„æºï¼Œæ²¡æœ‰è¯·æ±‚æ­£æ–‡ï¼Œä»…æœ‰URLå’Œè¯·æ±‚å¤´ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨Qtçš„GETè¯·æ±‚çš„ç¤ºä¾‹ï¼š\n1234567891011121314151617void performGetRequest(QUrl url)&#123;    QNetworkAccessManager manager;    QNetworkRequest request(url);    QNetworkReply* reply = manager.get(request);    connect(reply, &amp;QNetworkReply::finished, [reply]()&#123;        if (reply-&gt;error() != QNetworkReply::NoError) &#123;            qDebug() &lt;&lt; &quot;Error in performing get request: &quot; &lt;&lt; reply-&gt;errorString();            reply-&gt;deleteLater();            return;        &#125;        QByteArray data = reply-&gt;readAll();        qDebug() &lt;&lt; &quot;Received data: &quot; &lt;&lt; data;        reply-&gt;deleteLater();    &#125;);&#125;\n\næˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªQNetworkAccessManagerå¯¹è±¡ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªQNetworkRequestï¼Œç„¶åä½¿ç”¨get()å‡½æ•°æ‰§è¡ŒGETè¯·æ±‚ã€‚æˆ‘ä»¬ä½¿ç”¨finished()ä¿¡å·å’Œä¸€ä¸ªlambdaè¡¨è¾¾å¼æ¥è¯»å–å“åº”æ•°æ®å¹¶æ¸…ç†èµ„æºã€‚\nPOSTè¯·æ±‚POSTè¯·æ±‚æ˜¯å‘WebæœåŠ¡å™¨æäº¤ä¿¡æ¯çš„å¸¸è§æ–¹æ³•ã€‚ä¸GETè¯·æ±‚ä¸åŒï¼ŒPOSTåŒ…å«è¯·æ±‚æ­£æ–‡ï¼Œå¹¶ä¸”é€šå¸¸ç”¨äºå°†è¡¨å•æ•°æ®æäº¤åˆ°æœåŠ¡å™¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•ä½¿ç”¨Qtä¸­POSTè¯·æ±‚çš„ç¤ºä¾‹ï¼š\n1234567891011121314151617181920212223242526void performPostRequest(QUrl url, QVariantMap data)&#123;    QNetworkAccessManager manager;    QNetworkRequest request(url);    request.setHeader(QNetworkRequest::ContentTypeHeader, &quot;application/x-www-form-urlencoded&quot;);    QByteArray postData;    for (auto key : data.keys()) &#123;        postData.append(key.toLatin1()).append(&quot;=&quot;).append(data[key].toByteArray()).append(&quot;&amp;&quot;);    &#125;    if (postData.endsWith(&quot;&amp;&quot;)) &#123;        postData.chop(1);    &#125;    QNetworkReply* reply = manager.post(request, postData);    connect(reply, &amp;QNetworkReply::finished, [reply]()&#123;        if (reply-&gt;error() != QNetworkReply::NoError) &#123;            qDebug() &lt;&lt; &quot;Error in performing post request: &quot; &lt;&lt; reply-&gt;errorString();            reply-&gt;deleteLater();            return;        &#125;        QByteArray data = reply-&gt;readAll();        qDebug() &lt;&lt; &quot;Received data: &quot; &lt;&lt; data;        reply-&gt;deleteLater();    &#125;);&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªQNetworkRequestå¹¶ä¸ºå…¶è®¾ç½®ä¸€äº›HTTPæ ‡å¤´ï¼Œç„¶åå°†æ•°æ®æ˜ å°„åˆ°postè¯·æ±‚æ­£æ–‡ä¸­ï¼Œæœ€åä½¿ç”¨post()å‡½æ•°æ‰§è¡ŒPOSTè¯·æ±‚ã€‚åŒæ ·ï¼Œä½¿ç”¨finished()ä¿¡å·å’Œä¸€ä¸ªlambdaè¡¨è¾¾å¼æ¥å¤„ç†å“åº”æ•°æ®ã€‚\nPUTè¯·æ±‚PUTè¯·æ±‚ä¸»è¦ç”¨äºæ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œå¯ä»¥ç”¨äºåˆ›å»ºæ–°èµ„æºã€‚ä¸POSTç±»ä¼¼ï¼ŒPUTè¯·æ±‚åŒ…å«ä¸€ä¸ªè¯·æ±‚æ­£æ–‡ã€‚ä¸‹é¢æ˜¯å¦‚ä½•åœ¨Qtä¸­æ‰§è¡ŒPUTè¯·æ±‚çš„ç¤ºä¾‹ï¼š\n1234567891011121314151617181920212223void performPutRequest(QUrl url, QByteArray data)&#123;    QNetworkAccessManager manager;    QNetworkRequest request(url);    QBuffer *buffer = new QBuffer;    buffer-&gt;setData(data);    request.setHeader(QNetworkRequest::ContentTypeHeader, &quot;application/octet-stream&quot;);    QNetworkReply* reply = manager.put(request, buffer);    connect(reply, &amp;QNetworkReply::finished, [reply, buffer]()&#123;        if (reply-&gt;error() != QNetworkReply::NoError) &#123;            qDebug() &lt;&lt; &quot;Error in performing put request: &quot; &lt;&lt; reply-&gt;errorString();            reply-&gt;deleteLater();            buffer-&gt;deleteLater();            return;        &#125;        QByteArray responseData = reply-&gt;readAll();        qDebug() &lt;&lt; &quot;Received data: &quot; &lt;&lt; responseData;        reply-&gt;deleteLater();        buffer-&gt;deleteLater();    &#125;);&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘QBufferå¯¹è±¡çš„æŒ‡é’ˆï¼Œå®ƒç”¨äºä¼ é€’æ•°æ®ä¸»ä½“å’Œç®¡ç†å†…å­˜ã€‚å¯é€‰åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›HTTPæ ‡å¤´ã€‚\nDELETEè¯·æ±‚DELETEè¯·æ±‚ç”¨äºåˆ é™¤æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œé€šå¸¸ç”¨äºåˆ é™¤æ–‡ä»¶æˆ–æ¢å¤ä»æ•°æ®åº“åˆ é™¤çš„æ¡ç›®ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨Qtæ‰§è¡ŒDELETEè¯·æ±‚çš„ç¤ºä¾‹ï¼š\n1234567891011121314151617void performDeleteRequest(QUrl url)&#123;    QNetworkAccessManager manager;    QNetworkRequest request(url);    QNetworkReply* reply = manager.deleteResource(request);    connect(reply, &amp;QNetworkReply::finished, [reply]()&#123;        if (reply-&gt;error() != QNetworkReply::NoError) &#123;            qDebug() &lt;&lt; &quot;Error in performing delete request: &quot; &lt;&lt; reply-&gt;errorString();            reply-&gt;deleteLater();            return;        &#125;        QByteArray responseData = reply-&gt;readAll();        qDebug() &lt;&lt; &quot;Deleted data: &quot; &lt;&lt; responseData;        reply-&gt;deleteLater();    &#125;&#125;\n\næˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªQNetworkAccessManagerå¯¹è±¡ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªQNetworkRequestï¼Œç„¶åä½¿ç”¨deleteResource()å‡½æ•°æ‰§è¡ŒGETè¯·æ±‚ã€‚æˆ‘ä»¬ä½¿ç”¨finished()ä¿¡å·å’Œä¸€ä¸ªlambdaè¡¨è¾¾å¼æ¥è¯»å–å“åº”æ•°æ®å¹¶æ¸…ç†èµ„æºã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä½¿ç”¨Qtå®ç°HTTPä¸­GETã€POSTã€PUTã€DELETE","date":"2021-10-18T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ff14916e39f6b95778b03aff03b57cd4","title":"ä½¿ç”¨Qtè¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œ","content":"ä½¿ç”¨Qtè¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œåœ¨ç°ä»£åº”ç”¨ç¨‹åºä¸­ï¼Œå¤„ç†æ–‡ä»¶è¯»å†™æ“ä½œæ˜¯ä¸€é¡¹éå¸¸å¸¸è§çš„ä»»åŠ¡ã€‚Qtæä¾›äº†è®¸å¤šå·¥å…·æ¥è½»æ¾åœ°è¯»å†™æ–‡ä»¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Qtç¼–å†™æ–‡ä»¶è¯»å†™ä»£ç ã€‚\nQFileç±»QFileæ˜¯Qtä¸­ç”¨äºæ–‡ä»¶è¯»å†™çš„æ ¸å¿ƒç±»ä¹‹ä¸€ã€‚è¦ä½¿ç”¨å®ƒè¿›è¡Œè¯»å†™æ“ä½œï¼Œéœ€è¦é€šè¿‡åˆ›å»ºä¸€ä¸ªQFileå¯¹è±¡æ¥æ‰“å¼€æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œè¦æ‰“å¼€ä¸€ä¸ªåä¸ºexample.txtçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å°†å…¶è¯»å…¥åˆ°ä¸€ä¸ªQByteArrayä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š\n12345678910111213141516171819202122#include &lt;QFile&gt;#include &lt;QDebug&gt;int main()&#123;    const QString fileName = &quot;example.txt&quot;;    QFile file(fileName);    if (!file.open(QIODevice::ReadOnly)) &#123;        qDebug() &lt;&lt; &quot;Failed to open file:&quot; &lt;&lt; fileName;        return -1;    &#125;    QByteArray content = file.readAll();    qDebug() &lt;&lt; &quot;Content of file:&quot; &lt;&lt; fileName &lt;&lt; &quot;:&quot; &lt;&lt; endl &lt;&lt; content;    file.close();    return 0;&#125;\n\nè¦å°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨openå‡½æ•°æ¥ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åå¯ä»¥è°ƒç”¨writeå‡½æ•°ï¼Œä¼ å…¥è¦åŒ…å«åœ¨æ–‡ä»¶ä¸­çš„å­—èŠ‚çš„æŒ‡é’ˆå’Œå­—èŠ‚æ•°ï¼š\n12345678910111213141516171819202122#include &lt;QFile&gt;#include &lt;QDebug&gt;int main()&#123;    const QString fileName = &quot;example.txt&quot;;    QFile file(fileName);    if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) &#123;        qDebug() &lt;&lt; &quot;Failed to open file:&quot; &lt;&lt; fileName;        return -1;    &#125;    QByteArray content = &quot;Hello, world!&quot;;    file.write(content);    file.close();    return 0;&#125;\n\nQTextStreamç±»QTextStreamæ˜¯Qtä¸­ç”¨äºæ–‡æœ¬æ–‡ä»¶è¯»å†™çš„å¦ä¸€ä¸ªæ ¸å¿ƒç±»ã€‚å®ƒå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–ç ï¼ŒåŒ…æ‹¬UTF-8ã€UTF-16ç­‰ã€‚ä¾‹å¦‚ï¼Œè¦å°†å†…å®¹ä¿å­˜ä¸ºUTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š\n123456789101112131415161718192021222324#include &lt;QFile&gt;#include &lt;QTextStream&gt;#include &lt;QDebug&gt;int main()&#123;    const QString fileName = &quot;example.txt&quot;;    QFile file(fileName);    if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) &#123;        qDebug() &lt;&lt; &quot;Failed to open file:&quot; &lt;&lt; fileName;        return -1;    &#125;    QTextStream out(&amp;file);    out.setCodec(&quot;UTF-8&quot;);    out &lt;&lt; &quot;Hello, world!&quot; &lt;&lt; endl;    file.close();    return 0;&#125;\n\nè¯»å–UTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶åŒæ ·ç®€å•ï¼š\n1234567891011121314151617181920212223242526#include &lt;QFile&gt;#include &lt;QTextStream&gt;#include &lt;QDebug&gt;int main()&#123;    const QString fileName = &quot;example.txt&quot;;    QFile file(fileName);    if (!file.open(QIODevice::ReadOnly | QIODevice::Text)) &#123;        qDebug() &lt;&lt; &quot;Failed to open file:&quot; &lt;&lt; fileName;        return -1;    &#125;    QTextStream in(&amp;file);    in.setCodec(&quot;UTF-8&quot;);    QString content = in.readAll();    qDebug() &lt;&lt; &quot;Content of file:&quot; &lt;&lt; fileName &lt;&lt; &quot;:&quot; &lt;&lt; endl &lt;&lt; content;    file.close();    return 0;&#125;\n\nç»“è®ºåœ¨Qtä¸­ï¼Œæ–‡ä»¶è¯»å†™æ“ä½œéå¸¸ç®€å•ã€‚é€šè¿‡ä½¿ç”¨QFileå’ŒQTextStreamç±»ï¼Œå¯ä»¥è½»æ¾åœ°è¯»å†™å„ç§ç±»å‹çš„æ–‡ä»¶ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä½¿ç”¨Qtè¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œ","date":"2021-10-18T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c11d7ff241d9d77db46fba39f11f66e8","title":"ä½¿ç”¨Qtå®ç°JSONæ•°æ®çš„è§£æå’Œæ„å»º","content":"ä½¿ç”¨Qtå®ç°JSONæ•°æ®çš„è§£æå’Œæ„å»ºä»‹ç»åœ¨ç°ä»£åº”ç”¨ç¨‹åºä¸­ï¼Œå¤„ç†JSONæ•°æ®æ˜¯ä¸€é¡¹éå¸¸å¸¸è§çš„ä»»åŠ¡ã€‚Qtæä¾›äº†è®¸å¤šå·¥å…·æ¥è½»æ¾åœ°å¯¹JSONæ•°æ®è¿›è¡Œè§£æå’Œæ„å»ºã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Qtæ¡†æ¶çš„QJsonDocumentç±»æ¥è§£æå’Œæ„å»ºJSONæ•°æ®ã€‚\nè§£æJSONæ•°æ®è¦è§£æJSONæ•°æ®ï¼Œåœ¨Qtä¸­ä½¿ç”¨QJsonDocumentç±»ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹JSONæ–‡ä»¶ï¼š\n123456789101112&#123;    &quot;name&quot;: &quot;John Smith&quot;,    &quot;age&quot;: 30,    &quot;isMarried&quot;: true,    &quot;hobbies&quot;: [&quot;music&quot;, &quot;sports&quot;, &quot;reading&quot;],    &quot;address&quot;: &#123;        &quot;street&quot;: &quot;123 Main St&quot;,        &quot;city&quot;: &quot;Anytown&quot;,        &quot;state&quot;: &quot;CA&quot;,        &quot;zip&quot;: &quot;12345&quot;    &#125;&#125;\n\nä½¿ç”¨QJsonDocumentç±»ï¼Œå¯ä»¥å°†è¿™äº›æ•°æ®è§£æä¸ºä¸€ä¸ªQJsonObjectå¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n12345678910111213141516171819202122232425262728293031323334353637#include &lt;QFile&gt;#include &lt;QDebug&gt;#include &lt;QJsonDocument&gt;int main(int argc, char **argv)&#123;    QString filename = &quot;example.json&quot;;    QFile file(filename);    if (!file.open(QIODevice::ReadOnly)) &#123;        qWarning() &lt;&lt; &quot;Failed to open file:&quot; &lt;&lt; filename;        return -1;    &#125;    QByteArray data = file.readAll();    QJsonParseError error;    QJsonDocument doc = QJsonDocument::fromJson(data, &amp;error);    if (doc.isNull()) &#123;        qWarning() &lt;&lt; &quot;Failed to parse JSON:&quot; &lt;&lt; error.errorString();        return -1;    &#125;    QJsonObject obj = doc.object();    // Access the data in the object    QString name = obj.value(&quot;name&quot;).toString();    int age = obj.value(&quot;age&quot;).toInt();    QJsonArray hobbies = obj.value(&quot;hobbies&quot;).toArray();    foreach (const QJsonValue &amp; v, hobbies) &#123;        qDebug() &lt;&lt; v.toString();    &#125;    return 0;&#125;\n\nè¿™ä¸ªä¾‹å­æ‰“å¼€example.jsonæ–‡ä»¶ï¼Œå¹¶å°†å…¶è¯»å–åˆ°ä¸€ä¸ªQByteArrayä¸­ã€‚ç„¶åï¼Œä½¿ç”¨QJsonDocument::fromJson()æ–¹æ³•å°†æ•°æ®è§£æä¸ºä¸€ä¸ªQJsonDocumentå¯¹è±¡ã€‚å¦‚æœè§£ææˆåŠŸï¼Œå¯ä»¥è°ƒç”¨QJsonDocument::object()æ–¹æ³•ä»¥è·å–å…¶ä¸­çš„QJsonObjectã€‚\nä»»ä½•åœ¨QJsonObjectä¸­å­˜å‚¨çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨QJsonValueç±»å‹è®¿é—®ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨QJsonObject::value()æ‰¾åˆ°JSONå€¼ï¼Œå¹¶ä½¿ç”¨ç›¸åº”çš„QJsonValue::to*()æ–¹æ³•è·å–å®ƒã€‚\næ„å»ºJSONæ•°æ®è¦æ„å»ºJSONæ•°æ®ï¼Œè¯·ä½¿ç”¨QJsonDocumentå’Œå…¶æ”¯æŒçš„ç±»ã€‚å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸å‰é¢æåˆ°çš„JSONæ•°æ®ç»“æ„ç±»ä¼¼çš„å¯¹è±¡ã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨QJsonObjectå’ŒQJsonArrayç±»æ¥æ„å»ºå®ƒï¼š\n123456789101112131415161718192021222324252627282930313233#include &lt;QDebug&gt;#include &lt;QJsonDocument&gt;#include &lt;QJsonObject&gt;#include &lt;QJsonArray&gt;int main(int argc, char **argv)&#123;    QJsonObject obj;    obj.insert(&quot;name&quot;, &quot;John Smith&quot;);    obj.insert(&quot;age&quot;, 30);    obj.insert(&quot;isMarried&quot;, true);    QJsonArray hobbies;    hobbies.append(&quot;music&quot;);    hobbies.append(&quot;sports&quot;);    hobbies.append(&quot;reading&quot;);    obj.insert(&quot;hobbies&quot;, hobbies);    QJsonObject address;    address.insert(&quot;street&quot;, &quot;123 Main St&quot;);    address.insert(&quot;city&quot;, &quot;Anytown&quot;);    address.insert(&quot;state&quot;, &quot;CA&quot;);    address.insert(&quot;zip&quot;, &quot;12345&quot;);    obj.insert(&quot;address&quot;, address);    QJsonDocument doc(obj);    qDebug() &lt;&lt; doc.toJson();    return 0;&#125;\n\nåœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªQJsonObjectï¼Œå¹¶å°†ä¸€äº›é”®å€¼å¯¹æ·»åŠ åˆ°å¯¹è±¡ä¸­ã€‚ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªQJsonArrayï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å¯¹è±¡ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜åˆ›å»ºä¸€ä¸ªåµŒå¥—çš„QJsonObjectå¹¶å°†å…¶æ·»åŠ åˆ°ä¸»å¯¹è±¡ä¸­ã€‚\nè¦å°†QJsonObjectè½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œè¯·ä½¿ç”¨QJsonDocument::toJson()æ–¹æ³•ã€‚æ­¤æ–¹æ³•è¿”å›åŒ…å«å¯¹è±¡æ•°æ®çš„QByteArrayã€‚\nç»“è®ºåœ¨Qtä¸­ï¼Œå¤„ç†JSONæ•°æ®éå¸¸ç®€å•ã€‚ä½¿ç”¨QJsonDocumentå’Œæ”¯æŒçš„ç±»å¯ä»¥è½»æ¾åœ°è§£æå’Œæ„å»ºJSONæ•°æ®ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/ä½¿ç”¨Qtå®ç°JSONæ•°æ®çš„è§£æå’Œæ„å»º","date":"2021-10-14T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"6be795b38460ae66925a200f50747cea","title":"QDebugï¼šQtä¸­çš„è°ƒè¯•å·¥å…·","content":"QDebugï¼šQtä¸­çš„è°ƒè¯•å·¥å…·åœ¨å¼€å‘Qtåº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§å¯é çš„æ–¹æ³•æ¥æ£€æŸ¥ä»£ç å’Œæ’é™¤é”™è¯¯ã€‚QPlainTextEditæ˜¯ä¸€ä¸ªç”¨äºè¾“å‡ºè°ƒè¯•ä¿¡æ¯çš„åŸºæœ¬æ–¹æ³•ï¼Œä½†Qtæ¡†æ¶è¿˜æä¾›äº†ä¸€ä¸ªæ›´å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„è°ƒè¯•å·¥å…·ï¼šQDebugã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»QDebugç±»çš„åŠŸèƒ½å’Œåº”ç”¨åœºæ™¯ã€‚\nä½¿ç”¨QDebugè¾“å‡ºè°ƒè¯•ä¿¡æ¯QDebugæ˜¯Qtä¸­ç”¨äºè¾“å‡ºè°ƒè¯•ä¿¡æ¯çš„å¼ºå¤§å·¥å…·ï¼Œå¯ä»¥è¾“å‡ºå„ç§ç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¯¹è±¡ç­‰ã€‚ä¸ºäº†ä½¿ç”¨QDebugï¼Œæˆ‘ä»¬éœ€è¦åŒ…å«å…¶å¤´æ–‡ä»¶å¹¶ä½¿ç”¨qDebug()å®æ¥è¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€‚\nä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨QDebugè¾“å‡ºâ€œHello, World!â€ï¼š\n123456#include &lt;QDebug&gt;int main() &#123;    qDebug() &lt;&lt; &quot;Hello, World!&quot;;    return 0;&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒ…å«QDebugå¤´æ–‡ä»¶å¹¶è°ƒç”¨qDebug()å®æ¥è¾“å‡ºä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ã€‚â€œ&lt;&lt;â€ç¬¦å·ç”¨äºåœ¨qDebug()å®ä¸­åˆ†éš”å¤šä¸ªå‚æ•°ï¼Œå¯ä»¥è¾“å‡ºä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œè€Œæ— éœ€ä½¿ç”¨å…¶ä»–ç‰¹å®šçš„æ ¼å¼è¯´æ˜ç¬¦ã€‚\nè¾“å‡ºQtæ•°æ®ç±»å‹é™¤äº†å¸¸è§„æ•°æ®ç±»å‹ï¼ŒQDebugè¿˜æ”¯æŒè¾“å‡ºQtç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚QStringã€QByteArrayå’ŒQVariantç­‰ã€‚è¿™äº›æ•°æ®ç±»å‹ä¸ä»…å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“åœ°è·Ÿè¸ªåé¦ˆåˆ°åº”ç”¨ç¨‹åºçš„æ•°æ®ï¼Œè¿˜æä¾›äº†æ›´é«˜çš„çµæ´»æ€§å’Œå¯è¯»æ€§ã€‚\nä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨QDebugè¾“å‡ºä¸€ä¸ªQStringï¼š\n12345678#include &lt;QDebug&gt;#include &lt;QString&gt;int main() &#123;    QString data = &quot;Hello, World!&quot;;    qDebug() &lt;&lt; &quot;Outputting string using QDebug:&quot; &lt;&lt; data;    return 0;&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒ…å«QStringå¤´æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œdataâ€çš„å­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨qDebug()å®å¹¶å°†å…¶ä¸å­—ç¬¦ä¸²â€œOutputting string using QDebug:â€å’Œåä¸ºâ€œdataâ€çš„QStringä¸€èµ·ä½¿ç”¨ï¼Œä»¥é¿å…è¾“å‡ºå¤šè¡Œæ–‡æœ¬ã€‚\nä½¿ç”¨QDebugè§‚å¯Ÿå¯¹è±¡çŠ¶æ€é™¤äº†ä»¥ä¸Šåº”ç”¨åœºæ™¯ä¹‹å¤–ï¼ŒQDebugè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬è·Ÿè¸ªå¯¹è±¡çš„çŠ¶æ€å’Œè°ƒè¯•é”™è¯¯ã€‚å½“å¯¹è±¡åœ¨è¿è¡Œæ—¶å‡ºç°é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QDebugå¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚\nä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨QDebugè·Ÿè¸ªQWidgetå¯¹è±¡çš„çŠ¶æ€ï¼š\n12345678910111213#include &lt;QDebug&gt;#include &lt;QWidget&gt;int main() &#123;    QWidget widget;    widget.setGeometry(100, 100, 400, 300);    widget.show();    qDebug() &lt;&lt; &quot;Widget visibility&quot; &lt;&lt; widget.isVisible();    qDebug() &lt;&lt; &quot;Widget size&quot; &lt;&lt; widget.size();    return 0;&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªQWidgetå®ä¾‹ï¼Œå¹¶è®¾ç½®å…¶å¤§å°å’Œä½ç½®ï¼Œæ¥ç€ä½¿ç”¨qDebug()å®æ‰“å°widget isVisible() å’Œ size() çš„çŠ¶æ€ã€‚\nè¾“å‡ºè°ƒè¯•ä¿¡æ¯åˆ°æ–‡ä»¶æœ€åï¼ŒQDebugè¿˜æ”¯æŒå°†è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶è€Œä¸æ˜¯æ§åˆ¶å°ã€‚è¿™å¯¹äºåœ¨éœ€è¦é•¿æ—¶é—´è®°å½•è¾“å‡ºæ—¶éå¸¸æœ‰ç”¨ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦åœ¨æ§åˆ¶å°ä¹‹å¤–æŸ¥çœ‹å’Œåˆ†æè¾“å‡ºã€‚\nä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•å°†è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶ï¼š\n1234567891011121314#include &lt;QDebug&gt;#include &lt;QFile&gt;int main() &#123;    QFile file(&quot;output.txt&quot;);    if (!file.open(QIODevice::WriteOnly | QIODevice::Text))        return 1;    QTextStream out(&amp;file);    out &lt;&lt; &quot;Hello, World!&quot; &lt;&lt; endl;    qDebug().noquote().nospace() &lt;&lt; &quot;Outputted to a file:&quot; &lt;&lt; file.fileName();    return 0;&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åä¸ºâ€œoutput.txtâ€çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å¼€å®ƒä»¥ä¾¿äºå†™å…¥æ–‡æœ¬ï¼ˆæ³¨æ„QIODevice::Textæ ‡è®°ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨QTextStreamç±»ä»£æ›¿QDebugæ¥è¾“å‡ºä¸€äº›ä¿¡æ¯ã€‚â€œ&lt;&lt;â€ç¬¦å·ç”¨äºåœ¨è¾“å‡ºæ¶ˆæ¯ä¹‹é—´åˆ†ç¦»å¤šä¸ªå‚æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨qDebug()å®å°†è¾“å‡ºæ–‡ä»¶åç§°æ‰“å°åˆ°æ§åˆ¶å°ã€‚\nç»“è®ºQDebugæ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„è°ƒè¯•å·¥å…·ï¼Œåœ¨Qtåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒå¯ä»¥è½»æ¾åœ°è¿½è¸ªå¯¹è±¡çŠ¶æ€ã€è¾“å‡ºè°ƒè¯•ä¿¡æ¯åŠå®šä½é—®é¢˜ç­‰ã€‚é€šè¿‡ä½¿ç”¨QDebugï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¿«é€Ÿåœ°æµ‹è¯•å’Œè°ƒè¯•ä»£ç ï¼Œå¢åŠ æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/QDebugï¼šQtä¸­çš„è°ƒè¯•å·¥å…·","date":"2021-10-12T03:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"84bd6b5d625d0beb31de3b6ad48960fe","title":"QFontä¸­setPointSizeå’ŒsetPixelSizeçš„ä½œç”¨å’ŒåŒºåˆ«","content":"QFontä¸­setPointSizeå’ŒsetPixelSizeçš„ä½œç”¨å’ŒåŒºåˆ«åœ¨Qtåº”ç”¨ç¨‹åºä¸­ï¼Œå­—ä½“å¾€å¾€æ˜¯UIè®¾è®¡ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªå› ç´ ã€‚QFontç±»æ˜¯Qtæ¡†æ¶ä¸­è¡¨ç¤ºå­—ä½“çš„æ ¸å¿ƒç±»ï¼Œå®ƒæä¾›äº†è®¸å¤šæ–¹æ³•æ¥æŒ‡å®šå­—ä½“å¤–è§‚å’Œå¤§å°ç­‰å±æ€§ã€‚å…¶ä¸­ï¼ŒsetPointSize()å’ŒsetPixelSize()æ˜¯QFontä¸­æˆ‘ä»¬æœ€å¸¸è§ä¹Ÿéå¸¸å®ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ä¹‹ä¸€ï¼Œæœ¬æ–‡å°†ç»™å‡ºå®ƒä»¬çš„ä½œç”¨å’ŒåŒºåˆ«ã€‚\nsetPointSize()setPointSize()æ–¹æ³•æ˜¯QFontç±»çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥è®¾ç½®å­—ä½“çš„ç‚¹æ•°å¤§å°ã€‚å­—å·é€šå¸¸å‚æ•°æ˜¯æ•°å­—(N)ï¼Œå…¶é»˜è®¤å€¼ä¸ºï¼ˆ11ï¼‰ã€‚\nå½“æˆ‘ä»¬è°ƒç”¨setPointSize()æ–¹æ³•æ—¶ï¼ŒQFontå°†ç‚¹æ•°å¤§å°ä¸æ¯è‹±å¯¸ç‚¹æ•°åˆ†è¾¨ç‡ç»“åˆè®¡ç®—å‡ºæ¯ä¸ªå­—ç¬¦çš„é«˜åº¦ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœQFontMetricsè¿”å›åƒç´ æ•°ï¼Œåˆ™ä¼šå°†è¯¥å­—æ®µè½¬æ¢ä¸ºç‚¹æ•°å¤§å°ã€‚\nç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12QFont font(&quot;Times&quot;, 11);font.setPointSize(14);       // å°†å­—ä½“ç‚¹æ•°å¤§å°è®¾ç½®ä¸º 14\n\nåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œfontâ€çš„æ–°å­—ä½“å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å®ƒçš„setPointSize()æ–¹æ³•å°†ç‚¹æ•°å¤§å°è®¾ç½®ä¸º14ã€‚è¿™å°±æ„å‘³ç€æ­¤å­—ä½“çš„æ‰€æœ‰å­—ç¬¦éƒ½å°†å…·æœ‰14ä¸ªç‚¹çš„é«˜åº¦ã€‚\nsetPixelSize()setPixelSize()æ–¹æ³•æ˜¯QFontç±»çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå¯ä»¥è®¾ç½®å­—ä½“çš„åƒç´ å¤§å°ã€‚\nå½“ä½¿ç”¨setPixelSize()æ–¹æ³•æ—¶ï¼Œå­—ä½“çš„å¤§å°å°†ä»¥åƒç´ ä¸ºå•ä½è€Œä¸æ˜¯ç‚¹æ•°æ¥æµ‹é‡ã€‚æ³¨æ„ï¼šå¤§å°å®é™…ä¸Šä»ç„¶è¢«è§†ä¸ºç‚¹å€¼â€”â€”QFontMetricsåŸºäºå…¶å½“å‰åˆ†è¾¨ç‡å°†å…¶è½¬æ¢ä¸ºåƒç´ ã€‚\nç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12QFont font(&quot;Times&quot;, 11);font.setPixelSize(18);       // å°†å­—ä½“åƒç´ å¤§å°è®¾ç½®ä¸º 18\n\nåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œfontâ€çš„æ–°å­—ä½“å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å®ƒçš„setPixelSize()æ–¹æ³•å°†åƒç´ å¤§å°è®¾ç½®ä¸º18ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è‡³å°‘å¯èƒ½çš„QFontMetricsï¼ˆå³ä¸å±å¹•åˆ†è¾¨ç‡ç›¸åŒçš„å€¼ï¼‰ï¼Œæ­¤å­—ä½“å¯¹è±¡çš„æ¯ä¸ªå­—ç¬¦å°†å…·æœ‰18ä¸ªåƒç´ é«˜åº¦ã€‚\nåŒºåˆ«æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒsetPointSize()å’ŒsetPixelSize()éƒ½æä¾›äº†ä¸€ç§è®¾ç½®å­—ä½“å¤§å°çš„æ–¹æ³•ã€‚ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬ä½¿ç”¨çš„å•ä½ä¸åŒï¼šsetPointSize()æ–¹æ³•ä½¿ç”¨ç‚¹æ•°ä½œä¸ºå•ä½ï¼Œè€ŒsetPixelSize()æ–¹æ³•ä½¿ç”¨åƒç´ ä½œä¸ºå•ä½ã€‚å› æ­¤ï¼Œä¸åŒåˆ†è¾¨ç‡ä¸‹çš„å­—ä½“å®é™…æ˜¾ç¤ºæ•ˆæœä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚\né€šå¸¸æƒ…å†µä¸‹ï¼Œä¸ºäº†æ›´å¥½çš„UIæ•ˆæœï¼Œå»ºè®®ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨setPixelSize()æ–¹æ³•æ¥è®¾ç½®å­—ä½“å¤§å°ï¼Œä»¥ç¡®ä¿å­—ä½“åœ¨ä¸åŒè®¾å¤‡ä¸Šæ˜¾ç¤ºæ•ˆæœçš„ä¸€è‡´æ€§ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨åƒç´ å•ä½è®¾ç½®å­—ä½“å¤§å°å¯èƒ½å¯¼è‡´æ–‡å­—åœ¨é«˜åˆ†è¾¨ç‡è®¾å¤‡ä¸Šæ˜¾ç¤ºå¾—è¿‡å°æˆ–è¿‡å¤§ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œé€‰æ‹©ã€‚\nç»“è®ºåœ¨Qtåº”ç”¨ç¨‹åºä¸­ï¼Œå­—ä½“å¾€å¾€æ˜¯UIè®¾è®¡ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªå› ç´ ã€‚setPointSize()å’ŒsetPixelSize()æ–¹æ³•æ˜¯QFontç±»ä¸­æœ€åŸºæœ¬ã€å®ç”¨çš„è®¾ç½®å­—ä½“å¤§å°çš„æ–¹æ³•ä¹‹ä¸€ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºä½¿ç”¨çš„å•ä½å’Œå®é™…æ˜¾ç¤ºæ•ˆæœä¼šæœ‰æ‰€ä¸åŒï¼Œå› æ­¤åœ¨é€‰æ‹©æ—¶éœ€è¦ç»“åˆå…·ä½“éœ€æ±‚è¿›è¡Œé€‰æ‹©ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/QFontä¸­setPointSizeå’ŒsetPixelSizeçš„ä½œç”¨å’ŒåŒºåˆ«","date":"2021-10-05T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"41f212302bde8d9f69f32b4fddb39ad0","title":"Qtä¸­ä½¿ç”¨TCPæœåŠ¡ç«¯åŠå®¢æˆ·ç«¯","content":"Qtä¸­ä½¿ç”¨TCPæœåŠ¡ç«¯åŠå®¢æˆ·ç«¯TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯ä¸€ç§å¯é ã€é«˜åº¦ä¼˜åŒ–çš„äº’è”ç½‘é€šä¿¡åè®®ï¼Œå¹¿æ³›ç”¨äºå„ç±»ç½‘ç»œåº”ç”¨ç¨‹åºä¸­ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åœ¨Qtä¸­ä½¿ç”¨TCPæœåŠ¡ç«¯åŠå®¢æˆ·ç«¯ã€‚\nä½¿ç”¨Qtåˆ›å»ºTCPæœåŠ¡å™¨è¦ä½¿ç”¨Qtåˆ›å»ºTCPæœåŠ¡å™¨ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š\næ­¥éª¤1ï¼šåˆ›å»ºQTcpServerå¯¹è±¡1QTcpServer *server = new QTcpServer(this);\n\næ­¥éª¤2ï¼šç›‘å¬è¿æ¥è¯·æ±‚åœ¨å¼€å§‹ç›‘å¬ä¹‹å‰ï¼Œæ‚¨éœ€è¦ä½¿ç”¨listen()æ–¹æ³•æŒ‡å®šæœåŠ¡ç«¯å£å·å¹¶ç›‘å¬æ¥è‡ªç‰¹å®šIPåœ°å€çš„è¿æ¥è¯·æ±‚ã€‚\n12345if (!server-&gt;listen(QHostAddress::Any, 12345))&#123;    qDebug() &lt;&lt; &quot;Failed to start server&quot;;    return;&#125;\n\næ­¥éª¤3ï¼šå¤„ç†æ–°è¿æ¥è¯·æ±‚æ¯å½“ä¸€ä¸ªæ–°è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼ŒQTcpServerå°†é€šè¿‡å‘å°„newConnection()ä¿¡å·æ¥æç¤ºæ‚¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨accept()æ–¹æ³•æ¥æ¥å—è¯¥è¿æ¥ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„QTcpSocketå¯¹è±¡ä»¥è¿›è¡Œæ”¶å‘æ¶ˆæ¯ã€‚\n12345678910111213void MyTcpServer::newConnection()&#123;    QTcpSocket *socket = server-&gt;nextPendingConnection();    connect(socket, SIGNAL(readyRead()), this, SLOT(readData()));    connect(socket, SIGNAL(disconnected()), socket, SLOT(deleteLater()));&#125;void MyTcpServer::readData()&#123;    QTcpSocket *socket = static_cast&lt;QTcpSocket *&gt;(sender());    QByteArray data = socket-&gt;readAll();    // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®&#125;\n\næ­¥éª¤4ï¼šå‘é€æ•°æ®ä½¿ç”¨QTcpSocketçš„write()æ–¹æ³•å°†æ‚¨çš„æ•°æ®å‘é€åˆ°è¿æ¥çš„å®¢æˆ·ç«¯ã€‚\n1socket-&gt;write(&quot;Hello world&quot;);\n\nä½¿ç”¨Qtåˆ›å»ºTCPå®¢æˆ·ç«¯è¦ä½¿ç”¨Qtåˆ›å»ºTCPå®¢æˆ·ç«¯ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š\næ­¥éª¤1ï¼šåˆ›å»ºQTcpSocketå¯¹è±¡1QTcpSocket *m_socket = new QTcpSocket(this);\n\næ­¥éª¤2ï¼šè¿æ¥åˆ°æœåŠ¡å™¨ä½¿ç”¨connectToHost()æ–¹æ³•å°†socketè¿æ¥åˆ°ç›®æ ‡ä¸»æœºå’Œç«¯å£ã€‚è¿æ¥æˆåŠŸåï¼ŒQTcpSocketå°†å‘é€connected()ä¿¡å·ã€‚\n1m_socket-&gt;connectToHost(QHostAddress(&quot;127.0.0.1&quot;), 12345);\n\næ­¥éª¤3ï¼šå‘é€å’Œæ¥æ”¶æ•°æ®ä½¿ç”¨write()æ–¹æ³•å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œå¹¶é€šè¿‡readyRead()ä¿¡å·å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®ã€‚\n12345678910void MyTcpClient::sendData(QString data)&#123;    m_socket-&gt;write(data.toUtf8().constData());&#125;void MyTcpClient::readData()&#123;    QString data = m_socket-&gt;readAll();    // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®&#125;\n\næ€»ç»“åœ¨Qtä¸­ä½¿ç”¨TCPæœåŠ¡ç«¯åŠå®¢æˆ·ç«¯æ˜¯ä¸€ç§å¯é ã€é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚QTcpServerå’ŒQTcpSocketç±»æä¾›äº†ä¸€ä¸ªé¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿å¾—æ‚¨èƒ½å¤Ÿè½»æ¾åœ°å¼€å‘å‡ºå„ç§ç±»å‹çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚\nç„¶è€Œï¼Œè¯·æ³¨æ„å› å¤šç§åŸå› ï¼ˆä¾‹å¦‚ç½‘ç»œä¸­æ–­ã€è¿œç¨‹ä¸»æœºå…³é—­è¿æ¥ç­‰ï¼‰å¯¼è‡´çš„æ—¶å»¶å’Œå¼‚å¸¸æƒ…å†µï¼Œå¹¶ç¡®ä¿åœ¨ä»£ç ä¸­å¤„ç†è¿™äº›æƒ…å†µä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä¸­ä½¿ç”¨TCPæœåŠ¡ç«¯åŠå®¢æˆ·ç«¯","date":"2021-10-05T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5b80ee9c26ef869c27c39383e381d5b4","title":"Qtä¸­çš„æ—¶åŒº","content":"Qtä¸­çš„æ—¶åŒºåœ¨å¤„ç†æ—¥æœŸå’Œæ—¶é—´çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ—¶åŒºç›¸å…³çš„é—®é¢˜ä¸€ç›´æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚åœ¨Qtä¸­ï¼Œæä¾›äº†ä¸€å¥—å®Œå–„çš„æ—¶åŒºæ”¯æŒï¼Œèƒ½å¤Ÿè½»æ¾åœ°å¤„ç†æ—¶åŒºç›¸å…³çš„åŠŸèƒ½ã€‚\nQtä¸­çš„æ—¶åŒºæ¦‚è¿°åœ¨Qtä¸­ï¼Œæ—¶åŒºç”±QTimeZoneç±»æ¥è¡¨ç¤ºã€‚å®ƒæä¾›äº†ä¸€ç§è·¨å¹³å°æ–¹å¼ï¼Œä»¥æ ‡å‡†æ—¶é—´è¡¨ç¤ºç‰¹å®šåœ°åŒºçš„æ—¶é—´åç§»é‡ã€‚è¿™å¯¹äºåœ¨ä¸åŒçš„æ—¶åŒºä¸­ç¡®å®šæ—¶é—´ï¼ˆå¦‚UTCï¼‰å°¤å…¶æœ‰ç”¨ã€‚ä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªQTimeZoneå¯¹è±¡ï¼š\n1QTimeZone timeZone = QTimeZone(&quot;Asia/Shanghai&quot;);\n\nQDateTimeç±»ä¹Ÿå¯ä»¥ä¸QTimeZoneé…åˆä½¿ç”¨ï¼Œåœ¨ä½¿ç”¨æ—¶ä¹Ÿä¼šè‡ªåŠ¨è€ƒè™‘æ—¶åŒºã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼š\n123QDateTime time = QDateTime::currentDateTime();time.setTimeZone(QTimeZone(&quot;Asia/Shanghai&quot;));QString timeString = time.toString(Qt::ISODate);\n\nQtä¸­çš„æ—¶åŒºè½¬æ¢åœ¨Qtä¸­ï¼ŒQDateTimeç±»æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥ä»ä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼ˆUTCï¼‰è½¬æ¢ä¸ºç‰¹å®šæ—¶åŒºä¸­çš„æœ¬åœ°æ—¶é—´ã€‚å¯ä»¥ä½¿ç”¨toLocalTime()æ–¹æ³•å°†UTCè½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨toUTC()æ–¹æ³•å°†æœ¬åœ°æ—¶é—´è½¬æ¢ä¸ºUTCã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ç”¨æ³•ï¼š\n12345QDateTime utcTime = QDateTime::currentDateTimeUtc();QDateTime localTime = utcTime.toLocalTime();qDebug() &lt;&lt; &quot;UTC time: &quot; &lt;&lt; utcTime.toString(Qt::ISODate);qDebug() &lt;&lt; &quot;Local time: &quot; &lt;&lt; localTime.toString(Qt::ISODate);\n\nQtä¸­çš„æ—¶åŒºæ•°æ®åº“Qtä¸­çš„æ—¶åŒºæ•°æ®åº“æ˜¯ä¸€ä¸ªå†…ç½®çš„ã€è·¨å¹³å°çš„æ—¶åŒºæ•°æ®åº“ï¼ˆåˆç§°ä¸ºå®šä½æœåŠ¡ï¼‰ï¼Œå®ƒå°†åœ°ç†ä½ç½®æ˜ å°„åˆ°æœ€è¿‘çš„å¸‚&#x2F;åŒºåŸŸä»¥åŠç›¸å…³çš„æ—¶åŒºè§„åˆ™ã€‚QTimeZoneç±»ä½¿ç”¨è¯¥æ•°æ®åº“æ¥è¯†åˆ«æ—¶åŒºã€‚\nå¦‚æœæ‚¨è¦åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ—¶åŒºåŠŸèƒ½ï¼Œè¯·ç¡®ä¿ä½¿ç”¨æœ€æ–°çš„æ—¶åŒºæ•°æ®åº“ï¼Œå› ä¸ºå…¬å†å’Œæ”¿æ²»äº‹ä»¶ä¼šäº§ç”Ÿæ·±è¿œçš„å½±å“ï¼Œå¯¼è‡´æ—¶åŒºä¿¡æ¯éšæ—¶é—´è€Œå˜åŒ–ã€‚æ‚¨å¯ä»¥ä½¿ç”¨Qtæä¾›çš„tzdataæ›´æ–°ç¨‹åºæ¥æ›´æ–°æ—¶åŒºæ•°æ®åº“ã€‚ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ä»£ç æ¥æ›´æ–°æ—¶åŒºæ•°æ®åº“ï¼š\n1234#include &lt;QTimeZone&gt;#include &lt;QTimeZonePrivate&gt;QTimeZonePrivate::instance()-&gt;updateZoneInfo(QDir(&quot;/usr/share/zoneinfo&quot;));\n\nç»“è®ºé€šè¿‡Qtä¸­æä¾›çš„å®Œæ•´æ—¶åŒºæ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å¤„ç†æ—¶åŒºç›¸å…³çš„åŠŸèƒ½ã€‚QTimeZoneç±»æä¾›äº†ä¸€ä¸ªå¯é çš„æ–¹å¼æ¥è¡¨ç¤ºä¸åŒåœ°åŒºçš„æ—¶é—´åç§»é‡ï¼Œå¹¶ä¸”QDateTimeç±»å¯ä»¥è‡ªåŠ¨è€ƒè™‘æ—¶åŒºæ¥è¿›è¡Œè½¬æ¢ã€‚å½“ä½¿ç”¨æ—¶åŒºåŠŸèƒ½æ—¶ï¼Œè¯·ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„æ—¶åŒºæ•°æ®åº“ä»¥ç¡®ä¿å‡†ç¡®æ€§ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä¸­çš„æ—¶åŒº","date":"2021-10-05T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"8bf3e6aeb6e1a58dc6ced323d0a34c0b","title":"Qtå¸ƒå±€ä¸­çš„ setStretch() æ–¹æ³•","content":"Qtå¸ƒå±€ä¸­çš„ setStretch() æ–¹æ³•åœ¨Qtç¨‹åºå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨QLayoutç±»æ¥ç®¡ç†å’Œè‡ªåŠ¨å¸ƒç½®æ§ä»¶ã€‚ä½¿ç”¨QLayoutå¯ä»¥å¸®åŠ©ç»„ç»‡UIç•Œé¢ï¼Œå¹¶ç¡®ä¿æ§ä»¶å¯ä»¥è‡ªåŠ¨è°ƒæ•´å¤§å°ä»¥é€‚åº”ä¸åŒå¤§å°çš„å±å¹•ï¼Œä½¿ç”¨æˆ·è·å¾—æ›´å¥½çš„ä½“éªŒã€‚setLayout()æ–¹æ³•æ˜¯å°†QLayoutä¸QWidgetå…³è”ï¼Œå¹¶ä¸”å®ç°å›¾å½¢ç•Œé¢å¸ƒå±€çš„ä¸»è¦æ–¹æ³•ä¹‹ä¸€ã€‚å…¶ä¸­ï¼ŒsetStretch()æ–¹æ³•åˆ™æ˜¯QBoxLayoutåŠå…¶å­ç±»å¸ƒå±€ç‹¬æœ‰çš„æ–¹æ³•ï¼Œå…·æœ‰éå¸¸é‡è¦çš„ä½œç”¨ã€‚\nsetStretch() æ–¹æ³•ç¤ºä¾‹ä¾‹å¦‚ï¼Œå½“æ‚¨åˆ›å»ºä¸€ä¸ªæ°´å¹³æ’åˆ—çš„æŒ‰é’®åˆ—è¡¨æ—¶ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨çª—å£å®½åº¦ä¿®æ”¹æ—¶è°ƒæ•´æŒ‰é’®çš„å¤§å°ï¼Œå¹¶åŒæ—¶ä¿æŒæŒ‰é’®ä¹‹é—´çš„é—´éš”å§‹ç»ˆä¿æŒä¸€å®šå¤§å°ï¼ˆä¾‹å¦‚5ä¸ªåƒç´ ï¼‰ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨QHBoxLayoutç±»å¹¶ä½¿ç”¨setStretch()æ–¹æ³•æ¥å®ç°è¿™ä¸€ç‚¹ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š\n12345678910111213141516171819// åˆ›å»º3ä¸ªQPushButtonQPushButton *button1 = new QPushButton(&quot;Button 1&quot;);QPushButton *button2 = new QPushButton(&quot;Button 2&quot;);QPushButton *button3 = new QPushButton(&quot;Button 3&quot;);// åˆ›å»ºQHBoxLayoutå¹¶æ·»åŠ QPushButtonQHBoxLayout *layout = new QHBoxLayout;layout-&gt;addWidget(button1);layout-&gt;addWidget(button2);layout-&gt;addWidget(button3);// è®¾ç½®æ¯ä¸ªæ·»åŠ çš„Widgetåœ¨å¸ƒå±€ä¸­æ‰€å çš„æ¯”ä¾‹layout-&gt;setStretchFactor(button1, 1);layout-&gt;setStretchFactor(button2, 1);layout-&gt;setStretchFactor(button3, 1);// å°†QHBoxLayoutå…³è”åˆ°QWidgetQWidget *widget = new QWidget;widget-&gt;setLayout(layout);\n\nåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨QHBoxLayoutåˆ›å»ºäº†ä¸€ä¸ªæ°´å¹³æŒ‰é’®åˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨å¸ƒå±€çš„setStretchFactor()æ–¹æ³•å°†æŒ‰é’®ä¹‹é—´çš„é—´è·è®¾ç½®ä¸ºå…·æœ‰ç›¸åŒå®½åº¦æ¯”ä¾‹ã€‚å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨layout-&gt;setStretchFactor(button1, 1)ã€layout-&gt;setStretchFactor(button2, 1)å’Œlayout-&gt;setStretchFactor(button3, 1)å°†æ¯ä¸ªæŒ‰é’®çš„æ‹‰ä¼¸ç³»æ•°è®¾ç½®ä¸º1ã€‚è¿™æ ·ï¼Œå½“çˆ¶çª—å£å®½åº¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹æ‹‰ä¼¸å› å­æ¥æ§åˆ¶æ¯ä¸ªæŒ‰é’®çš„å¤§å°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå¦‚æœæ·»åŠ ç¬¬å››ä¸ªæŒ‰é’®ï¼Œåˆ™å¯ä»¥æŒ‰å¢åŠ æ­¤æŒ‰é’®åä»»æ„æ•°é‡çš„æŒ‰é’®è´¡çŒ®å…¶æŒ‰åˆ—çš„å¯ç”¨ç©ºé—´ã€‚\nsetStretch() æ–¹æ³•è§£é‡ŠsetStretch()æ–¹æ³•æŒ‡å®šäº†åŒ…å«åœ¨è¯¥å¸ƒå±€ä¸­çš„è¡Œæˆ–åˆ—æ‰€å æ®çš„çª—å£éƒ¨ä»¶åœ¨è¯¥è¡Œæˆ–è¯¥åˆ—ä¸­æ‰€è¢«æ‹‰ä¼¸çš„æ¯”ä¾‹ã€‚åœ¨QBoxLayoutä¸­ï¼Œæ¯ä¸ªQLayoutItemå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„æ‹‰ä¼¸ç³»æ•°ã€‚QBoxLayout ä¸­é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé¡¹çš„æ‹‰ä¼¸ç³»æ•°è®¾ç½®ä¸ºé›¶ï¼ˆ0ï¼‰ã€‚å½“ç”¨æˆ·è°ƒæ•´çª—å£å¤§å°æ—¶ï¼Œä¼šä»¥å„ä¸ªwidgetçš„ç­‰æ¯”ä¾‹ç¼©æ”¾æ¥æ”¹å˜çª—å£å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€åˆ—ä¸­çš„æ‰€æœ‰ç»„ä»¶å®½åº¦çš„å’Œç­‰äºåˆ—çš„å®½åº¦ã€‚\nåœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œä¸‰ä¸ªçª—å£éƒ¨ä»¶çš„æ‹‰ä¼¸å‚æ•°å‡è®¾ç½®ä¸º1ï¼Œè¡¨ç¤ºQHBoxLayout åº”è¯¥å°†å…¶å°½å¯èƒ½å¹³å‡åœ°åˆ†é…åˆ°å¸ƒå±€ä¸­çš„åŒºåŸŸä¸­ã€‚å› æ­¤ï¼Œæ¯ä¸ªçª—å£éƒ¨ä»¶è·å¾—ç›¸ç­‰çš„æ§åˆ¶æƒå¹¶å°†å æ®å¸ƒå±€çš„ç›¸ç­‰æ¯”ä¾‹ã€‚\nç»“è®ºsetStretch() æ–¹æ³•æ˜¯QBoxLayout å’Œå…¶æ´¾ç”Ÿç±» çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ‰€åŒ…å«æ§ä»¶åœ¨å¸ƒå±€ä¸­æ‰€å çš„ç©ºé—´æ¯”ä¾‹ï¼Œä»¥å®ç°åœ¨ä¸åŒçª—å£å¤§å°ä¸‹å¸ƒå±€çš„è‡ªé€‚åº”æ€§ã€‚è¿™å¯¹äºå¼€å‘é«˜åº¦åŠ¨æ€çš„UIç•Œé¢ï¼Œå°¤å…¶æ˜¯éœ€è¦åŒæ—¶è€ƒè™‘å¤§ã€ä¸­ã€å°å±å¹•å°ºå¯¸æ—¶éå¸¸æœ‰ç”¨ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtå¸ƒå±€ä¸­çš„ setStretch() æ–¹æ³•","date":"2021-10-05T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"d22eb85de16f2f58ec69f569b2b4a75b","title":"Qtå¤šçº¿ç¨‹è¯¦è§£","content":"Qtå¤šçº¿ç¨‹è¯¦è§£Qtæ˜¯ä¸€ä¸ªæ”¯æŒå¤šçº¿ç¨‹ã€è·¨å¹³å°çš„C++æ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘äººå‘˜ä»¥å®‰å…¨å’Œç®€å•çš„æ–¹å¼å¤„ç†å¹¶å‘ä»»åŠ¡ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»Qtä¸­çš„å¤šçº¿ç¨‹æ¦‚å¿µåŠå…¶ç”¨æ³•ã€‚\nä»€ä¹ˆæ˜¯Qtå¤šçº¿ç¨‹åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªè½»é‡çº§çš„ã€å¯æ‰§è¡Œçš„å•ç‹¬è¿›ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä¸ä¼ ç»Ÿçš„å•çº¿ç¨‹ç¨‹åºç›¸æ¯”ï¼Œå¤šçº¿ç¨‹ç¨‹åºå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå¹¶åˆ©ç”¨ç°ä»£CPUçš„å¤šæ ¸æ€§èƒ½ã€‚\nåœ¨Qtä¸­ï¼Œå¤šçº¿ç¨‹æ˜¯é€šè¿‡QThreadç±»æ¥å®ç°çš„ã€‚QThreadç±»æä¾›äº†ä¸€ç§ä½¿ç”¨çº¿ç¨‹çš„é€šç”¨æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¤„ç†å„ç§å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯ã€‚\nå¦‚ä½•åœ¨Qtä¸­ä½¿ç”¨å¤šçº¿ç¨‹ä½¿ç”¨QObjectç±»åŠå…¶æ´¾ç”Ÿçš„ç±»ï¼Œå¦‚QWidgetå’ŒQCoreApplicationï¼Œå¯ä»¥ä½¿çº¿ç¨‹é—´é€šä¿¡æ›´å®¹æ˜“ã€‚å…¶ä¸­ï¼Œæœ€å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¿¡å·å’Œæ§½æœºåˆ¶ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¹‹é—´å‘é€ä¿¡å·å’Œæ¥æ”¶æ§½ã€‚\nä½¿ç”¨å¤šçº¿ç¨‹çš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š\næ­¥éª¤1ï¼šåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹ç±»æ‚¨éœ€è¦ç»§æ‰¿QThreadç±»æˆ–ä½¿ç”¨QObjectç±»è‡ªå·±åˆ›å»ºçº¿ç¨‹çš„å­ç±»ã€‚\n123456class MyThread : public QThread&#123;    Q_OBJECT    public:    void run() override;\n\nåœ¨æ‚¨è‡ªå·±ç¼–å†™çš„run()å‡½æ•°å†…å®šä¹‰çº¿ç¨‹çš„ä»»åŠ¡ã€‚\næ­¥éª¤2ï¼šå®ä¾‹åŒ–æ–°çº¿ç¨‹åœ¨ä¸»çº¿ç¨‹ä¸­å£°æ˜MyThread threadå®ä¾‹ï¼Œå¹¶æ˜¾ç¤ºè¿è¡Œå®ƒï¼š\n12MyThread thread;thread.start();\n\næ­¥éª¤3ï¼šè¿æ¥ä¿¡å·å’Œæ§½å¤šçº¿ç¨‹ç¨‹åºçš„å…³é”®å°±æ˜¯çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚é€šè¿‡ä½¿ç”¨ä¿¡å·ï¼ˆQThread::finished()ï¼‰å°†å·¥ä½œçº¿ç¨‹ä¿¡å·ä¸æ¥æ”¶è¯¥ä¿¡å·çš„å¯¹è±¡çš„æ§½ï¼ˆdeleteLater()ï¼‰è¿æ¥ï¼Œå¯ä»¥ç¡®ä¿åœ¨å·¥ä½œå®Œæˆååˆ é™¤å·¥ä½œçº¿ç¨‹ã€‚ä»¥ä¸‹æ˜¯éƒ¨åˆ†ç¤ºä¾‹ä»£ç ï¼š\n1connect(&amp;thread, &amp;QThread::finished, worker, &amp;QObject::deleteLater);\n\næ­¥éª¤4ï¼šå¤„ç†çº¿ç¨‹åœæ­¢æ—¶çš„å¼‚å¸¸ä¸ºäº†ç¡®ä¿åœ¨çº¿ç¨‹åœæ­¢æ—¶åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§ï¼Œæˆ‘ä»¬éœ€è¦åœ¨çº¿ç¨‹åœæ­¢æ—¶å¤„ç†å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œåœ¨MyThreadç±»ä¸­å¯ä»¥æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š\n12345678void MyThread::stop()&#123;    mutex.lock();        stopped = true;    mutex.unlock();&#125;if (stopped) break;\n\næ³¨æ„ï¼šæ‚¨éœ€è¦æ ¹æ®æ‚¨çš„ä»£ç é€‚å½“åœ°æ·»åŠ äº’æ–¥é”protectsæ¥ä¿æŠ¤å…±äº«æ•°æ®ã€‚\nQtå¤šçº¿ç¨‹çš„æœ€ä½³å®è·µ\né¿å…åœ¨GUIçº¿ç¨‹ä¸Šè¿›è¡Œå¤§é‡è®¡ç®—ã€‚\nç¡®ä¿è¿›ç¨‹ã€çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ç”±Qtå¤„ç†ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®æˆ–æ›´æ”¹å˜é‡ã€‚\nå°½å¯èƒ½ä½¿ç”¨é˜Ÿåˆ—æ¥ç®¡ç†çº¿ç¨‹æ± ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨èµ„æºã€‚\néœ€è¦åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ä¿æŠ¤å…±äº«æ•°æ®ã€‚\n\næ€»ç»“Qtå¤šçº¿ç¨‹æä¾›äº†ä¸€ç§å¼ºå¤§çš„æœºåˆ¶æ¥å¤„ç†å¹¶å‘ä»»åŠ¡ã€‚ä½¿ç”¨ä¿¡å·å’Œæ§½æœºåˆ¶ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°å®ç°å„ç§çº¿ç¨‹é—´é€šä¿¡ï¼Œå¹¶é€šè¿‡QObjectç±»æ¥æ›´åŠ å®¹æ˜“åœ°ç®¡ç†çº¿ç¨‹æ± åŠå…¶ä»»åŠ¡ã€‚\nåœ¨å®é™…åº”ç”¨ç¨‹åºä¸­ï¼Œç¡®ä¿æ ¹æ®Qtå¤šçº¿ç¨‹æœ€ä½³å®è·µæ¥è®¾è®¡ä»£ç ï¼Œä¼šä½¿æ‚¨å†™å‡ºé«˜æ•ˆã€ç¨³å®šå¹¶ä¸”æ˜“äºç»´æŠ¤çš„ç¨‹åºã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtå¤šçº¿ç¨‹è¯¦è§£","date":"2021-10-04T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c0af7e63ff6c9262bf89de2022bf6b45","title":"QStringçš„ä»‹ç»","content":"QStringçš„ä»‹ç»QStringæ˜¯Qtä¸­å¤„ç†å­—ç¬¦ä¸²æœ€å¸¸ç”¨çš„ç±»ä¹‹ä¸€ï¼Œæä¾›äº†ä¸°å¯Œçš„å­—ç¬¦ä¸²æ“ä½œå’Œè½¬æ¢æ–¹æ³•ã€‚ç›¸æ¯”åŸç”ŸC++ä¸­çš„std::stringï¼ŒQStringå¯ä»¥æ–¹ä¾¿åœ°å¤„ç†Unicodeå­—ç¬¦ï¼Œæ”¯æŒåŠ¨æ€é•¿åº¦å’Œè‡ªåŠ¨å†…å­˜ç®¡ç†ç­‰åŠŸèƒ½ã€‚\nåŸºæœ¬ç”¨æ³•åˆ›å»ºå’Œèµ‹å€¼é€šè¿‡ç›´æ¥ä¼ å…¥å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²æŒ‡é’ˆæ¥åˆ›å»ºä¸€ä¸ªQStringå¯¹è±¡ï¼š\n123QString str1 = &quot;hello world&quot;;const char *str2 = &quot;hello qt&quot;;QString str3(str2);\n\nè¿˜å¯ä»¥é€šè¿‡å¤åˆ¶æ„é€ å‡½æ•°æˆ–è€…èµ‹å€¼æ“ä½œæ¥åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²ï¼š\n123QString str4(str1);QString str5 = str2;str4 = str5;\n\nå¸¸ç”¨å‡½æ•°QStringæä¾›äº†å¾ˆå¤šå¸¸è§çš„å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ã€‚\n\nsize() æˆ– length()ï¼šè·å–å­—ç¬¦ä¸²é•¿åº¦\ntoUpper() å’Œ toLower()ï¼šè½¬æ¢å¤§å°å†™\ntrimmed()ï¼šå»æ‰å‰åç©ºæ ¼\nsplit()ï¼šåˆ‡å‰²å­—ç¬¦ä¸²ä¸ºåˆ—è¡¨\nreplace()ï¼šæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å­ä¸²\nstartsWith(), contains() å’Œ endsWith()ï¼šåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾å­ä¸²\n\nä¾‹å¦‚ï¼š\n1234QString myString(&quot;  Hello, world!   &quot;);qDebug() &lt;&lt; &quot;String length: &quot; &lt;&lt; myString.length(); // è¾“å‡º &quot;String length: 16&quot;qDebug() &lt;&lt; &quot;Trimmed string: &quot; &lt;&lt; myString.trimmed(); // è¾“å‡º &quot;Trimmed string: Hello, world!&quot;\n\nè½¬æ¢å‡½æ•°QStringä¹Ÿæä¾›äº†ä¸€äº›ä¾¿äºå­—ç¬¦ä¸²è½¬æ¢çš„å‡½æ•°ã€‚æ¯”å¦‚ï¼Œå¦‚æœéœ€è¦å°†QStringå¯¹è±¡è½¬æ¢æˆå­—ç¬¦æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨toUtf8()ã€toLatin1()å’ŒtoLocal8Bit()ç­‰å‡½æ•°ã€‚\n123QString myString(&quot;Hello, world!&quot;);qDebug() &lt;&lt; myString.toUtf8().constData(); // è¾“å‡º &quot;Hello, world!&quot;\n\nåŒæ ·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡fromUtf8()ã€fromLatin1()å’ŒfromLocal8Bit()ç­‰å‡½æ•°å°†std::stringè½¬æ¢æˆQStringå¯¹è±¡ã€‚\n12345std::string myStdString = &quot;Hello, Qt!&quot;;QString myString = QString::fromUtf8(myStdString.c_str());qDebug() &lt;&lt; myString; // è¾“å‡º &quot;Hello, Qt!&quot;\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåœ¨è¿›è¡Œè·¨å¹³å°å¼€å‘æ—¶ï¼Œéœ€è¦è°¨æ…é€‰æ‹©å­—ç¬¦ç¼–ç æ–¹å¼æ¥ç¡®ä¿ä¸ç›®æ ‡å¹³å°çš„å…¼å®¹æ€§ã€‚\næ€§èƒ½è€ƒè™‘ç”±äºQStringç±»ä¼¼äºåŠ¨æ€æ•°ç»„ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åˆ†é…æ‰€éœ€å¤§å°çš„å†…å­˜ã€‚è¿™ç§è‡ªåŠ¨ç®¡ç†çš„ç‰¹ç‚¹ä¼šå¯¼è‡´æ¯æ¬¡ä¿®æ”¹å­—ç¬¦ä¸²éƒ½éœ€è¦åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œä»è€Œå½±å“äº†å…¶æ€§èƒ½è¡¨ç°ã€‚\nä¸ºäº†å‡å°‘é¢‘ç¹çš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾ï¼Œå¯ä»¥å°½é‡é¿å…ä½¿ç”¨toUpper()ã€toLower()ç­‰å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬ä¼šæ”¹å˜å­—ç¬¦ä¸²å†…å®¹å¹¶åˆ›å»ºæ–°çš„QStringå¯¹è±¡ã€‚\nå¦å¤–ï¼Œå½“åªéœ€è¦è¯»å–å­—ç¬¦ä¸²æ—¶ï¼Œå¯ä»¥ä½¿ç”¨QStringViewç±»ï¼Œè¿™ä¸ªç±»ä¸ä¼šåˆ›å»ºæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨åŸå§‹çš„QStringå¯¹è±¡ï¼Œæé«˜äº†ç¨‹åºçš„æ€§èƒ½ã€‚\nç»“è®ºæ€»ä¹‹ï¼ŒQStringæ˜¯Qtæ¡†æ¶ä¸­å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„å­—ç¬¦ä¸²ç±»ä¹‹ä¸€ï¼Œæä¾›äº†è®¸å¤šæ–¹ä¾¿å®ç”¨çš„æ–¹æ³•å’Œæ“ä½œã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨QStringViewç±»æ¥ä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€‚å¯¹äºæ¶‰åŠåˆ°å­—ç¬¦ç¼–ç çš„æƒ…å†µéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©å„ç§ä¸åŒçš„QStringå‡½æ•°å’Œè½¬æ¢ç­–ç•¥æ¥æ»¡è¶³å¼€å‘éœ€æ±‚ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/QStringçš„ä»‹ç»","date":"2021-10-04T06:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"0e349ef346a818a9b65cc579b534d135","title":"Qtä¿¡å·æ§½æœºåˆ¶è¯¦è§£","content":"Qtä¿¡å·æ§½æœºåˆ¶è¯¦è§£Qtä¿¡å·æ§½æœºåˆ¶æ˜¯ä¸€ç§ç”¨äºå¤„ç†åº”ç”¨ç¨‹åºä¸­äº‹ä»¶ä¸æ–¹æ³•äº¤äº’çš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡è¿™ä¸ªæœºåˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå¯ä»¥å½±å“åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä¿ƒè¿›äº‹ä»¶æµçš„è‡ªåŠ¨åŒ–ç®¡ç†ï¼Œæé«˜ç¨‹åºçš„æ•ˆç‡å’Œå¯è¯»æ€§ã€‚\nåœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨Qtä¿¡å·æ§½æœºåˆ¶çš„ç”¨æ³•ã€è§„åˆ™å’Œæœ€ä½³å®è·µã€‚\nä»€ä¹ˆæ˜¯Qtä¿¡å·æ§½æœºåˆ¶åœ¨Qtä¸­ï¼Œä¿¡å·ï¼ˆsignalï¼‰å’Œæ§½ï¼ˆslotï¼‰æ˜¯ä¸¤ä¸ªä»»åŠ¡ä¸åŒä½†éå¸¸å¯†åˆ‡ç›¸å…³çš„æ¦‚å¿µã€‚ç®€å•åœ°è¯´ï¼Œä¸€ä¸ªä¿¡å·æ˜¯æŒ‡è§¦å‘ç¨‹åºæŸä¸ªæ“ä½œçš„äº‹ä»¶ï¼Œè€Œä¸€ä¸ªæ§½æ˜¯æŒ‡è¢«è°ƒç”¨çš„ç¨‹åºæˆ–æ–¹æ³•ã€‚\nä½¿ç”¨Qtä¿¡å·æ§½æœºåˆ¶ï¼Œæ‚¨å¯ä»¥å°†ä¿¡å·ä¸æ§½è¿æ¥èµ·æ¥ï¼Œä½¿å¾—ä¸€ä¸ªäº‹ä»¶å¯ä»¥è§¦å‘å…¶ä»–æ“ä½œã€‚è¿™æ ·ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å‘å‡ºä¿¡å·æ—¶ï¼Œå¯ä»¥å”¤é†’å“åº”çš„æ§½ï¼Œå¹¶æ‰§è¡Œæ§½ä¸­çš„æ“ä½œã€‚\nåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¤§å¤šæ•°ä¿¡å·éƒ½æ˜¯ä»¥æŸäº›ç‰¹å®šäº‹ä»¶çš„å½¢å¼å‡ºç°çš„ï¼Œå¦‚é¼ æ ‡ç‚¹å‡»ã€æŒ‰é”®äº‹ä»¶ç­‰ã€‚æ¯ç§äº‹ä»¶éƒ½æœ‰å®ƒä»¬è‡ªå·±å¯¹åº”çš„ä¿¡å·ã€‚\nQtä¿¡å·æ§½æœºåˆ¶çš„ç”¨æ³•æ­¥éª¤1ï¼šåˆ›å»ºä¿¡å·åœ¨Qtä¸­ï¼Œä¿¡å·æ˜¯ä½¿ç”¨signalså…³é”®å­—å®šä¹‰çš„ç‰¹æ®Šå‡½æ•°ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªåä¸ºclick()çš„ä¿¡å·ï¼š\n12signals:    void click();\n\nè¯·æ³¨æ„ï¼Œä¿¡å·å‡½æ•°é€šå¸¸ä¸åŒ…å«ä»»ä½•å®ç°ä»£ç ã€‚\næ­¥éª¤2ï¼šè¿æ¥ä¿¡å·å’Œæ§½åœ¨ä½¿ç”¨ä¿¡å·å’Œæ§½ä¹‹å‰ï¼Œéœ€è¦å…ˆå°†å®ƒä»¬è¿›è¡Œè¿æ¥ã€‚å¯¹äºæ™®é€šC++å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·è¿æ¥å®ƒä»¬ï¼š\n1connect(sender, SIGNAL(click()), receiver, SLOT(handleClick()));\n\nåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œconnect()æ–¹æ³•ç”¨äºå°†senderå¯¹è±¡çš„click()ä¿¡å·è¿æ¥åˆ°receiverå¯¹è±¡çš„handleClick()æ§½ã€‚å¦‚æœsenderå¯¹è±¡å‘å‡ºäº†click()ä¿¡å·ï¼Œreceiverå¯¹è±¡çš„handleClick()æ§½å°±ä¼šè¢«è°ƒç”¨ã€‚\nè¯·æ³¨æ„ï¼Œä½¿ç”¨æ–°çš„ä¿¡å·æ§½è¯­æ³•è¿æ¥ä¿¡å·å’Œæ§½å¦‚ä¸‹ï¼š\n1connect(sender, &amp;Sender::click, receiver, &amp;Receiver::handleClick);\n\næ­¥éª¤3ï¼šå‘å‡ºä¿¡å·å½“è¦è§¦å‘ä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œå‘é€å¯¹è±¡å¿…é¡»åœ¨å…¶æŸäº›æ“ä½œä¸­ä½¿ç”¨emitå…³é”®å­—æ¥è§¦å‘å…¶ä¿¡å·ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š \n1234void Button::mousePressEvent(QMouseEvent *event)&#123;    emit click();&#125;\n\nåœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œå½“é¼ æ ‡æŒ‰ä¸‹æ—¶ï¼ŒButtonå¯¹è±¡å°†å‘å°„click()ä¿¡å·ã€‚\næ­¥éª¤4ï¼šæ¥æ”¶ä¿¡å·å¹¶æ‰§è¡Œæ§½ä¸€æ—¦æ¥æ”¶å¯¹è±¡æ¥æ”¶åˆ°ä¿¡å·ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨æ§½å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯æ§½å‡½æ•°çš„ç¤ºä¾‹ï¼š\n12345public slots:    void handleClick()    &#123;        qDebug() &lt;&lt; &quot;Button clicked!&quot;;    &#125;\n\nåœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œå½“æ¥æ”¶åˆ°ä¿¡å·æ—¶ï¼Œå°†æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚\nQtä¿¡å·æ§½æœºåˆ¶çš„è§„åˆ™å’Œæœ€ä½³å®è·µ\nä½¿ç”¨signalså’Œslotså…³é”®å­—å£°æ˜ä¿¡å·å’Œæ§½ã€‚\nè¿æ¥ä¿¡å·å’Œæ§½æ—¶ï¼Œç¡®ä¿å‚æ•°ç±»å‹æ€»æ˜¯åŒ¹é…ã€‚\nå¯¹äºå•ä¸ªä¿¡å·ï¼Œå¯ä»¥è¿æ¥å¤šä¸ªæ§½ã€‚\næ¥æ”¶å¯¹è±¡å°†æŒ‰è¿æ¥é¡ºåºæ‰§è¡Œå…¶æ§½å‡½æ•°ã€‚\næ–­å¼€è¿æ¥æ—¶ï¼Œè¯·æ³¨æ„ç¡®ä¿å‡†ç¡®çš„å‚æ•°åŒ¹é…ã€‚\nåœ¨UIæ§ä»¶ä¸Šä½¿ç”¨ä¿¡å·å’Œæ§½æ—¶ï¼Œè¯·åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œè¿æ¥ã€‚\nå°½å¯èƒ½é¿å…ä½¿ç”¨é˜Ÿåˆ—è¿æ¥æ¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚\n\næ€»ç»“Qtä¿¡å·æ§½æœºåˆ¶ä¸ºç¨‹åºå‘˜æä¾›äº†ä¸€ä¸ªçµæ´»è€Œå¼ºå¤§çš„äº‹ä»¶ç®¡ç†æ¡†æ¶ã€‚é€šè¿‡è¿æ¥ä¿¡å·å’Œæ§½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç¨‹åºä»£ç æ›´åŠ æ¨¡å—åŒ–ã€æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚ä½¿ç”¨Qtä¿¡å·æ§½æœºåˆ¶æ—¶ï¼Œè¯·ç¡®ä¿éµå¾ªè§„åˆ™å’Œæœ€ä½³å®è·µï¼Œä»¥ä½¿æ‚¨çš„ä»£ç æ¸…æ™°ã€é«˜æ•ˆä¸”å…·æœ‰å¯è¯»æ€§ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä¿¡å·æ§½æœºåˆ¶è¯¦è§£","date":"2021-10-04T06:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3ebafc97fc88a959250cd7b15e946c06","title":"QtçŠ¶æ€æœºä½¿ç”¨","content":"QtçŠ¶æ€æœºä½¿ç”¨åœ¨æœ¬ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨QtçŠ¶æ€æœºçš„ç”¨æ³•ä»¥åŠå¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒä»¬ã€‚çŠ¶æ€æœºå¯ä»¥ç®€åŒ–å¤æ‚åº”ç”¨ç¨‹åºçš„å¼€å‘æµç¨‹ï¼Œå¹¶ä¸”è®©ä»£ç æ›´å…·å¯è¯»æ€§å’Œæ˜“ç»´æŠ¤æ€§ã€‚\nä»€ä¹ˆæ˜¯QtçŠ¶æ€æœºQtçŠ¶æ€æœºæ˜¯ä¸€ç§è¢«ç§°ä¸ºQStateMachineçš„ç±»ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç®¡ç†åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚çŠ¶æ€æœºæœ‰åŠ©äºå°†åº”ç”¨ç¨‹åºåˆ†è§£ä¸ºäº’ç›¸ç‹¬ç«‹ã€å¯é‡å¤çš„çŠ¶æ€ã€‚çŠ¶æ€ç”±äº‹ä»¶é©±åŠ¨ï¼Œå¯ä»¥å“åº”è¾“å…¥ã€å‘å‡ºè¾“å‡ºå¹¶é‡‡å–è‡ªé€‚åº”æ“ä½œã€‚\nåœ¨Qtä¸­ï¼ŒçŠ¶æ€æœºéå¸¸å¹¿æ³›åœ°åº”ç”¨äºUIç•Œé¢è®¾è®¡ä¸­ã€‚å®ƒä»¬å¯ç”¨äºç®¡ç†UIå…ƒç´ çš„å˜åŒ–ã€æ§ä»¶ä¹‹é—´çš„äº¤äº’ä»¥åŠå¤„ç†ç”¨æˆ·çš„æ“ä½œã€‚åœ¨å¼€å§‹ä½¿ç”¨çŠ¶æ€æœºä¹‹å‰ï¼Œè¯·å…ˆç¡®ä¿å·²ç»æ·±å…¥äº†è§£äº†Qtä¿¡å·ä¸æ§½è¿æ¥æœºåˆ¶ã€‚\nå¦‚ä½•åˆ›å»ºQtçŠ¶æ€æœºä½¿ç”¨QtçŠ¶æ€æœºï¼Œéœ€è¦å®Œæˆä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\næ­¥éª¤1ï¼šå®šä¹‰çŠ¶æ€å˜é‡é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰è¡¨ç¤ºåº”ç”¨ç¨‹åºå¯èƒ½å¤„äºçš„çŠ¶æ€å˜é‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªçŠ¶æ€å˜é‡ï¼šIdleå’ŒWorkingï¼š\n1234enum State &#123;    Idle,    Working&#125;;\n\næ­¥éª¤2ï¼šåˆ›å»ºçŠ¶æ€æœºå¯¹è±¡æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQStateMachineçš„å®ä¾‹ï¼Œè¯¥å®ä¾‹å°†è´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼š\n1QStateMachine machine;\n\nä¸€æ—¦æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªQStateMachineå®ä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸¤ä¸ªçŠ¶æ€ï¼šIdleå’ŒWorkingï¼š\n12345QState *idle = new QState();QState *working = new QState();machine.addState(idle);machine.addState(working);\n\næ­¥éª¤3ï¼šæŒ‡å®šçŠ¶æ€è½¬æ¢ä¸€æ—¦æˆ‘ä»¬å®šä¹‰äº†çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬è¿æ¥èµ·æ¥ä»¥æ„å»ºçŠ¶æ€æœºã€‚åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªä»Idleåˆ°Workingçš„è½¬æ¢ï¼š\n1idle-&gt;addTransition(&amp;button, &amp;QPushButton::clicked, working);\n\nåœ¨è¿™ä¸ªè½¬æ¢ä¸­ï¼Œå½“ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶ï¼Œä»Idleåˆ°WorkingçŠ¶æ€è½¬æ¢ä¼šå¯åŠ¨ã€‚\næ­¥éª¤4ï¼šæŒ‡å®šè¿›å…¥&#x2F;é€€å‡ºåŠ¨ä½œé™¤äº†åœ¨æ­¤ä¹‹å‰æ¶‰åŠçš„åŠŸèƒ½ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨çŠ¶æ€è½¬æ¢ä¸­å®šä¹‰è¿›å…¥&#x2F;é€€å‡ºæ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥è®¾ç½®ä¸ºæ‰§è¡Œç‰¹å®šä»»åŠ¡æˆ–æ›´æ”¹UIå…ƒç´ çš„å€¼ç­‰åŠŸèƒ½ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ‰“å°æ–‡æœ¬æ¶ˆæ¯ä»¥ç¡®å®šçŠ¶æ€å˜åŒ–ã€‚\n1234567QObject::connect(idle, &amp;QState::entered, []()&#123;    qDebug() &lt;&lt; &quot;Now in Idle state&quot;;&#125;);QObject::connect(working, &amp;QState::entered, []()&#123;    qDebug() &lt;&lt; &quot;Now in Working state&quot;;&#125;);\n\nå®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå·²ç»æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨QtçŠ¶æ€æœºçš„åº”ç”¨ç¨‹åºï¼é€šè¿‡ä¸åŒçŠ¶æ€çš„è½¬æ¢ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å“åº”ç”¨æˆ·äº‹ä»¶å¹¶æ ¹æ®éœ€è¦æ‰§è¡Œç›¸åº”åŠ¨ä½œã€‚\næ€»ç»“æ€»è€Œè¨€ä¹‹ï¼ŒQtçŠ¶æ€æœºæ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œå¹¶ä¸”åœ¨UIè®¾è®¡ä¸­å¹¿æ³›åº”ç”¨ã€‚é€šè¿‡åˆ†è§£å¤æ‚é—®é¢˜å¹¶ç¡®ä¿æŒ‰ç…§æœ‰åºçš„ã€å¯è¯»çš„æ–¹æ³•å¤„ç†å®ƒä»¬ï¼Œå¯ä»¥ç®€åŒ–åº”ç”¨ç¨‹åºçš„å¼€å‘æµç¨‹å¹¶å¢å¼ºå…¶å¯ç»´æŠ¤æ€§ã€‚\nåœ¨å®é™…çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä½¿ç”¨ Qt çŠ¶æ€æœºå¯èƒ½æ¯”ä¸Šé¢æä¾›çš„ç¤ºä¾‹æ›´ä¸ºå¤æ‚ï¼Œå› æ­¤å»ºè®®é˜…è¯» Qt å®˜æ–¹æ–‡æ¡£ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/QtçŠ¶æ€æœºä½¿ç”¨","date":"2021-10-04T03:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"9cd29aa7149344790a81ff29803e94e3","title":"ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªæœç´¢æ¡†","content":"ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªæœç´¢æ¡†åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªæœç´¢æ¡†æ¥è®©ç”¨æˆ·å¿«é€ŸæŸ¥æ‰¾å†…å®¹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªç®€å•çš„å†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶æ¼”ç¤ºå¦‚ä½•è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œã€‚\nåˆ›å»ºæœç´¢æ¡†å’Œæœç´¢æŒ‰é’®é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQWidgetéƒ¨ä»¶ï¼Œå¹¶å°†å…¶å¸ƒå±€ä¸ºæ°´å¹³å¸ƒå±€ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å‘è¯¥å¸ƒå±€æ·»åŠ ä¸€ä¸ªQLineEditå¯¹è±¡å’Œä¸€ä¸ªQPushButtonå¯¹è±¡ï¼Œä»¥åˆ›å»ºæœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ã€‚\n12345678QWidget *searchWidget = new QWidget();QHBoxLayout *layout = new QHBoxLayout(searchWidget);QLineEdit *lineEdit = new QLineEdit();QPushButton *searchButton = new QPushButton(&quot;Search&quot;);layout-&gt;addWidget(lineEdit);layout-&gt;addWidget(searchButton);\n\nè·å–ç”¨æˆ·è¾“å…¥å¹¶æ‰§è¡Œæœç´¢æ“ä½œä¸ºäº†è·å–ç”¨æˆ·åœ¨æœç´¢æ¡†ä¸­è¾“å…¥çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥QLineEditçš„textChanged()ä¿¡å·ï¼Œå¹¶å°†å…¶å‘é€åˆ°ä¸€ä¸ªæ§½å‡½æ•°ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æ–‡æœ¬å¹¶å­˜å‚¨å®ƒï¼Œä»¥å¤‡æœç´¢æ—¶ä½¿ç”¨ã€‚\n123456connect(lineEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onSearchTextChanged);void MyClass::onSearchTextChanged(const QString &amp;text)&#123;    m_searchText = text;&#125;\n\nè¦æ‰§è¡Œæœç´¢æ“ä½œï¼Œæˆ‘ä»¬åªéœ€å°†QPushButtonçš„clicked()ä¿¡å·è¿æ¥åˆ°ä¸€ä¸ªæ§½å‡½æ•°å³å¯ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­˜å‚¨çš„æœç´¢æ–‡æœ¬æ‰§è¡Œæœç´¢æ“ä½œã€‚\n123456connect(searchButton, &amp;QPushButton::clicked, this, &amp;MyClass::onSearchClicked);void MyClass::onSearchClicked()&#123;    // æ‰§è¡Œæœç´¢æ“ä½œ&#125;\n\nå®Œæ•´ä»£ç ç¤ºä¾‹ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªå†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#include &lt;QApplication&gt;#include &lt;QWidget&gt;#include &lt;QHBoxLayout&gt;#include &lt;QLineEdit&gt;#include &lt;QPushButton&gt;#include &lt;QDebug&gt;class MyClass : public QWidget&#123;    Q_OBJECTpublic:    MyClass(QWidget *parent = nullptr) : QWidget(parent)    &#123;        // åˆ›å»ºæœç´¢æ¡†å’Œæœç´¢æŒ‰é’®        QWidget *searchWidget = new QWidget();        QHBoxLayout *layout = new QHBoxLayout(searchWidget);        QLineEdit *lineEdit = new QLineEdit();        QPushButton *searchButton = new QPushButton(&quot;Search&quot;);        layout-&gt;addWidget(lineEdit);        layout-&gt;addWidget(searchButton);        // è¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°        connect(lineEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onSearchTextChanged);        connect(searchButton, &amp;QPushButton::clicked, this, &amp;MyClass::onSearchClicked);        // æ˜¾ç¤ºæœç´¢æ¡†å’Œæœç´¢æŒ‰é’®        setLayout(layout);        show();    &#125;private slots:    void onSearchTextChanged(const QString &amp;text)    &#123;        m_searchText = text;    &#125;    void onSearchClicked()    &#123;        qDebug() &lt;&lt; &quot;Searching for:&quot; &lt;&lt; m_searchText;    &#125;private:    QString m_searchText;&#125;;int main(int argc, char *argv[])&#123;    QApplication a(argc, argv);    MyClass myClass;    return a.exec();&#125;\n\næ€»ç»“åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªå†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰ç”¨çš„ç•Œé¢å…ƒç´ ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æä¾›æœç´¢åŠŸèƒ½å¹¶æé«˜ç”¨æˆ·ä½“éªŒã€‚## æ‹“å±•\nåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªå†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œã€‚ä½†å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ›´åŠ å¤æ‚çš„åŠŸèƒ½å’Œäº¤äº’ä½“éªŒã€‚\nä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥æ‹“å±•å’Œä¼˜åŒ–çš„æ–¹å‘ï¼š\n\nåœ¨QLineEditä¸­ä½¿ç”¨å ä½ç¬¦æ–‡æœ¬ï¼ˆplaceholder textï¼‰æˆ–é»˜è®¤æ–‡æœ¬ï¼ˆdefault textï¼‰æ¥æç¤ºç”¨æˆ·è¾“å…¥ã€‚\nä¸ºæœç´¢æŒ‰é’®æ·»åŠ å¿«æ·é”®ï¼ˆä¾‹å¦‚Enteré”®ï¼‰ï¼Œä»¥æ–¹ä¾¿ç”¨æˆ·è¿›è¡Œæœç´¢ã€‚\nåœ¨æœç´¢è¿‡ç¨‹ä¸­æ˜¾ç¤ºè¿›åº¦æŒ‡ç¤ºå™¨ï¼ˆä¾‹å¦‚æ—‹è½¬çš„ç­‰å¾…å›¾æ ‡ï¼‰ï¼Œä»¥æç¤ºç”¨æˆ·æœç´¢æ­£åœ¨è¿›è¡Œä¸­ã€‚\nå®ç°è‡ªåŠ¨è¡¥å…¨ï¼ˆautocompleteï¼‰æˆ–è”æƒ³æœç´¢ï¼ˆsuggestion searchï¼‰åŠŸèƒ½ï¼Œä»¥æé«˜æœç´¢çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚\næ”¯æŒå¤šç§æœç´¢æ¨¡å¼ï¼ˆä¾‹å¦‚ç²¾ç¡®æœç´¢ã€æ¨¡ç³Šæœç´¢ã€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ç­‰ï¼‰å’Œé«˜çº§é€‰é¡¹ï¼Œä»¥æ»¡è¶³ä¸åŒç”¨æˆ·çš„éœ€æ±‚ã€‚\nç»“åˆå…¶ä»–ç•Œé¢å…ƒç´ ï¼ˆä¾‹å¦‚QListViewã€QTableWidgetç­‰ï¼‰æ¥å±•ç¤ºæœç´¢ç»“æœï¼Œå¹¶æä¾›ç›¸å…³çš„æ“ä½œå’Œäº¤äº’ã€‚\n\nå‚è€ƒèµ„æ–™\nQt Documentation: QLineEdit Class\nQt Documentation: QPushButton Class## ä»£ç ç¤ºä¾‹\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªå†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#include &lt;QApplication&gt;#include &lt;QWidget&gt;#include &lt;QHBoxLayout&gt;#include &lt;QLineEdit&gt;#include &lt;QPushButton&gt;#include &lt;QDebug&gt;class SearchWidget : public QWidget&#123;    Q_OBJECTpublic:    SearchWidget(QWidget *parent = nullptr) : QWidget(parent)    &#123;        // åˆ›å»ºæœç´¢æ¡†å’Œæœç´¢æŒ‰é’®        QLineEdit *lineEdit = new QLineEdit();        QPushButton *searchButton = new QPushButton(&quot;Search&quot;);        // åˆ›å»ºæ°´å¹³å¸ƒå±€        QHBoxLayout *layout = new QHBoxLayout();        layout-&gt;addWidget(lineEdit);        layout-&gt;addWidget(searchButton);        setLayout(layout);        // è¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°        connect(lineEdit, &amp;QLineEdit::textChanged, this, &amp;SearchWidget::onSearchTextChanged);        connect(searchButton, &amp;QPushButton::clicked, this, &amp;SearchWidget::onSearchClicked);    &#125;signals:    void searchRequested(const QString &amp;text);private slots:    void onSearchTextChanged(const QString &amp;text)    &#123;        m_searchText = text;    &#125;    void onSearchClicked()    &#123;        emit searchRequested(m_searchText);    &#125;private:    QString m_searchText;&#125;;class MainWindow : public QWidget&#123;    Q_OBJECTpublic:    MainWindow(QWidget *parent = nullptr) : QWidget(parent)    &#123;        // åˆ›å»ºæœç´¢éƒ¨ä»¶        m_searchWidget = new SearchWidget();        // åˆ›å»ºæ ‡ç­¾å’Œæ–‡æœ¬ç¼–è¾‘å™¨        QLabel *label = new QLabel(&quot;Search Result:&quot;);        m_textEdit = new QTextEdit();        // åˆ›å»ºå‚ç›´å¸ƒå±€        QVBoxLayout *layout = new QVBoxLayout();        layout-&gt;addWidget(m_searchWidget);        layout-&gt;addWidget(label);        layout-&gt;addWidget(m_textEdit);        setLayout(layout);        // è¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°        connect(m_searchWidget, &amp;SearchWidget::searchRequested, this, &amp;MainWindow::onSearchRequested);    &#125;private slots:    void onSearchRequested(const QString &amp;text)    &#123;        // TODO: æ‰§è¡Œæœç´¢æ“ä½œå¹¶æ›´æ–°m_textEditçš„å†…å®¹        qDebug() &lt;&lt; &quot;Searching for:&quot; &lt;&lt; text;    &#125;private:    SearchWidget *m_searchWidget;    QTextEdit *m_textEdit;&#125;;int main(int argc, char *argv[])&#123;    QApplication a(argc, argv);    MainWindow mainWindow;    mainWindow.show();    return a.exec();&#125;\n\nåœ¨è¯¥ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªè‡ªå®šä¹‰éƒ¨ä»¶ï¼šSearchWidgetå’ŒMainWindowã€‚SearchWidgetæ˜¯ä¸€ä¸ªåŒ…å«æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®çš„éƒ¨ä»¶ï¼Œç”¨äºè·å–ç”¨æˆ·è¾“å…¥å’Œå‘å‡ºæœç´¢è¯·æ±‚ï¼›è€ŒMainWindowåˆ™å±•ç¤ºäº†æœç´¢ç»“æœå¹¶æä¾›äº†ç›¸åº”çš„å¸ƒå±€ã€‚\næ€»ç»“åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªç®€å•çš„å†…åµŒå¼æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œå¹¶è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œæœç´¢æ“ä½œã€‚é€šè¿‡å°†æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ç»„åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°æ·»åŠ æœç´¢åŠŸèƒ½ï¼Œå¹¶æé«˜ç”¨æˆ·ä½“éªŒã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜ä»‹ç»äº†ä¸€äº›å¯ä»¥æ‹“å±•å’Œä¼˜åŒ–çš„æ–¹å‘ï¼ŒåŒ…æ‹¬ä½¿ç”¨å ä½ç¬¦æ–‡æœ¬ã€æ·»åŠ å¿«æ·é”®ã€æ˜¾ç¤ºè¿›åº¦æŒ‡ç¤ºå™¨ã€å®ç°è‡ªåŠ¨è¡¥å…¨ç­‰ã€‚è¿™äº›åŠŸèƒ½å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œå®šåˆ¶å’Œå®ç°ï¼Œä»¥æä¾›æ›´å¥½çš„æœç´¢ä½“éªŒã€‚\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæœç´¢åŠŸèƒ½é€šå¸¸æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç•Œé¢å…ƒç´ ï¼Œæ¶‰åŠåˆ°ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½ç­‰å¤šä¸ªæ–¹é¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»”ç»†è€ƒè™‘æœç´¢ç®—æ³•çš„å¤æ‚åº¦ã€æœç´¢ç»“æœçš„å‘ˆç°æ–¹å¼ã€æœç´¢æ“ä½œçš„å¹¶å‘æ€§ç­‰é—®é¢˜ï¼Œä»¥ä¿è¯æœç´¢åŠŸèƒ½çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚\næœ€åï¼ŒQtæä¾›äº†è®¸å¤šç›¸å…³çš„ç»„ä»¶å’Œç±»ï¼Œå¦‚QLineEditã€QPushButtonã€QLabelã€QTextEditç­‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œç®¡ç†ç”¨æˆ·ç•Œé¢å…ƒç´ ã€‚ç»“åˆä¿¡å·å’Œæ§½æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°å„ç§äº¤äº’å’Œäº‹ä»¶å¤„ç†ï¼Œä½¿å¾—æœç´¢åŠŸèƒ½æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚\nå‚è€ƒèµ„æ–™\nQt Documentation: QLineEdit Class\nQt Documentation: QPushButton Class\nQt Documentation: QLabel Class\nQt Documentation: QTextEdit Class\n\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªæœç´¢æ¡†","date":"2021-10-04T03:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e9e9c6fb0e1daf8f843d2ec1b3fc2e05","title":"ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªç™»å½•ç•Œé¢","content":"ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªç™»å½•ç•Œé¢åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªç™»å½•ç•Œé¢æ¥è®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶éªŒè¯å…¶èº«ä»½ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªç®€å•çš„ç™»å½•ç•Œé¢ï¼Œå¹¶æ¼”ç¤ºå¦‚ä½•è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œã€‚\nåˆ›å»ºç™»å½•ç•Œé¢é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQWidgetéƒ¨ä»¶ï¼Œå¹¶è®¾ç½®å…¶å¸ƒå±€ä¸ºå‚ç›´å¸ƒå±€ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å‘è¯¥å¸ƒå±€æ·»åŠ ä¸¤ä¸ªQLineEditå¯¹è±¡å’Œä¸€ä¸ªQPushButtonå¯¹è±¡ï¼Œä»¥åˆ†åˆ«åˆ›å»ºç”¨æˆ·åè¾“å…¥æ¡†ã€å¯†ç è¾“å…¥æ¡†å’Œç™»å½•æŒ‰é’®ã€‚\n1234567891011QWidget *loginWidget = new QWidget();QVBoxLayout *layout = new QVBoxLayout(loginWidget);QLineEdit *usernameEdit = new QLineEdit();QLineEdit *passwordEdit = new QLineEdit();passwordEdit-&gt;setEchoMode(QLineEdit::Password);QPushButton *loginButton = new QPushButton(&quot;Login&quot;);layout-&gt;addWidget(usernameEdit);layout-&gt;addWidget(passwordEdit);layout-&gt;addWidget(loginButton);\n\nè¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºå¯†ç è¾“å…¥æ¡†æ—¶ï¼Œå°†å…¶å›æ˜¾æ¨¡å¼ï¼ˆecho modeï¼‰è®¾ç½®ä¸ºå¯†ç æ¨¡å¼ï¼ˆPasswordï¼‰ã€‚è¿™æ ·åšå¯ä»¥éšè—ç”¨æˆ·è¾“å…¥çš„å®é™…å­—ç¬¦ï¼Œä»¥ä¿æŠ¤å…¶å®‰å…¨æ€§ã€‚\nè·å–ç”¨æˆ·è¾“å…¥å¹¶æ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œä¸ºäº†è·å–ç”¨æˆ·åœ¨ç”¨æˆ·åå’Œå¯†ç è¾“å…¥æ¡†ä¸­è¾“å…¥çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥QLineEditçš„textChanged()ä¿¡å·ï¼Œå¹¶å°†å…¶å‘é€åˆ°ä¸€ä¸ªæ§½å‡½æ•°ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æ–‡æœ¬å¹¶å­˜å‚¨å®ƒï¼Œä»¥å¤‡åç»­èº«ä»½éªŒè¯æ“ä½œä½¿ç”¨ã€‚\n123456789101112connect(usernameEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onUsernameTextChanged);connect(passwordEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onPasswordTextChanged);void MyClass::onUsernameTextChanged(const QString &amp;text)&#123;    m_username = text;&#125;void MyClass::onPasswordTextChanged(const QString &amp;text)&#123;    m_password = text;&#125;\n\nè¦æ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œï¼Œæˆ‘ä»¬åªéœ€å°†QPushButtonçš„clicked()ä¿¡å·è¿æ¥åˆ°ä¸€ä¸ªæ§½å‡½æ•°å³å¯ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­˜å‚¨çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯æ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œï¼Œå¹¶æ ¹æ®ç»“æœæ˜¾ç¤ºç›¸åº”çš„æ¶ˆæ¯æ¡†ï¼ˆä¾‹å¦‚æˆåŠŸç™»å½•æˆ–ç™»å½•å¤±è´¥ï¼‰ã€‚\n1234567891011connect(loginButton, &amp;QPushButton::clicked, this, &amp;MyClass::onLoginClicked);void MyClass::onLoginClicked()&#123;    bool isAuthenticated = authenticate(m_username, m_password);    if (isAuthenticated) &#123;        QMessageBox::information(this, &quot;Success&quot;, &quot;Login succeeded!&quot;);    &#125; else &#123;        QMessageBox::warning(this, &quot;Error&quot;, &quot;Invalid username or password.&quot;);    &#125;&#125;\n\nè¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ­¤ç¤ºä¾‹ä¸­ä½¿ç”¨äº†ä¸€ä¸ªauthenticate()å‡½æ•°æ¥æ¨¡æ‹Ÿèº«ä»½éªŒè¯æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ä»¥æŒ‡ç¤ºæ˜¯å¦éªŒè¯æˆåŠŸã€‚å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ›´åŠ å¤æ‚çš„èº«ä»½éªŒè¯é€»è¾‘æ¥ä¿éšœå®‰å…¨æ€§ã€‚\nå®Œæ•´ä»£ç ç¤ºä¾‹ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œå¹¶è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#include &lt;QApplication&gt;#include &lt;QWidget&gt;#include &lt;QVBoxLayout&gt;#include &lt;QLineEdit&gt;#include &lt;QPushButton&gt;#include &lt;QMessageBox&gt;class MyClass : public QWidget&#123;    Q_OBJECTpublic:    MyClass(QWidget *parent = nullptr) : QWidget(parent)    &#123;        // åˆ›å»ºç™»å½•ç•Œé¢        QWidget *loginWidget = new QWidget();        QVBoxLayout *layout = new QVBoxLayout(loginWidget);        QLineEdit *usernameEdit = new QLineEdit();        QLineEdit *passwordEdit = new QLineEdit();        passwordEdit-&gt;setEchoMode(QLineEdit::Password);        QPushButton *loginButton = new QPushButton(&quot;Login&quot;);        layout-&gt;addWidget(usernameEdit);        layout-&gt;addWidget(passwordEdit);        layout-&gt;addWidget(loginButton);        // è¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°        connect(usernameEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onUsernameTextChanged);        connect(passwordEdit, &amp;QLineEdit::textChanged, this, &amp;MyClass::onPasswordTextChanged);        connect(loginButton, &amp;QPushButton::clicked, this, &amp;MyClass::onLoginClicked);        // æ˜¾ç¤ºç™»å½•ç•Œé¢        setLayout(layout);        show();    &#125;private slots:    void onUsernameTextChanged(const QString &amp;text)    &#123;        m_username = text;    &#125;    void onPasswordTextChanged(const QString &amp;text)    &#123;        m_password = text;    &#125;    void onLoginClicked()    &#123;        bool isAuthenticated = authenticate(m_username, m_password);        if (isAuthenticated) &#123;            QMessageBox::information(this, &quot;Success&quot;, &quot;Login succeeded!&quot;);        &#125; else &#123;            QMessageBox::warning(this, &quot;Error&quot;, &quot;Invalid username or password.&quot;);        &#125;    &#125;private:    QString m_username;    QString m_password;    bool authenticate(const QString &amp;username, const QString &amp;password)    &#123;        // TODO: æ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œ        return username == &quot;admin&quot; &amp;&amp; password == &quot;123456&quot;;    &#125;&#125;;int main(int argc, char *argv[])&#123;    QApplication a(argc, argv);    MyClass myClass;    return a.exec();&#125;\n\nåœ¨è¯¥ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºMyClassçš„QWidgetå­ç±»ï¼Œç”¨äºå±•ç¤ºç™»å½•ç•Œé¢ã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ç”¨æˆ·åè¾“å…¥æ¡†ã€å¯†ç è¾“å…¥æ¡†å’Œç™»å½•æŒ‰é’®ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°å‚ç›´å¸ƒå±€ä¸­ã€‚ç„¶åï¼Œæˆ‘ä»¬è¿æ¥äº†QLineEditçš„textChanged()ä¿¡å·å’ŒQPushButtonçš„clicked()ä¿¡å·åˆ°ç›¸åº”çš„æ§½å‡½æ•°ä¸­ï¼Œä»¥è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œã€‚\nåœ¨onLoginClicked()æ§½å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å­˜å‚¨çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯æ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œï¼Œå¹¶æ ¹æ®ç»“æœæ˜¾ç¤ºç›¸åº”çš„æ¶ˆæ¯æ¡†ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„authenticate()å‡½æ•°æ¥æ¨¡æ‹Ÿèº«ä»½éªŒè¯æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ä»¥æŒ‡ç¤ºæ˜¯å¦éªŒè¯æˆåŠŸã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ›´åŠ å¤æ‚çš„èº«ä»½éªŒè¯é€»è¾‘æ¥ä¿éšœå®‰å…¨æ€§ã€‚\næœ€åï¼Œåœ¨main()å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªMyClasså¯¹è±¡ï¼Œå¹¶å¯åŠ¨Qtåº”ç”¨ç¨‹åºã€‚\næ€»ç»“åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Qtåˆ›å»ºä¸€ä¸ªç®€å•çš„ç™»å½•ç•Œé¢ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•è·å–ç”¨æˆ·è¾“å…¥å’Œæ‰§è¡Œèº«ä»½éªŒè¯æ“ä½œã€‚é€šè¿‡ç»“åˆQLineEditã€QPushButtonå’ŒQMessageBoxç­‰ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°å„ç§äº¤äº’å’Œäº‹ä»¶å¤„ç†ï¼Œä½¿å¾—ç™»å½•ç•Œé¢æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç™»å½•ç•Œé¢é€šå¸¸æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„ç•Œé¢å…ƒç´ ï¼Œæ¶‰åŠåˆ°èº«ä»½éªŒè¯å’Œå®‰å…¨æ€§ç­‰å¤šä¸ªæ–¹é¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»”ç»†è€ƒè™‘å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œä»¥ç¡®ä¿ç™»å½•åŠŸèƒ½çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚\næœ€åï¼ŒQtæä¾›äº†è®¸å¤šç›¸å…³çš„ç»„ä»¶å’Œç±»ï¼Œå¦‚QLineEditã€QPushButtonã€QMessageBoxç­‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œç®¡ç†ç”¨æˆ·ç•Œé¢å…ƒç´ ã€‚ç»“åˆä¿¡å·å’Œæ§½æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°å„ç§äº¤äº’å’Œäº‹ä»¶å¤„ç†ï¼Œä½¿å¾—ç™»å½•åŠŸèƒ½æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/ä½¿ç”¨Qtå¼€å‘ä¸€ä¸ªç™»å½•ç•Œé¢","date":"2021-10-04T03:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3c79f2443ad6c8142d688bf19c36b2ad","title":"QGraphicsDropShadowEffectçš„ä»‹ç»","content":"QGraphicsDropShadowEffectçš„ä»‹ç»QGraphicsDropShadowEffectæ˜¯Qtä¸­ä¸€ä¸ªç”¨äºæ·»åŠ é˜´å½±æ•ˆæœçš„å›¾å½¢ç‰¹æ•ˆç±»ï¼Œå¯ä»¥åœ¨å›¾å½¢æˆ–æ§ä»¶å‘¨å›´æ·»åŠ ä¸€å±‚é˜´å½±æ•ˆæœã€‚é€šè¿‡è°ƒæ•´é˜´å½±çš„åç§»ã€æ¨¡ç³Šåº¦ã€é¢œè‰²ç­‰å‚æ•°ï¼Œå¯ä»¥å®ç°å„ç§ç‹¬ç‰¹çš„è§†è§‰æ•ˆæœã€‚\nåŸºæœ¬ç”¨æ³•æ·»åŠ é˜´å½±é¦–å…ˆï¼Œåœ¨éœ€è¦æ·»åŠ é˜´å½±æ•ˆæœçš„QWidgetï¼ˆæˆ–QGraphicsItemï¼‰å¯¹è±¡ä¸Šåˆ›å»ºQGraphicsDropShadowEffectå¯¹è±¡ï¼š\n1QGraphicsDropShadowEffect *shadow = new QGraphicsDropShadowEffect(this);\n\nç„¶åï¼Œé€šè¿‡è°ƒæ•´é˜´å½±æ•ˆæœçš„å‚æ•°æ¥å®ç°ä¸åŒçš„è§†è§‰æ•ˆæœã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å°†å¯ç”¨5ä¸ªåƒç´ çš„æ¨¡ç³Šå’Œ45åº¦å‘å³ä¸‹æ–¹çš„åå…­è¿›åˆ¶é»‘è‰²é˜´å½±ï¼š\n123shadow-&gt;setBlurRadius(5);shadow-&gt;setOffset(3, 3);shadow-&gt;setColor(QColor(&quot;#000000&quot;));\n\nå°†QGraphicsDropShadowEffectåº”ç”¨åˆ°ç›¸åº”çš„QWidgetï¼ˆæˆ–QGraphicsItemï¼‰å¯¹è±¡ä¸Šï¼š\n1myWidget-&gt;graphicsEffect() = shadow;\n\nå¸¸ç”¨å‡½æ•°QGraphicsDropShadowEffectæä¾›äº†è®¸å¤šå¸¸è§çš„æ–¹æ³•ä»¥ä¾¿å¯¹é˜´å½±è¿›è¡Œè®¾ç½®å’Œç®¡ç†ã€‚ä¾‹å¦‚ï¼š\n\nsetBlurRadius()ï¼šè®¾ç½®é˜´å½±çš„æ¨¡ç³ŠåŠå¾„ã€‚\nsetOffset()ï¼šè®¾ç½®é˜´å½±ç›¸å¯¹äºåŸå§‹æ§ä»¶çš„åç§»é‡ã€‚\nsetColor()ï¼šè®¾ç½®é˜´å½±é¢œè‰²ã€‚\nsetOpacity()ï¼šè®¾ç½®é˜´å½±é€æ˜åº¦ã€‚\nsetEnabled()ï¼šå¯ç”¨æˆ–ç¦ç”¨é˜´å½±æ•ˆæœã€‚\nboundingRectFor()ï¼šè®¡ç®—äº§ç”Ÿçš„é˜´å½±ä¸‹é™Qtåº”ç”¨ç¨‹åºçš„èŒƒå›´ã€‚\n\nè®¾ç½®å½¢çŠ¶å¦‚æœéœ€è¦å°†é˜´å½±é™åˆ¶åœ¨è¾¹æ¡†å†…ï¼Œå¯ä»¥é€šè¿‡æ™®é€šçš„è®¾ç½®å½¢çŠ¶æ¥å®ç°ã€‚\n12345678QGraphicsDropShadowEffect *shadow = new QGraphicsDropShadowEffect(this);QPainterPath path;path.addRoundedRect(0, 0, width(), height(), 10, 10);shadow-&gt;setBlurRadius(20);shadow-&gt;setColor(QColor(&quot;#000000&quot;));shadow-&gt;setOffset(5,5);setGraphicsEffect(shadow);setMask(path.toFillPolygon().toPolygon());\n\nä¸Šé¢ä»£ç è¡¨ç¤ºä¸€ä¸ªåœ†è§’çŸ©å½¢çš„çª—å£ï¼ŒåŠå¾„ä¸º10åƒç´ ï¼Œå‘ä¸‹åç§»5ä¸ªåƒç´ ï¼Œä»¥åŠé»‘è‰²é¢œè‰²å’Œ20åƒç´ åŠå¾„çš„é˜´å½±ã€‚\nç»“è®ºæ€»ä¹‹ï¼ŒQGraphicsDropShadowEffectæä¾›äº†ä¸€ç§ç®€å•ä¸”çµæ´»çš„æ–¹æ³•æ¥æ·»åŠ é˜´å½±æ•ˆæœä»¥æ”¹å–„ç”¨æˆ·çš„è§†è§‰ä½“éªŒã€‚å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡æ›´æ”¹é˜´å½±æ•ˆæœçš„å‚æ•°æ¥å®ç°å„ç§ä¸åŒçš„è§†è§‰æ•ˆæœï¼Œé€šè¿‡å¯¹å½¢çŠ¶è¿›è¡Œé™åˆ¶ï¼Œæ¥æ»¡è¶³å…·ä½“ä¸šåŠ¡åœºæ™¯çš„éœ€æ±‚ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©é€‚å½“çš„é˜´å½±æ•ˆæœå‚æ•°ï¼Œå¹¶æ³¨æ„ä¸è¦è¿‡åº¦ä½¿ç”¨é˜´å½±æ•ˆæœä»¥å…å½±å“åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QGraphicsDropShadowEffectçš„ä»‹ç»","date":"2021-10-04T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"57a39664d5dfca7343351ad94bd0279c","title":"QAnimationçš„ä»‹ç»","content":"QAnimationçš„ä»‹ç»QAnimationæ˜¯Qtæ¡†æ¶ä¸­æä¾›çš„ä¸€ä¸ªåŠ¨ç”»ç±»ï¼Œç”¨äºå®ç°GUIæ§ä»¶çš„å„ç§åŠ¨ç”»æ•ˆæœã€‚å¯ä»¥é€šè¿‡QAnimationå®ç°å¦‚å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰åŠ¨æ€æ•ˆæœï¼ŒåŒæ—¶è¿˜æ”¯æŒåŠ¨æ€æ·»åŠ æˆ–åˆ é™¤æ§ä»¶ç­‰æ“ä½œã€‚\nåŸºæœ¬ç”¨æ³•åˆ›å»ºå’Œå¯åŠ¨åŠ¨ç”»é€šè¿‡ç»§æ‰¿QPropertyAnimationã€QSequentialAnimationGroupæˆ–QParallelAnimationGroupç­‰ç±»ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°åˆ›å»ºè‡ªå·±éœ€è¦çš„åŠ¨ç”»ã€‚\nä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„ä½ç§»åŠ¨ç”»ï¼Œå¹¶åœ¨ä¹‹åå¯åŠ¨ï¼š\n12345678QWidget* widget = new QWidget(this);widget-&gt;setGeometry(50, 50, 100, 100);QPropertyAnimation *animation = new QPropertyAnimation(widget, &quot;geometry&quot;);animation-&gt;setDuration(2000);animation-&gt;setStartValue(QRect(50, 50, 100, 100));animation-&gt;setEndValue(QRect(150, 150, 100, 100));animation-&gt;setEasingCurve(QEasingCurve::OutQuad);animation-&gt;start();\n\nå¸¸ç”¨å‡½æ•°QAnimationæä¾›äº†ä¸€äº›å¸¸è§çš„æ–¹æ³•ä»¥ä¾¿å¯¹åŠ¨ç”»è¿›è¡Œè®¾ç½®å’Œç®¡ç†ï¼š\n\nsetDuration()ï¼šè®¾ç½®åŠ¨ç”»æ‰§è¡Œæ—¶é—´ã€‚\nsetStartValue() å’Œ setEndValue()ï¼šè®¾ç½®åŠ¨ç”»å¼€å§‹å’Œç»“æŸçŠ¶æ€ã€‚\nsetEasingCurve()ï¼šè®¾ç½®åŠ¨ç”»çš„ç¼“åŠ¨æ›²çº¿ï¼ˆç”¨äºæ§åˆ¶åŠ¨ç”»é€Ÿåº¦å˜åŒ–çš„æ›²çº¿ï¼‰ã€‚\nsetLoopCount()ï¼šè®¾ç½®åŠ¨ç”»å¾ªç¯æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1æ¬¡ï¼ˆ-1è¡¨ç¤ºæ— é™å¾ªç¯ï¼‰ã€‚\nsetDirection()ï¼šè®¾ç½®åŠ¨ç”»çš„å‰è¿›æ–¹å‘ã€‚\nstop() å’Œ pause()ï¼šåœæ­¢æˆ–æš‚åœåŠ¨ç”»ã€‚\nstart()ï¼šå¯åŠ¨åŠ¨ç”»ã€‚\n\nåŠ¨ç”»ç»„åˆQAnimationè¿˜æä¾›äº†å¤šç§åŠ¨ç”»ç»„åˆæ–¹å¼ï¼Œä¾‹å¦‚ï¼š\n\nQSequentialAnimationGroupï¼šé¡ºåºæ’­æ”¾ä¸€ç³»åˆ—åŠ¨ç”»ã€‚\nQParallelAnimationGroupï¼šåŒæ—¶æ’­æ”¾ä¸€ç»„åŠ¨ç”»ã€‚\nQPauseAnimationï¼šæ’å…¥ä¸€ä¸ªæš‚åœæ—¶é—´æ®µã€‚\nQAnimationGroupï¼šä»¥ä»»æ„é¡ºåºæ’­æ”¾ä¸€ç»„ä¸åŒç±»å‹çš„åŠ¨ç”»ã€‚\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„QSequentialAnimationGroupä¾‹å­ï¼š\n12345678910111213141516QWidget* widget = new QWidget(this);widget-&gt;setGeometry(50, 50, 100, 100);QPropertyAnimation *animation1 = new QPropertyAnimation(widget, &quot;geometry&quot;);animation1-&gt;setDuration(1000);animation1-&gt;setStartValue(QRect(50, 50, 100, 100));animation1-&gt;setEndValue(QRect(150, 150, 100, 100));QPropertyAnimation *animation2 = new QPropertyAnimation(widget, &quot;geometry&quot;);animation2-&gt;setDuration(1000);animation2-&gt;setStartValue(QRect(150, 150, 100, 100));animation2-&gt;setEndValue(QRect(50, 50, 100, 100));QSequentialAnimationGroup *group = new QSequentialAnimationGroup;group-&gt;addAnimation(animation1);group-&gt;addAnimation(animation2);group-&gt;start();\n\næ€§èƒ½è€ƒè™‘QAnimationèƒ½å¤Ÿå®ç°æµç•…çš„åŠ¨ç”»æ•ˆæœï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ç‰¹åˆ«æ˜¯åœ¨æ“ä½œçš„æ§ä»¶æ•°é‡è¾ƒå¤šæˆ–è€…åŠ¨ç”»è¾ƒä¸ºå¤æ‚æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚\nå»ºè®®å‡å°‘ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹åˆ—æ–¹æ³•ï¼š\n\né€šè¿‡è°ƒæ•´setDuration()ä¹‹ç±»çš„å‚æ•°æ¥æ”¹å˜åŠ¨ç”»æ‰§è¡Œæ•ˆç‡ã€‚\nå¯¹äºæ— éœ€æ“ä½œï¼ˆæˆ–è€…ä¸å¯è§ï¼‰çš„æ§ä»¶ï¼Œå¯¹å…¶åœç”¨æˆ–æš‚åœå¯¹åº”åŠ¨ç”»ã€‚\nä¼˜åŒ–ç•Œé¢æ§ä»¶å¸ƒå±€å’Œæ˜¾ç¤ºï¼Œä½¿ç”¨ç¼“å­˜ç­‰æ‰‹æ®µæ¥åŠ é€ŸåŠ¨ç”»æ¸²æŸ“è¿‡ç¨‹ã€‚\n\nç»“è®ºæ€»ä¹‹ï¼ŒQAnimationæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¯ä»¥æºæºä¸æ–­åœ°ä¸ºQtåº”ç”¨å¼€å‘äººå‘˜å¸¦æ¥æ— é™å¯èƒ½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦ç»“åˆå…·ä½“ä¸šåŠ¡éœ€æ±‚é€‰æ‹©å„ç§ä¸åŒçš„QPropertyAnimationã€QSequentialAnimationGroupæˆ–å…¶ä»–åŠ¨ç”»ç»„åˆæ–¹å¼ï¼Œä»¥åŠè®¾ç½®åˆç†çš„å‚æ•°å’Œæ‰§è¡Œç­–ç•¥æ¥è¾¾åˆ°æœ€ä½³çš„åŠ¨ç”»æ•ˆæœå’Œæ€§èƒ½è¡¨ç°ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/QAnimationçš„ä»‹ç»","date":"2021-10-04T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"4ffa61e24f1f48ce78e535f52d6a978c","title":"Q_DæŒ‡é’ˆï¼šQtä¸­çš„ç§æœ‰æŒ‡é’ˆ","content":"Q_DæŒ‡é’ˆï¼šQtä¸­çš„ç§æœ‰æŒ‡é’ˆåœ¨å¼€å‘Qtåº”ç”¨ç¨‹åºæ—¶ï¼Œä¸ºäº†ä¿æŠ¤å¯¹è±¡çš„ç§æœ‰æ•°æ®å¹¶æé«˜ä»£ç å¥å£®æ€§ï¼Œç»å¸¸ä¼šä½¿ç”¨QObjectå’ŒQSharedDataç­‰ã€‚ç„¶è€Œï¼ŒQ_DæŒ‡é’ˆæ˜¯ä¸€ç§æ›´é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥é¿å…å¤åˆ¶æ•°æ®ï¼Œä¿æŠ¤å¯¹è±¡ä¸å—å¤–éƒ¨è®¿é—®ï¼Œå¹¶å‡å°‘å†…å­˜åˆ†é…å’Œå¤åˆ¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»Q_DæŒ‡é’ˆçš„åŸç†ã€ä¼˜ç‚¹å’Œä½¿ç”¨æ–¹æ³•ã€‚\nä»€ä¹ˆæ˜¯Q_DæŒ‡é’ˆï¼ŸQ_DæŒ‡é’ˆæ˜¯Qtæ¡†æ¶ä¸­çš„ç§æœ‰æŒ‡é’ˆï¼Œç”¨äºéšè—å¯¹è±¡çš„å®ç°å’Œä¿æŠ¤å…¶æ•°æ®ã€‚Q_DæŒ‡é’ˆçš„åŸç†æ˜¯å°†å¯¹è±¡çš„å®ç°æ”¾åœ¨å•ç‹¬çš„ç±»ï¼ˆä¾‹å¦‚MyClassPrivateï¼‰ä¸­ï¼Œç„¶åå°†Q_DæŒ‡é’ˆä½œä¸ºæŒ‡å‘è¯¥ç±»çš„å•ä¸ªæˆå‘˜å˜é‡å­˜å‚¨åœ¨ä¸»ç±»ä¸­ã€‚è¿™æ„å‘³ç€åªæœ‰è¯¥ç±»å¯ä»¥è®¿é—®æ­¤æŒ‡é’ˆï¼Œå¹¶ä¸”å¯¹è±¡çš„å®ç°å¯ä»¥è½»æ¾åœ°æ›´æ”¹è€Œæ— éœ€æ›´æ”¹å…¬å…±æ¥å£ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨Q_DæŒ‡é’ˆçš„ç¤ºä¾‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344#include &lt;QExplicitlySharedDataPointer&gt;#include &lt;iostream&gt;class MyClassPrivate;class MyClass &#123;public:    MyClass();    ~MyClass();    void setNumber(int number);    int getNumber() const;private:    QExplicitlySharedDataPointer&lt;MyClassPrivate&gt; const d_ptr;&#125;;class MyClassPrivate &#123;public:    int m_number;&#125;;MyClass::MyClass() : d_ptr(new MyClassPrivate)&#123; &#125;MyClass::~MyClass()&#123; &#125;void MyClass::setNumber(int number) &#123;    d_ptr-&gt;m_number = number;&#125;int MyClass::getNumber() const &#123;    return d_ptr-&gt;m_number;&#125;int main() &#123;    MyClass* myObject = new MyClass;    myObject-&gt;setNumber(42);    std::cout &lt;&lt; &quot;My object&#x27;s number is: &quot; &lt;&lt; myObject-&gt;getNumber() &lt;&lt; std::endl;    delete myObject;    return 0;&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸ºâ€œMyClassâ€çš„ä¸»ç±»å’Œä¸€ä¸ªåä¸ºâ€œMyClassPrivateâ€çš„è¾…åŠ©ç±»ã€‚åœ¨MyClassä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Q_DæŒ‡é’ˆä½œä¸ºç§æœ‰æˆå‘˜å˜é‡ï¼Œå¹¶å°†å®ƒå­˜å‚¨åœ¨constå˜é‡d_pträ¸­ã€‚ç„¶åï¼Œåœ¨MyClassPrivateä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„æ•°æ®æˆå‘˜m_numberï¼Œå¹¶ä»MyClassä¸­ä½¿ç”¨setNumber()å’ŒgetNumber()æ–¹æ³•è¿›è¡Œè®¿é—®ã€‚\næœ€åï¼Œåœ¨main()å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„MyClasså¯¹è±¡ï¼Œå¹¶ä½¿ç”¨setNumber()å’ŒgetNumber()æ–¹æ³•è®¾ç½®å’Œæ£€ç´¢å¯¹è±¡çš„æ•°å­—ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨deleteæ“ä½œç¬¦åˆ é™¤å¯¹è±¡ä»¥é¿å…å†…å­˜æ³„æ¼ã€‚\nQ_DæŒ‡é’ˆçš„ä¼˜ç‚¹ä½¿ç”¨Q_DæŒ‡é’ˆä½œä¸ºQtåº”ç”¨ç¨‹åºçš„å¼€å‘æ¨¡å¼æœ‰è®¸å¤šå¥½å¤„ï¼š\n\nç§æœ‰åŒ–å®ç°ï¼šQ_DæŒ‡é’ˆé¿å…ç›´æ¥è®¿é—®å’Œæ›´æ”¹å¯¹è±¡çŠ¶æ€ï¼Œä»è€Œä¿æŠ¤å¯¹è±¡åŠå…¶æ•°æ®å¹¶å‡å°‘æ“ä½œéœ€è¦ç®¡ç†å‘˜é£é™©ã€‚\né¿å…å¤åˆ¶ï¼šQ_DæŒ‡é’ˆé¿å…äº†å¯¹è±¡çš„å¤åˆ¶ï¼Œä»è€Œå‡å°‘äº†å†…å­˜åˆ†é…å’Œæ‹·è´æ“ä½œï¼ŒèŠ‚çº¦æ—¶é—´å’Œèµ„æºã€‚\nå¯æµ‹è¯•æ€§ï¼šä½¿ç”¨Q_DæŒ‡é’ˆå¯ä»¥ä½¿ç±»æ›´æ˜“äºæµ‹è¯•å’Œè°ƒè¯•ã€‚Q_DæŒ‡é’ˆå‡å°‘äº†å…¬å…±æ¥å£çš„å¤æ‚æ€§ï¼Œä½¿å¾—æ›´å®¹æ˜“æ„å»ºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚\n\nä½¿ç”¨Q_DæŒ‡é’ˆçš„æ³¨æ„ç‚¹åœ¨ä½¿ç”¨Q_DæŒ‡é’ˆæ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š\n\nå®ç°éœ€è¦å•ç‹¬å®šä¹‰ï¼š è¾…åŠ©ç±»å‹å•ç‹¬å®šä¹‰ä»¥ç¡®ä¿è¾…åŠ©ç±»å‹åªèƒ½é€šè¿‡Q_DæŒ‡é’ˆè®¿é—®ã€‚\næŒ‡é’ˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼šQ_DæŒ‡é’ˆä»éœ€è¦é”å®šï¼Œæœ‰è®¸å¤šé€‰é¡¹å¯ç”¨äºå®ç°è¯¥ç›®æ ‡ï¼Œä¾‹å¦‚ä¿¡å·æ§½æœºåˆ¶å’Œäº’æ–¥ä½“ç­‰ã€‚\nä¾èµ–QObjectï¼šç”±äºQ_DæŒ‡é’ˆéœ€è¦è®¿é—®QObjectçš„å…ƒä¿¡æ¯ï¼Œå› æ­¤åªèƒ½ä¸æ´¾ç”Ÿè‡ªQObjectçš„ç±»ä¸€èµ·ä½¿ç”¨ã€‚\n\nç»“è®ºQ_DæŒ‡é’ˆæ˜¯ä¸€ç§ç”¨äºä¿æŠ¤å¯¹è±¡å®ç°å¹¶é˜²æ­¢æ•°æ®å¤åˆ¶çš„Qtåº”ç”¨ç¨‹åºå¼€å‘æ¨¡å¼ã€‚å®ƒä½¿å¾—æˆ‘ä»¬å¼€å‘æ›´é«˜æ•ˆã€å…·å¤‡æ›´å¥½å¯æµ‹è¯•æ€§å’Œå‡å°‘å†…å­˜åˆ†é…çš„å®‰å…¨ä»£ç å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚æœ‰äº†Q_DæŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¤æ‚å¯¹è±¡ä¸­æ•°æ®çš„å°è£…å’Œç®¡ç†ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´å¿«åœ°å¼€å‘æ›´å¥å£®çš„Qtåº”ç”¨ç¨‹åºã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Q_DæŒ‡é’ˆï¼šQtä¸­çš„ç§æœ‰æŒ‡é’ˆ","date":"2021-10-04T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"9eb2b1aca9e69bfaa81739ec33faa057","title":"qRegisterMetaTypeï¼šQtä¸­çš„å…ƒç±»å‹æ³¨å†Œæœºåˆ¶","content":"qRegisterMetaTypeï¼šQtä¸­çš„å…ƒç±»å‹æ³¨å†Œæœºåˆ¶Qtæ¡†æ¶æä¾›äº†å¼ºå¤§çš„ä¿¡å·æ§½æœºåˆ¶å’Œåå°„åŠŸèƒ½ã€‚åœ¨è¿™äº›æœºåˆ¶ä¸‹ï¼Œå…ƒç±»å‹æ³¨å†Œæ˜¯ä¸€é¡¹é‡è¦ä¸”å¿…é¡»çš„æ“ä½œã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†è‡ªå®šä¹‰çš„C++ç±»æˆ–è€…ç»“æ„ä½“æš´éœ²ç»™Qtçš„å…ƒå¯¹è±¡ç³»ç»Ÿï¼Œä»¥ä¾¿èƒ½å¤Ÿé€šè¿‡ä¿¡å·æ§½æœºåˆ¶æˆ–è€…QVariantç­‰è¿›è¡Œå¤„ç†ã€‚qRegisterMetaTypeæ˜¯Qtä¸­ç”¨äºå…ƒç±»å‹æ³¨å†Œçš„å‡½æ•°ï¼Œæœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å®ƒçš„ä½¿ç”¨æ–¹æ³•å’Œåº”ç”¨åœºæ™¯ã€‚\nä»€ä¹ˆæ˜¯å…ƒç±»å‹æ³¨å†Œï¼Ÿå…ƒç±»å‹æ³¨å†Œæ˜¯å‘Qtå…ƒå¯¹è±¡ç³»ç»Ÿä¸­æ³¨å†ŒæŸä¸ªC++æ•°æ®ç±»å‹ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«Qtä¿¡å·æ§½æœºåˆ¶ã€åŠ¨æ€å±æ€§ã€QObjectå­ç±»åŒ–ï¼ˆQ_OBJECTï¼‰ç­‰ç±»å‹ç³»ç»Ÿæ‰€æ”¯æŒå’Œè¯†åˆ«ã€‚C++ä¸­çš„ç®€å•ç±»å‹ï¼Œå¦‚intã€charã€void*ç­‰ï¼Œå·²ç»è¢«Qtè¿›è¡Œè¿‡åˆå§‹åŒ–å¹¶æ³¨å†Œã€‚ä½†æ˜¯æˆ‘ä»¬å®šä¹‰çš„è‡ªå®šä¹‰ç±»å‹ï¼Œå¦‚ä¸ªäººä¿¡æ¯ã€è®¢å•ã€æ¶ˆæ¯ç­‰ç­‰ï¼Œéœ€è¦é€šè¿‡å…ƒç±»å‹æ³¨å†Œæ‰èƒ½ä¸ºQtæ¡†æ¶æ‰€ç”¨ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä»‹ç»äº†å¦‚ä½•ä½¿ç”¨qRegisterMetaTypeæ¥æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»ï¼š\n123456789101112131415161718192021222324252627282930#include &lt;QtCore/QCoreApplication&gt;#include &lt;QtCore/QMetaType&gt;class MyClass &#123;public:    MyClass() : m_data(0) &#123;&#125;    explicit MyClass(int data) : m_data(data) &#123;&#125;    int getData() const &#123; return m_data; &#125;private:    int m_data;&#125;;Q_DECLARE_METATYPE(MyClass)int main(int argc, char** argv) &#123;    QCoreApplication app(argc, argv);    qRegisterMetaType&lt;MyClass&gt;(&quot;MyClass&quot;);    MyClass myObject(42);   QMetaType::Type type = QMetaType::type(&quot;MyClass&quot;);   if (type != QMetaType::UnknownType) &#123;       qDebug() &lt;&lt; &quot;MyClass is a registered meta-type!&quot;;   &#125;   return app.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšâ€MyClassâ€çš„ç±»ï¼Œå¹¶ä½¿ç”¨äº†Q_DECLARE_METATYPEå®æ¥å£°æ˜å®ƒæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç±»å‹ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨qRegisterMetaTypeå‡½æ•°å°†è¿™ä¸ªç±»æ³¨å†Œåˆ°Qtå…ƒå¯¹è±¡ç³»ç»Ÿä¸­ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ ‡ç­¾åç§°â€œMyClassâ€ã€‚\nåˆ›å»ºäº†MyClasså¯¹è±¡ï¼ˆm_dataè¢«åˆå§‹åŒ–ä¸º42ï¼‰ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡Q_MetaType::type()å‡½æ•°æ£€æŸ¥æ˜¯å¦æ­£ç¡®åœ°æ³¨å†Œäº†è¯¥ç±»ã€‚å¦‚æœæ­£ç¡®æ³¨å†Œï¼Œåˆ™è¿”å›ç±»å‹QMetaType::Typeæ— æ•ˆ,å¦åˆ™è¿”å›QMetaType::UnknownTypeã€‚\nqRegisterMetaTypeçš„åº”ç”¨åœºæ™¯\nä¼ é€’å¤æ‚ç±»å‹å‚æ•°: å…ƒç±»å‹æ³¨å†Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨ä¿¡å·æ§½ä¹‹é—´ä¼ é€’æˆ‘ä»¬è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œè€Œä¸å¿…ä¾é QVariantè¿›è¡Œæ•°æ®å¤„ç†ä»è€Œè¿›è¡Œæ‰©å±•ã€‚\nç»§æ‰¿QObjectåæ·»åŠ æ–°çš„äº‹ä»¶æˆ–è€…å±æ€§: Q_OBJECTç±»ä¸­å®šä¹‰çš„äº‹ä»¶å’Œå±æ€§æ˜¯åŸºäºå…ƒå¯¹è±¡ç³»ç»Ÿå®ç°çš„ï¼Œå› æ­¤å¯¹äºæ–°çš„äº‹ä»¶æˆ–è€…å±æ€§ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨qRegisterMetaTypeå¢åŠ æ”¯æŒã€‚\næ„å»ºQtå¯¹å¤–éƒ¨åº“çš„æ¡¥æ¢ï¼šåœ¨æƒ³è¦å°†ç¬¬ä¸‰æ–¹åº“ä¸Qtç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†è‡ªå®šä¹‰ç±»å‹æ³¨å†Œä¸ºå…ƒç±»å‹ã€‚\n\nqRegisterMetaTypeæ³¨æ„ç‚¹\nå¯¹äºconstçš„m_amedataéœ€è¦ä¼ é€’åŒ…è£…å™¨ç±» ï¼ˆå¦‚QSharedPointer,const_cast åŒ…è£…å™¨ç­‰ï¼‰ã€‚\nå…ƒå¯¹è±¡ç³»ç»Ÿå†…éƒ¨æœ‰ä¸€ä¸ªHardcoded list of Qt data typeså·²ç»æ·»åŠ åˆ°Q_RegisterMetaTypeä¸­äº†ï¼Œå¦‚æœå·²ç»æ·»åŠ åˆ™ä¸éœ€è¦é¢å¤–æ·»åŠ ä¸¤æ¬¡ã€‚\nåœ¨ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®ç±»å‹ä¹‹å‰å¿…é¡»å…ˆè¿›è¡Œæ³¨å†Œï¼Œå¦åˆ™ç¨‹åºå¯èƒ½ä¼šå´©æºƒã€‚\nç”±äºQTçš„meta objectæ˜¯ç”¨å®æ¥å£°æ˜å…ƒä¿¡æ¯çš„ï¼Œå› æ­¤C++æ ‡å‡†çš„RTTI(Run-Time Type Information)å¹¶ä¸èƒ½åº”ç”¨äºæ­¤ã€‚\n\nç»“è®ºåœ¨Qtå¼€å‘ä¸­ï¼Œå…ƒç±»å‹æ³¨å†Œæ˜¯ä¸€é¡¹éå¸¸é‡è¦çš„æ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰æ•°æ®ç±»å‹æˆä¸ºQtå…ƒå¯¹è±¡ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚ä½¿ç”¨qRegisterMetaTypeå¯ä»¥è½»æ¾åœ°å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œé¿å…äº†ä¸å¿…è¦çš„å†—ä½™ä»£ç å’Œå…¶ä»–é—®é¢˜ï¼Œåœ¨Qtåº”ç”¨ç¨‹åºå¼€å‘ä¸­åˆå…·æœ‰é‡è¦åœ°ä½ã€‚ é€šè¿‡è¯¥æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ ä»£ç çš„å¥å£®æ€§ï¼Œå¹¶æ›´åŠ æœ‰æ•ˆåœ°ç¼–å†™åŸºäºå…ƒå¯¹è±¡ç³»ç»Ÿçš„ä»£ç ï¼Œå®ç°æ›´å¥½çš„æ•ˆç‡å’Œå¯è¯»æ€§ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/qRegisterMetaTypeï¼šQtä¸­çš„å…ƒç±»å‹æ³¨å†Œæœºåˆ¶","date":"2021-10-04T03:34:06.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"4d9fef62ec588fa571ad0698797e052d","title":"Qtä¸­åˆ›å»ºé›·è¾¾æ‰«æç•Œé¢","content":"Qtä¸­åˆ›å»ºé›·è¾¾æ‰«æç•Œé¢æ­¥éª¤1ï¼šæ·»åŠ QPainteræ˜¾ç¤ºåŒºåŸŸåœ¨Qtå·¥ç¨‹ä¸­æ‰“å¼€è¦å¤„ç†çš„UIè§†å›¾æ–‡ä»¶ã€‚å°†â€œQPainterâ€æ”¾å…¥æ ¸å¿ƒçª—å£ä¸­ï¼Œå¹¶è®¾ç½®å…¶å¤§å°å’Œä½ç½®ã€‚ä¸‹é¢æ˜¯åœ¨Qt Creatorä¸­æ·»åŠ QPainterçš„ä»£ç ç¤ºä¾‹ï¼š\n1234QPainter painter(this);painter.setPen(Qt::black);painter.setBrush(Qt::gray);painter.drawRect(0, 0, width(), height());\n\næ­¥éª¤2ï¼šç»˜åˆ¶é›·è¾¾çº¿ä½¿ç”¨QPainteråœ¨å±å¹•ä¸Šç”»çº¿ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨start()ä¸end()æ–¹æ³•ï¼ˆè¿™ç§æ–¹å¼åœ¨Qt Creatorçš„paintEvent()å‡½æ•°ä¸­æä¾›ï¼‰ã€‚ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ç»˜åˆ¶é›·è¾¾çº¿ï¼š\n12painter.setPen(QPen(Qt::green, 3));painter.drawLine(0, 0, x, y);\nè¿™å°†åœ¨å±å¹•ä¸Šç»˜åˆ¶ä¸€æ¡ä»ï¼ˆ0,0ï¼‰åˆ°ï¼ˆx,yï¼‰çš„ç»¿è‰²çº¿ã€‚\næ­¥éª¤3ï¼šç»˜åˆ¶é›·è¾¾æ‰‡å½¢ç»˜åˆ¶åœ†å¼§å¹¶å°†å…¶å¡«å……ä¸ºæ‰‡å½¢ï¼Œä½¿ç”¨ä»¥ä¸‹æ­¥éª¤ï¼š\næ­¥éª¤1ï¼šå®šä¹‰QPainterPath\nåˆ©ç”¨QPainterPathç±»å®šä¹‰ä¸€ä¸ªè·¯å¾„ï¼Œå¹¶è®¾ç½®å…¶èµ·ç‚¹å’Œè§’åº¦åº¦æ•°ï¼ˆdï¼‰ï¼š\n123QPainterPath path;path.moveTo(0, 0);path.arcTo(-100, -100, 200, 200, 30 * 16, d * 16);\n\næ­¥éª¤2ï¼šç»˜åˆ¶QPainterPath\nå°†è·¯å¾„ä¼ é€’ç»™QPainterï¼Œå¹¶åœ¨ç”»å¸ƒä¸Šå¼€å§‹ç”»å›¾ï¼š\n123painter.setBrush(QBrush(Qt::green));painter.setPen(Qt::NoPen);painter.drawPath(path);\n\nè¿™å°†åœ¨å±å¹•ä¸Šç»˜åˆ¶ä¸€ä¸ªä»å½“å‰æ§ä»¶çš„ä¸­å¿ƒå‘å³30Â°çš„åœ†å¼§å¹¶è¿›è¡Œå¡«å……ã€‚\néšç€æŒæ¡æŠ€æœ¯ï¼Œæ‚¨å¯ä»¥æ·»åŠ æ›´å¤šçš„ä»£ç ä»¥åˆ›å»ºå®Œæ•´çš„é›·è¾¾æ‰«æç•Œé¢ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä¸­åˆ›å»ºé›·è¾¾æ‰«æç•Œé¢","date":"2021-10-03T05:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"8c7d4356d8bda200c9e956adb3733402","title":"QWidgetï¼šQtä¸­çš„åŸºæœ¬ç”¨æˆ·ç•Œé¢ç±»","content":"QWidgetï¼šQtä¸­çš„åŸºæœ¬ç”¨æˆ·ç•Œé¢ç±»QStringç±»æ˜¯Qtä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç±»ï¼Œç”¨äºè¡¨ç¤ºåŸºæœ¬ç”¨æˆ·ç•Œé¢æ„ä»¶ã€‚å®ƒæ˜¯å…¶ä»–ç”¨æˆ·ç•Œé¢(Widget)ç±»çš„åŸºç±»ï¼Œä¾‹å¦‚QMainWindowã€QDialogå’ŒQPushButtonç­‰ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»QWidgetç±»çš„åŠŸèƒ½å’Œåº”ç”¨åœºæ™¯ã€‚\nåˆ›å»ºQWidgetå¯¹è±¡ä¸ºäº†åˆ›å»ºQWidgetå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QWidgetçš„é»˜è®¤æ„é€ å‡½æ•°æˆ–æŒ‡å®šå…¶çˆ¶å¯¹è±¡ã€åç§°å’Œå…¶ä»–å±æ€§çš„æ„é€ å‡½æ•°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªç®€å•çš„QWidgetå¯¹è±¡ï¼š\n1234567891011#include &lt;QWidget&gt;#include &lt;QApplication&gt;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    QWidget widget;                // é»˜è®¤çš„QWidgetå®ä¾‹    widget.show();    return app.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨QWidgetçš„é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åä¸ºâ€œwidgetâ€çš„QWidgetå®ä¾‹ï¼Œå¹¶é€šè¿‡è°ƒç”¨å…¶show()æ–¹æ³•ä½¿å…¶åœ¨å±å¹•ä¸Šå¯è§ã€‚\nQWidgetå±æ€§å’Œæ–¹æ³•QWidgetæœ‰è®¸å¤šå±æ€§å’Œæ–¹æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åˆ—å‡ºäº†å…¶ä¸­çš„ä¸€äº›æœ€å¸¸ç”¨å’Œæœ€é‡è¦çš„:\n\nresize(): è®¾ç½®QWidgetçš„å¤§å°ã€‚\nmove(): å°†QWidgetç§»åŠ¨åˆ°ç»™å®šçª—å£åæ ‡ã€‚\nshow(): æ˜¾ç¤ºQWidgetã€‚\nhide(): éšè—QWidgetã€‚\nsetWindowTitle(): è®¾ç½®çª—å£æ ‡é¢˜ã€‚\nsetWindowIcon(): è®¾ç½®çª—å£å›¾æ ‡ã€‚\nsetLayout(): è®¾ç½®QWidgetçš„å¸ƒå±€ç®¡ç†å™¨ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨åˆ›å»ºä¸€ä¸ªQWidgetç•Œé¢å’Œè®¾ç½®æ ‡é¢˜ã€å¤§å°å’Œå¸ƒå±€ï¼š\n1234567891011121314151617181920#include &lt;QWidget&gt;#include &lt;QHBoxLayout&gt;#include &lt;QApplication&gt;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    QWidget widget;    widget.setWindowTitle(&quot;My Widget&quot;);    widget.resize(400, 300);    QHBoxLayout* layout = new QHBoxLayout;    QLabel* label = new QLabel(&quot;Hello World&quot;, &amp;widget);    layout-&gt;addWidget(label);    widget.setLayout(layout);    widget.show();    return app.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„QWidgetå®ä¾‹â€œwidgetâ€ï¼Œå¹¶è®¾ç½®å…¶æ ‡é¢˜ä¸ºâ€œMy Widgetâ€å’Œå¤§å°ä¸º400x300ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ°´å¹³å¸ƒå±€å¹¶å‘å…¶ä¸­æ·»åŠ äº†ä¸€ä¸ªåŒ…å«â€œHello Worldâ€æ–‡æœ¬çš„æ ‡ç­¾ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è¯¥å¸ƒå±€è®¾ç½®ä¸ºQWidgetçš„å¸ƒå±€ç®¡ç†å™¨ï¼Œå¹¶ä½¿QWidgetåœ¨å±å¹•ä¸Šå¯è§ã€‚\nQWidgetäº‹ä»¶å¤„ç†æ‰€æœ‰QWidgetéƒ½æœ‰äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥å“åº”æ¥è‡ªç³»ç»Ÿå’Œç”¨æˆ·ç•Œé¢çš„äº‹ä»¶ï¼Œä¾‹å¦‚çª—å£é‡ç»˜ã€é¼ æ ‡å•å‡»ç­‰äº‹ä»¶ã€‚è¿™äº›æ–¹æ³•å…è®¸æˆ‘ä»¬ç¼–å†™è‡ªå®šä¹‰äº‹ä»¶å¤„ç†ç¨‹åºä»¥æ§åˆ¶ç”¨æˆ·ç•Œé¢çš„è¡Œä¸ºã€‚\nå¸¸ç”¨çš„QWidgetäº‹ä»¶å¤„ç†æ–¹æ³•æœ‰ï¼š\n\nmousePressEvent(QMouseEvent *event): é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ã€‚\nmouseMoveEvent(QMouseEvent *event): é¼ æ ‡ç§»åŠ¨äº‹ä»¶ã€‚\nkeyPressEvent(QKeyEvent *event): é”®ç›˜æŒ‰ä¸‹äº‹ä»¶ã€‚\nresizeEvent(QResizeEvent *event): çª—å£å¤§å°è°ƒæ•´äº‹ä»¶ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•å®ç°QWidgetçš„äº‹ä»¶å¤„ç†ï¼š\n1234567891011121314151617181920212223#include &lt;QWidget&gt;#include &lt;QMouseEvent&gt;#include &lt;QApplication&gt;class MyWidget : public QWidget &#123;public:    MyWidget() &#123; &#125;protected:    void mousePressEvent(QMouseEvent *event) override &#123;        qDebug() &lt;&lt; &quot;Mouse pressed at:&quot; &lt;&lt; event-&gt;pos();    &#125;&#125;;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    MyWidget widget;    widget.resize(400, 300);    widget.show();    return app.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„â€œMyWidgetâ€ç±»æ´¾ç”Ÿè‡ªQWidgetï¼Œå¹¶é‡å†™äº†å…¶mousePressEvent()æ–¹æ³•ï¼Œä»¥å¤„ç†é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ï¼Œå¹¶é€šè¿‡qDebug()è¾“å‡ºç‚¹å‡»ä½ç½®çš„åæ ‡ã€‚æœ€åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œwidgetâ€çš„MyWidgetå¯¹è±¡ï¼Œå¹¶ä½¿å®ƒå¯è§ã€‚\nç»“è®ºåœ¨Qtåº”ç”¨ç¨‹åºä¸­ï¼ŒQWidgetæ˜¯æ‰€æœ‰ç”¨æˆ·ç•Œé¢åŸºç¡€çš„ç±»å’Œçˆ¶ç±»ã€‚å®ƒæä¾›äº†è®¸å¤šå±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°åˆ›å»ºã€è®¾ç½®å¹¶å“åº”ç”¨æˆ·ç•Œé¢ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒQWidgetè¿˜æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„äº‹ä»¶å¤„ç†ç³»ç»Ÿï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿç¼–å†™è‡ªå®šä¹‰äº‹ä»¶å¤„ç†ç¨‹åºæ¥æ§åˆ¶åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/QWidgetï¼šQtä¸­çš„åŸºæœ¬ç”¨æˆ·ç•Œé¢ç±»","date":"2021-10-03T02:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ef385d6b305945df4f94b44ac9927f7a","title":"Qtä½¿ç”¨å¸ƒå±€","content":"Qtä½¿ç”¨å¸ƒå±€åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šä»‹ç»Qtä¸­çš„å„ç§å¸ƒå±€æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥ç®¡ç†æ§ä»¶çš„ä½ç½®å’Œå¤§å°ã€‚åœ¨Qtä¸­æœ‰å¾ˆå¤šç§å¸ƒå±€ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚é€‰æ‹©ä¸åŒçš„å¸ƒå±€æ–¹å¼ã€‚\nå¸ƒå±€ç®¡ç†å™¨åœ¨Qtä¸­ï¼Œå¸ƒå±€ç®¡ç†å™¨æ˜¯ç”¨æ¥è‡ªåŠ¨è°ƒæ•´çª—å£ä¸­åŒ…å«æ§ä»¶çš„ä½ç½®å’Œå¤§å°çš„ã€‚Qtæä¾›äº†å››ç§å¸¸ç”¨çš„å¸ƒå±€ç®¡ç†å™¨ï¼šQHBoxLayoutã€QVBoxLayoutã€QGridLayoutå’ŒQFormLayoutã€‚å®ƒä»¬çš„ä¸»è¦ä¸åŒåœ¨äºå®ƒä»¬å¦‚ä½•ç®¡ç†å’Œæ’åˆ—çª—å£ä¸­çš„æ§ä»¶ã€‚\nQHBoxLayoutå¸ƒå±€QHBoxLayoutï¼Œä¹Ÿç§°ä¸ºæ°´å¹³å¸ƒå±€ï¼Œé€‚ç”¨äºåœ¨ä¸€ä¸ªæ°´å¹³è¡Œä¸Šå¯¹æ§ä»¶è¿›è¡Œæ’åˆ—ã€‚ä»¥ä¸‹ä»£ç å°†å¸®åŠ©ä½ åˆ›å»ºå¹¶å®ç°QHBoxLayoutå¸ƒå±€ï¼š\n12345QHBoxLayout* layout = new QHBoxLayout;layout -&gt;addWidget(w1);layout -&gt;addWidget(w2);...setLayout(layout);\n\nè¿™é‡Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªQHBoxLayoutå¯¹è±¡ï¼Œæ¥ç€å°†æ§ä»¶w1ã€w2ç­‰æ·»åŠ åˆ°å†…éƒ¨ï¼Œç„¶åå°†è¯¥å¸ƒå±€è®¾ç½®ç»™å½“å‰çš„å®¹å™¨QWidgetï¼Œä¾‹å¦‚MainWindowæˆ–å…¶ä»–å®šåˆ¶åŒ–çš„çª—å£ã€‚å½“æˆ‘ä»¬ä½¿ç”¨setGeometry()æˆ–resize()å‡½æ•°è°ƒæ•´ä¸»çª—å£å¤§å°æ—¶ï¼Œå¸ƒå±€ç®¡ç†å™¨å°†è‡ªåŠ¨è°ƒæ•´å­æ§ä»¶çš„ä½ç½®å’Œå¤§å°ã€‚\nQVBoxLayoutå¸ƒå±€ç›¸å¯¹äºQHBoxLayoutæ°´å¹³å¸ƒå±€ï¼Œ QVBoxLayoutæ˜¯å‚ç›´å¸ƒå±€ï¼Œé€‚ç”¨äºåœ¨ä¸€ä¸ªå‚ç›´åˆ—ä¸Šå¯¹æ§ä»¶è¿›è¡Œæ’åˆ—ã€‚ä¸‹é¢æ¼”ç¤ºå¦‚ä½•åˆ›å»ºå¹¶å®ç°QVBoxLayoutï¼š\n12345QVBoxLayout* layout = new QVBoxLayout;layout -&gt;addWidget(w1);layout -&gt;addWidget(w2);...setLayout(layout);\n\nä¸QHBoxLayoutç›¸ä¼¼ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªQVBoxLayoutå¯¹è±¡ï¼Œå¹¶å°†æ§ä»¶æ·»åŠ åˆ°å†…éƒ¨ï¼Œç„¶åå°†è¯¥å¸ƒå±€è®¾ç½®ç»™å½“å‰çš„çª—å£æˆ–çª—ä½“ã€‚\nQGridLayoutå¸ƒå±€QGridLayoutæ˜¯å°†æ§ä»¶æ”¾ç½®åœ¨äºŒç»´ç½‘æ ¼ä¸­å¸ƒå±€çš„ä¸€ç§æ–¹å¼ã€‚ä»¥ä¸‹ä»£ç å°†å¸®åŠ©ä½ åˆ›å»ºå¹¶å®ç°QGridLayoutå¸ƒå±€ï¼š\n12345QGridLayout* layout= new QGridLayout;layout-&gt;addWidget(w1,0,0);     //è¿™é‡Œ 0 è¡¨ç¤ºè¡Œ 0 ï¼Œ 0 è¡¨ç¤ºåˆ— 0 layout-&gt;addWidget(w2,0,1);layout-&gt;addWidget(w3,1,0,1,2); //è¿™é‡Œ 1 è¡¨ç¤ºè¡Œ 1 ï¼Œ 0 è¡¨ç¤ºåˆ— 0ï¼Œ 1 è¡Œ 2 åˆ—setLayout(layout);\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªQGridLayoutå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨addWidget()å‡½æ•°å°†æ§ä»¶w1ã€w2ç­‰æ·»åŠ åˆ°å†…éƒ¨ï¼Œä½¿ç”¨ï¼ˆx,yï¼‰ã€rowSpanå’ŒcolSpanå‚æ•°æŒ‡å®šéœ€è¦å æ®çš„å•å…ƒæ ¼ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š3è¡Œ2åˆ—å¸ƒå±€ï¼Œw3 å æ®å…¶ä¸­2åˆ—ï¼Œèµ·å§‹ç‚¹ä¸ºç¬¬2è¡Œç¬¬0åˆ—ï¼ˆæ³¨æ„ï¼šåæ ‡ä»0å¼€å§‹ï¼‰ã€‚\nQFormLayoutå¸ƒå±€QFormLayoutæ—¨åœ¨ç”¨äºç®€å•çš„è¡¨å•å¸ƒå±€ï¼Œç‰¹åˆ«æ˜¯æ ‡ç­¾&#x2F;è¾“å…¥ç»„åˆã€‚ä»¥ä¸‹ä»£ç å°†å¸®åŠ©ä½ åˆ›å»ºå¹¶å®ç°QFormLayoutå¸ƒå±€ï¼š\n12345QFormLayout* layout= new QFormLayout;layout-&gt;addRow(&quot;æ ‡ç­¾ 1&quot;, w1);layout-&gt;addRow(&quot;æ ‡ç­¾ 2&quot;, w2);...setLayout(layout);\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨addRow()å‡½æ•°å°†æ§ä»¶w1ã€w2ç­‰æ·»åŠ åˆ°å†…éƒ¨ï¼Œå¹¶æ·»åŠ ç›¸åº”çš„æ ‡ç­¾ã€‚\næ€»ç»“åœ¨Qtä¸­æœ‰å¾ˆå¤šç§å¸ƒå±€æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©é€‚ç”¨äºç‰¹å®šéœ€æ±‚çš„å¸ƒå±€æ–¹å¼ã€‚å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ä»‹ç»äº†å‡ ç§ä¸»è¦çš„å¸ƒå±€ç®¡ç†å™¨ï¼ŒQtè¿˜æœ‰å…¶ä»–å¸ƒå±€å¯ä¾›é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šQStackedlayoutã€QSplitterç­‰ï¼›åœ¨ä½¿ç”¨æ—¶éœ€è¦æŒ‰ç…§å®é™…åœºæ™¯è¿›è¡Œé€‰æ‹©ã€‚å¸ƒå±€ç®¡ç†å™¨çš„ä½œç”¨æ˜¯è‡ªåŠ¨è°ƒæ•´å’Œç®¡ç†æ§ä»¶ä½ç½®å’Œå¤§å°ï¼Œå¹¶ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨é€‚åº”ä¸åŒåˆ†è¾¨ç‡å’Œçª—å£å°ºå¯¸çš„å˜åŒ–ï¼Œä»è€Œä½¿å¾—GUIç¼–ç¨‹æ›´åŠ æ–¹ä¾¿ç®€å•ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä½¿ç”¨å¸ƒå±€","date":"2021-10-03T02:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"340d1df588bee8247e70f61a451b98ba","title":"Qté«˜çº§ç»˜å›¾","content":"Qté«˜çº§ç»˜å›¾åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šä»‹ç»Qtä¸­çš„é«˜çº§ç»˜åˆ¶æŠ€æœ¯ï¼Œå¹¶äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥å®ç°è‡ªå®šä¹‰çš„ç»˜åˆ¶å’Œæ¸²æŸ“ã€‚Qtæä¾›äº†ä¸€äº›ä¸“ä¸šçº§åˆ«çš„APIæ¥è¿›è¡Œç»˜å›¾æ“ä½œï¼Œå¯ä»¥åˆ›å»ºçŸ¢é‡å›¾å½¢æˆ–è€…åƒç´ é¢œè‰²ï¼ˆbitmapï¼‰å›¾å½¢ã€‚\nQPainterç»˜å›¾æ¡†æ¶Qtä¸­æœ€å¸¸ç”¨çš„ç»˜åˆ¶APIæ˜¯QPainterç±»ã€‚å®ƒå¯ä»¥ç”¨äºå°†å‡ ä½•å½¢çŠ¶ã€å›¾åƒå’Œæ–‡æœ¬ç­‰å†…å®¹ç»˜åˆ¶åˆ°çª—å£æˆ–Widgeä¸Šã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨QPainteråœ¨QWidgetä¸Šç»˜åˆ¶ä¸€æ¡ç›´çº¿ï¼š\n1234void CustomWidget::paintEvent(QPaintEvent* event) &#123;    QPainter painter(this);    painter.drawLine(0, 0, width(), height());&#125;\né¦–å…ˆï¼Œæˆ‘ä»¬é‡è½½QWidgetçš„paintEvent()å‡½æ•°ï¼Œåœ¨å…¶å‚æ•°eventä¸­æ´¾ç”Ÿä¸€ä¸ªQPainterå¯¹è±¡ï¼Œç„¶åä½¿ç”¨drawLine()å‡½æ•°åœ¨CustomWidgetå§”æ‰˜çš„çª—å£ä¸Šç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚\næ‰‹åŠ¨ç»˜ç”»ï¼šç»˜åˆ¶åŸºæœ¬å›¾å…ƒé€šè¿‡æ‰‹åŠ¨ç»˜åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„å›¾å½¢ç•Œé¢ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨ä»¥ä¸‹çš„åŸºæœ¬å›¾å½¢å…ƒç´ ï¼šçº¿æ¡ã€å¤šè¾¹å½¢ã€æ¤­åœ†ã€å¼§å½¢å’Œæ–‡å­—ç­‰ã€‚\nä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç»˜åˆ¶åœ†å½¢å’ŒçŸ©å½¢çš„ä¾‹å­ï¼š\n123456void CustomWidget::paintEvent(QPaintEvent* event) &#123;    QPainter painter(this);    painter.setBrush(QBrush(Qt::black));    painter.drawEllipse(QRectF(20, 20, 50, 50));    painter.drawRect(QRectF(80, 20, 50, 50));&#125;\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é‡è½½QWidgetçš„paintEvent()å‡½æ•°ï¼Œå¹¶ä½¿ç”¨QPainterç±»åœ¨CustomWidgetå§”æ‰˜çš„çª—å£ä¸Šç»˜åˆ¶äº†ä¸€ä¸ªåœ†å’ŒçŸ©å½¢ã€‚æ³¨æ„ï¼šç”±äºQtè®¡ç®—å°ºå¯¸æ˜¯é‡‡ç”¨æµ®ç‚¹ç±»å‹çš„çŸ©å½¢æ ‡å‡†ï¼Œæˆ‘ä»¬ä½¿ç”¨QRectFæ¥å®šä¹‰çŸ©å½¢ã€‚\né«˜çº§ç»˜å›¾ï¼šOpenGLé™¤äº†Qtè‡ªå¸¦çš„ç»˜å›¾APIï¼ŒQtè¿˜æ”¯æŒOpenGLï¼Œé€šå¸¸å¯ç”¨äºé«˜æ€§èƒ½ã€å¤šæ¬¡è¿åŠ¨çš„ç¯å¢ƒä¸­ï¼Œå¦‚æ¸¸æˆæˆ–æ•°æ®ç§‘å­¦ç­‰ã€‚\nä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨QWidgetä¸Šç»˜åˆ¶ä¸‰è§’å½¢ï¼ˆå½“OpenGLå¼€å¯æ—¶ï¼‰ï¼š\n123456789101112131415void CustomWidget::paintEvent(QPaintEvent* event) &#123;#ifdef QT_OPENGL_SUPPORT    QOpenGLWidget* widget = new QOpenGLWidget(this);    widget -&gt;makeCurrent();    glBegin(GL_TRIANGLES);    glVertex2f(-1.0f,-0.5f);    glVertex2f( 1.0f,-0.5f);    glVertex2f( 0.0f, 0.5f);    glEnd();    glFlush();  #else    QPainter painter(this);    // ä½¿ç”¨QPainter API ç»˜åˆ¶å…¶ä»–å†…å®¹#endif&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªQOpenGLWidgetå¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„makeCurrent()æ–¹æ³•è·å–OpenGLæ¸²æŸ“ç¯å¢ƒã€‚\næ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨OpenGL APIç»˜åˆ¶ä¸‰è§’å½¢ï¼Œå¹¶è°ƒç”¨glFlush()å‡½æ•°åˆ·æ–°ç¼“å†²åŒºæ¥å‘ˆç°å›¾åƒã€‚\nåœ¨ä¸æ”¯æŒOpenGLçš„æƒ…å†µä¸‹ï¼ˆå¦‚è¿è¡Œåœ¨ä½ç«¯ç¡¬ä»¶æˆ–åµŒå…¥å¼è®¾å¤‡ä¸Šï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QPainter APIæ›¿ä»£OpenGLçš„åŠŸèƒ½ï¼Œæˆ–è€…æä¾›æœ¬åœ°CPUçš„è½¯ä»¶æ¸²æŸ“æ–¹å¼ã€‚\næ€»ç»“Qtæä¾›äº†å¤šç§é«˜çº§ç»˜åˆ¶æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ç²¾ç¾çš„UIç•Œé¢å’Œé«˜æ€§èƒ½çš„æ•°æ®å¯è§†åŒ–ã€‚é€šè¿‡æ‰‹åŠ¨ç»˜å›¾å’ŒOpenGLï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ å‡ºä»¤äººæƒŠå¹çš„è‰ºæœ¯ä½œå“å’Œå¤æ‚çš„3Dåœºæ™¯å±•ç¤ºã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qté«˜çº§ç»˜å›¾","date":"2021-10-03T02:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"b7a3f67da58560c80fad50efc08e725d","title":"Qtä½¿ç”¨QSSè®¾ç½®æ§ä»¶æ ·å¼","content":"Qtä½¿ç”¨QSSè®¾ç½®æ§ä»¶æ ·å¼åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨QSSï¼ˆQtæ ·å¼è¡¨ï¼‰æ¥è‡ªå®šä¹‰QPushButtonã€QLabelã€QLineEditå’ŒQComboBoxæ§ä»¶çš„æ ·å¼ã€‚åœ¨Qtä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QSSæ¥å®šåˆ¶æ§ä»¶çš„å¤–è§‚ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ–¹ä¾¿åœ°æ•´åˆåˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ã€‚\nè®¾ç½®QPushButtonçš„æ ·å¼æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¾ç½®QPushButtonçš„æ ·å¼ï¼š\n123456789101112131415QPushButton &#123;    background-color: qlineargradient(x1:0, y1:0, x2:1, y2:1, stop:0 #3b78e6, stop:1 #0f5fd7);    border-radius: 5px;    color: white;    font-weight: bold;    padding: 5px 15px;&#125;QPushButton:hover &#123;    background-color: qlineargradient(x1:0, y1:0, x2:1, y2:1, stop:0 #60a3f7, stop:1 #3b78e6);&#125;QPushButton:pressed &#123;    background-color: qlineargradient(x1:0, y1:0, x2:1, y2:1, stop:0 #0f5fd7, stop:1 #3b78e6);&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†QPushButtonæ§ä»¶çš„èƒŒæ™¯è®¾ç½®ä¸ºé¢œè‰²æ¸å˜ï¼Œä½¿ç”¨äº†border-radiuså±æ€§æ·»åŠ åœ†è§’è¾¹æ¡†ã€‚æˆ‘ä»¬è¿˜æ”¹å˜äº†å­—ä½“åŠ ç²—ç¨‹åº¦å’Œé¢œè‰²ï¼Œå¹¶ä¸”ä¸ºæŒ‰é’®è®¾ç½®äº†paddingå±æ€§ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜åœ¨:hoverå’Œ:pressedçŠ¶æ€ä¸‹åˆ†åˆ«ä¿®æ”¹æŒ‰é’®çš„æ¸å˜èƒŒæ™¯è‰²ã€‚\nè®¾ç½®QLabelçš„æ ·å¼ä¸QPushButtonçš„è®¾ç½®æ–¹å¼ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥è®¾ç½®QLabelçš„æ ·å¼ï¼š\n123456QLabel &#123;    background-color: #d8e5f4;    border: 1px solid #c7d9ea;    color: #333333;    padding: 2px;&#125;\n\nå¯¹äºQLabelæ§ä»¶ï¼Œæˆ‘ä»¬å°†å…¶èƒŒæ™¯è®¾ç½®ä¸ºå›ºå®šçš„é¢œè‰²ï¼Œåœ¨è¾¹ç•Œä¸­æ·»åŠ äº†ç»†çš„ç°è‰²è¾¹æ¡†ï¼Œå¹¶ä¸ºæ–‡æœ¬è®¾ç½®äº†é€‚å½“çš„å†…è¾¹è·ã€‚\nè®¾ç½®QLineEditçš„æ ·å¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥è®¾ç½®QLineEditçš„æ ·å¼ï¼š\n1234567891011QLineEdit &#123;    background-color: #ffffff;    border: 1px solid #c7d9ea;    color: #444444;    padding: 2px;&#125;QLineEdit:focus &#123;    border: 1px solid #3b79e6;    outline: none;&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†QLineEditæ§ä»¶çš„èƒŒæ™¯è‰²å’Œè¾¹æ¡†é¢œè‰²ï¼Œä½¿å…¶çœ‹èµ·æ¥æ›´åŠ å¹²å‡€ã€‚å¯¹äºç„¦ç‚¹æƒ…å†µï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªä»¥è“è‰²çªå‡ºè¡¨ç¤ºçš„è¾¹æ¡†çº¿ï¼Œå¹¶ç¦ç”¨äº†é»˜è®¤çš„å¤–è§‚å­—ä½“æ ·å¼åº”ç”¨ã€‚\nè®¾ç½®QComboBoxçš„æ ·å¼æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥è®¾ç½®QComboBoxçš„æ ·å¼ï¼š\n12345678910111213141516QComboBox &#123;    background-color: #ffffff;    border: 1px solid #c7d9ea;    color: #444444;    padding: 2px;    &#125;QComboBox:editable &#123;    background-color: #ffffff;&#125;QComboBox QAbstractItemView &#123;    border: 1px solid #c7d9ea;    selection-background-color: #3b78e6;    selection-color: white;&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†QComboBoxæ§ä»¶çš„èƒŒæ™¯è‰²å’Œè¾¹æ¡†é¢œè‰²ï¼Œä»¥åŠå®ƒçš„æ–‡æœ¬é¢œè‰²å¹¶æ·»åŠ äº†é€‚å½“çš„å†…è¾¹è·ã€‚å¯¹äºå¯ç¼–è¾‘çš„QComboBoxï¼Œæˆ‘ä»¬è¿˜å•ç‹¬ä¸ºå…¶è®¾ç½®äº†èƒŒæ™¯è‰²ã€‚æœ€åï¼Œæˆ‘ä»¬ä¿®æ”¹QComboBoxä¸­é¡¹ç›®è§†å›¾çš„è¾¹æ¡†çº¿ï¼Œå¹¶ä¸ºé€‰ä¸­çš„é¡¹æä¾›äº†æ›´æ˜æ˜¾çš„æ–‡æœ¬å’Œæ¸å˜èƒŒæ™¯é¢œè‰²ã€‚\nåœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨QSSæ¥è‡ªå®šä¹‰QPushButtonã€QLabelã€QLineEditå’ŒQComboBoxæ§ä»¶çš„å¤–è§‚æ ·å¼ã€‚Qtæä¾›äº†å¾ˆå¤šçš„å±æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ”¹å˜æ§ä»¶çš„å¤–è§‚ï¼Œå¹¶ä¸”ä½¿å¾—æˆ‘ä»¬å¯ä»¥åˆ›å»ºå…·æœ‰è‡ªå®šä¹‰å¤–è§‚çš„åº”ç”¨ç¨‹åºã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtä½¿ç”¨QSSè®¾ç½®æ§ä»¶æ ·å¼","date":"2021-10-02T02:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"1175242b1cb2123c73e3f30548ab2dd7","title":"Qtç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿ","content":"Qtç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿä»€ä¹ˆæ˜¯Qtï¼ŸQtæ˜¯ä¸€æ¬¾è·¨å¹³å°çš„C++åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·å’Œåº“ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ„å»ºé«˜è´¨é‡çš„åº”ç”¨ç¨‹åºã€‚Qtæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œå¼€å‘è¯­è¨€ï¼ŒåŒ…æ‹¬Windowsã€Linuxã€macOSã€Androidã€iOSç­‰ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒC++ã€Pythonã€JavaScriptç­‰å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚\næŒ‡é’ˆæ—¶é’Ÿçš„ä½œç”¨å’Œæ•ˆæœæŒ‡é’ˆæ—¶é’Ÿæ˜¯ä¸€ç§å¸¸è§çš„æ—¶é’Ÿæ˜¾ç¤ºæ–¹å¼ï¼Œå®ƒé€šè¿‡æŒ‡é’ˆçš„æ—‹è½¬æ¥æ˜¾ç¤ºæ—¶é—´ï¼Œå…·æœ‰ç®€æ´ã€ç›´è§‚ã€ç¾è§‚ç­‰ç‰¹ç‚¹ã€‚åœ¨Qtä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨QPainterç±»æ¥ç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡QTimerç±»æ¥å®ç°æ—¶é’Ÿçš„æ›´æ–°ã€‚\nç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿçš„ä»£ç ç¤ºä¾‹ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªæŒ‡é’ˆæ—¶é’Ÿï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#include &lt;QtWidgets&gt;class ClockWidget : public QWidget&#123;public:    ClockWidget(QWidget *parent = nullptr) : QWidget(parent)    &#123;        setFixedSize(200, 200);        QTimer *timer = new QTimer(this);        connect(timer, &amp;QTimer::timeout, this, QOverload&lt;&gt;::of(&amp;ClockWidget::update));        timer-&gt;start(1000);    &#125;protected:    void paintEvent(QPaintEvent *event) override    &#123;        Q_UNUSED(event);        QPainter painter(this);        painter.setRenderHint(QPainter::Antialiasing);        painter.translate(width() / 2, height() / 2);        painter.scale(width() / 200.0, height() / 200.0);        // ç»˜åˆ¶è¡¨ç›˜        painter.setPen(Qt::NoPen);        painter.setBrush(Qt::white);        painter.drawEllipse(-90, -90, 180, 180);        // ç»˜åˆ¶åˆ»åº¦        painter.setPen(QPen(Qt::black, 2));        for (int i = 0; i &lt; 12; ++i) &#123;            painter.drawLine(0, -80, 0, -70);            painter.rotate(30);        &#125;        // ç»˜åˆ¶æ—¶é’ˆ        painter.save();        painter.rotate(30 * QTime::currentTime().hour() + QTime::currentTime().minute() / 2.0);        painter.setPen(QPen(Qt::black, 4));        painter.drawLine(0, 0, 0, -40);        painter.restore();        // ç»˜åˆ¶åˆ†é’ˆ        painter.save();        painter.rotate(6 * QTime::currentTime().minute() + QTime::currentTime().second() / 10.0);        painter.setPen(QPen(Qt::black, 3));        painter.drawLine(0, 0, 0, -60);        painter.restore();        // ç»˜åˆ¶ç§’é’ˆ        painter.save();        painter.rotate(6 * QTime::currentTime().second());        painter.setPen(QPen(Qt::red, 2));        painter.drawLine(0, 0, 0, -70);        painter.restore();    &#125;&#125;;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    ClockWidget clock;    clock.show();    return app.exec();&#125;\n\nåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªClockWidgetç±»ï¼Œç»§æ‰¿è‡ªQWidgetç±»ï¼Œå¹¶é‡å†™äº†å®ƒçš„paintEventå‡½æ•°ã€‚åœ¨paintEventå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨QPainterç±»æ¥ç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿï¼ŒåŒ…æ‹¬è¡¨ç›˜ã€åˆ»åº¦ã€æ—¶é’ˆã€åˆ†é’ˆå’Œç§’é’ˆç­‰ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨QTimerç±»æ¥å®ç°æ—¶é’Ÿçš„æ›´æ–°ï¼Œæ¯éš”ä¸€ç§’é’Ÿå°±è°ƒç”¨ä¸€æ¬¡updateå‡½æ•°ï¼Œé‡æ–°ç»˜åˆ¶æ—¶é’Ÿã€‚\né€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Qtç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿçš„è¿‡ç¨‹éå¸¸ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨QPainterç±»å’ŒQTimerç±»å³å¯å®ç°ã€‚å¦‚æœæ‚¨æƒ³è¦è¿›ä¸€æ­¥äº†è§£Qtçš„ç»˜å›¾å’Œå®šæ—¶å™¨åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒQtå®˜æ–¹æ–‡æ¡£æˆ–è€…ç›¸å…³ä¹¦ç±ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtç»˜åˆ¶æŒ‡é’ˆæ—¶é’Ÿ","date":"2021-09-29T04:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"2106cd6b75d5bd1805d109460f8c2725","title":"Qtå®ç°ç¬”è®°æœ¬è½¯ä»¶","content":"EasyNoteğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°ç¬”è®°æœ¬è½¯ä»¶ã€‚\n\næ”¯æŒå¯Œæ–‡æœ¬ç¬”è®°\næ”¯æŒæœ€è¿‘æ–‡æ¡£ï¼Œæ”¶è—å¤¹ï¼Œå›æ”¶ç«™ï¼Œæ–‡ä»¶åˆ†ç±»ç­‰\næ”¯æŒå…¨å±€ç¬”è®°æœç´¢ï¼Œåˆ é™¤ï¼Œæ”¶è—ç¬”è®°\næ”¯æŒå›æ”¶ç«™è¿˜åŸç¬”è®°\næ”¯æŒè®¾ç½®å¯åŠ¨å¯†ç \næ”¯æŒåˆ‡æ¢ä¸»é¢˜\næ”¯æŒå›¾æ¡ˆå¯†ç ç™»å½•\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šmsvcç¼–è¯‘å™¨éƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nsqlite\nå­˜å‚¨æ•°æ®åº“\n\n\nğŸ—ºï¸è½¯ä»¶å±•ç¤º \n\né¦–æ¬¡ä½¿ç”¨\næ”¶è—å¤¹\næ”¶è—\nå­åˆ†ç±»\næœ€è¿‘æ–‡æ¡£\nåˆ é™¤æ–‡æ¡£\nå…¨å±€æœç´¢\nå›æ”¶ç«™\nè¿˜åŸ\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°ç¬”è®°æœ¬è½¯ä»¶","date":"2021-09-28T08:34:06.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"6b2f41d280a5ed65f0a5d3dda2e46f20","title":"Qtåˆ›å»ºä¸€ä¸ªåŠ¨ç”»æŒ‰é’®","content":"Qtåˆ›å»ºä¸€ä¸ªåŠ¨ç”»æŒ‰é’®åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ å¦‚ä½•é€šè¿‡ä½¿ç”¨Qtæ¥åˆ›å»ºä¸€ä¸ªåŠ¨ç”»æŒ‰é’®ã€‚æˆ‘ä»¬å°†ä¼šä½¿ç”¨QPropertyAnimationç±»ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çš„ä»»ä½•å±æ€§çš„åŠ¨ç”»ã€‚\nç¬¬1æ­¥ - åˆ›å»ºæŒ‰é’®é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªQPushButtonå¯¹è±¡æ¥è¡¨ç¤ºæˆ‘ä»¬çš„åŠ¨ç”»æŒ‰é’®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š\n1QPushButton *button = new QPushButton(&quot;Click me&quot;, parent);\n\nè¿™å°†ä¼šåˆ›å»ºä¸€ä¸ªå¸¦æœ‰â€œClick meâ€æ–‡æœ¬çš„QPushButtonå¯¹è±¡ï¼Œå¹¶ä¸”å°†å…¶æ·»åŠ åˆ°æŒ‡å®šçš„çˆ¶QWidgetå¯¹è±¡ä¸­ã€‚\nç¬¬2æ­¥ - ä¸ºæŒ‰é’®è®¾ç½®åŠ¨ç”»å±æ€§æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæŒ‰é’®è®¾ç½®å±æ€§ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ¨ç”»æ¥æ”¹å˜å®ƒä»¬ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šä¸ºæŒ‰é’®çš„å¤§å°å’Œé¢œè‰²å±æ€§è®¾ç½®åŠ¨ç”»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š\n123456QPropertyAnimation *animation = new QPropertyAnimation(button, &quot;geometry&quot;);animation-&gt;setDuration(1000);animation-&gt;setStartValue(QRect(0, 0, 100, 30));animation-&gt;setEndValue(QRect(250, 250, 200, 60));animation-&gt;setEasingCurve(QEasingCurve::InOutQuad);animation-&gt;start();\n\nè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªQPropertyAnimationå¯¹è±¡ï¼Œç„¶åå°†å…¶è¿æ¥åˆ°æŒ‰é’®ä¸Šï¼Œå¹¶å°†å…¶å±æ€§è®¾ç½®ä¸ºå‡ ä½•å½¢çŠ¶ã€‚æˆ‘ä»¬è¿˜å°†åŠ¨ç”»æ—¶é•¿è®¾ç½®ä¸º1000æ¯«ç§’ï¼Œèµ·å§‹å’Œç»ˆæ­¢å€¼è®¾ç½®ä¸ºæŒ‰é’®çš„åˆå§‹å’Œæœ€ç»ˆä½ç½®ï¼ˆè¿™é‡Œçš„å€¼æ˜¯çŸ©å½¢åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å…¶å¤§å°å’Œä½ç½®ï¼‰ï¼Œå¹¶ä¸”åŠ¨ç”»æ›²çº¿è®¾ç½®ä¸ºQEasingCurve::InOutQuadï¼Œä»¥ä½¿åŠ¨ç”»å…·æœ‰å¹³æ»‘çš„æ•ˆæœã€‚æœ€åæˆ‘ä»¬è°ƒç”¨start()å‡½æ•°å¼€å§‹åŠ¨ç”»ã€‚\nç¬¬3æ­¥ - è¿è¡Œç¨‹åºç°åœ¨æˆ‘ä»¬å¯ä»¥è¿è¡Œç¨‹åºï¼Œå¹¶ç‚¹å‡»æŒ‰é’®è§‚çœ‹å®ƒçš„åŠ¨ç”»æ•ˆæœå•¦ï¼å®Œæ•´çš„Qtç¨‹åºä»£ç åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š\n123456789101112131415161718192021222324#include &lt;QPushButton&gt;#include &lt;QPropertyAnimation&gt;#include &lt;QEasingCurve&gt;int main(int argc, char *argv[])&#123;    QApplication app(argc, argv);    QWidget *parent = new QWidget;    parent-&gt;setFixedSize(500, 500);    QPushButton *button = new QPushButton(&quot;Click me&quot;, parent);    button-&gt;setGeometry(0, 0, 100, 30);    QPropertyAnimation *animation = new QPropertyAnimation(button, &quot;geometry&quot;);    animation-&gt;setDuration(1000);    animation-&gt;setStartValue(QRect(0, 0, 100, 30));    animation-&gt;setEndValue(QRect(250, 250, 200, 60));    animation-&gt;setEasingCurve(QEasingCurve::InOutQuad);    animation-&gt;start();    parent-&gt;show();    return app.exec();&#125;\n\næ­å–œä½ ï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•é€šè¿‡Qtåˆ›å»ºä¸€ä¸ªåŠ¨ç”»æŒ‰é’®ï¼\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtåˆ›å»ºä¸€ä¸ªåŠ¨ç”»æŒ‰é’®","date":"2021-09-28T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e42b28a1e2572b90e90363072c82df61","title":"Qtå®ç°ç²¾ç¾æ—¶é’Ÿ","content":"PerfectClockğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°ä¸€æ¬¾æ‹Ÿç‰©æ—¶é’Ÿï¼Œå…¨éƒ¨ä¸ºè‡ªç»˜æ—¶é’Ÿï¼Œä¸»è¦ä½¿ç”¨å®šæ—¶å™¨ï¼Œç­‰æ¯”ä¾‹ç»˜å›¾ï¼Œç»˜åˆ¶è§’åº¦ï¼ŒåŠé’Ÿæ‘†åŠ¨ç”»ç­‰ã€‚ç§’é’ˆæ‘†åŠ¨æœ‰è½»å¾®åŠ¨ç”»æ•ˆæœï¼Œæ›´åŠ æ¥è¿‘æ‹Ÿç‰©é£æ ¼ã€‚\n\nå³é”®å•å‡»åˆ‡æ¢é£æ ¼\né¼ æ ‡æ»šè½®å¯ä»¥æ”¾å¤§ï¼Œç¼©å°çª—å£ã€‚\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šéƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQPainter\nçª—å£çš„ç»˜åˆ¶\n\n\nQPropertyAnimation\né’Ÿæ‘†åŠ¨ç”»\n\n\nQFont\næ—¶é—´å­—ä½“\n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾ä¸»ç•Œé¢\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°ç²¾ç¾æ—¶é’Ÿ","date":"2021-08-23T01:51:30.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"cb9e2c8abcfd3f6ecae0c80283194d87","title":"Qtå®ç°æ°´æ³¢è¿›åº¦æ¡","content":"LiquidPlotğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°æ°´æ³¢è¿›åº¦æ¡ã€‚\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šéƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQPainter\nçª—å£çš„ç»˜åˆ¶\n\n\nQFont\næ—¶é—´å­—ä½“\n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾ä¸»ç•Œé¢\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°æ°´æ³¢è¿›åº¦æ¡","date":"2021-08-23T01:49:30.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5501e08753ab993d068135c954746e49","title":"Qtæ¨¡ä»¿360æ¡Œé¢åŠ é€Ÿçƒ","content":"360FloatBallğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtæ¨¡ä»¿360æ¡Œé¢æ‚¬æµ®çª—ã€‚\n\nåŒå‡»æ¨¡æ‹Ÿæ¸…ç†\nå³ä¾§è‡ªåŠ¨å¸é™„\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šéƒ½æ”¯æŒ\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾ä¸»ç•Œé¢\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtæ¨¡ä»¿360æ¡Œé¢åŠ é€Ÿçƒ","date":"2021-08-23T01:46:49.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"2b714a0f88b5cb1551afa311876b2c36","title":"Qtå®ç°éŸ³ä¹æ’­æ”¾å™¨","content":"MusicPlayerğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°ä¸€æ¬¾å°è€Œç¾çš„éŸ³ä¹æ’­æ”¾å™¨ã€‚\nğŸ’¾ä½“éªŒç¨‹åº\nå®‰è£…åŒ…åœ°å€\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šmsvcç¼–è¯‘å™¨éƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\nQPainter\néƒ¨åˆ†çª—å£çš„ç»˜åˆ¶ï¼Œä¾‹å¦‚å®æ—¶å¤©æ°”ç•Œé¢\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾ä¸»ç•Œé¢\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°éŸ³ä¹æ’­æ”¾å™¨","date":"2021-08-23T01:44:01.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"49aefe99718bccc223ed635b4c3f5313","title":"Qtå®ç°æ±½è½¦å¯¼èˆªä»ªç•Œé¢","content":"CarCompassğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°æ±½è½¦å¯¼èˆªä»ªç•Œé¢ï¼Œç›®å‰è¿˜ä¸å¤ªå®Œå–„ï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚ã€‚ã€‚\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64) \nç†è®ºä¸ŠQt 5.6ä»¥ä¸Šmsvcç¼–è¯‘å™¨éƒ½æ”¯æŒ\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\nQPainter\néƒ¨åˆ†çª—å£çš„ç»˜åˆ¶ï¼Œä¾‹å¦‚å®æ—¶å¤©æ°”ç•Œé¢\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾å¼€æœºåŠ¨ç”»\nè¯­éŸ³è¾“å…¥\nä¸‹æ‹‰èœå•\nç”µè¯\néŸ³ä¹\nç³»ç»Ÿè®¾ç½®\nå±å¹•ä¿æŠ¤\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtå®ç°æ±½è½¦å¯¼èˆªä»ªç•Œé¢","date":"2021-08-20T07:48:18.000Z","categories_index":"Qtä½œå“é›†","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"1054abf09256abccd528b56b6b5c666f","title":"Qtæ¨¡ä»¿ä¼ä¸šå¾®ä¿¡ç•Œé¢","content":"WeCom_copyğŸ“šç®€ä»‹æœ¬é¡¹ç›®ä¸ºQtå®ç°ä¼ä¸šå¾®ä¿¡ç•Œé¢é¡¹ç›®ï¼Œçº¯ç•Œé¢é€»è¾‘ï¼Œä¸åŒ…å«çœŸå®ä¸šåŠ¡é€»è¾‘ã€‚ä¸»è¦ç”¨äºå­¦ä¹ QWidgetçš„ä½¿ç”¨ï¼ŒåŒ…å«ç»˜åˆ¶ï¼Œå¸ƒå±€ï¼Œä¿¡å·ï¼Œäº‹ä»¶ï¼Œé‡å†™ï¼Œå¤šçº¿ç¨‹ï¼Œqssç­‰æŠ€æœ¯ä½¿ç”¨ã€‚\n\nğŸ’¾ä½“éªŒç¨‹åº\nå®‰è£…åŒ…åœ°å€\n\nğŸ“¦è½¯ä»¶æ¶æ„\nQt 5.9 + msvc 2015\nWindows(x32, x64)&#x2F;Linux(x32, x64)\n\nğŸ› ï¸ä¸»è¦æŠ€æœ¯\n\n\næ¨¡å—\nä»‹ç»\n\n\n\nqss\næ ·å¼è¡¨ï¼Œæœ¬ç¨‹åºæ‰€æœ‰çª—ä½“ã€æ§ä»¶çš„æ ·å¼éƒ½ç”±qssè®¾è®¡\n\n\nsignal\\slot\næ§ä»¶ã€çª—ä½“é—´é€šä¿¡ï¼Œäº‹ä»¶å¤„ç†\n\n\nQThread\nå¼‚æ­¥å¤„ç†\n\n\nQNetworkAccessManager\nç½‘ç»œè¯·æ±‚ï¼Œä¸»è¦ç”¨äºèŠå¤©æœºå™¨äººåŠå®æ—¶å¤©æ°”è·å–\n\n\nQPainter\néƒ¨åˆ†çª—å£çš„ç»˜åˆ¶ï¼Œä¾‹å¦‚å®æ—¶å¤©æ°”ç•Œé¢\n\n\niconfont\né˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ï¼Œä¸»è¦ç”¨äºæŒ‰é’®åŠæ ‡ç­¾ä¸Šå›¾æ ‡ç­‰æ˜¾ç¤º\n\n\nwebenginewidgets\nå®ç°åµŒå…¥htmlï¼Œä¸»è¦ç”¨äºèŠå¤©ç•Œé¢\n\n\nwebchannel\nå’Œjsè¿›è¡Œé€šä¿¡ï¼Œç”¨äºèŠå¤©ç•Œé¢äº¤äº’\n\n\nğŸ—ºï¸è½¯ä»¶æˆªå›¾å¯¼èˆª\nåŸºç¡€æ¡†æ¶\nç”¨æˆ·è¯¦æƒ…\nå¥½å‹åˆ—è¡¨\næ¨¡æ‹Ÿç™»å½•\nèŠå¤©å¯¹è¯æ¡†\nèŠå¤©ç•Œé¢\næ™ºèƒ½æœºå™¨äºº\nå¤©æ°”é¢„æŠ¥\nè‡ªç»˜æ—¶é’Ÿ\niconfontå›¾æ ‡å±•ç¤º\né€—é€—çŒ«ï¼ˆå°çŒ«çœ¼ç›éšç€é¼ æ ‡ä½ç½®è½¬åŠ¨ï¼‰\nç»„ä»¶é€šçŸ¥æé†’æ¡†\næ°”æ³¡ç¡®è®¤æ¡†\næ»‘åŠ¨è¾“å…¥æ¡\nåŠ¨æ€ä¸»é¡µ\nEChartsè¡¨æ ¼\nè½®æ’­å›¾\nèƒŒæ™¯éŸ³ä¹(åˆ«æ’¸ä»£ç äº†ï¼Œå¬å¬æ­Œå§)\nğŸ“å‚è€ƒç½‘å€ğŸ“—qtå®˜ç½‘ğŸ“˜QTCNå¼€å‘ç½‘ğŸ“™é£æ‰¬é’æ˜¥ğŸ“™EChartsğŸ“ŒCSDNğŸ‰æ¬¢è¿å…³æ³¨CSDNğŸ§¡Starå¦‚æœä½ è§‰å¾—é¡¹ç›®ç”¨æ¥å­¦ä¹ ä¸é”™ï¼Œå¯ä»¥ç»™é¡¹ç›®ç‚¹ç‚¹starï¼Œè°¢è°¢ã€‚","slug":"Qt/ä½œå“å±•/Qtæ¨¡ä»¿ä¼ä¸šå¾®ä¿¡ç•Œé¢","date":"2021-08-20T07:26:42.000Z","categories_index":"ä½œå“å±•ç¤º","tags_index":"Qt,C/C++","author_index":"é˜¿æœ¨å¤§å”"},{"id":"58073f8af9c920179ae6420234803ea8","title":"VUE3å­¦ä¹ æ–‡æ¡£","content":"vue3å­¦ä¹ æ–‡æ¡£â¡ï¸ åˆ›å»ºé¡¹ç›®å®‰è£…\nnpm install @vue&#x2F;cli -g\n\næ–°å»ºé¡¹ç›®\né€‰æ‹©vue3ï¼Œè‡ªåŠ¨è¿›è¡Œæ–°å»ºé¡¹ç›®\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&gt; vue create webui  Vue CLI v4.5.13? Please pick a preset:  Default ([Vue 2] babel, eslint)&gt; Default (Vue 3) ([Vue 3] babel, eslint)   Manually select features      Vue CLI v4.5.13? Please pick a preset: Default (Vue 3) ([Vue 3] babel, eslint)    Vue CLI v4.5.13âœ¨  Creating project in E:\\code\\workspace\\vue\\webui.ğŸ—ƒ  Initializing git repository...âš™ï¸  Installing CLI plugins. This might take a while...    &gt; yorkie@2.0.0 install E:\\code\\workspace\\vue\\webui\\node_modules\\yorkie&gt; node bin/install.js  setting up Git hooksdone  &gt; core-js@3.16.1 postinstall E:\\code\\workspace\\vue\\webui\\node_modules\\core-js&gt; node -e &quot;try&#123;require(&#x27;./postinstall&#x27;)&#125;catch(e)&#123;&#125;&quot;    &gt; ejs@2.7.4 postinstall E:\\code\\workspace\\vue\\webui\\node_modules\\ejs&gt; node ./postinstall.js  added 1258 packages from 656 contributors in 77.87s  81 packages are looking for funding  run `npm fund` for details  ğŸš€  Invoking generators...ğŸ“¦  Installing additional dependencies...  added 80 packages from 86 contributors in 11.181s  88 packages are looking for funding  run `npm fund` for details  âš“  Running completion hooks...  ğŸ“„  Generating README.md...  ğŸ‰  Successfully created project webui.ğŸ‘‰  Get started with the following commands:   $ cd webui $ npm run serve\n\né»˜è®¤ç›®å½•ç»“æ„\n123456webuiâ”œâ”€node_modules          // npm åŠ è½½çš„é¡¹ç›®ä¾èµ–æ¨¡å—â”œâ”€public                // å…¬å…±èµ„æºç›®å½•â””â”€src                   // æºç ç›®å½•    â”œâ”€assets            // èµ„æºç›®å½•    â””â”€components        // ç»„ä»¶ç›®å½•\n\npublic å’Œ assets ç›®å½•çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œpublicåœ¨æ‰“åŒ…åæ–‡ä»¶å†…å®¹ä¸ä¼šæœ‰ä»»ä½•æ”¹å˜(é™¤äº†index.htmlï¼Œindex.htmlä¼šè‡ªåŠ¨æ·»åŠ æ‰“åŒ…åéœ€è¦å¼•ç”¨çš„jsï¼Œcssç­‰)ï¼Œassetsæ‰“åŒ…åä¼šè¿›è¡Œå‹ç¼©ï¼Œæ”¹åç­‰ã€‚\n\n\n\nç›®å½•&#x2F;æ–‡ä»¶\nè¯´æ˜\n\n\n\nbuild\né¡¹ç›®æ„å»º(webpack)ç›¸å…³ä»£ç \n\n\nconfig\né…ç½®ç›®å½•ï¼ŒåŒ…æ‹¬ç«¯å£å·ç­‰ã€‚æˆ‘ä»¬åˆå­¦å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ã€‚\n\n\nnode_modules\nnpm åŠ è½½çš„é¡¹ç›®ä¾èµ–æ¨¡å—\n\n\nsrc\nè¿™é‡Œæ˜¯æˆ‘ä»¬è¦å¼€å‘çš„ç›®å½•ï¼ŒåŸºæœ¬ä¸Šè¦åšçš„äº‹æƒ…éƒ½åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚é‡Œé¢åŒ…å«äº†å‡ ä¸ªç›®å½•åŠæ–‡ä»¶ï¼š\n\n\nsrc&#x2F;assets\næ”¾ç½®ä¸€äº›å›¾ç‰‡ï¼Œå¦‚logoç­‰ã€‚\n\n\nsrc&#x2F;components\nç›®å½•é‡Œé¢æ”¾äº†ä¸€ä¸ªç»„ä»¶æ–‡ä»¶ï¼Œå¯ä»¥ä¸ç”¨ã€‚\n\n\nsrc&#x2F;App.vue\né¡¹ç›®å…¥å£æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å°†ç»„ä»¶å†™è¿™é‡Œï¼Œè€Œä¸ä½¿ç”¨ components ç›®å½•ã€‚\n\n\nsrc&#x2F;main.js\né¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ã€‚\n\n\nindex.html\né¦–é¡µå…¥å£æ–‡ä»¶ï¼Œä½ å¯ä»¥æ·»åŠ ä¸€äº› meta ä¿¡æ¯å•¥çš„ã€‚\n\n\npackage.json\né¡¹ç›®é…ç½®æ–‡ä»¶ã€‚\n\n\nè¿è¡Œé¡¹ç›®\ncd webuinpm run serve     &#x2F;&#x2F; å¯åŠ¨æœ¬åœ°æœåŠ¡\n\n12345678910DONE  Compiled successfully in 11104ms ä¸Šåˆ10:13:47  App running at: - Local:   http://localhost:8080/  - Network: unavailable  Note that the development build is not optimized. To create a production build, run npm run build. \næµè§ˆå™¨æ‰“å¼€å³å¯æµè§ˆç½‘é¡µã€‚\n\nä»£ç æµç¨‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119Error: mermaid CLI is required to be installed.Check https://github.com/mermaid-js/mermaid.cli for more information.Error: Command failed: npx mmdc --theme default --input C:\\Users\\hudejie\\AppData\\Local\\Temp\\mume-mermaid2021713-8352-15nb1ty.drifi.mmd --output E:\\code\\doc\\assets\\5110930a681e95ebf71f91187936d3440.pngnpm ERR! code E404npm ERR! 404 Not Found - GET https://registry.npmjs.com/mmdc - Not foundnpm ERR! 404 npm ERR! 404  &#x27;mmdc@latest&#x27; is not in the npm registry.npm ERR! 404 You should bug the author to publish it (or use the name yourself!)npm ERR! 404 npm ERR! 404 Note that you can also install from anpm ERR! 404 tarball, folder, http url, or git url.npm ERR! A complete log of this run can be found in:npm ERR!     C:\\Users\\hudejie\\AppData\\Roaming\\npm-cache\\_logs\\2021-08-13T05_40_51_671Z-debug.logInstall for [ &#x27;mmdc@latest&#x27; ] failed with code 1```    ---------------------------------------------  ##  â¡ï¸ æ–°å»ºé¡µé¢    ###  åˆ›å»ºæ–‡ä»¶  - åœ¨srcä¸‹åˆ›å»ºviewsç›®å½•- viewsä¸‹åˆ›å»ºlogin.vueæ–‡ä»¶  ```html&lt;template&gt;    &lt;div class=&quot;login&quot;&gt;        &lt;div id=&quot;loginDiv&quot;&gt;            &lt;form action=&quot;&quot; id=&quot;form&quot;&gt;                &lt;h1 style=&quot;text-align: center;color: aliceblue;&quot;&gt;LOGIN IN&lt;/h1&gt;                &lt;div&gt;username:&lt;input id=&quot;username&quot; type=&quot;text&quot;&gt;&lt;/div&gt;                &lt;div style=&quot;margin-top: 5px;&quot;&gt;password:&lt;input id=&quot;password&quot; type=&quot;password&quot;&gt;&lt;/div&gt;                  &lt;div style=&quot;text-align: center;margin-top: 30px;&quot;&gt;                    &lt;input type=&quot;submit&quot; class=&quot;button&quot; value=&quot;login up&quot;&gt;                    &lt;input type=&quot;reset&quot; class=&quot;button&quot; value=&quot;reset&quot;&gt;                &lt;/div&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/template&gt;  &lt;script&gt;    export default &#123;        name: &quot;&quot;,        setup() &#123;            return &#123;              &#125;        &#125;,    &#125;&lt;/script&gt;  &lt;style scoped&gt;    * &#123;        margin: 0;        padding: 0;    &#125;      .login &#123;        background-size: cover;        display: flex;        justify-content: center;        align-items: center;        height: 100%;        background-image: linear-gradient(to right, #EBDFDB, #EBE9D9);    &#125;      #loginDiv &#123;        width: 37%;        display: flex;        justify-content: center;        align-items: center;        height: 300px;        background-color: rgba(75, 81, 95, 0.3);        box-shadow: 7px 7px 17px rgba(52, 56, 66, 0.5);        border-radius: 5px;    &#125;      #name_trip &#123;        margin-left: 50px;        color: red;    &#125;      p &#123;        margin-top: 30px;        margin-left: 20px;        color: azure;    &#125;      input &#123;        margin-left: 15px;        border-radius: 5px;        border-style: hidden;        height: 30px;        width: 140px;        background-color: rgba(216, 191, 216, 0.5);        outline: none;        color: #f0edf3;        padding-left: 10px;    &#125;      .button &#123;        border-color: cornsilk;        background-color: rgba(100, 149, 237, .7);        color: aliceblue;        border-style: hidden;        border-radius: 5px;        width: 100px;        height: 31px;        font-size: 16px;    &#125;&lt;/style&gt;\næ˜¾ç¤ºé¡µé¢\nå°†HelloWorldæ›¿æ¢ä¸ºLoginç•Œé¢1234567891011121314151617181920212223242526272829303132333435363738&lt;template&gt;  &lt;Login/&gt;&lt;/template&gt;  &lt;script&gt;//import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;import Login from &#x27;./views/login.vue&#x27;  export default &#123;  name: &#x27;App&#x27;,  components: &#123;    Login  &#125;&#125;&lt;/script&gt;  &lt;style&gt;  html,  body &#123;    width: 100%;    height: 100%;    padding: 0;    margin: 0;    overflow: hidden;    font-family: Avenir, Helvetica, Arial, sans-serif;  &#125;    #app &#123;    width: 100%;    height: 100%;    font-family: Avenir, Helvetica, Arial, sans-serif;    -webkit-font-smoothing: antialiased;    -moz-osx-font-smoothing: grayscale;    text-align: center;    color: #2c3e50;  &#125;&lt;/style&gt;  \n\næ˜¾ç¤ºæ•ˆæœ\n  â¡ï¸ vue-routerä½¿ç”¨ç®€ä»‹\n\nåµŒå¥—çš„è·¯ç”±&#x2F;è§†å›¾è¡¨\næ¨¡å—åŒ–çš„ã€åŸºäºç»„ä»¶çš„è·¯ç”±é…ç½®\nè·¯ç”±å‚æ•°ã€æŸ¥è¯¢ã€é€šé…ç¬¦\nåŸºäº Vue.js è¿‡æ¸¡ç³»ç»Ÿçš„è§†å›¾è¿‡æ¸¡æ•ˆæœ\nç»†ç²’åº¦çš„å¯¼èˆªæ§åˆ¶\nå¸¦æœ‰è‡ªåŠ¨æ¿€æ´»çš„ CSS class çš„é“¾æ¥\nHTML5 å†å²æ¨¡å¼æˆ– hash æ¨¡å¼ï¼Œåœ¨ IE9 ä¸­è‡ªåŠ¨é™çº§\nè‡ªå®šä¹‰çš„æ»šåŠ¨æ¡è¡Œä¸º\n\n\nå®‰è£…\nnpm install â€“save vue-router@next\n\nåˆ›å»ºrouter\næ–°å»ºsrc&#x2F;routerç›®å½•\næ–°å»ºindex.jsæ–‡ä»¶\næ–‡ä»¶å†…å®¹å¦‚ä¸‹\n\n12345678910111213141516171819202122232425262728293031323334353637383940import &#123; createRouter, createWebHashHistory &#125; from &#x27;vue-router&#x27;;import Login from &quot;../views/Login.vue&quot;;import HelloWorld from &quot;../components/HelloWorld.vue&quot;;  // è·¯ç”±è¡¨const routes = [    &#123;        path: &quot;/&quot;,        name: &quot;Home&quot;,        component: HelloWorld,    &#125;,    &#123;        path: &quot;/login&quot;,        name: &quot;Login&quot;,        meta: &#123;            title: &#x27;ç™»å½•&#x27;        &#125;,        component: Login,    &#125;]  // åˆ›å»ºè·¯ç”±const router = createRouter(&#123;    history: createWebHashHistory(),    routes&#125;);  // è·¯ç”±æ‹¦æˆª// router.beforeEach((to, from, next) =&gt; &#123;//     const role = localStorage.getItem(&#x27;username&#x27;);           // ä»localStorageè·å–ç”¨æˆ·å//     console.log(role);//     if (!role &amp;&amp; to.path !== &#x27;/login&#x27;) &#123;                      // å¦‚æœç”¨æˆ·åä¸å­˜åœ¨ï¼Œå¹¶ä¸”è·¯ç”±æ¡çŠ¶éloginæ—¶ï¼Œç›´æ¥è·³è½¬login//         next(&#x27;/login&#x27;);//     &#125; else &#123;//         next();//     &#125;// &#125;);  export default router;  \nä¸Šè¿°ä»£ç å¤§æ¦‚å«ä¹‰:- åˆ›å»ºä¸¤æ¡è·¯ç”±ï¼Œåˆ†åˆ«æŒ‡å‘HelloWorldï¼ŒLoginç•Œé¢ã€‚- åˆ›å»ºè·¯ç”±å¯¹è±¡- è·¯ç”±æ‹¦æˆªï¼šå½“localStorageä¸­ä¸å­˜åœ¨ç”¨æˆ·åæ—¶ï¼Œè®¤ä¸ºæœªç™»å½•ï¼Œæ‰€æœ‰é“¾æ¥éƒ½è·³è½¬åˆ°Loginç•Œé¢,æš‚æ—¶å»æ‰###  å¼•å…¥router- ä¿®æ”¹main.jså¦‚ä¸‹ï¼Œæ˜¯appæ˜¯ç”¨æˆ‘ä»¬åˆ›å»ºçš„è·¯ç”±12345678import &#123; createApp &#125; from &#x27;vue&#x27;import App from &#x27;./App.vue&#x27;import router from &#x27;./router&#x27;                               // å¼•å…¥è·¯ç”±é…ç½®  const app = createApp(App)  app.use(router)                 // è½½å…¥è·¯ç”±é…ç½®    .mount(&#x27;#app&#x27;)- ä¿®æ”¹main.jså¦‚ä¸‹ï¼Œappä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„è·¯ç”±###  æ˜¾ç¤ºè·¯ç”±é¡µé¢- ä¿®æ”¹App.vueä¸­htmlå—å¦‚ä¸‹123&lt;template&gt;  &lt;router-view /&gt;&lt;/template&gt;æ­¤æ—¶ç•Œé¢å°±ä¼šæ˜¾ç¤ºå½“å‰è·¯ç”±å¯¹åº”ç•Œé¢- åœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://localhost:8080/ å±•ç¤ºçš„æ˜¯HelloWordä¸­å†…å®¹- åœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://localhost:8080/#/login/ å±•ç¤ºçš„æ˜¯Loginä¸­å†…å®¹###  è·¯ç”±è·³è½¬- åœ¨HelloWord.vueä¸­å¢åŠ è·³è½¬è¿æ¥1&lt;router-link to=&quot;/login&quot;&gt;Go to Login&lt;/router-link&gt;ç‚¹å‡»é¡µé¢Go to Loginæ ‡ç­¾å³å¯è·³è½¬åˆ°ç™»å½•ç•Œé¢ã€‚\n  â¡ï¸ vue3ä½¿ç”¨i18nç®€ä»‹\nåœ¨ä¿¡æ¯æŠ€æœ¯é¢†åŸŸï¼Œå›½é™…åŒ–ä¸æœ¬åœ°åŒ–ï¼ˆè‹±æ–‡ï¼šinternationalization and localizationï¼‰æ˜¯æŒ‡ä¿®æ”¹è½¯ä»¶ä½¿ä¹‹èƒ½é€‚åº”ç›®æ ‡å¸‚åœºçš„è¯­è¨€ã€åœ°åŒºå·®å¼‚ä»¥åŠæŠ€æœ¯éœ€è¦ã€‚å›½é™…åŒ–æ˜¯æŒ‡åœ¨è®¾è®¡è½¯ä»¶ï¼Œå°†è½¯ä»¶ä¸ç‰¹å®šè¯­è¨€åŠåœ°åŒºè„±é’©çš„è¿‡ç¨‹ã€‚å½“è½¯ä»¶è¢«ç§»æ¤åˆ°ä¸åŒçš„è¯­è¨€åŠåœ°åŒºæ—¶ï¼Œè½¯ä»¶æœ¬èº«ä¸ç”¨åšå†…éƒ¨å·¥ç¨‹ä¸Šçš„æ”¹å˜æˆ–ä¿®æ­£ã€‚æœ¬åœ°åŒ–åˆ™æ˜¯æŒ‡å½“ç§»æ¤è½¯ä»¶æ—¶ï¼ŒåŠ ä¸Šä¸ç‰¹å®šåŒºåŸŸè®¾ç½®æœ‰å…³çš„ä¿¡æ¯å’Œç¿»è¯‘æ–‡ä»¶çš„è¿‡ç¨‹ã€‚å›½é™…åŒ–å’Œæœ¬åœ°åŒ–ä¹‹é—´çš„åŒºåˆ«è™½ç„¶å¾®å¦™ï¼Œä½†å´å¾ˆé‡è¦ã€‚å›½é™…åŒ–æ„å‘³ç€äº§å“æœ‰é€‚ç”¨äºä»»ä½•åœ°æ–¹çš„â€œæ½œåŠ›â€ï¼›æœ¬åœ°åŒ–åˆ™æ˜¯ä¸ºäº†æ›´é€‚åˆäºâ€œç‰¹å®šâ€åœ°æ–¹çš„ä½¿ç”¨ï¼Œè€Œå¦å¤–å¢æ·»çš„ç‰¹è‰²ã€‚ç”¨ä¸€é¡¹äº§å“æ¥è¯´ï¼Œå›½é™…åŒ–åªéœ€åšä¸€æ¬¡ï¼Œä½†æœ¬åœ°åŒ–åˆ™è¦é’ˆå¯¹ä¸åŒçš„åŒºåŸŸå„åšä¸€æ¬¡ã€‚è¿™ä¸¤è€…ä¹‹é—´æ˜¯äº’è¡¥çš„ï¼Œå¹¶ä¸”ä¸¤è€…åˆèµ·æ¥æ‰èƒ½è®©ä¸€ä¸ªç³»ç»Ÿé€‚ç”¨äºå„åœ° [1]  ã€‚åŸºäºä»–ä»¬çš„è‹±æ–‡å•å­—é•¿åº¦è¿‡é•¿ï¼Œå¸¸è¢«åˆ†åˆ«ç®€ç§°æˆi18nï¼ˆ18æ„å‘³ç€åœ¨â€œinternationalizationâ€è¿™ä¸ªå•å­—ä¸­ï¼Œiå’Œnä¹‹é—´æœ‰18ä¸ªå­—æ¯ï¼‰åŠL10nã€‚ä½¿ç”¨å¤§å†™çš„Lä»¥åˆ©åŒºåˆ†i18nä¸­çš„iå’Œæ˜“äºåˆ†è¾¨å°å†™lä¸1ã€‚\n\nå®‰è£…\nnpm install i18n â€“save\n\nä½¿ç”¨æ­¥éª¤1ã€åˆ›å»ºI18n12345678import &#123; createI18n &#125; from &#x27;vue-i18n&#x27;    const i18n = createI18n(&#123;  locale: localeZH.name,            // é»˜è®¤ä¸­æ–‡  fallbackLocale: localeEN.name,    // ä¸­æ–‡ä¸å­˜åœ¨æ—¶ï¼Œæ˜¾ç¤ºè‹±æ–‡  messages,                         // è‡ªå®šä¹‰è¯­è¨€åŒ…&#125;)  \n2ã€åˆ›å»ºè‡ªå®šä¹‰è¯­è¨€åŒ…12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152export default &#123;    &#x27;zh-cn&#x27;: &#123;        main: &#123;            prjname:&#x27;åå°ç®¡ç†ç³»ç»Ÿ&#x27;,            breadcrumb: &#x27;å›½é™…åŒ–äº§å“&#x27;,            tips: &#x27;é€šè¿‡åˆ‡æ¢è¯­è¨€æŒ‰é’®ï¼Œæ¥æ”¹å˜å½“å‰å†…å®¹çš„è¯­è¨€ã€‚&#x27;,            btn: &#x27;åˆ‡æ¢è‹±æ–‡&#x27;,            title1: &#x27;å¸¸ç”¨ç”¨æ³•&#x27;,            p1: &#x27;è¦æ˜¯ä½ æŠŠä½ çš„ç§˜å¯†å‘Šè¯‰äº†é£ï¼Œé‚£å°±åˆ«æ€ªé£æŠŠå®ƒå¸¦ç»™æ ‘ã€‚&#x27;,            p2: &#x27;æ²¡æœ‰ä»€ä¹ˆæ¯”ä¿¡å¿µæ›´èƒ½æ”¯æ’‘æˆ‘ä»¬åº¦è¿‡è‰°éš¾çš„æ—¶å…‰äº†ã€‚&#x27;,            p3: &#x27;åªè¦èƒ½æŠŠè‡ªå·±çš„äº‹åšå¥½ï¼Œå¹¶è®©è‡ªå·±å¿«ä¹ï¼Œä½ å°±é¢†å…ˆäºå¤§å¤šæ•°äººäº†ã€‚&#x27;        &#125;,        siderbar: &#123;            dashboard:&#x27;ç³»ç»Ÿé¦–é¡µ&#x27;,            table:&#x27;åŸºç¡€è¡¨æ ¼&#x27;,            tabs:&#x27;tabé€‰é¡¹å¡&#x27;,            froms:&#x27;è¡¨å•ç›¸å…³&#x27;,            icon:&#x27;è‡ªå®šä¹‰å›¾æ ‡&#x27;,            charts:&#x27;schartå›¾è¡¨&#x27;,            i18n:&#x27;å›½é™…åŒ–åŠŸèƒ½&#x27;,            error:&#x27;é”™è¯¯å¤„ç†&#x27;,            framestyle:&#x27;ç”»é¢é£æ ¼&#x27;,            iconfont:&#x27;iconfont&#x27;,            donate:&#x27;æ”¯æŒä½œè€…&#x27;,        &#125;    &#125;,    &#x27;en&#x27;: &#123;        main:&#123;            prjname:&#x27;Management System&#x27;,            breadcrumb: &#x27;International Products&#x27;,            tips: &#x27;Click on the button to change the current language. &#x27;,            btn: &#x27;Switch Chinese&#x27;,            title1: &#x27;Common usage&#x27;,            p1: &quot;If you reveal your secrets to the wind you should not blame the wind for  revealing them to the trees.&quot;,            p2: &quot;Nothing can help us endure dark times better than our faith. &quot;,            p3: &quot;If you can do what you do best and be happy, you&#x27;re further along in life  than most people.&quot;        &#125;,        siderbar: &#123;            dashboard:&#x27;dashboard&#x27;,            table:&#x27;table&#x27;,            tabs:&#x27;tabs&#x27;,            froms:&#x27;froms&#x27;,            icon:&#x27;icon&#x27;,            charts:&#x27;charts&#x27;,            i18n:&#x27;i18n&#x27;,            error:&#x27;error&#x27;,            framestyle:&#x27;framestyle&#x27;,            iconfont:&#x27;iconfont&#x27;,            donate:&#x27;donate&#x27;,        &#125;,    &#125;&#125;\nå¦‚ä¸Šï¼Œåˆ›å»ºäº†ä¸¤ä¸ªè¯­è¨€åŒ…ï¼Œåˆ†åˆ«ä¸ºzh-cnï¼Œen.####  3ã€ä½¿ç”¨è¯­è¨€1&lt;div class=&quot;logo&quot;&gt;&#123;&#123;$t(&#x27;main.prjname&#x27;)&#125;&#125;&lt;/div&gt;æ­¤æ—¶å°±ç”¨åˆ°è¯­è¨€åŒ…ä¸­main.prjnamæ ‡ç­¾####  4ã€åˆ‡æ¢è¯­è¨€#####  4.1ã€html12345&lt;el-button    type=&quot;primary&quot;    @click=&quot;$i18n.locale = $i18n.locale === &#x27;zh-cn&#x27;?&#x27;en&#x27;:&#x27;zh-cn&#x27;;&quot;&gt;    åˆ‡æ¢è¯­è¨€    &lt;/el-button&gt;#####  4.2ã€js1234567import &#123; getCurrentInstance &#125; from &quot;vue&quot;;const &#123; proxy &#125; = getCurrentInstance();  const handleLangCommand = (command) =&gt; &#123;    proxy.$i18n.locale = command;  // command:zh-cn æˆ– en    console.log(proxy);&#125;;\n  \n  \n  â¡ï¸ vue3+element-uiä½¿ç”¨iconfontåˆ›å»ºå›¾æ ‡é¡¹ç›®\nç™»å½•å®˜ç½‘ \nhttps://www.iconfont.cn\n\n\nåˆ›å»ºé¡¹ç›®\næ³¨æ„å‰ç¼€è¯·ä½¿ç”¨el-icon-å¼€å¤´ï¼Œfont-familyå¯éšæ„,å› ä¸ºelement-uiä¸­å¯¹å›¾æ ‡æ ·å¼æ§åˆ¶é‡‡ç”¨el-iconå¼€å¤´ï¼Œè¿™æ ·å¯ä»¥å’Œelement-uiä¸­å›¾æ ‡ä¿æŒç›¸åŒæ ·å¼\n\n123456789101112131415element-ui css æºç [class*=&quot; el-icon-&quot;],[class^=el-icon-] &#123;\tfont-family: element-icons!important;\tspeak: none;\tfont-style: normal;\tfont-weight: 400;\tfont-variant: normal;\ttext-transform: none;\tline-height: 1;\tvertical-align: baseline;\tdisplay: inline-block;\t-webkit-font-smoothing: antialiased;\t-moz-osx-font-smoothing: grayscale    ...&#125;\n\nå‹¾é€‰Base64\nç”Ÿæˆåœ¨çº¿é“¾æ¥ï¼Œä¹Ÿå¯ä¸‹è½½ä¸‹æ¥æœ¬åœ°ä½¿ç”¨\n\nå¼•å…¥iconfontå›¾æ ‡\nåœ¨index.htmlä¸­åŠ å…¥å¦‚ä¸‹é“¾æ¥ï¼Œé“¾æ¥åœ°å€æ¢æˆè‡ªå·±é¡¹ç›®åœ°å€1&lt;link rel=&quot;stylesheet&quot; href=&quot;https://at.alicdn.com/t/font_2720579_wc4x6y2ql9.css&quot;&gt;\næ–°å»ºiconfont.cssï¼ˆæ–‡ä»¶åéšæ„ï¼‰ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ŒæŒ‡å®šæ ·å¼ä¸ºel-icon-edgeå¼€å¤´çš„å…ƒç´ é‡‡ç”¨el-icon-edge-iconfonå­—ç¬¦é›† 1234[class*=&quot; el-icon-edge&quot;],[class^=el-icon-edge] &#123;    font-family: el-icon-edge-iconfont !important;&#125;\nmain.jsä¸­å¼•ç”¨ä¸Šè¿°iconfont.cssæ–‡ä»¶\n\nå®é™…ä½¿ç”¨\nå®é™…ä½¿ç”¨å’Œelement-uiä¸­å›¾æ ‡æ–¹å¼ä¸€è‡´ï¼Œå¦‚ä¸‹1&lt;i class=&quot;el-icon-edgechanrongxietong&quot;&gt;&lt;/i&gt;\n\n\n\nâ¡ï¸ vue3+element-uiä½¿ç”¨Animate.cssç®€ä»‹\nanimate.css æ˜¯ä¸€ä¸ªæ¥è‡ªå›½å¤–çš„ CSS3 åŠ¨ç”»åº“ï¼Œå®ƒé¢„è®¾äº†æŠ–åŠ¨ï¼ˆshakeï¼‰ã€é—ªçƒï¼ˆflashï¼‰ã€å¼¹è·³ï¼ˆbounceï¼‰ã€ç¿»è½¬ï¼ˆflipï¼‰ã€æ—‹è½¬ï¼ˆrotateIn&#x2F;rotateOutï¼‰ã€æ·¡å…¥æ·¡å‡ºï¼ˆfadeIn&#x2F;fadeOutï¼‰ç­‰å¤šè¾¾ 60 å¤šç§åŠ¨ç”»æ•ˆæœï¼Œå‡ ä¹åŒ…å«äº†æ‰€æœ‰å¸¸è§çš„åŠ¨ç”»æ•ˆæœã€‚\nè™½ç„¶å€ŸåŠ© animate.css èƒ½å¤Ÿå¾ˆæ–¹ä¾¿ã€å¿«é€Ÿçš„åˆ¶ä½œ CSS3 åŠ¨ç”»æ•ˆæœï¼Œä½†è¿˜æ˜¯å»ºè®®çœ‹çœ‹ animate.css çš„ä»£ç ï¼Œä¹Ÿè®¸ä½ èƒ½ä»ä¸­å­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚\n\nå…¼å®¹\næµè§ˆå™¨å…¼å®¹ï¼šå½“ç„¶æ˜¯åªå…¼å®¹æ”¯æŒ CSS3 animate å±æ€§çš„æµè§ˆå™¨ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼šIE10+ã€Firefoxã€Chromeã€Operaã€Safariã€‚\n\nä½¿ç”¨æ–¹æ³•1ã€å¼•å…¥æ–‡ä»¶\n123456&lt;link rel=&quot;stylesheet&quot; href=&quot;animate.min.css&quot;&gt;  æˆ–è€…cdnæ–¹å¼å¼•ç”¨ &lt;link rel=&quot;stylesheet&quot;       href=&quot;https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css&quot;&gt;\n\n2ã€ä½¿ç”¨åŠ¨ç”»2.1ã€ç»“åˆtransitionä½¿ç”¨åŠ¨ç”» 12345&lt;transition enter-active-class=&quot;animated bounceInDown&quot;             leave-active-class=&quot;animated bounceOutDown&quot;             :duration=&quot;200&quot;&gt;&lt;!--å…¥åœºå’Œç¦»åœºçš„æ—¶é—´--&gt;            &lt;div&gt; æµ‹è¯• &lt;/div&gt;&lt;/transition&gt;\n\nè¯´æ˜ï¼šç»“åˆtransitionæ ‡ç­¾å¯ä»¥è®¾ç½®å…ƒç´ å…¥åœºå’Œç¦»åœºåŠ¨ç”»\n\n2.2ã€ç›´æ¥ä½¿ç”¨ 123&lt;el-card class=&quot;animated bounceIn&quot; shadow=&quot;hover&quot;&gt;    &lt;schart ref=&quot;bar&quot; class=&quot;schart&quot; canvasId=&quot;bar&quot; :options=&quot;options&quot;&gt;&lt;/schart&gt;&lt;/el-card&gt;\n\nâ¡ï¸ å…¨å±ç»„ä»¶screenfullå®‰è£…\nnpm install screenfull â€“save\n\nä½¿ç”¨æ­¥éª¤1ã€å¼•å…¥æ–‡ä»¶1import screenfull from &#x27;screenfull&#x27;;\n2ã€ä½¿ç”¨2.1ã€æ•´ä¸ªé¡µé¢å…¨å± 12345678910111213141516// å…¨å±ç‚¹å‡»æ—¶const onScreenfullClick = () =&gt; &#123;    if (!screenfull.isEnabled) &#123;        ElMessage.warning(&#x27;æš‚ä¸ä¸æ”¯æŒå…¨å±&#x27;);        return false;    &#125;      screenfull.toggle();        // è§¦å‘å…¨å±åˆ‡æ¢ï¼Œå³åœ¨å…¨å±ä¸éå…¨å±çŠ¶æ€åˆ‡æ¢    screenfull.on(&#x27;change&#x27;, () =&gt; &#123;        // å“åº”å…¨å±çŠ¶æ€ï¼Œå¯æ ¹æ®æ­¤çŠ¶æ€ï¼Œæ›´æ¢æŒ‰é’®å›¾æ ‡ç­‰æ“ä½œ        if (screenfull.isFullscreen)             state.isScreenfull = true;             else             state.isScreenfull = false;    &#125;);&#125;;\n2.2ã€å•ä¸ªå…ƒç´ å…¨å± 123456789&lt;div class=&quot;text&quot;  @dblclick=&quot;FuncDbClick($event)&quot;&gt;    &lt;el-image style=&quot;width: 100%;height:100%;&quot; src=&quot;../src/assets/img/camera.png&quot; :fit=&quot;fit&quot;&gt;    &lt;/el-image&gt;&lt;/div&gt;  const FuncDbClick = (event) =&gt; &#123;    state.bSignalFull ? screenfull.exit() : screenfull.request(event.currentTarget);    state.bSignalFull = !state.bSignalFull;&#125;;\n\nåŒå‡»å…¨å±åŠé€€å‡ºå…¨å±\n\n\nâ¡ï¸ vue3çŸ¥è¯†å›¾è°±å­¦å‰äº†è§£###  åŸºç¡€çŸ¥è¯†###  ç»„ä»¶ç›¸å…³è¯­æ³•###  é«˜çº§è¯­æ³•###  é…å¥—å·¥å…·\n  ","slug":"WEB/vue3å­¦ä¹ æ–‡æ¡£","date":"2021-08-18T06:34:47.000Z","categories_index":"å‰ç«¯æ¡†æ¶","tags_index":"vue","author_index":"é˜¿æœ¨å¤§å”"},{"id":"799e4e62b5b5376eafc0cedc9d50e8a4","title":"Qté¢è¯•é¢˜é›†åˆ","content":"\nQt ä¸­å¸¸ç”¨çš„äº”å¤§æ¨¡å—æ˜¯å“ªäº›ï¼Ÿ\n\nQt ä¸­å¸¸ç”¨çš„äº”å¤§æ¨¡å—åŒ…æ‹¬ï¼š\n\nQtCoreï¼šæä¾›äº† Qt çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¾‹å¦‚åŸºæœ¬çš„é GUI ç±»ã€çº¿ç¨‹å’Œäº‹ä»¶å¤„ç†ç­‰ã€‚\n\nQtGuiï¼šæä¾›ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰ç±»ï¼Œä¾‹å¦‚çª—å£éƒ¨ä»¶ã€æŒ‰é’®ã€æ ‡ç­¾ç­‰ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜åŒ…å« QPainter å’Œ QPalette ç­‰ç»˜å›¾å’Œè°ƒè‰²æ¿ç±»ã€‚\n\nQtWidgetsï¼šæ˜¯ QtGui æ¨¡å—çš„å­é›†ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„å¯è§†åŒ– UI æ§ä»¶åº“ï¼Œä¾‹å¦‚æŒ‰é’®ã€æ–‡æœ¬ç¼–è¾‘å™¨ã€è¡¨æ ¼ç­‰ï¼Œç”¨äºæ„å»ºè·¨å¹³å°çš„æ¡Œé¢åº”ç”¨ç¨‹åºã€‚\n\nQtNetworkï¼šæä¾›ç½‘ç»œç¼–ç¨‹ç±»ï¼Œç”¨äºåˆ›å»º TCP å’Œ UDP å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼Œä»¥åŠå¤„ç†å¥—æ¥å­—å’Œ HTTP è¯·æ±‚ã€‚\n\nQtSqlï¼šæä¾›ç®€å•æ˜“ç”¨çš„æ•°æ®åº“è®¿é—® APIï¼Œç”¨äºåœ¨ Qt ä¸­è¿æ¥ã€æŸ¥è¯¢å’Œæ“ä½œæ•°æ®æºä¸­çš„æ•°æ®ã€‚\n\n\n\nä»€ä¹ˆæ˜¯ä¿¡å·å’Œæœºåˆ¶ï¼Ÿå¦‚ä½•ä½¿ç”¨ä¿¡å·å’Œå®ç°å¯¹è±¡é—´é€šä¿¡ï¼Ÿ\n\nä¿¡å·å’Œæ§½æ˜¯ Qt æ¡†æ¶ä¸­ç”¨äºå¯¹è±¡é—´é€šä¿¡çš„æœºåˆ¶ã€‚ä¿¡å·æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å‡½æ•°ï¼Œç”¨äºå‘å‡ºé€šçŸ¥å¯¹è±¡å·²ç»å‘ç”Ÿäº†æŸä¸ªäº‹ä»¶ã€‚è€Œæ˜¯æ¥æ”¶ä¿¡å·çš„å‡½æ•°ï¼Œå½“ä¸€ä¸ªä¿¡å·è§¦å‘æ—¶ï¼Œä¸ä¹‹ç›¸è¿æ¥çš„å°†è¢«è‡ªåŠ¨è°ƒç”¨ã€‚è¿™æ ·å¯ä»¥å®ç°å¯¹è±¡é—´çš„è§£è€¦å’Œçµæ´»çš„äº‹ä»¶å¤„ç†æµç¨‹ã€‚\nä½¿ç”¨ä¿¡å·å’Œæœºåˆ¶å¯ä»¥åœ¨ä¸€ä¸ªå¯¹è±¡å†…éƒ¨æˆ–ä¹‹é—´å®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©å¼€å‘è€…è§£è€¦ä¸åŒç»„ä»¶ã€æ¨¡å—çš„ä»£ç ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚\n\nå¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰ä¿¡å·ï¼Ÿ\n\næ‚¨å¯ä»¥ä½¿ç”¨å…³é”®å­— signals åœ¨ QObject ç±»ä¸­å£°æ˜è‡ªå®šä¹‰ä¿¡å·ã€‚ä¾‹å¦‚ï¼š\n1234567class MyObject : public QObject&#123;    Q_OBJECTsignals:    void mySignal();&#125;;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åœ¨ç±»ä¸­å£°æ˜äº†è‡ªå®šä¹‰ signalâ€œmySignalâ€ã€‚æ‚¨å¯ä»¥é€‰æ‹©ä¸å†™ä»»ä½•å‚æ•°ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„é€šçŸ¥ä¿¡å·ã€‚\nè¦è§¦å‘ä¿¡å·ï¼Œè¯·ä½¿ç”¨ç±»ä¼¼ emit mySignal() çš„è¯­æ³•ã€‚ä¾‹å¦‚ï¼š\n12345void MyClass::someFunction()&#123;    // do something ...    emit mySignal();&#125;\n\n\nåœ¨ Qt ä¸­ï¼Œä¸ºä½•ä¸å»ºè®®ä½œ UI æ§ä»¶å¹¶ä¿®æ”¹å…¶å±æ€§å€¼ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œå»ºè®®å°† UI æ§ä»¶ï¼ˆä¾‹å¦‚æŒ‰é’®ã€æ ‡ç­¾ç­‰ï¼‰è§†ä¸ºè§†å›¾å±‚æ§åˆ¶å™¨ï¼ˆView-Controllerï¼‰ï¼Œè€Œå°†ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºçš„ä½è€¦åˆæ€§ã€‚å› æ­¤ï¼Œåœ¨ UI æ§ä»¶ä¸­å¤„ç†ä¸šåŠ¡é€»è¾‘å’Œç›´æ¥æ›´æ”¹å±æ€§å€¼å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥ç»´æŠ¤ä»£ç ã€å¤šä½™çš„é‡å¤ä»£ç ä»¥åŠä¸ä¾¿äºæ–‡ä»¶ç»“æ„ä¼˜åŒ–ç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚\nç›¸åï¼Œé€šè¿‡å°†ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼Œæ‚¨å¯ä»¥æ›´å¥½åœ°ç®¡ç†å’Œæµ‹è¯•ä»£ç ï¼Œå¹¶ä¿æŒä»£ç çš„æ¸…æ™°åº¦ã€‚é€šè¿‡è¿æ¥ä¿¡å·å’Œæ§½æ¥å®ç°å¯¹ç•Œé¢æ§ä»¶çš„ä¿®æ”¹ã€‚\n\nQPainter æ˜¯ä»€ä¹ˆï¼Ÿå®ƒç”¨äºå“ªäº›åœºæ™¯ï¼Ÿ\n\nQPainter æ˜¯ Qt çš„ç»˜å›¾å¼•æ“ï¼Œç”¨äºç»˜åˆ¶å„ç§å›¾å½¢å…ƒç´ å’Œæ¸²æŸ“æ–‡æœ¬ã€‚ å®ƒæä¾›äº†å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ï¼Œä¾‹å¦‚ç”»çŸ©å½¢ã€ç”»åœ†ç­‰å¯ä»¥ç»˜åˆ¶åŸºæœ¬å›¾å½¢ã€‚å®ƒè¿˜åŒ…å«è®¾ç½®ç”»ç¬”å®½åº¦ã€é¢œè‰²å’Œæ ·å¼ã€å­—ä½“ï¼Œæ¸å˜ã€å›¾æ¡ˆã€é€æ˜åº¦çš„åŠŸèƒ½ç­‰ï¼Œä½¿ç”¨æˆ·å¯ä»¥ä½¿ç”¨ç›¸å¯¹ç®€å•çš„æ­¥éª¤å‘ˆç°å‡ºå¤æ‚çš„æ•ˆæœã€‚ \nQPainter åœ¨ GUI åº”ç”¨ç¨‹åºä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚ é€šè¿‡ä½¿ç”¨ QPainterï¼Œæ‚¨å¯ä»¥åœ¨çª—å£æˆ–å…¶ä»–éƒ¨ä»¶ä¸Šå®ç°è‡ªå®šä¹‰çš„æ¸²æŸ“ï¼Œå¹¶åˆ›å»ºè‡ªå·±çš„å›¾æ ‡ã€å›¾è¡¨å’Œæ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œå¢å¼ºåº”ç”¨ç¨‹åºçš„ç”¨æˆ·ä½“éªŒã€‚\n\nQt ä¸­æœ‰å“ªäº›ç±»å‹çš„å®šæ—¶å™¨ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿ\n\nQt ä¸­æœ‰ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„å®šæ—¶å™¨ï¼š\n\nQTimerï¼šæ˜¯ä¸€ä¸ªé€šç”¨çš„ã€åŸºäºäº‹ä»¶çš„å®šæ—¶å™¨ï¼Œç”¨äºåœ¨æŒ‡å®šæ—¶é—´é—´éš”åè§¦å‘ timeOut() ä¿¡å·ã€‚\n\nQBasicTimerï¼šæ˜¯ç”¨äºæ›´é«˜çº§åˆ«çš„å®šæ—¶æ“ä½œçš„è¾…åŠ©ç±»ã€‚å®ƒå…è®¸å¯¹è±¡åˆ›å»ºä¸€ä¸ªå†…éƒ¨è®¡æ—¶å™¨ï¼Œå¹¶ä½¿ç”¨ timerEvent() å‡½æ•°å¤„ç†è¶…æ—¶äº‹ä»¶ã€‚\n\n\nä¸¤è€…å‡æ”¯æŒé€ä¸ªæ¬¡æ•°è§¦å‘æˆ–é‡å¤è§¦å‘æ–¹æ³•ï¼Œä½† QBasicTimer å¯è‡ªè¡Œç®¡ç†å…¶å†…éƒ¨å®šæ—¶å™¨ï¼Œè¿™ä½¿å¾—å®ƒæ›´é€‚åˆäºéœ€è¦ç»†ç²’åº¦çš„å®šæ—¶å™¨æ“ä½œã€‚\n\nQThread å’Œ QtConcurrent ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿæ‚¨åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å“ªç§æ–¹å¼æ¥å¤„ç†å¤šçº¿ç¨‹ï¼Ÿ\n\nQThread æ˜¯ Qt ä¸­çš„ä¸€ä¸ªåŸºç¡€ç±»ï¼Œç”¨äºåœ¨åº”ç”¨ç¨‹åºä¸­å»ºç«‹æ–°çš„çº¿ç¨‹ã€‚ä½¿ç”¨ QThreadï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶å°†ç‰¹å®šä»»åŠ¡æ”¾åœ¨è¯¥çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä»è€Œä½¿ä¸»çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›´æ¥ä½¿ç”¨ QThread æ—¶æœ‰æ—¶å€™å­˜åœ¨ä¸€äº›éš¾ä»¥è§£å†³çš„é—®é¢˜ï¼Œä¾‹å¦‚å†…å­˜æ³„æ¼å’Œè·¨çº¿ç¨‹å¤„ç†ä¿¡å·æ—¶å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ç­‰ã€‚\nQtConcurrent åˆ™æ˜¯ä¸€ä¸ªé«˜çº§åˆ« APIï¼Œæä¾›äº†è®¸å¤šæ–¹ä¾¿åŠ è½½å’Œç®¡ç†çº¿ç¨‹çš„å‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨ QtConcurrentï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°ç¼–å†™å¹¶è¡Œä»£ç ï¼Œå¹¶ä½¿ç”¨ map-reduce æ¨¡å¼æ‰§è¡Œç®—æ³•ã€‚å®ƒæ›´æ˜“äºä½¿ç”¨å’Œç®¡ç†ï¼Œä½†çµæ´»æ€§è¾ƒä½ã€‚\nå…³äºåœ¨é¡¹ç›®ä¸­ä½¿ç”¨å“ªç§æ–¹å¼æ¥å¤„ç†å¤šçº¿ç¨‹ï¼Œè¿™å–å†³äºå…·ä½“æƒ…å†µã€‚å¦‚æœéœ€è¦æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œä¾‹å¦‚éœ€è¦åœ¨ç¨‹åºçº§åˆ«æ§åˆ¶çº¿ç¨‹ã€ç»™çº¿ç¨‹åˆ†é…ä¼˜å…ˆçº§å’Œåˆ†ç¦»ä¸‹å±çº¿ç¨‹ç­‰æ“ä½œï¼Œåˆ™åº”ä½¿ç”¨ QThreadã€‚å¦‚æœéœ€è¦çš„ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„åå°çº¿ç¨‹ï¼Œæ‰§è¡ŒIOå¯†é›†å‹ä»£ç æˆ–è€…å¤§é‡ç®€å•çš„è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨ QtConcurrentã€‚\n\nQt æä¾›äº†å“ªäº›ç”¨äºæ ¼å¼åŒ–å­—ç¬¦å’Œå­—ç¬¦ä¸²çš„ç±»å’Œå‡½æ•°ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿ\n\nQt æä¾›äº†å¾ˆå¤šèƒ½å¤Ÿæ ¼å¼åŒ–å­—ç¬¦å’Œå­—ç¬¦ä¸²çš„ç±»å’Œå‡½æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\n\nQStringï¼šå®ƒæ˜¯ Qt ä¸­æœ€å¸¸ç”¨çš„å­—ç¬¦ä¸²ç±»ï¼Œæ”¯æŒ Unicode å’Œæœ¬åœ°åŒ–å­—ç¬¦ã€æ”¯æŒæ ¼å¼åŒ–ï¼›\n\nQTextStreamï¼šå®ƒå¯ä»¥ä½¿ç”¨ &lt;&lt; è¿ç®—ç¬¦å‘æµä¸­æ·»åŠ æ•°æ®ï¼Œå¹¶è‡ªåŠ¨è¿›è¡Œå­—ç¬¦ä¸²è½¬æ¢å’Œç¼“å†²å¤„ç†ï¼›\n\nQLocaleï¼šæä¾›ä¸è¯­è¨€ç¯å¢ƒç›¸å…³çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ—¥æœŸå’Œæ•°å­—æ ¼å¼åŒ–ï¼›\n\nQVariantï¼šæ˜¯ä¸€ä¸ªé€šç”¨çš„å€¼ç±»ï¼Œå¯åœ¨ç‰¹å®šæ ¼å¼å’Œç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚\n\n\nè¿™äº›ç±»å’Œå‡½æ•°åœ¨å¤„ç†ä¸åŒåœºæ™¯æ—¶ï¼Œå„è‡ªæ‹¥æœ‰å®ƒä»¬çš„ä¼˜ç‚¹ã€‚ QString æä¾›äº†ä¸€èˆ¬æ€§å­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½ï¼› QTextStream å°¤å…¶æ“…é•¿äºå¤„ç†æ–‡ä»¶I&#x2F;Oæ“ä½œï¼› QLocale æ˜¾ç„¶é€‚ç”¨äºéœ€è¦å›½é™…åŒ–çš„å­—ç¬¦ä¸²æ“ä½œç­‰ç­‰ã€‚é€‰æ‹©åˆé€‚çš„å·¥å…·å°†ä¼šä½¿åº”ç”¨ç¨‹åºçš„æ•ˆç‡å’Œå‡†ç¡®æ€§å¾—åˆ°æé«˜ã€‚\n\nQObject ä¸ºä½•ç¦æ­¢æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç¬¦ï¼Ÿ\n\nQObject å®ä¾‹é€šå¸¸è¢«è§†ä¸ºå¯¹è±¡æ ‘çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬è¢«åˆ†å±‚ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€ä¸ªå±‚æ¬¡ç»“æ„ã€‚è¿™ä¸ªå±‚æ¬¡ç»“æ„ä¸­ï¼Œæ¯ä¸ª QObject å®ä¾‹éƒ½æœ‰ä¸€ä¸ªçˆ¶å¯¹è±¡ï¼ˆé™¤äº†é¡¶çº§çš„ QObject å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”å½“çˆ¶å¯¹è±¡åˆ é™¤æ—¶ï¼Œæ‰€æœ‰å­å¯¹è±¡ä¹Ÿä¼šè‡ªåŠ¨åˆ é™¤ã€‚\nå¦‚æœå…è®¸ QObject å®ä¾‹çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆ™å¯èƒ½å¯¼è‡´æŸäº›é—®é¢˜ï¼Œä¾‹å¦‚ï¼š\n\nå¤šä¸ªå®ä¾‹å¼•ç”¨åŒä¸€å¯¹è±¡ï¼Œæ— æ³•ç¡®å®šå“ªä¸ªå¯¹è±¡æ˜¯â€œæ­£ç¡®â€çš„ã€‚\n\nåœ¨å¤åˆ¶ä¸€ä¸ª QObject å®ä¾‹æ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ªä¸ªæ ‘ä¸­ï¼Œè¯¥å¯¹è±¡çš„çˆ¶æŒ‡é’ˆä¸æ­£ç¡®ã€‚\n\nå¦‚æœæ–°åˆ›å»ºçš„å¯¹è±¡æ²¡æœ‰è¿›è¡Œæ­£ç¡®çš„æ³¨å†Œï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯¥å¯¹è±¡åœ¨é”€æ¯æ—¶å‡ºç°é”™è¯¯å’Œå†…å­˜æ³„æ¼ã€‚\n\n\nå› æ­¤ï¼ŒQObject ç¦æ­¢æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œä»¥ç¡®ä¿ç¨‹åºå‘˜ä¸ä¼šæ„å¤–åœ°è§¦å‘ä¸Šè¿°é—®é¢˜ï¼Œåœ¨å¼€å‘æœŸé—´æ›´å¥½åœ°è¿›è¡Œç®¡ç†ã€‚\nå¦‚æœéœ€è¦å¤åˆ¶ QObject å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ QObject çš„ clone() å‡½æ•°æˆ–è€…å…¶ä»–è‡ªå®šä¹‰å‡½æ•°å®ç°æ·±åº¦å…‹éš†æ“ä½œï¼Œå¹¶ç¡®ä¿å¤„ç†æ‰€æœ‰å­å¯¹è±¡çš„å¼•ç”¨å’ŒæŒ‡é’ˆã€‚\n\nå¦‚ä½•åœ¨ Qt ä¸­å¤„ç†æ–‡ä»¶å’Œç›®å½•æ“ä½œï¼ŸQt ä¸­æœ‰å“ªäº›ç±»å’Œå‡½æ•°å¯ç”¨äºè¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ QFile ç±»æ¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚å¯¹äºæ–‡ä»¶ç›®å½•æ“ä½œï¼ŒQDir ç±»æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„è¯¾ç¨‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ QDir æ¥éå†ç›®å½•ã€è¿‡æ»¤å’Œæ’åºæ–‡ä»¶ã€è·å–æœ‰å…³æ–‡ä»¶&#x2F;ç›®å½•ä¿¡æ¯ã€åˆ›å»ºå’Œç§»åŠ¨æ–‡ä»¶ç­‰ç­‰ã€‚\nä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Qt æ–‡ä»¶å’Œç›®å½•æ“ä½œå‡½æ•°ï¼š\n\nQFile::open() - æ‰“å¼€æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å¥æŸ„ï¼›\n\nQFile::readAll() - è¯»å–æ•´ä¸ªæ–‡ä»¶å¹¶è¿”å›å…¶å†…å®¹çš„ QByteArrayï¼›\n\nQFile::write() - å†™æ•°æ®åˆ°æ‰“å¼€çš„æ–‡ä»¶ä¸Šï¼›\n\nQDir::setCurrent() - è®¾ç½®æ‰€ä»¥ç»å¯¹è·¯å¾„åŸºå½•ï¼›\n\nQDir::exists() - æ£€æŸ¥ç›®å½•æˆ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼›\n\nQDir::mkpath() - é€’å½’åˆ›å»ºæ–°ç›®å½•ã€‚\n\n\n\nåœ¨ Qt ä¸­å¦‚ä½•è¿›è¡Œæ•°æ®åº“æ“ä½œï¼ŸQt ä¸­æœ‰å“ªäº›ç±»å’Œå‡½æ•°å¯ç”¨äºè¿æ¥æ•°æ®åº“ã€æ‰§è¡ŒæŸ¥è¯¢å’Œæ›´æ–°æ•°æ®ï¼Ÿ\n\nQt æä¾›äº† QtSqlæ¨¡å—ï¼Œç”¨äºåœ¨ Qt åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæ•°æ®åº“æ“ä½œã€‚å®ƒæ”¯æŒå¤šç§ä¸»æµçš„æ•°æ®åº“å¼•æ“ï¼Œä¾‹å¦‚ SQLiteã€MySQLã€PostgreSQL å’Œ Oracleã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ QtSql ç±»å’Œå‡½æ•°ï¼š\n\nQSqlDatabaseï¼šç”¨äºè¿æ¥åˆ°ä¸€ä¸ªç‰¹å®šçš„æ•°æ®åº“å¼•æ“ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ï¼›\n\nQSqlQueryï¼šç”¨äºæ‰§è¡Œ SQL æŸ¥è¯¢ï¼Œå¹¶æä¾›å¯¹ç»“æœé›†çš„è®¿é—®ï¼›\n\nQSqlTableModelï¼š æä¾›äº†ä¸€ä¸ª model-view æ¥å£ï¼Œä½¿ç”¨ä¸æ•°æ®åº“è¡¨çš„è®°å½•å¯¹åº”çš„æ¨¡å‹æ•°æ®ï¼›\n\nQSqlRelationalTableModelï¼šQSqlTableModelçš„å­ç±»ï¼Œæ”¯æŒå¤šä¸ªè¡¨ä¹‹é—´çš„å…³è”ã€‚\n\n\nä½¿ç”¨ QtSql è¿›è¡Œæ•°æ®åº“æ“ä½œçš„ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š\n\né€‰æ‹©è¦ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“ï¼Œä¾‹å¦‚ SQLiteï¼ŒMySQL æˆ– PostgreSQLã€‚å¦‚æœæ‚¨ä¸ç¡®å®šåº”è¯¥é€‰æ‹©å“ªç§å¼•æ“ï¼Œè¯·å‚é˜…å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚\n\nåˆ›å»ºå¹¶æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼ˆQSqlDatabaseï¼‰ã€‚\n\næ‰§è¡Œ SQL æŸ¥è¯¢æˆ–æ“ä½œæ•°æ®ã€‚è¿™é€šå¸¸æ¶‰åŠä½¿ç”¨ QSqlQuery å¯¹è±¡ã€‚\n\nå¤„ç†æŸ¥è¯¢ç»“æœã€‚\n\nå…³é—­æ•°æ®åº“è¿æ¥ã€‚\n\n\næ³¨æ„ï¼šåœ¨ç¼–å†™ QtSql ä»£ç æ—¶ï¼Œæ‚¨éœ€è¦è€ƒè™‘å¤šçº¿ç¨‹é—®é¢˜å’Œ SQL æ³¨å…¥æ”»å‡»ç­‰å®‰å…¨é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨ prepare() å’Œ bindValue() ç­‰ QSqlQuery å‡½æ•°æ¥å‡è½» SQL æ³¨å…¥æ”»å‡»é—®é¢˜ã€‚åŒæ—¶ä¹Ÿå»ºè®®åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œä»¥ä¿æŒé«˜æ€§èƒ½å’Œæ›´å¥½çš„çº¿ç¨‹å®‰å…¨æ€§ã€‚\n\nQML å’Œ Qt Widgets ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿ\n\nQML å’Œ Qt Widgets éƒ½æ˜¯ Qt æ”¯æŒçš„ UI å¼€å‘æ¡†æ¶ï¼Œä½†äºŒè€…æœ‰å¾ˆå¤§çš„ä¸åŒï¼š\n\nç¼–å†™è¯­è¨€ï¼šQt Widgets ä½¿ç”¨ C++ æ¥ç¼–å†™ UI ç•Œé¢ï¼Œè€ŒQML åŸºäº JavaScriptã€XMLå’ŒåŸºç¡€ HTML&#x2F;CSSã€‚\n\næŠ€æœ¯ï¼šQt Widgets æ˜¯é€šè¿‡ QWidget å’Œ QML ï¼ˆé€šè¿‡ Qt Quick çš„ QQuickItem æ´¾ç”Ÿå¾—æ¥ï¼‰å°†å…ƒç´ ç»„åˆèµ·æ¥çš„ã€‚ Qt Widgets é‡‡ç”¨çš„æ˜¯å›ºå®šåæ ‡çš„æ–¹å¼å¸ƒå±€ï¼Œè€Œ QML ä½¿ç”¨åŸºäºç€è‰²å™¨çš„å¼•æ“ï¼Œèƒ½å¤Ÿæ”¯æŒåº”å˜æ€§å’ŒåŠ¨æ€æ’åˆ—ã€‚\n\nè§†è§‰é£æ ¼ï¼šQt Widgets æä¾›äº†ä¸€å¥—ç‹¬ç«‹äºå¹³å°çš„ widget åº“ï¼Œå¹¶ä¸å¹³å°çš„åŸç”Ÿè§†è§‰é£æ ¼ç±»ä¼¼ã€‚QML å…·æœ‰çµæ´»çš„ä¸»é¢˜ã€æ¨¡æ¿å’Œçš®è‚¤åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºé€‚åˆè‡ªå®šä¹‰å“ç‰Œçš„å®Œå…¨å¯Personalizedçš„ç”¨æˆ·ç•Œé¢ã€‚\n\næ€§èƒ½ï¼šQML çš„æ¸²æŸ“æ€§èƒ½ä¼˜äºä¼ ç»Ÿçš„ Qt Widgetsï¼Œåœ¨å¤„ç†å¤æ‚çš„ 2D å’Œ 3D å‘ˆç°ä»»åŠ¡æ—¶æ•ˆæœæ˜¾è‘—ã€‚\n\n\né€‰æ‹©ä½¿ç”¨å“ªç§æ¡†æ¶ä¾èµ–äºæ‚¨çš„éœ€æ±‚å’Œç‰¹å®šæƒ…å†µã€‚Qt Widgetsé€‚ç”¨äºå¯¹æ§ä»¶çš„ä½ç½®ã€å¤§å°å’Œå…¶ä»–å±æ€§æ–¹é¢æ›´ä¸ºå…³æ³¨ï¼Œè€Œ QML æ­£å¥½ç›¸åï¼›å¦‚æœæ‚¨éœ€è¦è‡ªå®šä¹‰è‡ªå·±çš„ CSS æˆ– JSï¼Œæˆ–è€…éœ€è¦å®ç°å¤æ‚çš„åŠ¨ç”»&#x2F; 2D&#x2F;3D æ¸²æŸ“ç­‰ï¼Œåˆ™å»ºè®®ä½¿ç”¨ QMLã€‚\n\nåœ¨ Qt ä¸­ï¼Œå¦‚ä½•å¤„ç†ç”¨æˆ·ç•Œé¢å…ƒç´ çš„äº‹ä»¶ï¼Ÿå…·ä½“æ¥è¯´ï¼Œå¦‚ä½•å¤„ç†æŒ‰é’®çš„å•å‡»äº‹ä»¶ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¿¡å·å’Œæ’æœºåˆ¶æ¥å¤„ç† UI å…ƒç´ çš„äº‹ä»¶ã€‚ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š\n\nä¸º UI å…ƒç´ å®šä¹‰ä¿¡å·ã€‚ä¾‹å¦‚ï¼ŒQPushButton çš„ clicked() ä¿¡å·è¡¨ç¤ºæŒ‰é’®å·²ç»å•å‡»ã€‚\n\nä¸º UI å…ƒç´ è¿æ¥æ’æ§½å‡½æ•°ã€‚æ’æ§½å‡½æ•°æ˜¯äº‹ä»¶å‘ç”Ÿæ—¶è¦è°ƒç”¨çš„å‡½æ•°ã€‚\n\nç¼–å†™æ’æ§½å‡½æ•°ä»¥å“åº”ä¿¡å·ã€‚ä¾‹å¦‚ï¼Œclicked() å‘ç”Ÿæ—¶æ‰§è¡Œçš„æ’æ§½å‡½æ•°å¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„è®¡ç®—æˆ–è€…å¯åŠ¨å…¶ä»–æ“ä½œã€‚\n\n\nä¸‹é¢æ˜¯ QPushButton å¤„ç†å•å‡»äº‹ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š\nåœ¨ Header æ–‡ä»¶ä¸­å£°æ˜ï¼š\n12public slots:    void onBtnClicked();\n\nåœ¨å®ç°æ–‡ä»¶ä¸­å®ç°ï¼š\n1234void MyWidget::onBtnClicked()&#123;   // æŒ‰é’®å·²è¢«å•å‡»&#125;\n\nåœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®è¿æ¥ï¼š\n1QObject::connect(ui-&gt;myButton, SIGNAL(clicked()), this, SLOT(onBtnClicked()));\n\nè¿™é‡Œï¼Œui-&gt;myButton æ˜¯åœ¨ .ui æ–‡ä»¶ä¸­å®šä¹‰çš„ QPushButton å¯¹è±¡ï¼ŒSIGNAL(clicked()) è¡¨ç¤ºå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œclicked() ä¿¡å·å°†è¢«å‘å°„ã€‚å¦‚æœä½¿ç”¨æ–°è¯­æ³•ï¼Œåˆ™éœ€è¦ä½¿ç”¨ QObject::connect() è€Œä¸æ˜¯ä¸Šé¢çš„æ—§è¯­æ³•ã€‚\n\nå¦‚ä½•ä½¿ç”¨ QML åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶ï¼Ÿ\n\nåœ¨ QML ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Component æ¥åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶ã€‚Component æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯¹è±¡ï¼Œå¯ä»¥è¢«å®ä¾‹åŒ–å¹¶ä½œä¸º QML çš„ä¸€éƒ¨åˆ†è¿›è¡Œä½¿ç”¨ã€‚è¦åˆ›å»º Componentï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œæˆ–è€…åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰å¤šä¸ªç»„ä»¶ã€‚\nä»¥ä¸‹å®šä¹‰ç»„ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š\n123456789101112131415161718192021// MyButton.qmlimport QtQuick 2.0Rectangle &#123;    id: root    width: 100; height: 50    color: &quot;red&quot;    radius: 10    signal clicked()    Text &#123;        anchors.centerIn: parent        text: &quot;Click me!&quot;    &#125;    MouseArea &#123;        anchors.fill: parent        onClicked: root.clicked()    &#125;&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º MyButton çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚è¯¥ç»„ä»¶åŒ…å«ä¸€ä¸ªçº¢è‰²çš„åœ†è§’çŸ©å½¢ã€æ–‡æœ¬å’Œä¸€ä¸ª MouseAreaã€‚MouseArea æ¥æ”¶å•å‡»äº‹ä»¶ï¼Œå¹¶å‘å°„ä¸€ä¸ª clicked() ä¿¡å·ï¼Œè¡¨ç¤ºæŒ‰é’®å·²è¢«å•å‡»ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å°†æ­¤ç»„ä»¶å®ä¾‹åŒ–å¹¶ä½œä¸º QML çš„ä¸€éƒ¨åˆ†è¿›è¡Œä½¿ç”¨ã€‚\næ‚¨å¯ä»¥åœ¨ä¸» QML æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç æ¥å®ä¾‹åŒ– MyButton ç»„ä»¶ï¼š\n123456789101112// main.qmlimport QtQuick 2.0Rectangle &#123;    width: 360; height: 360    color: &quot;#333&quot;    MyButton &#123;        x: 130; y: 130        onClicked: console.log(&quot;Button clicked!&quot;)    &#125;&#125;\n\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨ä¸» QML æ–‡ä»¶ä¸­å®ä¾‹åŒ–äº†ä¸€ä¸ª MyButton ç»„ä»¶ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°äº†ä¸»ç•Œé¢ä¸Šã€‚MyButtonè¢«ç‚¹å‡»æ—¶ï¼Œæˆ‘ä»¬å°†æ§åˆ¶å°è¾“å‡ºä¸€æ¡æ¶ˆæ¯ã€‚\n\nå¦‚ä½•åœ¨ Qt ä¸­ç»˜åˆ¶å›¾å½¢ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QPainter ç±»è¿›è¡Œç»˜å›¾ï¼Œå®ƒæä¾›äº†ä¸€ç»„ç”»å›¾è®¾å¤‡å’Œå…ƒç´ ï¼Œä¾‹å¦‚é¢œè‰²ã€çº¿å®½å’Œå„ç§å‡ ä½•å½¢çŠ¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ QPainter ç»˜åˆ¶ä¸€ä¸ªæ­£æ–¹å½¢ï¼š\n12345678910111213void MyWidget::paintEvent(QPaintEvent *event)&#123;    QPainter painter(this);    painter.setRenderHint(QPainter::Antialiasing);    // è®¾ç½®ç”»ç¬”å’ŒèƒŒæ™¯é¢œè‰²    painter.setPen(Qt::white);    painter.setBrush(Qt::gray);    // ç»˜åˆ¶æ­£æ–¹å½¢    QRectF rectangle(10.0, 20.0, 80.0, 60.0);    painter.drawRect(rectangle);&#125;\n\nè¦ç»˜åˆ¶å…¶ä»–å›¾å½¢ï¼Œæ‚¨éœ€è¦è®¾ç½®ä¸åŒçš„ QPainter å‡½æ•°ï¼Œä¾‹å¦‚ drawLine()ã€drawEllipse()ã€drawText() ç­‰ç­‰ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ QPainterPath ç±»æ¥åˆ›å»ºå¤æ‚çš„è‡ªå®šä¹‰å›¾å½¢è·¯å¾„ã€‚\næ³¨æ„ï¼šQt åœ¨ä½¿ç”¨ QPainter ç»˜å›¾æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç»˜å›¾é—®é¢˜å’Œæ€§èƒ½é—®é¢˜ã€‚å¦‚æœæ‚¨éœ€è¦è¿›è¡Œå¤§é‡ç»˜å›¾æ“ä½œæˆ–è€…å¤„ç†å¤æ‚çš„å›¾å½¢ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ OpenGL æˆ– Qt Quick çš„ QML Canvas ç­‰æ›´é«˜æ•ˆçš„ç»˜å›¾æŠ€æœ¯ã€‚\n\nåœ¨ Qt ä¸­ï¼Œå¦‚ä½•ä½¿ç”¨ä¿¡å·å’Œæ’æ§½æœºåˆ¶è¿›è¡Œå¯¹è±¡é—´é€šä¿¡ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œä¿¡å’Œæ’æ§½æ˜¯å®ç°å¯¹è±¡é—´é€šä¿¡çš„ä¸€ç§å¼ºå¤§æ–¹å¼ã€‚æ¯ä¸ª QObject ç±»å‹çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª signals: ä»¥åŠ slots: éƒ¨åˆ†ã€‚å…¶ä¸­ signals: åŒ…å«äº†æ‰€éœ€çš„ä¿¡å·å®šä¹‰ï¼Œslots: åˆ™åŒ…å«äº†å“åº”ä¿¡å·çš„æ’æ§½å‡½æ•°ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ä¿¡å·å’Œæ’æ§½çš„ç®€å•ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¼ é€’æ•°æ®ï¼š\n\nåˆ›å»ºå‘é€æ–¹ç±»ï¼š\n\n123456789101112131415class Sender : public QObject&#123;    Q_OBJECTpublic:    // å®šä¹‰ä¸€ä¸ª signal ï¼Œä»¥ int ç±»å‹å‘é€æ•°æ®    void sendNumber(int number)    &#123;        emit numberSent(number);    &#125;signals:    // å£°æ˜ä¸€ä¸ªå‘é€ int ç±»å‹æ•°æ®çš„ signal    void numberSent(int number);&#125;;\n\n\nåˆ›å»ºæ¥æ”¶æ–¹ç±»ï¼š\n\n1234567891011class Receiver : public QObject&#123;    Q_OBJECTpublic slots:    // å®šä¹‰ä¸€ä¸ªæ¥æ”¶ int ç±»å‹æ•°æ®çš„ slot    void receiveNumber(int number)    &#123;        qDebug() &lt;&lt; &quot;Received number:&quot; &lt;&lt; number;    &#125;&#125;;\n\n\nè¿æ¥ä¿¡å·å’Œæ’æ§½ï¼š\n\n123456789// åˆ›å»ºå®ä¾‹ï¼ˆæˆ–ä½¿ç”¨ç°æœ‰å®ä¾‹ï¼‰Sender sender;Receiver receiver;// è¿æ¥ Sender çš„ numberSent(int) ä¿¡å·åˆ° Receiver çš„ receiveNumber(int) æ§½QObject::connect(&amp;sender, &amp;Sender::numberSent, &amp;receiver,Receiver::receiveNumber);// å‘é€æ•°æ®sender.sendNumber(42); // receiver å°†ä¼šè¾“å‡º &quot;Received number: 42&quot;\n\nè¿™é‡Œï¼ŒSender ç±»å®šä¹‰äº†ä¸€ä¸ªå‘é€ int ç±»å‹æ•°æ®çš„ signalï¼ˆnumberSentï¼‰ï¼Œå¹¶å‘ä¿¡å·å‘å°„å™¨å‘é€è¯¥æ•°å€¼ã€‚Receiver ç±»å®šä¹‰äº†ä¸€ä¸ªæ¥æ”¶ int ç±»å‹æ•°æ®çš„ slotï¼ˆreceiveNumberï¼‰ï¼Œå¹¶åœ¨å…¶æ’æ§½å‡½æ•°ä¸­æ‰“å°è¯¥æ•°æ®ã€‚\næœ€åï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªå¯¹è±¡è¿æ¥èµ·æ¥ï¼Œå½“ Sender ç±»è°ƒç”¨ sendNumber() å‘é€æ•°å­—æ—¶ï¼Œconnect() å‡½æ•°ä¼šå°†å®ƒè¿æ¥åˆ° Receiver ç±»çš„ receiveNumber() slotï¼Œä»è€Œå®ç°äº†å¯¹è±¡é—´çš„é€šä¿¡ã€‚\n\nåœ¨ Qt ä¸­ï¼Œå¦‚ä½•å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Qt Network æ¨¡å—å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œå¹¶å‘é€å’Œæ¥æ”¶å„ç§åè®®çš„æ•°æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Qt Network æ¨¡å—å‘é€ HTTP GET è¯·æ±‚ï¼š\n12345678910111213141516171819202122232425262728293031323334353637#include &lt;QCoreApplication&gt;#include &lt;QtNetwork/QNetworkAccessManager&gt;#include &lt;QtNetwork/QNetworkReply&gt;#include &lt;Network/QNetworkRequest&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ª QNetworkAccessManager å®ä¾‹    QNetworkAccessManager manager;    // å®ä¾‹åŒ–è¯·æ±‚å¯¹è±¡    QNetworkRequest request;    request.setUrl(QUrl(&quot;http://www.example.com&quot;));    // å‘é€ GET è¯·æ±‚    QNetworkReply *reply = manager.get(request);    // å£°æ˜å¤„ç†æ•°æ®å®Œæˆçš„æ§½    QObject::connect(reply, &amp;QNetworkReply::finished, [&amp;]() &#123;        // å¤„ç†è¿”å›çš„æ•°æ®        if (reply-&gt;error() == QNetworkReply::NoError) &#123;            QString data = QString(reply-&gt;readAll());            qDebug() &lt;&lt; data;        &#125;        else &#123;            qDebug() &lt;&lt; &quot;Network error:&quot; &lt;&lt; reply-&gt;errorString();        &#125;        // é‡Šæ”¾èµ„æº        reply-&gt;deleteLater();        a.quit();    &#125;);    return a.exec();&#125;\n\næ³¨æ„ï¼šåœ¨å¤„ç†ç½‘ç»œè¯·æ±‚æ—¶ï¼Œè¯·å°†å…¶æ”¾åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­ï¼Œä»¥é¿å…é˜»å¡ä¸»å¾ªç¯å’Œå¯èƒ½çš„æ€§èƒ½é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨ QThread ä¹‹ç±»çš„ Qt ç±»æ¥å¤„ç†å¤šçº¿ç¨‹è¯·æ±‚ã€‚18. åœ¨ Qt ä¸­ï¼Œå¦‚ä½•ä½¿ç”¨æ•°æ®åº“ï¼Ÿ\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QSqlDatabase ç±»è¿æ¥å’Œæ“ä½œæ•°æ®åº“ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Qt è¿æ¥ SQLite æ•°æ®åº“ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839#include &lt;QCoreApplication&gt;#include &lt;QtSql&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åœ¨é»˜è®¤ä½ç½®åˆ›å»ºæ•°æ®åº“è¿æ¥    QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);    db.setDatabaseName(&quot;myDb.db&quot;);    // æ‰“å¼€æ•°æ®åº“åè¿›è¡Œæ“ä½œ    if (db.open()) &#123;        QSqlQuery query;        // å»ºç«‹è¡¨æ ¼        query.exec(&quot;CREATE TABLE people (id INTEGER PRIMARY KEY, name TEXT)&quot;);        // æ’å…¥æ•°æ®        query.exec(&quot;INSERT INTO people VALUES(1, &#x27;Tom&#x27;)&quot;);        query.exec(&quot;INSERT INTO people VALUES(2, &#x27;Jerry&#x27;)&quot;);        // æŸ¥è¯¢        query.exec(&quot;SELECT id, name FROM people&quot;);        while (query.next()) &#123;            int id = query.value(0).toInt();            QString name = query.value(1).toString();            qDebug() &lt;&lt; &quot;ID:&quot; &lt;&lt; &lt;&lt; &quot; Name:&quot; &lt;&lt; name;        &#125;        // å…³é—­è¿æ¥        db.close();    &#125;    else &#123;        qDebug() &lt;&lt; &quot;Failed to open database:&quot; &lt;&lt; db.lastError().text();    &#125;    return a.exec();&#125;\n\næ³¨æ„ï¼šåœ¨ä½¿ç”¨ QSqlDatabase ç±»æ—¶ï¼Œè¯·ç¡®ä¿å®‰è£…äº†æ‰€éœ€çš„é©±åŠ¨ç¨‹åºï¼ˆä¾‹å¦‚ï¼ŒSQLite éœ€è¦ Qt è‡ªå¸¦çš„ SQLite é©±åŠ¨ï¼‰ã€‚å¦å¤–è¯·æ³¨æ„ï¼ŒDatabase ä½¿ç”¨å¤§é‡çš„èµ„æºã€‚å½“æ‚¨ä¸å†éœ€è¦å®ƒæ—¶ï¼Œè¯·è®°å¾—å…³é—­&#x2F;åˆ é™¤è¿æ¥ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼å’Œæ€§èƒ½é—®é¢˜ã€‚\n\nåœ¨ Qt ä¸­ï¼Œå¦‚ä½•è¿›è¡Œå¤šè¯­è¨€æ”¯æŒï¼Ÿ\n\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QTranslator ç±»å®ç°åº”ç”¨ç¨‹åºçš„å¤šè¯­è¨€æ”¯æŒã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å°†æ­¤åŠŸèƒ½æ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ï¼š\n\nä½¿ç”¨ Qt Linguist åˆ›å»ºç¿»è¯‘æ–‡ä»¶\n\né¦–å…ˆï¼Œæ‚¨éœ€è¦ä½¿ç”¨ Qt Linguist å·¥å…·åˆ›å»ºç¿»è¯‘æ–‡ä»¶ (.ts)ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æ‰€æœ‰éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬å­—ç¬¦ä¸²å’Œå…¶å¯¹åº”çš„ç¿»è¯‘ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Qt Creator ç¼–è¾‘å™¨çš„ä¸€éƒ¨åˆ†æ¥æ‰“å¼€å’Œç¼–è¾‘ .ts æ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…· lupdate å’Œ linguist æ¥ç”Ÿæˆå’Œç¼–è¾‘å®ƒä»¬ã€‚\n\nåŠ è½½ç¿»è¯‘æ–‡ä»¶\n\nåœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QTranslator ç±»åŠ è½½ .qm ç¿»è¯‘æ–‡ä»¶ ï¼ˆä» .ts æ–‡ä»¶ç¼–è¯‘è€Œå¾—ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªé’ˆå¯¹è‹±æ–‡å’Œè¥¿ç­ç‰™æ–‡ç¿»è¯‘æ”¯æŒçš„ç®€å•ç¤ºä¾‹ï¼š\n123456789101112131415161718#include &lt;QCoreApplication&gt;#include &lt;QTranslator&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åŠ è½½ç¿»è¯‘æ–‡ä»¶    QTranslator translator;    if (translator.load(&quot;myapp_es.qm&quot;)) &#123;        a.installTranslator(&amp;translator);    &#125;    // æ‰§è¡Œå…¶ä»–æ“ä½œ    // ...    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åŠ è½½åä¸º myapp_es.qm çš„è¥¿ç­ç‰™è¯­ç¿»è¯‘æ–‡ä»¶ï¼Œå¹¶å°†å®ƒå®‰è£…åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ç„¶åï¼Œå½“æ˜¾ç¤ºæ–‡æœ¬å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä»¬å°†è‡ªåŠ¨ç¿»è¯‘æˆç›¸åº”çš„è¥¿ç­ç‰™è¯­æ–‡æœ¬ã€‚\n\né‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²\n\næœ€åï¼Œè¯·è®°å¾—é‡æ–°ç¼–è¯‘æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶å°† .qm æ–‡ä»¶éƒ¨ç½²åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºå¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¹¶ä½¿ç”¨å®ƒè¿›è¡Œå¤šè¯­è¨€æ”¯æŒã€‚20. åœ¨ Qt ä¸­ï¼Œå¦‚ä½•è¿›è¡Œæ–‡ä»¶å’Œç›®å½•æ“ä½œï¼Ÿ\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QFileã€QDir å’Œ QFileInfo ç­‰ç±»æ¥è¿›è¡Œæ–‡ä»¶å’Œç›®å½•æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼š\n\nåˆ›å»ºæ–‡ä»¶å¹¶å†™å…¥æ•°æ®\n\n1234567891011121314151617#include &lt;QCoreApplication&gt;#include &lt;QFile&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ªåä¸º myFile.txt çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥æ•°æ®    QFile file(&quot;myFile.txt&quot;);    if (file.open(QIODevice::WriteOnly | QIODevice::Text)) &#123;        QTextStream stream(&amp;file);        stream &lt;&lt; &quot;Hello world!&quot;;        file.close();    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ QFile ç±»åˆ›å»ºä¸€ä¸ªåä¸º myFile.txt çš„æ–‡ä»¶ï¼Œå¹¶å‘å®ƒå†™å…¥ â€œHello world!â€ æ–‡æœ¬æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬å…³é—­æ–‡ä»¶ä»¥ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½è¢«å†™å…¥ã€‚\n\nè¯»å–æ–‡ä»¶æ•°æ®\n\n#include #include \nint main(int argc, char *argv[]){    QCoreApplication a(argc, argv);\ntxt// æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è¯»å–å…¶ä¸­çš„æ•°æ®\nQFile file(&quot;myFile.txt&quot;);\nif (file.open(QIODevice::ReadOnly | QIODevice::Text)) &#123;\n    QTextStream stream(&amp;file);\n    QString data = stream.readAll();\n    file.close();\n    qDebug() &lt;&lt; data; // è¾“å‡ºæ–‡ä»¶åŒ…å«çš„æ•°æ®\n&#125;\n\nreturn a.exec();}\n123456789101112131415161718è¿™é‡Œï¼Œæˆ‘ä»¬æ‰“å¼€åä¸º myFile.txt çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ QTextStream ç±»ä»ä¸­è¯»å–æ‰€æœ‰æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ–‡ä»¶ä¸­åŒ…å«çš„æ•°æ®æ‰“å°åˆ°æ§åˆ¶å°ä¸Šä»¥è¿›è¡ŒéªŒè¯ã€‚3. åˆ é™¤æ–‡ä»¶```cpp#include &lt;QCoreApplication&gt;#include &lt;QFile&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ é™¤åä¸º myFile.txt çš„æ–‡ä»¶    QFile::remove(&quot;myFile.txt&quot;);    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ QFile ç±»çš„é™æ€ remove() å‡½æ•°åˆ é™¤åä¸º myFile.txt çš„æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ rename() å‡½æ•°æ¥é‡å‘½åæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ exists() å‡½æ•°æ¥æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚\n\néå†ç›®å½•\n\n1234567891011121314151617181920#include &lt;QCoreApplication&gt;#include &lt;QDir&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // éå†åä¸º myFolder çš„ç›®å½•ï¼Œå¹¶åˆ—ä¸¾å…¶ä¸­æ‰€æœ‰å­æ–‡ä»¶å’Œå­ç›®å½•    QDir dir(&quot;myFolder&quot;);    for (const QFileInfo&amp; info : dir.entryInfoList()) &#123;        if (info.isDir()) &#123;            qDebug() &lt;&lt; &quot;Directory:&quot; &lt;&lt; info.fileName();        &#125;        else &#123;            qDebug() &lt;&lt; &quot;File:&quot; &lt;&lt; info.fileName();        &#125;    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ QDir ç±»æ‰“å¼€åä¸º myFolder çš„ç›®å½•ï¼Œå¹¶ä½¿ç”¨ entryInfoList() å‡½æ•°åˆ—ä¸¾ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥æ¯ä¸ªæ¡ç›®æ˜¯å¦æ˜¯ç›®å½•æˆ–æ–‡ä»¶ï¼Œå¹¶æ‰“å°å®ƒä»¬çš„åç§°åˆ°æ§åˆ¶å°ä¸Šä»¥è¿›è¡ŒéªŒè¯ã€‚21. åœ¨ Qt ä¸­ï¼Œå¦‚ä½•è¿›è¡Œçº¿ç¨‹æ“ä½œï¼Ÿ\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QThread ç±»å’Œ QRunnable æ¥å£æ‰§è¡Œå¤šçº¿ç¨‹ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼š\n\nä½¿ç”¨ QThread æ‰§è¡Œä»»åŠ¡\n\n12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;QCoreApplication&gt;#include &lt;QThread&gt;class MyWorker : public QObject &#123;    Q_OBJECTpublic slots:    void doWork() &#123;        qDebug() &lt;&lt; &quot;Worker thread ID:&quot; &lt;&lt; QThread::currentThread();        // æ‰§è¡Œå…¶ä»–æ“ä½œ        // ...        emit workFinished();    &#125;signals:    void workFinished();&#125;;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹    QThread* thread = new QThread;    // åˆ›å»ºå·¥ä½œå¯¹è±¡ï¼Œå¹¶å°†å…¶ç§»åŠ¨åˆ°æ–°çº¿ç¨‹ä¸­    MyWorker* worker = new MyWorker;    worker-&gt;moveToThread(thread);    // è¿æ¥ä¿¡å·å’Œæ§½ä»¥å¯åŠ¨å·¥ä½œçº¿ç¨‹    QObject::connect(thread, &amp;QThread::started, worker, &amp;MyWorker::doWork);    QObject::connect(worker, &amp;MyWorker::workFinished, thread, &amp;QThread::quit);    QObject::connect(worker, &amp;MyWorker::workFinished, worker, &amp;MyWorker::deleteLater);    QObject::connect(thread, &amp;QThread::finished, thread, &amp;QThread::deleteLater);    // å¯åŠ¨çº¿ç¨‹    thread-&gt;start();    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º MyWorker çš„å·¥ä½œç±»ï¼Œè¯¥ç±»å®ç°äº†ä¸€ä¸ªæ§½å‡½æ•° doWork() æ¥æ‰§è¡Œå·¥ä½œä»»åŠ¡ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª QThread å®ä¾‹ï¼Œå¹¶å°† MyWorker ç§»åŠ¨åˆ°è¿™ä¸ª QThread å®ä¾‹çš„çº¿ç¨‹ä¸­ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°† QThread::started ä¿¡å·è¿æ¥åˆ° MyWorker::doWork ï¼Œä»¥å¯åŠ¨å·¥ä½œçº¿ç¨‹ã€‚å½“å·¥ä½œå®Œæˆæ—¶ï¼ŒMyWorker ä¼šå‘å°„ workFinished ä¿¡å·ï¼Œå¹¶å°†å…¶è¿æ¥åˆ° QThread::quit ä»¥åœæ­¢å·¥ä½œçº¿ç¨‹ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨ QThread::finished ä¿¡å·ä¸Šå°† QThread å®ä¾‹å’Œ MyWorker å®ä¾‹åˆ é™¤ã€‚\n\nä½¿ç”¨ QRunnable æ‰§è¡Œä»»åŠ¡\n\n1234567891011121314151617181920212223#include &lt;QCoreApplication&gt;#include &lt;QThread&gt;#include &lt;QThreadPool&gt;class MyTask : public QRunnable &#123;public:    void run() override &#123;        qDebug() &lt;&lt; &quot;Task thread ID:&quot; &lt;&lt; QThread::currentThread();        // æ‰§è¡Œå…¶ä»–æ“ä½œ        // ...    &#125;&#125;;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡å¹¶æ‰§è¡Œ    MyTask* task = new MyTask;    QThreadPool::globalInstance()-&gt;start(task);    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º MyTask çš„ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡å®ç°äº† QRunnable æ¥å£ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº† MyTask å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ QThreadPool::globalInstance()-&gt;start() å‡½æ•°å°†å…¶æäº¤åˆ°å…¨å±€çº¿ç¨‹æ± ä¸­ä»¥å¼‚æ­¥æ‰§è¡Œã€‚\næ³¨æ„ï¼šå¦‚æœæ‚¨æƒ³æ§åˆ¶çº¿ç¨‹æ± çš„è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ QThreadPool ç±»çš„å…¶ä»–å‡½æ•°ã€‚ä¾‹å¦‚ï¼ŒsetMaxThreadCount() å‡½æ•°å¯ç”¨äºè®¾ç½®æœ€å¤§çº¿ç¨‹æ•°ï¼ŒreleaseThread() å‡½æ•°å¯é‡Šæ”¾ç©ºé—²çš„çº¿ç¨‹èµ„æºï¼Œç­‰ç­‰ã€‚22. åœ¨ Qt ä¸­ï¼Œå¦‚ä½•è¿›è¡Œç½‘ç»œç¼–ç¨‹ï¼Ÿ\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QTcpServerã€QTcpSocketã€QUdpSocket å’Œ QSslSocket ç­‰ç±»æ¥è¿›è¡Œç½‘ç»œç¼–ç¨‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼š\n\nTCP æœåŠ¡å™¨\n\n1234567891011121314151617181920212223242526272829303132#include &lt;QCoreApplication&gt;#include &lt;QTcpServer&gt;#include &lt;QTcpSocket&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ª TCP æœåŠ¡å™¨    QTcpServer server;    // ç»‘å®šæœåŠ¡å™¨åˆ°æœ¬æœºåœ°å€å’Œç«¯å£    if (server.listen(QHostAddress::LocalHost, 12345)) &#123;        qDebug() &lt;&lt; &quot;Listening for incoming connections on port 12345...&quot;;        // æ¥å—ä¼ å…¥è¿æ¥        while (server.isListening()) &#123;            QTcpSocket* client = server.nextPendingConnection();            qDebug() &lt;&lt; &quot;New client connected from:&quot; &lt;&lt; client-&gt;peerAddress() &lt;&lt; &quot;:&quot; &lt;&lt; client-&gt;peerPort();            // å‘å®¢æˆ·ç«¯å‘é€æ¬¢è¿æ¶ˆæ¯            client-&gt;write(&quot;Welcome to my server!&quot;);            client-&gt;flush();            // æ¥æ”¶å¹¶æ˜¾ç¤ºæ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯            QByteArray data = client-&gt;readAll();            qDebug() &lt;&lt; &quot;Client message:&quot; &lt;&lt; data;        &#125;    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª TCP æœåŠ¡å™¨ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°æœ¬æœºåœ°å€ï¼ˆ127.0.0.1ï¼‰å’Œç«¯å£ 12345ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ nextPendingConnection() å‡½æ•°é˜»å¡ç­‰å¾…ä¼ å…¥è¿æ¥ï¼Œå¹¶æ˜¾ç¤ºè¿æ¥å®¢æˆ·ç«¯çš„åœ°å€å’Œç«¯å£ã€‚é€šè¿‡ client-&gt;write() å‡½æ•°å‘å®¢æˆ·å‘é€æ¬¢è¿æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨ readAll() å‡½æ•°æ¥æ”¶å¹¶æ˜¾ç¤ºæ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ QTcpSocket ç±»å®ç°å®¢æˆ·ç«¯ã€‚\n\nUDP å®¢æˆ·ç«¯\n\n123456789101112131415161718#include &lt;QCoreApplication&gt;#include &lt;QUdpSocket&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ª UDP å¥—æ¥å­—    QUdpSocket socket;    // å‘æœ¬åœ°ä¸»æœº 12345 ç«¯å£å‘é€æ•°æ®æŠ¥    QByteArray data = &quot;Hello, world!&quot;;    QHostAddress addr(&quot;127.0.0.1&quot;);    quint16 port = 12345;    socket.writeDatagram(data, addr, port);    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª QUdpSocket å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ writeDatagram() å‡½æ•°å‘æœ¬åœ°ä¸»æœºï¼ˆ127.0.0.1ï¼‰å’Œç«¯å£ 12345 å‘é€ Hello, world! æ•°æ®æŠ¥ã€‚æ‚¨å¯ä»¥åœ¨å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ QUdpSocket ç±»ä»¥æ¥æ”¶è¿™ä¸ªæ•°æ®åŒ…æˆ–é€šè¿‡å…¶ä»–æ–¹å¼ä¸å®ƒè¿›è¡Œé€šä¿¡ã€‚\n\nSSL å®¢æˆ·ç«¯\n\n123456789101112131415161718192021222324252627282930#include &lt;QCoreApplication&gt;#include &lt;QSslSocket&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    // åˆ›å»ºä¸€ä¸ª SSL è¿æ¥å¥—æ¥å­—    QSslSocket socket;    // è¿æ¥åˆ° SSL æœåŠ¡å™¨    socket.connectToHostEncrypted(&quot;mysslserver.com&quot;, 443);    if (socket.waitForEncrypted()) &#123;        qDebug() &lt;&lt; &quot;SSL handshake successful.&quot;;        // å‘é€å’Œæ¥æ”¶æ•°æ®        socket.write(&quot;GET / HTTP/1.0\\r\\n\\r\\n&quot;);        socket.flush();        while (socket.waitForReadyRead()) &#123;            qDebug() &lt;&lt; socket.readAll();        &#125;    &#125;    else &#123;        qDebug() &lt;&lt; &quot;SSL handshake failed:&quot; &lt;&lt; socket.errorString();    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº† QSslSocket å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ connectToHostEncrypted() å‡½æ•°è¿æ¥åˆ°åä¸º mysslserver.com çš„ SSL æœåŠ¡å™¨çš„ç«¯å£ 443ã€‚å¦‚æœ SSL æ¡æ‰‹æˆåŠŸï¼Œåˆ™ä½¿ç”¨ write()ã€flush() å’Œ readAll() å‡½æ•°å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ QSslSocket å®ç° SSL æœåŠ¡å™¨ã€‚è¯·æ³¨æ„ï¼Œä¸ºäº†ä½¿ SSL æ¡æ‰‹å°½å¯èƒ½å¹³æ»‘ï¼Œæœ€å¥½ä½¿ç”¨ QApplication è€Œä¸æ˜¯ QCoreApplication ç±»ä½œä¸º Qt åº”ç”¨ç¨‹åºçš„å­ç±»ï¼Œå¹¶æä¾›ä¸Šä¸‹æ–‡ä»¥æ”¯æŒè¯ä¹¦éªŒè¯ã€‚23. åœ¨ Qt ä¸­ï¼Œå¦‚ä½•è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Ÿ\nåœ¨ Qt ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ QSqlDatabaseã€QSqlQuery å’Œ QSqlTableModel ç­‰ç±»æ¥è¿›è¡Œæ•°æ®åº“æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ï¼š\n\nè¿æ¥åˆ° SQLite æ•°æ®åº“å¹¶æ‰§è¡ŒæŸ¥è¯¢\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;QCoreApplication&gt;#include &lt;QSqlDatabase&gt;#include &lt;QSqlError&gt;#include &lt;QSqlQuery&gt;int main(int argc, char *argv[])&#123;    QCoreApplication a(argc, argv);    QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);    db.setDatabaseName(&quot;mydatabase.db&quot;);    if (db.open()) &#123;        qDebug() &lt;&lt;Database connection established.&quot;;        QSqlQuery query;        query.exec(&quot;CREATE TABLE IF NOT EXISTS mytable (&quot;                   &quot;  id INTEGER PRIMARY KEY,&quot;                   &quot;  name TEXT NOT NULL,&quot;                   &quot;  age INTEGER);&quot;);        if (query.isActive()) &#123;            qDebug() &lt;&lt; &quot;Table created successfully.&quot;;        &#125;        else &#123;            qDebug() &lt;&lt; &quot;Table creation failed:&quot; &lt;&lt; query.lastError().text();        &#125;        // æ’å…¥æ•°æ®è®°å½•        query.prepare(&quot;INSERT INTO mytable (name, age) VALUES (?, ?)&quot;);        query.bindValue(0, &quot;John Doe&quot;);        query.bindValue(1, 25);        if (query.exec()) &#123;            qDebug() &lt;&lt; &quot;Record inserted successfully.&quot;;        &#125;        else &#123;            qDebug() &lt;&lt; &quot;Record insertion failed:&quot; &lt;&lt; query.lastError().text();        &#125;        // æ‰§è¡ŒæŸ¥è¯¢        if (query.exec(&quot;SELECT * FROM mytable&quot;)) &#123;            while (query.next()) &#123;                int id = query.value(0).toInt();                QString name = query.value(1).toString();                int age = query.value(2).toInt();                qDebug() &lt;&lt; &quot;ID:&quot; &lt;&lt; id &lt;&lt; &quot;Name:&quot; &lt;&lt; name &lt;&lt; &quot;Age:&quot; &lt;&lt; age;            &#125;        &#125;        else &#123;            qDebug() &lt;&lt; &quot;Query execution failed:&quot; &lt;&lt;.lastError().text();        &#125;    &#125;    else &#123;        qDebug() &lt;&lt; &quot;Database connection failed:&quot; &lt;&lt;.lastError().text();    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ addDatabase() å‡½æ•°æ·»åŠ ä¸€ä¸ª SQLite æ•°æ®åº“ï¼Œå¹¶ä½¿ç”¨ setDatabaseName() å‡½æ•°è®¾ç½®æ•°æ®åº“æ–‡ä»¶è·¯å¾„ã€‚ç„¶åï¼Œæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ•°æ®åº“å¹¶æ‰§è¡Œä¸€ä¸ª SQL æŸ¥è¯¢ä»¥åˆ›å»ºä¸€ä¸ªåä¸º mytable çš„æ•°æ®è¡¨ã€‚å¦‚æœæŸ¥è¯¢æˆåŠŸï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªæ–°çš„è®°å½•æ’å…¥åˆ°è¯¥æ•°æ®è¡¨ä¸­ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰§è¡Œå¦ä¸€ä¸ª SQL æŸ¥è¯¢ä»¥è¯»å– mytable ä¸­çš„æ•°æ®è¡Œï¼Œå¹¶ä½¿ç”¨ next() å‡½æ•°å‘å‰éå†ç»“æœé›†ã€‚æœ€åï¼Œæˆ‘ä»¬ä»æ¯ä¸€è¡Œä¸­æå–ä¸‰ä¸ªæ•´æ•°å€¼å¹¶æ‰“å°å…¶ IDã€å§“åå’Œå¹´é¾„ã€‚\n\né€šè¿‡ QSqlTableModel ç›´æ¥æ“ä½œæ•°æ®è¡¨\n\n12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;QCoreApplication&gt;#include &lt;QSqlDatabase&gt;#include &lt;QSqlError&gt;#include &lt;QSqlTableModel&gt;#include &lt;QDebug&gt;int main(int argc, char *argv[])    QCoreApplication a(argc, argv);    QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);    db.setDatabaseName(&quot;mydatabase.db&quot;);    if (db.open()) &#123;        qDebug() &lt;&lt; &quot;Database connection established.&quot;;        // åˆ›å»ºæ¨¡å‹å¹¶ç»‘å®šåˆ°æ•°æ®è¡¨        QSqlTableModel model;        model.setTable(&quot;mytable&quot;);        // æ·»åŠ æ–°è¡Œ        model.insertRows(0, 1);        model.setData(model.index(0, 1), &quot;Jane Smith&quot;);        model.setData(model.index(0, 2), 30);        model.submitAll();        // æ˜¾ç¤ºæ‰€æœ‰è¡Œ        model.select();        for (int row = 0; row &lt; model.rowCount(); ++row) &#123;            int id = model.index(row, 0).data().toInt();            QString name = model.index(row, 1).data().toString();            int age = model.index(row, 2).data().toInt();            qDebug() &lt;&lt; &quot;ID:&quot; &lt;&lt; id &lt;&lt; &quot;Name:&quot; &lt;&lt; name &lt;&lt; &quot;Age:&quot; &lt;&lt; age;        &#125;    &#125;    else &#123;        qDebug() &lt;&lt; &quot;Database connection failed:&quot; &lt;&lt; db.lastError().text();    &#125;    return a.exec();&#125;\n\nè¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨ addDatabase() å‡½æ•°æ·»åŠ  SQLite æ•°æ®åº“ï¼Œç„¶åæ‰“å¼€å®ƒã€‚æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª QSqlTableModel å®ä¾‹ï¼Œå°†å…¶ç»‘å®šåˆ° mytable æ•°æ®è¡¨ï¼Œå¹¶æ’å…¥ä¸€è¡Œæ–°çš„æ•°æ®è®°å½•ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ select() å‡½æ•°æŸ¥è¯¢æ•´ä¸ªæ•°æ®è¡¨å¹¶æ˜¾ç¤ºæ‰€æœ‰è¡Œçš„ IDã€å§“åå’Œå¹´é¾„ã€‚\né€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæ‚¨å°±å¯ä»¥åœ¨ Qt ä¸­è¿æ¥åˆ°æ•°æ®åº“ã€æ‰§è¡ŒæŸ¥è¯¢å’Œæ“ä½œæ•°æ®è¡¨ã€‚\n","slug":"Qt/è¿›é˜¶æ•™ç¨‹/Qté¢è¯•é¢˜é›†åˆ","date":"2021-06-13T08:23:29.000Z","categories_index":"Qtè¿›é˜¶æ•™ç¨‹,Qté¢è¯•é¢˜","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5d28961e81afaf3d71dc0378d856ba40","title":"Qtåº”ç”¨ç¨‹åºä¸­çš„ QApplication","content":"Qtåº”ç”¨ç¨‹åºä¸­çš„ QApplicationQApplicationç±»æ˜¯ä¸€ä¸ªQtæ¡†æ¶ä¸­æ ¸å¿ƒçš„åº”ç”¨ç¨‹åºç±»ï¼Œå®ƒæä¾›äº†ç®¡ç†åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€äº‹ä»¶å¾ªç¯å’Œç³»ç»Ÿçº§é…ç½®çš„åŸºç¡€ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»QApplicationç±»çš„åŠŸèƒ½å’Œåº”ç”¨åœºæ™¯ã€‚\nåˆ›å»º QApplication å¯¹è±¡é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨ä¸»å‡½æ•°ä¸­åˆ›å»º QApplication å¯¹è±¡ã€‚åœ¨åˆ›å»ºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€äº›å‘½ä»¤è¡Œé€‰é¡¹å’Œç‰¹å®šäºå¹³å°çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ç»™å‡ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„QApplicationå¯¹è±¡ï¼š\n1234567#include &lt;QApplication&gt;    // å¿…éœ€å¤´æ–‡ä»¶int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);   // åˆ›å»ºQApplicationå¯¹è±¡    ...    return app.quit();&#125;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åŒ…å«å¿…éœ€çš„QApplicationå¤´æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œappâ€çš„æ–°QApplicationå¯¹è±¡ã€‚æ­¤å¯¹è±¡å°†æ¥ç®¡åº”ç”¨ç¨‹åºçš„æ§åˆ¶æƒï¼Œå¹¶å¯åŠ¨åŸºæœ¬çš„äº‹ä»¶å¾ªç¯ï¼Œä»¥ä¾¿å¤„ç†ç”¨æˆ·æ“ä½œæˆ–å…¶ä»–ç³»ç»Ÿäº‹ä»¶ã€‚\nå¤„ç†åº”ç”¨ç¨‹åºå…¨å±€äº‹ä»¶QApplicationç±»æä¾›äº†è®¸å¤šæ–¹æ³•æ¥é’ˆå¯¹åº”ç”¨ç¨‹åºå…¨å±€äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚è¿™é‡Œåˆ—ä¸¾äº†ä¸€äº›æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼š\n\nexec(): å¯åŠ¨ä¸€ä¸ªåŸºç¡€çš„åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œç”¨äºç®¡ç†åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸå’Œå…¶ä¸ç”¨æˆ·äº¤äº’çš„æ–¹å¼ã€‚\nquit(): é€€å‡ºåº”ç”¨ç¨‹åºã€‚\nprocessEvents(): æ­¤æ–¹æ³•å…è®¸åº”ç”¨ç¨‹åºè½®è¯¢äº‹ä»¶é˜Ÿåˆ—å¹¶è§¦å‘äº‹ä»¶å¤„ç†ç¨‹åºã€‚\nsendEvent(): å‘é€ä¸€ä¸ªç‰¹å®šäº‹ä»¶åˆ°ç›®æ ‡å¯¹è±¡ã€‚\npostEvent(): åœ¨åº”ç”¨ç¨‹åºä¸»å¾ªç¯ä¸­å°†äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°ä¸‹æ¬¡è°ƒç”¨processEvents()æˆ–exec()ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨QApplicationå…¨å±€äº‹ä»¶å¤„ç†ç¨‹åºï¼š\n123456789101112#include &lt;QApplication&gt;    // å¿…éœ€å¤´æ–‡ä»¶int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);   // åˆ›å»ºQApplicationå¯¹è±¡        // åŠ è½½å¹¶æ˜¾ç¤ºçª—å£    QWidget myWidget;    myWidget.show();        // è¿›å…¥ä¸»äº‹ä»¶å¾ªç¯    return app.exec();&#125;\n\nåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„QApplicationå¯¹è±¡åä¸ºâ€œappâ€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­åŠ è½½QWidgetå¯¹è±¡â€œmyWidgetâ€ï¼Œå¹¶è°ƒç”¨å…¶show()æ–¹æ³•ä»¥ä½¿å…¶åœ¨å±å¹•ä¸Šå¯è§ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨app.exec()æ–¹æ³•è¿›å…¥åº”ç”¨ç¨‹åºä¸»äº‹ä»¶å¾ªç¯ï¼Œå¤„ç†ç”¨æˆ·æ“ä½œå’Œå…¶ä»–ä¸€äº›ç³»ç»Ÿäº‹ä»¶ã€‚\nå¤„ç†åº”ç”¨ç¨‹åºå‘½ä»¤è¡Œå‚æ•°QApplicationç±»æä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥é’ˆå¯¹åº”ç”¨ç¨‹åºå‘½ä»¤è¡Œå‚æ•°è¿›è¡Œå¤„ç†ã€‚è¿™äº›å‘½ä»¤è¡Œé€‰é¡¹å¯ä»¥åœ¨å¯åŠ¨æ—¶é€šè¿‡main()å‡½æ•°ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼š\n12345678910#include &lt;QApplication&gt;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    ...    if (app.arguments().contains(&quot;--debug&quot;))        qDebug() &lt;&lt; &quot;Running in debug mode!&quot;;    ...    return app.exec();&#125;\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„QApplicationå¯¹è±¡â€œappâ€ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨arguments()æ–¹æ³•æ¥è·å–ä»main()å‡½æ•°æ¥æ”¶åˆ°çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¦‚æœåŒ…å«å­—ç¬¦ä¸²â€œâ€“debugâ€ï¼Œåˆ™è¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€‚\nå¤„ç†åº”ç”¨ç¨‹åºå…¨å±€è®¾ç½®QApplicationè¿˜æä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥å¤„ç†åº”ç”¨ç¨‹åºå…¨å±€è®¾ç½®ã€‚è¿™å…è®¸æ‚¨å®šä¹‰åº”ç”¨ç¨‹åºåœ¨ä¸åŒç³»ç»Ÿä¸Šå¦‚ä½•è¿è¡Œä»¥åŠå…¶å¤–è§‚ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸€äº›æœ€é‡è¦å’Œå¸¸ç”¨çš„æ–¹æ³•ï¼š\n\nsetApplicationName() &#x2F; applicationName(): è®¾ç½®æˆ–è·å–åº”ç”¨ç¨‹åºåç§°ã€‚\nsetApplicationVersion() &#x2F; applicationVersion(): è®¾ç½®æˆ–è·å–åº”ç”¨ç¨‹åºç‰ˆæœ¬å·ã€‚\nsetOrganizationDomain() &#x2F; organizationDomain(): è®¾ç½®æˆ–è·å–ç»„ç»‡åŸŸåã€‚\nsetOrganizationName() &#x2F; organizationName(): è®¾ç½®æˆ–è·å–ç»„ç»‡åç§°ã€‚\nsetStyleSheet() &#x2F; styleSheet(): è®¾ç½®æˆ–è·å–åº”ç”¨ç¨‹åºæ ·å¼è¡¨ã€‚\n\nè¿™äº›æ–¹æ³•å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿›è¡Œä½¿ç”¨ï¼š\n123456789101112131415161718#include &lt;QApplication&gt;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    // è®¾ç½®åº”ç”¨ç¨‹åºæ ‡é¢˜å’Œå›¾æ ‡    app.setApplicationDisplayName(&quot;My Application&quot;);    app.setWindowIcon(QIcon(&quot;:/icons/myicon.png&quot;));    // è®¾ç½®åº”ç”¨ç¨‹åºå…¨å±€æ ·å¼è¡¨    QFile file(&quot;:/themes/mytheme.qss&quot;);    if (file.open(QIODevice::ReadOnly)) &#123;        QString styleSheet = QLatin1String(file.readAll());        app.setStyleSheet(styleSheet);    &#125;    return app.exec();&#125;\n\nåœ¨æ­¤ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„QApplicationå¯¹è±¡â€œappâ€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¾ç½®åº”ç”¨ç¨‹åºåç§°å’Œçª—å£å›¾æ ‡ï¼Œä»¥æ”¹å–„UIè®¾è®¡ã€‚æœ€åï¼Œæˆ‘ä»¬åŠ è½½å¹¶è®¾ç½®åº”ç”¨ç¨‹åºçš„å…¨å±€æ ·å¼è¡¨ï¼Œä»¥è®©ç”¨æˆ·ç•Œé¢çœ‹èµ·æ¥æ›´æ•´æ´ã€‚\n","slug":"Qt/åŸºç¡€æ•™ç¨‹/Qtåº”ç”¨ç¨‹åºä¸­çš„ QApplication","date":"2021-06-05T08:34:06.000Z","categories_index":"QtåŸºç¡€æ•™ç¨‹","tags_index":"Qt","author_index":"é˜¿æœ¨å¤§å”"},{"id":"7e72488827dc1c1de5e7eda02fcbe24e","title":"ã€è½¬è½½ã€‘C++17ç»“æ„åŒ–ç»‘å®š","content":"C++ 17 ç»“æ„åŒ–ç»‘å®šstl çš„ map å®¹å™¨å¾ˆå¤šè¯»è€…åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰ï¼Œmap å®¹å™¨æä¾›äº†ä¸€ä¸ª insert æ–¹æ³•ï¼Œæˆ‘ä»¬ç”¨è¯¥æ–¹æ³•å‘ map ä¸­æ’å…¥å…ƒç´ ï¼Œä½†æ˜¯åº”è¯¥å¾ˆå°‘æœ‰äººè®°å¾— insert æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆç±»å‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ C++98&#x2F;03 æä¾›çš„ insert æ–¹æ³•çš„ç­¾åï¼š\n1std::pair&lt;iterator,bool&gt; insert( const value_type&amp; value );\n\nè¿™é‡Œæˆ‘ä»¬ä»…å…³å¿ƒå…¶è¿”å›å€¼ï¼Œè¿™ä¸ªè¿”å›å€¼æ˜¯ä¸€ä¸ª std::pair ç±»å‹ï¼Œç”±äº map ä¸­çš„å…ƒç´ çš„ key ä¸å…è®¸é‡å¤ï¼Œæ‰€ä»¥å¦‚æœ insert æ–¹æ³•è°ƒç”¨æˆåŠŸï¼ŒT1 æ˜¯è¢«æˆåŠŸæ’å…¥åˆ° map ä¸­çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼ŒT2 çš„ç±»å‹ä¸º boolï¼Œæ­¤æ—¶å…¶å€¼ä¸º trueï¼ˆè¡¨ç¤ºæ’å…¥æˆåŠŸï¼‰ï¼›å¦‚æœ insert ç”±äº key é‡å¤ï¼ŒT1 æ˜¯é€ æˆ insert æ’å…¥å¤±è´¥ã€å·²ç»å­˜åœ¨äº map ä¸­çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ­¤æ—¶ T2 çš„å€¼ä¸º falseï¼ˆè¡¨ç¤ºæ’å…¥å¤±è´¥ï¼‰ã€‚\nåœ¨ C++98&#x2F;03 æ ‡å‡†ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ std::pair çš„ first å’Œ second å±æ€§æ¥åˆ†åˆ«å¼•ç”¨ T1 å’Œ T2 çš„å€¼ã€‚å¦‚ä¸‹é¢çš„æˆ‘ä»¬ç†Ÿæ‚‰çš„ä»£ç æ‰€ç¤ºï¼š\n123456789101112131415161718192021222324252627#include &lt;iostream&gt;#include &lt;string&gt;#include &lt;map&gt;int main()&#123;    std::map&lt;std::string, int&gt; cities;    cities[&quot;beijing&quot;]   = 0;    cities[&quot;shanghai&quot;]  = 1;    cities[&quot;shenzhen&quot;]  = 2;    cities[&quot;guangzhou&quot;] = 3;    //for (const auto&amp; [key, value] : m)    //&#123;    //    std::cout &lt;&lt; key &lt;&lt; &quot;: &quot; &lt;&lt; value &lt;&lt; std::endl;    //&#125;    //è¿™ä¸€è¡Œåœ¨ C++11 ä¹‹å‰å†™æ³•å®åœ¨å¤ªéº»çƒ¦äº†ï¼Œ    //std::pair&lt;std::map&lt;std::string, int&gt;::iterator, int&gt; insertResult = cities.insert(std::pair&lt;std::string, int&gt;(&quot;shanghai&quot;, 2));    //C++ 11ä¸­æˆ‘ä»¬å†™æˆï¼š    auto insertResult = cities.insert(std::pair&lt;std::string, int&gt;(&quot;shanghai&quot;, 2));    std::cout &lt;&lt; &quot;Is insertion successful ? &quot; &lt;&lt; (insertResult.second ? &quot;true&quot; : &quot;false&quot;)               &lt;&lt; &quot;, element key: &quot; &lt;&lt; insertResult.first-&gt;first &lt;&lt; &quot;, value: &quot; &lt;&lt; insertResult.first-&gt;second &lt;&lt; std::endl;    return 0;&#125;\n\nä»£ç  19 è¡Œå®åœ¨å¤ªå•°å—¦äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ auto å…³é”®å­—è®©ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼ç±»å‹ã€‚\nstd::pair ä¸€èˆ¬åªèƒ½è¡¨ç¤ºä¸¤ä¸ªå…ƒç´ ï¼ŒC++11 æ ‡å‡†ä¸­å¼•å…¥äº† std::tuple ç±»å‹ï¼Œæœ‰äº†è¿™ä¸ªç±»å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¾ä»»æ„ä¸ªå…ƒç´ äº†ï¼ŒåŸæ¥éœ€è¦å®šä¹‰æˆç»“æ„ä½“çš„ POD å¯¹è±¡æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ std::tuple è¡¨ç¤ºï¼Œä¾‹å¦‚ä¸‹é¢è¡¨ç¤ºç”¨æˆ·ä¿¡æ¯çš„ç»“æ„ä½“ï¼š\n1234567891011121314151617181920struct UserInfo&#123;    std::string username;    std::string password;    int         gender;    int         age;    std::string address;&#125;;int main()&#123;    UserInfo userInfo = &#123; &quot;Tom&quot;, &quot;123456&quot;, 0, 25, &quot;Pudong Street&quot; &#125;;    std::string username = userInfo.username;    std::string password = userInfo.password;    int gender = userInfo.gender;    int age = userInfo.age;    std::string address = userInfo.address;    return 0;&#125;\n\næˆ‘ä»¬ä¸å†éœ€è¦å®šä¹‰ struct UserInfo è¿™æ ·çš„å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ std::tuple è¡¨ç¤ºï¼š\n123456789101112int main()&#123;        std::tuple&lt;std::string, std::string, int, int, std::string&gt; userInfo(&quot;Tom&quot;, &quot;123456&quot;, 0, 25, &quot;Pudong Street&quot;);    std::string username = std::get&lt;0&gt;(userInfo);    std::string password = std::get&lt;1&gt;(userInfo);    int gender = std::get&lt;2&gt;(userInfo);    int age = std::get&lt;3&gt;(userInfo);    std::string address = std::get&lt;4&gt;(userInfo);    return 0;&#125;\n\nä» std::tuple ä¸­è·å–å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬ä½¿ç”¨ std::get ï¼Œå…¶ä¸­ N æ˜¯å…ƒç´ çš„åºå·ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚\nä¸å®šä¹‰ç»“æ„ä½“ç›¸æ¯”ï¼Œé€šè¿‡ std::pair çš„ first å’Œ second è¿˜æ˜¯ std::tuple çš„ std::get æ–¹æ³•æ¥è·å–å…ƒç´ å­å±æ€§ï¼Œè¿™äº›ä»£ç éƒ½æ˜¯éå¸¸éš¾ä»¥ç»´æŠ¤çš„ï¼Œå…¶æ ¹æœ¬åŸå› æ˜¯ first å’Œ second è¿™æ ·çš„å‘½åä¸èƒ½åšåˆ°è§åçŸ¥æ„ã€‚\nC++17 å¼•å…¥çš„ç»“æ„åŒ–ç»‘å®šï¼ˆStructured Binding ï¼‰å°†æˆ‘ä»¬ä»è¿™ç±»ä»£ç ä¸­è§£æ”¾å‡ºæ¥ã€‚ç»“æ„åŒ–ç»‘å®šä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š\n123auto [a, b, c, ...] = expression;auto [a, b, c, ...] &#123; expression &#125;;auto [a, b, c, ...] ( expression );\n\nå³è¾¹çš„ expression å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€èŠ±æ‹¬å·è¡¨è¾¾å¼æˆ–è€…æ”¯æŒç»“æ„åŒ–ç»‘å®šçš„æŸä¸ªç±»å‹çš„å˜é‡ã€‚ä¾‹å¦‚ï¼š\n12345678910111213//å½¢å¼1auto [iterator, inserted] = someMap.insert(...);//å½¢å¼2double myArray[3] = &#123; 1.0, 2.0, 3.0 &#125;;auto [a, b, c] = myArray;//å½¢å¼3struct Point&#123;    double x;    double y;&#125;;Point myPoint(10.0, 20.0);auto [myX, myY] = myPoint;\n\nè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç”¨äºç»‘å®šåˆ°ç›®æ ‡çš„å˜é‡åï¼ˆè¯­æ³•ä¸­çš„ aã€bã€cï¼‰èµ·ä¸€ä¸ªæœ‰æ„ä¹‰çš„åå­—ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»‘å®šåç§° aã€bã€c æ˜¯ç»‘å®šç›®æ ‡çš„ä¸€ä»½æ‹·è´ï¼Œå½“ç»‘å®šç±»å‹ä¸æ˜¯åŸºç¡€æ•°æ®ç±»å‹æ—¶ï¼Œå¦‚æœä½ çš„æœ¬æ„ä¸æ˜¯æƒ³è¦å¾—åˆ°ç»‘å®šç›®æ ‡çš„å‰¯æœ¬ï¼Œä¸ºäº†é¿å…æ‹·è´å¸¦æ¥çš„ä¸å¿…è¦å¼€é”€ï¼Œå»ºè®®ä½¿ç”¨å¼•ç”¨ï¼Œå¦‚æœä¸éœ€è¦ä¿®æ”¹ç»‘å®šç›®æ ‡å»ºè®®ä½¿ç”¨ const å¼•ç”¨ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\n12345678910double myArray[3] = &#123; 1.0, 2.0, 3.0 &#125;;auto&amp; [a, b, c] = myArray;//å½¢å¼3struct Point&#123;    double x;    double y;&#125;;Point myPoint(10.0, 20.0);const auto&amp; [myX, myY] = myPoint;\n\nç»“æ„åŒ–ç»‘å®šï¼ˆStructured Binding ï¼‰æ˜¯ C++17 å¼•å…¥çš„ä¸€ä¸ªéå¸¸å¥½ç”¨çš„è¯­æ³•ç‰¹æ€§ã€‚æœ‰äº†è¿™ç§è¯­æ³•ï¼Œåœ¨éå†åƒ map è¿™æ ·çš„å®¹å™¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´ç®€æ´å’Œæ¸…æ™°çš„ä»£ç å»éå†è¿™äº›å®¹å™¨äº†ï¼š\n12345678910std::map&lt;std::string, int&gt; cities;cities[&quot;beijing&quot;] = 0;cities[&quot;shanghai&quot;] = 1;cities[&quot;shenzhen&quot;] = 2;cities[&quot;guangzhou&quot;] = 3;for (const auto&amp; [cityName, cityNumber] : cities)&#123;    std::cout &lt;&lt; cityName &lt;&lt; &quot;: &quot; &lt;&lt; cityNumber &lt;&lt; std::endl;&#125;\n\nä¸Šè¿°ä»£ç ä¸­ cityName å’Œ cityNumber å¯ä»¥æ›´å¥½åœ°åæ˜ å‡ºè¿™ä¸ª map å®¹å™¨çš„å…ƒç´ å†…å®¹ã€‚\næˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒæŸ WebSocket ç½‘ç»œåº“ï¼ˆhttps://github.com/uNetworking/uWebSocketsï¼‰ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š\n123456789101112131415161718192021222324std::pair&lt;int, bool&gt; uncork(const char *src = nullptr, int length = 0, bool optionally = false) &#123;        LoopData *loopData = getLoopData();        if (loopData-&gt;corkedSocket == this) &#123;            loopData-&gt;corkedSocket = nullptr;            if (loopData-&gt;corkOffset) &#123;                /* Corked data is already accounted for via its write call */                auto [written, failed] = write(loopData-&gt;corkBuffer, loopData-&gt;corkOffset, false, length);                loopData-&gt;corkOffset = 0;                if (failed) &#123;                    /* We do not need to care for buffering here, write does that */                    return &#123;0, true&#125;;                &#125;            &#125;            /* We should only return with new writes, not things written to cork already */            return write(src, length, optionally, 0);        &#125; else &#123;            /* We are not even corked! */            return &#123;0, false&#125;;        &#125;    &#125;\n\nä»£ç çš„ç¬¬ 9 è¡Œ write å‡½æ•°è¿”å›ç±»å‹æ˜¯ std::pairï¼Œè¢«ç»‘å®šåˆ° [written, failed] è¿™ä¸¤ä¸ªå˜é‡ä¸­å»ã€‚å‰è€…åœ¨å†™å…¥æˆåŠŸçš„æƒ…å†µä¸‹è¡¨ç¤ºå®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼Œåè€…è¡¨ç¤ºæ˜¯å¦å†™å…¥æˆåŠŸã€‚\n123std::pair&lt;int, bool&gt; write(const char *src, int length, bool optionally = false, int nextLength = 0) &#123;    //å…·ä½“å®ç°çœç•¥...&#125;\n\nç»“æ„åŒ–ç»‘å®šçš„é™åˆ¶\nç»“æ„åŒ–ç»‘å®šä¸èƒ½ä½¿ç”¨ constexpr ä¿®é¥°æˆ–è¢«ç”³æ˜ä¸º staticï¼Œä¾‹å¦‚ï¼š\n123456//æ­£å¸¸ç¼–è¯‘auto [first, second] = std::pair&lt;int, int&gt;(1, 2);//æ— æ³•ç¼–è¯‘é€šè¿‡//constexpr auto [first, second] = std::pair&lt;int, int&gt;(1, 2);//æ— æ³•ç¼–è¯‘é€šè¿‡//static auto [first, second] = std::pair&lt;int, int&gt;(1, 2);\n\næ³¨æ„ï¼šæœ‰äº›ç¼–è¯‘å™¨ä¹Ÿä¸æ”¯æŒåœ¨ lamda è¡¨è¾¾å¼æ•è·åˆ—è¡¨ä¸­ä½¿ç”¨ç»“æ„åŒ–ç»‘å®šè¯­æ³•ã€‚\n","slug":"è½¬è½½/cpp/C++17ç»“æ„åŒ–ç»‘å®š","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"674a06ff970318ba143bc66d58326f5d","title":"ã€è½¬è½½ã€‘C++å¿…é¡»æŒæ¡çš„pimplæƒ¯ç”¨æ³•","content":"pimpl æƒ¯ç”¨æ³•ç°åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªåä¸º CSocketClient çš„ç½‘ç»œé€šä¿¡ç±»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960/** * ç½‘ç»œé€šä¿¡çš„åŸºç¡€ç±», SocketClient.h * zhangyl 2017.07.11 */class CSocketClient&#123;public:    CSocketClient();    ~CSocketClient(); public:      void SetProxyWnd(HWND hProxyWnd);    bool    Init(CNetProxy* pNetProxy);    bool    Uninit();        int Register(const char* pszUser, const char* pszPassword);     void GuestLogin();          BOOL    IsClosed();    BOOL\tConnect(int timeout = 3);    void    AddData(int cmd, const std::string&amp; strBuffer);    void    AddData(int cmd, const char* pszBuff, int nBuffLen);    void    Close();    BOOL    ConnectServer(int timeout = 3);    BOOL    SendLoginMsg();    BOOL    RecvLoginMsg(int&amp; nRet);    BOOL    Login(int&amp; nRet);private:    void LoadConfig();    static UINT CALLBACK SendDataThreadProc(LPVOID lpParam);    static UINT CALLBACK RecvDataThreadProc(LPVOID lpParam);    bool Send();    bool Recv();    bool CheckReceivedData();    void SendHeartbeatPackage();private:    SOCKET                          m_hSocket;    short                           m_nPort;    char                            m_szServer[64];    long                            m_nLastDataTime;        //æœ€è¿‘ä¸€æ¬¡æ”¶å‘æ•°æ®çš„æ—¶é—´    long                            m_nHeartbeatInterval;   //å¿ƒè·³åŒ…æ—¶é—´é—´éš”ï¼Œå•ä½ç§’    CRITICAL_SECTION                m_csLastDataTime;       //ä¿æŠ¤m_nLastDataTimeçš„äº’æ–¥ä½“     HANDLE                          m_hSendDataThread;      //å‘é€æ•°æ®çº¿ç¨‹    HANDLE                          m_hRecvDataThread;      //æ¥æ”¶æ•°æ®çº¿ç¨‹    std::string                     m_strSendBuf;    std::string                     m_strRecvBuf;    HANDLE                          m_hExitEvent;    bool                            m_bConnected;    CRITICAL_SECTION                m_csSendBuf;    HANDLE                          m_hSemaphoreSendBuf;    HWND                            m_hProxyWnd;    CNetProxy*                      m_pNetProxy;    int                             m_nReconnectTimeInterval;    //é‡è¿æ—¶é—´é—´éš”    time_t                          m_nLastReconnectTime;        //ä¸Šæ¬¡é‡è¿æ—¶åˆ»    CFlowStatistics*                m_pFlowStatistics;&#125;;\n\nè¿™æ®µä»£ç æ¥æºäºç¬”è€…å®é™…é¡¹ç›®ä¸­å¼€å‘çš„ä¸€ä¸ªè‚¡ç¥¨å®¢æˆ·ç«¯çš„è½¯ä»¶ã€‚\nCSocketClient ç±»çš„ public æ–¹æ³•æä¾›å¯¹å¤–æ¥å£ä¾›ç¬¬ä¸‰æ–¹ä½¿ç”¨ï¼Œæ¯ä¸ªå‡½æ•°çš„å…·ä½“å®ç°åœ¨ SocketClient.cpp ä¸­ï¼Œå¯¹ç¬¬ä¸‰æ–¹ä½¿ç”¨è€…ä¸å¯è§ã€‚åœ¨ Windows ç³»ç»Ÿä¸Šä½œä¸ºæä¾›ç»™ç¬¬ä¸‰æ–¹ä½¿ç”¨çš„åº“ï¼Œä¸€èˆ¬éœ€è¦æä¾›ç»™ä½¿ç”¨è€… .hã€.lib å’Œ .dll* æ–‡ä»¶ï¼Œåœ¨ Linux ç³»ç»Ÿä¸Šéœ€è¦æä¾› ***.h**ã€.a  æˆ– .so æ–‡ä»¶ã€‚\nä¸ç®¡æ˜¯åœ¨å“ªä¸ªæ“ä½œç³»ç»Ÿå¹³å°ä¸Šï¼Œåƒ SocketClient.h è¿™æ ·çš„å¤´æ–‡ä»¶æä¾›ç»™ç¬¬ä¸‰æ–¹ä½¿ç”¨æ—¶ï¼Œéƒ½ä¼šè®©åº“çš„ä½œè€…å¿ƒé‡Œéšéšä¸å®‰â€”â€”å› ä¸º SocketClient.h æ–‡ä»¶ä¸­ SocketClient ç±»å¤§é‡çš„æˆå‘˜å˜é‡å’Œç§æœ‰å‡½æ•°æš´éœ²äº†è¿™ä¸ªç±»å¤ªå¤šçš„å®ç°ç»†èŠ‚ï¼Œå¾ˆå®¹æ˜“è®©ä½¿ç”¨è€…çœ‹å‡ºå®ç°åŸç†ã€‚è¿™æ ·çš„å¤´æ–‡ä»¶ï¼Œå¯¹äºä¸€äº›ä¸æƒ³å¯¹ä½¿ç”¨è€…æš´éœ²æ ¸å¿ƒæŠ€æœ¯å®ç°çš„åº“å’Œ sdkï¼Œæ˜¯éå¸¸ä¸å¥½çš„ã€‚\né‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•æ—¢èƒ½ä¿æŒå¯¹å¤–çš„æ¥å£ä¸å˜ï¼Œåˆèƒ½å°½é‡ä¸æš´éœ²ä¸€äº›å…³é”®æ€§çš„æˆå‘˜å˜é‡å’Œç§æœ‰å‡½æ•°çš„å®ç°æ–¹æ³•å‘¢ï¼Ÿæœ‰çš„ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»£ç ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435/** * ç½‘ç»œé€šä¿¡çš„åŸºç¡€ç±», SocketClient.h * zhangyl 2017.07.11 */class Impl;class CSocketClient&#123;public:    CSocketClient();    ~CSocketClient(); public:    void SetProxyWnd(HWND hProxyWnd);    bool    Init(CNetProxy* pNetProxy);    bool    Uninit();    int Register(const char* pszUser, const char* pszPassword);        void GuestLogin();          BOOL    IsClosed();    BOOL\tConnect(int timeout = 3);    void    AddData(int cmd, const std::string&amp; strBuffer);    void    AddData(int cmd, const char* pszBuff, int nBuffLen);    void    Close();    BOOL    ConnectServer(int timeout = 3);    BOOL    SendLoginMsg();    BOOL    RecvLoginMsg(int&amp; nRet);    BOOL    Login(int&amp; nRet);private:    Impl*\tm_pImpl;&#125;;\n\nä¸Šè¿°ä»£ç ä¸­ï¼Œæ‰€æœ‰çš„å…³é”®æ€§æˆå‘˜å˜é‡å·²ç»æ²¡æœ‰äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ªç±»å‹ä¸º Impl çš„æŒ‡é’ˆæˆå‘˜å˜é‡ m_pImplã€‚\n\nå…·ä½“é‡‡ç”¨ä»€ä¹ˆåç§°ï¼Œè¯»è€…å®Œå…¨å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å®šï¼Œä¸ä¸€å®šéè¦ä½¿ç”¨è¿™é‡Œçš„ Impl å’Œ m_pImplã€‚\n\nImpl ç±»å‹ç°åœ¨æ˜¯å®Œå…¨å¯¹ä½¿ç”¨è€…é€æ˜ï¼Œä¸ºäº†åœ¨å½“å‰ç±»ä¸­å¯ä»¥ä½¿ç”¨ Implï¼Œä½¿ç”¨äº†ä¸€ä¸ªå‰ç½®å£°æ˜ï¼š\n12//åŸä»£ç ç¬¬5è¡Œclass Impl;\n\nç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†åˆšæ‰éšè—çš„æˆå‘˜å˜é‡æ”¾åˆ°è¿™ä¸ªç±»ä¸­å»ï¼š\n12345678910111213141516171819202122232425262728293031323334class Impl&#123;public:\tImpl()\t&#123;        //TODO: ä½ å¯ä»¥åœ¨è¿™é‡Œå¯¹æˆå‘˜å˜é‡åšä¸€äº›åˆå§‹åŒ–å·¥ä½œ\t&#125;\t\t~Impl()\t&#123;        //TODO: ä½ å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›æ¸…ç†å·¥ä½œ\t&#125;\tpublic:\tSOCKET                          m_hSocket;    short                           m_nPort;    char                            m_szServer[64];    long                            m_nLastDataTime;        //æœ€è¿‘ä¸€æ¬¡æ”¶å‘æ•°æ®çš„æ—¶é—´    long                            m_nHeartbeatInterval;   //å¿ƒè·³åŒ…æ—¶é—´é—´éš”ï¼Œå•ä½ç§’    CRITICAL_SECTION                m_csLastDataTime;       //ä¿æŠ¤m_nLastDataTimeçš„äº’æ–¥ä½“     HANDLE                          m_hSendDataThread;      //å‘é€æ•°æ®çº¿ç¨‹    HANDLE                          m_hRecvDataThread;      //æ¥æ”¶æ•°æ®çº¿ç¨‹    std::string                     m_strSendBuf;    std::string                     m_strRecvBuf;    HANDLE                          m_hExitEvent;    bool                            m_bConnected;    CRITICAL_SECTION                m_csSendBuf;    HANDLE                          m_hSemaphoreSendBuf;    HWND                            m_hProxyWnd;    CNetProxy*                      m_pNetProxy;    int                             m_nReconnectTimeInterval;    //é‡è¿æ—¶é—´é—´éš”    time_t                          m_nLastReconnectTime;        //ä¸Šæ¬¡é‡è¿æ—¶åˆ»    CFlowStatistics*                m_pFlowStatistics;&#125;;\n\næ¥ç€æˆ‘ä»¬åœ¨ CSocketClient çš„æ„é€ å‡½æ•°ä¸­åˆ›å»ºè¿™ä¸ª m_pImpl å¯¹è±¡ï¼Œåœ¨ CSocketClient ææ„å‡½æ•°ä¸­é‡Šæ”¾è¿™ä¸ªå¯¹è±¡ã€‚\n123456789CSocketClient::CSocketClient()&#123;\tm_pImpl = new Impl();&#125;CSocketClient::~CSocketClient()&#123;\tdelete m_pImpl;&#125;\n\nè¿™æ ·ï¼ŒåŸæ¥éœ€è¦å¼•ç”¨çš„æˆå‘˜å˜é‡ï¼Œå¯ä»¥åœ¨ CSocketClient å†…éƒ¨ä½¿ç”¨ m_pImpl-&gt;å˜é‡å æ¥å¼•ç”¨äº†ã€‚ \n\nè¿™é‡Œä»…ä»…ä»¥æ¼”ç¤ºéšè— CSocketClient çš„æˆå‘˜å˜é‡ä¸ºä¾‹ï¼Œéšè—å…¶ç§æœ‰æ–¹æ³•ä¸æ­¤ç±»ä¼¼ï¼Œéƒ½æ˜¯å˜æˆç±» Impl çš„æ–¹æ³•ã€‚\n\néœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äº Impl ç±»æ˜¯ CSocketClient çš„è¾…åŠ©ç±»ï¼Œ Impl ç±»æ²¡æœ‰ç‹¬ç«‹å­˜åœ¨çš„å¿…è¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šå°† Impl ç±»å®šä¹‰æˆ CSocketClient çš„å†…éƒ¨ç±»ã€‚å³é‡‡ç”¨å¦‚ä¸‹å½¢å¼ï¼š\n12345678910111213141516/** * ç½‘ç»œé€šä¿¡çš„åŸºç¡€ç±», SocketClient.h * zhangyl 2017.07.11 */class CSocketClient&#123;public:    CSocketClient();    ~CSocketClient(); //é‡å¤çš„ä»£ç çœç•¥...private:\tclass   Impl;    Impl*\tm_pImpl;&#125;;\n\nç„¶ååœ¨ ClientSocket.cpp ä¸­å®šä¹‰ Impl ç±»çš„å®ç°ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * ç½‘ç»œé€šä¿¡çš„åŸºç¡€ç±», SocketClient.cpp * zhangyl 2017.07.11 */class  CSocketClient::Impl&#123;public:    void LoadConfig()    &#123;    \t//æ–¹æ³•çš„å…·ä½“å®ç°    &#125;        //å…¶ä»–æ–¹æ³•çœç•¥...    public:\tSOCKET                          m_hSocket;    short                           m_nPort;    char                            m_szServer[64];    long                            m_nLastDataTime;        //æœ€è¿‘ä¸€æ¬¡æ”¶å‘æ•°æ®çš„æ—¶é—´    long                            m_nHeartbeatInterval;   //å¿ƒè·³åŒ…æ—¶é—´é—´éš”ï¼Œå•ä½ç§’    CRITICAL_SECTION                m_csLastDataTime;       //ä¿æŠ¤m_nLastDataTimeçš„äº’æ–¥ä½“     HANDLE                          m_hSendDataThread;      //å‘é€æ•°æ®çº¿ç¨‹    HANDLE                          m_hRecvDataThread;      //æ¥æ”¶æ•°æ®çº¿ç¨‹    std::string                     m_strSendBuf;    std::string                     m_strRecvBuf;    HANDLE                          m_hExitEvent;    bool                            m_bConnected;    CRITICAL_SECTION                m_csSendBuf;    HANDLE                          m_hSemaphoreSendBuf;    HWND                            m_hProxyWnd;    CNetProxy*                      m_pNetProxy;    int                             m_nReconnectTimeInterval;    //é‡è¿æ—¶é—´é—´éš”    time_t                          m_nLastReconnectTime;        //ä¸Šæ¬¡é‡è¿æ—¶åˆ»    CFlowStatistics*                m_pFlowStatistics;&#125; CSocketClient::CSocketClient()&#123;\tm_pImpl = new Impl();&#125;CSocketClient::~CSocketClient()&#123;\tdelete m_pImpl;&#125;\n\nç°åœ¨CSocketClient è¿™ä¸ªç±»é™¤äº†ä¿ç•™å¯¹å¤–çš„æ¥å£ä»¥å¤–ï¼Œå…¶å†…éƒ¨å®ç°ç”¨åˆ°çš„å˜é‡å’Œæ–¹æ³•åŸºæœ¬ä¸Šå¯¹ä½¿ç”¨è€…ä¸å¯è§äº†ã€‚C++ ä¸­å¯¹ç±»çš„è¿™ç§å°è£…æ–¹å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º pimpl æƒ¯ç”¨æ³•ï¼Œå³ Pointer to Implementation ï¼ˆä¹Ÿæœ‰äººè®¤ä¸ºæ˜¯ Private Implementationï¼‰ã€‚\n\nåœ¨å®é™…çš„å¼€å‘ä¸­ï¼ŒImpl ç±»çš„å£°æ˜å’Œå®šä¹‰æ—¢å¯ä»¥ä½¿ç”¨ class å…³é”®å­—ä¹Ÿå¯ä»¥ä½¿ç”¨ struct å…³é”®å­—ã€‚åœ¨ C++ è¯­è¨€ä¸­ï¼Œstruct ç±»å‹å¯ä»¥å®šä¹‰æˆå‘˜æ–¹æ³•ï¼Œä½† struct æ‰€æœ‰æˆå‘˜å˜é‡å’Œæ–¹æ³•é»˜è®¤éƒ½æ˜¯ public çš„ã€‚\n\nç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„ä¼˜ç‚¹ï¼š\n\næ ¸å¿ƒæ•°æ®æˆå‘˜è¢«éšè—ï¼›\n  æ ¸å¿ƒæ•°æ®æˆå‘˜è¢«éšè—ï¼Œä¸å¿…æš´éœ²åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œå¯¹ä½¿ç”¨è€…é€æ˜ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚\n\né™ä½ç¼–è¯‘ä¾èµ–ï¼Œæé«˜ç¼–è¯‘é€Ÿåº¦ï¼›\n  ç”±äºåŸæ¥çš„å¤´æ–‡ä»¶çš„ä¸€äº›ç§æœ‰æˆå‘˜å˜é‡å¯èƒ½æ˜¯éæŒ‡é’ˆéå¼•ç”¨ç±»å‹çš„è‡ªå®šä¹‰ç±»å‹ï¼Œéœ€è¦åœ¨å½“å‰ç±»çš„å¤´æ–‡ä»¶ä¸­åŒ…å«è¿™äº›ç±»å‹çš„å¤´æ–‡ä»¶ï¼Œä½¿ç”¨äº† pimpl æƒ¯ç”¨æ³•ä»¥åï¼Œè¿™äº›ç§æœ‰æˆå‘˜å˜é‡è¢«ç§»åŠ¨åˆ°å½“å‰ç±»çš„ cpp æ–‡ä»¶ä¸­ï¼Œå› æ­¤å¤´æ–‡ä»¶ä¸å†éœ€è¦åŒ…å«è¿™äº›æˆå‘˜å˜é‡çš„ç±»å‹å¤´æ–‡ä»¶ï¼Œå½“å‰å¤´æ–‡ä»¶å˜â€œå¹²å‡€â€ï¼Œè¿™æ ·å…¶ä»–æ–‡ä»¶åœ¨å¼•ç”¨è¿™ä¸ªå¤´æ–‡ä»¶æ—¶ï¼Œä¾èµ–çš„ç±»å‹å˜å°‘ï¼ŒåŠ å¿«äº†ç¼–è¯‘é€Ÿåº¦ã€‚\n\næ¥å£ä¸å®ç°åˆ†ç¦»ã€‚\n  ä½¿ç”¨äº† pimpl æƒ¯ç”¨æ³•ä¹‹åï¼Œå³ä½¿ CSocketClient æˆ–è€… Impl ç±»çš„å®ç°ç»†èŠ‚å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¹ä½¿ç”¨è€…éƒ½æ˜¯é€æ˜çš„ï¼Œå¯¹å¤–çš„ CSocketClient ç±»å£°æ˜ä»ç„¶å¯ä»¥ä¿æŒä¸å˜ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥å¢åˆ æ”¹ Impl çš„æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•è€Œä¿æŒ SocketClient.h æ–‡ä»¶å†…å®¹ä¸å˜ï¼›å¦‚æœä¸ä½¿ç”¨ pimpl æƒ¯ç”¨æ³•ï¼Œæˆ‘ä»¬åšä¸åˆ°ä¸æ”¹å˜ SocketClient.h æ–‡ä»¶è€Œå¢åˆ æ”¹ CSocketClient ç±»çš„æˆå‘˜ã€‚\n\n\næ™ºèƒ½æŒ‡é’ˆç”¨äº pimpl æƒ¯ç”¨æ³•\nC++ 11 æ ‡å‡†å¼•å…¥äº†æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ std::unique_ptr å¯¹è±¡æ¥ç®¡ç†ä¸Šè¿°ç”¨äºéšè—å…·ä½“å®ç°çš„ m_pImpl æŒ‡é’ˆã€‚\nSocketClient.h æ–‡ä»¶å¯ä»¥ä¿®æ”¹æˆå¦‚ä¸‹æ–¹å¼ï¼š\n1234567891011121314#include &lt;memory&gt; //for std::unique_ptr  class CSocketClient&#123;public:    CSocketClient();    ~CSocketClient();    //é‡å¤çš„ä»£ç çœç•¥...private:    struct                  Impl;    std::unique_ptr&lt;Impl&gt;   m_pImpl;&#125;;\n\nSocketClient.cpp ä¸­ä¿®æ”¹ CSocketClient å¯¹è±¡çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„å®ç°å¦‚ä¸‹ï¼š\næ„é€ å‡½æ•°\nå¦‚æœä½ çš„ç¼–è¯‘å™¨ä»…æ”¯æŒ C++ 11 æ ‡å‡†ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹ä¿®æ”¹ï¼š\n12345CSocketClient::CSocketClient()&#123;    //C++11 æ ‡å‡†å¹¶æœªæä¾› std::make_unique()ï¼Œè¯¥æ–¹æ³•æ˜¯ C++14 æä¾›çš„    m_pImpl.reset(new Impl());&#125;\n\nå¦‚æœä½ çš„ç¼–è¯‘å™¨æ”¯æŒ C++14 åŠä»¥ä¸Šæ ‡å‡†ï¼Œå¯ä»¥è¿™ä¹ˆä¿®æ”¹ï¼š\n123CSocketClient::CSocketClient() : m_pImpl(std::make_unique&lt;Impl&gt;())&#123;    &#125;\n\nç”±äºå·²ç»ä½¿ç”¨äº†æ™ºèƒ½æŒ‡é’ˆæ¥ç®¡ç† m_pImpl æŒ‡å‘çš„å †å†…å­˜ï¼Œå› æ­¤ææ„å‡½æ•°ä¸­ä¸å†éœ€è¦æ˜¾å¼é‡Šæ”¾å †å†…å­˜ï¼š\n12345CSocketClient::~CSocketClient()&#123;    //ä¸å†éœ€è¦æ˜¾å¼ delete äº†     //delete m_pImpl;&#125;\n\n\n\npimp æƒ¯ç”¨æ³•æ˜¯ C&#x2F;C++ é¡¹ç›®å¼€å‘ä¸­ä¸€ç§éå¸¸å®ç”¨çš„ä»£ç ç¼–å†™ç­–ç•¥ï¼Œå»ºè®®è¯»è€…æŒæ¡å®ƒã€‚\n","slug":"è½¬è½½/cpp/C++å¿…é¡»æŒæ¡çš„pimplæƒ¯ç”¨æ³•","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"40a7e4f59089c11e355c8f7228d5379e","title":"ã€è½¬è½½ã€‘ä¸å®šå‚æ•°å‡½æ•°å®ç°var_argç³»åˆ—çš„å®","content":"ä¸å®šå‚æ•°å‡½æ•°å®ç°var_argç³»åˆ—çš„å®ç”µé©´çš„æºç æ—¥å¿—æ¨¡å—æœ‰ä¸€ä¸ªå« DebugLogError å‡½æ•°ï¼Œå…¶ç­¾åå¦‚ä¸‹ï¼š\n12//ä»£ç ä½äºeasyMule-master/src/WorkLayer/Log.h 55è¡Œvoid DebugLogError(LPCTSTR pszLine, ...);\n\n\nç”µé©´çš„æºç å¯ä»¥åœ¨å…¬ä¼—å·ã€ é«˜æ€§èƒ½æœåŠ¡å™¨å¼€å‘ ã€‘åå°å›å¤â€œè·å–ç”µé©´æºç â€å³å¯è·å–ã€‚\n\nè¿™ä¸ªå‡½æ•°çš„ç”³æ˜åœ¨ Log.h å¤´æ–‡ä»¶ä¸­ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œå…¶å®ç°ä»£ç åœ¨ Log.cpp æ–‡ä»¶ä¸­ï¼š\n12345678//ä»£ç ä½äºeasyMule-master/src/WorkLayer/Log.cpp 111è¡Œvoid DebugLogError(LPCTSTR pszFmt, ...)&#123;    va_list argp;    va_start(argp, pszFmt);    LogV(LOG_DEBUG | LOG_ERROR, pszFmt, argp);    va_end(argp);&#125;\n\nè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå…·æœ‰ä¸å®šå‚æ•°çš„å‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯å‚æ•°ä¸ªæ•°ä¸ç¡®å®šï¼‰ï¼Œæ¯”å¦‚è°ƒç”¨è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥äºŒä¸ªæˆ–è€…ä¸‰ä¸ªå‚æ•°ç­‰ç­‰ï¼š\n123DebugLogError(L&quot;æˆ‘å–œæ¬¢ä½ !&quot;);DebugLogError(L&quot;æˆ‘å–œæ¬¢ä½ !&quot;, L&quot;ä½ å–œæ¬¢è°ï¼Ÿ&quot;);DebugLogError(L&quot;æˆ‘å–œæ¬¢ä½ !&quot;, L&quot;ä½ å–œæ¬¢è°ï¼Ÿ&quot;, L&quot;è§é›¨èŒ!&quot;);\n\nä¸æ­¤ç±»ä¼¼ï¼Œ C è¯­è¨€ä¸­æœ€ç†Ÿæ‚‰çš„å‡½æ•° printf() å’Œ scanf() å°±æ˜¯èƒ½ä¼ å…¥ä¸å®šå‚æ•°çš„å‡½æ•°çš„ä¾‹å­ï¼Œå¯æ˜¯ä½ çŸ¥é“å¦‚ä½•ç¼–å†™è¿™æ ·å…·æœ‰ä¸å®šå‚æ•°çš„å‡½æ•°ä¹ˆï¼Ÿ\nä½ å¯ä»¥é€šè¿‡è¿™æ®µä»£ç å­¦ä¹ åˆ°ç¼–å†™æ–¹æ³•ï¼Œå¥¥ç§˜å°±åœ¨DebugLogError()ä¸­ä½¿ç”¨çš„å‡ ä¸ªä½ ä»æ¥æ²¡è§è¿‡çš„å®ï¼Œè®©æˆ‘ä»¬æ¬¢è¿å®ƒä»¬ï¼š\n\nva_list\nva_start\nva_end\n\nè¿™å‡ ä¸ªå®æ˜¯Cå‡½æ•°åº“æä¾›çš„ï¼Œä½äºå¤´æ–‡ä»¶stdarg.hä¸­ã€‚ä¸‹é¢æˆ‘ä»¬åˆ©ç”¨è¿™å‡ ä¸ªå®è‡ªå®šä¹‰ä¸€ä¸ªShowLove()å‡½æ•°ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include &lt;stdio.h&gt;#include &lt;tchar.h&gt;#include &lt;stdarg.h&gt;#include &lt;locale.h&gt;int ShowLove(wchar_t* szFirstSentence, ...)&#123;   //ç”¨æ¥ç»Ÿè®¡å¯å˜å‚æ•°æ•°é‡   int num = 0;   //ç¬¬ä¸€æ­¥ï¼š   //ç”³æ˜ä¸€ä¸ªva_listç±»å‹å¯¹è±¡apï¼Œç”¨äºå¯¹å‚æ•°è¿›è¡Œéå†   va_list ap;      //ç¬¬äºŒæ­¥ï¼š   //ä½¿ç”¨va_startå¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–   //è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯:   //åœ¨ä¼ ç»ŸCè¯­è¨€ä¸­ï¼Œva_startæŠŠapä¸­å†…éƒ¨æŒ‡é’ˆè®¾ç½®ä¸ºä¼ é€’ç»™å‡½æ•°å‚æ•°çš„ã€ç¬¬ä¸€ä¸ªå®å‚ã€‘ï¼›   //è€Œåœ¨æ ‡å‡†çš„Cä¸­ï¼Œva_startæ¥å—ä¸€ä¸ªé¢å¤–å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªã€å›ºå®šå‚æ•°ã€‘çš„åç§°ï¼Œ   //å¹¶æŠŠapä¸­çš„å†…éƒ¨æŒ‡é’ˆè®¾ç½®ä¸ºä¼ é€’ç»™å‡½æ•°çš„ç¬¬ä¸€ä¸ªã€å¯å˜å‚æ•°ã€‘.   //æ‰€ä»¥ä½ åœ¨VC++ 6.0å’ŒVS2008ç­‰é«˜ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ä¸­ä½¿ç”¨va_startéœ€è¦æ³¨æ„åŒºåˆ«   //è¿™é‡Œä½¿ç”¨æ ‡å‡†C   va_start(ap, szFirstSentence);   //ç¬¬ä¸‰æ­¥ï¼š   //ä½¿ç”¨va_argå®è¿”å›å®å‚åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå‚æ•°å€¼ï¼Œå¹¶æŠŠapçš„å†…éƒ¨æŒ‡é’ˆæ¨å‘ä¸‹ä¸€ä¸ªå‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰   //å¿…é¡»æŒ‡å®šä¸‹ä¸€ä¸ªå‚æ•°çš„ç±»å‹ã€‚   //åœ¨è°ƒç”¨va_startä¹‹åç¬¬ä¸€æ¬¡è°ƒç”¨va_argå°†è¿”å›ç¬¬ä¸€ä¸ªå¯å˜å‚æ•°çš„å€¼   wprintf(szFirstSentence);   wchar_t* p = 0;   while(p = va_arg(ap, wchar_t*))   &#123;       wprintf(L&quot;%s&quot;, p);       num ++;   &#125;   //ç¬¬å››æ­¥ï¼š   //å¾…æ‰€æœ‰å¯å˜å‚æ•°éƒ½è¯»å–å®Œæ¯•ä»¥åï¼Œè°ƒç”¨va_endå®å¯¹apå’Œva_liståšå¿…è¦çš„æ¸…ç†å·¥ä½œ   va_end(ap);   return num;&#125;int main(int argc, char* argv[])&#123;   setlocale(LC_ALL, &quot;&quot;);   int z = ShowLoveL&quot;æˆ‘å–œæ¬¢ä½ ï¼\\n&quot;);   int y = ShowLove(L&quot;æˆ‘å–œæ¬¢ä½ ï¼&quot;, L&quot;ä½ å–œæ¬¢è°ï¼Ÿ\\n&quot;);   int l = ShowLove(L&quot;æˆ‘å–œæ¬¢ä½ ï¼&quot;, L&quot;ä½ å–œæ¬¢è°ï¼Ÿ&quot;, L&quot;è§é›¨èŒï¼\\n&quot;);      printf(&quot;å¯å˜å‚æ•°ä¸ªæ•°ä¾æ¬¡æ˜¯ï¼š%d\\t%d\\t%d\\n&quot;, z, y, l);   return 0;&#125;\n\nä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœæ˜¯ï¼š\n\nè¿™é‡Œé¡ºä¾¿è¡¥å……ä¸‹ï¼Œva çš„æ˜¯è‹±æ–‡ varied arguments ï¼ˆå¯å˜å‚æ•°ï¼‰çš„æ„æ€ã€‚å…³äº va_list ç­‰å®çš„å®ç°åŸç†å…¶å®ä¹Ÿå¾ˆå®¹æ˜“ææ˜ç™½ï¼Œè¿™é‡Œä¸å†è®²è§£äº†ã€‚\næˆ‘ä»¬ç°åœ¨æ¥çœ‹çœ‹å‡½æ•° DebugLogError()ï¼š\n1234567void DebugLogError(LPCTSTR pszFmt, ...)&#123;\tva_list argp;\tva_start(argp, pszFmt);\t\tLogV(LOG_DEBUG | LOG_ERROR, pszFmt, argp);\tva_end(argp);&#125;\n\nå…¶ä»–çš„æ²¡ä»€ä¹ˆï¼Œå°±æ˜¯è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°å« LogV()ï¼ŒLogV() çš„çš„å£°æ˜ä½äº Log.h æ–‡ä»¶ä¸­ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼š\n1void LogV(UINT uFlags, LPCTSTR pszFmt, va_list argp);\n\nå…¶å®ç°ä»£ç ä½äº Log.cpp æ–‡ä»¶ä¸­ï¼š\n1234void LogV(UINT uFlags, LPCTSTR pszFmt, va_list argp)&#123;\tAddLogTextV(uFlags, DLP_DEFAULT, pszFmt, argp);&#125;\n\nè¿™é‡Œåˆè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•° **AddLogTextV()**ï¼Œè¿™ä¸ªå‡½æ•°çš„ä¹Ÿå£°æ˜åœ¨ Log.h ä¸­ï¼š\n1void AddLogTextV(UINT uFlags, EDebugLogPriority dlpPriority, LPCTSTR pszLine, va_list argptr)ï¼›\n\nå…¶å®ç°ä»£ç åœ¨ Log.cpp æ–‡ä»¶ä¸­ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445void AddLogTextV(UINT uFlags, EDebugLogPriority dlpPriority, LPCTSTR pszLine, va_list argptr)&#123;\tASSERT(pszLine != NULL);\tif ((uFlags &amp; LOG_DEBUG) &amp;&amp; !thePrefs.GetVerbose() &amp;&amp; dlpPriority &gt;= thePrefs.GetVerboseLogPriority())\t\treturn;\t\t//Xman Anti-Leecher-Log\tif ((uFlags &amp; LOG_LEECHER) &amp;&amp; !thePrefs.GetAntiLeecherLog())\t\treturn;\t\t//Xman end\tTCHAR szLogLine[1000];\tif (_vsntprintf(szLogLine, ARRSIZE(szLogLine), pszLine, argptr) == -1)\t\tszLogLine[ARRSIZE(szLogLine) - 1] = _T(&#x27;\\0&#x27;);\tif(CGlobalVariable::m_hListenWnd)\t\tUINotify(WM_ADD_LOGTEXT, uFlags, (LPARAM)new CString(szLogLine));\t//  Comment UI\t/*if (theApp.emuledlg)\t\ttheApp.emuledlg-&gt;AddLogText(uFlags, szLogLine);\telse*/\t/*if(SendMessage(CGlobalVariable::m_hListenWnd, WM_ADD_LOGTEXT, uFlags, (LPARAM)szLogLine)==0)*/\telse\t&#123;\t\tTRACE(_T(&quot;App Log: %s\\n&quot;), szLogLine);\t\tTCHAR szFullLogLine[1060];\t\tint iLen = _sntprintf(szFullLogLine, ARRSIZE(szFullLogLine), _T(&quot;%s: %s\\r\\n&quot;), CTime::GetCurrentTime().Format(thePrefs.GetDateTimeFormat4Log()), szLogLine);\t\tif (iLen &gt;= 0)\t\t&#123;\t\t\t//Xman Anti-Leecher-Log //Xman Code Improvement\t\t\tif (!((uFlags &amp; LOG_DEBUG) || (uFlags &amp; LOG_LEECHER)))\t\t\t&#123;\t\t\t\tif (thePrefs.GetLog2Disk())\t\t\t\t\ttheLog.Log(szFullLogLine, iLen);\t\t\t&#125;\t\t\telse\t\t\tif (thePrefs.GetVerbose()) // &amp;&amp; ((uFlags &amp; LOG_DEBUG) || thePrefs.GetFullVerbose()))\t\t\t&#123;\t\t\t\tif (thePrefs.GetDebug2Disk())\t\t\t\t\ttheVerboseLog.Log(szFullLogLine, iLen);\t\t\t&#125;\t\t\t//Xman end\t\t&#125;\t&#125;&#125;\n\næˆ‘ä»¬ä»æºå¤´å‡½æ•°è°ƒç”¨æ¥ç†ä¸‹æ€è·¯ï¼š\n\né¦–å…ˆç”¨ä¸‹åˆ—å‚æ•°è°ƒç”¨ **DebugLogError()**ï¼š\n\n1DebugLogError(L&quot;Unable to load shell32.dll to retrieve the systemfolder locations, using fallbacks&quot;);\n\n\nç„¶ååœ¨ä¸Šè¿°å‡½æ•°å†…éƒ¨åˆè°ƒç”¨ï¼š\n\n123LogV(LOG_DEBUG | LOG_ERROR,\t L&quot;Unable to load shell32.dll to retrieve the systemfolder locations, using fallbacks&quot;,     argp);\n\nå…¶ä¸­ï¼Œargp æ˜¯å‡½æ•° DebugLogError() çš„å†…éƒ¨å˜é‡ï¼Œè€Œ LOG_DEBUG å’Œ LOG_ERROR æ˜¯ Log.h ä¸­å®šä¹‰å‡ ä¸ªå®ï¼Œå…¶ç±»å‹ä¸ºæ•´å½¢ï¼š\n12345678910111213// Log message type enumeration#define\tLOG_INFO\t\t0#define\tLOG_WARNING\t\t1#define\tLOG_ERROR\t\t2#define\tLOG_SUCCESS\t\t3#define\tLOGMSGTYPEMASK\t0x03// Log message targets flags#define\tLOG_DEFAULT\t\t0x00#define\tLOG_DEBUG\t\t0x10#define\tLOG_STATUSBAR\t0x20#define\tLOG_DONTNOTIFY\t0x40#define LOG_LEECHER\t\t0x80 //Xman Anti-Leecher-Log\n\n\næœ€åè°ƒç”¨ï¼š\n\n1234AddLogTextV(LOG_DEBUG | LOG_ERROR,           DLP_DEFAULT,           L&quot;Unable to load shell32.dll to retrieve the systemfolder locations, using fallbacks&quot;,           argp);\n\nè¿™ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨ Log.h ä¸­çš„æšä¸¾å˜é‡ EDebugLogPriorityï¼Œä»£è¡¨è°ƒè¯•çš„è®°å½•çº§åˆ«ï¼Œå…¶å–å€¼å¦‚ä¸‹ï¼š\n1234567enum EDebugLogPriority&#123;\tDLP_VERYLOW = 0,\tDLP_LOW,\tDLP_DEFAULT,\tDLP_HIGH,\tDLP_VERYHIGH&#125;;\n\nè¿™é‡Œæé†’ä¸€ç‚¹ï¼Œç”±äºæšä¸¾é‡ DLP_VERYLOW &#x3D; 0ï¼Œæ‰€ä»¥åé¢çš„ DLP_LOWã€ DLP_DEFAULTã€  DLP_HIGHã€ DLP_VERYHIGH å°±ä¾æ¬¡ç­‰äº1ã€2ã€3ã€4ï¼Œè¿™æ˜¯Cè¯­è¨€è§„å®šçš„ï¼ŒCè¯­è¨€è§„å®šæšä¸¾é‡å¦‚æœä¸èµ‹åˆå€¼ï¼Œæ ¹æ®å‰é¢ä¸€ä¸ªé‡çš„å€¼ä¾æ¬¡é€’å¢ã€‚\næˆ‘ä»¬æ¥å®é™…çœ‹çœ‹AddTextLogText()å‡½æ•°çš„å®ç°ä»£ç ï¼š\n1234567891011void AddLogTextV(UINT uFlags, EDebugLogPriority dlpPriority, LPCTSTR pszLine, va_list argptr)&#123;ASSERT(pszLine != NULL);if ((uFlags &amp; LOG_DEBUG) &amp;&amp; !thePrefs.GetVerbose() &amp;&amp; dlpPriority &gt;= thePrefs.GetVerboseLogPriority())\treturn;\t//Xman Anti-Leecher-Logif ((uFlags &amp; LOG_LEECHER) &amp;&amp; !thePrefs.GetAntiLeecherLog())\treturn;\t//Xman end\n\né¦–å…ˆæ˜¯ä¸€ä¸ªASSERTæ–­è¨€ï¼Œè¿™ä¸ªæ–­è¨€è¦æ±‚ pszLine ï¼ˆå‡½æ•°ç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰ä¸èƒ½ä¸ºç©ºã€‚\næ¥ç€å¦‚æœåŒæ—¶æ»¡è¶³ä¸‹åˆ—ä¸¤ä¸ªæ¡ä»¶ï¼Œåˆ™å‡½æ•°è¿”å›ï¼š\n\næ¡ä»¶1ï¼šè¡¨è¾¾å¼ ((uFlags &amp; LOG_DEBUG) || (uFlags &amp; LOG_LEECHER)) ä¸ºçœŸï¼›\næ¡ä»¶2ï¼šè¡¨è¾¾å¼ !(thePrefs.GetVerbose() &amp;&amp; dlpPriority &gt;&#x3D; thePrefs.GetVerboseLogPriority()) ä¸ºçœŸã€‚\n\næˆ‘ä»¬å…ˆçœ‹æ¡ä»¶1ï¼Œå¾ˆå¤šå¹´ä»¥å‰ï¼Œæˆ‘å¯¹è¿™ç§æŒ‰ä½æˆ–è¿ç®—ï¼ˆ**|**ï¼‰å’ŒæŒ‰ä½ä¸è¿ç®—ï¼ˆï¼†ï¼‰æ¥ç»„åˆè¿™äº›ç¨‹åºä¸­çš„æ ‡å¿—çš„åŸç†ä¸€å¤´é›¾æ°´ï¼Œè™½ç„¶é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘çŸ¥é“è¿™äº›è¿ç®—ç¬¦çš„å«ä¹‰ã€‚\nç°åœ¨å°±ä»¥è¿™ä¸¤ä¸ªä¸ºä¾‹å§ï¼š\næŒ‰ä½æˆ–è¿ç®—ï¼Œå°±æ˜¯æŠŠä¸¤ä¸ªæ•°åœ¨äºŒè¿›åˆ¶å±‚é¢ä¸ŠæŒ‰ä½æˆ–ï¼Œæ¯”å¦‚äºŒè¿›åˆ¶æ•°ï¼š\n111 | 10 = 11\n\nç¬¬ä¸€ä¸ªæ•°å­—é«˜ä½ä¸Š 1 ä¸ç¬¬äºŒä¸ªæ•°å­—é«˜ä½ä¸Šçš„ 1 æ¥è¿›è¡Œæˆ–è¿ç®—ï¼Œç­‰äº 1ï¼Œæ”¾åœ¨é«˜ä½ï¼›\nç¬¬ä¸€ä¸ªæ•°å­—ä½ä½ä¸Š 1 ä¸ç¬¬äºŒä¸ªæ•°å­—ä½ä½ä¸Šçš„ 0 æ¥è¿›è¡Œæˆ–è¿ç®—ï¼Œç­‰äº 1ï¼Œæ”¾åœ¨ä½ä½ã€‚\nåŒç†ï¼Œä¸è¿ç®—ï¼š\n111 &amp; 10 = 10\n\næŒ‰ä½ä¸ï¼Œè¦æ±‚ä¸¤ä¸ªæ•°å­—éƒ½æ˜¯ 1 æ‰æ˜¯ 1ï¼›è€ŒæŒ‰ä½æˆ–åªè¦æœ‰ä¸€ä¸ªæ˜¯ 1 å°±ç­‰äº 1ï¼Œé™¤éä¸¤è€…éƒ½æ˜¯ 0ï¼Œåˆ™ä¸º 0ã€‚\nçœ‹ä¸ªå¤æ‚çš„ï¼š\n111001100 &amp; 10101010 = 10001000\n\nè¿™ç§åšæ³•æœ‰ä¸ªä¸¤ä¸ªå¥½å¤„ï¼š\n\nç¬¬ä¸€ï¼Œå¯ä»¥å°†æŸä¸ªä½ç½®çš„ä¸Šçš„æ•°å­—æ¥ä»£è¡¨å½“å‰çš„çŠ¶æ€ï¼Œæ¯”å¦‚ç”µè·¯ä¸­ 1 ä»£è¡¨å¼€ï¼Œ0 ä»£è¡¨å…³ã€‚é‚£ä¹ˆæˆ‘ç”¨ä¸‹é¢æ•°å­— a ï¼ 10001000 è¡¨ç¤ºç”µè·¯å¼€å…³çŠ¶æ€ï¼Œä½ ä¼šå‘ç°ç”µè·¯æ˜¯å¼€çš„ã€‚\nå†æ¯”å¦‚ï¼Œé¢œè‰²å€¼ RGB è¡¨ç¤ºæ³•ï¼šCD1298ï¼Œ æˆ‘æƒ³æŠŠå…¶ä¸­ç»¿è‰²å€¼å•ç‹¬æå–å‡ºæ¥ï¼Œæ€ä¹ˆåšï¼Ÿ\næ–¹æ³•ï¼š\n1GreenValue = 0xCD1298 &amp; 0x001200,\n\nè¿™æ ·å°±å¯ä»¥åšåˆ°äº†ã€‚\n\nç¬¬äºŒï¼Œå› ä¸ºæ˜¯äºŒè¿›åˆ¶å±‚æ¬¡ä¸Šçš„æ“ä½œï¼Œæ‰€ä»¥é€Ÿåº¦éå¸¸å¿«ã€‚\n\n\næˆ‘ä»¬ç°åœ¨åˆ†æä¸‹ä»£ç ï¼š\n1(uFlags &amp; LOG_DEBUG) || (uFlags &amp; LOG_LEECHER)\n\nå…ˆçœ‹ç¬¬ä¸€éƒ¨åˆ†ï¼š\n1uFlags &amp; LOG_DEBUG\n\nå†ç»“åˆä¸‹é¢çš„å®šä¹‰ï¼š\n123456// Log message targets flags#define LOG_DEFAULT      0x00#define LOG_DEBUG       0x10#define LOG_STATUSBAR 0x20#define LOG_DONTNOTIFY   0x40#define LOG_LEECHER      0x80 //Xman Anti-Leecher-Log\n\nè¿™å‡ ä¸ªå¸¸é‡å®šä¹‰çš„æ•°å€¼æ˜¯æœ‰è®²ç©¶çš„ï¼Œä¸æ˜¯ä»»ä½•æ•°å€¼éƒ½è¡Œçš„ã€‚æˆ‘ä»¬å°†å®ƒä»¬éƒ½åŒ–æˆäºŒè¿›åˆ¶ï¼š\n12345LOG_DEFAULT      0000 0000LOG_DEBUG        0001 0000LOG_STATUSBAR    0010 0000LOG_DONTNOTIFY   0100 0000LOG_LEECHER      1000 0000\n\nè¿™æ ·å‡å¦‚ uFlags &#x3D; 1010 0000ï¼Œè¿™æ ·æˆ‘è¦æ£€æµ‹æ˜¯å¦è®¾ç½®äº†LOG_DEBUGï¼Œæˆ‘åªè¦è¿™æ ·åšï¼š\n1Result = uFlags &amp; LOG_DEBUG\n\nè®¡ç®—ç»“æœ\n1Result =&gt; 0000 0000 =&gt; 0\n\nè¿™æ · ifï¼ˆRESULTï¼‰{} ä¸­æ¡ä»¶ä¸ºå‡ï¼›è¯´æ˜æˆ‘æ²¡æœ‰è®¾ç½®è¿™ä¸ªæ ‡å¿—ä½ï¼›åŒç†æˆ‘éœ€è¦æ£€æµ‹æ˜¯å¦è®¾ç½® LOG_STATUSBAR æ ‡å¿—ï¼Œåˆ™æ‰§è¡Œï¼š\n1Result = uFlags &amp; LOG_STATUSBAR = 0001 0000\n\nè¿™ä¸ªæ•°å­—åŒ–ä¸ºåè¿›åˆ¶ä¸ä¸º 0ï¼Œæ‰€ä»¥ä¸ºçœŸï¼Œå› æ­¤åœ¨åˆ¤æ–­è¯­å¥é‡Œé¢æ¡ä»¶ä¹Ÿä¸ºçœŸï¼Œè¯´æ˜è®¾ç½®äº†è¿™ä¸ªæ ‡å¿—ä½ã€‚\nè¿™æ˜¯æ­£é¢æ£€æµ‹ï¼Œåè¿‡æ¥æˆ‘æƒ³è®¾ç½®è¿™äº›æ ‡è¯†ä½ï¼Œè€Œä¸”å¯ä»¥ä¸€æ¬¡è®¾ç½®å¤šä¸ªæ ‡å¿—ä½ï¼Œæ¯”å¦‚\n1uFlags = LOG_STATUSBAR  |  LOG_DONTNOTIFY | LOG_LEECHER = 1110 0000\n\næ˜¯ä¸æ˜¯ä¸€ç›®äº†ç„¶ï¼Ÿ\nè€Œä¸”æˆ‘ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä»è®¾ç½®å¥½çš„æ ‡å¿—ä½ä¸­å»æ‰æŸä¸ªæˆ–æŸäº›æ ‡è¯†ä½ï¼Œæ¯”å¦‚æˆ‘æƒ³ä»ä¸Šé¢çš„uFlagså€¼ä¸­å»æ‰LOG_DONTNOTIFY æ ‡è¯†ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™æ ·åšå°±å¯ä»¥äº†ï¼š\n1uFlags &amp; (~LOG_DONTNOTIFY)\n\næ¥è§£é‡Šä¸‹ï½ç¬¦å·æ˜¯äºŒè¿›åˆ¶å±‚æ¬¡ä¸Šæ±‚åï¼Œå°†å¯¹åº”ä½ä¸Šçš„ 1 æ”¹ä¸º 0ï¼Œ0 æ”¹ä¸º 1ï¼Œé‚£ä¹ˆï¼š\n1~ LOG_DONTNOTIFY = 1011 1111\n\nç„¶åä¸ uFlags æˆ–èµ·æ¥ç­‰äº 1010 0000ï¼Œä½ çœ‹ä¸‹æ˜¯ä¸æ˜¯åˆšå¥½æŠŠ LOG_DONTNOTIFY å»æ‰äº†å‘€ï¼Ÿ\nè¿™ç§æ–¹æ³•æ•ˆç‡é«˜ä¸ä»…æ˜¯å› ä¸ºåœ¨äºŒè¿›åˆ¶å±‚æ¬¡ä¸Šè¿ç®—ï¼Œè€Œä¸”å®ƒå¯ä»¥ç”¨ä¸€ä¸ªè¾ƒå°çš„æ•°æ®ç±»å‹ä»£è¡¨å¤šä¸ªä¿¡æ¯ï¼Œå¯¹æ•°æ®çš„åˆ©ç”¨ç¨‹åº¦ç²¾å‡†åˆ°äºŒè¿›åˆ¶ä½ã€‚\n","slug":"è½¬è½½/cpp/ä¸å®šå‚æ•°å‡½æ•°å®ç°var_argç³»åˆ—çš„å®","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c9abbbdef4e88dc3f27e1c9bd42d47df","title":"ã€è½¬è½½ã€‘ä½ ä¸€å®šè¦ææ˜ç™½çš„Cå‡½æ•°è°ƒç”¨æ–¹å¼ä¸æ ˆåŸç†","content":"ä½ ä¸€å®šè¦ææ˜ç™½çš„Cå‡½æ•°è°ƒç”¨æ–¹å¼ä¸æ ˆåŸç†å†™åœ¨å‰é¢çš„è¯\nè¿™ç»å¯¹ä¸æ˜¯æ ‡é¢˜å…šã€‚è€Œæ˜¯C&#x2F;C++å¼€å‘ä¸­ä½ å¿…é¡»è¦æŒæ¡çš„åŸºç¡€çŸ¥è¯†ï¼Œä¹Ÿæ˜¯é«˜çº§æŠ€æœ¯å²—ä½é¢è¯•ä¸­é«˜é¢‘é¢˜ã€‚æˆ‘çœŸçš„çœŸçš„çœŸçš„å¸Œæœ›æ— è®ºæ˜¯å­¦ç”Ÿè¿˜æ˜¯å¹¿å¤§C&#x2F;C++å¼€å‘è€…ï¼Œéƒ½è¯¥æŒæ¡æ­¤æ–‡ä¸­ä»‹ç»çš„çŸ¥è¯†ã€‚\næ­£æ–‡\nè¿™ç¯‡blogè¯•å›¾è®²æ˜å½“ä¸€ä¸ªcå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¸€ä¸ª**æ ˆå¸§(stack frame)**æ˜¯å¦‚ä½•è¢«å»ºç«‹ï¼Œåˆå¦‚ä½•è¢«æ¶ˆé™¤çš„ã€‚è¿™äº›ç»†èŠ‚è·Ÿæ“ä½œç³»ç»Ÿå¹³å°åŠç¼–è¯‘å™¨çš„å®ç°æœ‰å…³ï¼Œä¸‹é¢çš„æè¿°æ˜¯é’ˆå¯¹è¿è¡Œåœ¨Intelå¥”è…¾èŠ¯ç‰‡ä¸ŠLinuxçš„gccç¼–è¯‘å™¨è€Œè¨€ã€‚cè¯­è¨€çš„æ ‡å‡†å¹¶æ²¡æœ‰æè¿°å®ç°çš„æ–¹å¼ï¼Œæ‰€ä»¥ï¼Œä¸åŒçš„ç¼–è¯‘å™¨ï¼Œå¤„ç†å™¨ï¼Œæ“ä½œç³»ç»Ÿéƒ½å¯èƒ½æœ‰è‡ªå·±çš„å»ºç«‹æ ˆå¸§çš„æ–¹å¼ã€‚\nä¸€ä¸ªå…¸å‹çš„æ ˆå¸§\nå›¾1æ˜¯ä¸€ä¸ªå…¸å‹çš„æ ˆå¸§ï¼Œå›¾ä¸­ï¼Œæ ˆé¡¶åœ¨ä¸Šï¼Œåœ°å€ç©ºé—´å¾€ä¸‹å¢é•¿ã€‚è¿™æ˜¯å¦‚ä¸‹ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶çš„æ ˆçš„å†…å®¹ï¼š\n1int foo(int arg1, int arg2, int arg3); \n\nå¹¶ä¸”ï¼Œfooæœ‰ä¸¤ä¸ªå±€éƒ¨çš„intå˜é‡ï¼ˆ4ä¸ªå­—èŠ‚ï¼‰ã€‚åœ¨è¿™ä¸ªç®€åŒ–çš„åœºæ™¯ä¸­ï¼Œmainè°ƒç”¨fooï¼Œè€Œç¨‹åºçš„æ§åˆ¶ä»åœ¨fooä¸­ã€‚è¿™é‡Œï¼Œmainæ˜¯è°ƒç”¨è€…ï¼ˆcallerï¼‰ï¼Œfooæ˜¯è¢«è°ƒç”¨è€…ï¼ˆcalleeï¼‰ã€‚ESPè¢«fooä½¿ç”¨æ¥æŒ‡ç¤ºæ ˆé¡¶ã€‚EBPç›¸å½“äºä¸€ä¸ªâ€œåŸºå‡†æŒ‡é’ˆâ€ã€‚ä»mainä¼ é€’åˆ°fooçš„å‚æ•°ä»¥åŠfooæœ¬èº«çš„å±€éƒ¨å˜é‡éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªåŸºå‡†æŒ‡é’ˆä¸ºå‚è€ƒï¼ŒåŠ ä¸Šåç§»é‡æ‰¾åˆ°ã€‚ç”±äºè¢«è°ƒç”¨è€…å…è®¸ä½¿ç”¨EAXï¼ŒECXå’ŒEDXå¯„å­˜å™¨ï¼Œæ‰€ä»¥å¦‚æœè°ƒç”¨è€…å¸Œæœ›ä¿å­˜è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Œå°±å¿…é¡»åœ¨è°ƒç”¨å­å‡½æ•°ä¹‹å‰æ˜¾å¼åœ°æŠŠä»–ä»¬ä¿å­˜åœ¨æ ˆä¸­ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœé™¤äº†ä¸Šé¢æåˆ°çš„å‡ ä¸ªå¯„å­˜å™¨ï¼Œè¢«è°ƒç”¨è€…è¿˜æƒ³ä½¿ç”¨åˆ«çš„å¯„å­˜å™¨ï¼Œæ¯”å¦‚EBXï¼ŒESIå’ŒEDIï¼Œé‚£ä¹ˆï¼Œè¢«è°ƒç”¨è€…å°±å¿…é¡»åœ¨æ ˆä¸­ä¿å­˜è¿™äº›è¢«é¢å¤–ä½¿ç”¨çš„å¯„å­˜å™¨ï¼Œå¹¶åœ¨è°ƒç”¨è¿”å›å‰å›å¤ä»–ä»¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¢«è°ƒç”¨è€…åªä½¿ç”¨çº¦å®šçš„EAXï¼ŒECXå’ŒEDXå¯„å­˜å™¨ï¼Œä»–ä»¬ç”±è°ƒç”¨è€…è´Ÿè´£ä¿å­˜å¹¶å›å¤ï¼Œä½†å¦‚æœè¢«è°ƒç”¨è¿™è¿˜é¢å¤–ä½¿ç”¨äº†åˆ«çš„å¯„å­˜å™¨ï¼Œåˆ™å¿…é¡»æœ‰ä»–ä»¬è‡ªå·±ä¿å­˜å¹¶å›å¤è¿™äº›å¯„å­˜å™¨çš„å€¼ã€‚ä¼ é€’ç»™fooçš„å‚æ•°è¢«å‹åˆ°æ ˆä¸­ï¼Œæœ€åä¸€ä¸ªå‚æ•°å…ˆè¿›æ ˆï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½äºæ ˆé¡¶çš„ã€‚fooä¸­å£°æ˜çš„å±€éƒ¨å˜é‡ä»¥åŠå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°çš„ä¸€äº›ä¸´æ—¶å˜é‡ä¹Ÿéƒ½å­˜åœ¨æ ˆä¸­ã€‚å°äºç­‰äº4ä¸ªå­—èŠ‚çš„è¿”å›å€¼ä¼šè¢«ä¿å­˜åˆ°EAXä¸­ï¼Œå¦‚æœå¤§äº4å­—èŠ‚ï¼Œå°äº8å­—èŠ‚ï¼Œé‚£ä¹ˆEDXä¹Ÿä¼šè¢«ç”¨æ¥ä¿å­˜è¿”å›å€¼ã€‚å¦‚æœè¿”å›å€¼å ç”¨çš„ç©ºé—´è¿˜è¦å¤§ï¼Œé‚£ä¹ˆè°ƒç”¨è€…ä¼šå‘è¢«è°ƒç”¨è€…ä¼ é€’ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œè¿™ä¸ªé¢å¤–çš„å‚æ•°æŒ‡å‘å°†è¦ä¿å­˜è¿”å›å€¼çš„åœ°å€ã€‚ç”¨Cè¯­è¨€æ¥è¯´ï¼Œå°±æ˜¯å‡½æ•°è°ƒç”¨ï¼š\n1x = foo(a, b, c);\n\nè¢«è½¬åŒ–ä¸ºï¼š\n1foo(&amp;x, a, b, c);\n\næ³¨æ„ï¼Œè¿™ä»…ä»…åœ¨è¿”å›å€¼å ç”¨å¤§äº8ä¸ªå­—èŠ‚æ—¶æ‰å‘ç”Ÿã€‚æœ‰çš„ç¼–è¯‘å™¨ä¸ç”¨EDXä¿å­˜è¿”å›å€¼ï¼Œæ‰€ä»¥å½“è¿”å›å€¼å¤§äº4ä¸ªå­—èŠ‚æ—¶ï¼Œå°±ç”¨è¿™ç§è½¬æ¢ã€‚å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°è°ƒç”¨éƒ½ç›´æ¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œè¿˜å¯èƒ½æ˜¯ç›´æ¥å‚ä¸åˆ°æŸä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ä¸­ï¼Œå¦‚ï¼š\n1m = foo(a, b, c) + foo(d, e, f);\n\næœ‰æˆ–è€…ä½œä¸ºå¦å¤–çš„å‡½æ•°çš„å‚æ•°ï¼Œ å¦‚ï¼š\n1fooo(foo(a, b, c), 3);\n\nè¿™äº›æƒ…å†µä¸‹ï¼Œfooçš„è¿”å›å€¼ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­å‚åŠ åç»­çš„è¿ç®—ï¼Œæ‰€ä»¥ï¼Œfoo(a, b, c)è¿˜æ˜¯å¯ä»¥è¢«è½¬åŒ–æˆ**foo(&amp;tmp, a, b, c)**ã€‚\nè®©æˆ‘ä»¬ä¸€æ­¥æ­¥åœ°çœ‹ä¸€ä¸‹åœ¨cå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªæ ˆå¸§æ˜¯å¦‚ä½•å»ºç«‹åŠæ¶ˆé™¤çš„ã€‚\nå‡½æ•°è°ƒç”¨å‰è°ƒç”¨è€…çš„åŠ¨ä½œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè°ƒç”¨è€…æ˜¯mainï¼Œå®ƒå‡†å¤‡è°ƒç”¨å‡½æ•°fooã€‚åœ¨å‡½æ•°è°ƒç”¨å‰ï¼Œmainæ­£åœ¨ç”¨ESPå’ŒEBPå¯„å­˜å™¨æŒ‡ç¤ºå®ƒè‡ªå·±çš„æ ˆå¸§ã€‚\né¦–å…ˆï¼ŒmainæŠŠEAXï¼ŒECXå’ŒEDXå‹æ ˆã€‚è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„æ­¥éª¤ï¼Œåªåœ¨è¿™ä¸‰ä¸ªå¯„å­˜å™¨å†…å®¹éœ€è¦ä¿ç•™çš„æ—¶å€™æ‰§è¡Œæ­¤æ­¥éª¤ã€‚æ¥ç€ï¼ŒmainæŠŠä¼ é€’ç»™fooçš„å‚æ•°ä¸€ä¸€è¿›æ ˆï¼Œæœ€åçš„å‚æ•°æœ€å…ˆè¿›æ ˆã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„å‡½æ•°è°ƒç”¨æ˜¯ï¼š\n1a = foo(12, 15, 18);\n\nç›¸åº”çš„æ±‡ç¼–è¯­è¨€æŒ‡ä»¤æ˜¯ï¼š\n123push dword 18push dword 15push dword 12\n\næœ€åï¼Œmainç”¨callæŒ‡ä»¤è°ƒç”¨å­å‡½æ•°ï¼š\n1call foo\n\nå½“callæŒ‡ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼ŒEIPæŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨çš„å†…å®¹è¢«å‹å…¥æ ˆä¸­ã€‚å› ä¸ºEIPå¯„å­˜å™¨æ˜¯æŒ‡å‘mainä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œæ‰€ä»¥ç°åœ¨è¿”å›åœ°å€å°±åœ¨æ ˆé¡¶äº†ã€‚åœ¨callæŒ‡ä»¤æ‰§è¡Œå®Œä¹‹åï¼Œä¸‹ä¸€ä¸ªæ‰§è¡Œå‘¨æœŸå°†ä»åä¸ºfooçš„æ ‡è®°å¤„å¼€å§‹ã€‚å›¾2å±•ç¤ºäº†callæŒ‡ä»¤å®Œæˆåæ ˆçš„å†…å®¹ã€‚å›¾2åŠåç»­å›¾ä¸­çš„ç²—çº¿æŒ‡ç¤ºäº†å‡½æ•°è°ƒç”¨å‰æ ˆé¡¶çš„ä½ç½®ã€‚æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œå½“æ•´ä¸ªå‡½æ•°è°ƒç”¨è¿‡ç¨‹ç»“æŸåï¼Œæ ˆé¡¶åˆå›åˆ°äº†è¿™ä¸ªä½ç½®ã€‚\n\nè¢«è°ƒç”¨è€…åœ¨å‡½æ•°è°ƒç”¨åçš„åŠ¨ä½œå½“å‡½æ•°fooï¼Œä¹Ÿå°±æ˜¯è¢«è°ƒç”¨è€…å–å¾—ç¨‹åºçš„æ§åˆ¶æƒï¼Œå®ƒå¿…é¡»åš3ä»¶äº‹ï¼šå»ºç«‹å®ƒè‡ªå·±çš„æ ˆå¸§ï¼Œä¸ºå±€éƒ¨å˜é‡åˆ†é…ç©ºé—´ï¼Œæœ€åï¼Œå¦‚æœéœ€è¦ï¼Œä¿å­˜å¯„å­˜å™¨EBXï¼ŒESIå’ŒEDIçš„å€¼ã€‚é¦–å…ˆfooå¿…é¡»å»ºç«‹å®ƒè‡ªå·±çš„æ ˆå¸§ã€‚EBPå¯„å­˜å™¨ç°åœ¨æ­£æŒ‡å‘mainçš„æ ˆå¸§ä¸­çš„æŸä¸ªä½ç½®ï¼Œè¿™ä¸ªå€¼å¿…é¡»è¢«ä¿ç•™ï¼Œå› æ­¤ï¼ŒEBPè¿›æ ˆã€‚ç„¶åESPçš„å†…å®¹èµ‹å€¼ç»™äº†EBPã€‚è¿™ä½¿å¾—å‡½æ•°çš„å‚æ•°å¯ä»¥é€šè¿‡å¯¹EBPé™„åŠ ä¸€ä¸ªåç§»é‡å¾—åˆ°ï¼Œè€Œæ ˆå¯„å­˜å™¨ESPä¾¿å¯ä»¥ç©ºå‡ºæ¥åšå…¶ä»–äº‹æƒ…ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå‡ ä¹æ‰€æœ‰çš„cå‡½æ•°éƒ½ç”±å¦‚ä¸‹ä¸¤ä¸ªæŒ‡ä»¤å¼€å§‹ï¼š\n12push ebpmov ebp, esp\n\næ­¤æ—¶çš„æ ˆå…¥å›¾3æ‰€ç¤ºã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°çš„åœ°å€æ˜¯EBPåŠ 8ï¼Œå› ä¸ºmainçš„EBPå’Œè¿”å›åœ°å€å„åœ¨æ ˆä¸­å äº†4ä¸ªå­—èŠ‚ã€‚\n\nâ€‹       \nä¸‹ä¸€æ­¥ï¼Œfooå¿…é¡»ä¸ºå®ƒçš„å±€éƒ¨å˜é‡åˆ†é…ç©ºé—´ï¼ŒåŒæ—¶ï¼Œä¹Ÿå¿…é¡»ä¸ºå®ƒå¯èƒ½ç”¨åˆ°çš„ä¸€äº›ä¸´æ—¶å˜é‡åˆ†é…ç©ºé—´ã€‚æ¯”å¦‚ï¼Œfooä¸­çš„ä¸€äº›Cè¯­å¥å¯èƒ½åŒ…æ‹¬å¤æ‚çš„è¡¨è¾¾å¼ï¼Œå…¶å­è¡¨è¾¾å¼çš„ä¸­é—´å€¼å°±å¿…é¡»å¾—æœ‰åœ°æ–¹å­˜æ”¾ã€‚è¿™äº›å­˜æ”¾ä¸­é—´å€¼çš„åœ°æ–¹åŒåŸè¢«ç§°ä¸ºä¸´æ—¶çš„ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥ä¸ºä¸‹ä¸€ä¸ªå¤æ‚è¡¨è¾¾å¼æ‰€å¤ç”¨ã€‚ä¸ºè¯´æ˜æ–¹ä¾¿ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬çš„fooä¸­æœ‰ä¸¤ä¸ªintç±»å‹ï¼ˆæ¯ä¸ª4å­—èŠ‚ï¼‰çš„å±€éƒ¨å˜é‡ï¼Œéœ€è¦é¢å¤–çš„12å­—èŠ‚çš„ä¸´æ—¶å­˜å‚¨ç©ºé—´ã€‚ç®€å•åœ°æŠŠæ ˆæŒ‡é’ˆå‡å»20ä¾¿ä¸ºè¿™20ä¸ªå­—èŠ‚åˆ†é…äº†ç©ºé—´ï¼š\n1sub esp, 20\n\nç°åœ¨ï¼Œå±€éƒ¨å˜é‡å’Œä¸´æ—¶å­˜å‚¨éƒ½å¯ä»¥é€šè¿‡åŸºå‡†æŒ‡é’ˆEBPåŠ åç§»é‡æ‰¾åˆ°äº†ã€‚æœ€åï¼Œå¦‚æœfooç”¨åˆ°EBXï¼ŒESIå’ŒEDIå¯„å­˜å™¨ï¼Œåˆ™å®ƒfå¿…é¡»åœ¨æ ˆé‡Œä¿å­˜å®ƒä»¬ã€‚ç»“æœï¼Œç°åœ¨çš„æ ˆå¦‚å›¾4æ‰€ç¤ºã€‚ \n\nâ€‹    \nfooçš„å‡½æ•°ä½“ç°åœ¨å¯ä»¥æ‰§è¡Œäº†ã€‚è¿™å…¶ä¸­ä¹Ÿè®¸æœ‰è¿›æ ˆã€å‡ºæ ˆçš„åŠ¨ä½œï¼Œæ ˆæŒ‡é’ˆESPä¹Ÿä¼šä¸Šä¸‹ç§»åŠ¨ï¼Œä½†EBPæ˜¯ä¿æŒä¸å˜çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸€ç›´ç”¨[EBP+8]æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œä¸ç®¡åœ¨å‡½æ•°ä¸­æœ‰å¤šå°‘è¿›å‡ºæ ˆçš„åŠ¨ä½œã€‚å‡½æ•°fooçš„æ‰§è¡Œä¹Ÿè®¸è¿˜ä¼šè°ƒç”¨åˆ«çš„å‡½æ•°ï¼Œç”šè‡³é€’å½’åœ°è°ƒç”¨fooæœ¬èº«ã€‚ç„¶è€Œï¼Œåªè¦EBPå¯„å­˜å™¨åœ¨è¿™äº›å­è°ƒç”¨è¿”å›æ—¶è¢«æ¢å¤ï¼Œå°±å¯ä»¥ç»§ç»­ç”¨EBPåŠ ä¸Šåç§»é‡çš„æ–¹å¼è®¿é—®å®é™…å‚æ•°ï¼Œå±€éƒ¨å˜é‡å’Œä¸´æ—¶å­˜å‚¨ã€‚\nè¢«è°ƒç”¨è€…è¿”å›å‰çš„åŠ¨ä½œåœ¨æŠŠç¨‹åºæ§åˆ¶æƒè¿”è¿˜ç»™è°ƒç”¨è€…å‰ï¼Œè¢«è°ƒç”¨è€…fooå¿…é¡»å…ˆæŠŠè¿”å›å€¼ä¿å­˜åœ¨EAXå¯„å­˜å™¨ä¸­ã€‚æˆ‘ä»¬å‰é¢å·²ç»è®¨è®ºè¿‡ï¼Œå½“è¿”å›å€¼å ç”¨å¤šäº4ä¸ªæˆ–8ä¸ªå­—èŠ‚æ—¶ï¼Œæ¥æ”¶è¿”å›å€¼çš„å˜é‡åœ°å€ä¼šä½œä¸ºä¸€ä¸ªé¢å¤–çš„æŒ‡é’ˆå‚æ•°è¢«ä¼ åˆ°å‡½æ•°ä¸­ï¼Œè€Œå‡½æ•°æœ¬èº«å°±ä¸éœ€è¦è¿”å›å€¼äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¢«è°ƒç”¨è€…ç›´æ¥é€šè¿‡å†…å­˜æ‹·è´æŠŠè¿”å›å€¼ç›´æ¥æ‹·è´åˆ°æ¥æ”¶åœ°å€ï¼Œä»è€Œçœå»äº†ä¸€æ¬¡é€šè¿‡æ ˆçš„ä¸­è½¬æ‹·è´ã€‚å…¶æ¬¡ï¼Œfooå¿…é¡»æ¢å¤EBXï¼ŒESIå’ŒEDIå¯„å­˜å™¨çš„å€¼ã€‚å¦‚æœè¿™äº›å¯„å­˜å™¨è¢«ä¿®æ”¹ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´ï¼Œæˆ‘ä»¬ä¼šåœ¨fooæ‰§è¡Œå¼€å§‹æ—¶æŠŠå®ƒä»¬çš„åŸå§‹å€¼å‹å…¥æ ˆä¸­ã€‚å¦‚æœESPå¯„å­˜å™¨æŒ‡å‘å¦‚å›¾4æ‰€ç¤ºçš„æ­£ç¡®ä½ç½®ï¼Œå¯„å­˜å™¨çš„åŸå§‹å€¼å°±å¯ä»¥å‡ºæ ˆå¹¶æ¢å¤ã€‚å¯è§ï¼Œåœ¨fooå‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ­£ç¡®åœ°è·Ÿè¸ªESPæ˜¯å¤šä¹ˆçš„é‡è¦â€”â€”â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›æ ˆå’Œå‡ºæ ˆæ“ä½œçš„æ¬¡æ•°å¿…é¡»ä¿æŒå¹³è¡¡ã€‚è¿™ä¸¤æ­¥ä¹‹åï¼Œæˆ‘ä»¬ä¸å†éœ€è¦fooçš„å±€éƒ¨å˜é‡å’Œä¸´æ—¶å­˜å‚¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æŒ‡ä»¤æ¶ˆé™¤æ ˆå¸§ï¼š\n12mov esp, ebppop ebp\n\nå…¶ç»“æœå°±æ˜¯ç°åœ¨æ ˆé‡Œçš„å†…å®¹è·Ÿå›¾2ä¸­æ‰€ç¤ºçš„æ ˆå®Œå…¨ä¸€æ ·ã€‚ç°åœ¨å¯ä»¥æ‰§è¡Œè¿”å›æŒ‡ä»¤äº†ã€‚ä»æ ˆé‡Œå¼¹å‡ºè¿”å›åœ°å€ï¼Œèµ‹å€¼ç»™EIPå¯„å­˜å™¨ã€‚æ ˆå¦‚å›¾5æ‰€ç¤ºï¼š\n \ni386æŒ‡ä»¤é›†æœ‰ä¸€æ¡â€œleaveâ€æŒ‡ä»¤ï¼Œå®ƒä¸ä¸Šé¢æåˆ°çš„movå’ŒpopæŒ‡ä»¤æ‰€ä½œçš„åŠ¨ä½œå®Œå…¨ç›¸åŒã€‚æ‰€ä»¥ï¼ŒCå‡½æ•°é€šå¸¸ä»¥è¿™æ ·çš„æŒ‡ä»¤ç»“æŸï¼š\n12leaveret\n\n\n\nè°ƒç”¨è€…åœ¨è¿”å›åçš„åŠ¨ä½œåœ¨ç¨‹åºæ§åˆ¶æƒè¿”å›åˆ°è°ƒç”¨è€…ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¾‹å­ä¸­çš„mainï¼‰åï¼Œæ ˆå¦‚å›¾5æ‰€ç¤ºã€‚è¿™æ—¶ï¼Œä¼ é€’ç»™fooçš„å‚æ•°é€šå¸¸å·²ç»ä¸éœ€è¦äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ3ä¸ªå‚æ•°ä¸€èµ·å¼¹å‡ºæ ˆï¼Œè¿™å¯ä»¥é€šè¿‡æŠŠæ ˆæŒ‡é’ˆåŠ 12ï¼ˆ&#x3D;3ä¸ª4å­—èŠ‚ï¼‰å®ç°ï¼š\n1add esp, 12\n\nå¦‚æœåœ¨å‡½æ•°è°ƒç”¨å‰ï¼ŒEAXï¼ŒECXå’ŒEDXå¯„å­˜å™¨çš„å€¼è¢«ä¿å­˜åœ¨æ ˆä¸­ï¼Œè°ƒç”¨è€…mainå‡½æ•°ç°åœ¨å¯ä»¥æŠŠå®ƒä»¬å¼¹å‡ºã€‚è¿™ä¸ªåŠ¨ä½œä¹‹åï¼Œæ ˆé¡¶å°±å›åˆ°äº†æˆ‘ä»¬å¼€å§‹æ•´ä¸ªå‡½æ•°è°ƒç”¨è¿‡ç¨‹å‰çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å›¾5ä¸­ç²—çº¿çš„ä½ç½®ã€‚\nçœ‹ä¸ªå…·ä½“çš„å®ä¾‹ï¼š\nè¿™æ®µä»£ç åæ±‡ç¼–åï¼Œä»£ç æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\n12345678910111213#include &lt;stdio.h&gt;long test(int a, int b)&#123;\ta = a + 3;\tb = b + 5;\treturn a + b;&#125; int main(int argc, char* argv[])&#123;\tprintf(&quot;%d&quot;, test(10,90));\treturn 0;&#125;\n\nå…ˆæ¥çœ‹ä¸€ä¸ªæ¦‚è²Œï¼š\n1234567891011121314151617181920212223249:   int main(int argc, char* argv[])10:   &#123;00401070   push        ebp00401071   mov         ebp,esp00401073   sub         esp,40h00401076   push        ebx00401077   push        esi00401078   push        edi00401079   lea         edi,[ebp-40h]0040107C   mov         ecx,10h00401081   mov         eax,0CCCCCCCCh00401086   rep stos    dword ptr [edi]11:        printf(&quot;%d&quot;,test(10,90));00401088   push        5Ah0040108A   push        0Ah0040108C   call        @ILT+0(test) (00401005)00401091   add         esp,800401094   push        eax00401095   push        offset string &quot;%d&quot; (0042201c)0040109A   call        printf (004010d0)0040109F   add         esp,812:        return 0;004010A2   xor         eax,eax13:   &#125;\n\nä¸‹é¢æ¥è§£é‡Šä¸€ä¸‹ï¼Œ\nå¼€å§‹è¿›å…¥Mainå‡½æ•° esp&#x3D;0x12FF84  ebp&#x3D;0x12FFC0å®Œæˆæ¤­åœ†å½¢æ¡†èµ·æ¥çš„éƒ¨åˆ†ï¼š\n100401070   push        ebp\n\nebpçš„å€¼å…¥æ ˆï¼Œä¿å­˜ç°åœº(è°ƒç”¨ç°åœºï¼Œä»testå‡½æ•°çœ‹ï¼Œå¦‚çº¢çº¿æ‰€ç¤ºï¼Œå³ä¿å­˜çš„0x12FF80ç”¨äºä»testå‡½æ•°å †æ ˆè¿”å›åˆ°mainå‡½æ•°)ï¼š\n100401071    mov        ebp,esp \n\næ­¤æ—¶ebpï¼0x12FF80 æ­¤æ—¶ebpå°±æ˜¯â€œå½“å‰å‡½æ•°å †æ ˆâ€çš„åŸºå€ ä»¥ä¾¿è®¿é—®å †æ ˆä¸­çš„ä¿¡æ¯ï¼›è¿˜æœ‰å°±æ˜¯ä»å½“å‰å‡½æ•°æ ˆé¡¶è¿”å›åˆ°æ ˆåº•ï¼š\n100401073     sub        esp,40h   \n\nå‡½æ•°ä½¿ç”¨çš„å †æ ˆï¼Œé»˜è®¤64ä¸ªå­—èŠ‚ï¼Œå †æ ˆä¸Šå°±æ˜¯16ä¸ªæ¨ªæ¡ï¼ˆå¯†é›†çº¿éƒ¨åˆ†ï¼‰æ­¤æ—¶esp&#x3D;0x12FF40ã€‚åœ¨ä¸Šå›¾ä¸­ï¼Œä¸Šé¢å¯†é›†çº¿æ˜¯testå‡½æ•°å †æ ˆç©ºé—´ï¼Œä¸‹é¢æ˜¯Mainçš„å †æ ˆç©ºé—´(è¡¥å……ï¼Œå…¶å®è¿™ä¸ªå°±å«åš Stack Frame)ï¼š\n123456700401076   push        ebx00401077   push        esi00401078   push        edi    å…¥æ ˆ 00401079   lea         edi,[ebp-40h]0040107C   mov         ecx,10h00401081   mov         eax,0CCCCCCCCh00401086   rep stos    dword ptr [edi]      \n\nåˆå§‹åŒ–ç”¨äºè¯¥å‡½æ•°çš„æ ˆç©ºé—´ä¸º0XCCCCCCCCï¼Œå³ä»0x12FF40~0x12FF80æ‰€æœ‰çš„å€¼å‡ä¸º0xCCCCCCCCï¼š\n123411:        printf(&quot;%d&quot;,test(10,90));00401088   push        5Ah    å‚æ•°å…¥æ ˆ ä»å³è‡³å·¦ å…ˆ90  å100040108A   push        0Ah 0040108C   call        @ILT+0(test) (00401005)    \n\nå‡½æ•°è°ƒç”¨ï¼Œè½¬å‘eip 00401005 ã€‚æ³¨æ„ï¼Œæ­¤æ—¶ä»å…¥æ ˆï¼Œå…¥æ ˆçš„æ˜¯call test æŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€00401091ä¸‹ä¸€æ¡æŒ‡ä»¤æ˜¯add esp,8ã€‚@ILT+0(?test@@YAJHH@Z):\n100401005   jmp       test (00401020)   \n\nå³è½¬å‘è¢«è°ƒå‡½æ•°testï¼š\n123456789101112131415161718192021222324252627282930 2:    long test(int a,int b) 3:    &#123;00401020   push        ebp00401021   mov         ebp,esp           00401023   sub         esp,40h00401026   push        ebx00401027   push        esi00401028   push        edi00401029   lea         edi,[ebp-40h]0040102C   mov         ecx,10h00401031   mov         eax,0CCCCCCCCh00401036   rep stos    dword ptr [edi]       //è¿™äº›å’Œä¸Šé¢ä¸€æ ·4:        a = a + 3;                                    00401038   mov         eax,dword ptr [ebp+8] //ebp=0x12FF24 åŠ 8 [0x12FF30]å³å–åˆ°äº†å‚æ•°100040103B   add         eax,30040103E   mov         dword ptr [ebp+8],eax5:        b = b + 5;00401041   mov         ecx,dword ptr [ebp+0Ch]00401044   add         ecx,500401047   mov         dword ptr [ebp+0Ch],ecx6:        return a + b;0040104A   mov         eax,dword ptr [ebp+8]0040104D   add         eax,dword ptr [ebp+0Ch]  //æœ€åçš„ç»“æœä¿å­˜åœ¨eax, ç»“æœå¾—ä»¥è¿”å›7:   &#125;00401050   pop         edi                 00401051   pop         esi00401052   pop         ebx00401053   mov         esp,ebp    //espæŒ‡å‘0x12FF24, testå‡½æ•°çš„å †æ ˆç©ºé—´è¢«æ”¾å¼ƒï¼Œä»å½“å‰å‡½æ•°æ ˆé¡¶è¿”å›åˆ°æ ˆåº•00401055   pop         ebp        //æ­¤æ—¶ebp=0x12FF80, æ¢å¤ç°åœº  esp=0x12FF2800401056   ret                    //retè´Ÿè´£æ ˆé¡¶0x12FF28ä¹‹å€¼00401091å¼¹å‡ºåˆ°æŒ‡ä»¤å¯„å­˜å™¨ä¸­ï¼Œesp=0x12FF30\n\nå› ä¸ºwin32æ±‡ç¼–ä¸€èˆ¬ç”¨eaxè¿”å›ç»“æœ æ‰€ä»¥å¦‚æœæœ€ç»ˆç»“æœä¸æ˜¯åœ¨eaxé‡Œé¢çš„è¯ è¿˜è¦æŠŠå®ƒæ”¾åˆ°eaxã€‚\næ³¨æ„ï¼Œä»è¢«è°ƒå‡½æ•°è¿”å›æ—¶ï¼Œæ˜¯å¼¹å‡ºEBP,æ¢å¤å †æ ˆåˆ°å‡½æ•°è°ƒç”¨å‰çš„åœ°å€ï¼Œå¼¹å‡ºè¿”å›åœ°å€åˆ°EIPä»¥ç»§ç»­æ‰§è¡Œç¨‹åºã€‚\nä»testå‡½æ•°è¿”å›ï¼Œæ‰§è¡Œï¼š\n100401091   add         esp,8       \n\næ¸…æ ˆï¼Œæ¸…é™¤ä¸¤ä¸ªå‹æ ˆçš„å‚æ•°10 90 è°ƒç”¨è€…mainè´Ÿè´£ã€‚(æ‰€è°“__cdeclè°ƒç”¨ç”±è°ƒç”¨è€…è´Ÿè´£æ¢å¤æ ˆï¼Œè°ƒç”¨è€…è´Ÿè´£æ¸…ç†çš„åªæ˜¯å…¥æ ˆçš„å‚æ•°ï¼Œtestå‡½æ•°è‡ªå·±çš„å †æ ˆç©ºé—´è‡ªå·±è¿”å›æ—¶è‡ªå·±å·²ç»æ¸…é™¤ï¼Œé ï¼ä¸€ç›´ç†è§£é”™)\n123456700401094   push        eax          //å…¥æ ˆï¼Œè®¡ç®—ç»“æœ108å…¥æ ˆï¼Œå³printfå‡½æ•°çš„å‚æ•°ä¹‹ä¸€å…¥æ ˆ00401095   push        offset string &quot;%d&quot; (0042201c)//å…¥æ ˆï¼Œå‚æ•° &quot;%d&quot;  å½“ç„¶å…¶å®æ˜¯ï¼…dçš„åœ°å€0040109A   call        printf (004010d0)//å‡½æ•°è°ƒç”¨ printf(&quot;%d&quot;,108) å› ä¸ºprintfå‡½æ•°æ—¶0040109F   add         esp,8       //æ¸…æ ˆï¼Œæ¸…é™¤å‚æ•° (&quot;%d&quot;, 108)19:        return 0;           004010A2   xor         eax,eax     //eaxæ¸…é›¶20:   &#125;     \n\nmainå‡½æ•°æ‰§è¡Œå®Œæ¯• æ­¤æ—¶esp&#x3D;0x12FF34 ebp&#x3D;0x12FF80ï¼š\n12345678004010A4   pop         edi004010A5   pop         esi004010A6   pop         ebx004010A7   add         esp,40h    //ä¸ºå•¥ä¸ç”¨mov esp, ebp? æ˜¯ä¸ºäº†ä¸‹é¢çš„æ¯”è¾ƒ004010AA   cmp         ebp,esp   //æ¯”è¾ƒï¼Œè‹¥ä¸åŒåˆ™è°ƒç”¨chkespæŠ›å‡ºå¼‚å¸¸004010AC   call        __chkesp (00401150)   004010B1   mov         esp,ebp   004010B3   pop         ebp          //ESP=0X12FF84  \n\nEBP&#x3D;0x12FFC0 å°˜å½’å°˜ åœŸå½’åœŸ ä¸€åˆ‡éƒ½æ¢å¤æœ€åˆçš„å¹³é™äº† :)\n1004010B4   ret\n\nå¦ï¼š\n\nå¦‚æœå‡½æ•°è°ƒç”¨æ–¹å¼æ˜¯**__stdcall**ä¸åŒä¹‹å¤„åœ¨äºmainå‡½æ•°call åé¢æ²¡æœ‰äº†add esp, 8ï¼›testå‡½æ•°æœ€åä¸€å¥æ˜¯ ret 8  (ç”±testå‡½æ•°æ¸…æ ˆ, ret 8æ„æ€æ˜¯æ‰§è¡Œretåï¼Œesp+8)ã€‚\nè¿è¡Œè¿‡ç¨‹ä¸­0x12FF28 ä¿å­˜äº†æŒ‡ä»¤åœ°å€ 00401091æ˜¯æ€ä¹ˆä¿å­˜çš„ï¼Ÿæ ˆæ¯ä¸ªç©ºé—´ä¿å­˜4ä¸ªå­—èŠ‚ï¼ˆç²’åº¦4å­—èŠ‚ï¼‰ ä¾‹å¦‚ä¸‹ä¸€ä¸ªæ ˆç©ºé—´0x12FF2Cä¿å­˜å‚æ•°10ï¼Œå› æ­¤ï¼š\n\n120x12FF28 0x12FF29 0x12FF2A 0x12FF2B      91       10       40       00       \n\nlittle-endian è®¤ä¸ºå…¶è¯»çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºæœ€å°çš„é‚£ä½ä¸Šçš„æ•°ã€‚\n\nchar a[] &#x3D; â€œabcdeâ€ å¯¹å±€éƒ¨å­—ç¬¦æ•°ç»„å˜é‡ï¼ˆæ ˆå˜é‡ï¼‰èµ‹å€¼ï¼Œæ˜¯åˆ©ç”¨å¯„å­˜å™¨ä»å…¨å±€æ•°æ®å†…å­˜åŒºæŠŠå­—ç¬¦ä¸²â€œabcdeâ€æ‹·è´åˆ°æ ˆå†…å­˜ä¸­çš„ã€‚\nint szNum[5] &#x3D; { 1, 2, 3, 4, 5 }; æ ˆä¸­æ˜¯å¦‚ä½•åˆ†å¸ƒçš„ï¼Ÿ\n\n1234500401798   mov         dword ptr [ebp-14h],10040179F   mov         dword ptr [ebp-10h],2004017A6   mov         dword ptr [ebp-0Ch],3004017AD   mov         dword ptr [ebp-8],4004017B4   mov         dword ptr [ebp-4],5\n\nå¯ä»¥çœ‹å‡ºæ¥æ˜¯ä»å³è¾¹å¼€å§‹å…¥æ ˆï¼Œæ‰€ä»¥æ˜¯ 5 4 3 2 1 å…¥æ ˆï¼Œ\n123int *ptrA = (int*)(&amp;szNum+1);int *ptrB = (int*)((int)szNum + 1);std::cout&lt;&lt; ptrA[-1] &lt;&lt; *ptrB &lt;&lt; std::endl;\n\nç»“æœå¦‚ä½•ï¼Ÿ\n12328:       int *ptrA = (int*)(&amp;szNum+1);004017BB   lea         eax,[ebp]004017BE   mov         dword ptr [ebp-18h],eax\n\n&amp;szNumæ˜¯æŒ‡å‘æ•°ç»„æŒ‡é’ˆï¼›åŠ 1æ˜¯åŠ ä¸€ä¸ªæ•°ç»„å®½åº¦ï¼›&amp;szNum+1æŒ‡å‘ç§»åŠ¨5ä¸ªintå•ä½ä¹‹åçš„é‚£ä¸ªåœ°æ–¹ï¼Œ å°±æ˜¯æŠŠEBPçš„åœ°å€èµ‹ç»™æŒ‡é’ˆï¼›ptrA[-1]æ˜¯å›é€€ä¸€ä¸ªint*å®½åº¦ï¼Œå³ebp-4ï¼›\n12329:       int *ptrB = (int*)((int)szNum + 1);004017C1   lea         ecx,[ebp-13h]004017C4   mov         dword ptr [ebp-1Ch],ecx\n\nå¦‚æœä¸Šé¢æ˜¯æŒ‡é’ˆç®—æœ¯ï¼Œé‚£è¿™é‡Œå°±æ˜¯åœ°å€ç®—æœ¯ï¼Œåªæ˜¯é¦–åœ°å€+1ä¸ªå­—èŠ‚çš„offsetï¼Œå³ebp-13hç»™æŒ‡é’ˆã€‚å®é™…ä¿å­˜æ˜¯è¿™æ ·çš„ï¼š\n1201 00 00 00 02 00 00 00ebp-14h ebp-13h ebp-10h\n\næ³¨æ„ï¼Œæ˜¯int*ç±»å‹çš„ï¼Œæœ€åè·å¾—çš„æ˜¯ 00 00 00 02ï¼Œç”±äºLittle-endian, å®é™…ä¸Šé€»è¾‘æ•°æ˜¯02000000ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶æ•°å°±ä¸º33554432ï¼Œæœ€åè¾“å‡º533554432ã€‚\n","slug":"è½¬è½½/cpp/ä½ ä¸€å®šè¦ææ˜ç™½çš„Cå‡½æ•°è°ƒç”¨æ–¹å¼ä¸æ ˆåŸç†","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"0e9060ff12875a627166c3e18b56f8f7","title":"ã€è½¬è½½ã€‘åˆ©ç”¨cmakeå·¥å…·ç”ŸæˆVisualStudioå·¥ç¨‹æ–‡ä»¶","content":"åˆ©ç”¨ cmake å·¥å…·ç”Ÿæˆ Visual Studio å·¥ç¨‹æ–‡ä»¶å¯¹äºä¹ æƒ¯äº† Visual Studio å¼ºå¤§çš„ç®¡ç†é¡¹ç›®ã€ç¼–ç å’Œè°ƒè¯•åŠŸèƒ½çš„è¯»è€…æ¥è¯´ï¼Œåœ¨ Linux ä¸‹ä½¿ç”¨ gcc&#x2F;g++ ç¼–è¯‘ã€ä½¿ç”¨ gdb è°ƒè¯•æ˜¯ä¸€ä»¶ä½•å…¶ç—›è‹¦çš„äº‹æƒ…ï¼Œå¯¹äºå¤§å¤šæ•°çš„å¼€æº C&#x2F;C++ é¡¹ç›®ï¼Œå¦‚æœæˆ‘ä»¬ä¸åœ¨æ„ Windows å’Œ Linux åœ¨ä¸€äº›åº•å±‚ API æ¥å£ä¸Šçš„ä½¿ç”¨å·®åˆ«ï¼Œæƒ³ç†Ÿæ‚‰è¯¥é¡¹ç›®çš„æ‰§è¡Œè„‰ç»œå’ŒåŸç†ï¼Œåœ¨ Windows ä¸Šä½¿ç”¨ Visual Studio è°ƒè¯•è¯¥é¡¹ç›®ä¹Ÿæœªå°ä¸å¯ã€‚å‡¡æ˜¯å¯ä»¥ä½¿ç”¨ CMake å·¥å…·ç¼–è¯‘çš„ Linux ç¨‹åºï¼ˆå³æä¾›äº† CMakeLists.txt æ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥åˆ©ç”¨ CMake å·¥å…·ç”Ÿæˆ Windows ä¸Šçš„ Visual Studio å·¥ç¨‹æ–‡ä»¶ã€‚\nè¿™é‡Œæˆ‘ä»¬ä»¥è‘—åçš„å¼€æºç½‘ç»œåº“ libuv ä¸ºä¾‹ã€‚\nä» libuv çš„å®˜æ–¹åœ°å€æä¾›çš„ä¸‹è½½é“¾æ¥ï¼šhttps://dist.libuv.org/dist/ ä¸‹è½½æœ€æ–°çš„ libuv çš„æºç å¾—åˆ°æ–‡ä»¶ libuv-v1.31.0.tar.gzï¼ˆç¬”è€…å†™ä½œæ­¤ä¹¦æ—¶ï¼Œlibuv æœ€æ–°ç‰ˆæœ¬æ˜¯ 1.31.0ï¼‰ï¼Œè§£å‹è¯¥æ–‡ä»¶ã€‚ä½œè€…çš„æœºå™¨ä¸Šæˆ‘å°†ä»£ç è§£å‹è‡³ *F:\\mycode\\libuv-v1.31.0* ï¼Œè§£å‹åçš„ç›®å½•ä¸­ç¡®å®å­˜åœ¨ä¸€ä¸ª CMakeLists.txt æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nå¯åŠ¨ Windows ä¸Šçš„ CMake å›¾å½¢åŒ–å·¥å…·ï¼ˆcmake-guiï¼‰ï¼ŒæŒ‰ä¸‹å›¾è¿›è¡Œè®¾ç½®ï¼š\n\nè®¾ç½®å®Œæˆä¹‹åï¼Œç‚¹å‡»ç•Œé¢ä¸Šçš„Configure æŒ‰é’®ï¼Œä¼šæç¤º vsprojects ç›®å½•ä¸å­˜åœ¨ï¼Œæç¤ºæ˜¯å¦åˆ›å»ºï¼Œæˆ‘ä»¬ç‚¹å‡» Yes è¿›è¡Œåˆ›å»ºã€‚\n\nå¦‚æœæ‚¨çš„æœºå™¨ä¸Šå®‰è£…äº†å¤šä¸ªç‰ˆæœ¬çš„Visual Studioï¼Œæ¥ä¸‹æ¥ä¼šå¼¹çª—å¯¹è¯æ¡†è®©æˆ‘ä»¬é€‰æ‹©è¦ç”Ÿæˆçš„å·¥ç¨‹æ–‡ä»¶å¯¹åº”çš„ Visual Studio ç‰ˆæœ¬å·ã€‚è¯»è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæŒ‰éœ€é€‰æ‹©ã€‚æˆ‘è¿™é‡Œé€‰æ‹© Visual Studio 2019ã€‚\n\n\nç‚¹å‡» Finish æŒ‰é’®åå¼€å§‹å¯åŠ¨ CMake çš„æ£€æµ‹å’Œé…ç½®å·¥ä½œã€‚ç­‰å¾…ä¸€ä¼šå„¿ï¼ŒCMake åº•éƒ¨çš„è¾“å‡ºæ¡†ä¸­æç¤º â€œConfiguring Doneâ€ è¡¨ç¤ºé…ç½®å·¥ä½œå·²ç»å®Œæˆã€‚\n\næ¥ä¸‹æ¥ç‚¹å‡» Generate æŒ‰é’®å³å¯ç”Ÿæˆæ‰€é€‰ç‰ˆæœ¬çš„ Visual Studio å·¥ç¨‹æ–‡ä»¶ï¼Œç”Ÿæˆçš„æ–‡ä»¶ä½äº vsprojects ç›®å½•ã€‚\n\næˆ‘ä»¬å¯ä»¥åœ¨ç•Œé¢ä¸Šç‚¹å‡»æŒ‰é’® Open Project æŒ‰é’®ç›´æ¥æ‰“å¼€å·¥ç¨‹æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ‰¾åˆ°å¯¹åº”ç›®å½•ä¸‹çš„ libuv.sln æ‰“å¼€ã€‚\næ‰“å¼€åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Visual Studio æ„‰å¿«åœ°è¿›è¡Œç¼–è¯‘å’Œè°ƒè¯•äº†ã€‚\nè®©æˆ‘ä»¬å†æ·±å…¥èŠä¸€ä¸‹ä¸Šè¿°è¿‡ç¨‹ï¼šåœ¨ç‚¹å‡» Configure æŒ‰é’®ä¹‹åï¼Œå’Œåœ¨ Linux ä¸‹æ‰§è¡Œ cmake å‘½ä»¤ä¸€æ ·ï¼ŒCMake å·¥å…·ä¹Ÿæ˜¯åœ¨æ£€æµ‹æ‰€åœ¨çš„ç³»ç»Ÿç¯å¢ƒæ˜¯å¦åŒ¹é… CMakeLists.txt ä¸­å®šä¹‰çš„å„ç§ç¯å¢ƒï¼Œæœ¬è´¨ä¸Šæ˜¯ç”Ÿæˆäº†ä¸€ä»½å¯ä»¥åœ¨ Windows ä¸Šç¼–è¯‘å’Œè¿è¡Œçš„ä»£ç ï¼ˆä¹Ÿå°±æ˜¯è¯´è¯¥æºç æ”¯æŒåœ¨ Windows ä¸Šè¿è¡Œï¼‰ ã€‚å› æ­¤ï¼Œå¯¹äºå¾ˆå¤šè™½ç„¶æä¾›äº† CMakeLists.txt æ–‡ä»¶ä½†å¹¶ä¸æ”¯æŒåœ¨ Windows ä¸Šè¿è¡Œçš„çš„ Linux å·¥ç¨‹ï¼Œè™½ç„¶åˆ©ç”¨ä¸Šè¿°æ–¹æ³•ä¹Ÿèƒ½æœ€ç»ˆç”Ÿæˆ Visual Studio å·¥ç¨‹æ–‡ä»¶ï¼Œä½†æ˜¯è¿™äº›æ–‡ä»¶å¹¶ä¸èƒ½åœ¨ Windows ä¸Šç›´æ¥æ— é”™ç¼–è¯‘å’Œè°ƒè¯•ã€‚\n\nç”±äºä¸åŒçš„ CMake ç‰ˆæœ¬æ”¯æŒçš„ CMakeLists.txt ä¸­çš„è¯­æ³•å¯èƒ½ç•¥æœ‰ç»†å¾®å·®åˆ«ï¼Œæœ‰äº› CMakeLists.txt æ–‡ä»¶åœ¨ä½¿ç”¨ä¸Šè¿°æ–¹æ³• configure æ—¶å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é”™è¯¯ï¼Œéœ€è¦è¯»è€…åšäº›ä¿®æ”¹æ‰èƒ½é€šè¿‡ã€‚\n\n","slug":"è½¬è½½/cpp/åˆ©ç”¨cmakeå·¥å…·ç”ŸæˆVisualStudioå·¥ç¨‹æ–‡ä»¶","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3add2e8130af8265f056561f93db8e22","title":"ã€è½¬è½½ã€‘å¦‚ä½•ä½¿ç”¨VisualStudioç®¡ç†å’Œé˜…è¯»å¼€æºé¡¹ç›®ä»£ç ","content":"å¦‚ä½•ä½¿ç”¨ Visual Studio ç®¡ç†å’Œé˜…è¯»å¼€æºé¡¹ç›®ä»£ç å¯¹äº Linux C&#x2F;C++ é¡¹ç›®ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨ Linux ç³»ç»Ÿä¸­ä½¿ç”¨ gdb å»è°ƒè¯•ï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹å¯¹äº C&#x2F;C++ é¡¹ç›®ç¬”è€…ä¸€èˆ¬ä¹ æƒ¯ä½¿ç”¨ Visual Studio å»åšé¡¹ç›®ç®¡ç†ï¼ŒVisual Studio æä¾›äº†å¼ºå¤§çš„ C&#x2F;C++ é¡¹ç›®å¼€å‘å’Œç®¡ç†èƒ½åŠ›ã€‚è¿™é‡Œä»¥ redis æºç ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸‹å¦‚ä½•å°†è¿™ç§å¼€æºé¡¹ç›®æ•´ä½“æ·»åŠ åˆ° Visual Studio çš„è§£å†³æ–¹æ¡ˆä¸­å»ã€‚\n\nå¯åŠ¨ Visual Studio æ–°å»ºä¸€ä¸ªç©ºçš„ Win32 æ§åˆ¶å°ç¨‹åºã€‚(å·¥ç¨‹å»ºå¥½åï¼Œå…³é—­è¯¥å·¥ç¨‹é˜²æ­¢æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­æ–‡ä»¶å ç”¨å¯¼è‡´çš„æ— æ³•ç§»åŠ¨ã€‚)\n\n\n\\2. è¿™æ ·ä¼šåœ¨ redis æºç ç›®å½•ä¸‹ä¼šæ ¹æ®ä½ è®¾ç½®çš„åç§°ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆè¿™é‡Œæ˜¯ redis-4.0.1ï¼‰ï¼Œå°†è¯¥æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ° redis æºç æ ¹ç›®å½•ï¼Œç„¶ååˆ æ‰ç”Ÿæˆçš„è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚\n\n\n \\3. å†æ¬¡ç”¨ Visual Studio æ‰“å¼€ redis-4.0.1.sln æ–‡ä»¶ï¼Œç„¶ååœ¨è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨è§†å›¾ä¸­ç‚¹å‡»æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶æŒ‰é’®å¹¶ä¿æŒè¯¥æŒ‰é’®é€‰ä¸­ã€‚ï¼ˆå¦‚æœæ‰¾ä¸åˆ°è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨è§†å›¾ï¼Œå¯ä»¥åœ¨ã€è§†å›¾ã€‘èœå•ä¸­æ‰“å¼€ï¼Œå¿«æ·é”® Ctrl + Alt + Lã€‚ï¼‰\n\n\\4. ç„¶åé€‰ä¸­æ‰€æœ‰éœ€è¦æ·»åŠ åˆ°è§£å†³æ–¹æ¡ˆä¸­çš„æ–‡ä»¶ï¼Œå³é”®é€‰æ‹©èœå•ã€åŒ…æ‹¬åœ¨é¡¹ç›®ä¸­ã€‘å³å¯ï¼Œå¦‚æœæ–‡ä»¶æ¯”è¾ƒå¤šï¼ŒVisual Studio å¯èƒ½éœ€è¦ä¸€ä¼šå„¿æ‰èƒ½å®Œæˆï¼Œä¸ºäº†å‡å°‘ç­‰å¾…æ—¶é—´ï¼Œè¯»è€…ä¹Ÿå¯ä»¥ä¸€æ‰¹ä¸€æ‰¹çš„æ·»åŠ ã€‚\n\n5.æ¥ç€é€‰æ‹©ã€æ–‡ä»¶ã€‘èœå•ã€å…¨éƒ¨ä¿å­˜ã€‘èœå•é¡¹ä¿å­˜å³å¯ï¼ˆå¿«æ·é”® Ctrl + Shift + S ï¼‰ã€‚\næœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nè¿™æ ·æˆ‘ä»¬å°±èƒ½åˆ©ç”¨ Visual Studio å¼ºå¤§çš„åŠŸèƒ½ç®¡ç†å’Œé˜…è¯»æˆ‘ä»¬çš„æºç äº†ã€‚\n\nè¿™é‡Œè¦æé†’ä¸€ä¸‹è¯»è€…ï¼šC&#x2F;C++ å¼€æºé¡¹ç›®ä¸­ä¸€èˆ¬ä¼šä½¿ç”¨å„ç§å®å»æ¡ä»¶ç¼–è¯‘ä¸€äº›ä»£ç ï¼Œå®é™…ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ä¸ä¸€å®šåŒ…å«è¿™äº›ä»£ç ï¼Œæ‰€ä»¥åœ¨ Visual Studio ä¸­çœ‹åˆ°æŸæ®µä»£ç çš„è¡Œå·ä¸å®é™…åœ¨ gdb ä¸­è°ƒè¯•çš„ä»£ç è¡Œå·ä¸ä¸€å®šç›¸åŒï¼Œåœ¨ç»™æŸä¸€è¡Œä»£ç è®¾ç½®æ–­ç‚¹æ—¶è¯·ä»¥ gdb ä¸­ list å‘½ä»¤çœ‹åˆ°çš„ä»£ç è¡Œå·ä¸ºå‡†ã€‚\n\n","slug":"è½¬è½½/cpp/å¦‚ä½•ä½¿ç”¨VisualStudioç®¡ç†å’Œé˜…è¯»å¼€æºé¡¹ç›®ä»£ç ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"19b943d557ff5766028818e28feaf31f","title":"ã€è½¬è½½ã€‘å¦‚ä½•æˆä¸ºä¸€ååˆæ ¼çš„CC++å¼€å‘è€…ï¼Ÿ","content":"å¦‚ä½•æˆä¸ºä¸€ååˆæ ¼çš„ C&#x2F;C++ å¼€å‘è€…ï¼Ÿå†™åœ¨å‰é¢çš„è¯åœ¨å¤§å¤šæ•°å¼€å‘æˆ–è€…å‡†å¼€å‘äººå‘˜çš„è®¤è¯†ä¸­ï¼ŒC&#x2F;C++ æ˜¯ä¸€é—¨éå¸¸éš¾çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¾ˆå¤šäººçŸ¥é“å®ƒçš„å¼ºå¤§ï¼Œä½†å› ä¸ºè®¤ä¸ºâ€œéš¾â€é€ æˆçš„ææƒ§è®©å¾ˆå¤šäººæ”¾å¼ƒã€‚\nç¬”è€…ä»å­¦ç”Ÿæ—¶ä»£å¼€å§‹æ¥è§¦ C&#x2F;C++ï¼Œå·¥ä½œä»¥åå…ˆåæ‹…ä»»è¿‡ C++ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„å¼€å‘ç»ç†å¹¶å¸¦é˜Ÿå¼€å‘ï¼Œè‡³ä»Šå·²ç»æœ‰åå¤šå¹´äº†ã€‚è™½ç„¶æ—¶è‡³ä»Šæ—¥å“ªç§ç¼–ç¨‹è¯­è¨€å¯¹æˆ‘æ¥è¯´å·²ç»ä¸å†é‡è¦ï¼ˆæˆ‘ç›®å‰ä¸»è¦ä»äº‹ Java å¼€å‘ï¼‰ï¼Œä½† C&#x2F;C++ ä»ç„¶æ˜¯ç¬”è€…æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒC&#x2F;C++ ä¸€æ—¦å­¦æˆï¼Œå…¶å¦™æ— ç©·ï¼Œå°±åƒæ­¦ä¾ å°è¯´ä¸­çš„â€œä¹é˜³ç¥åŠŸâ€ä¸€æ ·ï¼Œæœ‰äº†è¿™ä¸ªåŸºç¡€ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå­¦ä¹ ä»»ä½•è¯­è¨€å’Œç¼–ç¨‹æŠ€æœ¯ã€‚\nC&#x2F;C++ çš„å½“å‰åº”ç”¨é¢†åŸŸéœ€è¦æ³¨æ„çš„æ˜¯æœ¬æ–‡ä¸ç»†åˆ† Cä¸ C++ çš„åŒºåˆ«ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ŒC++ å¯ä»¥çœ‹æˆæ˜¯ C çš„ä¸€ä¸ªè¶…é›†ï¼Œåœ¨å¤å…¸æ—¶æœŸï¼Œå¯ä»¥è®¤ä¸º C++ å°±æ˜¯ C with classesã€‚è™½ç„¶å¦‚ä»Šçš„ C++ ä»åŠŸèƒ½å±‚é¢ä¸Šæ¥çœ‹ï¼Œç¦» C è¶Šæ¥è¶Šè¿œäº†ï¼›ä½†æ˜¯ä»è¯­æ³•å±‚é¢æ¥ä¸Šæ¥çœ‹ï¼Œå¤§å¤šæ•° C++ è¯­æ³•è¿˜æ˜¯ä¸ C åŸºæœ¬ä¸€è‡´çš„â€”â€”æ‰€è°“ C++ çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œå¦‚æœç»†ç©¶ C++ ç±»æ–¹æ³•çš„å…·ä½“è¯­æ³•è¿˜æ˜¯ C çš„è¿‡ç¨‹å¼è¯­æ³•ã€‚å½“ç„¶ï¼Œé¢å‘å¯¹è±¡æ˜¯ä¸€ç§æ€æƒ³ï¼Œè¯­è¨€æœ¬èº«å¯¹å…¶æ”¯æŒçš„ç¨‹åº¦å›ºç„¶é‡è¦ï¼Œèƒ½å¦ç†Ÿç»ƒä½¿ç”¨æ›´è¦çœ‹å¼€å‘è€…çš„æ°´å¹³ã€‚\nC è¯­è¨€ç›®å‰ä¸»è¦ç”¨äºåƒæ“ä½œç³»ç»Ÿä¸€ç±»ååº•å±‚çš„åº”ç”¨å¼€å‘ï¼ŒåŒ…æ‹¬åƒ Windows&#x2F;Linux è¿™æ ·çš„å¤§å‹å•†ä¸šæ“ä½œç³»ç»Ÿï¼Œä»¥åŠåµŒå…¥å¼æ“ä½œç³»ç»Ÿã€åµŒå…¥å¼è®¾å¤‡ä¸Šçš„åº”ç”¨ã€‚è¿˜æœ‰ä¸€äº›å¼€æºçš„è½¯ä»¶ï¼Œä¹Ÿä¼šé€‰æ‹© C å¼€å‘ï¼Œè¿™äº›ç³»ç»Ÿä¸»è¦ä¼˜å…ˆè€ƒè™‘ç¨‹åºæ‰§è¡Œæ•ˆç‡å’Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯ï¼ˆC ä»£ç ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯ç›¸å¯¹æ›´å°ï¼‰ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›æ˜¯å†å²æŠ€æœ¯é€‰å‹é—®é¢˜ï¼Œè¿™ç±»è½¯ä»¶åƒ Redisã€libeventã€Nginxï¼Œç›®å‰åƒå›½å†…çš„ç”µä¿¡æœåŠ¡å•†æ‰€ä½¿ç”¨çš„ç”µè¯å‘¼å«ç³»ç»Ÿï¼Œä¸€èˆ¬ä¹Ÿæ˜¯åŸºäºä¸€æ¬¾å« FreeSWITCH çš„å¼€æº C ç¨‹åºåšçš„äºŒæ¬¡å¼€å‘ï¼ˆé¡¹ç›®åœ°å€ï¼šhttps://freeswitch.com/ ï¼‰ã€‚\nC++ é¢å‘å¯¹è±¡çš„è¯­æ³•ä¸ C ç›¸æ¯”è¾ƒèµ·æ¥ï¼Œåœ¨å°†é«˜çº§è¯­è¨€ç¿»è¯‘æˆæœºå™¨äºŒè¿›åˆ¶ç çš„æ—¶å€™ï¼ŒC++ ç¼–è¯‘å™¨åœ¨èƒŒåå·å·åœ°åšäº†å¤§é‡å·¥ä½œï¼Œç”Ÿæˆäº†å¤§é‡çš„é¢å¤–æœºå™¨ç ï¼Œè€Œè¿™ç§æœºå™¨ç ç›¸å¯¹äº C æ¥è¯´ä¸æ˜¯å¿…é¡»çš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ª C++ ç±»çš„å®ä¾‹æ–¹æ³•ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆè¿™ä¸ªæ–¹æ³•çš„æœºå™¨ç æ—¶ï¼Œä¼šå°†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®æˆå¯¹è±¡çš„ this æŒ‡é’ˆåœ°å€ï¼Œä»¥æ­¤æ¥å®ç°å¯¹è±¡ä¸å‡½æ•°çš„ç»‘å®šã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œè®¸å¤šå¼€å‘è€…ä¼šä¼˜åŒ–å’Œè°ƒæ•´ç¼–è¯‘å™¨ç”Ÿæˆçš„æ±‡ç¼–ä»£ç ã€‚\næˆ‘ä»¬å†æ¥è¯´è¯´ C++ã€‚C++ çš„åº”ç”¨é¢†åŸŸç›®å‰æœ‰ä¸‰å¤§ç±»ï¼Œç¬¬ä¸€ç±»å°±æ˜¯æˆ‘ä»¬ç›®å‰è§åˆ°çš„å„ç§æ¡Œé¢åº”ç”¨è½¯ä»¶ï¼Œå°¤å…¶ Windows æ¡Œé¢è½¯ä»¶ï¼Œå¦‚ QQã€å®‰å…¨ç±»æ€æ¯’ç±»è½¯ä»¶ï¼ˆå¦‚é‡‘å±±çš„å®‰å…¨å«å£«ï¼Œå·²å¼€æºï¼Œå…¶ä»£ç åœ°å€ï¼šhttp://code.ijinshan.com/source/source.html ï¼‰ã€å„ç§æµè§ˆå™¨ç­‰ï¼›å¦å¤–å°±æ˜¯ä¸€äº›åŸºç¡€è½¯ä»¶å’Œé«˜çº§è¯­è¨€çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œå¦‚å¤§å‹æ•°æ®åº“è½¯ä»¶ã€Java è™šæ‹Ÿæœºã€C# çš„ CLRã€Python ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ç¯å¢ƒç­‰ï¼›ç¬¬ä¸‰ç±»å°±æ˜¯ä¸€äº›ä¸šåŠ¡å‹åº”ç”¨è½¯ä»¶çš„åå°ï¼Œåƒæ¸¸æˆçš„æœåŠ¡å™¨åå°ï¼Œå¦‚é­”å…½ä¸–ç•Œçš„æœåŠ¡å™¨ï¼ˆä»£ç åœ°å€ï¼šhttps://github.com/azerothcore/azerothcore-wotlk ï¼‰å’Œä¸€äº›ä¼ä¸šå†…éƒ¨çš„åº”ç”¨ç³»ç»Ÿã€‚ç¬”è€…æ›¾åœ¨æŸäº¤æ˜“æ‰€ä»äº‹åå°å¼€å‘ï¼Œå…¶äº¤æ˜“ç³»ç»Ÿå’Œè¡Œæƒ…ç³»ç»Ÿå°±æ˜¯åŸºäº C++ å¼€å‘çš„ã€‚\nC++ ä¸æ“ä½œç³»ç»Ÿå¹³å°ä»ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œä¸ Javaã€Python ç­‰è¯­è¨€ç›¸æ¯”ï¼ŒC&#x2F;C++ è¯­è¨€æ˜¯ç¦»æ“ä½œç³»ç»Ÿæœ€è¿‘çš„ä¸€ç§é«˜çº§è¯­è¨€ï¼Œå› æ­¤å…¶æ‰§è¡Œæ•ˆç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚ä½†æ˜¯æœ‰å¾—å¿…æœ‰å¤±ï¼Œå› ä¸ºå¦‚æ­¤ï¼ŒC&#x2F;C++ è¿™é—¨è¯­è¨€å­˜åœ¨å¦‚ä¸‹ç‰¹ç‚¹ã€‚\nC&#x2F;C++ æ•´å¥—çš„è¯­æ³•ä¸å…·å¤‡â€œåŠŸèƒ½å®Œå¤‡æ€§â€ï¼Œå•çº¯åœ°ä½¿ç”¨è¿™é—¨è¯­è¨€æœ¬èº«æä¾›çš„åŠŸèƒ½æ— æ³•åˆ›å»ºä»»ä½•æœ‰æ„ä¹‰çš„ç¨‹åºï¼Œå¿…é¡»å€ŸåŠ©æ“ä½œç³»ç»Ÿçš„ API æ¥å£å‡½æ•°æ¥è¾¾åˆ°ç›¸åº”çš„åŠŸèƒ½ã€‚å½“ç„¶ï¼Œéšç€ C++ è¯­è¨€æ ‡å‡†å’Œç‰ˆæœ¬çš„ä¸æ–­æ›´æ–°å‡çº§ï¼Œè¿™ç§ç°çŠ¶æ­£åœ¨æ”¹å˜ï¼›è€Œåƒ Javaã€Python è¿™ç±»è¯­è¨€ï¼Œå…¶è‡ªå¸¦çš„ SDK æä¾›äº†å„ç§æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚\nä¸¾ä¸ªä¾‹å­ï¼ŒC&#x2F;C++ è¯­è¨€æœ¬èº«ä¸å…·å¤‡ç½‘ç»œé€šä¿¡åŠŸèƒ½ï¼Œå¿…é¡»ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„ç½‘ç»œé€šä¿¡å‡½æ•°ï¼ˆå¦‚ Socket ç³»åˆ—å‡½æ•°ï¼‰ï¼›è€Œå¯¹äº Java æ¥è¯´ï¼Œå…¶ JDK è‡ªå¸¦çš„ java.net å’Œ java.io ç­‰åŒ…åˆ™æä¾›äº†å®Œæ•´çš„ç½‘ç»œé€šä¿¡åŠŸèƒ½ã€‚æˆ‘åœ¨è¯»ä¹¦çš„æ—¶å€™å¸¸å¸¸å¬äººè¯´ï¼ŒQQã€360 å®‰å…¨å«å£«è¿™ç±»è½¯ä»¶æ˜¯ç”¨ C&#x2F;C++ å¼€å‘çš„ï¼Œä½†æ˜¯å½“æˆ‘å­¦å®Œæ•´æœ¬ C&#x2F;C++ æ•™æä»¥åï¼Œä»ç„¶å†™ä¸å‡ºæ¥ä¸€ä¸ªåƒæ ·çš„çª—å£ç¨‹åºã€‚è®¸å¤šè¿‡æ¥äººåº”è¯¥éƒ½æœ‰ç±»ä¼¼çš„å›°æƒ‘å§ï¼Ÿå…¶åŸå› æ˜¯ä¸€èˆ¬ C&#x2F;C++ çš„æ•™æä¸ä¼šæ•™ä½ å¦‚ä½•ä½¿ç”¨æ“ä½œç³»ç»Ÿ API å‡½æ•°çš„å†…å®¹ã€‚\nC&#x2F;C++ è¯­è¨€éœ€è¦ç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„æ¥å£åŠŸèƒ½ï¼Œè¿™å°±é€ æˆäº† C&#x2F;C++ è¯­è¨€ç¹ã€éš¾çš„åœ°æ–¹ã€‚å¦‚æ“ä½œå†…å­˜ä¸å½“å®¹æ˜“å¼•èµ·ç¨‹åºå®•æœºï¼Œä¸åŒæ“ä½œç³»ç»Ÿçš„ API æ¥å£ä½¿ç”¨ä¹ æƒ¯å’Œé£æ ¼ä¹Ÿä¸ä¸€æ ·ã€‚æ¥å£å‡½æ•°ç§ç±»ç¹å¤šï¼Œå¼€å‘è€…å¦‚æœæƒ³å¼€å‘è·¨å¹³å°çš„ç¨‹åºï¼Œå¿…é¡»è¦å­¦ä¹ å¤šä¸ªå¹³å°çš„æ¥å£å‡½æ•°å’Œå¯¹åº”çš„ç³»ç»ŸåŸç†ã€‚\nåœ¨åº”ç”¨å±‚å¼€å‘ï¼Œç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿæ¥å£çš„å‡½æ•°ï¼Œå¾€å¾€æ‰§è¡Œæ•ˆç‡é«˜ã€æ§åˆ¶åŠ›åº¦å¤§ã€‚è€Œå¼€å‘èƒ½åŠ›ä»…ä»…é™åˆ¶äºæ“ä½œç³»ç»Ÿæœ¬èº«ï¼ŒJava è¿™ç±»è¯­è¨€ï¼Œå¾ˆå¤šåŠŸèƒ½å³ä½¿æ“ä½œç³»ç»Ÿæä¾›äº†ï¼Œå¦‚æœ Java è™šæ‹Ÿæœºä¸æä¾›ï¼Œå¼€å‘äººå‘˜ä¹Ÿæ— æ³•ä½¿ç”¨ã€‚æ­£å¦‚è‘—åçš„ç¼–ç¨‹å¤§å¸ˆ Charles Petzold æ‰€è¯´ï¼š\n\nâ€œæ˜¾è€Œæ˜“è§ï¼Œç©¶ç«Ÿç”¨å“ªç§æ–¹å¼ç¼–å†™åº”ç”¨ç¨‹åºæœ€å¥½ï¼Œå…¶å®å¹¶æ— ä¸€å®šä¹‹è§„ã€‚åº”ç”¨ç¨‹åºæœ¬èº«çš„ç‰¹æ€§åº”è¯¥æ˜¯å†³å®šé‡‡ç”¨ä½•ç§ç¼–ç¨‹å·¥å…·çš„æœ€ä¸»è¦å› ç´ ï¼Œä½†æ˜¯æ— è®ºå°†æ¥ä½ é‡‡ç”¨ä»€ä¹ˆæ ·çš„ç¼–ç¨‹å·¥å…·ï¼Œé€šè¿‡äº†è§£æ“ä½œç³»ç»Ÿ API ä»è€Œæ·±å…¥ç†è§£æ“ä½œç³»ç»Ÿçš„å·¥ä½œåŸç†ï¼Œè¿™æœ¬èº«å°±æœ‰å¾ˆé‡è¦çš„æ„ä¹‰ã€‚æ“ä½œç³»ç»Ÿæ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ç³»ç»Ÿï¼Œåœ¨ API ä¹‹ä¸ŠåŠ ä¸€å±‚ç¼–ç¨‹è¯­è¨€å¹¶ä¸èƒ½æ¶ˆé™¤å…¶å¤æ‚æ€§ï¼Œæœ€å¤šä¸è¿‡æ˜¯æŠŠå¤æ‚æ€§éšè—èµ·æ¥è€Œå·²ã€‚è¯´ä¸å®šä»€ä¹ˆæ—¶å€™ï¼Œå¤æ‚çš„é‚£ä¸€é¢è¿Ÿæ—©ä¼šè¹¦å‡ºæ¥æ‹–ä½ çš„åè…¿ï¼Œæ‡‚å¾—ç³»ç»Ÿ API èƒ½è®©ä½ åˆ°æ—¶å€™å¯ä»¥æ›´å¿«åœ°æŒ£è„±å›°å¢ƒã€‚\nåœ¨åŸºæœ¬æ“ä½œç³»ç»Ÿ API ä¹‹ä¸Šçš„ä»»ä½•è½¯ä»¶å±‚æˆ–å¤šæˆ–å°‘éƒ½ä¼šé™åˆ¶ä½ ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œä½ æˆ–è®¸å‘ç°é‡‡ç”¨ Visual Basic æ¥ç¼–å†™ä½ çš„åº”ç”¨ç¨‹åºéå¸¸ç†æƒ³ï¼Œä½†æ˜¯å°±æœ‰é‚£ä¹ˆä¸€ä¸¤é¡¹éå¸¸åŸºæœ¬çš„åŠŸèƒ½ Visual Basic æ— æ³•æ”¯æŒã€‚å¾€å¾€è¿™ä¸ªæ—¶å€™ä½ å¾—éè¦è°ƒç”¨åŸºæœ¬ API ã€‚ä½œä¸ºç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿ API çš„ç¨‹åºå‘˜ï¼Œæˆ‘ä»¬çš„æ´»åŠ¨ç©ºé—´å®Œå…¨ç”± API æ¥è§„èŒƒï¼Œå†æ²¡æœ‰ä»€ä¹ˆå…¶ä»–æ–¹å¼æ¯”ç›´æ¥è°ƒç”¨ API æ›´æœ‰æ•ˆã€æ›´çµæ´»å¤šæ ·äº†ã€‚â€\n\næ€»ç»“èµ·æ¥ï¼ŒC&#x2F;C++ è¯­è¨€çš„å¼€å‘æ ¸å¿ƒå»ºç«‹åœ¨ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿ API çš„åŸºç¡€ä¸Šï¼Œä¼˜ç‚¹æ˜¯æ‰§è¡Œæ•ˆç‡é«˜ã€å‘æŒ¥ç©ºé—´å¤§ï¼›ç¼ºç‚¹æ˜¯ï¼Œéœ€è¦ç»è¿‡ç³»ç»Ÿæ·±å…¥çš„å­¦ä¹ ï¼Œå­¦ä¹ å‘¨æœŸé•¿ï¼Œç¼–å†™ä»£ç è¾ƒå¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ã€‚\nLinux C++ ä¸ Windows C++ é¢†åŸŸä¹‹äº‰æˆ‘ä¹‹æ‰€ä»¥æŠŠè¿™ä¸ªæ ‡é¢˜å•ç‹¬åˆ—å‡ºæ¥ï¼Œæ˜¯æƒ³çº æ­£ç°åœ¨å¾ˆå¤š C&#x2F;C++ æ–°äººå’Œåˆå­¦è€…ä¸€äº›ä¸å½“çš„è®¤è¯†ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§è§‚ç‚¹ï¼š\n\n\nLinux C++ å¼€å‘å°±æ˜¯åå°å¼€å‘ï¼Œè€Œ Windows C++ å¼€å‘å°±æ˜¯å®¢æˆ·ç«¯å¼€å‘ï¼›\nåç«¯å¼€å‘æ¯”å®¢æˆ·ç«¯å¼€å‘ï¼ˆå‰ç«¯ï¼‰é«˜çº§ï¼Œå› æ­¤åç«¯å¼€å‘è¡Œä¸šè–ªèµ„æ°´å¹³æ¯”å®¢æˆ·ç«¯å¼€å‘è–ªèµ„è¦é«˜ï¼›\næˆ‘åªå­¦ Linuxï¼Œä¸å­¦ Windowsã€‚\n\n\næˆ‘ç›¸ä¿¡å¯¹äº 80 å’Œ 90 çš„è¿™ä¸€ä»£å¼€å‘è€…æ¥è¯´ï¼Œå½“åˆæ¥è§¦è®¡ç®—æœºå¹¶è¿›å…¥è½¯ä»¶è¡Œä¸šï¼Œéƒ½æ˜¯ä»æ¥è§¦ Windows å¼€å§‹çš„ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œå¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ç­‰å„ç§æ–°æŠ€æœ¯æ–¹å…´æœªè‰¾ï¼Œç§»åŠ¨äº’è”ç½‘å¦‚ç«å¦‚è¼ã€‚æ— è®ºæ˜¯ Linux è¿˜æ˜¯ Windowsï¼Œå°¤å…¶æ˜¯ Windowsï¼Œä»ç„¶æ˜¯æˆ‘ä»¬å¤§å¤šæ•°äººå·¥ä½œã€å­¦ä¹ ã€å¨±ä¹ä½¿ç”¨æœ€å¤šçš„æ“ä½œç³»ç»Ÿâ€”â€”æˆ‘ä»¬æ¯å¤©éƒ½ä¼šä½¿ç”¨å…¶ä¸Šçš„å„ç§è½¯ä»¶ã€‚ä½¿ç”¨è¿™äº›è½¯ä»¶åƒå–æ°´ã€å‘¼å¸ç©ºæ°”ä¸€æ ·è‡ªç„¶ï¼Œæ‰€ä»¥å¾ˆå¤šäººå°±å¿½è§†äº†è¿™ç±»è½¯ä»¶çš„ â€œåŸºç¡€ä½œç”¨â€ã€‚\nWindows ä¸Šçš„è½¯ä»¶å¼€å‘å‘å±•äº†å¾ˆå¤šå¹´äº†ï¼Œè¿™äº›é¢†åŸŸä¹Ÿæ¯”è¾ƒæˆç†Ÿï¼Œä¸€èˆ¬ä¸å†æ‹›åˆä¸­çº§å¼€å‘ï¼Œè€Œæ˜¯éœ€è¦æ°´å¹³è¾ƒé«˜ã€ç»éªŒè¾ƒä¸°å¯Œçš„é«˜çº§å¼€å‘è€…ã€‚è¿™è®©å¾ˆå¤šäººé€ æˆäº†â€œWindows C++â€å¼€å‘å¸‚åœºéœ€æ±‚å·²ç»å¾ˆå°äº†çš„é”™è§‰ã€‚è¯•é—®ï¼ŒQQ PC éƒ¨é—¨è¿™äº›å¹´å¯¹å¤–æ‹›äº†å¤šå°‘äººï¼Ÿ\nLinux C++ å’Œ Windows C++ ä¸€æ ·ï¼Œæ²¡æœ‰å­°é«˜å­°ä½ä¹‹åˆ†ï¼Œåªæ˜¯ä¸¤ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿè€Œå·²ï¼Œä¸è¦è§‰å¾—åœ¨ Linux ä¸‹æ•²å‘½ä»¤å°±æ¯”åœ¨ Windows çš„å›¾å½¢åŒ–ç•Œé¢ç‚¹å‡»é¼ æ ‡è¾¾é«˜çº§ã€‚\nå›¾å½¢åŒ–ç•Œé¢ä¹‹äºå‘½ä»¤è¡Œï¼Œæ˜¯äººä»¬å¯¹æ›´é«˜çº§ã€æ›´æ–¹ä¾¿çš„å·¥å…·è¿½æ±‚çš„å¿…ç„¶ç»“æœã€‚Linux C++ ä¹Ÿä¸ä¸€å®šå°±æ˜¯åå°å¼€å‘ï¼ŒWindows C++ ä¹Ÿä¸ä¸€å®šå°±æ˜¯å®¢æˆ·ç«¯å¼€å‘ï¼›æ‰€è°“çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯æ˜¯ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œå³è°ç»™è°æä¾›æœåŠ¡ï¼Œæä¾›æœåŠ¡çš„æˆ‘ä»¬è®¤ä¸ºæ˜¯æœåŠ¡ç«¯ï¼ˆåå°ï¼‰ï¼Œè¢«æœåŠ¡çš„æˆ‘ä»¬è®¤ä¸ºæ˜¯å®¢æˆ·ç«¯ï¼ˆå‰å°ï¼‰ã€‚è€Œ Windows ä½œä¸ºåå°æœåŠ¡çš„åº”ç”¨ä¹Ÿæ¯”æ¯”çš†æ˜¯ï¼Œå¦‚ç¬”è€…ä¹‹å‰æ‰€åœ¨çš„æŸäº¤æ˜“æ‰€çš„æœåŠ¡å™¨åå°éƒ½æ˜¯ Windows ä¸‹çš„ C++ ç¨‹åºï¼›å¦å¤–å¦‚ä¸€äº›æ¸¸æˆç±»çš„æœåŠ¡å™¨ç«¯ï¼Œä¹Ÿä¸å°‘æ˜¯ Windows çš„ã€‚\nå€Ÿç”¨ã€ŠUNIX ç¼–ç¨‹è‰ºæœ¯ã€‹è¿™æœ¬ä¹¦çš„è§‚ç‚¹ï¼ŒWindows å’Œ Linux çš„å“²å­¦ç†å¿µä¸ä¸€æ ·ï¼ŒWindows æ˜¯å‡è®¾ä½ ä¸ä¼šæ“ä½œï¼Œå®ƒæ•™ä½ å¦‚ä½•æ“ä½œï¼Œè€Œ Linux æ˜¯å‡è®¾ä½ ä¼šæ“ä½œç„¶åè¿›è¡Œæ“ä½œã€‚æ ¹æ®è¿™ä¸ªç†å¿µï¼ŒWindows ä¸€èˆ¬æ˜¯æ™®é€šäººç”¨çš„å¤šï¼Œè€Œ Linux æ˜¯ç¨‹åºå‘˜ç”¨çš„å¤šã€‚\nä»ç¼–ç¨‹çš„è§’åº¦æ¥è¯´ï¼ŒWindows çš„ä»£ç é£æ ¼æ˜¯æ‰€è°“çš„åŒˆç‰™åˆ©å‘½åæ³•ï¼Œè€Œ Linux æ˜¯çŸ­å°ç²¾æ‚çš„è¿å­—ç¬¦é£æ ¼ã€‚ä¾‹å¦‚åŒä¸€ä¸ªè¡¨ç¤ºå±å¹•å°ºå¯¸çš„æ•´å‹å˜é‡ï¼ŒWindows ä¸Šå¯èƒ½è¢«å‘½åä¸º iScreen æˆ– cxScreen ï¼Œè€Œ Linux å¯èƒ½æ˜¯ screenï¼›å†ä¾‹å¦‚ Windows ä¸Šåˆ›å»ºçº¿ç¨‹çš„å‡½æ•°å« CreateThreadï¼ŒLinux ä¸‹å« pthread_createã€‚æœ‰æ—¶å€™ï¼Œæˆ‘è§‰å¾— Windows çš„åŒˆç‰™åˆ©å‘½åæ³•åè€Œæ›´å®¹æ˜“ç†è§£ä»£ç ã€‚\nè¿™é‡Œæ—¢ç„¶æåˆ°å‰ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰å¼€å‘å’Œåç«¯å¼€å‘ï¼Œè¿™é‡Œä¸å¾—ä¸æä¸€ä¸‹ï¼Œè¿™äºŒè€…æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ã€‚å…¶ä¾§é‡ç‚¹å’Œå¼€å‘æ€ç»´æ˜¯ä¸ä¸€æ ·çš„ï¼Œå‰ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰å¼€å‘ä¸€èˆ¬æœ‰è¾ƒå¤šçš„ç•Œé¢é€»è¾‘ï¼Œå®ƒä»¬æ˜¯ç›´æ¥ä¸ç”¨æˆ·æ‰“äº¤é“ï¼Œå› è€Œä¸€æ¬¾å®¢æˆ·ç«¯è½¯ä»¶çš„å¥½åå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå…¶ç•Œé¢çš„æ˜“ç”¨æ€§å’Œæµç•…æ€§ï¼Œå¼€å‘è€…åªè¦æŠŠè¿™ä¸€ç«¯çš„â€œä¸€äº©ä¸‰åˆ†åœ°â€ç»™ç®¡ç†å¥½å³å¯ï¼›è€Œåç«¯æœåŠ¡ï¼Œå¯¹äºæ™®é€šç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œå¼€å‘è€…çš„ç¨‹åºå¿…é¡»å°½é‡ä½“ç°â€œæœåŠ¡â€è¿™ä¸ªå­—çœ¼ï¼Œå³æ›´æœ‰æ•ˆåœ°ä¸ºæ›´å¤šçš„å®¢æˆ·ç«¯æœåŠ¡ï¼Œè¿™å°±è¦æ±‚å…¼é¡¾è¯·æ±‚å“åº”çš„æ­£ç¡®æ€§ã€åŠæ—¶æ€§å’Œæµç•…æ€§ã€‚\nç”±äºæœåŠ¡è½¯ä»¶ä¹Ÿæ˜¯è¿è¡Œåœ¨æŸå°ç‰©ç†æœºå™¨ä¸Šçš„ç¨‹åºï¼Œé‰´äº CPUã€å†…å­˜ã€ç½‘ç»œå¸¦å®½èµ„æºæœ‰é™ï¼Œè€ŒæœåŠ¡ç¨‹åºä¸€èˆ¬æ˜¯é•¿å‘¨æœŸè¿è¡Œçš„ï¼Œå› æ­¤å¿…é¡»åˆç†åœ°åˆ†é…å’Œä½¿ç”¨èµ„æºï¼ˆå¦‚å°½é‡å›æ”¶ä¸å†ä½¿ç”¨çš„å„ç§èµ„æºï¼‰ã€‚å¼€å‘è€…åº”ä»å…¨å±€è€ƒè™‘ï¼Œä¸èƒ½åœ¨æŸä¸ªâ€œå®¢æˆ·ç«¯â€è¿™ä¸€æ£µæ ‘ä¸Šâ€œåŠæ­»â€ã€‚\nä»ä¸ªäººçš„èŒä¸šå‘å±•æ¥çœ‹ï¼Œå»ºè®®ä»äº‹å®¢æˆ·ç«¯å¼€å‘çš„äººå‘˜é€‚å½“åœ°äº†è§£ä¸€ä¸‹æœåŠ¡å™¨å¼€å‘çš„æ€è·¯ï¼Œåè¿‡æ¥ä¹Ÿå»ºè®®ä»äº‹åç«¯å¼€å‘çš„äººå‘˜å»å­¦ä¹ ä¸€ä¸‹å®¢æˆ·ç«¯å¼€å‘ï¼ŒäºŒè€…ç›¸å¾—ç›Šå½°ã€‚ä»ä¸ªäººçš„æŠ€æœ¯æé«˜æ¥è¯´ï¼Œä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚\nä¾‹å¦‚æ‚¨è¦å­¦ä¹ ä¸€å¥—å¼€æºçš„è½¯ä»¶ä»£ç ï¼Œå¦‚æœæ‚¨ç†Ÿæ‚‰å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„åŸºæœ¬å¼€å‘å’Œè°ƒè¯•æŠ€å·§ï¼Œæ‚¨å¯ä»¥æ›´å¥½åœ°å­¦ä¹ å®ƒã€‚è€Œåœ¨å·¥ä½œä¸Šï¼Œä¸€ä¸ªé¡¹ç›®ï¼Œå¾€å¾€æ˜¯ç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç¨‹åºç»„æˆï¼Œå¦‚æœæ‚¨éƒ½ç†Ÿæ‚‰ï¼Œæ‚¨å¯ä»¥ç«™åœ¨ä¸€ä¸ªæ›´é«˜çš„è§’åº¦å»å®¡è§†å®ƒã€è§„åˆ’å®ƒï¼Œè¿™ä¹Ÿæ˜¯æ¶æ„å¸ˆçš„åŸºæœ¬è¦æ±‚ä¹‹ä¸€ã€‚\næœ€åå°±æ˜¯å¾ˆå¤šè¯»è€…å…³å¿ƒçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„è–ªèµ„é—®é¢˜ï¼Œè¿™ä¸ªæ²¡æœ‰ç»å¯¹çš„è°é«˜è°ä½ï¼Œå› äººè€Œå¼‚ï¼Œå› èƒ½åŠ›è€Œå¼‚ï¼Œå› å²—ä½è€Œå¼‚ã€‚\nå¦‚ä½•çœ‹å¾… C++ 11&#x2F;14&#x2F;17 æ–°æ ‡å‡†C++ å¼€å‘è€…æœ‰ä¸ªä¸æˆæ–‡çš„è§„å®šï¼šå³ä½¿æ‚¨å¯¹ C++ å¾ˆç†Ÿæ‚‰ï¼Œä¹Ÿä¸è¦åœ¨ç®€å†ä¸Šå†™ä¸Šæ‚¨ç²¾é€š C++ï¼ŒåŸå› å¾ˆç®€å•â€”â€” C++ è¿™é—¨è¯­è¨€åŒ…å«çš„ä¸œè¥¿å®åœ¨å¤ªå¤šäº†ï¼Œæ²¡æœ‰äººèƒ½çœŸæ­£â€œç²¾é€šâ€æ‰€æœ‰ã€‚\nC++ æ—¢æ”¯æŒé¢å‘å¯¹è±¡è®¾è®¡ï¼ˆOOPï¼‰ï¼Œä¹Ÿæ”¯æŒä»¥æ¨¡æ¿è¯­æ³•ä¸ºä»£è¡¨çš„æ³›å‹ç¼–ç¨‹ï¼ˆGPï¼‰ã€‚è€Œä¸”æ–°çš„ C++ æ ‡å‡†å’Œéµå¾ª C++ æ–°æ ‡å‡†çš„ç¼–è¯‘å™¨ä¹Ÿå±‚å‡ºä¸ç©·ï¼Œè¿™äº›å¹´ï¼ŒC++ å˜åŒ–è¶Šæ¥è¶Šå¤§ã€è¶Šæ¥è¶Šå¿«ï¼Œä»æœ€åˆä¸šç•Œå’Œå¼€å‘è€…ç¿˜é¦–ä»¥ç›¼çš„ C++11 æ ‡å‡†ï¼Œå†ç» C++14ã€C++17 åˆ°ä»Šå¤©çš„ C++20ï¼Œè¿™é—¨è¯­è¨€ä¸ä¹‹å‰çš„ç‰ˆæœ¬å·®åˆ«è¶Šæ¥è¶Šå¤§ï¼Œæ›´å¤šåŸæ¥éœ€è¦ä½¿ç”¨ç¬¬ä¸‰åº“çš„åŠŸèƒ½ä¹Ÿè¢«é™†ç»­æ·»åŠ åˆ° C++ æ ‡å‡†åº“ä¸­ã€‚ä»¥è‡´äº C++ ä¹‹çˆ¶ Bjarne Stroustrup ä¹Ÿå¼€å§‹å¯¹è¿™é—¨è¯­è¨€è¡¨ç¤ºæ‹…å¿§ï¼š\n\nâ€œC++11 å¼€å§‹çš„åŸºç¡€å»ºè®¾å°šæœªå®Œæˆï¼Œè€Œ C++17 åœ¨ä½¿åŸºç¡€æ›´åŠ ç¨³å›ºã€è§„èŒƒæ€§å’Œå®Œæ•´æ€§æ–¹é¢ï¼ŒåŸºæœ¬æ²¡æœ‰åšå‡ºæ”¹å–„ã€‚ç›¸ååœ°ï¼Œå´å¢åŠ äº†é‡è¦æ¥å£çš„å¤æ‚åº¦ï¼Œè®©äººä»¬éœ€è¦å­¦ä¹ çš„ç‰¹æ€§æ•°é‡è¶Šæ¥è¶Šå¤šã€‚C++ å¯èƒ½åœ¨è¿™ç§ä¸æˆç†Ÿæè®®çš„é‡å‹ä¹‹ä¸‹å´©æºƒï¼Œæˆ‘ä»¬ä¸åº”è¯¥èŠ±è´¹å¤§é‡çš„æ—¶é—´ä¸ºä¸“å®¶çº§ç”¨æˆ·ä»¬ï¼ˆæ¯”å¦‚æˆ‘ä»¬è‡ªå·±ï¼‰å»åˆ›å»ºè¶Šæ¥è¶Šå¤æ‚çš„ä¸œè¥¿ã€‚ï¼ˆè¿˜è¦è€ƒè™‘æ™®é€šç”¨æˆ·çš„å­¦ä¹ æ›²çº¿ï¼Œè¶Šå¤æ‚çš„ä¸œè¥¿è¶Šä¸æ˜“æ™®åŠã€‚ï¼‰â€\n\næ–‡ç« å‚çœ‹è¿™é‡Œï¼šhttps://zhuanlan.zhihu.com/p/48793948ï¼Œåœ¨ Bjarne Stroustrup çš„ä¿¡ä¸­ï¼Œä»–æ‹…å¿ƒ C++ ä¼šåƒå†å²çš„ç“¦è¨å·å†›èˆ°ä¸€æ ·ï¼ŒæŸå¤©æ–°çš„æ ‡å‡†åˆšå¯èˆªï¼ˆå‘å¸ƒï¼‰ä¾¿ç«‹å³æ²‰æ²¡ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬ä¸ç”¨æœ‰è¿™ç§æ‹…å¿§ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ—¢ä¸æ˜¯ C++ æ ‡å‡†å§”å‘˜ä¼šæˆå‘˜ï¼Œä¹Ÿä¸æ˜¯ C++ ç¼–è¯‘å™¨å¼€å‘å‚å•†ã€‚å°±æˆ‘ä¸ªäººç»éªŒæ¥è¯´ï¼Œå¯¹äºC++11ã€C++14ã€C++17 ä¹ƒè‡³ C++20ï¼Œæˆ‘ä»¬å­¦ä¹ å®ƒä»¬çš„å‡†åˆ™åº”è¯¥æ˜¯ä»¥å®ç”¨ä¸ºä¸»ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åº”è¯¥å­¦ä¹ å…¶å®ç”¨çš„éƒ¨åˆ†ï¼Œè‡³äºæ–°æ ‡å‡†æåˆ°çš„ä¸€äº›é«˜çº§ç‰¹æ€§å’Œå„ç§å¤æ‚çš„æ¨¡æ¿ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…å»äº†è§£ã€‚æˆ‘ä»¬å¹¶ä¸æ˜¯åšå­¦æœ¯ç ”ç©¶ï¼Œæˆ‘ä»¬å­¦ä¹  C++ æ˜¯ä¸ºäº†æŠ•å…¥å®é™…çš„ç”Ÿäº§å¼€å‘ï¼Œæ‰€ä»¥åº”è¯¥å»å­¦ä¹  C++ æ–°æ ‡å‡†ä¸­å®ç”¨çš„è¯­æ³•å’Œå·¥å…·åº“ã€‚å…³äº C++11 å¸¸ç”¨ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œè¿™é‡Œä¹Ÿç®€å•åœ°ç»™è¯»è€…åˆ—ä¸¾ä¸€ä¸‹ã€‚\n\nauto å…³é”®å­—\nfor-each å¾ªç¯\nå³å€¼åŠç§»åŠ¨æ„é€ å‡½æ•° + std::forward + std::move + stl å®¹å™¨æ–°å¢çš„ emplace_back() æ–¹æ³•\nstd::thread åº“ã€std::chrono åº“\næ™ºèƒ½æŒ‡é’ˆç³»åˆ—ï¼ˆstd::shared_ptr&#x2F;std::unique_ptr&#x2F;std::weak_ptrï¼‰ï¼Œæ™ºèƒ½æŒ‡é’ˆçš„å®ç°åŸç†ä¸€å®šè¦çŸ¥é“ï¼Œæœ€å¥½æ˜¯è‡ªå·±å®ç°è¿‡\nçº¿ç¨‹åº“ std::thread + çº¿ç¨‹åŒæ­¥æŠ€æœ¯åº“ std::mutex&#x2F;std::condition_variable&#x2F;std::lock_guard ç­‰\nLamda è¡¨è¾¾å¼ï¼ˆJava ä¸­ç°åœ¨ä¹Ÿå¸¸å¸¸è€ƒå¯Ÿ Lamda è¡¨è¾¾å¼çš„ä½œç”¨ï¼‰\nstd::bind&#x2F;std::function åº“\n\nå…¶ä»–çš„å°±æ˜¯ä¸€äº›å…³é”®å­—çš„ç”¨æ³•ï¼ˆoverrideã€finalã€deleteï¼‰ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€äº›ç»†èŠ‚å¦‚å¯ä»¥åƒ Java ä¸€æ ·åœ¨ç±»æˆå‘˜å˜é‡å®šä¹‰å¤„ç»™å‡ºåˆå§‹åŒ–å€¼ã€‚\nC++ è¯­è¨€åŸºç¡€ä¸è¿›é˜¶åŸºç¡€è¿™é‡Œè¯´çš„åŸºç¡€ä¸æ˜¯ç‹­ä¹‰ä¸Šçš„ C++ è¯­è¨€åŸºç¡€ï¼Œè€Œæ˜¯åŒ…æ‹¬ C++ å¼€å‘è¿™ä¸€ç”Ÿæ€ä½“ç³»çš„åŸºç¡€ï¼Œç¬”è€…è®¤ä¸ºçš„åŸºç¡€åŒ…æ‹¬ï¼š\n\nC++ è¯­è¨€æœ¬èº«ç†Ÿç»ƒä½¿ç”¨ç¨‹åº¦ã€‚\nå‰é¢ä¹Ÿä»‹ç»äº†å•çº¯çš„ C++ æ‚¨å•¥ä¹Ÿå¹²ä¸äº†ï¼Œæ‚¨å¿…é¡»ç»“åˆä¸€ä¸ªå…·ä½“çš„æ“ä½œç³»ç»Ÿå¹³å°ï¼Œæ‰€ä»¥å¾—ç†Ÿæ‚‰æŸä¸ªæ“ä½œç³»ç»Ÿå¹³å°çš„ API å‡½æ•°ï¼Œæ¯”å¦‚Linuxï¼Œä»¥åŠè¯¥æ“ä½œç³»ç»Ÿçš„åŸç†ã€‚è¿™é‡Œè¯´çš„æ“ä½œç³»ç»Ÿçš„åŸç†ä¸å±€é™äºæ‚¨åœ¨æ“ä½œç³»ç»ŸåŸç†å›¾ä¹¦ä¸Šçœ‹çš„çŸ¥è¯†ï¼Œè€Œæ˜¯å®å®åœ¨åœ¨ä¸ç³»ç»Ÿ API å…³è”èµ·æ¥çš„ï¼Œå¦‚ç†Ÿç»ƒä½¿ç”¨å„ç§è¿›ç¨‹ä¸çº¿ç¨‹å‡½æ•°ã€å¤šçº¿ç¨‹èµ„æºåŒæ­¥å‡½æ•°ã€æ–‡ä»¶æ“ä½œå‡½æ•°ã€ç³»ç»Ÿæ—¶é—´å‡½æ•°ã€çª—å£è‡ªç»˜ä¸æ“ä½œå‡½æ•°ï¼ˆè¿™ç‚¹é’ˆå¯¹ Windowsï¼‰ã€å†…å­˜åˆ†é…ä¸ç®¡ç†å‡½æ•°ã€PE æˆ– ELF æ–‡ä»¶çš„ç¼–è¯‘ã€é“¾æ¥åŸç†ç­‰ç­‰ã€‚\nç½‘ç»œé€šä¿¡ï¼Œç½‘ç»œé€šä¿¡åœ¨è¿™é‡Œå…·ä½“ä¸€ç‚¹å°±æ˜¯ Socket ç¼–ç¨‹ã€‚è¿™é‡Œçš„ Socket ç¼–ç¨‹ä¸ä»…è¦æ±‚ç†Ÿç»ƒä½¿ç”¨å„ç§ç½‘ç»œ API å‡½æ•°ï¼Œè¿˜è¦æ±‚ç†è§£å’Œçµæ´»è¿ç”¨åƒä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ç­‰å„ç§åŸºç¡€ç½‘ç»œé€šä¿¡åè®®ä¸åŸç†ã€‚å…³äº Socket ç¼–ç¨‹å®è·µï¼Œã€ŠTCP&#x2F;IP ç½‘ç»œç¼–ç¨‹ã€‹è¿™æœ¬ä¹¦æ˜¯éå¸¸å¥½çš„å…¥é—¨æ•™æã€‚\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œæ‚¨å¯èƒ½ä¼šè§‰å¾—å¾ˆæŠ½è±¡ã€‚ç¬”è€…åœ¨è¿™é‡Œä¸¾ä¸ªå…·ä½“ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨è¦å¼€å‘ä¸€ä¸ªç±»ä¼¼ç”µé©´è¿™æ ·çš„è½¯ä»¶ï¼Œè½¯ä»¶ç•Œé¢å¦‚ä¸‹å›¾ï¼š\n\n\n\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æ“ä½œç³»ç»Ÿé€‰æ‹© Windowsï¼Œä½¿ç”¨è¯­è¨€ä½¿ç”¨ C++ï¼Œè¿™å°±è¦æ±‚æ‚¨å¿…é¡»ç†Ÿæ‚‰ C++ å¸¸ç”¨çš„è¯­æ³•ï¼Œå¦‚æœè¿˜ä¸ç†Ÿæ‚‰ï¼Œå°±éœ€è¦è¡¥å……è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚\n\nç”µé©´çš„æºç å¯ä»¥åœ¨å…¬ä¼—å·ã€ é«˜æ€§èƒ½æœåŠ¡å™¨å¼€å‘ ã€‘åå°å›å¤â€œè·å–ç”µé©´æºç â€å³å¯è·å–ã€‚\n\nåœ¨ç†Ÿæ‚‰ C++ è¯­æ³•çš„å‰æä¸‹ï¼Œä»è¿™æ¬¾äº§å“å®ç°æŠ€æœ¯æ¥çœ‹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡äº§å“åˆ†ä¸º UI å’Œç½‘ç»œé€šä¿¡éƒ¨åˆ†ã€‚ä¸‹é¢å°†è¯¦ç»†ä»‹ç»è¿™ä¸¤éƒ¨åˆ†ã€‚\nUI éƒ¨åˆ†å¯¹äº UI éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„è®¤è¯†æ˜¯ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨ Windows çš„çª—å£æŠ€æœ¯ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨åŸç”Ÿçš„ Win 32 API æ¥åˆ¶ä½œè‡ªå·±çš„ç•Œé¢åº“ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸€äº›ç†Ÿæ‚‰çš„ç•Œé¢æ¡†æ¶ï¼Œå¦‚ MFCã€WTLã€Duilibã€wxWidgets ç­‰ã€‚æ— è®ºæ‚¨æ˜¯åœ¨é˜…è¯»åˆ«äººçš„é¡¹ç›®è¿˜æ˜¯éœ€è¦è‡ªå·±å¼€å‘è¿™æ ·çš„é¡¹ç›®ï¼Œåœ¨ç¡®å®šäº†è¿™æ¬¾è½¯ä»¶ä½¿ç”¨çš„ UI åº“ï¼ˆæˆ–è€…ä½¿ç”¨åŸç”Ÿ Win 32 APIï¼‰ï¼Œæ‚¨å°±éœ€è¦å¯¹ Windows çš„çª—å£ã€å¯¹è¯æ¡†ã€æ¶ˆæ¯äº§ç”Ÿã€æ´¾å‘ä¸å¤„ç†æœºåˆ¶è¿›è¡Œäº†è§£ã€‚åŒæ ·çš„é“ç†ï¼Œå¦‚æœä¸ç†Ÿæ‚‰æ‚¨éœ€è¦è¡¥å……ç›¸å…³çš„çŸ¥è¯†ï¼ˆå…³äºè¿™ä¸€ç‚¹ï¼Œä¸‹æ–‡ä¸å†èµ˜è¿°ï¼‰ã€‚\næ¥ç€ï¼Œæ ¹æ®ä¸Šå›¾ä¸­çš„è½¯ä»¶åŠŸèƒ½ï¼Œå¤§è‡´åˆ†ä¸ºä¸‰å¤§æ¨¡å—ï¼Œå³èµ„æºã€ä¸‹è½½å’Œåˆ†äº«ã€‚è¿™ä¸‰å¤§å—æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ª Windows Tab æ§ä»¶å»ç»„ç»‡ï¼Œè¿™ä¸ªæ—¶å€™æ‚¨éœ€è¦äº†è§£ Windows Tab æ§ä»¶çš„ç‰¹æ€§ã€‚\n\nå¯¹äºèµ„æºæ¨¡å—ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçª—å£ä¸­åµŒå…¥äº†ä¸€ä¸ªæµè§ˆå™¨æ§ä»¶ï¼ˆWebBrowser æ§ä»¶ï¼‰ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦äº†è§£è¿™ä¸€ä¸ªåŠŸèƒ½ç‚¹çš„ç›¸å…³çŸ¥è¯†ã€‚å½“ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªåˆ—è¡¨ä¸­æŸä¸ªå…·ä½“çš„èµ„æºï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œä¸‹è½½ã€‚è¿™å°±åˆæ¶‰åŠåˆ° WebBrowser æ§ä»¶ä¸ C++ å®¿ä¸»ç¨‹åºçš„äº¤äº’äº†ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ ActiveX æŠ€æœ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ JavaScript ä¸ C++ äº¤äº’æŠ€æœ¯ã€‚\nå†æ¥çœ‹ä¸‹è½½æ¨¡å—ï¼Œå½“äº§ç”Ÿä¸€ä¸ªä¸‹è½½æ“ä½œæ—¶ï¼Œç•Œé¢ä¸Šä¼šäº§ç”Ÿä»¥ä¸‹ä¸‹è½½åˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨é¡¹ä¼šå®æ—¶æ˜¾ç¤ºä¸‹è½½è¿›åº¦ã€ä¸‹è½½é€Ÿç‡ç­‰å‚æ•°ï¼ŒåŒæ—¶æ­£åœ¨ä¸‹è½½çš„é¡¹ç›®ä¹Ÿå¯ä»¥è¢«æš‚åœã€åœæ­¢å’Œåˆ é™¤ã€‚é‚£ä¹ˆè¿™åˆæ¶‰åŠåˆ° ListView æ§ä»¶çš„ç›¸å…³åŠŸèƒ½ï¼Œä»¥åŠ ListView å¦‚ä½•ä¸åå°ç½‘ç»œé€šä¿¡çš„é€»è¾‘äº¤äº’ã€‚\nåˆ†äº«æ¨¡å—æ˜¯å°†æœ¬åœ°èµ„æºåˆ†äº«åˆ°æœåŠ¡å™¨æˆ–è€…ç»™å…¶ä»–ç”¨æˆ·ã€‚ç•Œé¢å·¦ä¾§æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªå¿«ç…§ï¼Œé‚£ä¹ˆè¿™åˆæ¶‰åŠåˆ°å¦‚ä½•éå†æ–‡ä»¶ç³»ç»Ÿï¼ˆäº†è§£æšä¸¾æ–‡ä»¶ç³»ç»Ÿçš„ APIï¼‰ï¼Œå³ä¾§ä¹Ÿæ˜¯ä¸€ä¸ª ListView æ§ä»¶ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\n\nç½‘ç»œé€šä¿¡éƒ¨åˆ†ç½‘ç»œé€šä¿¡éƒ¨åˆ†ï¼Œä¸»è¦æœ‰ä¸¤å¤§å—ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¸æœåŠ¡ç«¯çš„äº¤äº’ï¼›ç¬¬äºŒä¸ªå°±æ˜¯æ–‡ä»¶ä¸‹è½½ä¸åˆ†äº«çš„ P2P ç½‘ç»œã€‚æ‚¨åœ¨é˜…è¯»æˆ–å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¯¹è¿™äº›æŠ€æœ¯æ¯”è¾ƒé™Œç”Ÿï¼Œæ‚¨éœ€è¦è¡¥å……è¿™äº›çŸ¥è¯†ï¼Œå…·ä½“çš„å°±æ˜¯ Socket çš„å„ç§ API å‡½æ•°ï¼Œä»¥åŠåŸºäºè¿™äº› API é€»è¾‘çš„ç»„åˆã€‚å½“ç„¶å¯èƒ½ä¹Ÿä¼šç”¨åˆ°æ“ä½œç³»ç»Ÿå¹³å°æ‰€ç‰¹æœ‰çš„ç½‘ç»œ API å‡½æ•°ï¼Œå¦‚ WSAAsyncSelect ç½‘ç»œæ¨¡å‹ã€‚\nå¦å¤–ä¸€ç‚¹ï¼Œç½‘ç»œé€šä¿¡éƒ¨åˆ†å¦‚ä½•ä¸ UI éƒ¨åˆ†è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œæ˜¯ä½¿ç”¨é˜Ÿåˆ—ï¼Ÿå…¨å±€å˜é‡ï¼Ÿæˆ–è€…ç›¸åº”çš„ Windows æ“ä½œå¹³å°æä¾›çš„ç‰¹æ®Šé€šä¿¡æŠ€æœ¯ï¼Œå¦‚ PostMessage å‡½æ•°ã€ç®¡é“ï¼Ÿå¦‚æœä½¿ç”¨é˜Ÿåˆ—ï¼Œå¤šçº¿ç¨‹ä¹‹é—´å¦‚ä½•ä¿æŒèµ„æºçš„ä¸€è‡´æ€§å’Œè§£å†³èµ„æºç«æ€ï¼Œä½¿ç”¨ Eventã€CriticalSectionã€Mutexã€Semaphore ç­‰ï¼Ÿ\nå½“ç„¶ï¼Œç¬”è€…è¿™é‡Œåªåˆ—ä¸¾äº†è¿™ä¸ªè½¯ä»¶çš„ä¸»å¹²éƒ¨åˆ†ï¼Œè¿˜æœ‰è®¸å¤šæ–¹æ–¹é¢é¢çš„ç»†èŠ‚éœ€è¦è€ƒè™‘ã€‚è¿™å°±éœ€è¦è¯»è€…æ ¹æ®è‡ªå·±çš„æƒ…å†µï¼Œæ–Ÿé…Œå’Œç­›é€‰äº†ã€‚æ‚¨æƒ³è¾¾åˆ°ä»€ä¹ˆç›®çš„ï¼Œå°±è¦å»å­¦ä¹ å’Œç ”ç©¶ç›¸å…³çš„ä»£ç ã€‚\næ€»ç»“èµ·æ¥ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å…¬å¼ï¼š\n\nä¸€æ¬¾ C++ è½¯ä»¶ &#x3D; C++ è¯­æ³• + æ“ä½œç³»ç»Ÿ API å‡½æ•°è°ƒç”¨\n\nè¿›é˜¶å¦‚æœæ‚¨è¾¾åˆ°äº†æˆ‘ä¸Šé¢è¯´çš„ä¸‰ç‚¹åï¼Œå¯ä»¥å†æ‰¾ä¸€äº›é«˜è´¨é‡çš„å¼€æºé¡¹ç›®å»å®æˆ˜ä¸€ä¸‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ€å¥½æ‰¾ä¸€äº›æ²¡æœ‰å¤æ‚ä¸šåŠ¡æˆ–è€…æ‚¨ç†Ÿæ‚‰å…¶ä¸šåŠ¡çš„å¼€æºé¡¹ç›®ï¼ˆå¦‚å¼€æºçš„ IM ç³»ç»Ÿï¼‰ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰å…¶ä¸šåŠ¡ï¼Œä¸ä»…è¦å­¦ä¹ å…¶ä¸šåŠ¡ï¼ˆè½¯ä»¶åŠŸèƒ½ï¼‰ï¼Œè¿˜éœ€è¦å†å»å­¦ä¹ å®ƒçš„æºç ï¼Œæœ€åå¯èƒ½è®©æˆ‘ä»¬è¿·å¤±äº†æœ€åˆå­¦ä¹ è¿™æ¬¾è½¯ä»¶çš„ç›®çš„ã€‚\nå­¦ä¹ è¿™äº›é¡¹ç›®çš„åŒæ—¶ï¼Œè¯»è€…åº”è¯¥å…ˆç¡®å®šè‡ªå·±çš„å­¦ä¹ ç›®çš„ï¼Œå¦‚æœæ‚¨çš„ç›®çš„æ˜¯å­¦ä¹ å’Œå€Ÿé‰´è¿™æ¬¾è½¯ä»¶çš„æ¶æ„ï¼Œé‚£ä¹ˆå…ˆä»æ•´ä½“å»æŠŠæ¡ï¼Œä¸è¦ä¸€å¼€å§‹å°±è¿·å¤±åœ¨ç»†ææœ«èŠ‚ä¸­ï¼Œè¿™ç±»æˆ‘ç§°ä¹‹ä¸ºâ€œç²—è¯»â€ï¼›æˆ–è€…æ‚¨çš„ç›®çš„æ˜¯å­¦ä¹ å¼€æºè½¯ä»¶åœ¨ä¸€äº›ç»†èŠ‚ä¸Šçš„å¤„ç†ä¸åšæ³•ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ‚¨å¯ä»¥é’ˆå¯¹æ€§åœ°å»é˜…è¯»æ‚¨æ„Ÿå…´è¶£çš„æ¨¡å—ï¼Œæ·±å…¥åˆ°æ¯ä¸€è¡Œä»£ç ä¸Šã€‚\nå­¦ä¹ å¼€æºè½¯ä»¶å­˜åœ¨ä¸€ç§é£æ°”ï¼Œè®¸å¤šæ–°æ‰‹å–œæ¬¢é“å¬é€”è¯´ï¼Œä¸€å¬åˆ«äººè¯´è¿™ä¸ªè½¯ä»¶ä¸å¥½ï¼Œé‚£ä¸ªè½¯ä»¶å­˜åœ¨æŸæŸç‘•ç–µå°±æ”¾å¼ƒé˜…è¯»å®ƒçš„æ‰“ç®—äº†ã€‚ç„¶ååˆ°äº†å®é™…å¼€å‘ä¸­ï¼Œå› ä¸ºå¿ƒä¸­æ²¡æœ‰ä»»ä½•å·²æœ‰è½¯ä»¶å¼€å‘é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œäº§ç”ŸæŒ«è´¥æ„Ÿï¼Œä¹…è€Œä¹…ä¹‹å°±å¯¹æœ¬æ¥å–œæ¬¢çš„ C&#x2F;C++ å¼€å‘å¤±å»äº†å…´è¶£ã€‚\nå­¦ä¹ çš„è¿‡ç¨‹æ˜¯å…ˆæ¥è§¦ï¼Œå†ç†Ÿæ‚‰ï¼Œå†æ¨¡ä»¿ï¼Œå†åˆ›é€ ã€‚ä¸ç®¡ä»€ä¹ˆå¼€æºé¡¹ç›®ï¼Œåœ¨æ‚¨å¿ƒä¸­æ²¡æœ‰ä»»ä½•æ€è·¯æˆ–è€…è§£å†³æ–¹æ¡ˆæ—¶ï¼Œæ‚¨åº”è¯¥å…ˆæ¥è§¦ç†Ÿæ‚‰ï¼Œä¸æ–­æ¨¡ä»¿ï¼Œåšåˆ°è‡³å°‘å¿ƒä¸­æœ‰ä¸€å¥—å¯¹äºæŸåœºæ™¯çš„è§£å†³æ–¹æ¡ˆï¼Œç„¶åå†æ¥è°ˆåˆ›æ–°è°ˆæ‰¹åˆ¤ã€æ”¹é€ åˆ«äººçš„é¡¹ç›®ã€‚\næˆ‘ä¸ªäººå­¦ä¹ ä¸€å¥—é™Œç”Ÿçš„å¼€æºé¡¹ç›®æ—¶ï¼Œæ€»æ˜¯å–œæ¬¢å°†ç¨‹åºç”¨è°ƒè¯•å™¨æ­£å¸¸è·‘èµ·æ¥ï¼Œç„¶åå†ä¸­æ–­ä¸‹æ¥ï¼Œç»Ÿè®¡å½“å‰çš„çº¿ç¨‹æ•°ç›®ï¼Œç„¶åé€šè¿‡ç¨‹åºå…¥å£ main å‡½æ•°ä»ä¸»çº¿ç¨‹è¿½è¸ªå…¶ä»–å·¥ä½œçº¿ç¨‹æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼›æ¥ç€ï¼Œåˆ†æå’Œç ”ç©¶æ¯ä¸ªçº¿ç¨‹çš„ç”¨é€”ä»¥åŠçº¿ç¨‹ä¹‹é—´äº¤äº’çš„ï¼Œè¿™å°±æ˜¯æ•´ä½“æŠŠæ¡ï¼Œæ¥ç€æ‰¾æˆ‘æ„Ÿå…´è¶£çš„ç»†èŠ‚å»å­¦ä¹ ã€‚\nè¿™é‡Œæˆ‘ä»¥å­¦ä¹  Redis ä¸ºä¾‹ã€‚å°† Redis æºç ä»å®˜ç½‘ä¸‹è½½ä¸‹æ¥ä»¥åï¼Œä½¿ç”¨å–œæ¬¢çš„ä»£ç é˜…è¯»å™¨è¿›è¡Œç®¡ç†ã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ Visual Studioï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nåœ¨å¤§è‡´äº†è§£äº† Redis æœ‰å“ªäº›ä»£ç æ¨¡å—ä»¥åï¼Œæˆ‘ä»¬æŠŠä»£ç æ‹·è´åˆ° Linux å¹³å°ï¼Œç„¶åç¼–è¯‘å¹¶ä½¿ç”¨ GDB è°ƒè¯•å™¨è·‘èµ·æ¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nç„¶åæŒ‰ CTRL+C å°† GDB ä¸­æ–­ä¸‹æ¥ï¼Œè¾“å…¥ info threads æŸ¥çœ‹å½“å‰ç¨‹åºçš„æ‰€æœ‰çº¿ç¨‹ï¼š\n\næ¥ç€æŒ¨ä¸ªä½¿ç”¨ thread + çº¿ç¨‹ç¼–å· å’Œ bt å‘½ä»¤å»æŸ¥çœ‹æ¯ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡è°ƒç”¨å †æ ˆï¼š\n\nå¯¹ç…§æ¯ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡å †æ ˆï¼Œææ¸…æ¥šå…¶é€»è¾‘ï¼Œå¹¶ç»“åˆä¸»çº¿ç¨‹ï¼Œçœ‹çœ‹æ¯ä¸ªçº¿ç¨‹æ˜¯åœ¨ä½•æ—¶å¯åŠ¨çš„ï¼Œç«¯å£åœ¨ä½•æ—¶å¯åŠ¨ä¾¦å¬çš„ï¼Œç­‰ç­‰ã€‚åšå®Œè¿™ä¸€æ­¥ï¼Œå…³äº redis-server çš„æ¡†æ¶ä¹ŸåŸºæœ¬æ¸…æ¥šäº†ã€‚\næ¥ç€æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªè‡ªå·±æ„Ÿå…´è¶£çš„å‘½ä»¤ï¼Œææ¸…æ¥š redis-cli ä¸ redis-server å‘½ä»¤çš„äº¤äº’æµç¨‹ã€‚\næœ€åï¼Œå¦‚æœå¯¹ redis-server æºç ä¸­å„ç§æ•°æ®ç»“æ„å’Œç»†èŠ‚æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ·±å…¥åˆ°å…·ä½“çš„ä»£ç ç»†èŠ‚ã€‚\nå½“ç„¶ï¼Œä¸ç†Ÿæ‚‰ GDB çš„è¯»è€…çœ‹ç¬”è€…è¿™æ®µæ“ä½œæµç¨‹æ¯”è¾ƒå›°éš¾ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œè¯´æ˜å¦‚æœæƒ³é€šè¿‡è°ƒè¯•å»ç ”ç©¶ Redis è¿™ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼Œæ‚¨éœ€è¦å»è¡¥å……ä¸€ç‚¹ GDB è°ƒè¯•çš„çŸ¥è¯†ã€‚è¿™å°±æ˜¯æˆ‘ä¸Šæ–‡ä¸­æ‰€è¯´çš„ï¼Œé’ˆå¯¹æ€§åœ°è¡¥ç¼ºè¡¥å·®ã€‚\nC++ é¢è¯•å…³äº C++ é¢è¯•ï¼Œé¢è¯•çš„è¦æ±‚åˆ°åº•æ˜¯ä¾§é‡ä»£ç é‡ã€é¡¹ç›®ç»éªŒï¼Œè¿˜æ˜¯ä¾§é‡æ“ä½œç³»ç»Ÿã€æ•°æ®ç»“æ„è¿™ç§åŸºç¡€çŸ¥è¯†ï¼Ÿæˆ‘åœ¨çŸ¥ä¹ä¸Šæ›¾ç»ä¸“é—¨å†™è¿‡ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»æˆ‘æ›¾ç»çš„ C++ é¢è¯•ç»å†å’Œç»éªŒï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ï¼šhttps://www.zhihu.com/question/264198516/answer/341999235ã€‚\nå…³äº C++ é¢è¯•å¸¸è§çš„é¢è¯•é¢˜ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œï¼šhttps://zhuanlan.zhihu.com/p/45668078ï¼Œè¿™ç¯‡æ–‡ç« é—®é¢˜ç‚¹æ•´ç†å¾—éå¸¸è¯¦ç»†ï¼Œè¯»è€…å¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ä»…ä»…æ˜¯ C++ é¢è¯•ï¼Œå…¶ä»–è¯­è¨€å¼€å‘é¢è¯•ä¹Ÿæ˜¯ä¸€æ ·ã€‚å¦‚æœæ‚¨æ˜¯æƒ³è¿›å…¥å¤§å‹äº’è”ç½‘å…¬å¸çš„åº”å±Šç”Ÿï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä¼˜å…ˆå¥½å¥½å‡†å¤‡ç®—æ³•å’Œæ•°æ®ç»“æ„çŸ¥è¯†ä»¥åº”å¯¹é¢è¯•ï¼Œè¿™æ˜¯å¤§å‹äº’è”ç½‘å…¬å¸é¢è¯•é¢‘ç‡æœ€é«˜çš„è€ƒå¯ŸèŒƒå›´ã€‚è‡³äºå…¶ä»–çš„åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æ“ä½œç³»ç»ŸåŸç†ã€ç½‘ç»œé€šä¿¡ç­‰ï¼ˆä½œä¸ºè®¡ç®—æœºç›¸å…³ä¸“ä¸šçš„å­¦ç”Ÿï¼Œè¿™äº›åº”è¯¥æ˜¯æ‚¨çš„ä¸“ä¸šè¯¾ï¼‰ï¼Œå¦‚æœæ‚¨å·²ç»åœ¨å¹³æ—¶çš„å­¦ä¹ ä¸­æŒæ¡å¾—å¾ˆå¥½ï¼Œé‚£å°±ä¸ç”¨æ‹…å¿ƒï¼Œè¿™ç±»é—®é¢˜ä¸€èˆ¬å¯¹äºåº”å±Šç”Ÿæ±‚èŒä¸ä¼šé—®å¾—å¤ªæ·±ï¼›å€˜è‹¥æ‚¨å°šæœªå­¦å¾—æ‰å®ï¼Œè€Œæ˜¥æ‹›æˆ–ç§‹æ‹›åˆæ—¶é—´ä¸´è¿‘ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å‡†å¤‡è¿™äº›ï¼Œæ‚¨åº”è¯¥åªæ˜¯å°½é‡å»è¡¥ï¼Œå®åœ¨æ¥ä¸åŠä¹Ÿæ²¡å…³ç³»ï¼Œè¿˜æ˜¯åº”è¯¥æŠŠé‡å¿ƒæ”¾åœ¨å¥½å¥½å‡†å¤‡ç®—æ³•å’Œæ•°æ®ç»“æ„ç­‰çŸ¥è¯†ä¸Šã€‚\nå¯¹äºç¤¾ä¼šäººå£«å‚åŠ çš„ C++ èŒä½çš„é¢è¯•ï¼Œå¦‚æœæ˜¯å¤§å‹äº’è”ç½‘å…¬å¸ï¼Œè™½ç„¶ç¤¾ä¼šæ‹›è˜é—®çš„æ›´å¤šçš„æ˜¯é¡¹ç›®ç»éªŒï¼Œé€‚å½“åœ°ä¸ºä¸€äº›åŸºç¡€çš„ç®—æ³•å’Œæ•°æ®ç»“æ„çŸ¥è¯†åšä¸€äº›å‡†å¤‡ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœé—®åˆ°äºŒåˆ†æŸ¥æ‰¾è¿™ä¸€ç±»åŸºç¡€ç®—æ³•ï¼Œå¦‚æœç­”ä¸å‡ºæ¥æœªå…ä¼šè®©é¢è¯•å®˜å°è±¡ä¸å¤ªå¥½ï¼Œåœºé¢ä¹Ÿæ¯”è¾ƒå°´å°¬ã€‚å¦å¤–ï¼ŒC++ æ˜¯ä¸€é—¨è®²ç©¶æ·±åº¦çš„ç¼–ç¨‹æŠ€èƒ½ï¼Œå¯¹äºæœ‰ä¸€å®šå·¥ä½œå¹´é™çš„é¢è¯•è€…ï¼Œé¢è¯•å®˜å¾€å¾€ä¼šé—®å¾ˆå¤šåŸç†æ€§çš„ç»†èŠ‚ï¼Œè¿™å°±è¦æ±‚å¹¿å¤§ C++ å¼€å‘è€…åœ¨å¹³å¸¸å¤šç•™å¿ƒã€å¤šç§¯ç´¯ã€å¤šæ€è€ƒæŠ€æœ¯èƒŒåçš„åŸç†ã€‚\nå¯¹äºå¤§å¤šæ•°å°å‹ä¼ä¸šï¼Œæ— è®ºæ˜¯åº”å±Šç”Ÿè¿˜æ˜¯ç¤¾ä¼šäººå£«ï¼Œåªè¦æœ‰èƒ½åŠ›èƒœä»»ä¸€å®šçš„å·¥ä½œå³å¯ã€‚ä¸€èˆ¬åªè¦å¯¹æ‰€é¢è¯•çš„å…¬å¸é¡¹ç›®æœ‰ç±»ä¼¼ç»éªŒæˆ–è€…ç›¸å…³çš„æŠ€æœ¯èƒ½åŠ›ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥é€šè¿‡é¢è¯•ã€‚å¤§å¤šæ•°å°å…¬å¸åœ¨ä¹çš„æ˜¯æ‚¨æ¥äº†èƒ½ä¸èƒ½å¹²æ´»ï¼Œæ‰€ä»¥è¿™ç±»å…¬å¸å¯¹å®é™…é¡¹ç›®ç»éªŒå’ŒæŠ€èƒ½è¦æ±‚æ›´é«˜ä¸€ç‚¹ã€‚\nå…³äºé¡¹ç›®ç»éªŒï¼Œè®¸å¤šäººå¯èƒ½è§‰å¾—é¡¹ç›®ç»éªŒä¸€å®šæ˜¯è‡ªå·±å‚ä¸çš„é¡¹ç›®ï¼Œå…¶å®ä¸ç„¶ï¼Œé¡¹ç›®ç»éªŒä¹Ÿå¯ä»¥æ¥æºäºæ‚¨é˜…è¯»å’Œå­¦ä¹ å…¶ä»–äººçš„é¡¹ç›®ä»£ç æˆ–è€…å¼€æºè½¯ä»¶ï¼Œåªè¦æ‚¨èƒ½çœ‹æ‡‚å¹¶ç†è§£å®ƒä»¬ï¼Œåœ¨é¢è¯•çš„æ—¶å€™æåŠåˆ°ï¼Œèƒ½æ¡ç†æ¸…æ™°ã€è‡ªåœ†å…¶è¯´å³å¯ã€‚å½“ç„¶ï¼Œå¦‚æœä¸ç†Ÿæ‚‰æˆ–è€…åªæ˜¯äº†è§£äº›çš®æ¯›ï¼Œåˆ‡è®°ä¸å¯ä¿¡å£å¼€æ²³ã€èƒ¡ç¼–ä¹±é€ ç”šè‡³å¼ å† ææˆ´ã€‚\næˆ‘æ›¾ç»é¢è¯•è¿‡ä¸€äº›å¼€å‘è€…ï¼Œçœ‹ç®€å†é¡¹ç›®ç»éªŒä¸°å¯Œï¼Œå®é™…ä¸€é—®çš„æ—¶å€™ï¼Œåªæ˜¯æŠŠåˆ«äººçš„æ¡†æ¶æˆ–è€…åº“æ‹¿æ¥åŒ…è£…è°ƒç”¨ä¸€ä¸‹ï¼Œé—®åŠå…¶æŠ€æœ¯åŸç†æ—¶ï¼Œä¸æ˜¯é¡¾å·¦å³è€Œè¨€ä»–å°±æ˜¯è¯´ä¸æ¸…é“ä¸æ˜æ¨¡æ£±ä¸¤å¯å«ç³Šä¸æ¸…ï¼Œè¿™ä¸€ç±»äººå¾€å¾€æ¯”ä¸çŸ¥é“è¿˜è®©äººè®¨åŒï¼Œé¢è¯•å®˜ä¸€èˆ¬åæ„Ÿè¿™ä¸€ç±»é¢è¯•è€…æ‰€è°“çš„é¡¹ç›®ç»éªŒã€‚\nå­¦ç”Ÿä¸ç¤¾ä¼šäººå£«å­¦ä¹  C++ æ–¹å¼çš„åŒºåˆ«ä½œä¸ºå­¦ç”Ÿæœ‰å……è£•çš„æ—¶é—´ï¼Œå»ºè®®é™¤äº†æŠŠ C++ è¯­æ³•å­¦å¥½ï¼Œç³»ç»Ÿåœ°å¤šè¯»ä¸€ç‚¹åŸºç¡€çš„ä¹¦ç±ï¼Œå¦‚æ“ä½œç³»ç»ŸåŸç†ã€ç½‘ç»œç¼–ç¨‹ã€æ•°æ®ç»“æ„ä¸ç®—æ³•ç­‰ç›¸å…³å„æ–¹å„é¢çš„ç»å…¸ä¹¦ç±ã€‚\nå¯ä»¥å‚è€ƒä¸‹è¿™é‡Œï¼š\n\nhttps://mp.weixin.qq.com/s/EjgtX2Wghia7ajn2AugCtw\n\nå°½é‡åšåˆ°ç­‰æ‚¨æ¯•ä¸šèµ°å‡ºæ ¡å›­ä»¥åï¼Œè‡³å°‘ç†Ÿæ‚‰ä¸€é—¨ç¼–ç¨‹è¯­è¨€å’Œå…¶ç›¸åº”çš„å¼€å‘ç¯å¢ƒï¼Œè¿™å°±æ˜¯ä¸€ä¸ªåŸºç¡€æ‰å®ã€ç†è®ºæ¸…æ™°ã€ç¼–ç èƒ½åŠ›å¼ºçš„æ±‚èŒè€…ã€‚å¯æƒœçš„æ˜¯ï¼Œä»ç°åœ¨çš„å„ç§æ‹›è˜åé¦ˆæ¥çœ‹ï¼Œå¤§å¤šæ•°å­¦ç”Ÿåœ¨æ±‚èŒæ—¶ï¼Œå¯¹ç›¸å…³å¼€å‘å·¥å…·å’Œè¯­è¨€çš„é™Œç”Ÿç¨‹åº¦å®åœ¨è®©äººç ç›®ç»“èˆŒï¼Œé¢è¯•å®˜åœ¨é¢è¯•çš„æ—¶å€™ä¼šå¾ˆçº³é—·ï¼šè¿™ä½å­¦ç”Ÿå¤§å­¦å››å¹´ï¼ˆæˆ–è€…ä¸ƒå¹´ï¼‰åˆ°åº•æ˜¯å¦è°ƒè¯•è¿‡ç¨‹åºï¼Ÿ\nç¤¾ä¼šäººå£«ç”±äºå·²ç»èµ°ä¸Šå·¥ä½œå²—ä½ï¼Œå®¶åº­ã€å·¥ä½œçš„çäº‹ç¹å¤šï¼Œæ²¡æœ‰å¤ªå¤šçš„æ—¶é—´å»ç³»ç»Ÿåœ°é˜…è¯»ä¸€äº›ç›¸å…³åŸºç¡€ä¹¦ç±ï¼Œå¦‚æœæ‚¨å½“å‰å·¥ä½œæ­£å¥½æ˜¯ä»äº‹ C&#x2F;C++ å¼€å‘ï¼Œé‚£ä¹ˆè¯·ç»“åˆæ‚¨å½“å‰çš„é¡¹ç›®æ¥å­¦ä¹ ï¼Œææ¸…æ¥šé¡¹ç›®çš„ä½“ç³»ç»“æ„ã€å¸æ”¶é¡¹ç›®ä¸­ä¼˜ç§€çš„å®ç°ç»†èŠ‚ï¼Œé’ˆå¯¹æ€§åœ°è¡¥å……ç›¸å…³çŸ¥è¯†ï¼Œè¿™æ˜¯è¿›æ­¥æœ€å¿«çš„æ–¹å¼ã€‚\nä½†æ˜¯å®é™…æƒ…å½¢ä¸­ï¼Œå¾ˆå¤šäººè§‰å¾—å…¬å¸çš„é¡¹ç›®ä»£ç åˆçƒ‚åˆæ‚ï¼Œä¸æ„¿æ„å»ç ”ç©¶ã€‚è¿™ç§æ€æƒ³åƒä¸‡ä¸èƒ½æœ‰çš„ï¼Œåœ¨æ‚¨æ²¡æœ‰è‡ªå·±è¶³å¤Ÿå¥½çš„èƒ½åŠ›ç»™å…¬å¸æä¾›æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œè¯·å…ˆå­¦ä¹ å’Œæ¨¡ä»¿ï¼Œæˆ‘ä»¬æ­¤æ—¶è¦ä¿æŒâ€œç©ºæ¯â€å¿ƒæ€ï¼Œå…¬å¸çš„ä»£ç å†çƒ‚ï¼Œå®ƒä¹Ÿæ˜¯å…¬å¸çš„å•†ä¸šä»·å€¼æ‰€åœ¨ï¼›å³ä½¿æ˜¯çº¯ç²¹çš„ä¸šåŠ¡ä»£ç ï¼Œä¹Ÿæœ‰å®ƒçš„å¯å–ä¹‹å¤„ï¼Œæ‹©å…¶å–„è€…è€Œä»ä¹‹ï¼Œå…¶ä¸å–„è€…è€Œæ”¹ä¹‹ã€‚å°¤å…¶æ˜¯å¼€å‘è€…å¤„äºä¸€äº›åˆä¸­çº§çš„å¼€å‘å²—ä½æ—¶ï¼Œå¯èƒ½æ¥è§¦ä¸åˆ°å…¬å¸æ ¸å¿ƒæ¡†æ¶çš„æºç ï¼Œæ­¤æ—¶åƒä¸‡ä¸è¦ç›²ç›®åœ°å»æ’æ–¥ã€‚å­¦ä¸šåŠ¡ï¼Œè¡¥åŸºç¡€ï¼Œæ—¶åˆ»æ„è¯†æ¸…é†’è‡ªå·±æ‰€éœ€ï¼Œæ˜ç™½è‡ªå·±æƒ³è¦å­¦çš„ä¸œè¥¿ã€‚\nå¦‚æœä»äº‹çš„ä¸æ˜¯ C++ ç›¸å…³çš„å¼€å‘ï¼Œé‚£ä¹ˆå¯ä»¥æŒ¤å‡ºä¸€äº›æ—¶é—´å»å­¦ä¹ ä¸€äº›å¼€æºçš„ä»£ç ï¼Œåœ¨é˜…è¯»å¼€æºä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œé’ˆå¯¹æ€§åœ°è¡¥ç¼ºè¡¥å·®ã€‚ä¸å»ºè®®ç³»ç»Ÿåœ°å»çœ‹ã€ŠC++ Primer ä¸­æ–‡ç‰ˆã€‹ã€ŠUNIX ç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹è¯¸å¦‚æ­¤ç±»çš„å¤§éƒ¨å¤´ä¹¦ç±ï¼Œå®é™…å¼€å‘ä¸­ä¸éœ€è¦å¤ªå¤šè¿™ç±»ä¹¦ä¸­çš„ç»†ææœ«èŠ‚ï¼Œé˜…è¯»è¿™ç±»ä¹¦å¾€å¾€åªä¼šäº‹å€åŠŸåŠï¼Œç”šè‡³æœ€åå› ä¹¦ç±å¤ªåšã€æ—¶é—´ä¸å¤Ÿï¼Œæœ€ååšæŒä¸ä¸‹å»ï¼Œæœ€ç»ˆæ”¾å¼ƒã€‚\nå½“ç„¶ï¼Œå¯¹äºç¤¾ä¼šäººå£«ï¼Œå½“æ‚¨æœ‰ä¸€å®šçš„æ—¶é—´çš„æ—¶å€™ä¸€å®šè¦å»è¡¥å……ä¸€äº›åŸºç¡€çš„ã€åŸç†æ€§çš„ä¸œè¥¿ï¼Œåƒä¸‡ä¸è¦æ²‰æººäºâ€œé¢å‘æœç´¢å¼•æ“ç¼–ç¨‹â€æˆ–è€…â€œé¢å‘å·¥èµ„ç¼–ç¨‹â€ï¼Œæœ‰äº›é—®é¢˜è™½ç„¶å½“æ—¶é€šè¿‡æœç´¢å¼•æ“è§£å†³äº†ï¼Œä½†å¦‚æœæƒ³åœ¨æŠ€æœ¯æˆ–èŒä¸šä¸Šæœ‰é•¿è¶³çš„å‘å±•ï¼Œä¸€å®šè¦ç³»ç»Ÿåœ°å»è¯»ä¸€äº›ç»å…¸çš„ã€è½»é‡çº§çš„ä¹¦ç±ï¼ˆå¦‚ã€ŠC++ å¯¹è±¡æ¨¡å‹ã€‹ï¼‰ã€‚é•¿æœŸåœ¨ç½‘ä¸Šçš„æ–‡ç« ä¸­å¯»ç« æ‘˜å¥ï¼Œåªä¼šè®©æ‚¨çš„çŸ¥è¯†ç»“æ„ç¢ç‰‡åŒ–ã€å‡Œä¹±åŒ–ï¼Œç”šè‡³æ··ä¹±åŒ–ã€‚è€Œä¸”äº’è”ç½‘ä¸Šçš„æŠ€æœ¯æ–‡ç« è´¨é‡è‰¯è ä¸é½ï¼Œæœ‰æ—¶å€™ä¹Ÿå®¹æ˜“å¯¹è‡ªå·±å½¢æˆè¯¯å¯¼å’Œä¾èµ–ã€‚æ€»è€Œè¨€ä¹‹ï¼Œä½œä¸ºæŠ€æœ¯å¼€å‘äººå‘˜ï¼Œæé«˜è‡ªå·±æŠ€æœ¯æ°´å¹³æ˜¯æ”¹å˜ç°çŠ¶ã€æ”¹å–„ç”Ÿæ´»æœ€ç›´æ¥çš„é€”å¾„ã€‚\nå°ç»“å…³äº C&#x2F;C++ï¼Œæš‚ä¸”å°±è®¨è®ºè¿™ä¹ˆå¤šã€‚æœ€åå†å¼ºè°ƒä¸€éï¼ŒC++ æ˜¯ä¸€é—¨è®²ç©¶æ·±åº¦çš„è¯­è¨€ï¼Œå…¶â€œæ·±åº¦â€ä¸æ˜¯ä½“ç°åœ¨ä¼šå¤šå°‘ C++ è¯­æ³•ï¼Œè€Œæ˜¯èƒ½å¤Ÿæ´å¯Ÿæ‚¨æ‰€å†™çš„ C++ ä»£ç èƒŒåçš„ç³»ç»ŸåŸç†ï¼Œè¿™æ˜¯éœ€è¦é•¿æœŸä¸æ–­çš„ç§¯ç´¯çš„ï¼Œæ²¡æœ‰é€Ÿæˆä¹‹æ³•ã€‚åè¿‡æ¥ä¸€æ—¦å­¦æˆï¼Œå¯ä»¥å¿«é€Ÿåœ°å­¦ä¹ å…¶ä»–è¯­è¨€å’Œæ¡†æ¶ã€‚ä¸ªäººè§‰å¾—ï¼Œå¦‚æœè‡ªä¸»åˆ›ä¸šæˆ–è€…æƒ³åœ¨äºŒä¸‰çº¿åŸå¸‚é•¿æœŸå‘å±•çš„è¯»è€…ï¼ŒC&#x2F;C++ åº”è¯¥æ˜¯ä¼˜é€‰è¯­è¨€ï¼Œæœ‰äº†å®ƒä½œä¸ºåŸºç¡€ï¼Œæ‚¨å¯ä»¥è·³å‡ºä¾èµ–å„ç§ç¯å¢ƒå’Œæ¡†æ¶çš„çª è‡¼ï¼Œå¿«é€Ÿåœ°å­¦ä¹ å’Œå¼€å‘æ‚¨æƒ³è¦çš„è½¯ä»¶ï¼Œå®Œæˆæ‚¨æƒ³è¦çš„ä¸šåŠ¡äº§å“ã€‚\næœ€åï¼Œé™äºç¬”è€…ç»éªŒæ°´å¹³æœ‰é™ï¼Œæ¬¢è¿è¯»è€…å°±æ–‡ä¸­çš„è§‚ç‚¹æå‡ºå®è´µçš„å»ºè®®å’Œæ„è§ã€‚å¦‚æœæƒ³è·å¾—æ›´å¤šçš„å­¦ä¹ èµ„æºæˆ–è€…æƒ³ä¸æˆ‘åšè¿›ä¸€æ­¥äº¤æµï¼Œå¯ä»¥åŠ æˆ‘å¾®ä¿¡ easy_coder ä¸€èµ·äº¤æµã€‚\n\næ–‡ä¸­æåˆ°çš„ç”µé©´çš„æºç å¯ä»¥åœ¨å…¬ä¼—å·ã€ é«˜æ€§èƒ½æœåŠ¡å™¨å¼€å‘ ã€‘åå°å›å¤â€œè·å–ç”µé©´æºç â€å³å¯è·å–ã€‚\n\n","slug":"è½¬è½½/cpp/å¦‚ä½•æˆä¸ºä¸€ååˆæ ¼çš„CC++å¼€å‘è€…ï¼Ÿ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"171b5e45338b6064c4b33120174da47b","title":"ã€è½¬è½½ã€‘æ·±å…¥ç†è§£CC++ä¸­çš„æŒ‡é’ˆ","content":"æ·±å…¥ç†è§£C&#x2F;C++ä¸­çš„æŒ‡é’ˆCå’ŒC++ä¸­æœ€å¼ºå¤§çš„åŠŸèƒ½è«è¿‡äºæŒ‡é’ˆäº†ï¼ˆpointerï¼‰ï¼Œä½†æ˜¯å¯¹äºå¤§å¤šæ•°äººå°¤å…¶æ˜¯æ–°æ‰‹æ¥è¯´ï¼ŒæŒ‡é’ˆæ˜¯ä¸€ä¸ªæœ€å®¹æ˜“å‡ºé”™ã€ä¹Ÿæœ€éš¾æŒæ¡çš„æ¦‚å¿µäº†ã€‚æœ¬æ–‡å°†ä»æŒ‡é’ˆçš„æ–¹æ–¹é¢é¢æ¥è®²è¿°æŒ‡é’ˆçš„æ¦‚å¿µå’Œç”¨æ³•ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚\nå†…å­˜æ¨¡å‹ä¸ºäº†æ›´å¥½åœ°ç†è§£æŒ‡é’ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è®¡ç®—æœºçš„å†…å­˜æ¨¡å‹ã€‚\nå†…å­˜åˆ†ä¸ºç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜ï¼Œç‰©ç†å†…å­˜å¯¹åº”è®¡ç®—æœºä¸­çš„å†…å­˜æ¡ï¼Œè™šæ‹Ÿå†…å­˜æ˜¯æ“ä½œç³»ç»Ÿå†…å­˜ç®¡ç†ç³»ç»Ÿå‡è±¡å‡ºæ¥çš„ã€‚ç”±äºè¿™äº›ä¸æ˜¯æˆ‘ä»¬æœ¬æ–‡çš„é‡ç‚¹ï¼Œä¸‹é¢ä¸åšåŒºåˆ†ã€‚æœ‰ä¸æ¸…æ¥šè¿™äº›æ¦‚å¿µçš„åŒå­¦ï¼Œå¯ä»¥ç»™æˆ‘ç•™è¨€æˆ–è€…åœ¨çº¿è¯¢é—®ã€‚\nåœ¨ä¸è€ƒè™‘cpuç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—æœºè¿è¡Œç¨‹åºæœ¬è´¨ä¸Šå°±æ˜¯å¯¹å†…å­˜ä¸­çš„æ•°æ®çš„æ“ä½œï¼Œé€šä¿—åœ°æ¥è¯´ï¼Œå°±æ˜¯å°†å†…å­˜æ¡æŸäº›éƒ¨åˆ†çš„æ•°æ®æ¬è¿›æ¬å‡ºæˆ–è€…æ¬æ¥æ¬å»ï¼Œå…¶ä¸­â€œæ¬è¿›æ¬å‡ºâ€æ˜¯æŒ‡å°†å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®æ¬å…¥cpuå¯„å­˜å™¨åŠè¿ç®—å™¨ä¸­è¿›è¡Œç›¸åº”çš„åŠ å‡è¿ç®—æˆ–è€…å°†å¯„å­˜å™¨ä¸­çš„æ•°æ®æ¬å›å†…å­˜å•å…ƒä¸­ï¼Œè€Œâ€œæ¬æ¥æ¬å»â€æ˜¯æŒ‡å°†å†…å­˜ä¸­çš„æ•°æ®ç”±è¿™ä¸ªä½ç½®æ¬åˆ°å¦å¤–ä¸€ä¸ªä½ç½®ï¼ˆå½“ç„¶ï¼Œä¸€èˆ¬ä¸æ˜¯ç›´æ¥æ¬ï¼Œè€Œæ˜¯å€ŸåŠ©å¯„å­˜å™¨ä½œä¸ºä¸­é—´å­˜å‚¨åŒºï¼‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nè®¡ç®—æœºä¸ºäº†æ–¹ä¾¿ç®¡ç†å†…å­˜ï¼Œå°†å†…å­˜çš„æ¯ä¸ªå•å…ƒç”¨ä¸€ä¸ªæ•°å­—ç¼–å·ï¼Œå¦‚ä¸‹å›¾æ‰€ä»¥ï¼š\n\nå›¾ä¸­æ‰€ç¤ºï¼Œæ˜¯ä¸€ä¸ªå¤§å°ä¸º128ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªç©ºæ ¼ä»£è¡¨ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å†…å­˜ç¼–å·æ˜¯0~127ã€‚\nå¯¹äºä¸€ä¸ª32ä½çš„æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œå†…å­˜ç©ºé—´ä¸­æ¯ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·æ˜¯ä¸€ä¸ª32ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥å†…å­˜ç¼–å·ä»0000 0000 0000 0000 0000 0000 0000 0000è‡³1111 1111 1111 1111 1111 1111 1111 1111ï¼Œè½¬æ¢æˆ16è¿›åˆ¶ä¹Ÿå°±æ˜¯0x00000000è‡³0xFFFFFFFFï¼Œç”±äºæ˜¯ä»0å¼€å§‹çš„ï¼Œæ‰€ä»¥åŒ–æˆ10æœºåˆ¶å°±æ˜¯ä»0è‡³2çš„32æ¬¡æ–¹å‡1ï¼›å¯¹äº64ä½æ“ä½œç³»ç»Ÿï¼Œå†…å­˜ç¼–å·ä¹Ÿå°±æ˜¯ä»64ä¸ª0è‡³64ä¸ª1ã€‚\nå¤§å®¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»ä¸Šé¢ä¸¤ä¸ªå›¾æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°†ç¼–å·å°çš„å†…å­˜å•å…ƒç”»åœ¨ä¸Šé¢ï¼Œç¼–å·å¤§çš„ç”»åœ¨ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä¸Šè‡³ä¸‹ï¼Œå†…å­˜ç¼–å·è¶Šæ¥è¶Šå¤§ã€‚\næŒ‡é’ˆä¸æŒ‡é’ˆå˜é‡æŒ‡é’ˆçš„æœ¬æ„å°±æ˜¯å†…å­˜åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥é€šä¿—åœ°ç†è§£æˆå†…å­˜ç¼–å·ï¼Œæ—¢ç„¶è®¡ç®—æœºé€šè¿‡ç¼–å·æ¥æ“ä½œå†…å­˜å•å…ƒï¼Œè¿™å°±é€ å°±äº†æŒ‡é’ˆçš„é«˜æ•ˆç‡ã€‚\né‚£ä¹ˆä»€ä¹ˆæ˜¯æŒ‡é’ˆå˜é‡å‘¢ï¼ŸæŒ‡é’ˆå˜é‡å¯é€šä¿—åœ°ç†è§£æˆå­˜å‚¨æŒ‡é’ˆçš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨å†…å­˜åœ°å€ï¼ˆå†…å­˜ç¼–å·ï¼‰çš„å˜é‡ã€‚é¦–å…ˆæŒ‡é’ˆå˜é‡å’Œæ•´å‹å˜é‡ã€å­—ç¬¦å‹å˜é‡ä»¥åŠå…¶ä»–æ•°æ®ç±»å‹çš„å˜é‡ä¸€æ ·éƒ½æ˜¯å˜é‡ç±»å‹ï¼›ä½†æ˜¯ï¼Œåè¿‡æ¥ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æŒ‰è¿™æ ·çš„æ–¹å¼æ¥åˆ†ç±»ï¼Œå³ï¼šæ•´å‹æŒ‡é’ˆå˜é‡ã€å­—ç¬¦å‹æŒ‡é’ˆå˜é‡ã€æµ®ç‚¹å‹æŒ‡é’ˆå˜é‡ç­‰ç­‰ã€‚ä¸ºä»€ä¹ˆä¸æ¨èè¿™æ ·çš„åˆ†ç±»æ–¹æ³•å‘¢ï¼Ÿé¦–å…ˆï¼ŒæŒ‡é’ˆå˜é‡å°±æ˜¯ä¸€ä¸ªæ•°æ®ç±»å‹ï¼ŒæŒ‡é’ˆæ•°æ®ç±»å‹ï¼Œè¿™ç§æ•°æ®ç±»å‹é¦–å…ˆæ˜¯ä¸€ä¸ªå˜é‡æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå®ƒçš„å¤§å°æ˜¯å¤šå°‘å‘¢ï¼Ÿå¾ˆå¤šåŒå­¦ç†æ‰€å½“ç„¶åœ°è®¤ä¸ºæ•´å‹æŒ‡é’ˆå˜é‡å’Œä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆå˜é‡çš„å¤§å°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™ç§è®¤è¯†æ˜¯é”™çš„ã€‚æŒ‡é’ˆå˜é‡ä¹Ÿæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æ¥å­˜å‚¨å…¶ä»–å˜é‡çš„å†…å­˜åœ°å€çš„ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼ŒæŒ‡é’ˆå˜é‡æ—¶ç”¨æ¥å­˜å‚¨å…¶ä»–å˜é‡çš„å†…å­˜é¦–åœ°å€çš„ï¼Œå› ä¸ºä¸åŒçš„æ•°æ®ç±»å‹æ‰€å çš„å†…å­˜å¤§å°ä¸ä¸€æ ·ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨32ä½æœºå™¨ä¸Šï¼Œå‡å¦‚aæ˜¯intå‹å˜é‡ï¼Œpaæ˜¯æŒ‡å‘açš„æŒ‡é’ˆå˜é‡ï¼Œbæ˜¯ä¸€ä¸ªdoubleå‹å˜é‡ï¼Œpbæ˜¯æŒ‡å‘bçš„æŒ‡é’ˆå˜é‡ï¼Œé‚£ä¹ˆaåœ¨å†…å­˜ä¸­å å››ä¸ªå­—èŠ‚ï¼Œbåœ¨å†…å­˜ä¸­å 8ä¸ªå­—èŠ‚ï¼Œå‡å¦‚aåœ¨å†…å­˜ä¸­åˆ†å¸ƒæ˜¯ä»0x11111110~0x11111113ï¼Œè€Œbåœ¨å†…å­˜ä¸­åˆ†å¸ƒæ˜¯0x11112221è‡³0x11112228ï¼Œé‚£ä¹ˆæŒ‡é’ˆå˜é‡paä¸­å­˜å‚¨çš„å†…å®¹æ˜¯0x11111110ï¼Œè€Œpbä¸­å­˜å‚¨å°±æ˜¯0x11112221ï¼Œçœ‹åˆ°äº†å§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œpaå’Œpbä¸­å­˜å‚¨çš„éƒ½æ˜¯åœ°å€ï¼Œè€Œä¸”éƒ½æ˜¯32ä½çš„äºŒè¿›åˆ¶åœ°å€ï¼›å†è€…ï¼Œå› ä¸ºå­˜å‚¨è¿™æ ·çš„åœ°å€éœ€è¦4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æ— è®ºæ˜¯intå‹æŒ‡é’ˆå˜é‡paæˆ–è€…æ˜¯doubleå‹æŒ‡é’ˆå˜é‡pbï¼Œå®ƒä»¬æ‰€å çš„å†…å­˜å¤§å°éƒ½æ˜¯å››ä¸ªå­—èŠ‚ï¼Œä»è¿™ç‚¹æ¥è¯´ï¼Œä¸ç®¡ä»€ä¹ˆç±»å‹çš„æŒ‡é’ˆéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸è®ºæŒ‰æ•´å‹æŒ‡é’ˆå˜é‡ã€å­—ç¬¦å‹æŒ‡é’ˆå˜é‡ã€æµ®ç‚¹å‹æŒ‡é’ˆå˜é‡ç­‰ç­‰æ¥åŒºåˆ†æŒ‡é’ˆå˜é‡ã€‚æ€»ç»“èµ·æ¥ï¼ŒæŒ‡é’ˆå˜é‡å’Œintã€floatã€charç­‰ç±»å‹ä¸€æ ·åŒå±å˜é‡ç±»å‹ï¼ŒæŒ‡é’ˆå˜é‡ç±»å‹å å››ä¸ªå­—èŠ‚ï¼ˆ32ä½æœºå™¨ä¸‹ï¼‰ï¼Œå­˜å‚¨çš„æ˜¯32ä½çš„å†…å­˜åœ°å€ã€‚ä¸‹é¢çš„ä»£ç è¯æ˜è¿™ä¸€ç‚¹ï¼š\n\n\nä¸Šé¢ä»‹ç»çš„æ˜¯æŒ‡é’ˆå˜é‡çš„ä¸€ä¸ªæ–¹é¢ï¼ŒæŒ‡é’ˆå˜é‡è¿˜æœ‰å¦å¤–ä¸€å±‚å«ä¹‰ï¼šåœ¨C&#x2F;C++ä¸­æ˜Ÿå·ï¼ˆ*ï¼‰è¢«å®šä¹‰æˆå–å†…å®¹ç¬¦å·ï¼Œè™½ç„¶æ‰€æœ‰æŒ‡é’ˆå˜é‡å çš„å†…å­˜å¤§å°å’Œå­˜å‚¨çš„å†…å­˜åœ°å€å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”±äºå­˜å‚¨çš„åªæ˜¯æ•°æ®çš„å†…å­˜é¦–åœ°å€ï¼Œæ‰€ä»¥æŒ‡é’ˆå˜é‡å­˜å‚¨çš„å†…å­˜åœ°å€æ‰€æŒ‡å‘çš„æ•°æ®ç±»å‹å†³å®šç€å¦‚ä½•è§£æè¿™ä¸ªé¦–åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºintå‹æŒ‡é’ˆå˜é‡ï¼Œæˆ‘ä»¬éœ€è¦ä»è¯¥æŒ‡é’ˆå˜é‡å­˜å‚¨çš„ï¼ˆé¦–ï¼‰åœ°å€å¼€å§‹å‘åä¸€ç›´æœç´¢4ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œä»¥å›¾ä¸­çš„å˜é‡aä¸ºä¾‹å°±æ˜¯ä»0x12ff600x12ff63ï¼Œå¯¹äºå˜é‡bå°±æ˜¯0x12ff440x12ff4bã€‚æ‰€ä»¥ä»è¿™ä¸ªæ„ä¹‰æ¥ä¸Šè®²ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨*paï¼Œå¿…é¡»å…ˆçŸ¥é“paæ˜¯ä¸€ä¸ªæ•´å‹çš„æŒ‡é’ˆï¼Œè¿™é‡Œå¼ºè°ƒâ€œæ•´å‹â€ï¼Œè€Œaçš„å€¼1ä¹Ÿå°±å­˜å‚¨åœ¨ä»0x12ff600x12ff63è¿™å››ä¸ªå­—èŠ‚é‡Œé¢ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨*pbï¼Œå¿…é¡»å…ˆçŸ¥é“pbæ˜¯ä¸€ä¸ªdoubleå‹æŒ‡é’ˆï¼Œè¿™é‡Œå¼ºè°ƒâ€doubleâ€,ä¹Ÿå°±æ˜¯è¯´å€¼2.0000å­˜å‚¨åœ¨0x12ff440x12ff4bè¿™å…«ä¸ªå­—èŠ‚é‡Œé¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹æŒ‡é’ˆå˜é‡è¿›è¡Œç®—æœ¯è¿ç®—ï¼Œæ¯”å¦‚pa + 2,pb + +ä¹‹ç±»çš„æ“ä½œï¼Œæ˜¯ä»¥æ•°æ®ç±»å‹å¤§å°ä¸ºå•ä½çš„ï¼Œä¹Ÿå°±æ˜¯è¯´pa + 2,ç›¸å½“äº0x12ff60 + sizeof(int) * 2 &#x3D; 0x12ff60 + 4 * 2 &#x3D; 0x12ff68,ä¸æ˜¯0x12ff60 + 2å“¦ï¼›è€Œpb - -ç›¸å½“äº0x12ff44 + sizeof(double) * 1 &#x3D; 0x12ff44 + 8 * 1 &#x3D; 0x12ff4cã€‚ç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚ åŒç†&amp;a + 2å’Œ&amp;b - 1ä¹Ÿæ˜¯ä¸€æ ·ï¼ˆæ³¨æ„ç”±äº&amp;bæ˜¯ä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ï¼Œæ‰€ä»¥å†™æˆ&amp;b - -æ˜¯é”™è¯¯çš„ï¼‰ã€‚\næŒ‡é’ˆå˜é‡å’ŒæŒ‡é’ˆå¸¸é‡æŒ‡é’ˆå˜é‡é¦–å…ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œç”±äºæŒ‡é’ˆå˜é‡å­˜å‚¨äº†æŸä¸ªå˜é‡çš„å†…å­˜é¦–åœ°å€ï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºâ€æŒ‡é’ˆå˜é‡æŒ‡å‘äº†è¯¥å˜é‡â€œï¼Œä½†æ˜¯åœ¨è¿™ä¸ªæ—¶åˆ»æŒ‡é’ˆå˜é‡paæŒ‡å‘å˜é‡aï¼Œä¸‹ä¸ªæ—¶å€™å¯èƒ½ä¸å­˜å‚¨å˜é‡açš„é¦–åœ°å€ï¼Œè€Œæ˜¯å­˜å‚¨å˜é‡cçš„é¦–åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸ªæ—¶å€™ï¼Œpaä¸å†æŒ‡å‘aï¼Œè€Œæ˜¯æŒ‡å‘cã€‚è¯·åˆ«å«Œæˆ‘å•°å—¦ï¼Œä¸ºäº†å¸®åŠ©ä½ ç†è§£ï¼Œæˆ‘æ˜¯æ•…æ„è¯´å¾—è¿™ä¹ˆç»†çš„ï¼Œåé¢æˆ‘ä»¬è®¨è®ºé«˜çº§ä¸»é¢˜çš„æ—¶å€™ï¼Œå½“ä½ è§‰å¾—è¿·ç³Šï¼Œè¯·å›æ¥åå¤å’€åš¼ä¸€ä¸‹è¿™æ®µè¯ã€‚ä¹Ÿå°±æ˜¯è¯´æŒ‡é’ˆå˜é‡æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒçš„å€¼å¯ä»¥å˜åŠ¨çš„ã€‚\nç›¸åï¼ŒæŒ‡é’ˆå¸¸é‡å¯é€šä¿—åœ°ç†è§£ä¸ºå­˜å‚¨å›ºå®šçš„å†…å­˜å•å…ƒåœ°å€ç¼–å·çš„â€é‡â€œï¼Œå®ƒä¸€æ—¦å­˜å‚¨äº†æŸä¸ªå†…å­˜åœ°å€ä»¥åï¼Œä¸å¯å†æ”¹å­˜å‚¨å…¶ä»–çš„å†…å­˜åœ°å€äº†ã€‚æ‰€ä»¥æŒ‡é’ˆå¸¸é‡æ˜¯åšéŸ§ï¼Œå› ä¸ºå®ƒâ€å’¬å®šé’å±±ä¸æ”¾æ¾â€œï¼›è¯´æ˜¯â€ç—´æƒ…â€œï¼Œå› ä¸ºå®ƒâ€æ›¾ç»æ²§æµ·éš¾ä¸ºæ°´â€œã€‚æˆ‘è¿™é‡Œè®²çš„æŒ‡é’ˆå¸¸é‡å¯¹åº”çš„æ˜¯constå…³é”®å­—å®šä¹‰çš„é‡ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆå­—é¢é‡ã€‚åƒ&amp;a, &amp;b, &amp;a + 2ç­‰æ˜¯æŒ‡é’ˆå­—é¢é‡ï¼Œè€Œconst int *p &#x3D; &a;ä¸­çš„pæ‰ç®—æ˜¯çœŸæ­£çš„æŒ‡é’ˆå¸¸é‡ï¼ŒæŒ‡é’ˆå¸¸é‡ä¸€èˆ¬ç”¨åœ¨å‡½æ•°çš„å‚æ•°ä¸­ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ä¸å¯æ”¹å˜å®å‚çš„å†…å®¹ã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­å§ï¼š\n\nä¸Šé¢çš„å‡½æ•°ç”±äºä¿®æ”¹äº†ä¸€ä¸ªå¸¸æŒ‡é’ˆï¼ˆå¤šæ•°æƒ…å†µä¸‹ç­‰åŒæŒ‡é’ˆå¸¸é‡ï¼‰ï¼Œå› è€Œä¼šç¼–è¯‘å‡ºé”™ï¼šerror C3892: â€œxâ€: ä¸èƒ½ç»™å¸¸é‡èµ‹å€¼ã€‚\næŒ‡é’ˆå˜é‡ä¸æ•°ç»„è®°å¾—å¤šå¹´ä»¥å‰ï¼Œæˆ‘åœ¨å­¦ç”Ÿä¼šç»™ç”µå­æŠ€æœ¯éƒ¨å’Œåœ°ç†ä¿¡æ¯ç³»ç»Ÿä¸“ä¸šçš„åŒå­¦è¿›è¡ŒCè¯­è¨€åŸ¹è®­æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€è®©ä»–ä»¬å¤´ç–¼å’Œæ„Ÿåˆ°ä¸€å¤´é›¾æ°´çš„è¯é¢˜ï¼Œå°¤å…¶æ˜¯æŒ‡é’ˆå˜é‡ä¸äºŒç»´æ•°ç»„çš„ç»“åˆï¼Œæˆ‘æ°¸è¿œå¿˜ä¸äº†èƒ¡æ°¸æœˆé‚£ä¸€è„¸è¿·æƒ‘ä¸æ— åŠ©çš„è¡¨æƒ…ã€‚ä»Šå¤©æˆ‘è¿™é‡Œç»™å¤§å®¶æ·±å…¥åœ°åˆ†æä¸€ä¸‹ã€‚å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š\n\nå¦‚æœä½ èƒ½å¾—å‡ºä¸‹é¢è¿™æ ·çš„ç»“æœï¼Œè¯´æ˜ä½ å·²ç»åŸºæœ¬ä¸Šå¯¹æ•°ç»„ä¸æŒ‡é’ˆçš„æ¦‚å¿µç†è§£æ¸…æ¥šäº†ï¼š\n\né€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“*(a + 1) &#x3D; 2, *(ptr - 1) &#x3D; 5ã€‚\nä¸”ä¸è¯´å¾ˆå¤šåŒå­¦æ ¹æœ¬å¾—ä¸åˆ°è¿™æ ·çš„ç»“æœï¼Œä»–ä»¬çœ‹åˆ°int ptr &#x3D; (int)(&amp;a+1);è¿™æ ·çš„è¯­å¥å°±å·²ç»æ‡µäº†ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“Cè¯­è¨€ä¸­è§„å®šæ•°ç»„åè¡¨ç¤ºè¿™ä¸ªæ•°ç»„çš„é¦–åœ°å€ï¼Œè€Œè¿™é‡Œç«Ÿç„¶å‡ºç°äº†&amp;aè¿™æ ·çš„ç¬¦å·ï¼Œæœ¬æ¥aå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¸¸é‡äº†ï¼Œè¿™é‡Œå¯¹&amp;aå†æ¬¡å–åœ°å€éš¾é“ä¸æ˜¯éæ³•æ“ä½œå—ï¼Ÿå“ˆå“ˆï¼Œå½“ä½ æœ‰è¿™æ ·çš„ç–‘é—®çš„æ—¶å€™ï¼Œè¯´æ˜ä½ å¯¹äºŒç»´æ•°ç»„ç›¸å…³çŸ¥è¯†ç†è§£ä¸æ·±å…¥ã€‚æˆ‘è¿™é‡Œå…ˆç»™ä½ è¡¥å……ä¸‹çŸ¥è¯†ç‚¹å§ï¼š\nçœ‹è¿™æ ·ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼šint arr[3][4],è¿™ä¸ªæ•°ç»„å¸ƒå±€å¦‚ä¸‹ï¼š\n\nè¿™æ˜¯ä¸€ä¸ª3è¡Œ4åˆ—çš„æ•°ç»„ï¼Œå®ƒåœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒå¦‚ä¸‹ï¼š\n\nè¿™é‡Œæ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ å 4å­—èŠ‚ç©ºé—´ï¼Œæˆ‘ä»¬çŸ¥é“Cè¯­è¨€è§„å®šï¼Œæ•°ç»„åarræ˜¯æ•´ä¸ªæ•°ç»„å…ƒç´ çš„é¦–åœ°å€ï¼Œæ¯”å¦‚æ˜¯0x0012ff08,è€Œåƒarr[0]ã€arr[1]ã€arr[2]åˆ†åˆ«æ˜¯æ•°ç»„ç¬¬ä¸€è¡Œã€ç¬¬äºŒè¡Œã€ç¬¬ä¸‰è¡Œçš„é¦–åœ°å€ï¼Œä¹Ÿå°±æ˜¯0x0012ff08ã€0x0012ff18ã€0x0012ff28ã€‚\næˆ‘ä»¬æŠŠarrã€arr[0]å’Œ&amp;arr[0][0]å•ç‹¬æ‹¿å‡ºæ¥åˆ†æï¼Œå› ä¸ºæ•°ç»„çš„é¦–åœ°å€ä¹Ÿæ˜¯ç¬¬ä¸€åˆ—çš„é¦–åœ°å€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„é¦–åœ°å€ï¼Œæ‰€ä»¥arrå’Œarr[0]å’Œ&amp;arr[0][0]è¡¨ç¤ºçš„éƒ½æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œä½†æ˜¯è¿™ä¸‰ä¸ªé¦–åœ°å€åœ¨è¿›è¡Œç®—æœ¯è¿ç®—æ—¶æ˜¯æœ‰åŒºåˆ«çš„ã€‚å¦‚æœ&amp;arr[0][0] + 1ï¼Œè¿™é‡Œçš„ç›¸å½“äºè·³ä¸€ä¸ªå…ƒç´ çš„å†…å­˜å­—èŠ‚æ•°ï¼Œä¹Ÿå°±æ˜¯4ä¸ªï¼›ä½†æ˜¯arr[0] + 1ï¼Œç§»åŠ¨çš„å†…å­˜å­—èŠ‚æ•°æ˜¯ä¸€åˆ—å…ƒç´ æ‰€å çš„å­—èŠ‚æ•°ï¼Œä¹Ÿå°±æ˜¯4 * 4 &#x3D; 16ä¸ªï¼›æœ€åï¼Œä¹Ÿæ˜¯æœ€è®©äººè¿·æƒ‘çš„çš„å°±æ˜¯arr + 1,è¿™ä¸ªæ—¶å€™ç§»åŠ¨çš„å†…å­˜æ•°ç›®æ˜¯æ•´ä¸ªæ•°ç»„å çš„å†…å­˜å­—èŠ‚æ•°ï¼Œä¹Ÿå°±æ˜¯48ä¸ªå­—èŠ‚æ•°ï¼Œæ‰€ä»¥a + 1æ‰€è¡¨ç¤ºçš„å†…å­˜åœ°å€å·²ç»ä¸å±äºè¿™ä¸ªæ•°ç»„äº†ï¼Œè¿™ä¸ªåœ°å€ä½äºæ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ æ‰€å å†…å­˜ç©ºé—´çš„ä¸‹ä¸€ä¸ªå­—èŠ‚ç©ºé—´ã€‚\nå…‰æœ‰è¿™äº›çŸ¥è¯†è¿˜æ˜¯ä¸èƒ½è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬å†è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚\nC++æ˜¯ä¸€ç§å¼ºç±»å‹çš„è¯­è¨€ï¼Œå…¶ä¸­æœ‰ä¸€ç§ç±»å‹å«voidç±»å‹ï¼Œä»æœ¬è´¨ä¸Šè¯´voidä¸æ˜¯ä¸€ç§ç±»å‹ï¼Œå› ä¸ºå˜é‡éƒ½æ˜¯â€æœ‰ç±»å‹â€œçš„ï¼Œå°±å¥½åƒäººçš„æ€§åˆ«ï¼Œä¸æ˜¯ç”·äººå°±æ˜¯å¥³äººï¼Œä¸å­˜åœ¨æ— æ€§åˆ«çš„äººï¼Œæ‰€ä»¥voidæ›´å¤šæ˜¯ä¸€ç§æŠ½è±¡ã€‚åœ¨ç¨‹åºä¸­ï¼Œvoidç±»å‹æ›´å¤šæ˜¯ç”¨æ¥â€ä¿®é¥°â€œå’Œâ€é™åˆ¶â€œä¸€ä¸ªå‡½æ•°çš„ï¼šä¾‹å¦‚ä¸€ä¸ªå‡½æ•°å¦‚æœä¸è¿”å›ä»»ä½•ç±»å‹çš„å€¼ï¼Œå¯ä»¥ç”¨voidä½œè¿”å›ç±»å‹ï¼›å¦‚æœä¸€ä¸ªå‡½æ•°æ— å‚æ•°åˆ—è¡¨ï¼Œå¯ä»¥ç”¨voidä½œä¸ºå‚æ•°åˆ—è¡¨ã€‚\nè·Ÿvoidç±»å‹â€ä¿®é¥°â€œä½œç”¨ä¸åŒï¼Œvoidå‹æŒ‡é’ˆä½œä¸ºæŒ‡å‘æŠ½è±¡æ•°æ®çš„æŒ‡é’ˆï¼Œå®ƒæœ¬è´¨ä¸Šè¡¨ç¤ºä¸€æ®µå†…å­˜å—ã€‚å¦‚æœä¸¤ä¸ªæŒ‡é’ˆç±»å‹ä¸åŒï¼Œåœ¨è¿›è¡ŒæŒ‡é’ˆç±»å‹èµ‹å€¼æ—¶å¿…é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n\nä½†æ˜¯å¯ä»¥å°†ä»»ä½•æŒ‡é’ˆç±»å‹èµ‹å€¼ç»™voidç±»å‹è€Œæ— é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼š\n\nå½“ç„¶ï¼Œå¦‚æœæŠŠvoidå‹æŒ‡é’ˆè½¬æ¢æˆå¹¶ä¸æ˜¯å®ƒå®é™…æŒ‡å‘çš„æ•°æ®ç±»å‹ï¼Œå…¶ç»“æœæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚è¯•æƒ³ï¼Œå¦‚æœæŠŠä¸€ä¸ªintå‹æŒ‡é’ˆèµ‹ç»™voidå‹ï¼Œç„¶åå†æŠŠè¿™ä¸ªvoidå‹æŒ‡é’ˆå¼ºåˆ¶è½¬æ¢æˆdoubleå‹æŒ‡é’ˆï¼Œè¿™æ ·çš„ç»“æœæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚å› ä¸ºä¸åŒæ•°æ®ç±»å‹æ‰€å å†…å­˜å¤§å°ä¸ä¸€æ ·ï¼Œè¿™æ ·åšå¯èƒ½æˆ–æˆªæ–­å†…å­˜æ•°æ®æˆ–è€…ä¼šå¢åŠ ä¸€äº›æœªçŸ¥çš„é¢å¤–æ•°æ®ã€‚æ‰€ä»¥ï¼Œæœ€å¥½æ˜¯å°†voidç±»å‹æŒ‡é’ˆè½¬æ¢æˆå®ƒå®é™…æ•°æ®ç±»å‹æŒ‡é’ˆã€‚\næœ‰äº†ä¸Šé¢çš„è¯´æ˜ï¼Œä½ åº”è¯¥èƒ½çœ‹æ‡‚Cå‡½æ•°åº“ä¸­ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ç­¾åå«ä¹‰äº†å§ï¼Ÿ\n1void *memcpy(void *dest,const void *src,size_t len);\n\nåœ¨è¿™é‡Œï¼Œä»»ä½•æ•°æ®ç±»å‹çš„æŒ‡é’ˆéƒ½å¯ä»¥ä¼ ç»™è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°æˆä¸ºäº†ä¸€ä¸ªé€šç”¨çš„å†…å­˜å¤åˆ¶å‡½æ•°ã€‚\nå¥½äº†ï¼Œè¯´äº†è¿™ä¹ˆå¤šï¼Œå›ç­”æœ€åˆçš„é‚£ä¸ªé—®é¢˜ä¸Šï¼š\n\næˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ•°ç»„çœ‹æˆæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„äºŒç»´æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯1è¡Œ5åˆ—çš„äºŒç»´æ•°ç»„ï¼Œç°åœ¨aè¡¨ç¤ºçš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„é¦–åœ°å€ï¼Œé‚£ä¹ˆa + 1æŒ‡å‘çš„å°±æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ çš„å†…å­˜é¦–åœ°å€ï¼Œæ‰€ä»¥*(a + 1) &#x3D; 2ï¼›è€Œ&amp;aåˆ™æ˜¯è¡¨ç¤ºæ•´ä¸ªæ•°ç»„çš„é¦–åœ°å€ï¼Œé‚£ä¹ˆ&amp;a + 1ç§»åŠ¨çš„å†…å­˜æ•°ç›®å°±æ˜¯æ•´ä¸ªæ•°ç»„æ‰€å å­—èŠ‚æ•°ï¼Œå‡å¦‚è¿™é‡Œæˆ‘ä»¬é‡åŒ–æ¥è¯´æ˜ï¼Œå‡å¦‚åŸå…ˆæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„é¦–åœ°å€æ˜¯1,é‚£ä¹ˆ&amp;a + 1è¡¨ç¤ºçš„å°±æ˜¯21ï¼Œè€Œè¿™ä¸ªåœ°å€å·²ç»ä¸å±äºæ•°ç»„äº†ï¼Œæ¥ç€é€šè¿‡(int*)(&amp;a + 1)å°†æ•°ç»„æŒ‡é’ˆè½¬æ¢æˆæ•´å‹æŒ‡é’ˆï¼Œè¿™æ ·åŸå…ˆ&amp;a + 1è¡¨ç¤ºçš„æ•°æ®èŒƒå›´æ˜¯2140ä¸€ä¸‹ç¼©å°åˆ°2124,æ­£å¥½æ˜¯ä¸€ä¸ªintå‹çš„å¤§å°ï¼Œæ‰€ä»¥ptr - 1çš„å­˜å‚¨çš„åœ°å€å°±æ˜¯17äº†ï¼Œè¡¨ç¤ºçš„æ•°æ®å†…å­˜èŒƒå›´æ˜¯17~20,è¿™æ ·*(ptr - 1)æ­£å¥½å°±æ˜¯æœ€åä¸€ä¸ªå…ƒç´ 5äº†ã€‚\nä½†æ˜¯è¯è¯´å›æ¥ï¼Œé¦–å…ˆè¿™æ ·çš„è½¬æ¢å®‰å…¨ä¸å¦å°šæœ‰äº‰è®®ï¼Œå†æ¬¡ï¼Œè¿™æ ·çš„ç¨‹åºæ™¦æ¶©éš¾æ‡‚ï¼Œéš¾äºç†è§£ï¼Œæ‰€ä»¥å»ºè®®ä¸è¦å†™å‡ºè¿™æ ·çš„ç¨‹åºã€‚\nä¸Šé¢çš„ä¾‹å­ï¼Œåªæ˜¯é€šè¿‡ä¸€äº›ç®€å•çš„æ•°æ®ç±»å‹æ¥è¯´æ˜å†…å­˜åˆ†å¸ƒï¼Œä½†æ˜¯å®é™…å¯¹äºä¸€äº›å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œå°¤å…¶æ˜¯ä¸€äº›è‡ªå®šä¹‰çš„ç±»æˆ–è€…ç»“æ„ä½“ç±»å‹ï¼Œå†…å­˜åˆ†å¸ƒå¿…é¡»è¿˜è¦å……åˆ†è€ƒè™‘åˆ°å­—èŠ‚å¯¹é½ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š \n\nè¿™æ˜¯è¾“å‡ºç»“æœï¼š\n\nç”±äºç»“æ„ä½“s1ä¸­å­˜åœ¨å­—èŠ‚å¯¹é½ç°è±¡ï¼ˆä»¥sizeof(double) &#x3D; 8ä¸ªå­—èŠ‚å¯¹é½ï¼‰ï¼Œæ‰€ä»¥s1å æ®24å­—èŠ‚å†…å­˜ï¼Œè€Œs2åªå 16ä¸ªå­—èŠ‚ã€‚çŸ¥é“è¿™ç‚¹ï¼Œæˆ‘ä»¬å¹³å¸¸åœ¨è®¾è®¡ç»“æ„ä½“å­—æ®µçš„æ—¶å€™ï¼Œå°±å¯ä»¥åˆç†å®‰æ’å­—æ®µé¡ºåºæ¥ä½¿ç”¨æ›´å°‘çš„å†…å­˜ç©ºé—´äº†ã€‚\nå‡½æ•°æŒ‡é’ˆå‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚ å› è€Œâ€œå‡½æ•°æŒ‡é’ˆâ€æœ¬èº«é¦–å…ˆåº”æ˜¯æŒ‡é’ˆå˜é‡ï¼Œåªä¸è¿‡è¯¥æŒ‡é’ˆå˜é‡æŒ‡å‘å‡½æ•°ã€‚è¿™æ­£å¦‚ç”¨æŒ‡é’ˆå˜é‡å¯æŒ‡å‘æ•´å‹å˜é‡ã€å­—ç¬¦å‹ã€æ•°ç»„ä¸€æ ·ï¼Œè¿™é‡Œæ˜¯æŒ‡å‘å‡½æ•°ã€‚C&#x2F;C++ç¨‹åºåœ¨ç¼–è¯‘æ—¶ï¼Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…¥å£åœ°å€ï¼Œè¯¥å…¥å£åœ°å€å°±æ˜¯å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ã€‚æœ‰äº†æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡åï¼Œå¯ç”¨è¯¥æŒ‡é’ˆå˜é‡è°ƒç”¨å‡½æ•°ï¼Œå°±å¦‚åŒç”¨æŒ‡é’ˆå˜é‡å¯å¼•ç”¨å…¶ä»–ç±»å‹å˜é‡ä¸€æ ·ï¼Œåœ¨è¿™äº›æ¦‚å¿µä¸Šæ˜¯ä¸€è‡´çš„ã€‚å‡½æ•°æŒ‡é’ˆæœ‰ä¸¤ä¸ªç”¨é€”ï¼šè°ƒç”¨å‡½æ•°å’Œåšå‡½æ•°çš„å‚æ•°ã€‚\næˆ‘ä»¬å…ˆæ¥å…ˆä½¿ç”¨å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nä¸Šé¢çš„ä»£ç é¦–å…ˆæ˜¯å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°fï¼Œç„¶åæ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆpfï¼Œæ¥ç€åœ¨ä¸»å‡½æ•°é‡Œé¢å°†å‡½æ•°fçš„åœ°å€èµ‹å€¼ç»™å‡½æ•°æŒ‡é’ˆï¼Œè¿™æ ·pfå°±æŒ‡å‘äº†å‡½æ•°fï¼Œè¿™æ ·ä½¿ç”¨*pfå°±å¯ä»¥ç›´æ¥è°ƒç”¨å‡½æ•°äº†ã€‚ä½†æ˜¯ä¸Šé¢çš„ä¾‹å­å®šä¹‰å‡½æ•°æŒ‡é’ˆçš„æ–¹æ³•åœ¨æŸäº›ç¼–è¯‘å™¨ä¸­æ˜¯æ— æ³•é€šè¿‡çš„ï¼Œæœ€å¥½é€šè¿‡typedefå…³é”®å­—å®šä¹‰å‡½æ•°æŒ‡é’ˆï¼Œæ¨èçš„å†™æ³•å¦‚ä¸‹ï¼š\n\né€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸‹å‡½æ•°æŒ‡é’ˆçš„å®šä¹‰å’Œä½¿ç”¨æ–¹æ³•ï¼š\né¦–å…ˆï¼Œé€šè¿‡typedefå…³é”®å­—å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªè¯¥å‡½æ•°æŒ‡é’ˆç±»å‹å˜é‡ï¼Œæ¥ç€å°†å‡½æ•°çš„å…¥å£åœ°å€èµ‹å€¼ç»™è¯¥å‡½æ•°æŒ‡é’ˆç±»å‹å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°æŒ‡é’ˆå˜é‡è°ƒç”¨å‡½æ•°äº†ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹æ—¶çš„å‡½æ•°ç­¾åï¼ˆåŒ…æ‹¬å‡½æ•°è¿”å›å€¼å’Œå‡½æ•°å‚æ•°åˆ—è¡¨çš„ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºï¼‰è¦å°†èµ‹å€¼ç»™è¯¥ç±»å‹å˜é‡çš„å‡½æ•°ç­¾åä¿æŒä¸€è‡´ï¼Œä¸ç„¶å¯èƒ½ä¼šå‘ç”Ÿå¾ˆå¤šæ— æ³•é¢„æ–™çš„æƒ…å†µã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯C&#x2F;C++è§„å®šå‡½æ•°åå°±è¡¨ç¤ºå‡½æ•°å…¥å£åœ°å€ï¼Œæ‰€ä»¥ï¼Œå‡½æ•°åèµ‹å€¼æ—¶å‡½æ•°åå‰é¢åŠ ä¸åŠ å–åœ°å€ç¬¦&amp;éƒ½ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯è¯´PF pf &#x3D; fç­‰ä»·äºPF pf &#x3D; &amp;fã€‚è¿™ä¸ª**&amp;æ˜¯å¯ä»¥çœç•¥**çš„ã€‚ä½†æ˜¯è¿™æ˜¯å•ä¸ªå‡½æ•°çš„æƒ…å†µï¼Œåœ¨C++ä¸­å–ç±»çš„æ–¹æ³•å‡½æ•°çš„åœ°å€æ—¶ï¼Œè¿™ä¸ª&amp;ç¬¦å·å¼ä¸èƒ½çœç•¥çš„ï¼Œè§ä¸‹é¢çš„ä¾‹å­ï¼š\n\nå‡½æ•°æŒ‡é’ˆçš„å¦å¤–ä¸€ä¸ªç”¨å¤„ï¼Œè€Œä¸”æ˜¯ç”¨çš„æœ€å¤šçš„ï¼Œå°±æ˜¯ä½œä¸ºä¸€ä¸ªå‡½æ•°çš„å‚æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´æŸä¸ªå‡½æ•°çš„æŸä¸ªå‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™åœ¨windowsç¼–ç¨‹ä¸­ä½œä¸ºå›è°ƒå‡½æ•°(callback)å°¤å…¶å¸¸è§ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š\n\nä¸Šå›¾ä¸­ï¼Œå‡½æ•°f2ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¼ å…¥å‡½æ•°f1ä½œä¸ºå‚æ•°ã€‚è¿™ç§å‡½æ•°å‚æ•°æ˜¯å‡½æ•°ç±»å‹çš„ç”¨æ³•å¾ˆé‡è¦ï¼Œå»ºè®®å¤§å®¶æŒæ¡ã€‚\næŒ‡é’ˆå˜é‡çš„å®šä¹‰æ–¹æ³•å…ˆæ’æ’­ä¸€æ®µå¹¿å‘Šï¼Œè¯´ä¸‹mainå‡½æ•°çš„è¿”å›å€¼é—®é¢˜ï¼Œå¦‚ä¸‹å›¾ï¼š\n\nè¿™ç§mainå‡½æ•°æ— è¿”å›å€¼çš„å†™æ³•ï¼Œåœ¨å›½å†…å„å¤§C&#x2F;C++æ•™æä¸Šå±¡è§ä¸é²œï¼Œè¿™ç§å†™æ³•æ˜¯é”™è¯¯çš„ï¼\næœ‰ä¸€ç‚¹ä½ å¿…é¡»æ˜ç¡®ï¼šC&#x2F;C++æ ‡å‡†ä¸­ä»æ¥æ²¡æœ‰å®šä¹‰è¿‡void main()è¿™æ ·çš„ä»£ç å½¢å¼ã€‚C++ä¹‹çˆ¶Bjarne Stroustrupåœ¨ä»–çš„ä¸»é¡µFAQä¸­æ˜ç¡®åœ°å†™äº†è¿™æ ·ä¸€å¥è¯ï¼š\n\nåœ¨C++ä¸­ç»å¯¹æ²¡æœ‰å‡ºç°è¿‡void main(){ &#x2F;* â€¦ *&#x2F; } è¿™æ ·çš„å‡½æ•°å®šä¹‰ï¼Œåœ¨Cè¯­è¨€ä¸­ä¹Ÿæ˜¯ã€‚\n\nmainå‡½æ•°çš„è¿”å›å€¼åº”è¯¥å®šä¹‰ä¸ºintå‹ï¼Œåœ¨C&#x2F;C++æ ‡å‡†ä¸­éƒ½æ˜¯è¿™æ ·è§„å®šçš„ã€‚åœ¨C99æ ‡å‡†è§„å®šï¼Œåªæœ‰ä»¥ä¸‹ä¸¤ç§å®šä¹‰æ–¹å¼æ˜¯æ­£ç¡®çš„çš„ï¼š\n121 int main(void);2 int main(int argc,char *argv[]);\n\nè™½ç„¶åœ¨Cå’ŒC++æ ‡å‡†ä¸­å¹¶ä¸æ”¯æŒvoid main()ï¼Œä½†æ˜¯åœ¨éƒ¨åˆ†ç¼–è¯‘å™¨ä¸­void main()ä¾æ—§æ˜¯å¯ä»¥é€šè¿‡ç¼–è¯‘å¹¶æ‰§è¡Œçš„ï¼Œæ¯”å¦‚å¾®è½¯çš„VC++ã€‚ç”±äºå¾®è½¯äº§å“çš„å¸‚åœºå æœ‰ç‡å’Œå½±å“åŠ›å¾ˆå¤§ï¼Œå› ä¸ºåœ¨æŸç§ç¨‹åº¦ä¸ŠåŠ å‰§äº†è¿™ç§ä¸è‰¯ä¹ æƒ¯çš„è”“å»¶ã€‚ä¸è¿‡ï¼Œå¹¶éæ‰€æœ‰çŠ¯äººç¼–è¯‘å™¨éƒ½æ”¯æŒvoid main()ï¼Œgccå°±ç«™åœ¨VC++çš„å¯¹ç«‹é¢ï¼Œå®ƒæ˜¯è¿™ä¸€ä¸è‰¯ä¹ æ°”çš„åšå®šæŠµåˆ¶è€…ï¼Œå®ƒä¼šåœ¨ç¼–è¯‘æ—¶æ˜ç¡®åœ°ç»™å‡ºä¸€ä¸ªé”™è¯¯ã€‚\nå¹¿å‘Šæ’­å®Œï¼Œæˆ‘ä»¬å›åˆ°æ­£é¢˜ä¸Šæ¥ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆï¼Œé¦–å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š\n\næˆ‘æ¥æ›¿ä½ å›ç­”å§ï¼Œä½ è‚¯å®šè®¤ä¸ºaæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œbæ˜¯ä¸€ä¸ªæ•´å‹å˜é‡ï¼Œcå’Œdéƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ã€‚å¥½å§ï¼Œæ­å–œä½ ï¼Œç­”é”™äº†ï¼\nå…¶å®å®šä¹‰æŒ‡é’ˆå˜é‡çš„æ—¶å€™ï¼Œæ˜Ÿå·(*)æ— è®ºæ˜¯ä¸æ•°æ®ç±»å‹ç»“åˆè¿˜æ˜¯ä¸å˜é‡åç»“åˆåœ¨ä¸€èµ·éƒ½æ˜¯ä¸€æ ·çš„ï¼ä½†æ˜¯ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œè¿˜æ˜¯æ¨èå¤§å®¶å†™æˆç¬¬ä¸€ç§å½¢å¼ï¼Œç¬¬äºŒç§å½¢å¼å®¹æ˜“è¯¯å¯¼äººï¼Œä¸æ˜¯å—ï¼Ÿè€Œä¸”ç¬¬ä¸€ç§å½¢å¼è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·çœ‹ï¼š\n1int *a;  //å°†*açœ‹æˆä¸€ä¸ªæ•´ä½“ï¼Œå®ƒæ˜¯ä¸€ä¸ªintå‹æ•°æ®ï¼Œé‚£ä¹ˆaè‡ªç„¶å°±æ˜¯æŒ‡å‘*açš„æŒ‡é’ˆäº†ã€‚\n\nè¯´å®Œå®šä¹‰æŒ‡é’ˆçš„æ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š\n\nä¸Šé¢çš„ä»£ç æœ‰é”™è¯¯å—ï¼Ÿ\né”™è¯¯åœ¨äºæˆ‘ä»¬ä¸èƒ½è¿™æ ·å†™ï¼šint *p &#x3D; 1; ç”±äºpæ˜¯ä¸€ä¸ªåŒ¿åæŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯è¯´pæ²¡æœ‰æ­£ç¡®çš„åˆå§‹åŒ–ï¼Œå®ƒå¯èƒ½æŒ‡å‘ä¸€ä¸ªä¸ç¡®å®šçš„å†…å­˜åœ°å€ï¼Œè€Œè¿™ä¸ªå†…å­˜åœ°å€å¯èƒ½æ˜¯ç³»ç»Ÿç¨‹åºå†…å­˜æ‰€åœ¨ï¼Œæˆ‘ä»¬å°†æ•°å€¼1è£…å…¥é‚£ä¸ªä¸ç¡®å®šçš„å†…å­˜å•å…ƒä¸­æ˜¯å¾ˆå±é™©çš„ï¼Œå› ä¸ºå¯èƒ½ä¼šç ´åç³»ç»Ÿé‚£ä¸ªå†…å­˜åŸæ¥çš„æ•°æ®ï¼Œå¼•å‘å¼‚å¸¸ã€‚æ¢å¦ä¸€ä¸ªæ–¹é¢æ¥çœ‹ï¼Œå°†æ•´å‹æ•°å€¼1ç›´æ¥èµ‹å€¼ç»™æŒ‡é’ˆå‹å˜é‡pæ˜¯éæ³•çš„ã€‚ \nè¿™æ ·çš„æŒ‡é’ˆæˆ‘ä»¬ç§°ä¸ºåŒ¿åæŒ‡é’ˆæˆ–è€…é‡æŒ‡é’ˆã€‚å’Œå…¶ä»–å˜é‡ç±»å‹ä¸€æ ·ï¼Œä¸ºäº†é˜²æ­¢å‘ç”Ÿæ„æ–™ä¹‹å¤–çš„é”™è¯¯ï¼Œæˆ‘ä»¬åº”è¯¥ç»™æ–°å®šä¹‰çš„æŒ‡é’ˆå˜é‡ä¸€ä¸ªåˆå§‹å€¼ã€‚ä½†æ˜¯æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åˆæ²¡æœ‰åˆé€‚çš„åˆå§‹å€¼ç»™è¿™ä¸ªæŒ‡é’ˆï¼Œæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨NULLå…³é”®å­—æˆ–è€…C++ä¸­çš„nullptrã€‚ä»£ç å¦‚ä¸‹ï¼š \n\né€šè¿‡ä¸Šé¢çš„å†™æ³•å°±å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆç°åœ¨ä¸ä¼šæŒ‡å‘ä¸ç¡®å®šçš„å†…å­˜å•å…ƒäº†ï¼Œä½†æ˜¯ç›®å‰æš‚æ—¶ä¸éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚ã€€\nC++ä¸­çš„å¼•ç”¨C++ä¸­ä¸ä»…æœ‰æŒ‡é’ˆçš„æ¦‚å¿µï¼Œè€Œä¸”è¿˜å­˜åœ¨ä¸€ä¸ªå¼•ç”¨çš„æ¦‚å¿µï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š\n\næˆ‘å¼€å§‹åœ¨æ¥è§¦è¿™ä¸ªæ¦‚å¿µçš„æ—¶å€™ï¼Œè€æ˜¯å¼„é”™ã€‚å½“æ—¶è¿™ä¹ˆæƒ³çš„ï¼Œæ—¢ç„¶bæ˜¯açš„å¼•ç”¨ï¼Œé‚£ä¹ˆ&amp;båº”è¯¥ç­‰äºaå§?ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨éœ€è¦ä½¿ç”¨å˜é‡açš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨&amp;bæ¥ä»£æ›¿ã€‚\nä¸Šé¢çš„è¿™ç§è®¤è¯†æ˜¯é”™è¯¯çš„ï¼æ‰€è°“å¼•ç”¨ï¼Œä½¿ç”¨å¦å¤–ä¸€ä¸ªå˜é‡åæ¥ä»£è¡¨æŸä¸€å—å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´aå’Œbå®Œå…¨æ˜¯ä¸€æ ·ï¼Œæ‰€ä»¥ä»»ä½•åœ°æ–¹ï¼Œå¯ä»¥ä½¿ç”¨açš„ï¼Œæ¢æˆbä¹Ÿå¯ä»¥ï¼Œè€Œä¸æ˜¯ä½¿ç”¨&amp;bï¼Œè¿™å°±ç›¸å½“äºåŒä¸€ä¸ªäººæœ‰ä¸åŒçš„åå­—ï¼Œä½†æ˜¯ä¸ç®¡å“ªä¸ªåå­—ï¼ŒæŒ‡çš„éƒ½æ˜¯åŒä¸€ä¸ªäººã€‚\n\næ–°æ‰‹åœ¨åˆšæ¥è§¦å¼•ç”¨çš„ä½¿ç”¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ°æ–¹å®¹æ˜“å‡ºé”™ï¼Œå°±æ˜¯å¿˜è®°ç»™å¼•ç”¨åŠæ—¶åˆå§‹åŒ–ï¼Œæ³¨æ„è¿™é‡Œçš„â€œåŠæ—¶â€ä¸¤ä¸ªå­—ï¼ŒC++è§„å®šï¼Œå®šä¹‰ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œå¿…é¡»é©¬ä¸Šåˆå§‹åŒ–ã€‚çœ‹ä¸‹é¢çš„ä»£ç ï¼š\n\nä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨(by value or by reference)çœ‹ä¸‹é¢çš„ä¼ªä»£ç ï¼š\n\nåœ¨æ¶‰åŠåˆ°åˆ©ç”¨ä¸€ä¸ªå·²æœ‰åˆå€¼çš„å˜é‡ç»™å¦å¤–ä¸€ä¸ªå˜é‡èµ‹å€¼æ—¶ï¼Œå¿…é¡»è€ƒè™‘è¿™æ ·çš„æƒ…å†µã€‚å›¾ä¸­å˜é‡aå·²ç»æœ‰äº†åˆå€¼ï¼Œç„¶ååˆ©ç”¨aæ¥ç»™bèµ‹åˆå€¼ï¼Œé‚£ä¹ˆæœ€åæ”¹å˜bçš„å€¼ï¼Œaçš„å€¼ä¼šä¸ä¼šå—å½±å“å‘¢ï¼Ÿè¿™å°±å–å†³äºbåˆ°åº•æ˜¯açš„å‰¯æœ¬è¿˜æ˜¯å’ŒaåŒæ—¶æŒ‡å‘åŒä¸€å†…å­˜åŒºåŸŸï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„èµ‹å€¼æ—¶æ˜¯ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨ã€‚å„å¤§è¯­è¨€éƒ½æ˜¯è¿™æ ·è§„å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å±€é™äºC&#x2F;C++ï¼ŒåŒæ—¶Javaã€C#ã€phpã€javascriptç­‰éƒ½ä¸€æ ·ï¼š\n\nå¦‚æœå˜é‡ç±»å‹æ˜¯åŸºå…ƒæ•°æ®ç±»å‹ï¼ˆåŸºç¡€æ•°æ®ç±»å‹ï¼‰ï¼Œæ¯”å¦‚intã€floatã€boolã€charç­‰å°æ•°æ®ç±»å‹è¢«ç§°ä¸ºåŸºå…ƒæ•°æ®ç±»å‹(primitive data type)ï¼Œé‚£ä¹ˆèµ‹å€¼æ—¶ä¼ çš„æ˜¯å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™bçš„å€¼æ˜¯açš„æ‹·è´ï¼Œé‚£ä¹ˆæ›´æ”¹bä¸ä¼šå½±å“åˆ°aï¼ŒåŒç†æ›´æ”¹aä¹Ÿä¸ä¼šå½±å“åˆ°bã€‚\n\n\nä½†æ˜¯ï¼Œå¦‚æœå˜é‡ç±»å‹æ˜¯å¤æ‚æ•°æ®ç±»å‹(complex data type)ï¼Œä¸å¦‚æ•°ç»„ã€ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆèµ‹å€¼æ—¶ä¼ çš„å°±æ˜¯å¼•ç”¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œaå’ŒbæŒ‡å‘çš„éƒ½æ˜¯åŒä¸€å—å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆæ— è®ºæ›´æ”¹aæˆ–è€…béƒ½ä¼šç›¸äº’å½±å“ã€‚\n\nè®©æˆ‘ä»¬æ¥æ·±å…¥åœ°åˆ†æä¸‹ï¼Œä¸ºä»€ä¹ˆå„å¤§è¯­è¨€éƒ½é‡‡å–è¿™ç§æœºåˆ¶ã€‚å¯¹äºé‚£äº›åŸºå…ƒæ•°æ®ç±»å‹ï¼Œç”±äºæ•°æ®æœ¬èº«å ç”¨çš„å†…å­˜ç©ºé—´å°±å°ï¼Œè¿™æ ·å¤åˆ¶èµ·æ¥ä¸ä»…é€Ÿåº¦å¿«ï¼Œå³ä½¿è¿™æ ·çš„å˜é‡æ•°ç›®å¾ˆå¤šï¼Œæ€»å…±ä¹Ÿä¸ä¼šå å¤šå¤§ç©ºé—´ã€‚ä½†æ˜¯å¯¹äºå¤æ‚æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ä¸€äº›ç±»å¯¹è±¡ï¼Œå®ƒä»¬åŒ…å«çš„å±æ€§å­—æ®µå°±å¾ˆå¤šï¼Œå ç”¨çš„ç©ºé—´å°±å¤§ï¼Œå¦‚æœèµ‹å€¼æ—¶ï¼Œä¹Ÿæ˜¯å¤åˆ¶æ•°æ®ï¼Œé‚£ä¹ˆä¸€ä¸ªä¸¤ä¸ªå¯¹è±¡è¿˜å¥½ï¼Œä¸€æ—¦å¤šä¸€ç‚¹æ¯”å¦‚10ä¸ªã€100ä¸ªï¼Œä¼šå å¾ˆå¤§çš„å†…å­˜å•å…ƒçš„ï¼Œè¿™å°±å¯¼è‡´æ•ˆç‡çš„ä¸‹é™ã€‚\næœ€åï¼Œæé†’ä¸€ç‚¹ï¼Œåœ¨åˆ©ç”¨C++ä¸­æ‹·è´æ„é€ å‡½æ•°å¤åˆ¶å¯¹è±¡æ—¶éœ€è¦æ³¨æ„ï¼ŒåŸºå…ƒæ•°æ®ç±»å‹å¯ä»¥ç›´æ¥å¤åˆ¶ï¼Œä½†æ˜¯å¯¹äºå¼•ç”¨ç±»å‹æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å®ç°å¼•ç”¨å‹æ•°æ®çš„çœŸæ­£å¤åˆ¶ã€‚\nC&#x2F;C++ä¸­çš„newå…³é”®å­—ä¸Javaã€C#ä¸­çš„å…³é”®å­—å¯¹æ¯”\næˆ‘å¤§å­¦æ¯•ä¸šçš„æ—¶å€™ç—´è¿·äºäºç½‘é¡µæ¸¸æˆå¼€å‘ï¼Œä½¿ç”¨çš„è¯­è¨€æ˜¯flashå¹³å°çš„actionscript 3.0ï¼ˆç®€ç§°as3ï¼Œå”‰ï¼Œå¦‚ä»Šå·²ç»æ²¡è½ï¼‰ï¼Œæˆ‘åˆšå¼€å§‹ç”±as3è½¬è¡Œè‡³C&#x2F;C++ï¼Œå¯¹äºC&#x2F;C++ä¸­newå‡ºæ¥çš„å¯¹è±¡å¿…é¡»é€šè¿‡æŒ‡é’ˆå¯¹è±¡æ¥å¼•ç”¨å®ƒéå¸¸ä¸ä¹ æƒ¯ã€‚ä¸Šå›¾ä¸­,Objectæ˜¯ä¸€ä¸ªç±»(class)ï¼Œåœ¨Javaæˆ–è€…C#ç­‰è¯­è¨€ä¸­ï¼Œé€šè¿‡newå…³é”®å­—å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œç›´æ¥å¾—åˆ°Objectçš„å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´åç»­å¼•ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨obj.propertyæˆ–è€…**obj.method()ç­‰å½¢å¼ï¼Œä½†æ˜¯åœ¨C++ä¸­ä¸è¡Œï¼Œæ¯”å¦‚ç”¨ä¸€ä¸ªæŒ‡é’ˆå»æ¥å—è¿™ä¸ªnewå‡ºæ¥çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¼•ç”¨è¿™ä¸ªå¯¹è±¡å¿…é¡»ä½¿ç”¨æŒ‡é’ˆå¼•ç”¨è¿ç®—ç¬¦-&gt;**ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦è¿™æ ·å†™ï¼špObj-&gt;propertyæˆ–pObject-&gt;method()ã€‚ä»£ç å¦‚ä¸‹ï¼š\n\nå½“ç„¶C++ä¸­è¿˜æœ‰ä¸€ç§ä¸éœ€è¦ä½¿ç”¨æŒ‡é’ˆå°±å¯ä»¥å®ä¾‹åŒ–å‡ºæ¥ç±»å¯¹è±¡çš„æ–¹æ³•ï¼Œä»Javaã€C#ç­‰è½¬å‘C++çš„ç¨‹åºå‘˜å®¹æ˜“è¯¯è§£ä¸ºæœªåˆå§‹åŒ–å¯¹è±¡å˜é‡çš„å®šä¹‰ï¼Œçœ‹ä¸‹åˆ—ä»£ç ï¼š\n\nè¿™æ˜¯C++ä¸­åˆ©ç”¨Objectç±»å®ä¾‹åŒ–ä¸¤ä¸ªå¯¹è±¡obj1å’Œobj2ï¼Œobj2å› ä¸ºè°ƒç”¨æ„é€ å‡½æ•°ä¼ äº†ä¸¤ä¸ªå‚æ•°param1,param2è¿˜å¥½ç†è§£ä¸€ç‚¹ï¼Œå¯¹äºobj1å¾ˆå¤šJavaæˆ–è€…C#çš„ç¨‹åºå‘˜å¼€å§‹å¾ˆéš¾æ¥å—è¿™ç§å†™æ³•ï¼Œå› ä¸ºå¦‚æœæ”¾åœ¨Javaæˆ–è€…C#ä¸­ï¼Œobj1æ ¹æœ¬å°±æ²¡æœ‰è¢«å®ä¾‹åŒ–å˜›ï¼Œåœ¨ä»–ä»¬çœ‹æ¥ï¼Œobj1åªæ˜¯ä¸€ä¸ªç®€å•çš„ç±»å‹ç”³æ˜ã€‚å¸Œæœ›Javaã€C#ç­‰ç¨‹åºå‘˜è¦è½¬æ¢è¿‡æ€ç»´æ¥çœ‹å¾…C++ä¸­çš„è¿™ç§å†™æ³•ã€‚\nè¿˜æœ‰ä¸€ç‚¹ä¹Ÿå®¹æ˜“å‡ºé”™ï¼Œåœ¨C++ä¸­ï¼Œthiså…³é”®å­—æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œä¸æ˜¯åƒåœ¨Javaã€C#ä¸­æ˜¯ä¸€ä¸ªç±»å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨C++ä¸­*thisæ‰ç­‰ä»·äºJavaã€C#ä¸­çš„thisã€‚æ‰€ä»¥å†™æ³•ä¹Ÿå°±ä¸ä¸€æ ·äº†ï¼š\n\n\nWindowsç¼–ç¨‹ä¸­çš„æŒ‡é’ˆWindowsæ˜¯æ“ä½œç³»ç»Ÿæ˜¯ç”¨Cè¯­è¨€å†™å‡ºæ¥çš„ï¼Œæ‰€ä»¥å°½ç®¡ä½ åœ¨Windowsä¸­çœ‹åˆ°å¾ˆå¤šä¸è®¤è¯†çš„æ•°æ®ç±»å‹ï¼Œä½†æ˜¯è¿™äº›æ•°æ®ç±»å‹ä¹Ÿæ˜¯é€šè¿‡åŸºæœ¬çš„Cè¯­è¨€ç±»å‹ç»„è£…èµ·æ¥çš„ã€‚æˆ‘ä»¬è¿™é‡Œåªä»‹ç»Windowsä¸­æŒ‡é’ˆå‹æ•°æ®ã€‚\nå®šä¹‰æŒ‡é’ˆæ•°æ®ç±»å‹å¿…é¡»ä½¿ç”¨æ˜Ÿå·(*)ï¼Œä½†æ˜¯Windowsä¸ºäº†å¼€å‘çš„æ–¹ä¾¿ï¼Œé€šè¿‡å®å®šä¹‰å°†æŒ‡é’ˆâ€œéšè—èµ·æ¥â€ï¼Œä¸¥æ ¼åœ°è¯´åº”è¯¥æ˜¯å°†æ˜Ÿå·éšè—èµ·æ¥äº†ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›ä¾‹å­ï¼š\n\nC++ä¸­çš„æ™ºèƒ½æŒ‡é’ˆä¸ºäº†ä¿æŒå†…å®¹çš„å®Œæ•´æ€§ï¼Œæš‚ä¸”åˆ—ä¸€ä¸ªæ ‡é¢˜æ”¾åœ¨è¿™é‡Œï¼Œè¿™ä¸ªè¯é¢˜è¯·å‚è€ƒæœ¬ä¸“é¢˜ç›¸å…³æ–‡ç« ã€‚\næˆ‘èƒ½æƒ³åˆ°çš„å…³äºC&#x2F;C++ä¸­æŒ‡é’ˆçš„å†…å®¹å°±è¿™ä¹ˆå¤šäº†ï¼Œå¸Œæœ›æœ¬æ–‡å¯¹ä½ æœ‰ç”¨ã€‚æ–‡ä¸­å¦‚æœæœ‰ä¸å½“æˆ–è€…çº°æ¼çš„åœ°æ–¹æ¬¢è¿æ‰¹è¯„æŒ‡æ­£ã€‚\n","slug":"è½¬è½½/cpp/æ·±å…¥ç†è§£CC++ä¸­çš„æŒ‡é’ˆ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c1544df243e5ebe89f100e61b30feb98","title":"ã€è½¬è½½ã€‘ç”¨VisualStudioè°ƒè¯•Linuxç¨‹åº","content":"ç”¨Visual Studioè°ƒè¯•Linuxç¨‹åºç”¨Visual Studioè°ƒè¯•Linuxç¨‹åºï¼Ÿä½ çœŸçš„æ²¡çœ‹é”™ï¼Œè¿™ä¸ªæ˜¯çœŸçš„ï¼Œä¸æ˜¯æ ‡é¢˜å…šã€‚å½“ç„¶å¦‚æœä½ è¯´VS2015åŠä»¥ä¸Šç‰ˆæœ¬è‡ªå¸¦çš„Linuxè°ƒè¯•æ’ä»¶ï¼Œé‚£å°±ç®—äº†ã€‚è¿™äº›è‡ªå¸¦çš„æ’ä»¶è°ƒè¯•ä¸€ä¸ªæœ‰ç®€å•çš„mainå‡½æ•°ç¨‹åºè¿˜å‡‘åˆï¼Œç¨å¾®å¤æ‚ç‚¹çš„ç¨‹åºï¼Œæ ¹æœ¬æ— æ³•ç¼–è¯‘è°ƒè¯•ã€‚\nè€Œæœ¬æ–‡ä»‹ç»çš„ä¸»è§’æ˜¯VSçš„å¦å¤–ä¸€æ¬¾æ’ä»¶Visual GDBï¼Œè®©æˆ‘ä»¬æ¬¢è¿ä¸»è§’ç™»åœºï¼Œä¸‹é¢æ˜¯æ­£æ–‡ã€‚\nä½¿ç”¨Visual Studio+VisualGDBè°ƒè¯•è¿œç¨‹Linuxç¨‹åºéœ€è¦å·¥å…·ï¼š\n\nVisual Studio 2013æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼ˆä»¥ä¸‹ç®€ç§°VSï¼‰\nVisualGDBï¼ˆä¸€æ¬¾VSæ’ä»¶ï¼Œå®˜ç½‘ä¸ºï¼šhttp://visualgdb.com/ï¼‰\nå«æœ‰è°ƒè¯•ç¬¦å·çš„Linuxç¨‹åºæ–‡ä»¶ï¼ˆè¯¥ç¨‹åºæ–‡ä»¶ä¸ºè°ƒè¯•ç›®æ ‡ï¼‰\nVisual Assistantï¼ˆç•ªèŒ„åŠ©æ‰‹ï¼Œå¦å¤–ä¸€æ¬¾VSæ’ä»¶ï¼‰\n\nåœ¨VSä¸Šå®‰è£…å®ŒVisualGDBæ’ä»¶ä»¥åï¼Œæœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼æ¥å¯¹è¿œç¨‹Linuxæœºå™¨ä¸Šçš„ç¨‹åºè¿›è¡Œè°ƒè¯•ï¼š\n\næ–¹æ³•ä¸€ã€å¦‚æœè¯¥ç¨‹åºå·²ç»å¯åŠ¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨VSèœå•ã€Debugã€‘-&gt;ã€Attach to Processâ€¦ã€‘ã€‚\n\n\n\n\n\n\nè¿™ç§æ–¹æ³•æœ‰ä¸ªç¼ºç‚¹æ˜¯ï¼Œä¸èƒ½ä»å¼€å§‹å¯åŠ¨çš„mainå‡½æ•°å¤„æ·»åŠ æ–­ç‚¹ï¼Œè‡ªå§‹è‡³ç»ˆåœ°è°ƒè¯•ç¨‹åºï¼ŒæŸ¥çœ‹å®Œæ•´ç¨‹åºè¿è¡Œè„‰ç»œï¼Œæ‰€ä»¥ä¸‹é¢æ¨èæ–¹æ³•äºŒã€‚\n\næ–¹æ³•äºŒã€åˆ©ç”¨VSå¯åŠ¨è¿œç¨‹Linuxæœºå™¨ä¸Šä¸€ä¸ªLinuxç¨‹åºæ–‡ä»¶è¿›è¡Œè°ƒè¯•ã€‚é€‰æ‹©VSèœå•ã€Debugã€‘ -&gt;ã€Quick Debugwith GDBã€‘ã€‚\n\n\néœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œå·²ç»åœ¨ä¸Šå›¾ä¸­æ ‡çº¢æ¡†ã€‚è¿™é‡Œç®€å•åœ°è§£é‡Šä¸€ä¸‹ï¼š\nå¦‚æœä½ å®‰è£…äº†äº¤å‰ç¼–è¯‘ç¯å¢ƒTargetå¯ä»¥é€‰æ‹©MinGW&#x2F;Cygwinï¼Œå¦åˆ™å°±é€‰æ‹©è¿œç¨‹Linuxç³»ç»Ÿã€‚è¿™é‡Œå¦‚æœä¸å­˜åœ¨ä¸€ä¸ªsshè¿æ¥ï¼Œåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªã€‚ \nDebugged programæ˜¯éœ€è¦è®¾ç½®çš„è¢«è°ƒè¯•ç¨‹åºçš„è·¯å¾„ï¼Œä½äºè¿œç¨‹Linuxæœºå™¨ä¸Šã€‚\nArgumentsæ˜¯è¯¥è°ƒè¯•ç¨‹åºéœ€è¦è®¾ç½®çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¦‚æœè¢«è°ƒè¯•ç¨‹åºä¸éœ€è¦å‘½ä»¤è¡Œå‚æ•°å¯ä»¥ä¸è®¾ç½®ã€‚\nWorking directoryæ˜¯è¢«è°ƒè¯•ç¨‹åºè¿è¡Œçš„å·¥ä½œç›®å½•ã€‚\nå¦å¤–å»ºè®®å‹¾é€‰ä¸ŠInitial breakpoint in mainï¼Œè¿™æ ·å¯åŠ¨è°ƒè¯•æ—¶ï¼Œç¨‹åºå°±ä¼šåœåœ¨ç¨‹åºå…¥å£å¤„ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨VSå¼ºå¤§çš„åŠŸèƒ½å»æŸ¥çœ‹ç¨‹åºçš„å„ç§çŠ¶æ€äº†ï¼Œå¸¸ç”¨çš„é¢æ¿ï¼Œå¦‚ã€å†…å­˜ã€‘ã€çº¿ç¨‹ã€‘ã€è§‚å¯Ÿã€‘ã€å †æ ˆã€‘ã€GDB Sessionã€‘ã€æ–­ç‚¹ã€‘ç­‰çª—å£ä½äºVS èœå•ã€Debugã€‘-&gt;ã€Windowsã€‘èœå•ä¸‹ï¼Œæ³¨æ„ï¼Œæœ‰äº›çª—å£åªæœ‰åœ¨è°ƒè¯•çŠ¶æ€ä¸‹æ‰å¯è§ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªå€¼å¾—å¼ºè°ƒä¸€ä¸‹çš„åŠŸèƒ½æ˜¯ï¼š\n\nGDB Session****çª—å£ï¼Œåœ¨è¿™ä¸ªçª—å£é‡Œé¢å¯ä»¥åƒåŸæ¥ç›´æ¥ä½¿ç”¨gdbè°ƒè¯•ä¸€æ ·è¾“å…¥gdbæŒ‡ä»¤æ¥è¿›è¡Œè°ƒè¯•ã€‚\n\n\n\nSSH console****çª—å£ï¼Œè¿™ä¸ªçª—å£ç±»ä¼¼ä¸€ä¸ªè¿œç¨‹æ“ä½œLinuxç³»ç»Ÿçš„åº”ç”¨ç¨‹åºå¦‚xshellã€SecureCRTã€‚\n\n\nç°åœ¨è¿˜å‰©ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬è™½ç„¶åœ¨è°ƒè¯•æ—¶å¯è§†åŒ–åœ°è¿œç¨‹æŸ¥çœ‹ä¸€ä¸ªLinuxè¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œä½†å¾ˆå¤šç±»å‹çš„å®šä¹‰å’Œä»€ä¹ˆå´æ— æ³•çœ‹åˆ°ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•å°±æ˜¯ä½ å¯ä»¥å…ˆåœ¨VSé‡Œé¢å»ºç«‹ä¸€ä¸ªå·¥ç¨‹ï¼Œå¯¼å…¥ä½ è¦è°ƒè¯•çš„ç¨‹åºçš„æºä»£ç ç›®å½•ã€‚ç„¶ååˆ©ç”¨æ–¹æ³•ä¸€æˆ–è€…æ–¹æ³•äºŒå»å¯åŠ¨è°ƒè¯•ç¨‹åºã€‚è¿™ä¸ªæ—¶å€™ä½ æƒ³æŸ¥çœ‹æŸä¸ªç±»å‹çš„å®šä¹‰æˆ–ä»€ä¹ˆåªè¦åˆ©ç”¨Visual Assitçš„æŸ¥çœ‹æºç åŠŸèƒ½å³å¯ï¼Œå¿«æ·é”®æ˜¯Alt + Gã€‚\n\néœ€è¦æ³¨æ„çš„æ—¶ï¼šåŒæ—¶å®‰è£…äº†Visual Assistå’ŒVisualGDBåï¼Œåè€…ä¹Ÿä¼šæä¾›ä¸€ä¸ªgoæŒ‰é’®å»æŸ¥æ‰¾æºç å®šä¹‰ï¼Œä½†è¿™ä¸ªåŠŸèƒ½è¿œä¸å¦‚Visual AssistæŒ‰é’®å¥½ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç¦ç”¨æ‰å®ƒæ¥ä½¿ç”¨Visual Assistçš„GoåŠŸèƒ½ã€‚ç¦ç”¨æ–¹æ³•ï¼Œæ‰“å¼€èœå•ï¼šã€Toolsã€‘-&gt;ã€Optionâ€¦ã€‘:\n\nç„¶åé‡å¯VSå³å¯ã€‚\nåˆ°è¿™é‡Œï¼Œæ—¢å¯ä»¥æŸ¥çœ‹æºç ï¼Œä¹Ÿå¯ä»¥è°ƒè¯•ç¨‹åºäº†ã€‚\nVisualGDB ä¸‹è½½åœ°å€ï¼š\né“¾æ¥ï¼šhttps://share.weiyun.com/57aGHLM å¯†ç ï¼škj9ahs\n","slug":"è½¬è½½/cpp/ç”¨VisualStudioè°ƒè¯•Linuxç¨‹åº","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ca4f18d64c449f5b0232c48e6847b463","title":"ã€è½¬è½½ã€‘è¯¦è§£C++11ä¸­çš„æ™ºèƒ½æŒ‡é’ˆ","content":"è¯¦è§£ C++ 11 ä¸­çš„æ™ºèƒ½æŒ‡é’ˆC&#x2F;C++ è¯­è¨€æœ€ä¸ºäººæ‰€è¯Ÿç—…çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å­˜åœ¨å†…å­˜æ³„éœ²é—®é¢˜ï¼Œå› æ­¤åæ¥çš„å¤§å¤šæ•°è¯­è¨€éƒ½æä¾›äº†å†…ç½®å†…å­˜åˆ†é…ä¸é‡Šæ”¾åŠŸèƒ½ï¼Œæœ‰çš„ç”šè‡³å¹²è„†å¯¹è¯­è¨€çš„ä½¿ç”¨è€…å±è”½äº†å†…å­˜æŒ‡é’ˆè¿™ä¸€æ¦‚å¿µã€‚è¿™é‡Œä¸ç½®è´¬è¤’ï¼Œæ‰‹åŠ¨åˆ†é…å†…å­˜ä¸æ‰‹åŠ¨é‡Šæ”¾å†…å­˜æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œè‡ªåŠ¨åˆ†é…å†…å­˜å’Œè‡ªåŠ¨é‡Šæ”¾å†…å­˜äº¦å¦‚æ­¤ï¼Œè¿™æ˜¯ä¸¤ç§ä¸åŒçš„è®¾è®¡å“²å­¦ã€‚æœ‰äººè®¤ä¸ºï¼Œå†…å­˜å¦‚æ­¤é‡è¦çš„ä¸œè¥¿æ€ä¹ˆèƒ½æ”¾å¿ƒäº¤ç»™ç”¨æˆ·å»ç®¡ç†å‘¢ï¼Ÿè€Œå¦å¤–ä¸€äº›äººåˆ™è®¤ä¸ºï¼Œå†…å­˜å¦‚æ­¤é‡è¦çš„ä¸œè¥¿æ€ä¹ˆèƒ½æ”¾å¿ƒäº¤ç»™ç³»ç»Ÿå»ç®¡ç†å‘¢ï¼Ÿåœ¨ C&#x2F;C++ è¯­è¨€ä¸­ï¼Œå†…å­˜æ³„éœ²çš„é—®é¢˜ä¸€ç›´å›°æ‰°ç€å¹¿å¤§çš„å¼€å‘è€…ï¼Œå› æ­¤å„ç±»åº“å’Œå·¥å…·çš„ä¸€ç›´åœ¨åŠªåŠ›å°è¯•å„ç§æ–¹æ³•å»æ£€æµ‹å’Œé¿å…å†…å­˜æ³„éœ²ï¼Œå¦‚ boostï¼Œæ™ºèƒ½æŒ‡é’ˆæŠ€æœ¯åº”è¿è€Œç”Ÿã€‚\nC++ 98&#x2F;03 çš„å°è¯•â€”â€”std::auto_ptråœ¨ 2019 å¹´è®¨è®º std::auto_ptr ä¸å…æœ‰ç‚¹è®©äººæ€€ç–‘æ˜¯ä¸æ˜¯æœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç¡®å®å¦‚æ­¤ï¼Œéšç€ C++11 æ ‡å‡†çš„å‡ºç°ï¼ˆæœ€æ–°æ ‡å‡†æ˜¯ C++20ï¼‰ï¼Œstd::auto_ptr å·²ç»è¢«å½»åº•åºŸå¼ƒäº†ï¼Œå–è€Œä»£ä¹‹æ˜¯ std::unique_ptrã€‚ç„¶è€Œï¼Œæˆ‘ä¹‹æ‰€ä»¥è¿˜å‘ä½ ä»‹ç»ä¸€ä¸‹ std::auto_ptr çš„ç”¨æ³•ä»¥åŠå®ƒçš„è®¾è®¡ä¸è¶³ä¹‹å¤„æ˜¯æƒ³è®©ä½ äº†è§£ C++ è¯­è¨€ä¸­æ™ºèƒ½æŒ‡é’ˆçš„å‘å±•è¿‡ç¨‹ï¼Œä¸€é¡¹æŠ€æœ¯å¦‚æœæˆ‘ä»¬äº†è§£å®ƒè¿‡å»çš„æ ·å­å’Œå‘å±•çš„è½¨è¿¹ï¼Œæˆ‘ä»¬å°±èƒ½æ›´å¥½åœ°æŒæ¡å®ƒï¼Œä¸æ˜¯å—ï¼Ÿ\nstd::auto_ptr çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š\n123456789101112#include &lt;memory&gt;int main()&#123;    //åˆå§‹åŒ–æ–¹å¼1    std::auto_ptr&lt;int&gt; sp1(new int(8));    //åˆå§‹åŒ–æ–¹å¼2    std::auto_ptr&lt;int&gt; sp2;    sp2.reset(new int(8));    return 0;&#125;\n\næ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ sp1 å’Œ sp2 å‡æŒæœ‰ä¸€ä¸ªåœ¨å †ä¸Šåˆ†é… int å¯¹è±¡ï¼Œå…¶å€¼å‡æ˜¯ 8ï¼Œè¿™ä¸¤å—å †å†…å­˜å‡å¯ä»¥åœ¨ sp1 å’Œ sp2 é‡Šæ”¾æ—¶å¾—åˆ°é‡Šæ”¾ã€‚è¿™æ˜¯ std::auto_ptr çš„åŸºæœ¬ç”¨æ³•ã€‚\n\nsp æ˜¯ smart pointerï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰çš„ç®€å†™ã€‚\n\nstd::auto_ptr çœŸæ­£è®©äººå®¹æ˜“è¯¯ç”¨çš„åœ°æ–¹æ˜¯å…¶ä¸å¸¸ç”¨çš„å¤åˆ¶è¯­ä¹‰ï¼Œå³å½“å¤åˆ¶ä¸€ä¸ª std::auto_ptr å¯¹è±¡æ—¶ï¼ˆæ‹·è´å¤åˆ¶æˆ– operator &#x3D; å¤åˆ¶ï¼‰ï¼ŒåŸå¯¹è±¡æ‰€æŒæœ‰çš„å †å†…å­˜å¯¹è±¡ä¹Ÿä¼šè½¬ç§»ç»™å¤åˆ¶å‡ºæ¥çš„å¯¹è±¡ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;iostream&gt;#include &lt;memory&gt;int main()&#123;    //æµ‹è¯•æ‹·è´æ„é€     std::auto_ptr&lt;int&gt; sp1(new int(8));    std::auto_ptr&lt;int&gt; sp2(sp1);    if (sp1.get() != NULL)    &#123;        std::cout &lt;&lt; &quot;sp1 is not empty.&quot; &lt;&lt; std::endl;    &#125;    else    &#123;        std::cout &lt;&lt; &quot;sp1 is empty.&quot; &lt;&lt; std::endl;    &#125;    if (sp2.get() != NULL)    &#123;        std::cout &lt;&lt; &quot;sp2 is not empty.&quot; &lt;&lt; std::endl;    &#125;    else    &#123;        std::cout &lt;&lt; &quot;sp2 is empty.&quot; &lt;&lt; std::endl;    &#125;    //æµ‹è¯•èµ‹å€¼æ„é€     std::auto_ptr&lt;int&gt; sp3(new int(8));    std::auto_ptr&lt;int&gt; sp4;    sp4 = sp3;    if (sp3.get() != NULL)    &#123;        std::cout &lt;&lt; &quot;sp3 is not empty.&quot; &lt;&lt; std::endl;    &#125;    else    &#123;        std::cout &lt;&lt; &quot;sp3 is empty.&quot; &lt;&lt; std::endl;    &#125;    if (sp4.get() != NULL)    &#123;        std::cout &lt;&lt; &quot;sp4 is not empty.&quot; &lt;&lt; std::endl;    &#125;    else    &#123;        std::cout &lt;&lt; &quot;sp4 is empty.&quot; &lt;&lt; std::endl;    &#125;    return 0;&#125;\n\nä¸Šè¿°ä»£ç ä¸­åˆ†åˆ«åˆ©ç”¨æ‹·è´æ„é€ ï¼ˆsp1 &#x3D;&gt; sp2ï¼‰å’Œ èµ‹å€¼æ„é€ ï¼ˆsp3 &#x3D;&gt; sp4ï¼‰æ¥åˆ›å»ºæ–°çš„ std::auto_ptr å¯¹è±¡ï¼Œå› æ­¤ sp1 æŒæœ‰çš„å †å¯¹è±¡è¢«è½¬ç§»ç»™ sp2ï¼Œsp3 æŒæœ‰çš„å †å¯¹è±¡è¢«è½¬ç§»ç»™ sp4ã€‚æˆ‘ä»¬å¾—åˆ°ç¨‹åºæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\n123456[root@iZ238vnojlyZ testx]# g++ -g -o test_auto_ptr test_auto_ptr.cpp[root@iZ238vnojlyZ testx]# ./test_auto_ptr sp1 is empty.sp2 is not empty.sp3 is empty.sp4 is not empty.\n\nç”±äº std::auto_ptr è¿™ç§ä¸å¸¸ç”¨çš„å¤åˆ¶è¯­ä¹‰ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…åœ¨ stl å®¹å™¨ä¸­ä½¿ç”¨ std::auto_ptrï¼Œä¾‹å¦‚æˆ‘ä»¬ç»ä¸åº”è¯¥å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š\n1std::vector&lt;std::auto_ptr&lt;int&gt;&gt; myvectors;\n\nå½“ç”¨ç®—æ³•å¯¹å®¹å™¨æ“ä½œçš„æ—¶å€™ï¼ˆå¦‚æœ€å¸¸è§çš„å®¹å™¨å…ƒç´ éå†ï¼‰ï¼Œå¾ˆéš¾é¿å…ä¸å¯¹å®¹å™¨ä¸­çš„å…ƒç´ å®ç°èµ‹å€¼ä¼ é€’ï¼Œè¿™æ ·ä¾¿ä¼šä½¿å®¹å™¨ä¸­å¤šä¸ªå…ƒç´ è¢«ç½®ä¸ºç©ºæŒ‡é’ˆï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³çœ‹åˆ°çš„ï¼Œä¼šé€ æˆå¾ˆå¤šæ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚\nä»¥å²ä¸ºé‰´ï¼Œä½œä¸º std::auto_ptr çš„æ›¿ä»£è€… std::unique_ptr å¸å–äº†è¿™ä¸ªç»éªŒæ•™è®­ã€‚ä¸‹æ–‡ä¼šæ¥è¯¦ç»†ä»‹ç»ã€‚\næ­£å› ä¸º std::auto_ptr çš„è®¾è®¡å­˜åœ¨å¦‚æ­¤é‡å¤§ç¼ºé™·ï¼ŒC++11 æ ‡å‡†åœ¨å……åˆ†å€Ÿé‰´å’Œå¸æ”¶äº† boost åº“ä¸­æ™ºèƒ½æŒ‡é’ˆçš„è®¾è®¡æ€æƒ³ï¼Œå¼•å…¥äº†ä¸‰ç§ç±»å‹çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå³ std::unique_ptrã€std::shared_ptr å’Œ std::weak_ptrã€‚\n\nboost è¿˜æœ‰ scoped_ptrï¼ŒC++11 å¹¶æ²¡æœ‰å…¨éƒ¨ç…§æ¬ï¼Œè€Œæ˜¯é€‰æ‹©äº†ä¸‰ä¸ªæœ€å®ç”¨çš„æŒ‡é’ˆç±»å‹ã€‚åœ¨ C++11 ä¸­å¯ä»¥é€šè¿‡ std::unique_ptr è¾¾åˆ°ä¸ boost::scoped_ptr ä¸€æ ·çš„æ•ˆæœã€‚\n\næ‰€æœ‰çš„æ™ºèƒ½æŒ‡é’ˆç±»ï¼ˆåŒ…æ‹¬ std::unique_ptrï¼‰å‡åŒ…å«äºå¤´æ–‡ä»¶ **** ä¸­ã€‚\n\næ­£å› ä¸ºå­˜åœ¨ä¸Šè¿°è®¾è®¡ä¸Šçš„ç¼ºé™·ï¼Œåœ¨ C++11åŠåç»­è¯­è¨€è§„èŒƒä¸­ std::auto_ptr å·²ç»è¢«åºŸå¼ƒï¼Œä½ çš„ä»£ç ä¸åº”è¯¥å†ä½¿ç”¨å®ƒã€‚\n\nstd::unique_ptrstd::unique_ptr å¯¹å…¶æŒæœ‰çš„å †å†…å­˜å…·æœ‰å”¯ä¸€æ‹¥æœ‰æƒï¼Œä¹Ÿå°±æ˜¯è¯´å¼•ç”¨è®¡æ•°æ°¸è¿œæ˜¯ 1ï¼Œstd::unique_ptr å¯¹è±¡é”€æ¯æ—¶ä¼šé‡Šæ”¾å…¶æŒæœ‰çš„å †å†…å­˜ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼åˆå§‹åŒ–ä¸€ä¸ª std::unique_ptr å¯¹è±¡ï¼š\n123456789//åˆå§‹åŒ–æ–¹å¼1std::unique_ptr&lt;int&gt; sp1(new int(123));//åˆå§‹åŒ–æ–¹å¼2std::unique_ptr&lt;int&gt; sp2;sp2.reset(new int(123));//åˆå§‹åŒ–æ–¹å¼3std::unique_ptr&lt;int&gt; sp3 = std::make_unique&lt;int&gt;(123);\n\nä½ åº”è¯¥å°½é‡ä½¿ç”¨åˆå§‹åŒ–æ–¹å¼ 3 çš„æ–¹å¼å»åˆ›å»ºä¸€ä¸ª std::unique_ptr è€Œä¸æ˜¯æ–¹å¼ 1 å’Œ 2ï¼Œå› ä¸ºå½¢å¼ 3 æ›´å®‰å…¨ï¼ŒåŸå›  Scott Meyers åœ¨å…¶ã€ŠEffective Modern C++ã€‹ä¸­å·²ç»è§£é‡Šè¿‡äº†ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯»æ­¤ä¹¦ç›¸å…³ç« èŠ‚ã€‚\n\nä»¤å¾ˆå¤šäººå¯¹ C++11 è§„èŒƒä¸æ»¡çš„åœ°æ–¹æ˜¯ï¼ŒC++11 æ–°å¢äº† std::make_shared() æ–¹æ³•åˆ›å»ºä¸€ä¸ª std::shared_ptr å¯¹è±¡ï¼Œå´æ²¡æœ‰æä¾›ç›¸åº”çš„ std::make_unique() æ–¹æ³•åˆ›å»ºä¸€ä¸ª std::unique_ptr å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•ç›´åˆ° C++14 æ‰è¢«æ·»åŠ è¿›æ¥ã€‚å½“ç„¶ï¼Œåœ¨ C++11 ä¸­ä½ å¾ˆå®¹æ˜“å®ç°å‡ºè¿™æ ·ä¸€ä¸ªæ–¹æ³•æ¥ï¼š\n\n12345template&lt;typename T, typename... Ts&gt;std::unique_ptr&lt;T&gt; make_unique(Ts&amp;&amp; ...params)&#123;    return std::unique_ptr&lt;T&gt;(new T(std::forward&lt;Ts&gt;(params)...));&#125;\n\né‰´äº std::auto_ptr çš„å‰è½¦ä¹‹é‰´ï¼Œstd::unique_ptr ç¦æ­¢å¤åˆ¶è¯­ä¹‰ï¼Œä¸ºäº†è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œstd::unique_ptr ç±»çš„æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼ˆoperator &#x3D;ï¼‰è¢«æ ‡è®°ä¸º deleteã€‚\n123456789template &lt;class T&gt;class unique_ptr&#123;    //çœç•¥å…¶ä»–ä»£ç ...    //æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦è¢«æ ‡è®°ä¸ºdelete    unique_ptr(const unique_ptr&amp;) = delete;    unique_ptr&amp; operator=(const unique_ptr&amp;) = delete;&#125;;\n\nå› æ­¤ï¼Œä¸‹åˆ—ä»£ç æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼š\n1234567std::unique_ptr&lt;int&gt; sp1(std::make_unique&lt;int&gt;(123));;//ä»¥ä¸‹ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘//std::unique_ptr&lt;int&gt; sp2(sp1);std::unique_ptr&lt;int&gt; sp3;//ä»¥ä¸‹ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘//sp3 = sp1;\n\nç¦æ­¢å¤åˆ¶è¯­ä¹‰ä¹Ÿå­˜åœ¨ç‰¹ä¾‹ï¼Œå³å¯ä»¥é€šè¿‡ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª std::unique_ptrï¼š\n1234567891011121314#include &lt;memory&gt;std::unique_ptr&lt;int&gt; func(int val)&#123;    std::unique_ptr&lt;int&gt; up(new int(val));    return up;&#125;int main()&#123;    std::unique_ptr&lt;int&gt; sp1 = func(123);    return 0;&#125;\n\nä¸Šè¿°ä»£ç ä» func å‡½æ•°ä¸­å¾—åˆ°ä¸€ä¸ª std::unique_ptr å¯¹è±¡ï¼Œç„¶åè¿”å›ç»™ sp1ã€‚\næ—¢ç„¶ std::unique_ptr ä¸èƒ½å¤åˆ¶ï¼Œé‚£ä¹ˆå¦‚ä½•å°†ä¸€ä¸ª std::unique_ptr å¯¹è±¡æŒæœ‰çš„å †å†…å­˜è½¬ç§»ç»™å¦å¤–ä¸€ä¸ªå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨ç§»åŠ¨æ„é€ ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213#include &lt;memory&gt;int main()&#123;    std::unique_ptr&lt;int&gt; sp1(std::make_unique&lt;int&gt;(123));    std::unique_ptr&lt;int&gt; sp2(std::move(sp1));    std::unique_ptr&lt;int&gt; sp3;    sp3 = std::move(sp2);    return 0;&#125;\n\nä»¥ä¸Šä»£ç åˆ©ç”¨ std::move å°† sp1 æŒæœ‰çš„å †å†…å­˜ï¼ˆå€¼ä¸º 123ï¼‰è½¬ç§»ç»™ sp2ï¼Œå†æŠŠ sp2 è½¬ç§»ç»™ sp3ã€‚æœ€åï¼Œsp1 å’Œ sp2 ä¸å†æŒæœ‰å †å†…å­˜çš„å¼•ç”¨ï¼Œå˜æˆä¸€ä¸ªç©ºçš„æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡çš„ std::move æ“ä½œéƒ½æœ‰æ„ä¹‰ï¼Œåªæœ‰å®ç°äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆMove Constructorï¼‰æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼ˆoperator &#x3D;ï¼‰çš„ç±»æ‰è¡Œï¼Œè€Œ std::unique_ptr æ­£å¥½å®ç°äº†è¿™äºŒè€…ï¼Œä»¥ä¸‹æ˜¯å®ç°ä¼ªç ï¼š\n1234567891011121314151617181920212223template&lt;typename T, typename Deletor&gt;class unique_ptr&#123;    //å…¶ä»–å‡½æ•°çœç•¥...public:    unique_ptr(unique_ptr&amp;&amp; rhs)    &#123;        this-&gt;m_pT = rhs.m_pT;        //æºå¯¹è±¡é‡Šæ”¾        rhs.m_pT = nullptr;    &#125;    unique_ptr&amp; operator=(unique_ptr&amp;&amp; rhs)    &#123;        this-&gt;m_pT = rhs.m_pT;        //æºå¯¹è±¡é‡Šæ”¾        rhs.m_pT = nullptr;        return *this;    &#125;private:    T*    m_pT;&#125;;\n\nè¿™æ˜¯ std::unique_ptr å…·æœ‰ç§»åŠ¨è¯­ä¹‰çš„åŸå› ï¼Œå¸Œæœ›è¯»è€…å¯ä»¥ç†è§£ä¹‹ã€‚å…³äºç§»åŠ¨æ„é€ å’Œ std::moveï¼Œæˆ‘ä»¬å°†åœ¨åé¢ç« èŠ‚è¯¦ç»†ä»‹ç»ã€‚\nstd::unique_ptr ä¸ä»…å¯ä»¥æŒæœ‰ä¸€ä¸ªå †å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æŒæœ‰ä¸€ç»„å †å¯¹è±¡ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829#include &lt;iostream&gt;#include &lt;memory&gt;int main()&#123;    //åˆ›å»º10ä¸ªintç±»å‹çš„å †å¯¹è±¡    //å½¢å¼1    std::unique_ptr&lt;int[]&gt; sp1(new int[10]);    //å½¢å¼2    std::unique_ptr&lt;int[]&gt; sp2;    sp2.reset(new int[10]);    //å½¢å¼3    std::unique_ptr&lt;int[]&gt; sp3(std::make_unique&lt;int[]&gt;(10));    for (int i = 0; i &lt; 10; ++i)    &#123;        sp1[i] = i;        sp2[i] = i;        sp3[i] = i;    &#125;    for (int i = 0; i &lt; 10; ++i)    &#123;        std::cout &lt;&lt; sp1[i] &lt;&lt; &quot;, &quot; &lt;&lt; sp2[i] &lt;&lt; &quot;, &quot; &lt;&lt; sp3[i] &lt;&lt; std::endl;    &#125;    return 0;&#125;\n\nç¨‹åºæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\n123456789101112[root@myaliyun testmybook]# g++ -g -o test_unique_ptr_with_array test_unique_ptr_with_array.cpp -std=c++17[root@myaliyun testmybook]# ./test_unique_ptr_with_array 0, 0, 01, 1, 12, 2, 23, 3, 34, 4, 45, 5, 56, 6, 67, 7, 78, 8, 89, 9, 9\n\nstd::shared_ptr å’Œ std::weak_ptr ä¹Ÿå¯ä»¥æŒæœ‰ä¸€ç»„å †å¯¹è±¡ï¼Œç”¨æ³•ä¸ std::unique_ptr ç›¸åŒï¼Œä¸‹æ–‡ä¸å†èµ˜è¿°ã€‚\nè‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æŒæœ‰çš„èµ„æºçš„é‡Šæ”¾å‡½æ•°\né»˜è®¤æƒ…å†µä¸‹ï¼Œæ™ºèƒ½æŒ‡é’ˆå¯¹è±¡åœ¨ææ„æ—¶åªä¼šé‡Šæ”¾å…¶æŒæœ‰çš„å †å†…å­˜ï¼ˆè°ƒç”¨ delete æˆ–è€… delete[]ï¼‰ï¼Œä½†æ˜¯å‡è®¾è¿™å—å †å†…å­˜ä»£è¡¨çš„å¯¹è±¡è¿˜å¯¹åº”ä¸€ç§éœ€è¦å›æ”¶çš„èµ„æºï¼ˆå¦‚æ“ä½œç³»ç»Ÿçš„å¥—æ¥å­—å¥æŸ„ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆçš„èµ„æºé‡Šæ”¾å‡½æ•°ã€‚å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª Socket ç±»ï¼Œå¯¹åº”ç€æ“ä½œç³»ç»Ÿçš„å¥—æ¥å­—å¥æŸ„ï¼Œåœ¨å›æ”¶æ—¶éœ€è¦å…³é—­è¯¥å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹è‡ªå®šä¹‰æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡çš„èµ„æºææ„å‡½æ•°ï¼Œè¿™é‡Œä»¥ std::unique_ptr ä¸ºä¾‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;#include &lt;memory&gt;class Socket&#123;public:    Socket()    &#123;    &#125;    ~Socket()    &#123;    &#125;    //å…³é—­èµ„æºå¥æŸ„    void close()    &#123;    &#125;&#125;;int main()&#123;    auto deletor = [](Socket* pSocket) &#123;        //å…³é—­å¥æŸ„        pSocket-&gt;close();        //TODO: ä½ ç”šè‡³å¯ä»¥åœ¨è¿™é‡Œæ‰“å°ä¸€è¡Œæ—¥å¿—...        delete pSocket;    &#125;;    std::unique_ptr&lt;Socket, void(*)(Socket * pSocket)&gt; spSocket(new Socket(), deletor);    return 0;&#125;\n\nè‡ªå®šä¹‰ std::unique_ptr çš„èµ„æºé‡Šæ”¾å‡½æ•°å…¶è§„åˆ™æ˜¯ï¼š\n1std::unique_ptr&lt;T, DeletorFuncPtr&gt;\n\nå…¶ä¸­ T æ˜¯ä½ è¦é‡Šæ”¾çš„å¯¹è±¡ç±»å‹ï¼ŒDeletorPtr æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°æŒ‡é’ˆã€‚ä¸Šè¿°ä»£ç  33 è¡Œè¡¨ç¤º DeletorPtr æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ decltype(deletor) è®©ç¼–è¯‘å™¨è‡ªå·±æ¨å¯¼ deletor çš„ç±»å‹ï¼Œå› æ­¤å¯ä»¥å°† 33 è¡Œä»£ç ä¿®æ”¹ä¸ºï¼š\n1std::unique_ptr&lt;Socket, decltype(deletor)&gt; spSocket(new Socket(), deletor);\n\nstd::shared_ptrstd::unique_ptr å¯¹å…¶æŒæœ‰çš„èµ„æºå…·æœ‰ç‹¬å æ€§ï¼Œè€Œ std::shared_ptr æŒæœ‰çš„èµ„æºå¯ä»¥åœ¨å¤šä¸ª std::shared_ptr ä¹‹é—´å…±äº«ï¼Œæ¯å¤šä¸€ä¸ª std::shared_ptr å¯¹èµ„æºçš„å¼•ç”¨ï¼Œèµ„æºå¼•ç”¨è®¡æ•°å°†å¢åŠ  1ï¼Œæ¯ä¸€ä¸ªæŒ‡å‘è¯¥èµ„æºçš„ std::shared_ptr å¯¹è±¡ææ„æ—¶ï¼Œèµ„æºå¼•ç”¨è®¡æ•°å‡ 1ï¼Œæœ€åä¸€ä¸ª std::shared_ptr å¯¹è±¡ææ„æ—¶ï¼Œå‘ç°èµ„æºè®¡æ•°ä¸º 0ï¼Œå°†é‡Šæ”¾å…¶æŒæœ‰çš„èµ„æºã€‚å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼Œé€’å¢å’Œå‡å°‘èµ„æºçš„å¼•ç”¨è®¡æ•°æ˜¯å®‰å…¨çš„ã€‚ï¼ˆæ³¨æ„ï¼šè¿™ä¸æ„å‘³ç€å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œ std::shared_ptr å¼•ç”¨çš„å¯¹è±¡æ˜¯å®‰å…¨çš„ï¼‰ã€‚std::shared_ptr æä¾›äº†ä¸€ä¸ª use_count() æ–¹æ³•æ¥è·å–å½“å‰æŒæœ‰èµ„æºçš„å¼•ç”¨è®¡æ•°ã€‚é™¤äº†ä¸Šé¢æè¿°çš„ï¼Œstd::shared_ptr ç”¨æ³•å’Œ std::unique_ptr åŸºæœ¬ç›¸åŒã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªåˆå§‹åŒ– std::shared_ptr çš„ç¤ºä¾‹ï¼š\n12345678910//åˆå§‹åŒ–æ–¹å¼1std::shared_ptr&lt;int&gt; sp1(new int(123));//åˆå§‹åŒ–æ–¹å¼2std::shared_ptr&lt;int&gt; sp2;sp2.reset(new int(123));//åˆå§‹åŒ–æ–¹å¼3std::shared_ptr&lt;int&gt; sp3;sp3 = std::make_shared&lt;int&gt;(123);\n\nå’Œ std::unique_ptr ä¸€æ ·ï¼Œä½ åº”è¯¥ä¼˜å…ˆä½¿ç”¨ std::make_shared å»åˆå§‹åŒ–ä¸€ä¸ª std::shared_ptr å¯¹è±¡ã€‚\nå†æ¥çœ‹å¦å¤–ä¸€æ®µä»£ç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;iostream&gt;#include &lt;memory&gt;class A&#123;public:    A()    &#123;        std::cout &lt;&lt; &quot;A constructor&quot; &lt;&lt; std::endl;    &#125;    ~A()    &#123;        std::cout &lt;&lt; &quot;A destructor&quot; &lt;&lt; std::endl;    &#125;&#125;;int main()&#123;    &#123;        //åˆå§‹åŒ–æ–¹å¼1        std::shared_ptr&lt;A&gt; sp1(new A());        std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;        //åˆå§‹åŒ–æ–¹å¼2        std::shared_ptr&lt;A&gt; sp2(sp1);        std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;        sp2.reset();        std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;        &#123;            std::shared_ptr&lt;A&gt; sp3 = sp1;            std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;        &#125;        std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    &#125;    return 0;&#125;\n\n\nä¸Šè¿°ä»£ç  22 è¡Œ sp1 æ„é€ æ—¶ï¼ŒåŒæ—¶è§¦å‘å¯¹è±¡ A çš„æ„é€ ï¼Œå› æ­¤ A çš„æ„é€ å‡½æ•°ä¼šæ‰§è¡Œï¼›\næ­¤æ—¶åªæœ‰ä¸€ä¸ª sp1 å¯¹è±¡å¼•ç”¨ 22 è¡Œ new å‡ºæ¥çš„ A å¯¹è±¡ï¼ˆä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œä¸‹æ–‡ç»Ÿä¸€ç§°ä¹‹ä¸ºèµ„æºå¯¹è±¡ Aï¼‰ï¼Œå› æ­¤ä»£ç  24 è¡Œæ‰“å°å‡ºæ¥çš„å¼•ç”¨è®¡æ•°å€¼ä¸º 1ï¼›\nä»£ç  27 è¡Œï¼Œåˆ©ç”¨ sp1 æ‹·è´ä¸€ä»½ sp2ï¼Œå¯¼è‡´ä»£ç  28 è¡Œæ‰“å°å‡ºæ¥çš„å¼•ç”¨è®¡æ•°ä¸º 2ï¼›\nä»£ç  30 è¡Œè°ƒç”¨ sp2 çš„ reset() æ–¹æ³•ï¼Œsp2 é‡Šæ”¾å¯¹èµ„æºå¯¹è±¡ A çš„å¼•ç”¨ï¼Œå› æ­¤ä»£ç  31 è¡Œæ‰“å°çš„å¼•ç”¨è®¡æ•°å€¼å†æ¬¡å˜ä¸º 1ï¼›\nä»£ç  34 è¡Œ åˆ©ç”¨ sp1 å†æ¬¡ åˆ›å»º sp3ï¼Œå› æ­¤ä»£ç  35 è¡Œæ‰“å°çš„å¼•ç”¨è®¡æ•°å˜ä¸º 2ï¼›\nç¨‹åºæ‰§è¡Œåˆ° 36 è¡Œä»¥åï¼Œsp3 å‡ºäº†å…¶ä½œç”¨åŸŸè¢«ææ„ï¼Œèµ„æº A çš„å¼•ç”¨è®¡æ•°é€’å‡ 1ï¼Œå› æ­¤ ä»£ç  38 è¡Œæ‰“å°çš„å¼•ç”¨è®¡æ•°ä¸º 1ï¼›\nç¨‹åºæ‰§è¡Œåˆ° 39 è¡Œä»¥åï¼Œsp1 å‡ºäº†å…¶ä½œç”¨åŸŸè¢«ææ„ï¼Œåœ¨å…¶ææ„æ—¶é€’å‡èµ„æº A çš„å¼•ç”¨è®¡æ•°è‡³ 0ï¼Œå¹¶ææ„èµ„æº A å¯¹è±¡ï¼Œå› æ­¤ç±» A çš„ææ„å‡½æ•°è¢«è°ƒç”¨ã€‚\n\næ‰€ä»¥æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\n12345678[root@myaliyun testmybook]# ./test_shared_ptr_use_count A constructoruse count: 1use count: 2use count: 1use count: 2use count: 1A destructor\n\nstd::enable_shared_from_this\nå®é™…å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™éœ€è¦åœ¨ç±»ä¸­è¿”å›åŒ…è£¹å½“å‰å¯¹è±¡ï¼ˆthisï¼‰çš„ä¸€ä¸ª std::shared_ptr å¯¹è±¡ç»™å¤–éƒ¨ä½¿ç”¨ï¼ŒC++ æ–°æ ‡å‡†ä¹Ÿä¸ºæˆ‘ä»¬è€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼Œæœ‰å¦‚æ­¤éœ€æ±‚çš„ç±»åªè¦ç»§æ‰¿è‡ª std::enable_shared_from_this æ¨¡æ¿å¯¹è±¡å³å¯ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132#include &lt;iostream&gt;#include &lt;memory&gt;class A : public std::enable_shared_from_this&lt;A&gt;&#123;public:    A()    &#123;        std::cout &lt;&lt; &quot;A constructor&quot; &lt;&lt; std::endl;    &#125;    ~A()    &#123;        std::cout &lt;&lt; &quot;A destructor&quot; &lt;&lt; std::endl;    &#125;    std::shared_ptr&lt;A&gt; getSelf()    &#123;        return shared_from_this();    &#125;&#125;;int main()&#123;    std::shared_ptr&lt;A&gt; sp1(new A());    std::shared_ptr&lt;A&gt; sp2 = sp1-&gt;getSelf();    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    return 0;&#125;\n\nä¸Šè¿°ä»£ç ä¸­ï¼Œç±» A çš„ç»§æ‰¿ std::enable_shared_from_this å¹¶æä¾›ä¸€ä¸ª getSelf() æ–¹æ³•è¿”å›è‡ªèº«çš„ std::shared_ptr å¯¹è±¡ï¼Œåœ¨ getSelf() ä¸­è°ƒç”¨ shared_from_this() å³å¯ã€‚\nstd::enable_shared_from_this ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨å¾ˆå¤šä¸æ˜“å¯Ÿè§‰çš„é™·é˜±ã€‚\né™·é˜±ä¸€ï¼šä¸åº”è¯¥å…±äº«æ ˆå¯¹è±¡çš„ this ç»™æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡\nå‡è®¾æˆ‘ä»¬å°†ä¸Šé¢ä»£ç  main å‡½æ•° 25 è¡Œç”Ÿæˆ A å¯¹è±¡çš„æ–¹å¼æ”¹æˆä¸€ä¸ªæ ˆå˜é‡ï¼Œå³ï¼š\n123456789101112//å…¶ä»–ç›¸åŒä»£ç çœç•¥...int main()&#123;    A a;    std::shared_ptr&lt;A&gt; sp2 = a.getSelf();    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp2.use_count() &lt;&lt; std::endl;    return 0;&#125;\n\nè¿è¡Œä¿®æ”¹åçš„ä»£ç ä¼šå‘ç°ç¨‹åºåœ¨ std::shared_ptr sp2 = a.getSelf(); äº§ç”Ÿå´©æºƒã€‚è¿™æ˜¯å› ä¸ºï¼Œæ™ºèƒ½æŒ‡é’ˆç®¡ç†çš„æ˜¯å †å¯¹è±¡ï¼Œæ ˆå¯¹è±¡ä¼šåœ¨å‡½æ•°è°ƒç”¨ç»“æŸåè‡ªè¡Œé”€æ¯ï¼Œå› æ­¤ä¸èƒ½é€šè¿‡ shared_from_this() å°†è¯¥å¯¹è±¡äº¤ç”±æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ç®¡ç†ã€‚åˆ‡è®°ï¼šæ™ºèƒ½æŒ‡é’ˆæœ€åˆè®¾è®¡çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç®¡ç†å †å¯¹è±¡çš„ï¼ˆå³é‚£äº›ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾çš„èµ„æºï¼‰ã€‚\né™·é˜±äºŒï¼šé¿å… std::enable_shared_from_this çš„å¾ªç¯å¼•ç”¨é—®é¢˜\nå†æ¥çœ‹å¦å¤–ä¸€æ®µä»£ç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445// test_std_enable_shared_from_this.cpp : This file contains the &#x27;main&#x27; function. Program execution begins and ends there.//#include &lt;iostream&gt;#include &lt;memory&gt;class A : public std::enable_shared_from_this&lt;A&gt;&#123;public:    A()    &#123;        m_i = 9;        //æ³¨æ„:        //æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯åœ¨æ„é€ å‡½æ•°é‡Œé¢è°ƒç”¨shared_from_this()ç»™m_SelfPtrèµ‹å€¼        //ä½†æ˜¯å¾ˆé—æ†¾ä¸èƒ½è¿™ä¹ˆåš,å¦‚æœå†™åœ¨æ„é€ å‡½æ•°é‡Œé¢ç¨‹åºä¼šç›´æ¥å´©æºƒ        std::cout &lt;&lt; &quot;A constructor&quot; &lt;&lt; std::endl;    &#125;    ~A()    &#123;        m_i = 0;        std::cout &lt;&lt; &quot;A destructor&quot; &lt;&lt; std::endl;    &#125;    void func()    &#123;        m_SelfPtr = shared_from_this();    &#125;public:    int                 m_i;    std::shared_ptr&lt;A&gt;  m_SelfPtr;&#125;;int main()&#123;    &#123;        std::shared_ptr&lt;A&gt; spa(new A());        spa-&gt;func();    &#125;    return 0;&#125;\n\nä¹ä¸€çœ‹ä¸Šé¢çš„ä»£ç å¥½åƒçœ‹ä¸å‡ºä»€ä¹ˆé—®é¢˜ï¼Œè®©æˆ‘ä»¬æ¥å®é™…è¿è¡Œä¸€ä¸‹çœ‹çœ‹è¾“å‡ºç»“æœï¼š\n123[root@myaliyun testmybook]# g++ -g -o test_std_enable_shared_from_this_problem test_std_enable_shared_from_this_problem.cpp[root@myaliyun testmybook]# ./test_std_enable_shared_from_this_problemA constructor\n\næˆ‘ä»¬å‘ç°åœ¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ï¼Œåªæœ‰ A ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨è¾“å‡ºï¼Œæ²¡æœ‰ A ç±»ææ„å‡½æ•°çš„è°ƒç”¨è¾“å‡ºï¼Œè¿™æ„å‘³ç€ new å‡ºæ¥çš„ A å¯¹è±¡äº§ç”Ÿäº†å†…å­˜æ³„æ¼äº†ï¼\næˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆ new å‡ºæ¥çš„ A å¯¹è±¡å¾—ä¸åˆ°é‡Šæ”¾ã€‚å½“ç¨‹åºæ‰§è¡Œåˆ° 42 è¡Œåï¼Œspa å‡ºäº†å…¶ä½œç”¨åŸŸå‡†å¤‡ææ„ï¼Œåœ¨ææ„æ—¶å…¶å‘ç°ä»ç„¶æœ‰å¦å¤–çš„ä¸€ä¸ª std::shared_ptr å¯¹è±¡å³ A::m_SelfPtr å¼•ç”¨äº† Aï¼Œå› æ­¤ spa åªä¼šå°† A çš„å¼•ç”¨è®¡æ•°é€’å‡ä¸º 1ï¼Œç„¶åå°±é”€æ¯è‡ªèº«äº†ã€‚ç°åœ¨ç•™ä¸‹ä¸€ä¸ªçŸ›ç›¾çš„å¤„å¢ƒï¼šå¿…é¡»é”€æ¯ A æ‰èƒ½é”€æ¯å…¶æˆå‘˜å˜é‡ m_SelfPtrï¼Œè€Œé”€æ¯ m_SelfPtr å¿…é¡»å…ˆé”€æ¯ Aã€‚è¿™å°±æ˜¯æ‰€è°“çš„ std::enable_shared_from_this çš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­åº”è¯¥é¿å…åšå‡ºè¿™æ ·çš„é€»è¾‘è®¾è®¡ï¼Œè¿™ç§æƒ…å½¢ä¸‹å³ä½¿ä½¿ç”¨äº†æ™ºèƒ½æŒ‡é’ˆä¹Ÿä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªèµ„æºçš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥äº¤ç»™ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ï¼Œä½†æ˜¯è¯¥æ™ºèƒ½æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸä¸å¯ä»¥å†äº¤ç»™æ•´ä¸ªèµ„æºæ¥ç®¡ç†ã€‚\nstd::weak_ptrstd::weak_ptr æ˜¯ä¸€ä¸ªä¸æ§åˆ¶èµ„æºç”Ÿå‘½å‘¨æœŸçš„æ™ºèƒ½æŒ‡é’ˆï¼Œæ˜¯å¯¹å¯¹è±¡çš„ä¸€ç§å¼±å¼•ç”¨ï¼Œåªæ˜¯æä¾›äº†å¯¹å…¶ç®¡ç†çš„èµ„æºçš„ä¸€ä¸ªè®¿é—®æ‰‹æ®µï¼Œå¼•å…¥å®ƒçš„ç›®çš„ä¸ºååŠ© std::shared_ptr å·¥ä½œã€‚\nstd::weak_ptr å¯ä»¥ä»ä¸€ä¸ª std::shared_ptr æˆ–å¦ä¸€ä¸ª std::weak_ptr å¯¹è±¡æ„é€ ï¼Œstd::shared_ptr å¯ä»¥ç›´æ¥èµ‹å€¼ç»™ std::weak_ptr ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ std::weak_ptr çš„ lock() å‡½æ•°æ¥è·å¾— std::shared_ptrã€‚å®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®¡æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚std::weak_ptr å¯ç”¨æ¥è§£å†³ std::shared_ptr ç›¸äº’å¼•ç”¨æ—¶çš„æ­»é”é—®é¢˜ï¼ˆå³ä¸¤ä¸ªstd::shared_ptr ç›¸äº’å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸‹é™ä¸º 0ï¼Œ èµ„æºæ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼‰ã€‚\nç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223#include &lt;iostream&gt;#include &lt;memory&gt;int main()&#123;    //åˆ›å»ºä¸€ä¸ªstd::shared_ptrå¯¹è±¡    std::shared_ptr&lt;int&gt; sp1(new int(123));    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    //é€šè¿‡æ„é€ å‡½æ•°å¾—åˆ°ä¸€ä¸ªstd::weak_ptrå¯¹è±¡    std::weak_ptr&lt;int&gt; sp2(sp1);    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    //é€šè¿‡èµ‹å€¼è¿ç®—ç¬¦å¾—åˆ°ä¸€ä¸ªstd::weak_ptrå¯¹è±¡    std::weak_ptr&lt;int&gt; sp3 = sp1;    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    //é€šè¿‡ä¸€ä¸ªstd::weak_ptrå¯¹è±¡å¾—åˆ°å¦å¤–ä¸€ä¸ªstd::weak_ptrå¯¹è±¡    std::weak_ptr&lt;int&gt; sp4 = sp2;    std::cout &lt;&lt; &quot;use count: &quot; &lt;&lt; sp1.use_count() &lt;&lt; std::endl;    return 0;&#125;\n\nç¨‹åºæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\n123456[root@myaliyun testmybook]# g++ -g -o test_weak_ptr test_weak_ptr.cpp [root@myaliyun testmybook]# ./test_weak_ptruse count: 1use count: 1use count: 1use count: 1\n\næ— è®ºé€šè¿‡ä½•ç§æ–¹å¼åˆ›å»º std::weak_ptr éƒ½ä¸ä¼šå¢åŠ èµ„æºçš„å¼•ç”¨è®¡æ•°ï¼Œå› æ­¤æ¯æ¬¡è¾“å‡ºå¼•ç”¨è®¡æ•°çš„å€¼éƒ½æ˜¯ 1ã€‚\næ—¢ç„¶ï¼Œstd::weak_ptr ä¸ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¹ˆå…¶å¼•ç”¨çš„å¯¹è±¡å¯èƒ½åœ¨æŸä¸ªæ—¶åˆ»è¢«é”€æ¯äº†ï¼Œå¦‚ä½•å¾—çŸ¥å‘¢ï¼Ÿstd::weak_ptr æä¾›äº†ä¸€ä¸ª expired() æ–¹æ³•æ¥åšè¿™ä¸€é¡¹æ£€æµ‹ï¼Œè¿”å› trueï¼Œè¯´æ˜å…¶å¼•ç”¨çš„èµ„æºå·²ç»ä¸å­˜åœ¨äº†ï¼›è¿”å› falseï¼Œè¯´æ˜è¯¥èµ„æºä»ç„¶å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ std::weak_ptr çš„ lock() æ–¹æ³•å¾—åˆ°ä¸€ä¸ª std::shared_ptr å¯¹è±¡ç„¶åç»§ç»­æ“ä½œèµ„æºï¼Œä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†è¯¥ç”¨æ³•ï¼š\n12345678910//tmpConn_ æ˜¯ä¸€ä¸ª std::weak_ptr&lt;TcpConnection&gt; å¯¹è±¡//tmpConn_å¼•ç”¨çš„TcpConnectionå·²ç»é”€æ¯ï¼Œç›´æ¥è¿”å›if (tmpConn_.expired())    return;std::shared_ptr&lt;TcpConnection&gt; conn = tmpConn_.lock();if (conn)&#123;    //å¯¹connè¿›è¡Œæ“ä½œï¼Œçœç•¥...&#125;\n\næœ‰è¯»è€…å¯èƒ½å¯¹ä¸Šè¿°ä»£ç äº§ç”Ÿç–‘é—®ï¼Œæ—¢ç„¶ä½¿ç”¨äº† std::weak_ptr çš„ expired() æ–¹æ³•åˆ¤æ–­äº†å¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ std::weak_ptr å¯¹è±¡å¯¹å¼•ç”¨èµ„æºè¿›è¡Œæ“ä½œå‘¢ï¼Ÿå®é™…ä¸Šè¿™æ˜¯è¡Œä¸é€šçš„ï¼Œstd::weak_ptr ç±»æ²¡æœ‰é‡å†™ operator-&gt; å’Œ operator* æ–¹æ³•ï¼Œå› æ­¤ä¸èƒ½åƒ std::shared_ptr æˆ– std::unique_ptr ä¸€æ ·ç›´æ¥æ“ä½œå¯¹è±¡ï¼ŒåŒæ—¶ std::weak_ptr ç±»ä¹Ÿæ²¡æœ‰é‡å†™ operator! æ“ä½œï¼Œå› æ­¤ä¹Ÿä¸èƒ½é€šè¿‡ std::weak_ptr å¯¹è±¡ç›´æ¥åˆ¤æ–­å…¶å¼•ç”¨çš„èµ„æºæ˜¯å¦å­˜åœ¨ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#include &lt;memory&gt;class A&#123;public:    void doSomething()    &#123;    &#125;&#125;;int main()&#123;        std::shared_ptr&lt;A&gt; sp1(new A());    std::weak_ptr&lt;A&gt; sp2(sp1);    //æ­£ç¡®ä»£ç     if (sp1)    &#123;        //æ­£ç¡®ä»£ç         sp1-&gt;doSomething();        (*sp1).doSomething();    &#125;    //æ­£ç¡®ä»£ç     if (!sp1)    &#123;    &#125;    //é”™è¯¯ä»£ç ï¼Œæ— æ³•ç¼–è¯‘é€šè¿‡    //if (sp2)    //&#123;    //    //é”™è¯¯ä»£ç ï¼Œæ— æ³•ç¼–è¯‘é€šè¿‡    //    sp2-&gt;doSomething();    //    (*sp2).doSomething();    //&#125;    //é”™è¯¯ä»£ç ï¼Œæ— æ³•ç¼–è¯‘é€šè¿‡    //if (!sp2)    //&#123;    //&#125;    return 0;&#125;\n\nä¹‹æ‰€ä»¥ std::weak_ptr ä¸å¢åŠ å¼•ç”¨èµ„æºçš„å¼•ç”¨è®¡æ•°ä¸ç®¡ç†èµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ˜¯å› ä¸ºï¼Œå³ä½¿å®ƒå®ç°äº†ä»¥ä¸Šè¯´çš„å‡ ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨å®ƒä»¬ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨è°ƒç”¨æœŸé—´ï¼Œå¼•ç”¨çš„èµ„æºå¯èƒ½æ°å¥½è¢«é”€æ¯äº†ï¼Œè¿™ä¼šé€ æˆæ£˜æ‰‹çš„é”™è¯¯å’Œéº»çƒ¦ã€‚\nå› æ­¤ï¼Œstd::weak_ptr çš„æ­£ç¡®ä½¿ç”¨åœºæ™¯æ˜¯é‚£äº›èµ„æºå¦‚æœå¯èƒ½å°±ä½¿ç”¨ï¼Œå¦‚æœä¸å¯ä½¿ç”¨åˆ™ä¸ç”¨çš„åœºæ™¯ï¼Œå®ƒä¸å‚ä¸èµ„æºçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ä¾‹å¦‚ï¼Œç½‘ç»œåˆ†å±‚ç»“æ„ä¸­ï¼ŒSession å¯¹è±¡ï¼ˆä¼šè¯å¯¹è±¡ï¼‰åˆ©ç”¨ Connection å¯¹è±¡ï¼ˆè¿æ¥å¯¹è±¡ï¼‰æä¾›çš„æœåŠ¡å·¥ä½œï¼Œä½†æ˜¯ Session å¯¹è±¡ä¸ç®¡ç† Connection å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ŒSession ç®¡ç† Connection çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºç½‘ç»œåº•å±‚å‡ºé”™ä¼šå¯¼è‡´ Connection å¯¹è±¡è¢«é”€æ¯ï¼Œæ­¤æ—¶ Session å¯¹è±¡å¦‚æœå¼ºè¡ŒæŒæœ‰ Connection å¯¹è±¡ä¸äº‹å®çŸ›ç›¾ã€‚\nstd::weak_ptr çš„åº”ç”¨åœºæ™¯ï¼Œç»å…¸çš„ä¾‹å­æ˜¯è®¢é˜…è€…æ¨¡å¼æˆ–è€…è§‚å¯Ÿè€…æ¨¡å¼ä¸­ã€‚è¿™é‡Œä»¥è®¢é˜…è€…ä¸ºä¾‹æ¥è¯´æ˜ï¼Œæ¶ˆæ¯å‘å¸ƒå™¨åªæœ‰åœ¨æŸä¸ªè®¢é˜…è€…å­˜åœ¨çš„æƒ…å†µä¸‹æ‰ä¼šå‘å…¶å‘å¸ƒæ¶ˆæ¯ï¼Œè€Œä¸èƒ½ç®¡ç†è®¢é˜…è€…çš„ç”Ÿå‘½å‘¨æœŸã€‚\n12345678910111213141516171819202122class Subscriber&#123;&#125;;class SubscribeManager&#123;public:    void publish()    &#123;        for (const auto&amp; iter : m_subscribers)        &#123;            if (!iter.expired())            &#123;                //TODOï¼šç»™è®¢é˜…è€…å‘é€æ¶ˆæ¯            &#125;        &#125;    &#125;private:    std::vector&lt;std::weak_ptr&lt;Subscriber&gt;&gt;   m_subscribers;&#125;;\n\næ™ºèƒ½æŒ‡é’ˆå¯¹è±¡çš„å¤§å°ä¸€ä¸ª std::unique_ptr å¯¹è±¡å¤§å°ä¸è£¸æŒ‡é’ˆå¤§å°ç›¸åŒï¼ˆå³ sizeof(std::unique_ptr) &#x3D;&#x3D; sizeof(void*)ï¼‰ï¼Œè€Œ std::shared_ptr çš„å¤§å°æ˜¯ std::unique_ptr çš„ä¸€å€ã€‚ä»¥ä¸‹æ˜¯æˆ‘åˆ†åˆ«åœ¨ Visual Studio 2019 å’Œ gcc&#x2F;g++ 4.8 ä¸Šï¼ˆäºŒè€…éƒ½ç¼–è¯‘æˆ x64 ç¨‹åºï¼‰çš„æµ‹è¯•ç»“æœï¼š\næµ‹è¯•ä»£ç \n12345678910111213141516171819#include &lt;iostream&gt;#include &lt;memory&gt;#include &lt;string&gt;int main()&#123;    std::shared_ptr&lt;int&gt; sp0;    std::shared_ptr&lt;std::string&gt; sp1;    sp1.reset(new std::string());    std::unique_ptr&lt;int&gt; sp2;    std::weak_ptr&lt;int&gt; sp3;    std::cout &lt;&lt; &quot;sp0 size: &quot; &lt;&lt; sizeof(sp0) &lt;&lt; std::endl;    std::cout &lt;&lt; &quot;sp1 size: &quot; &lt;&lt; sizeof(sp1) &lt;&lt; std::endl;    std::cout &lt;&lt; &quot;sp2 size: &quot; &lt;&lt; sizeof(sp2) &lt;&lt; std::endl;    std::cout &lt;&lt; &quot;sp3 size: &quot; &lt;&lt; sizeof(sp3) &lt;&lt; std::endl;    return 0;&#125;\n\nVisual Studio 2019 è¿è¡Œç»“æœï¼š\n\ngcc&#x2F;g++ è¿è¡Œç»“æœï¼š\n\nåœ¨ 32 ä½æœºå™¨ä¸Šï¼Œstd_unique_ptr å  4 å­—èŠ‚ï¼Œstd::shared_ptr å’Œ std::weak_ptr å  8 å­—èŠ‚ï¼›åœ¨ 64 ä½æœºå™¨ä¸Šï¼Œstd_unique_ptr å  8 å­—èŠ‚ï¼Œstd::shared_ptr å’Œ std::weak_ptr å  16 å­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œstd_unique_ptr çš„å¤§å°æ€»æ˜¯å’ŒåŸå§‹æŒ‡é’ˆå¤§å°ä¸€æ ·ï¼Œstd::shared_ptr å’Œ std::weak_ptr å¤§å°æ˜¯åŸå§‹æŒ‡é’ˆçš„ä¸€å€ã€‚\næ™ºèƒ½æŒ‡é’ˆä½¿ç”¨æ³¨æ„äº‹é¡¹C++ æ–°æ ‡å‡†æå€¡çš„ç†å¿µä¹‹ä¸€æ˜¯ä¸åº”è¯¥å†æ‰‹åŠ¨è°ƒç”¨ delete æˆ–è€… free å‡½æ•°å»é‡Šæ”¾å†…å­˜äº†ï¼Œè€Œåº”è¯¥æŠŠå®ƒä»¬äº¤ç»™æ–°æ ‡å‡†æä¾›çš„å„ç§æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ã€‚C++ æ–°æ ‡å‡†ä¸­çš„å„ç§æ™ºèƒ½æŒ‡é’ˆæ˜¯å¦‚æ­¤çš„å®ç”¨ä¸å¼ºå¤§ï¼Œåœ¨ç°ä»£ C++ é¡¹ç›®å¼€å‘ä¸­ï¼Œè¯»è€…åº”è¯¥å°½é‡å»ä½¿ç”¨å®ƒä»¬ã€‚æ™ºèƒ½æŒ‡é’ˆè™½ç„¶å¥½ç”¨ï¼Œä½†ç¨ä¸æ³¨æ„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨è®¸å¤šéš¾ä»¥å‘ç°çš„ bugï¼Œè¿™é‡Œæˆ‘æ ¹æ®ç»éªŒæ€»ç»“äº†å‡ æ¡ï¼š\n\nä¸€æ—¦ä¸€ä¸ªå¯¹è±¡ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆç®¡ç†åï¼Œå°±ä¸è¯¥å†ä½¿ç”¨åŸå§‹è£¸æŒ‡é’ˆå»æ“ä½œï¼›\nçœ‹ä¸€æ®µä»£ç ï¼š\n1234567891011121314151617#include &lt;memory&gt;class Subscriber&#123;&#125;;int main()&#123;      Subscriber* pSubscriber = new Subscriber();  std::unique_ptr&lt;Subscriber&gt; spSubscriber(pSubscriber);  delete pSubscriber;  return 0;&#125;\n\nè¿™æ®µä»£ç åˆ©ç”¨åˆ›å»ºäº†ä¸€ä¸ªå †å¯¹è±¡ Subscriberï¼Œç„¶ååˆ©ç”¨æ™ºèƒ½æŒ‡é’ˆ spSubscriber å»ç®¡ç†ä¹‹ï¼Œå¯ä»¥å´ç§ä¸‹åˆ©ç”¨åŸå§‹æŒ‡é’ˆé”€æ¯äº†è¯¥å¯¹è±¡ï¼Œè¿™è®©æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ spSubscriber æƒ…ä½•ä»¥å ªå•Šï¼Ÿ\nè®°ä½ï¼Œä¸€æ—¦æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æ¥ç®¡äº†ä½ çš„èµ„æºï¼Œæ‰€æœ‰å¯¹èµ„æºçš„æ“ä½œéƒ½åº”è¯¥é€šè¿‡æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡è¿›è¡Œï¼Œä¸å»ºè®®å†é€šè¿‡åŸå§‹æŒ‡é’ˆè¿›è¡Œæ“ä½œäº†ã€‚å½“ç„¶ï¼Œé™¤äº† std::weak_ptrï¼Œstd::unique_ptr å’Œ std::shared_ptr éƒ½æä¾›äº†è·å–åŸå§‹æŒ‡é’ˆçš„æ–¹æ³•â€”â€”get() å‡½æ•°ã€‚\n1234567891011int main()&#123;      Subscriber* pSubscriber = new Subscriber();  std::unique_ptr&lt;Subscriber&gt; spSubscriber(pSubscriber);  //pTheSameSubscriberå’ŒpSubscriberæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡  Subscriber* pTheSameSubscriber= spSubscriber.get();  return 0;&#125;\n\nåˆ†æ¸…æ¥šåœºåˆåº”è¯¥ä½¿ç”¨å“ªç§ç±»å‹çš„æ™ºèƒ½æŒ‡é’ˆï¼›\né€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä½ çš„èµ„æºä¸éœ€è¦åœ¨å…¶ä»–åœ°æ–¹å…±äº«ï¼Œé‚£ä¹ˆåº”è¯¥ä¼˜å…ˆä½¿ç”¨ std::unique_ptrï¼Œåä¹‹ä½¿ç”¨ std::shared_ptrï¼Œå½“ç„¶è¿™æ˜¯åœ¨è¯¥æ™ºèƒ½æŒ‡é’ˆéœ€è¦ç®¡ç†èµ„æºçš„ç”Ÿå‘½å‘¨æœŸçš„æƒ…å†µä¸‹ï¼›å¦‚æœä¸éœ€è¦ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¯·ä½¿ç”¨ std::weak_ptrã€‚\n\nè®¤çœŸè€ƒè™‘ï¼Œé¿å…æ“ä½œæŸä¸ªå¼•ç”¨èµ„æºå·²ç»é‡Šæ”¾çš„æ™ºèƒ½æŒ‡é’ˆï¼›\nå‰é¢çš„ä¾‹å­ï¼Œä¸€å®šè®©ä½ è§‰å¾—éå¸¸å®¹æ˜“çŸ¥é“ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆçš„æŒæœ‰çš„èµ„æºæ˜¯å¦è¿˜æœ‰æ•ˆï¼Œä½†æ˜¯è¿˜æ˜¯å»ºè®®åœ¨ä¸åŒåœºæ™¯è°¨æ…ä¸€ç‚¹ï¼Œæœ‰äº›åœºæ™¯æ˜¯å¾ˆå®¹æ˜“é€ æˆè¯¯åˆ¤ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š\n123456789101112131415161718192021222324252627#include &lt;iostream&gt;#include &lt;memory&gt;class T&#123;public:  void doSomething()  &#123;      std::cout &lt;&lt; &quot;T do something...&quot; &lt;&lt; m_i &lt;&lt; std::endl;  &#125;private:  int     m_i;&#125;;int main()&#123;      std::shared_ptr&lt;T&gt; sp1(new T());  const auto&amp; sp2 = sp1;  sp1.reset();  //ç”±äºsp2å·²ç»ä¸å†æŒæœ‰å¯¹è±¡çš„å¼•ç”¨ï¼Œç¨‹åºä¼šåœ¨è¿™é‡Œå‡ºç°æ„å¤–çš„è¡Œä¸º  sp2-&gt;doSomething();  return 0;&#125;\n\nä¸Šè¿°ä»£ç ä¸­ï¼Œsp2 æ˜¯ sp1 çš„å¼•ç”¨ï¼Œsp1 è¢«ç½®ç©ºåï¼Œsp2 ä¹Ÿä¸€åŒä¸ºç©ºã€‚è¿™æ—¶å€™è°ƒç”¨ sp2-&gt;doSomething()ï¼Œsp2-&gt;ï¼ˆå³ **operator-&gt;**ï¼‰åœ¨å†…éƒ¨ä¼šè°ƒç”¨ get() æ–¹æ³•è·å–åŸå§‹æŒ‡é’ˆå¯¹è±¡ï¼Œè¿™æ—¶ä¼šå¾—åˆ°ä¸€ä¸ªç©ºæŒ‡é’ˆï¼ˆåœ°å€ä¸º 0ï¼‰ï¼Œç»§ç»­è°ƒç”¨ doSomething() å¯¼è‡´ç¨‹åºå´©æºƒã€‚\nä½ ä¸€å®šä»ç„¶è§‰å¾—è¿™ä¸ªä¾‹å­ä¹Ÿèƒ½å¾ˆæ˜æ˜¾åœ°çœ‹å‡ºé—®é¢˜ï¼Œokï¼Œè®©æˆ‘ä»¬æŠŠè¿™ä¸ªä¾‹å­æ”¾åˆ°å®é™…å¼€å‘ä¸­å†æ¥çœ‹ä¸€ä¸‹ï¼š\n12345678910111213141516//è¿æ¥æ–­å¼€void MonitorServer::OnClose(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn)&#123;      std::lock_guard&lt;std::mutex&gt; guard(m_sessionMutex);  for (auto iter = m_sessions.begin(); iter != m_sessions.end(); ++iter)  &#123;      //é€šè¿‡æ¯”å¯¹connectionå¯¹è±¡æ‰¾åˆ°å¯¹åº”çš„session      if ((*iter)-&gt;GetConnectionPtr() == conn)      &#123;          m_sessions.erase(iter);          //æ³¨æ„è¿™é‡Œï¼šç¨‹åºåœ¨æ­¤å¤„å´©æºƒ          LOGI(&quot;monitor client disconnected: %s&quot;, conn-&gt;peerAddress().toIpPort().c_str());          break;      &#125;  &#125;&#125;\n\nè¿™æ®µä»£ç ä¸æ˜¯æˆ‘æœæ’°çš„ï¼Œè€Œæ˜¯æ¥è‡ªäºæˆ‘å®é™…çš„ä¸€ä¸ªå•†ä¸šé¡¹ç›®ä¸­ã€‚æ³¨æ„ä»£ç ä¸­æˆ‘æé†’æ³¨æ„çš„åœ°æ–¹ï¼Œè¯¥æ®µç¨‹åºä¼šåœ¨ä»£ç  12 è¡Œå¤„å´©æºƒï¼Œå´©æºƒåŸå› æ˜¯è°ƒç”¨äº† conn-&gt;peerAddress() æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨å¯èƒ½ä¼šå¼•èµ·å´©æºƒï¼Ÿç°åœ¨å¯ä»¥ä¸€ç›®äº†ç„¶åœ°çœ‹å‡ºäº†å—ï¼Ÿ\nå´©æºƒåŸå› æ˜¯ä¼ å…¥çš„ conn å¯¹è±¡å’Œä¸Šä¸€ä¸ªä¾‹å­ä¸­çš„ sp2 ä¸€æ ·éƒ½æ˜¯å¦å¤–ä¸€ä¸ª std::shared_ptr çš„å¼•ç”¨ï¼Œå½“è¿æ¥æ–­å¼€æ—¶ï¼Œå¯¹åº”çš„ TcpConnection å¯¹è±¡å¯èƒ½æ—©å·²è¢«é”€æ¯ï¼Œè€Œ conn å¼•ç”¨å°±ä¼šå˜æˆç©ºæŒ‡é’ˆï¼ˆä¸¥æ ¼æ¥è¯´æ˜¯ä¸å†æ‹¥æœ‰ä¸€ä¸ª TcpConnection å¯¹è±¡ï¼‰ï¼Œæ­¤æ—¶è°ƒç”¨ TcpConnection çš„ peerAddress() æ–¹æ³•å°±ä¼šäº§ç”Ÿå’Œä¸Šä¸€ä¸ªç¤ºä¾‹ä¸€æ ·çš„é”™è¯¯ã€‚\n\nä½œä¸ºç±»æˆå‘˜å˜é‡æ—¶ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨å‰ç½®å£°æ˜ï¼ˆforward declarationsï¼‰\næˆ‘ä»¬çŸ¥é“ï¼Œä¸ºäº†å‡å°ç¼–è¯‘ä¾èµ–åŠ å¿«ç¼–è¯‘é€Ÿåº¦å’Œç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°ï¼ŒC&#x2F;C++ é¡¹ç›®ä¸­ä¸€èˆ¬åœ¨ *.h æ–‡ä»¶å¯¹äºæŒ‡é’ˆç±»å‹å°½é‡ä½¿ç”¨å‰ç½®å£°æ˜ï¼Œè€Œä¸æ˜¯ç›´æ¥åŒ…å«å¯¹åº”ç±»çš„å¤´æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š\n12345678910111213//Test.h//åœ¨è¿™é‡Œä½¿ç”¨Açš„å‰ç½®å£°æ˜ï¼Œè€Œä¸æ˜¯ç›´æ¥åŒ…å«A.hæ–‡ä»¶class A;class Test&#123;public:  Test();  ~Test();private:  A*      m_pA;&#125;;\n\nåŒæ ·çš„é“ç†ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­å½“ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ä½œä¸ºç±»æˆå‘˜å˜é‡æ—¶ï¼Œä¹Ÿåº”è¯¥ä¼˜å…ˆä½¿ç”¨å‰ç½®å£°æ˜å»å¼•ç”¨æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡çš„åŒ…è£¹ç±»ï¼Œè€Œä¸æ˜¯ç›´æ¥åŒ…å«åŒ…è£¹ç±»çš„å¤´æ–‡ä»¶ã€‚\n123456789101112131415//Test.h#include &lt;memory&gt;//æ™ºèƒ½æŒ‡é’ˆåŒ…è£¹ç±»Aï¼Œè¿™é‡Œä¼˜å…ˆä½¿ç”¨Açš„å‰ç½®å£°æ˜ï¼Œè€Œä¸æ˜¯ç›´æ¥åŒ…å«A.hclass A;class Test&#123;public:  Test();  ~Test();private:    std::unique_ptr&lt;A&gt;  m_spA;&#125;;\n\nC++ æ–°æ ‡å‡†ä¸­çš„æ™ºèƒ½æŒ‡é’ˆæˆ‘æƒ³ä»‹ç»çš„å°±è¿™ä¹ˆå¤šäº†ï¼ŒModern C&#x2F;C++ å·²ç»å˜ä¸º C&#x2F;C++ å¼€å‘çš„è¶‹åŠ¿ï¼Œå¸Œæœ›è¯»è€…èƒ½å–„ç”¨å’Œç†Ÿç»ƒä½¿ç”¨æœ¬èŠ‚ä»‹ç»çš„åä¸‰ç§æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡ã€‚\n","slug":"è½¬è½½/cpp/è¯¦è§£C++11ä¸­çš„æ™ºèƒ½æŒ‡é’ˆ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"8ecb216f8fd8194ddd13637de67a4f14","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ01","content":"libeventæºç æ·±åº¦å‰–æä¸€1. å‰è¨€libeventæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¼€æºé«˜æ€§èƒ½ç½‘ç»œåº“ï¼Œä½¿ç”¨è€…ä¼—å¤šï¼Œç ”ç©¶è€…æ›´ç”šï¼Œç›¸å…³æ–‡ç« ä¹Ÿä¸å°‘ã€‚å†™è¿™ä¸€ç³»åˆ—æ–‡ç« çš„ç”¨æ„åœ¨äºï¼Œä¸€åˆ™åˆ†äº«å¿ƒå¾—ï¼›äºŒåˆ™å¯¹libeventä»£ç å’Œè®¾è®¡æ€æƒ³åšç³»ç»Ÿçš„ã€æ›´æ·±å±‚æ¬¡çš„åˆ†æï¼Œå†™å‡ºæ¥ï¼Œä¹Ÿå¯ä¾›åæ¥è€…å‚è€ƒã€‚\né™„å¸¦ä¸€å¥ï¼šlibeventæ˜¯ç”¨cè¯­è¨€ç¼–å†™çš„ï¼ˆå¤§ç‰›ä»¬éƒ½åçˆ±cè¯­è¨€å“ªï¼‰ï¼Œè€Œä¸”å‡ ä¹æ˜¯æ— å¤„ä¸å‡½æ•°æŒ‡é’ˆï¼Œå­¦ä¹ å…¶æºä»£ç ä¹Ÿéœ€è¦ç›¸å½“çš„cè¯­è¨€åŸºç¡€ã€‚\n2. Libeventç®€ä»‹ä¸Šæ¥å½“ç„¶è¦å…ˆå¤¸å¥–å•¦ï¼Œlibevent æœ‰å‡ ä¸ªæ˜¾è‘—çš„äº®ç‚¹ï¼šäº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œé«˜æ€§èƒ½;è½»é‡çº§ï¼Œä¸“æ³¨äºç½‘ç»œï¼Œä¸å¦‚ACEé‚£ä¹ˆè‡ƒè‚¿åºå¤§ï¼›æºä»£ç ç›¸å½“ç²¾ç‚¼ã€æ˜“è¯»ï¼›è·¨å¹³å°ï¼Œæ”¯æŒWindowsã€Linuxã€BSDå’ŒMac Osï¼›æ”¯æŒå¤šç§I&#x2F;Oå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œ epollã€pollã€dev&#x2F;pollã€selectå’Œkqueueç­‰ï¼›æ”¯æŒI&#x2F;Oï¼Œå®šæ—¶å™¨å’Œä¿¡å·ç­‰äº‹ä»¶ï¼›æ³¨å†Œäº‹ä»¶ä¼˜å…ˆçº§ï¼›\nlibeventå·²ç»è¢«å¹¿æ³›çš„åº”ç”¨ï¼Œä½œä¸ºåº•å±‚çš„ç½‘ç»œåº“ï¼›æ¯”å¦‚memcachedã€Vomitã€Nylonã€Netchatç­‰ç­‰ã€‚libeventå½“å‰çš„æœ€æ–°ç¨³å®šç‰ˆæ˜¯1.4.13ï¼›è¿™ä¹Ÿæ˜¯æœ¬æ–‡å‚ç…§çš„ç‰ˆæœ¬ã€‚\n3. å­¦ä¹ çš„å¥½å¤„å­¦ä¹ libeventæœ‰åŠ©äºæå‡ç¨‹åºè®¾è®¡åŠŸåŠ›ï¼Œé™¤äº†ç½‘ç»œç¨‹åºè®¾è®¡æ–¹é¢å¤–ï¼Œlibeventçš„ä»£ç é‡Œæœ‰å¾ˆå¤šæœ‰ç”¨çš„è®¾è®¡æŠ€å·§å’ŒåŸºç¡€æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚ä¿¡æ¯éšè—ã€å‡½æ•°æŒ‡é’ˆã€cè¯­è¨€çš„å¤šæ€æ”¯æŒã€é“¾è¡¨å’Œå †ç­‰ç­‰ï¼Œéƒ½æœ‰åŠ©äºæå‡è‡ªèº«çš„ç¨‹åºåŠŸåŠ›ã€‚ç¨‹åºè®¾è®¡ä¸æ­¢è¦äº†è§£æ¡†æ¶ï¼Œå¾ˆå¤šç»†èŠ‚ä¹‹å¤„æ°æ°ä¹Ÿæ˜¯äº‹å…³æ•´ä¸ªç³»ç»Ÿæˆè´¥çš„å…³é”®ã€‚åªå¯¹libeventæœ¬èº«çš„æ¡†æ¶å¤§æ¦‚äº†è§£ï¼Œé‚£æˆ–è®¸ä»…ä»…æ˜¯ä¸€çŸ¥åŠè§£ï¼Œä¸æ·±å…¥ä»£ç åˆ†æï¼Œå°±éš¾ä»¥äº†è§£å…¶è®¾è®¡çš„ç²¾å·§ä¹‹å¤„ï¼Œä¹Ÿå°±éš¾ä»¥ä¸ºè‡ªå·±æ‰€ç”¨ã€‚\näº‹å®ä¸Šlibeventæœ¬èº«å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„Reactoræ¨¡å‹ï¼Œç†è§£Reactoræ¨¡å¼æ˜¯ç†è§£libeventçš„åŸºçŸ³ï¼›å› æ­¤ä¸‹ä¸€èŠ‚å°†ä»‹ç»å…¸å‹çš„äº‹ä»¶é©±åŠ¨è®¾è®¡æ¨¡å¼â€”â€”Reactoræ¨¡å¼ã€‚\nå‚è€ƒèµ„æ–™ï¼šlibeventå®˜æ–¹åœ°å€: http://monkey.org/~provos/libevent/\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ01","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"0b2fd1ebe4476d5c0bbc97c748eb6d3b","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ02","content":"libeventæºç æ·±åº¦å‰–æ02Reactoræ¨¡å¼\nå‰é¢è®²åˆ°ï¼Œæ•´ä¸ªlibeventæœ¬èº«å°±æ˜¯ä¸€ä¸ªReactorï¼Œå› æ­¤æœ¬èŠ‚å°†ä¸“é—¨å¯¹Reactoræ¨¡å¼è¿›è¡Œå¿…è¦çš„ä»‹ç»ï¼Œå¹¶åˆ—å‡ºlibevnetä¸­çš„å‡ ä¸ªé‡è¦ç»„ä»¶å’ŒReactorçš„å¯¹åº”å…³ç³»ï¼Œåœ¨åé¢çš„ç« èŠ‚ä¸­å¯èƒ½è¿˜ä¼šæåˆ°æœ¬èŠ‚ä»‹ç»çš„åŸºæœ¬æ¦‚å¿µã€‚\n1. Reactorçš„äº‹ä»¶å¤„ç†æœºåˆ¶é¦–å…ˆæ¥å›æƒ³ä¸€ä¸‹æ™®é€šå‡½æ•°è°ƒç”¨çš„æœºåˆ¶ï¼šç¨‹åºè°ƒç”¨æŸå‡½æ•°?å‡½æ•°æ‰§è¡Œï¼Œç¨‹åºç­‰å¾…?å‡½æ•°å°†ç»“æœå’Œæ§åˆ¶æƒè¿”å›ç»™ç¨‹åº?ç¨‹åºç»§ç»­å¤„ç†ã€‚\nReactoré‡Šä¹‰â€œååº”å †â€ï¼Œæ˜¯ä¸€ç§äº‹ä»¶é©±åŠ¨æœºåˆ¶ã€‚å’Œæ™®é€šå‡½æ•°è°ƒç”¨çš„ä¸åŒä¹‹å¤„åœ¨äºï¼šåº”ç”¨ç¨‹åºä¸æ˜¯ä¸»åŠ¨çš„è°ƒç”¨æŸä¸ªAPIå®Œæˆå¤„ç†ï¼Œè€Œæ˜¯æ°æ°ç›¸åï¼ŒReactoré€†ç½®äº†äº‹ä»¶å¤„ç†æµç¨‹ï¼Œåº”ç”¨ç¨‹åºéœ€è¦æä¾›ç›¸åº”çš„æ¥å£å¹¶æ³¨å†Œåˆ°Reactorä¸Šï¼Œå¦‚æœç›¸åº”çš„æ—¶é—´å‘ç”Ÿï¼ŒReactorå°†ä¸»åŠ¨è°ƒç”¨åº”ç”¨ç¨‹åºæ³¨å†Œçš„æ¥å£ï¼Œè¿™äº›æ¥å£åˆç§°ä¸ºâ€œå›è°ƒå‡½æ•°â€ã€‚ä½¿ç”¨libeventä¹Ÿæ˜¯æƒ³libeventæ¡†æ¶æ³¨å†Œç›¸åº”çš„äº‹ä»¶å’Œå›è°ƒå‡½æ•°ï¼›å½“è¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œlibeventä¼šè°ƒç”¨è¿™äº›å›è°ƒå‡½æ•°å¤„ç†ç›¸åº”çš„äº‹ä»¶ï¼ˆI&#x2F;Oè¯»å†™ã€å®šæ—¶å’Œä¿¡å·ï¼‰ã€‚\nç”¨â€œå¥½è±ååŸåˆ™â€æ¥å½¢å®¹Reactorå†åˆé€‚ä¸è¿‡äº†ï¼šä¸è¦æ‰“ç”µè¯ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šæ‰“ç”µè¯é€šçŸ¥ä½ ã€‚\nä¸¾ä¸ªä¾‹å­ï¼šä½ å»åº”è˜æŸxxå…¬å¸ï¼Œé¢è¯•ç»“æŸåã€‚\nâ€œæ™®é€šå‡½æ•°è°ƒç”¨æœºåˆ¶â€å…¬å¸HRæ¯”è¾ƒæ‡’ï¼Œä¸ä¼šè®°ä½ çš„è”ç³»æ–¹å¼ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Œä½ åªèƒ½é¢è¯•å®Œåè‡ªå·±æ‰“ç”µè¯å»é—®ç»“æœï¼›æœ‰æ²¡æœ‰è¢«å½•å–å•Šï¼Œè¿˜æ˜¯è¢«æ®äº†ï¼›\nâ€œReactorâ€å…¬å¸HRå°±è®°ä¸‹äº†ä½ çš„è”ç³»æ–¹å¼ï¼Œç»“æœå‡ºæ¥åä¼šä¸»åŠ¨æ‰“ç”µè¯é€šçŸ¥ä½ ï¼šæœ‰æ²¡æœ‰è¢«å½•å–å•Šï¼Œè¿˜æ˜¯è¢«æ®äº†ï¼›ä½ ä¸ç”¨è‡ªå·±æ‰“ç”µè¯å»é—®ç»“æœï¼Œäº‹å®ä¸Šä¹Ÿä¸èƒ½ï¼Œä½ æ²¡æœ‰HRçš„ç•™è”ç³»æ–¹å¼ã€‚\n2. Reactoræ¨¡å¼çš„ä¼˜ç‚¹Reactoræ¨¡å¼æ˜¯ç¼–å†™é«˜æ€§èƒ½ç½‘ç»œæœåŠ¡å™¨çš„å¿…å¤‡æŠ€æœ¯ä¹‹ä¸€ï¼Œå®ƒå…·æœ‰å¦‚ä¸‹çš„ä¼˜ç‚¹\n1ï¼‰å“åº”å¿«ï¼Œä¸å¿…ä¸ºå•ä¸ªåŒæ­¥æ—¶é—´æ‰€é˜»å¡ï¼Œè™½ç„¶Reactoræœ¬èº«ä¾ç„¶æ˜¯åŒæ­¥çš„ï¼›\n2ï¼‰ç¼–ç¨‹ç›¸å¯¹ç®€å•ï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„é¿å…å¤æ‚çš„å¤šçº¿ç¨‹åŠåŒæ­¥é—®é¢˜ï¼Œå¹¶ä¸”é¿å…äº†å¤šçº¿ç¨‹&#x2F;è¿›ç¨‹çš„åˆ‡æ¢å¼€é”€ï¼›3ï¼‰å¯æ‰©å±•æ€§ï¼Œå¯ä»¥æ–¹ä¾¿çš„é€šè¿‡å¢åŠ Reactorå®ä¾‹ä¸ªæ•°æ¥å……åˆ†åˆ©ç”¨CPUèµ„æºï¼›4ï¼‰å¯å¤ç”¨æ€§ï¼Œreactoræ¡†æ¶æœ¬èº«ä¸å…·ä½“äº‹ä»¶å¤„ç†é€»è¾‘æ— å…³ï¼Œå…·æœ‰å¾ˆé«˜çš„å¤ç”¨æ€§ï¼›\n3. Reactoræ¨¡å¼æ¡†æ¶ä½¿ç”¨Reactoræ¨¡å‹ï¼Œå¿…å¤‡çš„å‡ ä¸ªç»„ä»¶ï¼šäº‹ä»¶æºã€Reactoræ¡†æ¶ã€å¤šè·¯å¤ç”¨æœºåˆ¶å’Œäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå…ˆæ¥çœ‹çœ‹Reactoræ¨¡å‹çš„æ•´ä½“æ¡†æ¶ï¼Œæ¥ä¸‹æ¥å†å¯¹æ¯ä¸ªç»„ä»¶åšé€ä¸€è¯´æ˜ã€‚\n\n1ï¼‰ äº‹ä»¶æºLinuxä¸Šæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼ŒWindowsä¸Šå°±æ˜¯Socketæˆ–è€…Handleäº†ï¼Œè¿™é‡Œç»Ÿä¸€ç§°ä¸ºâ€œå¥æŸ„é›†â€ï¼›ç¨‹åºåœ¨æŒ‡å®šçš„å¥æŸ„ä¸Šæ³¨å†Œå…³å¿ƒçš„äº‹ä»¶ï¼Œæ¯”å¦‚I&#x2F;Oäº‹ä»¶ã€‚\n2ï¼‰ event demultiplexerâ€”â€”äº‹ä»¶å¤šè·¯åˆ†å‘æœºåˆ¶ç”±æ“ä½œç³»ç»Ÿæä¾›çš„I&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œæ¯”å¦‚selectå’Œepollã€‚ç¨‹åºé¦–å…ˆå°†å…¶å…³å¿ƒçš„å¥æŸ„ï¼ˆäº‹ä»¶æºï¼‰åŠå…¶äº‹ä»¶æ³¨å†Œåˆ°event demultiplexerä¸Šï¼›å½“æœ‰äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œevent demultiplexerä¼šå‘å‡ºé€šçŸ¥â€œåœ¨å·²ç»æ³¨å†Œçš„å¥æŸ„é›†ä¸­ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªå¥æŸ„çš„äº‹ä»¶å·²ç»å°±ç»ªâ€ï¼›ç¨‹åºæ”¶åˆ°é€šçŸ¥åï¼Œå°±å¯ä»¥åœ¨éé˜»å¡çš„æƒ…å†µä¸‹å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†äº†ã€‚å¯¹åº”åˆ°libeventä¸­ï¼Œä¾ç„¶æ˜¯selectã€pollã€epollç­‰ï¼Œä½†æ˜¯libeventä½¿ç”¨ç»“æ„ä½“eventopè¿›è¡Œäº†å°è£…ï¼Œä»¥ç»Ÿä¸€çš„æ¥å£æ¥æ”¯æŒè¿™äº›I&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œè¾¾åˆ°äº†å¯¹å¤–éšè—åº•å±‚ç³»ç»Ÿæœºåˆ¶çš„ç›®çš„ã€‚\n3ï¼‰ Reactorâ€”â€”ååº”å™¨Reactorï¼Œæ˜¯äº‹ä»¶ç®¡ç†çš„æ¥å£ï¼Œå†…éƒ¨ä½¿ç”¨event demultiplexeræ³¨å†Œã€æ³¨é”€äº‹ä»¶ï¼›å¹¶è¿è¡Œäº‹ä»¶å¾ªç¯ï¼Œå½“æœ‰äº‹ä»¶è¿›å…¥â€œå°±ç»ªâ€çŠ¶æ€æ—¶ï¼Œè°ƒç”¨æ³¨å†Œäº‹ä»¶çš„å›è°ƒå‡½æ•°å¤„ç†äº‹ä»¶ã€‚å¯¹åº”åˆ°libeventä¸­ï¼Œå°±æ˜¯event_baseç»“æ„ä½“ã€‚ä¸€ä¸ªå…¸å‹çš„Reactorå£°æ˜æ–¹å¼ï¼š\n1234567class Reactor&#123;    public:        int register_handler(Event_Handler *pHandler, int event);        int remove_handler(Event_Handler *pHandler, int event);        void handle_events(timeval *ptv);        // ...&#125;;\n\n\n\n4ï¼‰ Event Handlerâ€”â€”äº‹ä»¶å¤„ç†ç¨‹åº\näº‹ä»¶å¤„ç†ç¨‹åºæä¾›äº†ä¸€ç»„æ¥å£ï¼Œæ¯ä¸ªæ¥å£å¯¹åº”äº†ä¸€ç§ç±»å‹çš„äº‹ä»¶ï¼Œä¾›Reactoråœ¨ç›¸åº”çš„äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨ï¼Œæ‰§è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ã€‚é€šå¸¸å®ƒä¼šç»‘å®šä¸€ä¸ªæœ‰æ•ˆçš„å¥æŸ„ã€‚å¯¹åº”åˆ°libeventä¸­ï¼Œå°±æ˜¯eventç»“æ„ä½“ã€‚ä¸‹é¢æ˜¯ä¸¤ç§å…¸å‹çš„Event Handlerç±»å£°æ˜æ–¹å¼ï¼ŒäºŒè€…äº’æœ‰ä¼˜ç¼ºç‚¹ã€‚\n1234567891011121314151617class Event_Handler&#123;    public:        virtual void handle_read() = 0;        virtual void handle_write() = 0;        virtual void handle_timeout() = 0;        virtual void handle_close() = 0;        virtual HANDLE get_handle() = 0;        // ...&#125;;class Event_Handler&#123;    public:        // events maybe read/write/timeout/close .etc        virtual void handle_events(int events) = 0;        virtual HANDLE get_handle() = 0;        // ...&#125;;\n\n4. Reactoräº‹ä»¶å¤„ç†æµç¨‹å‰é¢è¯´è¿‡Reactorå°†äº‹ä»¶æµâ€œé€†ç½®â€äº†ï¼Œé‚£ä¹ˆä½¿ç”¨Reactoræ¨¡å¼åï¼Œäº‹ä»¶æ§åˆ¶æµæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿå¯ä»¥å‚è§ä¸‹é¢çš„åºåˆ—å›¾ã€‚\n\n5. å°ç»“ä¸Šé¢è®²åˆ°äº†Reactorçš„åŸºæœ¬æ¦‚å¿µã€æ¡†æ¶å’Œå¤„ç†æµç¨‹ï¼Œå¯¹Reactoræœ‰ä¸ªåŸºæœ¬æ¸…æ™°çš„äº†è§£åï¼Œå†æ¥å¯¹æ¯”çœ‹libeventå°±ä¼šæ›´å®¹æ˜“ç†è§£äº†ï¼Œæ¥ä¸‹æ¥å°±æ­£å¼è¿›å…¥åˆ°libeventçš„ä»£ç ä¸–ç•Œäº†ï¼ŒåŠ æ²¹ï¼\nå‚è€ƒèµ„æ–™ï¼šPattern-Oriented Software Architecture, Patterns for Concurrent and Networked Objects, Volume 2\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ02","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"dd54cd62e1387361117c63cf12445709","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ03","content":"libeventæºç æ·±åº¦å‰–æ03libeventåŸºæœ¬ä½¿ç”¨åœºæ™¯å’Œäº‹ä»¶æµç¨‹1. å‰è¨€å­¦ä¹ æºä»£ç è¯¥ä»å“ªé‡Œå…¥æ‰‹ï¼Ÿæˆ‘è§‰å¾—ä»ç¨‹åºçš„åŸºæœ¬ä½¿ç”¨åœºæ™¯å’Œä»£ç çš„æ•´ä½“å¤„ç†æµç¨‹å…¥æ‰‹æ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œè‡³å°‘ä»ä¸ªäººçš„ç»éªŒä¸Šè®²ï¼Œç”¨æ­¤æ–¹æ³•åˆ†ælibeventæ˜¯æ¯”è¾ƒæœ‰æ•ˆçš„ã€‚\n2. åŸºæœ¬åº”ç”¨åœºæ™¯åŸºæœ¬åº”ç”¨åœºæ™¯ä¹Ÿæ˜¯ä½¿ç”¨libevnetçš„åŸºæœ¬æµç¨‹ï¼Œä¸‹é¢æ¥è€ƒè™‘ä¸€ä¸ªæœ€ç®€å•çš„åœºæ™¯ï¼Œä½¿ç”¨liveventè®¾ç½®å®šæ—¶å™¨ï¼Œåº”ç”¨ç¨‹åºåªéœ€è¦æ‰§è¡Œä¸‹é¢å‡ ä¸ªç®€å•çš„æ­¥éª¤å³å¯ã€‚1ï¼‰é¦–å…ˆåˆå§‹åŒ–libeventåº“ï¼Œå¹¶ä¿å­˜è¿”å›çš„æŒ‡é’ˆ\n1struct event_base* base = event_init();\n\nå®é™…ä¸Šè¿™ä¸€æ­¥ç›¸å½“äºåˆå§‹åŒ–ä¸€ä¸ªReactorå®ä¾‹ï¼›åœ¨åˆå§‹åŒ–libeventåï¼Œå°±å¯ä»¥æ³¨å†Œäº‹ä»¶äº†ã€‚\n2ï¼‰åˆå§‹åŒ–äº‹ä»¶eventï¼Œè®¾ç½®å›è°ƒå‡½æ•°å’Œå…³æ³¨çš„äº‹ä»¶\n1evtimer_set(&amp;ev, timer_cb, NULL);\n\näº‹å®ä¸Šè¿™ç­‰ä»·äºè°ƒç”¨ event_set(&amp;ev, -1, 0, timer_cb, NULL);event_setçš„å‡½æ•°åŸå‹æ˜¯ï¼š\n1void event_set(struct event *ev, int fd, short event, void (*cb)(int, short, void *), void *arg)\n\nevï¼šæ‰§è¡Œè¦åˆå§‹åŒ–çš„eventå¯¹è±¡ï¼›fdï¼šè¯¥eventç»‘å®šçš„â€œå¥æŸ„â€ï¼Œå¯¹äºä¿¡å·äº‹ä»¶ï¼Œå®ƒå°±æ˜¯å…³æ³¨çš„ä¿¡å·ï¼›eventï¼šåœ¨è¯¥fdä¸Šå…³æ³¨çš„äº‹ä»¶ç±»å‹ï¼Œå®ƒå¯ä»¥æ˜¯EV_READ, EV_WRITE, EV_SIGNALï¼›cbï¼šè¿™æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå½“fdä¸Šçš„äº‹ä»¶eventå‘ç”Ÿæ—¶ï¼Œè°ƒç”¨è¯¥å‡½æ•°æ‰§è¡Œå¤„ç†ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œè°ƒç”¨æ—¶ç”±event_baseè´Ÿè´£ä¼ å…¥ï¼ŒæŒ‰é¡ºåºï¼Œå®é™…ä¸Šå°±æ˜¯event_setæ—¶çš„fd, eventå’Œargï¼›argï¼šä¼ é€’ç»™cbå‡½æ•°æŒ‡é’ˆçš„å‚æ•°ï¼›ç”±äºå®šæ—¶äº‹ä»¶ä¸éœ€è¦fdï¼Œå¹¶ä¸”å®šæ—¶äº‹ä»¶æ˜¯æ ¹æ®æ·»åŠ æ—¶ï¼ˆevent_addï¼‰çš„è¶…æ—¶å€¼è®¾å®šçš„ï¼Œå› æ­¤è¿™é‡Œeventä¹Ÿä¸éœ€è¦è®¾ç½®ã€‚è¿™ä¸€æ­¥ç›¸å½“äºåˆå§‹åŒ–ä¸€ä¸ªevent handlerï¼Œåœ¨libeventä¸­äº‹ä»¶ç±»å‹ä¿å­˜åœ¨eventç»“æ„ä½“ä¸­ã€‚æ³¨æ„ï¼šlibeventå¹¶ä¸ä¼šç®¡ç†eventäº‹ä»¶é›†åˆï¼Œè¿™éœ€è¦åº”ç”¨ç¨‹åºè‡ªè¡Œç®¡ç†ï¼›\n3ï¼‰è®¾ç½®eventä»å±çš„event_base\n1event_base_set(base, &amp;ev); \n\nè¿™ä¸€æ­¥ç›¸å½“äºæŒ‡æ˜eventè¦æ³¨å†Œåˆ°å“ªä¸ªevent_baseå®ä¾‹ä¸Šï¼›\n4ï¼‰æ˜¯æ­£å¼çš„æ·»åŠ äº‹ä»¶çš„æ—¶å€™äº†\n1event_add(&amp;ev, timeout);\n\nåŸºæœ¬ä¿¡æ¯éƒ½å·²è®¾ç½®å®Œæˆï¼Œåªè¦ç®€å•çš„è°ƒç”¨**event_add()å‡½æ•°å³å¯å®Œæˆï¼Œå…¶ä¸­timeoutæ˜¯å®šæ—¶å€¼ï¼›è¿™ä¸€æ­¥ç›¸å½“äºè°ƒç”¨Reactor::register_handler()**å‡½æ•°æ³¨å†Œäº‹ä»¶ã€‚\n5ï¼‰ç¨‹åºè¿›å…¥æ— é™å¾ªç¯ï¼Œç­‰å¾…å°±ç»ªäº‹ä»¶å¹¶æ‰§è¡Œäº‹ä»¶å¤„ç†\n1event_base_dispatch(base);\n\n3. å®ä¾‹ä»£ç ä¸Šé¢ä¾‹å­çš„ç¨‹åºä»£ç å¦‚ä¸‹æ‰€ç¤º\n123456789101112131415struct event ev;struct timeval tv;void time_cb(int fd, short event, void *argc)&#123;    printf(&quot;timer wakeup/n&quot;);    event_add(&amp;ev, &amp;tv); // reschedule timer&#125;int main()&#123;    struct event_base *base = event_init();    tv.tv_sec = 10; // 10s period    tv.tv_usec = 0;    evtimer_set(&amp;ev, time_cb, NULL);    event_add(&amp;ev, &amp;tv);    event_base_dispatch(base);&#125;\n\n4. äº‹ä»¶å¤„ç†æµç¨‹å½“åº”ç”¨ç¨‹åºå‘libeventæ³¨å†Œä¸€ä¸ªäº‹ä»¶åï¼Œlibeventå†…éƒ¨æ˜¯æ€ä¹ˆæ ·è¿›è¡Œå¤„ç†çš„å‘¢ï¼Ÿä¸‹é¢çš„å›¾å°±ç»™å‡ºäº†è¿™ä¸€åŸºæœ¬æµç¨‹ã€‚1ï¼‰é¦–å…ˆåº”ç”¨ç¨‹åºå‡†å¤‡å¹¶åˆå§‹åŒ–eventï¼Œè®¾ç½®å¥½äº‹ä»¶ç±»å‹å’Œå›è°ƒå‡½æ•°ï¼›è¿™å¯¹åº”äºå‰é¢ç¬¬æ­¥éª¤2å’Œ3ï¼›2ï¼‰å‘libeventæ·»åŠ è¯¥äº‹ä»¶eventã€‚å¯¹äºå®šæ—¶äº‹ä»¶ï¼Œlibeventä½¿ç”¨ä¸€ä¸ªå°æ ¹å †ç®¡ç†ï¼Œkeyä¸ºè¶…æ—¶æ—¶é—´ï¼›å¯¹äºSignalå’ŒI&#x2F;Oäº‹ä»¶ï¼Œlibeventå°†å…¶æ”¾å…¥åˆ°ç­‰å¾…é“¾è¡¨ï¼ˆwait listï¼‰ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ï¼›3ï¼‰ç¨‹åºè°ƒç”¨**event_base_dispatch()**ç³»åˆ—å‡½æ•°è¿›å…¥æ— é™å¾ªç¯ï¼Œç­‰å¾…äº‹ä»¶ï¼Œä»¥select()å‡½æ•°ä¸ºä¾‹ï¼›æ¯æ¬¡å¾ªç¯å‰libeventä¼šæ£€æŸ¥å®šæ—¶äº‹ä»¶çš„æœ€å°è¶…æ—¶æ—¶é—´tvï¼Œæ ¹æ®tvè®¾ç½®select()çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œä»¥ä¾¿äºåé¢åŠæ—¶å¤„ç†è¶…æ—¶äº‹ä»¶ï¼›å½“select()è¿”å›åï¼Œé¦–å…ˆæ£€æŸ¥è¶…æ—¶äº‹ä»¶ï¼Œç„¶åæ£€æŸ¥I&#x2F;Oäº‹ä»¶ï¼›Libeventå°†æ‰€æœ‰çš„å°±ç»ªäº‹ä»¶ï¼Œæ”¾å…¥åˆ°æ¿€æ´»é“¾è¡¨ä¸­ï¼›ç„¶åå¯¹æ¿€æ´»é“¾è¡¨ä¸­çš„äº‹ä»¶ï¼Œè°ƒç”¨äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œäº‹ä»¶å¤„ç†ï¼› \n5. å°ç»“æœ¬èŠ‚ä»‹ç»äº†libeventçš„ç®€å•å®ç”¨åœºæ™¯ï¼Œå¹¶æ—‹é£èˆ¬çš„ä»‹ç»äº†libeventçš„äº‹ä»¶å¤„ç†æµç¨‹ï¼Œè¯»è€…åº”è¯¥å¯¹libeventæœ‰äº†åŸºæœ¬çš„å°è±¡ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†ä»‹ç»libeventçš„äº‹ä»¶ç®¡ç†æ¡†æ¶ï¼ˆReactoræ¨¡å¼ä¸­çš„Reactoræ¡†æ¶ï¼‰åšè¯¦ç»†çš„ä»‹ç»ï¼Œåœ¨æ­¤ä¹‹å‰ä¼šå¯¹æºä»£ç æ–‡ä»¶åšç®€å•çš„åˆ†ç±»ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ03","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"21cc3849aa98d79b1da8af8304100d2a","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ04","content":"libeventæºç æ·±åº¦å‰–æ041. å‰è¨€è¯¦ç»†åˆ†ææºä»£ç ä¹‹å‰ï¼Œå¦‚æœèƒ½å¯¹å…¶ä»£ç æ–‡ä»¶çš„åŸºæœ¬ç»“æ„æœ‰ä¸ªå¤§æ¦‚çš„è®¤è¯†å’Œåˆ†ç±»ï¼Œå¯¹äºä»£ç çš„åˆ†æå°†æ˜¯å¤§æœ‰è£¨ç›Šçš„ã€‚æœ¬èŠ‚å†…å®¹ä¸å¤šï¼Œæˆ‘æƒ³å¹¶ä¸æ˜¯è¯´å®ƒä¸é‡è¦ï¼\n2. æºä»£ç ç»„ç»‡ç»“æ„Libeventçš„æºä»£ç è™½ç„¶éƒ½åœ¨ä¸€å±‚æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œä½†æ˜¯å…¶ä»£ç åˆ†ç±»è¿˜æ˜¯ç›¸å½“æ¸…æ™°çš„ï¼Œä¸»è¦å¯åˆ†ä¸ºå¤´æ–‡ä»¶ã€å†…éƒ¨ä½¿ç”¨çš„å¤´æ–‡ä»¶ã€è¾…åŠ©åŠŸèƒ½å‡½æ•°ã€æ—¥å¿—ã€libeventæ¡†æ¶ã€å¯¹ç³»ç»ŸI&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶çš„å°è£…ã€ä¿¡å·ç®¡ç†ã€å®šæ—¶äº‹ä»¶ç®¡ç†ã€ç¼“å†²åŒºç®¡ç†ã€åŸºæœ¬æ•°æ®ç»“æ„å’ŒåŸºäºlibeventçš„ä¸¤ä¸ªå®ç”¨åº“ç­‰å‡ ä¸ªéƒ¨åˆ†ï¼Œæœ‰äº›éƒ¨åˆ†å¯èƒ½å°±æ˜¯ä¸€ä¸ªæºæ–‡ä»¶ã€‚æºä»£ç ä¸­çš„testéƒ¨åˆ†å°±ä¸åœ¨æˆ‘ä»¬å…³æ³¨çš„èŒƒç•´äº†ã€‚1ï¼‰å¤´æ–‡ä»¶ä¸»è¦å°±æ˜¯event.hï¼šäº‹ä»¶å®å®šä¹‰ã€æ¥å£å‡½æ•°å£°æ˜ï¼Œä¸»è¦ç»“æ„ä½“eventçš„å£°æ˜ï¼›2ï¼‰å†…éƒ¨å¤´æ–‡ä»¶xxx-internal.hï¼šå†…éƒ¨æ•°æ®ç»“æ„å’Œå‡½æ•°ï¼Œå¯¹å¤–ä¸å¯è§ï¼Œä»¥è¾¾åˆ°ä¿¡æ¯éšè—çš„ç›®çš„ï¼›3ï¼‰libeventæ¡†æ¶event.cï¼ševentæ•´ä½“æ¡†æ¶çš„ä»£ç å®ç°ï¼›4ï¼‰å¯¹ç³»ç»ŸI&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶çš„å°è£…epoll.cï¼šå¯¹epollçš„å°è£…ï¼›select.cï¼šå¯¹selectçš„å°è£…ï¼›devpoll.cï¼šå¯¹dev&#x2F;pollçš„å°è£…;kqueue.cï¼šå¯¹kqueueçš„å°è£…ï¼›5ï¼‰å®šæ—¶äº‹ä»¶ç®¡ç†min-heap.hï¼šå…¶å®å°±æ˜¯ä¸€ä¸ªä»¥æ—¶é—´ä½œä¸ºkeyçš„å°æ ¹å †ç»“æ„ï¼›6ï¼‰ä¿¡å·ç®¡ç†signal.cï¼šå¯¹ä¿¡å·äº‹ä»¶çš„å¤„ç†ï¼›7ï¼‰è¾…åŠ©åŠŸèƒ½å‡½æ•°evutil.h å’Œevutil.cï¼šä¸€äº›è¾…åŠ©åŠŸèƒ½å‡½æ•°ï¼ŒåŒ…æ‹¬åˆ›å»ºsocket pairå’Œä¸€äº›æ—¶é—´æ“ä½œå‡½æ•°ï¼šåŠ ã€å‡å’Œæ¯”è¾ƒç­‰ã€‚8ï¼‰æ—¥å¿—log.hå’Œlog.cï¼šlogæ—¥å¿—å‡½æ•°9ï¼‰ç¼“å†²åŒºç®¡ç†evbuffer.cå’Œbuffer.cï¼šlibeventå¯¹ç¼“å†²åŒºçš„å°è£…ï¼›10ï¼‰åŸºæœ¬æ•°æ®ç»“æ„compat&#x2F;sysä¸‹çš„ä¸¤ä¸ªæºæ–‡ä»¶ï¼šqueue.hæ˜¯libeventåŸºæœ¬æ•°æ®ç»“æ„çš„å®ç°ï¼ŒåŒ…æ‹¬é“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨ï¼Œé˜Ÿåˆ—ç­‰ï¼›_libevent_time.hï¼šä¸€äº›ç”¨äºæ—¶é—´æ“ä½œçš„ç»“æ„ä½“å®šä¹‰ã€å‡½æ•°å’Œå®å®šä¹‰ï¼›11ï¼‰å®ç”¨ç½‘ç»œåº“httpå’Œevdnsï¼šæ˜¯åŸºäºlibeventå®ç°çš„httpæœåŠ¡å™¨å’Œå¼‚æ­¥dnsæŸ¥è¯¢åº“ï¼›\n3. å°ç»“æœ¬èŠ‚ä»‹ç»äº†libeventçš„ç»„ç»‡å’Œåˆ†ç±»ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†ä»‹ç»libeventçš„æ ¸å¿ƒéƒ¨åˆ†eventç»“æ„ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ04","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e23144502108769556e4aa73a855e4ee","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ05","content":"libeventæºç æ·±åº¦å‰–æ05libeventçš„æ ¸å¿ƒï¼šäº‹ä»¶event\nå¯¹äº‹ä»¶å¤„ç†æµç¨‹æœ‰äº†é«˜å±‚çš„è®¤è¯†åï¼Œæœ¬èŠ‚å°†è¯¦ç»†ä»‹ç»libeventçš„æ ¸å¿ƒç»“æ„eventï¼Œä»¥åŠlibeventå¯¹eventçš„ç®¡ç†ã€‚\n1. libeventçš„æ ¸å¿ƒ-eventlibeventæ˜¯åŸºäºäº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰çš„ï¼Œä»åå­—ä¹Ÿå¯ä»¥çœ‹åˆ°eventæ˜¯æ•´ä¸ªåº“çš„æ ¸å¿ƒã€‚eventå°±æ˜¯Reactoræ¡†æ¶ä¸­çš„äº‹ä»¶å¤„ç†ç¨‹åºç»„ä»¶ï¼›å®ƒæä¾›äº†å‡½æ•°æ¥å£ï¼Œä¾›Reactoråœ¨äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨ï¼Œä»¥æ‰§è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ï¼Œé€šå¸¸å®ƒä¼šç»‘å®šä¸€ä¸ªæœ‰æ•ˆçš„å¥æŸ„ã€‚\né¦–å…ˆç»™å‡ºeventç»“æ„ä½“çš„å£°æ˜ï¼Œå®ƒä½äºevent.hæ–‡ä»¶ä¸­ï¼š\n123456789101112131415161718192021222324252627282930313233struct event &#123;     TAILQ_ENTRY (event) ev_next;     TAILQ_ENTRY (event) ev_active_next;     TAILQ_ENTRY (event) ev_signal_next;     unsigned int min_heap_idx; /* for managing timeouts */     struct event_base *ev_base;     int ev_fd;     short ev_events;     short ev_ncalls;     short *ev_pncalls; /* Allows deletes in callback */     struct timeval ev_timeout;     int ev_pri;  /* smaller numbers are higher priority */     void (*ev_callback)(int, short, void *arg);     void *ev_arg;     int ev_res;  /* result passed to event callback */     int ev_flags;&#125;;\n\nev_eventsï¼ševentå…³æ³¨çš„äº‹ä»¶ç±»å‹ï¼Œå®ƒå¯ä»¥æ˜¯ä»¥ä¸‹3ç§ç±»å‹ï¼š\n\nI&#x2F;Oäº‹ä»¶ï¼š EV_WRITEå’ŒEV_READ å®šæ—¶äº‹ä»¶ï¼šEV_TIMEOUT ä¿¡å·ï¼š EV_SIGNAL è¾…åŠ©é€‰é¡¹ï¼šEV_PERSISTï¼Œè¡¨æ˜æ˜¯ä¸€ä¸ªæ°¸ä¹…äº‹ä»¶ Libeventä¸­çš„å®šä¹‰ä¸ºï¼š\n 123456789#define EV_TIMEOUT 0x01#define EV_READ  0x02#define EV_WRITE 0x04#define EV_SIGNAL 0x08#define EV_PERSIST 0x10 /* Persistant event */\n\n å¯ä»¥çœ‹å‡ºäº‹ä»¶ç±»å‹å¯ä»¥ä½¿ç”¨â€œ|â€è¿ç®—ç¬¦è¿›è¡Œç»„åˆï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¿¡å·å’ŒI&#x2F;Oäº‹ä»¶ä¸èƒ½åŒæ—¶è®¾ç½®ï¼›\n è¿˜å¯ä»¥çœ‹å‡ºlibeventä½¿ç”¨eventç»“æ„ä½“å°†è¿™3ç§äº‹ä»¶çš„å¤„ç†ç»Ÿä¸€èµ·æ¥ï¼›\n\nev_nextï¼Œev_active_nextå’Œev_signal_nextéƒ½æ˜¯åŒå‘é“¾è¡¨èŠ‚ç‚¹æŒ‡é’ˆï¼›å®ƒä»¬æ˜¯libeventå¯¹ä¸åŒäº‹ä»¶ç±»å‹å’Œåœ¨ä¸åŒçš„æ—¶æœŸï¼Œå¯¹äº‹ä»¶çš„ç®¡ç†æ—¶ä½¿ç”¨åˆ°çš„å­—æ®µã€‚ libeventä½¿ç”¨åŒå‘é“¾è¡¨ä¿å­˜æ‰€æœ‰æ³¨å†Œçš„I&#x2F;Oå’ŒSignaläº‹ä»¶\n\nev_nextå°±æ˜¯è¯¥I&#x2F;Oäº‹ä»¶åœ¨é“¾è¡¨ä¸­çš„ä½ç½®ï¼›ç§°æ­¤é“¾è¡¨ä¸ºâ€œå·²æ³¨å†Œäº‹ä»¶é“¾è¡¨â€ï¼›\n\nåŒæ ·ev_signal_nextå°±æ˜¯signaläº‹ä»¶åœ¨signaläº‹ä»¶é“¾è¡¨ä¸­çš„ä½ç½®ï¼›\n\nev_active_nextï¼šlibeventå°†æ‰€æœ‰çš„æ¿€æ´»äº‹ä»¶æ”¾å…¥åˆ°é“¾è¡¨active listä¸­ï¼Œç„¶åéå†active listæ‰§è¡Œè°ƒåº¦ï¼Œev_active_nextå°±æŒ‡æ˜äº†eventåœ¨active listä¸­çš„ä½ç½®ï¼›\n\nmin_heap_idxå’Œev_timeoutï¼Œå¦‚æœæ˜¯timeoutäº‹ä»¶ï¼Œå®ƒä»¬æ˜¯eventåœ¨å°æ ¹å †ä¸­çš„ç´¢å¼•å’Œè¶…æ—¶å€¼ï¼Œlibeventä½¿ç”¨å°æ ¹å †æ¥ç®¡ç†å®šæ—¶äº‹ä»¶ï¼Œè¿™å°†åœ¨åé¢å®šæ—¶äº‹ä»¶å¤„ç†æ—¶ä¸“é—¨è®²è§£ï¼›\n\nev_baseè¯¥äº‹ä»¶æ‰€å±çš„ååº”å †å®ä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªevent_baseç»“æ„ä½“ï¼Œä¸‹ä¸€èŠ‚å°†ä¼šè¯¦ç»†è®²è§£ï¼›\n\nev_fdï¼Œå¯¹äºI&#x2F;Oäº‹ä»¶ï¼Œæ˜¯ç»‘å®šçš„æ–‡ä»¶æè¿°ç¬¦ï¼›å¯¹äºsignaläº‹ä»¶ï¼Œæ˜¯ç»‘å®šçš„ä¿¡å·ï¼›\n\nev_callbackï¼Œeventçš„å›è°ƒå‡½æ•°ï¼Œè¢«ev_baseè°ƒç”¨ï¼Œæ‰§è¡Œäº‹ä»¶å¤„ç†ç¨‹åºï¼Œè¿™æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒåŸå‹ä¸ºï¼š\n 11void (*ev_callback)(int fd, short events, void *arg)\n\n å…¶ä¸­å‚æ•°fdå¯¹åº”äºev_fdï¼›eventså¯¹åº”äºev_eventsï¼›argå¯¹åº”äºev_argï¼›\n\nev_argï¼švoid*ï¼Œè¡¨æ˜å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œåœ¨è®¾ç½®eventæ—¶æŒ‡å®šï¼›\n\neb_flagsï¼šlibeventç”¨äºæ ‡è®°eventä¿¡æ¯çš„å­—æ®µï¼Œè¡¨æ˜å…¶å½“å‰çš„çŠ¶æ€ï¼Œå¯èƒ½çš„å€¼æœ‰ï¼š\n1234567891011 1#define EVLIST_TIMEOUT 0x01 // eventåœ¨timeå †ä¸­ 2 3#define EVLIST_INSERTED 0x02 // eventåœ¨å·²æ³¨å†Œäº‹ä»¶é“¾è¡¨ä¸­ 4 5#define EVLIST_SIGNAL 0x04 // æœªè§ä½¿ç”¨ 6 7#define EVLIST_ACTIVE 0x08 // eventåœ¨æ¿€æ´»é“¾è¡¨ä¸­ 8 9#define EVLIST_INTERNAL 0x10 // å†…éƒ¨ä½¿ç”¨æ ‡è®°1011#define EVLIST_INIT     0x80 // eventå·²è¢«åˆå§‹åŒ–\n\nev_ncallsï¼šäº‹ä»¶å°±ç»ªæ‰§è¡Œæ—¶ï¼Œè°ƒç”¨ev_callbackçš„æ¬¡æ•°ï¼Œé€šå¸¸ä¸º1ï¼›\n\nev_pncallsï¼šæŒ‡é’ˆï¼Œé€šå¸¸æŒ‡å‘ev_ncallsæˆ–è€…ä¸ºNULLï¼›\n\nev_resï¼šè®°å½•äº†å½“å‰æ¿€æ´»äº‹ä»¶çš„ç±»å‹ï¼›\n\n\n2. libeventå¯¹eventçš„ç®¡ç†ä»eventç»“æ„ä½“ä¸­çš„3ä¸ªé“¾è¡¨èŠ‚ç‚¹æŒ‡é’ˆå’Œä¸€ä¸ªå †ç´¢å¼•å‡ºå‘ï¼Œå¤§ä½“ä¸Šä¹Ÿèƒ½çª¥å‡ºlibeventå¯¹eventçš„ç®¡ç†æ–¹æ³•äº†ï¼Œå¯ä»¥å‚è§ä¸‹é¢çš„ç¤ºæ„å›¾ï¼š\n\n\næ¯æ¬¡å½“æœ‰äº‹ä»¶eventè½¬å˜ä¸ºå°±ç»ªçŠ¶æ€æ—¶ï¼Œlibeventå°±ä¼šæŠŠå®ƒç§»å…¥åˆ°active event list[priority]ä¸­ï¼Œå…¶ä¸­priorityæ˜¯eventçš„ä¼˜å…ˆçº§ï¼›\næ¥ç€libeventä¼šæ ¹æ®è‡ªå·±çš„è°ƒåº¦ç­–ç•¥é€‰æ‹©å°±ç»ªäº‹ä»¶ï¼Œè°ƒç”¨å…¶cb_callback()å‡½æ•°æ‰§è¡Œäº‹ä»¶å¤„ç†ï¼›å¹¶æ ¹æ®å°±ç»ªçš„å¥æŸ„å’Œäº‹ä»¶ç±»å‹å¡«å……cb_callbackå‡½æ•°çš„å‚æ•°ã€‚\n\n3. äº‹ä»¶è®¾ç½®çš„æ¥å£å‡½æ•°è¦å‘libeventæ·»åŠ ä¸€ä¸ªäº‹ä»¶ï¼Œéœ€è¦é¦–å…ˆè®¾ç½®eventå¯¹è±¡ï¼Œè¿™é€šè¿‡è°ƒç”¨libeventæä¾›çš„å‡½æ•°æœ‰ï¼ševent_set(), event_base_set(), event_priority_set()æ¥å®Œæˆï¼›ä¸‹é¢åˆ†åˆ«è¿›è¡Œè®²è§£ã€‚\n1void event_set(struct event *ev, int fd, short events, void (*callback)(int, short, void *), void *arg)\n\n\nè®¾ç½®äº‹ä»¶evç»‘å®šçš„æ–‡ä»¶æè¿°ç¬¦æˆ–è€…ä¿¡å·ï¼Œå¯¹äºå®šæ—¶äº‹ä»¶ï¼Œè®¾ä¸º-1å³å¯ï¼›\nè®¾ç½®äº‹ä»¶ç±»å‹ï¼Œæ¯”å¦‚EV_READ|EV_PERSIST, EV_WRITE, EV_SIGNALç­‰ï¼›\nè®¾ç½®äº‹ä»¶çš„å›è°ƒå‡½æ•°ä»¥åŠå‚æ•°argï¼›\nåˆå§‹åŒ–å…¶å®ƒå­—æ®µï¼Œæ¯”å¦‚ç¼ºçœçš„event_baseå’Œä¼˜å…ˆçº§ï¼› int event_base_set(struct event_base *base, struct event *ev) è®¾ç½®event evå°†è¦æ³¨å†Œåˆ°çš„event_baseï¼› libeventæœ‰ä¸€ä¸ªå…¨å±€event_baseæŒ‡é’ˆcurrent_baseï¼Œé»˜è®¤æƒ…å†µä¸‹äº‹ä»¶evå°†è¢«æ³¨å†Œåˆ°current_baseä¸Šï¼Œä½¿ç”¨è¯¥å‡½æ•°å¯ä»¥æŒ‡å®šä¸åŒçš„event_baseï¼› å¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸­å­˜åœ¨å¤šä¸ªlibeventå®ä¾‹ï¼Œåˆ™å¿…é¡»è¦è°ƒç”¨è¯¥å‡½æ•°ä¸ºeventè®¾ç½®ä¸åŒçš„event_baseï¼›\n\n1int event_priority_set(struct event *ev, int pri)\n\nè®¾ç½®event evçš„ä¼˜å…ˆçº§ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œæ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯ï¼šå½“evæ­£å¤„äºå°±ç»ªçŠ¶æ€æ—¶ï¼Œä¸èƒ½è®¾ç½®ï¼Œè¿”å›-1ã€‚\n4. å°ç»“æœ¬èŠ‚è®²è¿°äº†libeventçš„æ ¸å¿ƒeventç»“æ„ï¼Œä»¥åŠlibeventæ”¯æŒçš„äº‹ä»¶ç±»å‹å’Œlibeventå¯¹eventçš„ç®¡ç†æ¨¡å‹ï¼›æ¥ä¸‹æ¥å°†ä¼šæè¿°libeventçš„äº‹ä»¶å¤„ç†æ¡†æ¶ï¼Œä»¥åŠå…¶ä¸­ä½¿ç”¨çš„é‡è¦çš„ç»“æ„ä½“event_baseã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ05","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"1db95bdb6c78dab83e0028f095b96fd6","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ06","content":"libeventæºç æ·±åº¦å‰–æ06åˆè§äº‹ä»¶å¤„ç†æ¡†æ¶\nå‰é¢å·²ç»å¯¹libeventçš„äº‹ä»¶å¤„ç†æ¡†æ¶å’Œeventç»“æ„ä½“åšäº†æè¿°ï¼Œç°åœ¨æ˜¯æ—¶å€™å‰–ælibeventå¯¹äº‹ä»¶çš„è¯¦ç»†å¤„ç†æµç¨‹äº†ï¼Œæœ¬èŠ‚å°†åˆ†ælibeventçš„äº‹ä»¶å¤„ç†æ¡†æ¶event_baseå’Œlibeventæ³¨å†Œã€åˆ é™¤äº‹ä»¶çš„å…·ä½“æµç¨‹ï¼Œå¯ç»“åˆå‰ä¸€èŠ‚libeventå¯¹eventçš„ç®¡ç†ã€‚\n1. äº‹ä»¶å¤„ç†æ¡†æ¶-event_baseå›æƒ³Reactoræ¨¡å¼çš„å‡ ä¸ªåŸºæœ¬ç»„ä»¶ï¼Œæœ¬èŠ‚è®²è§£çš„éƒ¨åˆ†å¯¹åº”äºReactoræ¡†æ¶ç»„ä»¶ã€‚åœ¨libeventä¸­ï¼Œè¿™å°±è¡¨ç°ä¸ºevent_baseç»“æ„ä½“ï¼Œç»“æ„ä½“å£°æ˜å¦‚ä¸‹ï¼Œå®ƒä½äºevent-internal.hæ–‡ä»¶ä¸­ï¼š\n1234567891011121314151617struct event_base &#123;    const struct eventop *evsel;    void *evbase;ã€€    int event_count;  /* counts number of total events */    int event_count_active; /* counts number of active events */    int event_gotterm;  /* Set to terminate loop */    int event_break;  /* Set to terminate loop immediately */    /* active event management */    struct event_list **activequeues;    int nactivequeues;    /* signal handling info */    struct evsignal_info sig;    struct event_list eventqueue;    struct timeval event_tv;    struct min_heap timeheap;    struct timeval tv_cache;&#125;;\n\nä¸‹é¢è¯¦ç»†è§£é‡Šä¸€ä¸‹ç»“æ„ä½“ä¸­å„å­—æ®µçš„å«ä¹‰ã€‚\n\nevselå’Œevbaseè¿™ä¸¤ä¸ªå­—æ®µçš„è®¾ç½®å¯èƒ½ä¼šè®©äººæœ‰äº›è¿·æƒ‘ï¼Œè¿™é‡Œä½ å¯ä»¥æŠŠevselå’Œevbaseçœ‹ä½œæ˜¯ç±»å’Œé™æ€å‡½æ•°çš„å…³ç³»ï¼Œæ¯”å¦‚æ·»åŠ äº‹ä»¶æ—¶çš„è°ƒç”¨è¡Œä¸ºï¼ševsel-&gt;add(evbase, ev)ï¼Œå®é™…æ‰§è¡Œæ“ä½œçš„æ˜¯evbaseï¼›è¿™ç›¸å½“äºclass::add(instance, ev)ï¼Œinstanceå°±æ˜¯classçš„ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚ evselæŒ‡å‘äº†å…¨å±€å˜é‡static const struct eventop *eventops[]ä¸­çš„ä¸€ä¸ªï¼› å‰é¢ä¹Ÿè¯´è¿‡ï¼Œlibeventå°†ç³»ç»Ÿæä¾›çš„I&#x2F;O demultiplexæœºåˆ¶ç»Ÿä¸€å°è£…æˆäº†eventopç»“æ„ï¼›å› æ­¤eventops[]åŒ…å«äº†selectã€pollã€kequeueå’Œepollç­‰ç­‰å…¶ä¸­çš„è‹¥å¹²ä¸ªå…¨å±€å®ä¾‹å¯¹è±¡ã€‚ evbaseå®é™…ä¸Šæ˜¯ä¸€ä¸ªeventopå®ä¾‹å¯¹è±¡ï¼› å…ˆæ¥çœ‹çœ‹eventopç»“æ„ä½“ï¼Œå®ƒçš„æˆå‘˜æ˜¯ä¸€ç³»åˆ—çš„å‡½æ•°æŒ‡é’ˆ, åœ¨event-internal.hæ–‡ä»¶ä¸­ï¼š\n 12345678910struct eventop &#123;    const char *name;    void *(*init)(struct event_base *); // åˆå§‹åŒ–    int (*add)(void *, struct event *); // æ³¨å†Œäº‹ä»¶    int (*del)(void *, struct event *); // åˆ é™¤äº‹ä»¶    int (*dispatch)(struct event_base *, void *, struct timeval *); // äº‹ä»¶åˆ†å‘    void (*dealloc)(struct event_base *, void *); // æ³¨é”€ï¼Œé‡Šæ”¾èµ„æº    /* set if we need to reinitialize the event base */    int need_reinit;&#125;;\n\n ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨libeventä¸­ï¼Œæ¯ç§I&#x2F;O demultiplexæœºåˆ¶çš„å®ç°éƒ½å¿…é¡»æä¾›è¿™äº”ä¸ªå‡½æ•°æ¥å£ï¼Œæ¥å®Œæˆè‡ªèº«çš„åˆå§‹åŒ–ã€é”€æ¯é‡Šæ”¾ï¼›å¯¹äº‹ä»¶çš„æ³¨å†Œã€æ³¨é”€å’Œåˆ†å‘ã€‚ æ¯”å¦‚å¯¹äºepollï¼Œlibeventå®ç°äº†5ä¸ªå¯¹åº”çš„æ¥å£å‡½æ•°ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶å¹¶å°†eventopçš„5ä¸ªå‡½æ•°æŒ‡é’ˆæŒ‡å‘è¿™5ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç¨‹åºå°±å¯ä»¥ä½¿ç”¨epollä½œä¸ºI&#x2F;O demultiplexæœºåˆ¶äº†ï¼Œè¿™ä¸ªåœ¨åé¢ä¼šå†æ¬¡æåˆ°ã€‚\n\nactivequeuesæ˜¯ä¸€ä¸ªäºŒçº§æŒ‡é’ˆï¼Œå‰é¢è®²è¿‡libeventæ”¯æŒäº‹ä»¶ä¼˜å…ˆçº§ï¼Œå› æ­¤ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯æ•°ç»„ï¼Œå…¶ä¸­çš„å…ƒç´ activequeues[priority]æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹æŒ‡å‘ä¸€ä¸ªä¼˜å…ˆçº§ä¸ºpriorityçš„å°±ç»ªäº‹ä»¶eventã€‚\n\neventqueueï¼Œé“¾è¡¨ï¼Œä¿å­˜äº†æ‰€æœ‰çš„æ³¨å†Œäº‹ä»¶eventçš„æŒ‡é’ˆã€‚\n\nsigæ˜¯ç”±æ¥ç®¡ç†ä¿¡å·çš„ç»“æ„ä½“ï¼Œå°†åœ¨åé¢ä¿¡å·å¤„ç†æ—¶ä¸“é—¨è®²è§£ï¼›\n\ntimeheapæ˜¯ç®¡ç†å®šæ—¶äº‹ä»¶çš„å°æ ¹å †ï¼Œå°†åœ¨åé¢å®šæ—¶äº‹ä»¶å¤„ç†æ—¶ä¸“é—¨è®²è§£ï¼›\n\nevent_två’Œtv_cacheæ˜¯libeventç”¨äºæ—¶é—´ç®¡ç†çš„å˜é‡ï¼Œå°†åœ¨åé¢è®²åˆ°ï¼› å…¶å®ƒå„ä¸ªå˜é‡éƒ½èƒ½å› åçŸ¥æ„ï¼Œå°±ä¸å†å•°å—¦äº†ã€‚\n\n\n2. åˆ›å»ºå’Œåˆå§‹åŒ–event_baseåˆ›å»ºä¸€ä¸ªevent_baseå¯¹è±¡ä¹Ÿæ—¢æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„libeventå®ä¾‹ï¼Œç¨‹åºéœ€è¦é€šè¿‡è°ƒç”¨event_init()ï¼ˆå†…éƒ¨è°ƒç”¨event_base_newå‡½æ•°æ‰§è¡Œå…·ä½“æ“ä½œï¼‰å‡½æ•°æ¥åˆ›å»ºï¼Œè¯¥å‡½æ•°åŒæ—¶è¿˜å¯¹æ–°ç”Ÿæˆçš„libeventå®ä¾‹è¿›è¡Œäº†åˆå§‹åŒ–ã€‚\n\nè¯¥å‡½æ•°é¦–å…ˆä¸ºevent_baseå®ä¾‹ç”³è¯·ç©ºé—´ï¼Œ\nç„¶ååˆå§‹åŒ–timer mini-heapï¼Œé€‰æ‹©å¹¶åˆå§‹åŒ–åˆé€‚çš„ç³»ç»ŸI&#x2F;O çš„demultiplexeræœºåˆ¶ï¼Œåˆå§‹åŒ–å„äº‹ä»¶é“¾è¡¨ï¼›\n\nå‡½æ•°è¿˜æ£€æµ‹äº†ç³»ç»Ÿçš„æ—¶é—´è®¾ç½®ï¼Œä¸ºåé¢çš„æ—¶é—´ç®¡ç†æ‰“ä¸‹åŸºç¡€ã€‚\n3. æ¥å£å‡½æ•°å‰é¢æåˆ°Reactoræ¡†æ¶çš„ä½œç”¨å°±æ˜¯æä¾›äº‹ä»¶çš„æ³¨å†Œã€æ³¨é”€æ¥å£ï¼›æ ¹æ®ç³»ç»Ÿæä¾›çš„äº‹ä»¶å¤šè·¯åˆ†å‘æœºåˆ¶æ‰§è¡Œäº‹ä»¶å¾ªç¯ï¼Œå½“æœ‰äº‹ä»¶è¿›å…¥â€œå°±ç»ªâ€çŠ¶æ€æ—¶ï¼Œè°ƒç”¨æ³¨å†Œäº‹ä»¶çš„å›è°ƒå‡½æ•°æ¥å¤„ç†äº‹ä»¶ã€‚Libeventä¸­å¯¹åº”çš„æ¥å£å‡½æ•°ä¸»è¦å°±æ˜¯ï¼š\n12345int  event_add(struct event *ev, const struct timeval *timeout);int  event_del(struct event *ev);int  event_base_loop(struct event_base *base, int loops);void event_active(struct event *event, int res, short events);void event_process_active(struct event_base *base); \n\næœ¬èŠ‚å°†æŒ‰ä»‹ç»äº‹ä»¶æ³¨å†Œå’Œåˆ é™¤çš„ä»£ç æµç¨‹ï¼Œlibeventçš„äº‹ä»¶å¾ªç¯æ¡†æ¶å°†åœ¨ä¸‹ä¸€èŠ‚å†å…·ä½“æè¿°ã€‚\n\nå¯¹äºå®šæ—¶äº‹ä»¶ï¼Œè¿™äº›å‡½æ•°å°†è°ƒç”¨timer heapç®¡ç†æ¥å£æ‰§è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼›\nå¯¹äºI&#x2F;Oå’ŒSignaläº‹ä»¶å°†è°ƒç”¨eventopaddå’Œdeleteæ¥å£å‡½æ•°æ‰§è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼ˆeventopä¼šå¯¹Signaläº‹ä»¶è°ƒç”¨Signalå¤„ç†æ¥å£æ‰§è¡Œæ“ä½œï¼‰ï¼›\n\nè¿™äº›ç»„ä»¶å°†åœ¨åé¢çš„å†…å®¹æè¿°ã€‚\n1ï¼‰æ³¨å†Œäº‹ä»¶å‡½æ•°åŸå‹ï¼š\n1int event_add(struct event *ev, const struct timeval *tv)\n\nå‚æ•°ï¼ševï¼šæŒ‡å‘è¦æ³¨å†Œçš„äº‹ä»¶ï¼›tvï¼šè¶…æ—¶æ—¶é—´ï¼›\neå‡½æ•°å°†evæ³¨å†Œåˆ°ev-&gt;ev_baseä¸Šï¼Œäº‹ä»¶ç±»å‹ç”±ev-&gt;ev_eventsæŒ‡æ˜ï¼Œ\n\nå¦‚æœæ³¨å†ŒæˆåŠŸï¼Œvå°†è¢«æ’å…¥åˆ°å·²æ³¨å†Œé“¾è¡¨ä¸­ï¼›\nå¦‚æœtvä¸æ˜¯NULLï¼Œåˆ™ä¼šåŒæ—¶æ³¨å†Œå®šæ—¶äº‹ä»¶ï¼Œå°†evæ·»åŠ åˆ°timerå †ä¸Šï¼›\n\nå¦‚æœå…¶ä¸­æœ‰ä¸€æ­¥æ“ä½œå¤±è´¥ï¼Œé‚£ä¹ˆå‡½æ•°ä¿è¯æ²¡æœ‰äº‹ä»¶ä¼šè¢«æ³¨å†Œï¼Œå¯ä»¥è®²è¿™ç›¸å½“äºä¸€ä¸ªåŸå­æ“ä½œã€‚è¿™ä¸ªå‡½æ•°ä¹Ÿä½“ç°äº†libeventç»†èŠ‚ä¹‹å¤„çš„å·§å¦™è®¾è®¡ï¼Œä¸”ä»”ç»†çœ‹ç¨‹åºä»£ç ï¼Œéƒ¨åˆ†æœ‰çœç•¥ï¼Œæ³¨é‡Šç›´æ¥é™„åœ¨ä»£ç ä¸­ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344int event_add(struct event *ev, const struct timeval *tv) &#123;\tstruct event_base *base = ev-&gt;ev_base;\t// è¦æ³¨å†Œåˆ°çš„event_base\tconst struct eventop *evsel = base-&gt;evsel;\tvoid *evbase = base-&gt;evbase;\t// baseä½¿ç”¨çš„ç³»ç»ŸI/Oç­–ç•¥\t// æ–°çš„timeräº‹ä»¶ï¼Œè°ƒç”¨timer heapæ¥å£åœ¨å †ä¸Šé¢„ç•™ä¸€ä¸ªä½ç½®\t// æ³¨ï¼šè¿™æ ·èƒ½ä¿è¯è¯¥æ“ä½œçš„åŸå­æ€§ï¼š\t// å‘ç³»ç»ŸI/Oæœºåˆ¶æ³¨å†Œå¯èƒ½ä¼šå¤±è´¥ï¼Œè€Œå½“åœ¨å †ä¸Šé¢„ç•™æˆåŠŸåï¼Œ\t// å®šæ—¶äº‹ä»¶çš„æ·»åŠ å°†è‚¯å®šä¸ä¼šå¤±è´¥ï¼›\t// è€Œé¢„ç•™ä½ç½®çš„å¯èƒ½ç»“æœæ˜¯å †æ‰©å……ï¼Œä½†æ˜¯å†…éƒ¨å…ƒç´ å¹¶ä¸ä¼šæ”¹å˜\tif (tv != NULL &amp;&amp; !(ev-&gt;ev_flags &amp; EVLIST_TIMEOUT)) &#123;\t\tif (min_heap_reserve(&amp;base-&gt;timeheap, 1 + min_heap_size(&amp;base-&gt;timeheap)) == -1)\t\t        \treturn (-1);\t\t/* ENOMEM == errno */\t&#125;\t// å¦‚æœäº‹ä»¶evä¸åœ¨å·²æ³¨å†Œæˆ–è€…æ¿€æ´»é“¾è¡¨ä¸­ï¼Œåˆ™è°ƒç”¨evbaseæ³¨å†Œäº‹ä»¶\tif ((ev-&gt;ev_events &amp; (EV_READ|EV_WRITE|EV_SIGNAL)) &amp;&amp; !(ev-&gt;ev_flags &amp; (EVLIST_INSERTED|EVLIST_ACTIVE))) &#123;\t\tres = evsel-&gt;add(evbase, ev);\t\tif (res != -1) // æ³¨å†ŒæˆåŠŸï¼Œæ’å…¥eventåˆ°å·²æ³¨å†Œé“¾è¡¨ä¸­\t\tevent_queue_insert(base, ev, EVLIST_INSERTED);\t&#125;\t// å‡†å¤‡æ·»åŠ å®šæ—¶äº‹ä»¶\tif (res != -1 &amp;&amp; tv != NULL) &#123;\t\tstruct timeval now;\t\t// EVLIST_TIMEOUTè¡¨æ˜eventå·²ç»åœ¨å®šæ—¶å™¨å †ä¸­äº†ï¼Œåˆ é™¤æ—§çš„\t\tif (ev-&gt;ev_flags &amp; EVLIST_TIMEOUT)\t\t        \tevent_queue_remove(base, ev, EVLIST_TIMEOUT);\t\t// å¦‚æœäº‹ä»¶å·²ç»æ˜¯å°±ç»ªçŠ¶æ€åˆ™ä»æ¿€æ´»é“¾è¡¨ä¸­åˆ é™¤\t\tif ((ev-&gt;ev_flags &amp; EVLIST_ACTIVE) &amp;&amp;\t\t        (ev-&gt;ev_res &amp; EV_TIMEOUT)) &#123;\t\t\t// å°†ev_callbackè°ƒç”¨æ¬¡æ•°è®¾ç½®ä¸º0\t\t\tif (ev-&gt;ev_ncalls &amp;&amp; ev-&gt;ev_pncalls) &#123;\t\t\t\t*ev-&gt;ev_pncalls = 0;\t\t\t&#125;\t\t\tevent_queue_remove(base, ev, EVLIST_ACTIVE);\t\t&#125;\t\t// è®¡ç®—æ—¶é—´ï¼Œå¹¶æ’å…¥åˆ°timerå°æ ¹å †ä¸­\t\tgettime(base, &amp;now);\t\tevutil_timeradd(&amp;now, tv, &amp;ev-&gt;ev_timeout);\t\tevent_queue_insert(base, ev, EVLIST_TIMEOUT);\t&#125;\treturn (res);&#125;\n\n\nevent_queue_insert()è´Ÿè´£å°†äº‹ä»¶æ’å…¥åˆ°å¯¹åº”çš„é“¾è¡¨ä¸­ï¼Œä¸‹é¢æ˜¯ç¨‹åºä»£ç ï¼›\nevent_queue_remove()è´Ÿè´£å°†äº‹ä»¶ä»å¯¹åº”çš„é“¾è¡¨ä¸­åˆ é™¤ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤è´´ä»£ç äº†ï¼›\n\n12345678910111213141516171819202122void event_queue_insert(struct event_base *base, struct event *ev, int queue) &#123;\t// evå¯èƒ½å·²ç»åœ¨æ¿€æ´»åˆ—è¡¨ä¸­äº†ï¼Œé¿å…é‡å¤æ’å…¥\tif (ev-&gt;ev_flags &amp; queue) &#123;\t\tif (queue &amp; EVLIST_ACTIVE)\t\t   return;\t&#125;\t// ...\tev-&gt;ev_flags |= queue;\t// è®°å½•queueæ ‡è®°\tswitch (queue) &#123;\t\tcase EVLIST_INSERTED: // I/Oæˆ–Signaläº‹ä»¶ï¼ŒåŠ å…¥å·²æ³¨å†Œäº‹ä»¶é“¾è¡¨\t\tTAILQ_INSERT_TAIL(&amp;base-&gt;eventqueue, ev, ev_next);\t\tbreak;\t\tcase EVLIST_ACTIVE: // å°±ç»ªäº‹ä»¶ï¼ŒåŠ å…¥æ¿€æ´»é“¾è¡¨\t\tbase-&gt;event_count_active++;\t\tTAILQ_INSERT_TAIL(base-&gt;activequeues[ev-&gt;ev_pri], ev, ev_active_next);\t\tbreak;\t\tcase EVLIST_TIMEOUT: // å®šæ—¶äº‹ä»¶ï¼ŒåŠ å…¥å †\t\tmin_heap_push(&amp;base-&gt;timeheap, ev);\t\tbreak;\t&#125;&#125;\n\n2ï¼‰åˆ é™¤äº‹ä»¶ï¼šå‡½æ•°åŸå‹ä¸ºï¼š\n1int event_del(struct event *ev);\n\nè¯¥å‡½æ•°å°†åˆ é™¤äº‹ä»¶ev\n\nå¯¹äºI&#x2F;Oäº‹ä»¶ï¼Œä»I&#x2F;O çš„demultiplexerä¸Šå°†äº‹ä»¶æ³¨é”€ï¼›\nå¯¹äºSignaläº‹ä»¶ï¼Œå°†ä»Signaläº‹ä»¶é“¾è¡¨ä¸­åˆ é™¤ï¼›\nå¯¹äºå®šæ—¶äº‹ä»¶ï¼Œå°†ä»å †ä¸Šåˆ é™¤ï¼›\n\nåŒæ ·åˆ é™¤äº‹ä»¶çš„æ“ä½œåˆ™ä¸ä¸€å®šæ˜¯åŸå­çš„ï¼Œæ¯”å¦‚åˆ é™¤æ—¶é—´äº‹ä»¶ä¹‹åï¼Œæœ‰å¯èƒ½ä»ç³»ç»ŸI&#x2F;Oæœºåˆ¶ä¸­æ³¨é”€ä¼šå¤±è´¥ã€‚\n12345678910111213141516171819202122232425262728int event_del(struct event *ev) &#123;\tstruct event_base *base;\tconst struct eventop *evsel;\tvoid *evbase;\t// ev_baseä¸ºNULLï¼Œè¡¨æ˜evæ²¡æœ‰è¢«æ³¨å†Œ\tif (ev-&gt;ev_base == NULL)\t  return (-1);\t// å–å¾—evæ³¨å†Œçš„event_baseå’ŒeventopæŒ‡é’ˆ\tbase = ev-&gt;ev_base;\tevsel = base-&gt;evsel;\tevbase = base-&gt;evbase;\t// å°†ev_callbackè°ƒç”¨æ¬¡æ•°è®¾ç½®ä¸º\tif (ev-&gt;ev_ncalls &amp;&amp; ev-&gt;ev_pncalls) &#123;\t\t*ev-&gt;ev_pncalls = 0;\t&#125;\t// ä»å¯¹åº”çš„é“¾è¡¨ä¸­åˆ é™¤\tif (ev-&gt;ev_flags &amp; EVLIST_TIMEOUT)\t  event_queue_remove(base, ev, EVLIST_TIMEOUT);\tif (ev-&gt;ev_flags &amp; EVLIST_ACTIVE)\t  event_queue_remove(base, ev, EVLIST_ACTIVE);\tif (ev-&gt;ev_flags &amp; EVLIST_INSERTED) &#123;\t\tevent_queue_remove(base, ev, EVLIST_INSERTED);\t\t// EVLIST_INSERTEDè¡¨æ˜æ˜¯I/Oæˆ–è€…Signaläº‹ä»¶ï¼Œ\t\t// éœ€è¦è°ƒç”¨I/O demultiplexeræ³¨é”€äº‹ä»¶\t\treturn (evsel-&gt;del(evbase, ev));\t&#125;\treturn (0);&#125;\n\n4. å°ç»“åˆ†æäº†event_baseè¿™ä¸€é‡è¦ç»“æ„ä½“ï¼Œåˆæ­¥çœ‹åˆ°äº†libeventå¯¹ç³»ç»Ÿçš„I&#x2F;O demultiplexæœºåˆ¶çš„å°è£…event_opç»“æ„ï¼Œå¹¶ç»“åˆæºä»£ç åˆ†æäº†äº‹ä»¶çš„æ³¨å†Œå’Œåˆ é™¤å¤„ç†ï¼Œä¸‹é¢å°†ä¼šæ¥ç€åˆ†æäº‹ä»¶ç®¡ç†æ¡†æ¶ä¸­çš„ä¸»äº‹ä»¶å¾ªç¯éƒ¨åˆ†ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ06","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"2db59a77cabd819a1426d0628461aab7","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ07","content":"libeventæºç æ·±åº¦å‰–æ07äº‹ä»¶ä¸»å¾ªç¯\nç°åœ¨æˆ‘ä»¬å·²ç»åˆæ­¥äº†è§£äº†libeventçš„Reactorç»„ä»¶â€”â€”event_baseå’Œäº‹ä»¶ç®¡ç†æ¡†æ¶ï¼Œæ¥ä¸‹æ¥å°±æ˜¯libeventäº‹ä»¶å¤„ç†çš„ä¸­å¿ƒéƒ¨åˆ†â€”â€”äº‹ä»¶ä¸»å¾ªç¯ï¼Œæ ¹æ®ç³»ç»Ÿæä¾›çš„äº‹ä»¶å¤šè·¯åˆ†å‘æœºåˆ¶æ‰§è¡Œäº‹ä»¶å¾ªç¯ï¼Œå¯¹å·²æ³¨å†Œçš„å°±ç»ªäº‹ä»¶ï¼Œè°ƒç”¨æ³¨å†Œäº‹ä»¶çš„å›è°ƒå‡½æ•°æ¥å¤„ç†äº‹ä»¶ã€‚\n1. é˜¶æ®µæ€§çš„èƒœåˆ©libeventå°†I&#x2F;Oäº‹ä»¶ã€å®šæ—¶å™¨å’Œä¿¡å·äº‹ä»¶å¤„ç†å¾ˆå¥½çš„ç»“åˆåˆ°äº†ä¸€èµ·ï¼Œæœ¬èŠ‚ä¹Ÿä¼šä»‹ç»libeventæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ã€‚åœ¨çœ‹å®Œæœ¬èŠ‚çš„å†…å®¹åï¼Œè¯»è€…åº”è¯¥ä¼šå¯¹Libeventçš„åŸºæœ¬æ¡†æ¶ï¼šäº‹ä»¶ç®¡ç†å’Œä¸»å¾ªç¯æœ‰æ¯”è¾ƒæ¸…æ™°çš„è®¤è¯†äº†ï¼Œå¹¶èƒ½å¤ŸæŠŠlibeventçš„äº‹ä»¶æ§åˆ¶æµç¨‹æ¸…æ™°çš„ä¸²é€šèµ·æ¥ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€äº›ç»†èŠ‚çš„å†…å®¹äº†ã€‚\n2. äº‹ä»¶å¤„ç†ä¸»å¾ªç¯libeventçš„äº‹ä»¶ä¸»å¾ªç¯ä¸»è¦æ˜¯é€šè¿‡event_base_loop ()å‡½æ•°å®Œæˆçš„ï¼Œå…¶ä¸»è¦æ“ä½œå¦‚ä¸‹é¢çš„æµç¨‹å›¾æ‰€ç¤ºï¼Œevent_base_loopæ‰€ä½œçš„å°±æ˜¯æŒç»­æ‰§è¡Œä¸‹é¢çš„å¾ªç¯ã€‚ \næ¸…æ¥šäº†event_base_loopæ‰€ä½œçš„ä¸»è¦æ“ä½œï¼Œå°±å¯ä»¥å¯¹æ¯”æºä»£ç çœ‹ä¸ªç©¶ç«Ÿäº†ï¼Œä»£ç ç»“æ„è¿˜æ˜¯ç›¸å½“æ¸…æ™°çš„ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869int event_base_loop(struct event_base *base, int flags)&#123;    const struct eventop *evsel = base-&gt;evsel;    void *evbase = base-&gt;evbase;    struct timeval tv;    struct timeval *tv_p;    int res, done;    // æ¸…ç©ºæ—¶é—´ç¼“å­˜    base-&gt;tv_cache.tv_sec = 0;    // evsignal_baseæ˜¯å…¨å±€å˜é‡ï¼Œåœ¨å¤„ç†signalæ—¶ï¼Œç”¨äºæŒ‡åsignalæ‰€å±çš„event_baseå®ä¾‹    if (base-&gt;sig.ev_signal_added)        evsignal_base = base;    done = 0;    while (!done) &#123; // äº‹ä»¶ä¸»å¾ªç¯        // æŸ¥çœ‹æ˜¯å¦éœ€è¦è·³å‡ºå¾ªç¯ï¼Œç¨‹åºå¯ä»¥è°ƒç”¨event_loopexit_cb()è®¾ç½®event_gottermæ ‡è®°        // è°ƒç”¨event_base_loopbreak()è®¾ç½®event_breakæ ‡è®°        if (base-&gt;event_gotterm) &#123;            base-&gt;event_gotterm = 0;            break;        &#125;        if (base-&gt;event_break) &#123;            base-&gt;event_break = 0;            break;        &#125;        // æ ¡æ­£ç³»ç»Ÿæ—¶é—´ï¼Œå¦‚æœç³»ç»Ÿä½¿ç”¨çš„æ˜¯éMONOTONICæ—¶é—´ï¼Œç”¨æˆ·å¯èƒ½ä¼šå‘åè°ƒæ•´äº†ç³»ç»Ÿæ—¶é—´        // åœ¨timeout_correctå‡½æ•°é‡Œï¼Œæ¯”è¾ƒlast wait timeå’Œå½“å‰æ—¶é—´ï¼Œå¦‚æœå½“å‰æ—¶é—´&lt; last wait time        // è¡¨æ˜æ—¶é—´æœ‰é—®é¢˜ï¼Œè¿™æ˜¯éœ€è¦æ›´æ–°timer_heapä¸­æ‰€æœ‰å®šæ—¶äº‹ä»¶çš„è¶…æ—¶æ—¶é—´ã€‚        timeout_correct(base, &amp;tv);        // æ ¹æ®timer heapä¸­äº‹ä»¶çš„æœ€å°è¶…æ—¶æ—¶é—´ï¼Œè®¡ç®—ç³»ç»ŸI/O demultiplexerçš„æœ€å¤§ç­‰å¾…æ—¶é—´        tv_p = &amp;tv;        if (!base-&gt;event_count_active &amp;&amp; !(flags &amp; EVLOOP_NONBLOCK)) &#123;            timeout_next(base, &amp;tv_p);        &#125; else &#123;            // ä¾ç„¶æœ‰æœªå¤„ç†çš„å°±ç»ªæ—¶é—´ï¼Œå°±è®©I/O demultiplexerç«‹å³è¿”å›ï¼Œä¸å¿…ç­‰å¾…            // ä¸‹é¢ä¼šæåˆ°ï¼Œåœ¨libeventä¸­ï¼Œä½ä¼˜å…ˆçº§çš„å°±ç»ªäº‹ä»¶å¯èƒ½ä¸èƒ½ç«‹å³è¢«å¤„ç†            evutil_timerclear(&amp;tv);        &#125;        // å¦‚æœå½“å‰æ²¡æœ‰æ³¨å†Œäº‹ä»¶ï¼Œå°±é€€å‡º        if (!event_haveevents(base)) &#123;            event_debug((&quot;%s: no events registered.&quot;, __func__));            return (1);        &#125;        // æ›´æ–°last wait timeï¼Œå¹¶æ¸…ç©ºtime cache        gettime(base, &amp;base-&gt;event_tv);        base-&gt;tv_cache.tv_sec = 0;        // è°ƒç”¨ç³»ç»ŸI/O demultiplexerç­‰å¾…å°±ç»ªI/O eventsï¼Œå¯èƒ½æ˜¯epoll_waitï¼Œæˆ–è€…selectç­‰ï¼›        // åœ¨evsel-&gt;dispatch()ä¸­ï¼Œä¼šæŠŠå°±ç»ªsignal eventã€I/O eventæ’å…¥åˆ°æ¿€æ´»é“¾è¡¨ä¸­        res = evsel-&gt;dispatch(base, evbase, tv_p);        if (res == -1)            return (-1);        // å°†time cacheèµ‹å€¼ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´        gettime(base, &amp;base-&gt;tv_cache);        // æ£€æŸ¥heapä¸­çš„timer eventsï¼Œå°†å°±ç»ªçš„timer eventä»heapä¸Šåˆ é™¤ï¼Œå¹¶æ’å…¥åˆ°æ¿€æ´»é“¾è¡¨ä¸­        timeout_process(base);        // è°ƒç”¨event_process_active()å¤„ç†æ¿€æ´»é“¾è¡¨ä¸­çš„å°±ç»ªeventï¼Œè°ƒç”¨å…¶å›è°ƒå‡½æ•°æ‰§è¡Œäº‹ä»¶å¤„ç†        // è¯¥å‡½æ•°ä¼šå¯»æ‰¾æœ€é«˜ä¼˜å…ˆçº§ï¼ˆpriorityå€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰çš„æ¿€æ´»äº‹ä»¶é“¾è¡¨ï¼Œ        // ç„¶åå¤„ç†é“¾è¡¨ä¸­çš„æ‰€æœ‰å°±ç»ªäº‹ä»¶ï¼›        // å› æ­¤ä½ä¼˜å…ˆçº§çš„å°±ç»ªäº‹ä»¶å¯èƒ½å¾—ä¸åˆ°åŠæ—¶å¤„ç†ï¼›        if (base-&gt;event_count_active) &#123;            event_process_active(base);            if (!base-&gt;event_count_active &amp;&amp; (flags &amp; EVLOOP_ONCE))                done = 1;        &#125; else if (flags &amp; EVLOOP_NONBLOCK)            done = 1;    &#125;    // å¾ªç¯ç»“æŸï¼Œæ¸…ç©ºæ—¶é—´ç¼“å­˜    base-&gt;tv_cache.tv_sec = 0;    event_debug((&quot;%s: asked to terminate loop.&quot;, __func__));    return (0);&#125;\n\n\n\n3. I&#x2F;Oå’ŒTimeräº‹ä»¶çš„ç»Ÿä¸€libeventå°†Timerå’ŒSignaläº‹ä»¶éƒ½ç»Ÿä¸€åˆ°äº†ç³»ç»Ÿçš„I&#x2F;O çš„demultiplexæœºåˆ¶ä¸­äº†ï¼Œç›¸ä¿¡è¯»è€…ä»ä¸Šé¢çš„æµç¨‹å’Œä»£ç ä¸­ä¹Ÿèƒ½çª¥å‡ºä¸€æ–‘äº†ï¼Œä¸‹é¢å°±å†å•°å—¦ä¸€æ¬¡äº†ã€‚é¦–å…ˆå°†Timeräº‹ä»¶èåˆåˆ°ç³»ç»ŸI&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶ä¸­ï¼Œè¿˜æ˜¯ç›¸å½“æ¸…æ™°çš„ï¼Œå› ä¸ºç³»ç»Ÿçš„I&#x2F;Oæœºåˆ¶åƒselect()å’Œepoll_wait()éƒ½å…è®¸ç¨‹åºåˆ¶å®šä¸€ä¸ªæœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆä¹Ÿç§°ä¸ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼‰timeoutï¼Œå³ä½¿æ²¡æœ‰I&#x2F;Oäº‹ä»¶å‘ç”Ÿï¼Œå®ƒä»¬ä¹Ÿä¿è¯èƒ½åœ¨timeoutæ—¶é—´å†…è¿”å›ã€‚é‚£ä¹ˆæ ¹æ®æ‰€æœ‰Timeräº‹ä»¶çš„æœ€å°è¶…æ—¶æ—¶é—´æ¥è®¾ç½®ç³»ç»ŸI&#x2F;Oçš„timeoutæ—¶é—´ï¼›å½“ç³»ç»ŸI&#x2F;Oè¿”å›æ—¶ï¼Œå†æ¿€æ´»æ‰€æœ‰å°±ç»ªçš„Timeräº‹ä»¶å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±èƒ½å°†Timeräº‹ä»¶å®Œç¾çš„èåˆåˆ°ç³»ç»Ÿçš„I&#x2F;Oæœºåˆ¶ä¸­äº†ã€‚è¿™æ˜¯åœ¨Reactorå’ŒProactoræ¨¡å¼ï¼ˆä¸»åŠ¨å™¨æ¨¡å¼ï¼Œæ¯”å¦‚Windowsä¸Šçš„IOCPï¼‰ä¸­å¤„ç†Timeräº‹ä»¶çš„ç»å…¸æ–¹æ³•äº†ï¼ŒACEé‡‡ç”¨çš„ä¹Ÿæ˜¯è¿™ç§æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒPOSA vol2ä¹¦ä¸­çš„Reactoræ¨¡å¼ä¸€èŠ‚ã€‚å †æ˜¯ä¸€ç§ç»å…¸çš„æ•°æ®ç»“æ„ï¼Œå‘å †ä¸­æ’å…¥ã€åˆ é™¤å…ƒç´ æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(lgN)ï¼ŒNä¸ºå †ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œè€Œè·å–æœ€å°keyå€¼ï¼ˆå°æ ¹å †ï¼‰çš„å¤æ‚åº¦ä¸ºO(1)ï¼›å› æ­¤å˜æˆäº†ç®¡ç†Timeräº‹ä»¶çš„ç»ä½³äººé€‰ï¼ˆå½“ç„¶æ˜¯éå”¯ä¸€çš„ï¼‰ï¼Œlibeventå°±æ˜¯é‡‡ç”¨çš„å †ç»“æ„ã€‚\n4. I&#x2F;Oå’ŒSignaläº‹ä»¶çš„ç»Ÿä¸€Signalæ˜¯å¼‚æ­¥äº‹ä»¶çš„ç»å…¸äº‹ä¾‹ï¼Œå°†Signaläº‹ä»¶ç»Ÿä¸€åˆ°ç³»ç»Ÿçš„I&#x2F;Oå¤šè·¯å¤ç”¨ä¸­å°±ä¸åƒTimeräº‹ä»¶é‚£ä¹ˆè‡ªç„¶äº†ï¼ŒSignaläº‹ä»¶çš„å‡ºç°å¯¹äºè¿›ç¨‹æ¥è®²æ˜¯å®Œå…¨éšæœºçš„ï¼Œè¿›ç¨‹ä¸èƒ½åªæ˜¯æµ‹è¯•ä¸€ä¸ªå˜é‡æ¥åˆ¤åˆ«æ˜¯å¦å‘ç”Ÿäº†ä¸€ä¸ªä¿¡å·ï¼Œè€Œæ˜¯å¿…é¡»å‘Šè¯‰å†…æ ¸â€œåœ¨æ­¤ä¿¡å·å‘ç”Ÿæ—¶ï¼Œè¯·æ‰§è¡Œå¦‚ä¸‹çš„æ“ä½œâ€ã€‚å¦‚æœå½“Signalå‘ç”Ÿæ—¶ï¼Œå¹¶ä¸ç«‹å³è°ƒç”¨eventçš„callbackå‡½æ•°å¤„ç†ä¿¡å·ï¼Œè€Œæ˜¯è®¾æ³•é€šçŸ¥ç³»ç»Ÿçš„I&#x2F;Oæœºåˆ¶ï¼Œè®©å…¶è¿”å›ï¼Œç„¶åå†ç»Ÿä¸€å’ŒI&#x2F;Oäº‹ä»¶ä»¥åŠTimerä¸€èµ·å¤„ç†ï¼Œä¸å°±å¯ä»¥äº†å˜›ã€‚æ˜¯çš„ï¼Œè¿™ä¹Ÿæ˜¯libeventä¸­ä½¿ç”¨çš„æ–¹æ³•ã€‚é—®é¢˜çš„æ ¸å¿ƒåœ¨äºï¼Œå½“Signalå‘ç”Ÿæ—¶ï¼Œå¦‚ä½•é€šçŸ¥ç³»ç»Ÿçš„I&#x2F;Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œè¿™é‡Œå…ˆä¹°ä¸ªå°å…³å­ï¼Œæ”¾åˆ°ä¿¡å·å¤„ç†ä¸€èŠ‚å†è¯¦ç»†è¯´æ˜ï¼Œæˆ‘æƒ³è¯»è€…è‚¯å®šä¹Ÿèƒ½æƒ³å‡ºé€šçŸ¥çš„æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨pipeã€‚\n5 å°èŠ‚ä»‹ç»äº†libeventçš„äº‹ä»¶ä¸»å¾ªç¯ï¼Œæè¿°äº†libeventæ˜¯å¦‚ä½•å¤„ç†å°±ç»ªçš„I&#x2F;Oäº‹ä»¶ã€å®šæ—¶å™¨å’Œä¿¡å·äº‹ä»¶ï¼Œä»¥åŠå¦‚ä½•å°†å®ƒä»¬æ— ç¼çš„èåˆåˆ°ä¸€èµ·ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ07","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c96eddcf717cad02fc0a6f9698a4cec4","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ08","content":"libeventæºç æ·±åº¦å‰–æ08é›†æˆä¿¡å·å¤„ç†\nç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†libeventçš„åŸºæœ¬æ¡†æ¶ï¼šäº‹ä»¶ç®¡ç†æ¡†æ¶å’Œäº‹ä»¶ä¸»å¾ªç¯ã€‚ä¸ŠèŠ‚æåˆ°äº†libeventä¸­I&#x2F;Oäº‹ä»¶å’ŒSignalä»¥åŠTimeräº‹ä»¶çš„é›†æˆï¼Œè¿™ä¸€èŠ‚å°†åˆ†æå¦‚ä½•å°†Signalé›†æˆåˆ°äº‹ä»¶ä¸»å¾ªç¯çš„æ¡†æ¶ä¸­ã€‚\n1. é›†æˆç­–ç•¥â€”â€”ä½¿ç”¨socket pairå‰ä¸€èŠ‚å·²ç»åšäº†è¶³å¤Ÿå¤šçš„ä»‹ç»äº†ï¼ŒåŸºæœ¬æ–¹æ³•å°±æ˜¯é‡‡ç”¨â€œæ¶ˆæ¯æœºåˆ¶â€ã€‚åœ¨libeventä¸­è¿™æ˜¯é€šè¿‡socket pairå®Œæˆçš„ï¼Œä¸‹é¢å°±æ¥è¯¦ç»†åˆ†æä¸€ä¸‹ã€‚Socket pairå°±æ˜¯ä¸€ä¸ªsocketå¯¹ï¼ŒåŒ…å«ä¸¤ä¸ªsocketï¼Œä¸€ä¸ªè¯»socketï¼Œä¸€ä¸ªå†™socketã€‚å·¥ä½œæ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n \nåˆ›å»ºä¸€ä¸ªsocket pairå¹¶ä¸æ˜¯å¤æ‚çš„æ“ä½œï¼Œå¯ä»¥å‚è§ä¸‹é¢çš„æµç¨‹å›¾ï¼Œæ¸…æ™°èµ·è§ï¼Œå…¶ä¸­å¿½ç•¥äº†ä¸€äº›é”™è¯¯å¤„ç†å’Œæ£€æŸ¥ã€‚\n\nLibeventæä¾›äº†è¾…åŠ©å‡½æ•°evutil_socketpair()æ¥åˆ›å»ºä¸€ä¸ªsocket pairï¼Œå¯ä»¥ç»“åˆä¸Šé¢çš„åˆ›å»ºæµç¨‹æ¥åˆ†æè¯¥å‡½æ•°ã€‚\n2. é›†æˆåˆ°äº‹ä»¶ä¸»å¾ªç¯â€”â€”é€šçŸ¥event_baseSocket pairåˆ›å»ºå¥½äº†ï¼Œå¯æ˜¯libeventçš„äº‹ä»¶ä¸»å¾ªç¯è¿˜æ˜¯ä¸çŸ¥é“Signalæ˜¯å¦å‘ç”Ÿäº†å•Šï¼Œçœ‹æ¥æˆ‘ä»¬è¿˜å·®äº†æœ€åä¸€æ­¥ï¼Œé‚£å°±æ˜¯ï¼šä¸ºsocket pairçš„è¯»socketåœ¨libeventçš„event_baseå®ä¾‹ä¸Šæ³¨å†Œä¸€ä¸ªpersistçš„è¯»äº‹ä»¶ã€‚è¿™æ ·å½“å‘å†™socketå†™å…¥æ•°æ®æ—¶ï¼Œè¯»socketå°±ä¼šå¾—åˆ°é€šçŸ¥ï¼Œè§¦å‘è¯»äº‹ä»¶ï¼Œä»è€Œevent_baseå°±èƒ½ç›¸åº”çš„å¾—åˆ°é€šçŸ¥äº†ã€‚å‰é¢æåˆ°è¿‡ï¼ŒLibeventä¼šåœ¨äº‹ä»¶ä¸»å¾ªç¯ä¸­æ£€æŸ¥æ ‡è®°ï¼Œæ¥ç¡®å®šæ˜¯å¦æœ‰è§¦å‘çš„signalï¼Œå¦‚æœæ ‡è®°è¢«è®¾ç½®å°±å¤„ç†è¿™äº›signalï¼Œè¿™æ®µä»£ç åœ¨å„ä¸ªå…·ä½“çš„I&#x2F;Oæœºåˆ¶ä¸­ï¼Œä»¥Epollä¸ºä¾‹ï¼Œåœ¨**epoll_dispatch()**å‡½æ•°ä¸­ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š\n1234567891011res = epoll_wait(epollop-&gt;epfd, events, epollop-&gt;nevents, timeout);    if (res == -1) &#123;        if (errno != EINTR) &#123;            event_warn(&quot;epoll_wait&quot;);            return (-1);        &#125;        evsignal_process(base);// å¤„ç†signaläº‹ä»¶        return (0);    &#125; else if (base-&gt;sig.evsignal_caught) &#123;        evsignal_process(base);// å¤„ç†signaläº‹ä»¶&#125;\n\nå®Œæ•´çš„å¤„ç†æ¡†æ¶å¦‚ä¸‹æ‰€ç¤ºï¼š\n\næ³¨1ï¼šlibeventä¸­ï¼Œåˆå§‹åŒ–é˜¶æ®µå¹¶ä¸æ³¨å†Œè¯»socketçš„è¯»äº‹ä»¶ï¼Œè€Œæ˜¯åœ¨æ³¨å†Œä¿¡å·é˜¶æ®µæ‰ä¼šæµ‹è¯•å¹¶æ³¨å†Œï¼›æ³¨2ï¼šlibeventä¸­ï¼Œæ£€æŸ¥I&#x2F;Oäº‹ä»¶æ˜¯åœ¨å„ç³»ç»ŸI&#x2F;Oæœºåˆ¶çš„**dispatch()å‡½æ•°ä¸­å®Œæˆçš„ï¼Œè¯¥dispatch()å‡½æ•°åœ¨event_base_loop()**å‡½æ•°ä¸­è¢«è°ƒç”¨ï¼›\n3. evsignal_infoç»“æ„ä½“libeventä¸­Signaläº‹ä»¶çš„ç®¡ç†æ˜¯é€šè¿‡ç»“æ„ä½“evsignal_infoå®Œæˆçš„ï¼Œç»“æ„ä½“ä½äºevsignal.hæ–‡ä»¶ä¸­ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š\n1234567891011121314struct evsignal_info &#123;    struct event ev_signal;    int ev_signal_pair[2];    int ev_signal_added;    volatile sig_atomic_t evsignal_caught;    struct event_list evsigevents[NSIG];    sig_atomic_t evsigcaught[NSIG];#ifdef HAVE_SIGACTION    struct sigaction **sh_old;#else    ev_sighandler_t **sh_old;#endif    int sh_old_max;&#125;;\n\nä¸‹é¢è¯¦ç»†ä»‹ç»ä¸€ä¸‹ä¸ªå­—æ®µçš„å«ä¹‰å’Œä½œç”¨ï¼š1ï¼‰ev_signalï¼Œ ä¸ºsocket pairçš„è¯»socketå‘event_baseæ³¨å†Œè¯»äº‹ä»¶æ—¶ä½¿ç”¨çš„eventç»“æ„ä½“ï¼›2ï¼‰ev_signal_pairï¼Œsocket pairå¯¹ï¼Œä½œç”¨è§ç¬¬ä¸€èŠ‚çš„ä»‹ç»ï¼›3ï¼‰ev_signal_addedï¼Œè®°å½•ev_signaläº‹ä»¶æ˜¯å¦å·²ç»æ³¨å†Œäº†ï¼›4ï¼‰evsignal_caughtï¼Œæ˜¯å¦æœ‰ä¿¡å·å‘ç”Ÿçš„æ ‡è®°ï¼›æ˜¯volatileç±»å‹ï¼Œå› ä¸ºå®ƒä¼šåœ¨å¦å¤–çš„çº¿ç¨‹ä¸­è¢«ä¿®æ”¹ï¼›5ï¼‰evsigvents[NSIG]ï¼Œæ•°ç»„ï¼Œevsigevents[signo]è¡¨ç¤ºæ³¨å†Œåˆ°ä¿¡å·signoçš„äº‹ä»¶é“¾è¡¨ï¼›6ï¼‰evsigcaught[NSIG]ï¼Œå…·ä½“è®°å½•æ¯ä¸ªä¿¡å·è§¦å‘çš„æ¬¡æ•°ï¼Œevsigcaught[signo]æ˜¯è®°å½•ä¿¡å·signoè¢«è§¦å‘çš„æ¬¡æ•°ï¼›7ï¼‰sh_oldè®°å½•äº†åŸæ¥çš„signalå¤„ç†å‡½æ•°æŒ‡é’ˆï¼Œå½“ä¿¡å·signoæ³¨å†Œçš„eventè¢«æ¸…ç©ºæ—¶ï¼Œéœ€è¦é‡æ–°è®¾ç½®å…¶å¤„ç†å‡½æ•°ï¼›evsignal_infoçš„åˆå§‹åŒ–åŒ…æ‹¬ï¼Œåˆ›å»ºsocket pairï¼Œè®¾ç½®ev_signaläº‹ä»¶ï¼ˆä½†å¹¶æ²¡æœ‰æ³¨å†Œï¼Œè€Œæ˜¯ç­‰åˆ°æœ‰ä¿¡å·æ³¨å†Œæ—¶æ‰æ£€æŸ¥å¹¶æ³¨å†Œï¼‰ï¼Œå¹¶å°†æ‰€æœ‰æ ‡è®°ç½®é›¶ï¼Œåˆå§‹åŒ–ä¿¡å·çš„æ³¨å†Œäº‹ä»¶é“¾è¡¨æŒ‡é’ˆç­‰ã€‚\n4. æ³¨å†Œã€æ³¨é”€signaläº‹ä»¶æ³¨å†Œsignaläº‹ä»¶æ˜¯é€šè¿‡evsignal_add(struct event *ev)å‡½æ•°å®Œæˆçš„ï¼Œlibeventå¯¹æ‰€æœ‰çš„ä¿¡å·æ³¨å†ŒåŒä¸€ä¸ªå¤„ç†å‡½æ•°evsignal_handler()ï¼Œè¯¥å‡½æ•°å°†åœ¨ä¸‹ä¸€æ®µä»‹ç»ï¼Œæ³¨å†Œè¿‡ç¨‹å¦‚ä¸‹ï¼š1 å–å¾—evè¦æ³¨å†Œåˆ°çš„ä¿¡å·signoï¼›2 å¦‚æœä¿¡å·signoæœªè¢«æ³¨å†Œï¼Œé‚£ä¹ˆå°±ä¸ºsignoæ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°evsignal_handler()ï¼›3 å¦‚æœäº‹ä»¶ev_signalè¿˜æ²¡å“Ÿæ³¨å†Œï¼Œå°±æ³¨å†Œev_signaläº‹ä»¶ï¼›4 å°†äº‹ä»¶evæ·»åŠ åˆ°signoçš„eventé“¾è¡¨ä¸­ï¼›ä»signoä¸Šæ³¨é”€ä¸€ä¸ªå·²æ³¨å†Œçš„signaläº‹ä»¶å°±æ›´ç®€å•äº†ï¼Œç›´æ¥ä»å…¶å·²æ³¨å†Œäº‹ä»¶çš„é“¾è¡¨ä¸­ç§»é™¤å³å¯ã€‚å¦‚æœäº‹ä»¶é“¾è¡¨å·²ç©ºï¼Œé‚£ä¹ˆå°±æ¢å¤æ—§çš„å¤„ç†å‡½æ•°ï¼›ä¸‹é¢çš„è®²è§£éƒ½ä»¥signal()å‡½æ•°ä¸ºä¾‹ï¼Œsigaction()å‡½æ•°çš„å¤„ç†å’Œsignal()ç›¸ä¼¼ã€‚å¤„ç†å‡½æ•°evsignal_handler()å‡½æ•°åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œå°±æ˜¯è®°å½•ä¿¡å·çš„å‘ç”Ÿæ¬¡æ•°ï¼Œå¹¶é€šçŸ¥event_baseæœ‰ä¿¡å·è§¦å‘ï¼Œéœ€è¦å¤„ç†ï¼š\n12345678910111213141516static void evsignal_handler(int sig)&#123;    int save_errno = errno; // ä¸è¦†ç›–åŸæ¥çš„é”™è¯¯ä»£ç     if (evsignal_base == NULL) &#123;        event_warn(&quot;%s: received signal %d, but have no base configured&quot;, __func__, sig);        return;    &#125;    // è®°å½•ä¿¡å·sigçš„è§¦å‘æ¬¡æ•°ï¼Œå¹¶è®¾ç½®eventè§¦å‘æ ‡è®°    evsignal_base-&gt;sig.evsigcaught[sig]++;    evsignal_base-&gt;sig.evsignal_caught = 1;#ifndef HAVE_SIGACTION    signal(sig, evsignal_handler); // é‡æ–°æ³¨å†Œä¿¡å·#endif    // å‘å†™socketå†™ä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼Œè§¦å‘event_baseçš„I/Oäº‹ä»¶ï¼Œä»è€Œé€šçŸ¥å…¶æœ‰ä¿¡å·è§¦å‘ï¼Œéœ€è¦å¤„ç†    send(evsignal_base-&gt;sig.ev_signal_pair[0], &quot;a&quot;, 1, 0);    errno = save_errno; // é”™è¯¯ä»£ç &#125;\n\n\n\n5. å°èŠ‚æœ¬èŠ‚ä»‹ç»äº†libeventå¯¹signaläº‹ä»¶çš„å…·ä½“å¤„ç†æ¡†æ¶ï¼ŒåŒ…æ‹¬äº‹ä»¶æ³¨å†Œã€åˆ é™¤å’Œsocket pairé€šçŸ¥æœºåˆ¶ï¼Œä»¥åŠæ˜¯å¦‚ä½•å°†Signaläº‹ä»¶é›†æˆåˆ°äº‹ä»¶ä¸»å¾ªç¯ä¹‹ä¸­çš„ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ08","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3ac2d154bc8f115a96c543f8b70be68b","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ09","content":"libeventæºç æ·±åº¦å‰–æ09é›†æˆå®šæ—¶å™¨äº‹ä»¶\nç°åœ¨å†æ¥è¯¦ç»†åˆ†ælibeventä¸­I&#x2F;Oäº‹ä»¶å’ŒTimeräº‹ä»¶çš„é›†æˆï¼Œä¸Signalç›¸æ¯”ï¼ŒTimeräº‹ä»¶çš„é›†æˆä¼šç›´è§‚å’Œç®€å•å¾ˆå¤šã€‚Libeventå¯¹å †çš„è°ƒæ•´æ“ä½œåšäº†ä¸€äº›ä¼˜åŒ–ï¼Œæœ¬èŠ‚è¿˜ä¼šæè¿°è¿™äº›ä¼˜åŒ–æ–¹æ³•ã€‚\n1. é›†æˆåˆ°äº‹ä»¶ä¸»å¾ªç¯å› ä¸ºç³»ç»Ÿçš„I&#x2F;Oæœºåˆ¶åƒselect()å’Œepoll_wait()éƒ½å…è®¸ç¨‹åºåˆ¶å®šä¸€ä¸ªæœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆä¹Ÿç§°ä¸ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼‰timeoutï¼Œå³ä½¿æ²¡æœ‰I&#x2F;Oäº‹ä»¶å‘ç”Ÿï¼Œå®ƒä»¬ä¹Ÿä¿è¯èƒ½åœ¨timeoutæ—¶é—´å†…è¿”å›ã€‚é‚£ä¹ˆæ ¹æ®æ‰€æœ‰Timeräº‹ä»¶çš„æœ€å°è¶…æ—¶æ—¶é—´æ¥è®¾ç½®ç³»ç»ŸI&#x2F;Oçš„timeoutæ—¶é—´ï¼›å½“ç³»ç»ŸI&#x2F;Oè¿”å›æ—¶ï¼Œå†æ¿€æ´»æ‰€æœ‰å°±ç»ªçš„Timeräº‹ä»¶å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±èƒ½å°†Timeräº‹ä»¶å®Œç¾çš„èåˆåˆ°ç³»ç»Ÿçš„I&#x2F;Oæœºåˆ¶ä¸­äº†ã€‚å…·ä½“çš„ä»£ç åœ¨æºæ–‡ä»¶event.cçš„**event_base_loop()**ä¸­ï¼Œç°åœ¨å°±å¯¹æ¯”ä»£ç æ¥çœ‹çœ‹è¿™ä¸€å¤„ç†æ–¹æ³•ï¼š\n12345678910111213if (!base-&gt;event_count_active &amp;&amp; !(flags &amp; EVLOOP_NONBLOCK)) &#123;          // æ ¹æ®Timeräº‹ä»¶è®¡ç®—evsel-&gt;dispatchçš„æœ€å¤§ç­‰å¾…æ—¶é—´          timeout_next(base, &amp;tv_p);      &#125; else &#123;           // å¦‚æœè¿˜æœ‰æ´»åŠ¨äº‹ä»¶ï¼Œå°±ä¸è¦ç­‰å¾…ï¼Œè®©evsel-&gt;dispatchç«‹å³è¿”å›          evutil_timerclear(&amp;tv);      &#125;      // ...      // è°ƒç”¨select() or epoll_wait() ç­‰å¾…å°±ç»ªI/Oäº‹ä»¶      res = evsel-&gt;dispatch(base, evbase, tv_p);      // ...      // å¤„ç†è¶…æ—¶äº‹ä»¶ï¼Œå°†è¶…æ—¶äº‹ä»¶æ’å…¥åˆ°æ¿€æ´»é“¾è¡¨ä¸­      timeout_process(base);\n\n**timeout_next()**å‡½æ•°æ ¹æ®å †ä¸­å…·æœ‰æœ€å°è¶…æ—¶å€¼çš„äº‹ä»¶å’Œå½“å‰æ—¶é—´æ¥è®¡ç®—ç­‰å¾…æ—¶é—´ï¼Œä¸‹é¢çœ‹çœ‹ä»£ç ï¼š\n123456789101112131415161718192021 1static int timeout_next(struct event_base *base, struct timeval **tv_p)&#123; 2    struct timeval now; 3    struct event *ev; 4    struct timeval *tv = *tv_p; 5    // å †çš„é¦–å…ƒç´ å…·æœ‰æœ€å°çš„è¶…æ—¶å€¼ 6    if ((ev = min_heap_top(&amp;base-&gt;timeheap)) == NULL) &#123; 7        // å¦‚æœæ²¡æœ‰å®šæ—¶äº‹ä»¶ï¼Œå°†ç­‰å¾…æ—¶é—´è®¾ç½®ä¸ºNULL,è¡¨ç¤ºä¸€ç›´é˜»å¡ç›´åˆ°æœ‰I/Oäº‹ä»¶å‘ç”Ÿ 8        *tv_p = NULL; 9        return (0);10    &#125;11    // å–å¾—å½“å‰æ—¶é—´12    gettime(base, &amp;now);13    // å¦‚æœè¶…æ—¶æ—¶é—´&lt;=å½“å‰å€¼ï¼Œä¸èƒ½ç­‰å¾…ï¼Œéœ€è¦ç«‹å³è¿”å›14    if (evutil_timercmp(&amp;ev-&gt;ev_timeout, &amp;now, &lt;=)) &#123;15        evutil_timerclear(tv);16        return (0);17    &#125;18    // è®¡ç®—ç­‰å¾…çš„æ—¶é—´=å½“å‰æ—¶é—´-æœ€å°çš„è¶…æ—¶æ—¶é—´19    evutil_timersub(&amp;ev-&gt;ev_timeout, &amp;now, tv);20    return (0);21&#125;\n\n\n\n2. Timerå°æ ¹å †libeventä½¿ç”¨å †æ¥ç®¡ç†Timeräº‹ä»¶ï¼Œå…¶keyå€¼å°±æ˜¯äº‹ä»¶çš„è¶…æ—¶æ—¶é—´ï¼Œæºä»£ç ä½äºæ–‡ä»¶min_heap.hä¸­ã€‚æ‰€æœ‰çš„æ•°æ®ç»“æ„ä¹¦ä¸­éƒ½æœ‰å…³äºå †çš„è¯¦ç»†ä»‹ç»ï¼Œå‘å †ä¸­æ’å…¥ã€åˆ é™¤å…ƒç´ æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(lgN)ï¼ŒNä¸ºå †ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œè€Œè·å–æœ€å°keyå€¼ï¼ˆå°æ ¹å †ï¼‰çš„å¤æ‚åº¦ä¸ºO(1)ã€‚å †æ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼ŒåŸºæœ¬å­˜å‚¨æ–¹å¼æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚libeventå®ç°çš„å †è¿˜æ˜¯æ¯”è¾ƒè½»å·§çš„ï¼Œè™½ç„¶æˆ‘ä¸å–œæ¬¢è¿™ç§ç¼–ç æ–¹å¼ï¼ˆæä¸€äº›å¤æ‚çš„è¡¨è¾¾å¼ï¼‰ã€‚è½»å·§åˆ°ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Œå°±ä»¥æ’å…¥å…ƒç´ ä¸ºä¾‹ï¼Œæ¥å¯¹æ¯”è¯´æ˜ï¼Œä¸‹é¢ä¼ªä»£ç ä¸­çš„sizeè¡¨ç¤ºå½“å‰å †çš„å…ƒç´ ä¸ªæ•°ï¼š\nå…¸å‹çš„ä»£ç é€»è¾‘å¦‚ä¸‹ï¼š\n12345678910Heap[size++] = new; // å…ˆæ”¾åˆ°æ•°ç»„æœ«å°¾ï¼Œå…ƒç´ ä¸ªæ•°+1// ä¸‹é¢å°±æ˜¯shift_up()çš„ä»£ç é€»è¾‘ï¼Œä¸æ–­çš„å°†newå‘ä¸Šè°ƒæ•´_child = size;while(_child&gt;0) // å¾ªç¯&#123;    _parent = (_child-1)/2; // è®¡ç®—parent    if(Heap[_parent].key &lt; Heap[_child].key)    \tbreak; // è°ƒæ•´ç»“æŸï¼Œè·³å‡ºå¾ªç¯    swap(_parent, _child); // äº¤æ¢parentå’Œchild&#125;\n\nè€Œlibeventçš„heapä»£ç å¯¹è¿™ä¸€è¿‡ç¨‹åšäº†ä¼˜åŒ–ï¼Œåœ¨æ’å…¥æ–°å…ƒç´ æ—¶ï¼Œåªæ˜¯ä¸ºæ–°å…ƒç´ é¢„ç•™äº†ä¸€ä¸ªä½ç½®holeï¼ˆåˆå§‹æ—¶holeä½äºæ•°ç»„å°¾éƒ¨ï¼‰ï¼Œä½†å¹¶ä¸ç«‹åˆ»å°†æ–°å…ƒç´ æ’å…¥åˆ°holeä¸Šï¼Œè€Œæ˜¯ä¸æ–­å‘ä¸Šè°ƒæ•´holeçš„å€¼ï¼Œå°†çˆ¶èŠ‚ç‚¹å‘ä¸‹è°ƒæ•´ï¼Œæœ€åç¡®è®¤holeå°±æ˜¯æ–°å…ƒç´ çš„æ‰€åœ¨ä½ç½®æ—¶ï¼Œæ‰ä¼šçœŸæ­£çš„å°†æ–°å…ƒç´ æ’å…¥åˆ°holeä¸Šï¼Œå› æ­¤åœ¨è°ƒæ•´è¿‡ç¨‹ä¸­å°±æ¯”ä¸Šé¢çš„ä»£ç å°‘äº†ä¸€æ¬¡èµ‹å€¼çš„æ“ä½œï¼Œä»£ç é€»è¾‘æ˜¯ï¼š\n123456789101112// ä¸‹é¢å°±æ˜¯shift_up()çš„ä»£ç é€»è¾‘ï¼Œä¸æ–­çš„å°†newçš„â€œé¢„ç•™ä½ç½®â€å‘ä¸Šè°ƒæ•´_hole = size; // _holeå°±æ˜¯ä¸ºnewé¢„ç•™çš„ä½ç½®ï¼Œä½†å¹¶ä¸ç«‹åˆ»å°†newæ”¾ä¸Šwhile(_hole&gt;0) // å¾ªç¯&#123;    _parent = (_hole-1)/2; // è®¡ç®—parent    if(Heap[_parent].key &lt; new.key)        break; // è°ƒæ•´ç»“æŸï¼Œè·³å‡ºå¾ªç¯    Heap[_hole] = Heap[_parent]; // å°†parentå‘ä¸‹è°ƒæ•´    _hole = _parent; // å°†_holeè°ƒæ•´åˆ°_parent&#125;Heap[_hole] = new; // è°ƒæ•´ç»“æŸï¼Œå°†newæ’å…¥åˆ°_holeæŒ‡ç¤ºçš„ä½ç½®size++; // å…ƒç´ ä¸ªæ•°+1\n\nç”±äºæ¯æ¬¡è°ƒæ•´éƒ½å°‘åšä¸€æ¬¡èµ‹å€¼æ“ä½œï¼Œåœ¨è°ƒæ•´è·¯å¾„æ¯”è¾ƒé•¿æ—¶ï¼Œè°ƒæ•´æ•ˆç‡ä¼šæ¯”ç¬¬ä¸€ç§æœ‰æ‰€æé«˜ã€‚libeventä¸­çš„**min_heap_shift_up_()å‡½æ•°å°±æ˜¯ä¸Šé¢é€»è¾‘çš„å…·ä½“å®ç°ï¼Œå¯¹åº”çš„å‘ä¸‹è°ƒæ•´å‡½æ•°æ˜¯min_heap_shift_down_()**ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå‘ä¸€ä¸ªå°æ ¹å †3, 5, 8, 7, 12ä¸­æ’å…¥æ–°å…ƒç´ 2ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸­å…¸å‹çš„ä»£ç é€»è¾‘ï¼Œå…¶è°ƒæ•´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nä½¿ç”¨libeventä¸­çš„å †è°ƒæ•´é€»è¾‘ï¼Œè°ƒæ•´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nå¯¹äºåˆ é™¤å’Œå…ƒç´ ä¿®æ”¹æ“ä½œï¼Œä¹Ÿéµä»ç›¸åŒçš„é€»è¾‘ï¼Œå°±ä¸å†ç½—å—¦äº†ã€‚\n3. å°èŠ‚é€šè¿‡è®¾ç½®ç³»ç»ŸI&#x2F;Oæœºåˆ¶çš„waitæ—¶é—´ï¼Œä»è€Œç®€æ´çš„é›†æˆTimeräº‹ä»¶ï¼›ä¸»è¦åˆ†æäº†libeventå¯¹å †è°ƒæ•´æ“ä½œçš„ä¼˜åŒ–ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ09","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"7d0768b2cfc1e99a9f8dcf0642553217","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ10","content":"libeventæºç æ·±åº¦å‰–æ10æ”¯æŒI&#x2F;Oå¤šè·¯å¤ç”¨æŠ€æœ¯\nlibeventçš„æ ¸å¿ƒæ˜¯äº‹ä»¶é©±åŠ¨ã€åŒæ­¥éé˜»å¡ï¼Œä¸ºäº†è¾¾åˆ°è¿™ä¸€ç›®æ ‡ï¼Œå¿…é¡»é‡‡ç”¨ç³»ç»Ÿæä¾›çš„I&#x2F;Oå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œè€Œè¿™äº›åœ¨Windowsã€Linuxã€Unixç­‰ä¸åŒå¹³å°ä¸Šå´å„æœ‰ä¸åŒï¼Œå¦‚ä½•èƒ½æä¾›ä¼˜é›…è€Œç»Ÿä¸€çš„æ”¯æŒæ–¹å¼ï¼Œæ˜¯é¦–è¦å…³é”®çš„é—®é¢˜ï¼Œè¿™å…¶å®ä¸éš¾ï¼Œæœ¬èŠ‚å°±æ¥åˆ†æä¸€ä¸‹ã€‚\n1. ç»Ÿä¸€çš„å…³é”®libeventæ”¯æŒå¤šç§I&#x2F;Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„å…³é”®å°±åœ¨äºç»“æ„ä½“eventopï¼Œè¿™ä¸ªç»“æ„ä½“å‰é¢ä¹Ÿæ›¾æåˆ°è¿‡ï¼Œå®ƒçš„æˆå‘˜æ˜¯ä¸€ç³»åˆ—çš„å‡½æ•°æŒ‡é’ˆ, å®šä¹‰åœ¨event-internal.hæ–‡ä»¶ä¸­ï¼š\n12345678910struct eventop &#123;    const char *name;    void *(*init)(struct event_base *); // åˆå§‹åŒ–    int (*add)(void *, struct event *); // æ³¨å†Œäº‹ä»¶    int (*del)(void *, struct event *); // åˆ é™¤äº‹ä»¶    int (*dispatch)(struct event_base *, void *, struct timeval *); // äº‹ä»¶åˆ†å‘    void (*dealloc)(struct event_base *, void *); // æ³¨é”€ï¼Œé‡Šæ”¾èµ„æº    /* set if we need to reinitialize the event base */    int need_reinit;&#125;;\n\n åœ¨libeventä¸­ï¼Œæ¯ç§I&#x2F;O demultiplexæœºåˆ¶çš„å®ç°éƒ½å¿…é¡»æä¾›è¿™äº”ä¸ªå‡½æ•°æ¥å£ï¼Œæ¥å®Œæˆè‡ªèº«çš„åˆå§‹åŒ–ã€é”€æ¯é‡Šæ”¾ï¼›å¯¹äº‹ä»¶çš„æ³¨å†Œã€æ³¨é”€å’Œåˆ†å‘ã€‚æ¯”å¦‚å¯¹äºepollï¼Œlibeventå®ç°äº†5ä¸ªå¯¹åº”çš„æ¥å£å‡½æ•°ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶å¹¶å°†eventopçš„5ä¸ªå‡½æ•°æŒ‡é’ˆæŒ‡å‘è¿™5ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç¨‹åºå°±å¯ä»¥ä½¿ç”¨epollä½œä¸ºI&#x2F;O demultiplexæœºåˆ¶äº†ã€‚\n2. è®¾ç½®I&#x2F;O demultiplexæœºåˆ¶libeventæŠŠæ‰€æœ‰æ”¯æŒçš„I&#x2F;O demultiplexæœºåˆ¶å­˜å‚¨åœ¨ä¸€ä¸ªå…¨å±€é™æ€æ•°ç»„eventopsä¸­ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶é€‰æ‹©ä½¿ç”¨ä½•ç§æœºåˆ¶ï¼Œæ•°ç»„å†…å®¹æ ¹æ®ä¼˜å…ˆçº§é¡ºåºå£°æ˜å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425/* In order of preference */static const struct eventop *eventops[] = &#123;#ifdef HAVE_EVENT_PORTS    &amp;evportops,#endif#ifdef HAVE_WORKING_KQUEUE    &amp;kqops,#endif#ifdef HAVE_EPOLL    &amp;epollops,#endif#ifdef HAVE_DEVPOLL    &amp;devpollops,#endif#ifdef HAVE_POLL    &amp;pollops,#endif#ifdef HAVE_SELECT    &amp;selectops,#endif#ifdef WIN32    &amp;win32ops,#endif    NULL&#125;; \n\nç„¶ålibeventæ ¹æ®ç³»ç»Ÿé…ç½®å’Œç¼–è¯‘é€‰é¡¹å†³å®šä½¿ç”¨å“ªä¸€ç§I&#x2F;O demultiplexæœºåˆ¶ï¼Œè¿™æ®µä»£ç åœ¨å‡½æ•°**event_base_new()**ä¸­ï¼š\n12345678910111213base-&gt;evbase = NULL;for (i = 0; eventops[i] &amp;&amp; !base-&gt;evbase; i++) &#123;    base-&gt;evsel = eventops[i];    base-&gt;evbase = base-&gt;evsel-&gt;init(base);&#125; base-&gt;evbase = NULL;for (i = 0; eventops[i] &amp;&amp; !base-&gt;evbase; i++) &#123;    base-&gt;evsel = eventops[i];    base-&gt;evbase = base-&gt;evsel-&gt;init(base);&#125; \n\nå¯ä»¥çœ‹å‡ºï¼Œlibeventåœ¨ç¼–è¯‘é˜¶æ®µé€‰æ‹©ç³»ç»Ÿçš„I&#x2F;O demultiplexæœºåˆ¶ï¼Œè€Œä¸æ”¯æŒåœ¨è¿è¡Œé˜¶æ®µæ ¹æ®é…ç½®å†æ¬¡é€‰æ‹©ã€‚\nä»¥Linuxä¸‹é¢çš„epollä¸ºä¾‹ï¼Œå®ç°åœ¨æºæ–‡ä»¶epoll.cä¸­ï¼Œeventopså¯¹è±¡epollopså®šä¹‰å¦‚ä¸‹ï¼š\n123456789const struct eventop epollops = &#123;    &quot;epoll&quot;,    epoll_init,    epoll_add,    epoll_del,    epoll_dispatch,    epoll_dealloc,    1 /* need reinit */&#125;;\n\nå˜é‡epollopsä¸­çš„å‡½æ•°æŒ‡é’ˆå…·ä½“å£°æ˜å¦‚ä¸‹ï¼Œæ³¨æ„åˆ°å…¶è¿”å›å€¼å’Œå‚æ•°éƒ½å’Œeventopä¸­çš„å®šä¹‰ä¸¥æ ¼ä¸€è‡´ï¼Œè¿™æ˜¯å‡½æ•°æŒ‡é’ˆçš„è¯­æ³•é™åˆ¶ã€‚\n12345static void *epoll_init    (struct event_base *);static int epoll_add    (void *, struct event *);static int epoll_del    (void *, struct event *);static int epoll_dispatch(struct event_base *, void *, struct timeval *);static void epoll_dealloc    (struct event_base *, void *);\n\né‚£ä¹ˆå¦‚æœé€‰æ‹©çš„æ˜¯epollï¼Œé‚£ä¹ˆè°ƒç”¨ç»“æ„ä½“eventopçš„initå’Œdispatchå‡½æ•°æŒ‡é’ˆæ—¶ï¼Œå®é™…è°ƒç”¨çš„å‡½æ•°å°±æ˜¯epollçš„åˆå§‹åŒ–å‡½æ•°**epoll_init()å’Œäº‹ä»¶åˆ†å‘å‡½æ•°epoll_dispatch()**äº†ï¼›\nhttp://blog.csdn.net/sparkliang/archive/2009/06/09/4254115.aspxåŒæ ·çš„ï¼Œä¸Šé¢epollopsä»¥åŠepollçš„å„ç§å‡½æ•°éƒ½ç›´æ¥å®šä¹‰åœ¨äº†epoll.cæºæ–‡ä»¶ä¸­ï¼Œå¯¹å¤–éƒ½æ˜¯ä¸å¯è§çš„ã€‚å¯¹äºlibeventçš„ä½¿ç”¨è€…è€Œè¨€ï¼Œå®Œå…¨ä¸ä¼šçŸ¥é“å®ƒä»¬çš„å­˜åœ¨ï¼Œå¯¹epollçš„ä½¿ç”¨ä¹Ÿæ˜¯é€šè¿‡eventopæ¥å®Œæˆçš„ï¼Œè¾¾åˆ°äº†ä¿¡æ¯éšè—çš„ç›®çš„ã€‚\n3. å°èŠ‚æ”¯æŒå¤šç§I&#x2F;O demultiplexæœºåˆ¶çš„æ–¹æ³•å…¶å®æŒºç®€å•çš„ï¼Œå€ŸåŠ©äºå‡½æ•°æŒ‡é’ˆå°±OKäº†ã€‚é€šè¿‡å¯¹æºä»£ç çš„åˆ†æä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œlibeventæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µé€‰æ‹©ç³»ç»Ÿçš„I&#x2F;O demultiplexæœºåˆ¶çš„ï¼Œè€Œä¸æ”¯æŒåœ¨è¿è¡Œé˜¶æ®µæ ¹æ®é…ç½®å†æ¬¡é€‰æ‹©ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ10","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e1ec444aa92c9259448efee0050b6181","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ11","content":"libeventæºç æ·±åº¦å‰–æ11æ—¶é—´ç®¡ç†\nä¸ºäº†æ”¯æŒå®šæ—¶å™¨ï¼Œlibeventå¿…é¡»å’Œç³»ç»Ÿæ—¶é—´æ‰“äº¤é“ï¼Œè¿™ä¸€éƒ¨åˆ†çš„å†…å®¹ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ¶‰åŠåˆ°æ—¶é—´çš„åŠ å‡è¾…åŠ©å‡½æ•°ã€æ—¶é—´ç¼“å­˜ã€æ—¶é—´æ ¡æ­£å’Œå®šæ—¶å™¨å †çš„æ—¶é—´å€¼è°ƒæ•´ç­‰ã€‚ä¸‹é¢å°±ç»“åˆæºä»£ç æ¥åˆ†æä¸€ä¸‹ã€‚\n1. åˆå§‹åŒ–æ£€æµ‹libeventåœ¨åˆå§‹åŒ–æ—¶ä¼šæ£€æµ‹ç³»ç»Ÿæ—¶é—´çš„ç±»å‹ï¼Œé€šè¿‡è°ƒç”¨å‡½æ•°*d***etect_monotonic()å®Œæˆï¼Œå®ƒé€šè¿‡è°ƒç”¨clock_gettime()**æ¥æ£€æµ‹ç³»ç»Ÿæ˜¯å¦æ”¯æŒmonotonicæ—¶é’Ÿç±»å‹ï¼š\n1234567static void detect_monotonic(void)&#123;#if defined(HAVE_CLOCK_GETTIME) &amp;&amp; defined(CLOCK_MONOTONIC)    struct timespec    ts;    if (clock_gettime(CLOCK_MONOTONIC, &amp;ts) == 0)        use_monotonic = 1; // ç³»ç»Ÿæ”¯æŒmonotonicæ—¶é—´#endif&#125;\n\nMonotonicæ—¶é—´æŒ‡ç¤ºçš„æ˜¯ç³»ç»Ÿä»bootååˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ—¶é—´ï¼Œå¦‚æœç³»ç»Ÿæ”¯æŒMonotonicæ—¶é—´å°±å°†å…¨å±€å˜é‡use_monotonicè®¾ç½®ä¸º1ï¼Œè®¾ç½®use_monotonicåˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Œè¿™ä¸ªåœ¨åé¢è¯´åˆ°æ—¶é—´æ ¡æ­£æ—¶å°±èƒ½çœ‹å‡ºæ¥äº†ã€‚\n2. æ—¶é—´ç¼“å­˜ç»“æ„ä½“event_baseä¸­çš„tv_cacheï¼Œç”¨æ¥è®°å½•æ—¶é—´ç¼“å­˜ã€‚è¿™ä¸ªè¿˜è¦ä»å‡½æ•°**gettime()**è¯´èµ·ï¼Œå…ˆæ¥çœ‹çœ‹è¯¥å‡½æ•°çš„ä»£ç ï¼š\n1234567891011121314151617181920static int gettime(struct event_base *base, struct timeval *tp)&#123;    // å¦‚æœtv_cacheæ—¶é—´ç¼“å­˜å·²è®¾ç½®ï¼Œå°±ç›´æ¥ä½¿ç”¨    if (base-&gt;tv_cache.tv_sec) &#123;        *tp = base-&gt;tv_cache;        return (0);    &#125;    // å¦‚æœæ”¯æŒmonotonicï¼Œå°±ç”¨clock_gettimeè·å–monotonicæ—¶é—´#if defined(HAVE_CLOCK_GETTIME) &amp;&amp; defined(CLOCK_MONOTONIC)    if (use_monotonic) &#123;        struct timespec    ts;        if (clock_gettime(CLOCK_MONOTONIC, &amp;ts) == -1)            return (-1);        tp-&gt;tv_sec = ts.tv_sec;        tp-&gt;tv_usec = ts.tv_nsec / 1000;        return (0);    &#125;#endif    // å¦åˆ™åªèƒ½å–å¾—ç³»ç»Ÿå½“å‰æ—¶é—´    return (evutil_gettimeofday(tp, NULL));&#125;\n\nå¦‚æœtv_cacheå·²ç»è®¾ç½®ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„æ—¶é—´ï¼›å¦åˆ™éœ€è¦å†æ¬¡æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è·å–ç³»ç»Ÿæ—¶é—´ã€‚å‡½æ•°**evutil_gettimeofday()ç”¨æ¥è·å–å½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œåœ¨Linuxä¸‹å…¶å®å°±æ˜¯ç³»ç»Ÿè°ƒç”¨gettimeofday()ï¼›Windowsæ²¡æœ‰æä¾›å‡½æ•°gettimeofdayï¼Œè€Œæ˜¯é€šè¿‡è°ƒç”¨_ftime()**æ¥å®Œæˆçš„ã€‚åœ¨æ¯æ¬¡ç³»ç»Ÿäº‹ä»¶å¾ªç¯ä¸­ï¼Œæ—¶é—´ç¼“å­˜tv_cacheå°†ä¼šè¢«ç›¸åº”çš„æ¸…ç©ºå’Œè®¾ç½®ï¼Œå†æ¬¡æ¥çœ‹çœ‹ä¸‹é¢event_base_loopçš„ä¸»è¦ä»£ç é€»è¾‘ï¼š\n123456789101112131415161718192021int event_base_loop(struct event_base *base, int flags)&#123;    // æ¸…ç©ºæ—¶é—´ç¼“å­˜    base-&gt;tv_cache.tv_sec = 0;    while(!done)&#123;        timeout_correct(base, &amp;tv); // æ—¶é—´æ ¡æ­£        // æ›´æ–°event_tvåˆ°tv_cacheæŒ‡ç¤ºçš„æ—¶é—´æˆ–è€…å½“å‰æ—¶é—´ï¼ˆç¬¬ä¸€æ¬¡ï¼‰         // event_tv &lt;--- tv_cache        gettime(base, &amp;base-&gt;event_tv);        // æ¸…ç©ºæ—¶é—´ç¼“å­˜-- æ—¶é—´ç‚¹1        base-&gt;tv_cache.tv_sec = 0;        // ç­‰å¾…I/Oäº‹ä»¶å°±ç»ª        res = evsel-&gt;dispatch(base, evbase, tv_p);        // ç¼“å­˜tv_cacheå­˜å‚¨äº†å½“å‰æ—¶é—´çš„å€¼-- æ—¶é—´ç‚¹2         // tv_cache &lt;--- now        gettime(base, &amp;base-&gt;tv_cache);        // .. å¤„ç†å°±ç»ªäº‹ä»¶    &#125;    // é€€å‡ºæ—¶ä¹Ÿè¦æ¸…ç©ºæ—¶é—´ç¼“å­˜    base-&gt;tv_cache.tv_sec = 0;    return (0);&#125;\n\næ—¶é—´event_tvæŒ‡ç¤ºäº†dispatch()ä¸Šæ¬¡è¿”å›ï¼Œä¹Ÿå°±æ˜¯I&#x2F;Oäº‹ä»¶å°±ç»ªæ—¶çš„æ—¶é—´ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥å¾ªç¯æ—¶ï¼Œç”±äºtv_cacheè¢«æ¸…ç©ºï¼Œå› æ­¤gettime()æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è·å–å½“å‰ç³»ç»Ÿæ—¶é—´ï¼›è€Œåå°†ä¼šæ›´æ–°ä¸ºtv_cacheæŒ‡ç¤ºçš„æ—¶é—´ã€‚æ—¶é—´tv_cacheåœ¨dispatch()è¿”å›åè¢«è®¾ç½®ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œå› æ­¤å®ƒç¼“å­˜äº†æœ¬æ¬¡I&#x2F;Oäº‹ä»¶å°±ç»ªæ—¶çš„æ—¶é—´ï¼ˆevent_tvï¼‰ã€‚ä»ä»£ç é€»è¾‘é‡Œå¯ä»¥çœ‹å‡ºevent_två–å¾—çš„æ˜¯tv_cacheä¸Šä¸€æ¬¡çš„å€¼ï¼Œå› æ­¤event_tvåº”è¯¥å°äºtv_cacheçš„å€¼ã€‚è®¾ç½®æ—¶é—´ç¼“å­˜çš„ä¼˜ç‚¹æ˜¯ä¸å¿…æ¯æ¬¡è·å–æ—¶é—´éƒ½æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè¿™æ˜¯ä¸ªç›¸å¯¹è´¹æ—¶çš„æ“ä½œï¼›åœ¨ä¸Šé¢æ ‡æ³¨çš„æ—¶é—´ç‚¹2åˆ°æ—¶é—´ç‚¹1çš„è¿™æ®µæ—¶é—´ï¼ˆå¤„ç†å°±ç»ªäº‹ä»¶æ—¶ï¼‰ï¼Œè°ƒç”¨gettime()å–å¾—çš„éƒ½æ˜¯tv_cacheç¼“å­˜çš„æ—¶é—´ã€‚\n3. æ—¶é—´æ ¡æ­£å¦‚æœç³»ç»Ÿæ”¯æŒmonotonicæ—¶é—´ï¼Œè¯¥æ—¶é—´æ˜¯ç³»ç»Ÿä»bootååˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ—¶é—´ï¼Œå› æ­¤ä¸éœ€è¦æ‰§è¡Œæ ¡æ­£ã€‚æ ¹æ®å‰é¢çš„ä»£ç é€»è¾‘ï¼Œå¦‚æœç³»ç»Ÿä¸æ”¯æŒmonotonicæ—¶é—´ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ‰‹åŠ¨çš„è°ƒæ•´æ—¶é—´ï¼Œå¦‚æœæ—¶é—´è¢«å‘å‰è°ƒæ•´äº†ï¼ˆMSå‰é¢ç¬¬7éƒ¨åˆ†è®²æˆäº†å‘åè°ƒæ•´ï¼Œè¦æ”¹æ­£ï¼‰ï¼Œæ¯”å¦‚ä»5ç‚¹è°ƒæ•´åˆ°äº†3ç‚¹ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ç‚¹2å–å¾—çš„å€¼å¯èƒ½ä¼šå°äºä¸Šæ¬¡çš„æ—¶é—´ï¼Œè¿™å°±éœ€è¦è°ƒæ•´äº†ï¼Œä¸‹é¢æ¥çœ‹çœ‹æ ¡æ­£çš„å…·ä½“ä»£ç ï¼Œç”±å‡½æ•°**timeout_correct()**å®Œæˆï¼š\n123456789101112131415161718192021222324static void timeout_correct(struct event_base *base, struct timeval *tv)&#123;    struct event **pev;    unsigned int size;    struct timeval off;    if (use_monotonic) // monotonicæ—¶é—´å°±ç›´æ¥è¿”å›ï¼Œæ— éœ€è°ƒæ•´        return;    gettime(base, tv); // tv &lt;---tv_cache    // æ ¹æ®å‰é¢çš„åˆ†æå¯ä»¥çŸ¥é“event_tvåº”è¯¥å°äºtv_cache    // å¦‚æœtv &lt; event_tvè¡¨æ˜ç”¨æˆ·å‘å‰è°ƒæ•´æ—¶é—´äº†ï¼Œéœ€è¦æ ¡æ­£æ—¶é—´    if (evutil_timercmp(tv, &amp;base-&gt;event_tv, &gt;=)) &#123;        base-&gt;event_tv = *tv;        return;    &#125;    // è®¡ç®—æ—¶é—´å·®å€¼    evutil_timersub(&amp;base-&gt;event_tv, tv, &amp;off);    // è°ƒæ•´å®šæ—¶äº‹ä»¶å°æ ¹å †    pev = base-&gt;timeheap.p;    size = base-&gt;timeheap.n;    for (; size-- &gt; 0; ++pev) &#123;        struct timeval *ev_tv = &amp;(**pev).ev_timeout;        evutil_timersub(ev_tv, &amp;off, ev_tv);    &#125;    base-&gt;event_tv = *tv; // æ›´æ–°event_tvä¸ºtv_cache&#125;\n\nåœ¨è°ƒæ•´å°æ ¹å †æ—¶ï¼Œå› ä¸ºæ‰€æœ‰å®šæ—¶äº‹ä»¶çš„æ—¶é—´å€¼éƒ½ä¼šè¢«å‡å»ç›¸åŒçš„å€¼ï¼Œå› æ­¤è™½ç„¶å †ä¸­å…ƒç´ çš„æ—¶é—´é”®å€¼æ”¹å˜äº†ï¼Œä½†æ˜¯ç›¸å¯¹å…³ç³»å¹¶æ²¡æœ‰æ”¹å˜ï¼Œä¸ä¼šæ”¹å˜å †çš„æ•´ä½“ç»“æ„ã€‚å› æ­¤åªéœ€è¦éå†å †ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå°†æ¯ä¸ªå…ƒç´ çš„æ—¶é—´é”®å€¼å‡å»ç›¸åŒçš„å€¼å³å¯å®Œæˆè°ƒæ•´ï¼Œä¸éœ€è¦é‡æ–°è°ƒæ•´å †çš„ç»“æ„ã€‚å½“ç„¶è°ƒæ•´å®Œåï¼Œè¦å°†event_två€¼é‡æ–°è®¾ç½®ä¸ºtv_cacheå€¼äº†ã€‚\n4. å°èŠ‚ä¸»è¦åˆ†æäº†ä¸€ä¸‹libeventå¯¹ç³»ç»Ÿæ—¶é—´çš„å¤„ç†ï¼Œæ—¶é—´ç¼“å­˜ã€æ—¶é—´æ ¡æ­£å’Œå®šæ—¶å †çš„æ—¶é—´å€¼è°ƒæ•´ç­‰ï¼Œé€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ—¶é—´çš„åŠ å‡ã€è®¾ç½®ç­‰è¾…åŠ©å‡½æ•°åˆ™éå¸¸ç®€å•ï¼Œä¸»è¦åœ¨å¤´æ–‡ä»¶evutil.hä¸­ï¼Œå°±ä¸å†å¤šè¯´äº†ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ11","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"6ab33ba5c42af5d08609eb8e6d060470","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ12","content":"libeventæºç æ·±åº¦å‰–æ12è®©libeventæ”¯æŒå¤šçº¿ç¨‹\nlibeventæœ¬èº«ä¸æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šæ ¸çš„æ—¶ä»£ï¼Œå¦‚ä½•èƒ½å……åˆ†åˆ©ç”¨CPUçš„èƒ½åŠ›å‘¢ï¼Œè¿™ä¸€èŠ‚æ¥è¯´è¯´å¦‚ä½•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨libeventï¼Œè·Ÿæºä»£ç å¹¶æ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œçº¯ç²¹æ˜¯ä½¿ç”¨ä¸Šçš„æŠ€å·§ã€‚\n1. é”™è¯¯ä½¿ç”¨ç¤ºä¾‹åœ¨å¤šæ ¸çš„CPUä¸Šåªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å§‹ç»ˆæ˜¯å¯¹ä¸èµ·CPUçš„å¤„ç†èƒ½åŠ›å•Šï¼Œé‚£å¥½å§ï¼Œé‚£å°±å¤šåˆ›å»ºå‡ ä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚ä¸‹é¢çš„ç®€å•æœåŠ¡å™¨åœºæ™¯ã€‚1 ä¸»çº¿ç¨‹åˆ›å»ºå·¥ä½œçº¿ç¨‹1ï¼›2 æ¥ç€ä¸»çº¿ç¨‹ç›‘å¬åœ¨ç«¯å£ä¸Šï¼Œç­‰å¾…æ–°çš„è¿æ¥ï¼›3 åœ¨çº¿ç¨‹1ä¸­æ‰§è¡Œeventäº‹ä»¶å¾ªç¯ï¼Œç­‰å¾…äº‹ä»¶åˆ°æ¥ï¼›4 æ–°è¿æ¥åˆ°æ¥ï¼Œä¸»çº¿ç¨‹è°ƒç”¨libeventæ¥å£event_addå°†æ–°è¿æ¥æ³¨å†Œåˆ°libeventä¸Šï¼›â€¦ â€¦ä¸Šé¢çš„é€»è¾‘çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé”™è¯¯ï¼Œåœ¨å¾ˆå¤šæœåŠ¡å™¨è®¾è®¡ä¸­éƒ½å¯èƒ½ç”¨åˆ°ä¸»çº¿ç¨‹å’Œå·¥ä½œçº¿ç¨‹çš„æ¨¡å¼â€¦.å¯æ˜¯å°±åœ¨çº¿ç¨‹1æ³¨å†Œäº‹ä»¶æ—¶ï¼Œä¸»çº¿ç¨‹å¾ˆå¯èƒ½ä¹Ÿåœ¨æ“ä½œäº‹ä»¶ï¼Œæ¯”å¦‚åˆ é™¤ï¼Œä¿®æ”¹ï¼Œé€šè¿‡libeventçš„æºä»£ç ä¹Ÿèƒ½çœ‹åˆ°ï¼Œæ²¡æœ‰åŒæ­¥ä¿æŠ¤æœºåˆ¶ï¼Œé—®é¢˜éº»çƒ¦äº†ï¼Œçœ‹èµ·æ¥ä¸èƒ½è¿™æ ·åšå•Šï¼Œéš¾é“åªèƒ½ä½¿ç”¨å•çº¿ç¨‹ä¸æˆï¼ï¼Ÿ\n2. æ”¯æŒå¤šçº¿ç¨‹çš„å‡ ç§æ¨¡å¼libeventå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†è¿™ä¸ä»£è¡¨libeventä¸æ”¯æŒå¤šçº¿ç¨‹æ¨¡å¼ï¼Œå…¶å®æ–¹æ³•åœ¨å‰é¢å·²ç»å°†signaläº‹ä»¶å¤„ç†æ—¶å°±æ¥è§¦åˆ°äº†ï¼Œé‚£å°±æ˜¯æ¶ˆæ¯é€šçŸ¥æœºåˆ¶ã€‚ä¸€å¥è¯ï¼Œâ€œä½ å‘æ¶ˆæ¯é€šçŸ¥æˆ‘ï¼Œç„¶åå†ç”±æˆ‘åœ¨åˆé€‚çš„æ—¶é—´æ¥å¤„ç†â€ï¼›è¯´åˆ°è¿™å°±å†å¤šè¯´å‡ å¥ï¼Œå†æ‰“ä¸ªæ¯”æ–¹ï¼ŒæŠŠä½ è‡ªå·±æ¯”ä½œä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œè€Œä½ çš„å¤´æ˜¯ä¸»çº¿ç¨‹ï¼Œä½ æœ‰ä¸€ä¸ªæ¶ˆæ¯ä¿¡ç®±æ¥æ¥æ”¶åˆ«äººå‘ç»™ä½ çš„æ¶ˆæ¯ï¼Œå½“æ—¶å¤´æœ‰ä¸ªæ–°ä»»åŠ¡è¦æŒ‡æ´¾ç»™ä½ ã€‚\n2.1 æš´åŠ›æŠ¢å é‚£ä¹ˆç¬¬ä¸€èŠ‚ä¸­ä½¿ç”¨çš„å¤šçº¿ç¨‹æ–¹æ³•ç›¸å½“ä¸‹é¢çš„æµç¨‹ï¼š1 å½“æ—¶ä½ æ­£åœ¨åšäº‹ï¼Œæ¯”å¦‚åœ¨å†™æ–‡æ¡£ï¼›2 ä½ çš„å¤´æ‰¾åˆ°äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¦æŒ‡æ´¾ç»™ä½ ï¼Œæ¯”å¦‚å¸®ä»–æä¸ªPPTï¼Œå“ˆï¼›3 å¤´å‘½ä»¤ä½ é©¬ä¸ŠæPPTï¼Œä½ è¿™æ˜¯ä¸å¾—ä¸åœæ­¢æ‰‹å¤´çš„å·¥ä½œï¼ŒæŠŠPPTæå®šäº†å†æ¥ç€å†™æ–‡æ¡£ï¼›â€¦\n2.2 çº¯ç²¹çš„æ¶ˆæ¯é€šçŸ¥æœºåˆ¶é‚£ä¹ˆåŸºäºçº¯ç²¹çš„æ¶ˆæ¯é€šçŸ¥æœºåˆ¶çš„å¤šçº¿ç¨‹æ–¹å¼å°±åƒä¸‹é¢è¿™æ ·ï¼š1 å½“æ—¶ä½ æ­£åœ¨å†™æ–‡æ¡£ï¼›2 ä½ çš„å¤´æ‰¾åˆ°äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¦æŒ‡æ´¾ç»™ä½ ï¼Œå¸®ä»–æä¸ªPPTï¼›3 å¤´å‘ä¸ªæ¶ˆæ¯åˆ°ä½ ä¿¡ç®±ï¼Œæœ‰ä¸ªPPTè¦å¸®ä»–æå®šï¼Œè¿™æ—¶ä½ å¹¶ä¸é¸Ÿä»–ï¼›4 ä½ å†™å¥½æ–‡æ¡£ï¼Œæ¥ç€æ£€æŸ¥æ¶ˆæ¯å‘ç°å¤´æœ‰ä¸ªPPTè¦ä½ æå®šï¼Œä½ å¼€å§‹æPPTï¼›â€¦ç¬¬ä¸€ç§çš„å¥½å¤„æ˜¯æ¶ˆæ¯å¯ä»¥ç«‹å³å¾—åˆ°å¤„ç†ï¼Œä½†æ˜¯å¾ˆæ–¹æ³•å¾ˆç²—æš´ï¼Œä½ å¿…é¡»ç«‹å³å¤„ç†è¿™ä¸ªæ¶ˆæ¯ï¼Œæ‰€ä»¥ä½ å¿…é¡»å¤„ç†å¥½åˆ‡æ¢é—®é¢˜ï¼Œçœå¾—æŠŠæ–‡æ¡£ä¸Šçš„å†…å®¹ä¸å°å¿ƒå†™åˆ°PPTé‡Œã€‚åœ¨æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹é€šä¿¡ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæ¶ˆæ¯ä¿¡ç®±ï¼‰éƒ½æ˜¯æ“ä½œç³»ç»Ÿç»´æŠ¤çš„ï¼Œä½ ä¸å¿…å…³å¿ƒã€‚ç¬¬äºŒç§çš„ä¼˜ç‚¹æ˜¯é€šè¿‡æ¶ˆæ¯é€šçŸ¥ï¼Œåˆ‡æ¢é—®é¢˜çœå¿ƒäº†ï¼Œä¸è¿‡æ¶ˆæ¯æ˜¯ä¸èƒ½ç«‹å³å¤„ç†çš„ï¼ˆåŸºäºæ¶ˆæ¯é€šçŸ¥æœºåˆ¶ï¼Œè¿™ä¸ªæ€»æ˜¯éš¾å…çš„ï¼‰ï¼Œè€Œä¸”æ‰€æœ‰çš„å†…å®¹éƒ½é€šè¿‡æ¶ˆæ¯å‘é€ï¼Œæ¯”å¦‚PPTçš„æ ¼å¼ã€å†…å®¹ç­‰ç­‰ä¿¡æ¯ï¼Œè¿™æ— ç–‘å¢åŠ äº†é€šä¿¡å¼€é”€ã€‚\n2.3 æ¶ˆæ¯é€šçŸ¥+åŒæ­¥å±‚æœ‰ä¸ªæŠ˜ä¸­æœºåˆ¶å¯ä»¥å‡å°‘æ¶ˆæ¯é€šä¿¡çš„å¼€é”€ï¼Œå°±æ˜¯æå–ä¸€ä¸ªåŒæ­¥å±‚ï¼Œè¿˜æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œä½ æŠŠå·¥ä½œå®‰æ’éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œè€Œä¸”ä½ èƒ½å¤Ÿä¿è¯â€œä»»ä½•äººæŠŠæ–°ä»»åŠ¡æ‰”åˆ°è¿™ä¸ªé˜Ÿåˆ—â€ï¼Œâ€œè‡ªå·±å–å‡ºå½“å‰ç¬¬ä¸€ä¸ªä»»åŠ¡â€ç­‰è¿™äº›æ“ä½œéƒ½èƒ½å¤Ÿä¿è¯ä¸ä¼šæŠŠé˜Ÿåˆ—æä¹±ï¼ˆå…¶å®å°±æ˜¯ä¸ªåŠ é”çš„é˜Ÿåˆ—å®¹å™¨ï¼‰ã€‚å†æ¥çœ‹çœ‹å¤„ç†è¿‡ç¨‹å’Œä¸Šé¢æœ‰ä»€ä¹ˆä¸åŒï¼š1 å½“æ—¶ä½ æ­£åœ¨å†™æ–‡æ¡£ï¼›2 ä½ çš„å¤´æ‰¾åˆ°äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¦æŒ‡æ´¾ç»™ä½ ï¼Œå¸®ä»–æä¸ªPPTï¼›2 å¤´æœ‰ä¸ªPPTè¦ä½ æå®šï¼Œä»–æŠŠä»»åŠ¡pushåˆ°ä½ çš„å·¥ä½œé˜Ÿåˆ—ä¸­ï¼ŒåŒ…æ‹¬äº†PPTçš„æ ¼å¼ã€å†…å®¹ç­‰ä¿¡æ¯ï¼›3 å¤´å‘ä¸ªæ¶ˆæ¯ï¼ˆä¸€ä¸ªå­—èŠ‚ï¼‰åˆ°ä½ ä¿¡ç®±ï¼Œæœ‰ä¸ªPPTè¦å¸®ä»–æå®šï¼Œè¿™æ—¶ä½ å¹¶ä¸é¸Ÿä»–ï¼›4 ä½ å†™å¥½æ–‡æ¡£ï¼Œå‘ç°æœ‰æ–°æ¶ˆæ¯ï¼ˆè¿™é¢„ç¤ºç€æœ‰æ–°ä»»åŠ¡æ¥äº†ï¼‰ï¼Œæ£€æŸ¥å·¥ä½œé˜Ÿåˆ—çŸ¥é“å¤´æœ‰ä¸ªPPTè¦ä½ æå®šï¼Œä½ å¼€å§‹æPPTï¼›â€¦å·¥ä½œé˜Ÿåˆ—å…¶å®å°±æ˜¯ä¸€ä¸ªåŠ é”çš„å®¹å™¨ï¼ˆé˜Ÿåˆ—ã€é“¾è¡¨ç­‰ç­‰ï¼‰ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“å®ç°å®ç°ï¼›è€Œæ¶ˆæ¯é€šçŸ¥ä»…éœ€è¦ä¸€ä¸ªå­—èŠ‚ï¼Œå…·ä½“çš„ä»»åŠ¡éƒ½pushåˆ°äº†åœ¨å·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œå› æ­¤æƒ³æ¯”2.2å‡å°‘äº†ä¸å°‘é€šä¿¡å¼€é”€ã€‚å¤šçº¿ç¨‹ç¼–ç¨‹æœ‰å¾ˆå¤šé™·é˜±ï¼Œçº¿ç¨‹é—´èµ„æºçš„åŒæ­¥äº’æ–¥ä¸æ˜¯ä¸€ä¸¤å¥èƒ½è¯´å¾—æ¸…çš„ï¼Œè€Œä¸”å‡ºç°bugå¾ˆéš¾è·Ÿè¸ªè°ƒè¯•ï¼›è¿™ä¹Ÿæœ‰å¾ˆå¤šçš„ç»éªŒå’Œæ•™è®­ï¼Œå› æ­¤å¦‚æœè®©æˆ‘é€‰æ‹©ï¼Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä¼šé€‰æ‹©æœºåˆ¶3ä½œä¸ºå®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•ã€‚\n3. ä¾‹å­â€”â€”memcachedMemcachedä¸­çš„ç½‘ç»œéƒ¨åˆ†å°±æ˜¯åŸºäºlibeventå®Œæˆçš„ï¼Œå…¶ä¸­çš„å¤šçº¿ç¨‹æ¨¡å‹å°±æ˜¯å…¸å‹çš„æ¶ˆæ¯é€šçŸ¥+åŒæ­¥å±‚æœºåˆ¶ã€‚ä¸‹é¢çš„å›¾è¶³å¤Ÿè¯´æ˜å…¶å¤šçº¿ç¨‹æ¨¡å‹äº†ï¼Œå…¶ä¸­æœ‰è¯¦ç»†çš„æ–‡å­—è¯´æ˜ã€‚\n\næ³¨ï¼šè¯¥å›¾çš„å…·ä½“å‡ºå¤„å¿˜è®°äº†ï¼Œæ„Ÿè°¢åŸä½œè€…ã€‚\n4. å°èŠ‚æœ¬èŠ‚æ›´æ˜¯libeventçš„ä½¿ç”¨æ–¹é¢çš„æŠ€å·§ï¼Œè®¨è®ºäº†ä¸€ä¸‹å¦‚ä½•è®©libeventæ”¯æŒå¤šçº¿ç¨‹ï¼Œä»¥åŠå‡ ç§æ”¯æŒå¤šçº¿ç¨‹çš„æœºåˆ¶ï¼Œå’Œmemcachedä½¿ç”¨libeventçš„å¤šçº¿ç¨‹æ¨¡å‹ã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ12","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"467347dafd8ded07c13ba37241779bf0","title":"ã€è½¬è½½ã€‘libeventæºç æ·±åº¦å‰–æ13","content":"libeventæºç æ·±åº¦å‰–æ13libeventä¿¡å·å¤„ç†æ³¨æ„ç‚¹\nå‰é¢è®²åˆ°äº† libevent å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•ï¼Œç„¶è€Œåœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸­æ³¨å†Œä¿¡å·äº‹ä»¶ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›æƒ…å†µéœ€è¦å°å¿ƒå¤„ç†ï¼Œé‚£å°±æ˜¯ä¸èƒ½åœ¨å¤šä¸ª libevent å®ä¾‹ä¸Šæ³¨å†Œä¿¡å·äº‹ä»¶ã€‚ä¾ç„¶å† åè¿½åŠ åˆ° libevent ç³»åˆ—ã€‚\nä»¥ 2 ä¸ªçº¿ç¨‹ä¸ºä¾‹ï¼Œåšç®€å•çš„åœºæ™¯åˆ†æã€‚\n1 é¦–å…ˆæ˜¯åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹ 1 çš„ libevent å®ä¾‹ base1 ï¼Œçº¿ç¨‹ 1 çš„ libevent å®ä¾‹ base2 ï¼›\n2 åœ¨ base1 ä¸Šæ³¨å†Œ SIGALRM ä¿¡å·ï¼›åœ¨ base2 ä¸Šæ³¨å†Œ SIGINT ä¿¡å·ï¼›\n3 å‡è®¾å½“å‰ base1 å’Œ base2 ä¸Šéƒ½æ²¡æœ‰æ³¨å†Œå…¶ä»–çš„äº‹ä»¶ï¼›\n4 çº¿ç¨‹ 1 å’Œ 2 éƒ½è¿›å…¥ event_base_loop äº‹ä»¶å¾ªç¯ï¼š\n\n5 å‡è®¾çº¿ç¨‹ 1 å…ˆè¿›å…¥ event_base_loop ï¼Œå¹¶è®¾ç½® evsignal_base &#x3D; base1 ï¼›å¹¶ç­‰å¾…ï¼›\n6 æ¥ç€çº¿ç¨‹ 2 ä¹Ÿè¿›å…¥ event_base_loop ï¼Œå¹¶è®¾ç½® evsignal_base &#x3D; base2 ï¼›å¹¶ç­‰å¾…ï¼›\n äºæ˜¯ evsignal_base å°±æŒ‡å‘äº† base2 ï¼›\n7 ä¿¡å· ALARM è§¦å‘ï¼Œè°ƒç”¨æœåŠ¡ä¾‹ç¨‹ï¼š\n12345678static void evsignal_handler(int sig)&#123;       ...       evsignal_base-&gt;sig.evsigcaught[sig]++;       evsignal_base-&gt;sig.evsignal_caught = 1;       /* Wake up our notification mechanism */       send(evsignal_base-&gt;sig.ev_signal_pair[0], &quot;a&quot;, 1, 0);       ...&#125;\n\näºæ˜¯ base2 å¾—åˆ°é€šçŸ¥ ALARM ä¿¡å·å‘ç”Ÿäº†ï¼Œè€Œå®é™…ä¸Š ALARM æ˜¯æ³¨å†Œåœ¨ base1 ä¸Šçš„ï¼Œ base2 ä¸Šçš„ ALARM æ³¨å†Œ event æ˜¯ç©ºçš„ï¼Œäºæ˜¯å¤„ç†å‡½æ•°å°†ä¸èƒ½å¾—åˆ°è°ƒç”¨ï¼›å› æ­¤åœ¨ libevent ä¸­ï¼Œå¦‚æœéœ€è¦å¤„ç†ä¿¡å·ï¼Œåªèƒ½å°†ä¿¡å·æ³¨å†Œåˆ°ä¸€ä¸ª libevent å®ä¾‹ä¸Šã€‚\nmemcached å°±æ²¡æœ‰ä½¿ç”¨ libevent æä¾›çš„ signal æ¥å£ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„åŸç”Ÿ API ï¼Œçœ‹èµ·æ¥è¿™æ ·æ›´ç®€æ´ã€‚\nlibeventæºç æ·±åº¦å‰–æå…¨ç³»åˆ—å®Œã€‚\n","slug":"è½¬è½½/libevent/libeventæºç æ·±åº¦å‰–æ13","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,libevent,æºç è§£æ","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c1e8331f572d9e5ea51efac83edeef24","title":"ã€è½¬è½½ã€‘ä¸šåŠ¡æ•°æ®å¤„ç†ä¸€å®šè¦å•ç‹¬å¼€çº¿ç¨‹å—","content":"ä¸šåŠ¡æ•°æ®å¤„ç†ä¸€å®šè¦å•ç‹¬å¼€çº¿ç¨‹å—åœ¨ ã€Šone thread one loop æ€æƒ³ã€‹ä¸€æ–‡æˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ª loop çš„ä¸»è¦ç»“æ„ä¸€èˆ¬å¦‚ä¸‹æ‰€ç¤ºï¼š\n12345678while (!m_bQuitFlag)&#123;\tepoll_or_select_func();\thandle_io_events();\thandle_other_things();&#125;\n\nå¯¹äºä¸€äº›ä¸šåŠ¡é€»è¾‘å¤„ç†æ¯”è¾ƒç®€å•ã€ä¸ä¼šå¤ªè€—æ—¶çš„åº”ç”¨æ¥è¯´ï¼Œhandle_io_events() æ–¹æ³•é™¤äº†æ”¶å‘æ•°æ®ä¹Ÿå¯ä»¥ç›´æ¥ç”¨æ¥ç›´æ¥åšä¸šåŠ¡çš„å¤„ç†ï¼Œå³å…¶ç»“æ„å¦‚ä¸‹ï¼š\n12345678void handle_io_events()&#123;\t//æ”¶å‘æ•°æ®\trecv_or_send_data();\t\t//è§£åŒ…å¹¶å¤„ç†æ•°æ®\tdecode_packages_and_process();&#125;\n\nå…¶ä¸­ recv_or_send_data() æ–¹æ³•ä¸­è°ƒç”¨ send&#x2F;recv API è¿›è¡Œå®é™…çš„ç½‘ç»œæ•°æ®æ”¶å‘ã€‚ä»¥æ”¶æ•°æ®ä¸ºä¾‹ï¼Œæ”¶å®Œæ•°æ®å­˜å…¥æ¥æ”¶ç¼“å†²åŒºåï¼Œæ¥ä¸‹æ¥è¿›è¡Œè§£åŒ…å¤„ç†ï¼Œç„¶åè¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªç™»é™†æ•°æ®åŒ…ï¼Œå…¶ä¸šåŠ¡å°±æ˜¯éªŒè¯ç™»é™†çš„è´¦æˆ·å¯†ç æ˜¯å¦æ­£ç¡®ã€è®°å½•å…¶ç™»é™†è¡Œä¸ºç­‰ç­‰ã€‚ä»ç¨‹åºå‡½æ•°è°ƒç”¨å †æ ˆæ¥çœ‹ï¼Œè¿™äº›ä¸šåŠ¡å¤„ç†é€»è¾‘å…¶å®æ˜¯ç›´æ¥åœ¨ç½‘ç»œæ”¶å‘æ•°æ®çº¿ç¨‹ä¸­å¤„ç†çš„ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼šç½‘ç»œçº¿ç¨‹è°ƒç”¨ handle_io_events() æ–¹æ³•ï¼Œhandle_io_events() æ–¹æ³•è°ƒç”¨ decode_packages_and_process() æ–¹æ³•ï¼Œdecode_packages_and_process() æ–¹æ³•åšå…·ä½“çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†è®©ç½‘ç»œå±‚ä¸ä¸šåŠ¡å±‚è„±è€¦ï¼Œç½‘ç»œå±‚ä¸­é€šå¸¸ä¼šæä¾›ä¸€äº›å›è°ƒå‡½æ•°çš„æ¥å£ï¼Œè¿™äº›å›è°ƒå‡½æ•°æˆ‘ä»¬å°†å…¶æŒ‡å‘å…·ä½“çš„ä¸šåŠ¡å¤„ç†å‡½æ•°ã€‚ä»¥ libevent ç½‘ç»œåº“çš„ç”¨æ³•ä¸ºä¾‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243int main(int argc, char **argv)&#123;\tstruct event_base *base;\tstruct evconnlistener *listener;\tstruct event *signal_event;\tstruct sockaddr_in sin;\tbase = event_base_new();\tmemset(&amp;sin, 0, sizeof(sin));\tsin.sin_family = AF_INET;\tsin.sin_port = htons(PORT);\t//listener_cbæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰å›è°ƒå‡½æ•°\tlistener = evconnlistener_new_bind(base, listener_cb, (void *)base,\t    LEV_OPT_REUSEABLE|LEV_OPT_CLOSE_ON_FREE, -1,\t    (struct sockaddr*)&amp;sin,\t    sizeof(sin));\tif (!listener) &#123;\t\tfprintf(stderr, &quot;Could not create a listener!\\n&quot;);\t\treturn 1;\t&#125;\t//signal_cbæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰å›è°ƒå‡½æ•°\tsignal_event = evsignal_new(base, SIGINT, signal_cb, (void *)base);\tif (!signal_event || event_add(signal_event, NULL)&lt;0) &#123;\t\tfprintf(stderr, &quot;Could not create/add a signal event!\\n&quot;);\t\treturn 1;\t&#125;\t//å¯åŠ¨loop\tevent_base_dispatch(base);\tevconnlistener_free(listener);\tevent_free(signal_event);\tevent_base_free(base);\tprintf(&quot;done\\n&quot;);\treturn 0;&#125;\n\nä¸Šè¿°ä»£ç æ ¹æ® libevent è‡ªå¸¦çš„ helloworld ç¤ºä¾‹ä¿®æ”¹è€Œæ¥ï¼Œå…¶ä¸­ listener_cb å’Œ signal_cb æ˜¯è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œæœ‰ç›¸åº”çš„äº‹ä»¶è§¦å‘åï¼Œlibevent çš„äº‹ä»¶å¾ªç¯ä¼šè°ƒç”¨æˆ‘ä»¬è®¾ç½®çš„å›è°ƒï¼Œåœ¨è¿™äº›å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ä»£ç ã€‚\nè¿™ç§åŸºæœ¬çš„æœåŠ¡å™¨ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶æˆå¦‚ä¸‹æµç¨‹å›¾ï¼š\n\nè¿™æ˜¯è¿™ä¸ªç»“æ„çš„æœ€åŸºæœ¬é€»è¾‘ï¼Œåœ¨è¿™åŸºç¡€ä¸Šå¯ä»¥å»¶ä¼¸å‡ºå¾ˆå¤šå˜ä½“ã€‚ä¸çŸ¥é“è¯»è€…æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šè¿°æµç¨‹å›¾ä¸­ç¬¬ä¸‰æ­¥è§£åŒ…å’Œä¸šåŠ¡é€»è¾‘å¤„ç†è¿™ä¸€æ­¥ä¸­ï¼ˆä½äº handle_io_events() ä¸­çš„ decode_packages_and_process() æ–¹æ³•ä¸­ï¼‰ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘å¤„ç†è¿‡ç¨‹æ¯”è¾ƒè€—æ—¶ï¼ˆä¾‹å¦‚ï¼Œä»æ•°æ®åº“å–å¤§é‡æ•°æ®ã€å†™æ–‡ä»¶ï¼‰ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´ ç½‘ç»œçº¿ç¨‹åœ¨è¿™ä¸ªæ­¥éª¤åœç•™æ—¶é—´å¾ˆé•¿ï¼Œå¯¼è‡´å¾ˆä¹…ä»¥åæ‰èƒ½æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œå½±å“ç½‘ç»œæ•°æ®çš„æ£€æµ‹å’Œæ”¶å‘ï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªç¨‹åºçš„æ•ˆç‡ä½ä¸‹ã€‚\nå› æ­¤ï¼Œå¯¹äºè¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸šåŠ¡å¤„ç†é€»è¾‘å•ç‹¬æ‹†å‡ºæ¥äº¤ç»™å¦å¤–çš„ä¸šåŠ¡å·¥ä½œçº¿ç¨‹å¤„ç†ï¼Œä¸šåŠ¡å·¥ä½œçº¿ç¨‹å¯ä»¥æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸šåŠ¡æ•°æ®ä»ç½‘ç»œçº¿ç¨‹ç»„æµå‘ä¸šåŠ¡çº¿ç¨‹ç»„ã€‚\nè¿™æ ·çš„ç¨‹åºç»“æ„å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nä¸Šå›¾ä¸­ï¼Œå¯¹äºç½‘ç»œçº¿ç¨‹å°†ä¸šåŠ¡æ•°æ®åŒ…äº¤ç»™ä¸šåŠ¡çº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå…±äº«çš„ä¸šåŠ¡æ•°æ®é˜Ÿåˆ—æ¥å®ç°ï¼Œæ­¤æ—¶ç½‘ç»œçº¿ç¨‹æ˜¯ç”Ÿäº§è€…ï¼Œä¸šåŠ¡çº¿ç¨‹ä»ä¸šåŠ¡æ•°æ®é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡å»å¤„ç†ï¼Œä¸šåŠ¡çº¿ç¨‹æ˜¯æ¶ˆè´¹è€…ã€‚ä¸šåŠ¡çº¿ç¨‹å¤„ç†å®Œæˆåå¦‚æœéœ€è¦å°†ç»“æœæ•°æ®å‘å‡ºå»ï¼Œåˆ™å†å°†æ•°æ®äº¤ç»™ç½‘ç»œçº¿ç¨‹ã€‚è¿™é‡Œå¤„ç†åçš„æ•°æ®ä»ä¸šåŠ¡çº¿ç¨‹å†æ¬¡æµå‘ç½‘ç»œçº¿ç¨‹ï¼Œé‚£ä¹ˆå¦‚ä½•å°†æ•°æ®ä»ä¸šåŠ¡çº¿ç¨‹äº¤ç»™ç½‘ç»œçº¿ç¨‹å‘¢ï¼Ÿè¿™é‡Œä»¥å‘æ•°æ®ä¸ºä¾‹ï¼Œä¸€èˆ¬æœ‰ä¸‰ç§æ–¹æ³•ï¼š\næ–¹æ³•ä¸€\nç›´æ¥è°ƒç”¨ç›¸åº”çš„çš„å‘æ•°æ®çš„æ–¹æ³•ï¼Œå¦‚æœä½ çš„ç½‘ç»œçº¿ç¨‹æœ¬èº«ä¹Ÿä¼šè°ƒç”¨è¿™äº›å‘æ•°æ®çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±å¯èƒ½ä¼šå‡ºç°ç½‘ç»œçº¿ç¨‹å’Œä¸šåŠ¡çº¿ç¨‹åŒæ—¶å¯¹å‘æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œç›¸å½“äºå¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ socket send å‡½æ•°ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´åŒä¸€ä¸ªè¿æ¥ä¸Šçš„æ•°æ®é¡ºåºæœ‰é—®é¢˜ï¼Œæ­¤æ—¶çš„åšæ³•æ—¶ï¼Œåˆ©ç”¨é”æœºåˆ¶ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è°ƒç”¨ socket send æ–¹æ³•ã€‚è¿™é‡Œç»™å‡ºä¸€æ®µä¼ªä»£ç ï¼Œå‡è®¾ TcpConnection å¯¹è±¡è¡¨ç¤ºæŸè·¯è¿æ¥ï¼Œæ— è®ºç½‘ç»œçº¿ç¨‹è¿˜æ˜¯ä¸šåŠ¡çº¿ç¨‹å¤„ç†å®Œæ•°æ®åéœ€è¦å‘é€æ•°æ®ï¼Œåˆ™ä½¿ç”¨ï¼š\n123456void TcpConnection::sendData(const std::string&amp; data)&#123;\t//åŠ ä¸Šé”\tstd::lock_guard&lt;std::mutex&gt; scoped_lock(m_mutexForConnection);\t//åœ¨è¿™é‡Œè°ƒç”¨ send&#125;\n\næ–¹æ³•ä¸€çš„åšæ³•åœ¨è®¾è®¡ä¸Šæ¥è¯´ï¼Œå­˜åœ¨è®©äººä¸æ»¡æ„çš„åœ°æ–¹ï¼Œå³æ•°æ®å‘é€åº”è¯¥å±äºç½‘ç»œå±‚è‡ªå·±çš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯å…¶ä»–æ¨¡å—ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯ä¸šåŠ¡çº¿ç¨‹ï¼‰å¼ºè¡ŒæŠ¢å¤ºè¿‡æ¥è¶Šä¿ä»£åº–ã€‚\næ–¹æ³•äºŒ\nå‰é¢ç« èŠ‚ä»‹ç»äº†å­˜åœ¨å®šæ—¶å™¨ç»“æ„çš„æƒ…å†µï¼Œç½‘ç»œçº¿ç¨‹ç»“æ„å˜æˆå¦‚ä¸‹æµç¨‹ï¼š\n12345678while (!m_bQuitFlag)&#123;\tcheck_and_handle_timers();\t\tepoll_or_select_func();\thandle_io_events();&#125;\n\nä¸šåŠ¡çº¿ç¨‹å¯ä»¥å°†éœ€è¦å‘é€çš„æ•°æ®æ”¾å…¥å¦å¤–ä¸€ä¸ªå…±äº«åŒºåŸŸä¸­ï¼ˆä¾‹å¦‚ç›¸åº”çš„ TcpConnection å¯¹è±¡çš„ä¸€ä¸ªæˆå‘˜å˜é‡ä¸­ï¼‰ï¼Œå®šæ—¶å™¨å®šæ—¶ä»è¿™ä¸ªå…±äº«åŒºåŸŸå–å‡ºæ¥ï¼Œå†å‘é€å‡ºå»ï¼Œè¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯ç½‘ç»œçº¿ç¨‹åšäº†å®ƒè¯¥åšçš„äº‹æƒ…ï¼Œç¼ºç‚¹æ˜¯éœ€è¦æ·»åŠ å®šæ—¶å™¨ï¼Œè®©ç¨‹åºé€»è¾‘å˜å¾—å¤æ‚ï¼Œä¸”å®šæ—¶å™¨æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´æ‰ä¼šè§¦å‘ï¼Œå‘é€çš„æ•°æ®å¯èƒ½ä¼šæœ‰ä¸€å®šçš„å»¶è¿Ÿã€‚\næ–¹æ³•ä¸‰\nåˆ©ç”¨çº¿ç¨‹æ‰§è¡Œæµä¸­çš„ handle_other_things() æ–¹æ³•ï¼Œå†æ¥çœ‹ä¸‹å‰é¢ç« èŠ‚ä¸­ä»‹ç»çš„åŸºæœ¬ç»“æ„ï¼š\n12345678while (!m_bQuitFlag)&#123;\tepoll_or_select_func();\thandle_io_events();\thandle_other_things();&#125;\n\næˆ‘ä»¬åœ¨ã€Šone thread one loop æ€æƒ³ã€‹ç« èŠ‚ä»‹ç»äº† handle_other_things() å‡½æ•°å¯ä»¥åšä¸€äº›â€œå…¶ä»–äº‹æƒ…â€ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨éœ€è¦æ‰§è¡Œæ—¶é€šè¿‡å‰é¢ç« èŠ‚ä»‹ç»çš„å”¤é†’æœºåˆ¶ç«‹å³è¢«å”¤é†’æ‰§è¡Œã€‚ä¸šåŠ¡çº¿ç¨‹å°†æ•°æ®æ”¾å…¥æŸä¸ªå…±äº«åŒºåŸŸä¸­ï¼ˆè¿™ä¸€æ­¥å’Œæ–¹æ³•äºŒä»‹ç»çš„ä¸€æ ·ï¼‰ï¼Œç„¶åæ·»åŠ  â€œother_thingsâ€ ï¼Œåœ¨ handle_other_things() ä¸­æ‰§è¡Œæ•°æ®çš„å‘é€ã€‚\nå¦‚æœè¯»è€…èƒ½æ¸…æ™°æ˜ç™½åœ°çœ‹åˆ°è¿™é‡Œï¼Œè¯´æ˜æ‚¨å¤§è‡´æ˜ç™½äº†ä¸€ä¸ªä¸é”™çš„æœåŠ¡å™¨æ¡†æ¶æ˜¯æ€ä¹ˆå›äº‹äº†ã€‚ä¸Šé¢ä»‹ç»çš„æœåŠ¡å™¨ç»“æ„æ˜¯ç›®å‰ä¸»æµçš„åŸºäº Reactor æ¨¡å¼çš„æœåŠ¡ç¨‹åºçš„é€šç”¨ç»“æ„ï¼Œä¾‹å¦‚ libeventã€libuvã€‚\nå¦‚æœè¯»è€…æœ‰å…´è¶£ï¼Œå’±ä»¬å¯ä»¥å†è¿›ä¸€æ­¥æ·±å…¥è®¨è®ºä¸€ä¸‹ã€‚\nå®é™…åº”ç”¨ä¸­ï¼Œå¾ˆå¤šç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å¤„ç†å…¶å®æ˜¯ä¸è€—æ—¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›ä¸šåŠ¡é€»è¾‘å¤„ç†é€Ÿåº¦å¾ˆå¿«ã€‚ç”±äº CPU æ ¸æ•°æœ‰é™ï¼Œå½“çº¿ç¨‹æ•°é‡è¶…è¿‡ CPU æ•°é‡æ—¶ï¼Œå„ä¸ªçº¿ç¨‹ï¼ˆç½‘ç»œçº¿ç¨‹å’Œä¸šåŠ¡çº¿ç¨‹ï¼‰ä¹Ÿä¸æ˜¯çœŸæ­£åœ°å¹¶è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆå³ä½¿å¼€äº†ä¸€ç»„ä¸šåŠ¡çº¿ç¨‹ä¹Ÿä¸ä¸€å®šèƒ½çœŸæ­£åœ°å¹¶å‘æ‰§è¡Œï¼Œè€Œä¸šåŠ¡é€»è¾‘å¤„ç†å¹¶ä¸è€—æ—¶ï¼Œä¸ä¼šå½±å“ç½‘ç»œçº¿ç¨‹çš„æ‰§è¡Œæ•ˆç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸å¦‚å°±åœ¨ç½‘ç»œçº¿ç¨‹é‡Œé¢ç›´æ¥å¤„ç†ã€‚\nä¸Šæ–‡ä»‹ç»äº†åœ¨ handle_io_events() æ–¹æ³•ä¸­ç›´æ¥å¤„ç†ï¼Œå¦‚æœå¤„ç†çš„ä¸šåŠ¡é€»è¾‘ä¼šäº§ç”Ÿæ–°çš„å…¶ä»–ä»»åŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠ•é€’ â€œother_thingsâ€ï¼Œæœ€ç»ˆäº¤ç»™ handle_other_things() æ–¹æ³•æ¥å¤„ç†ã€‚æ­¤æ—¶çš„æœåŠ¡å™¨ç¨‹åºç»“æ„å¦‚ä¸‹ï¼š\nç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼šè¿™ç§æ–¹å¼ä»…é™äº handle_io_events() æˆ– handle_other_things() é‡Œé¢ä¸ä¼šæœ‰è€—æ—¶çš„é€»è¾‘ï¼Œæ‰å¯ä»¥æ›¿ä»£ä¸“é—¨å¼€ä¸šåŠ¡çº¿ç¨‹ï¼Œå¦‚æœæœ‰è€—æ—¶æ“ä½œè¿˜å¾—è€è€å®å®å•ç‹¬å¼€ä¸šåŠ¡çº¿ç¨‹ã€‚è™½ç„¶çº¿ç¨‹æ•°é‡è¶…è¿‡ CPU æ•°é‡æ—¶ï¼Œå„ä¸ªçº¿ç¨‹ä¸ä¼šå¾—åˆ°çœŸæ­£çš„å¹¶è¡Œï¼Œä½†é‚£æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹è°ƒåº¦çš„äº‹æƒ…äº†ï¼Œåº”ç”¨å±‚å¼€å‘ä¸å¿…å…³å¿ƒè¿™ç‚¹ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/ä¸šåŠ¡æ•°æ®å¤„ç†ä¸€å®šè¦å•ç‹¬å¼€çº¿ç¨‹å—","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"51dbd98ea18bf4e97e2efcaab62e6cec","title":"ã€è½¬è½½ã€‘C++é«˜æ€§èƒ½æœåŠ¡å™¨ç½‘ç»œæ¡†æ¶è®¾è®¡ç»†èŠ‚","content":"C++ é«˜æ€§èƒ½æœåŠ¡å™¨ç½‘ç»œæ¡†æ¶è®¾è®¡ç»†èŠ‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°†ä»‹ç»æœåŠ¡å™¨çš„å¼€å‘ï¼Œå¹¶ä»å¤šä¸ªæ–¹é¢æ¢ç©¶å¦‚ä½•å¼€å‘ä¸€æ¬¾é«˜æ€§èƒ½é«˜å¹¶å‘çš„æœåŠ¡å™¨ç¨‹åºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸€èˆ¬å¤§å‹æœåŠ¡å™¨ï¼Œå…¶å¤æ‚ç¨‹åº¦åœ¨äºå…¶ä¸šåŠ¡ï¼Œè€Œä¸æ˜¯åœ¨äºå…¶ä»£ç å·¥ç¨‹çš„åŸºæœ¬æ¡†æ¶ã€‚å¤§å‹æœåŠ¡å™¨ä¸€èˆ¬æœ‰å¤šä¸ªæœåŠ¡ç»„æˆï¼Œå¯èƒ½ä¼šæ”¯æŒCDNï¼Œæˆ–è€…æ”¯æŒæ‰€è°“çš„â€œåˆ†å¸ƒå¼â€ç­‰ï¼Œè¿™ç¯‡æ–‡ç« ä¸ä¼šä»‹ç»è¿™äº›ä¸œè¥¿ï¼Œå› ä¸ºä¸ç®¡ç»“æ„å¤šä¹ˆå¤æ‚çš„æœåŠ¡å™¨ï¼Œéƒ½æ˜¯ç”±å•ä¸ªæœåŠ¡å™¨ç»„æˆçš„ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« çš„ä¾§é‡ç‚¹æ˜¯è®¨è®ºå•ä¸ªæœåŠ¡ç¨‹åºçš„ç»“æ„ï¼Œè€Œä¸”è¿™é‡Œçš„ç»“æ„æŒ‡çš„ä¹Ÿæ˜¯å•ä¸ªæœåŠ¡å™¨çš„ç½‘ç»œé€šä¿¡å±‚ç»“æ„ï¼Œå¦‚æœä½ èƒ½çœŸæ­£åœ°ç†è§£äº†æˆ‘æ‰€è¯´çš„ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªåŸºç¡€çš„ç»“æ„ä¸Šé¢å¼€å±•ä»»ä½•ä¸šåŠ¡éƒ½æ˜¯å¯ä»¥çš„ï¼Œä¹Ÿå¯ä»¥å°†è¿™ç§ç»“æ„æ‰©å±•æˆå¤æ‚çš„å¤šä¸ªæœåŠ¡å™¨ç»„ï¼Œä¾‹å¦‚â€œåˆ†å¸ƒå¼â€æœåŠ¡ã€‚æ–‡ä¸­çš„ä»£ç ç¤ºä¾‹è™½ç„¶æ˜¯ä»¥C++ä¸ºä¾‹ï¼Œä½†åŒæ ·é€‚åˆJavaï¼ˆæˆ‘æœ¬äººä¹Ÿæ˜¯Javaå¼€å‘è€…ï¼‰ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡Javaå¯èƒ½åœ¨åŸºæœ¬çš„æ“ä½œç³»ç»Ÿç½‘ç»œé€šä¿¡APIçš„åŸºç¡€ä¸Šç”¨è™šæ‹ŸæœºåŒ…è£¹äº†ä¸€å±‚æ¥å£è€Œå·²ï¼ˆJavaç”šè‡³å¯èƒ½åŸºäºä¸€äº›å¸¸ç”¨çš„ç½‘ç»œé€šä¿¡æ¡†æ¶æ€æƒ³æä¾›äº†ä¸€äº›ç°æˆçš„APIï¼Œä¾‹å¦‚NIOï¼‰ã€‚æœ‰é‰´äºæ­¤ï¼Œè¿™ç¯‡æ–‡ç« ä¸è®¨è®ºé‚£äº›å¤§è€Œç©ºã€æ³›æ³›è€Œè°ˆçš„æŠ€æœ¯æœ¯è¯­ï¼Œè€Œæ˜¯è®²çš„æ˜¯å®å®åœ¨åœ¨çš„èƒ½æŒ‡å¯¼è¯»è€…åœ¨å®é™…å·¥ä½œä¸­å®è·µçš„ç¼–ç æ–¹æ¡ˆæˆ–ä¼˜åŒ–å·²æœ‰ç¼–ç çš„æ–¹æ³•ã€‚å¦å¤–è¿™é‡Œè®¨è®ºçš„æŠ€æœ¯åŒæ—¶æ¶‰åŠwindowså’Œlinuxä¸¤ä¸ªå¹³å°ã€‚\næ‰€è°“é«˜æ€§èƒ½å°±æ˜¯æœåŠ¡å™¨èƒ½æµç•…åœ°å¤„ç†å„ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥å¹¶å°½é‡ä½å»¶è¿Ÿåœ°åº”ç­”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼›æ‰€è°“é«˜å¹¶å‘ï¼Œä¸ä»…æŒ‡çš„æ˜¯æœåŠ¡å™¨å¯ä»¥åŒæ—¶æ”¯æŒå¤šçš„å®¢æˆ·ç«¯è¿æ¥ï¼Œè€Œä¸”è¿™äº›å®¢æˆ·ç«¯åœ¨è¿æ¥æœŸé—´å†…ä¼šä¸æ–­ä¸æœåŠ¡å™¨æœ‰æ•°æ®æ¥å¾€ã€‚ç½‘ç»œä¸Šç»å¸¸æœ‰å„ç§ç½‘ç»œåº“å·ç§°å•ä¸ªæœåŠ¡èƒ½åŒæ—¶æ”¯æŒç™¾ä¸‡ç”šè‡³åƒä¸‡çš„å¹¶å‘ï¼Œç„¶åæˆ‘å®é™…å»çœ‹äº†ä¸‹ï¼Œç»“æœå‘ç°åªæ˜¯èƒ½åŒæ—¶æ”¯æŒå¾ˆå¤šçš„è¿æ¥è€Œå·²ã€‚å¦‚æœä¸€ä¸ªæœåŠ¡å™¨èƒ½å•çº¯åœ°æ¥å—ï½ä¸ªè¿æ¥ï¼ˆï½å¯èƒ½å¾ˆå¤§ï¼‰ï¼Œä½†æ˜¯ä¸èƒ½æœ‰æ¡ä¸ç´Šåœ°å¤„ç†ä¸è¿™äº›è¿æ¥ä¹‹é—´çš„æ•°æ®æ¥å¾€ä¹Ÿæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œè¿™ç§æœåŠ¡å™¨æ¡†æ¶åªæ˜¯â€œç©å…·å‹â€çš„ï¼Œå¯¹å®é™…ç”Ÿäº§å’Œåº”ç”¨æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚\nè¿™ç¯‡æ–‡ç« å°†ä»ä¸¤ä¸ªæ–¹é¢æ¥ä»‹ç»ï¼Œä¸€ä¸ªæ˜¯æœåŠ¡å™¨ä¸­çš„åŸºç¡€çš„ç½‘ç»œé€šä¿¡éƒ¨ä»¶ï¼›å¦å¤–ä¸€ä¸ªæ˜¯ï¼Œå¦‚ä½•åˆ©ç”¨è¿™äº›åŸºç¡€é€šä¿¡éƒ¨ä»¶æ•´åˆæˆä¸€ä¸ªå®Œæ•´çš„é«˜æ•ˆçš„æœåŠ¡å™¨æ¡†æ¶ã€‚æ³¨æ„ï¼šæœ¬æ–‡ä»¥ä¸‹å†…å®¹ä¸­çš„å®¢æˆ·ç«¯æ˜¯ç›¸å¯¹æ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯è¿æ¥åˆ°å½“å‰è®¨è®ºçš„æœåŠ¡ç¨‹åºçš„ç»ˆç«¯ï¼Œæ‰€ä»¥è¿™é‡Œçš„å®¢æˆ·ç«¯æ—¢å¯èƒ½æ˜¯æˆ‘ä»¬ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å®¢æˆ·ç«¯ç¨‹åºï¼Œä¹Ÿå¯èƒ½æ˜¯è¿æ¥è¯¥æœåŠ¡çš„å…¶ä»–æœåŠ¡å™¨ç¨‹åºã€‚\nä¸€ã€ç½‘ç»œé€šä¿¡éƒ¨ä»¶ æŒ‰ä¸Šé¢ä»‹ç»çš„æ€è·¯ï¼Œæˆ‘ä»¬å…ˆä»æœåŠ¡ç¨‹åºçš„ç½‘ç»œé€šä¿¡éƒ¨ä»¶å¼€å§‹ä»‹ç»ã€‚\nï¼ˆä¸€ï¼‰ã€éœ€è¦è§£å†³çš„é—®é¢˜æ—¢ç„¶æ˜¯æœåŠ¡å™¨ç¨‹åºè‚¯å®šä¼šæ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡éƒ¨åˆ†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç¨‹åºçš„ç½‘ç»œé€šä¿¡æ¨¡å—è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿç›®å‰ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œå¦‚libeventã€boost asioã€ACEï¼Œä½†éƒ½ç½‘ç»œé€šä¿¡çš„å¸¸è§çš„æŠ€æœ¯æ‰‹æ®µéƒ½å¤§åŒå°å¼‚ï¼Œè‡³å°‘è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š\n\nå¦‚ä½•æ£€æµ‹æœ‰æ–°å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\nå¦‚ä½•æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\nå¦‚ä½•æ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ•°æ®å‘æ¥ï¼Ÿ\nå¦‚ä½•æ”¶å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Ÿ\nå¦‚ä½•æ£€æµ‹è¿æ¥å¼‚å¸¸ï¼Ÿå‘ç°è¿æ¥å¼‚å¸¸ä¹‹åï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ\nå¦‚ä½•ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Ÿ\nå¦‚ä½•åœ¨ç»™å®¢æˆ·ç«¯å‘å®Œæ•°æ®åå…³é—­è¿æ¥ï¼Ÿ\n\nç¨å¾®æœ‰ç‚¹ç½‘ç»œåŸºç¡€çš„äººï¼Œéƒ½èƒ½å›ç­”ä¸Šé¢è¯´çš„å…¶ä¸­å‡ ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ç”¨socket APIçš„acceptå‡½æ•°ï¼Œæ”¶å–å®¢æˆ·ç«¯æ•°æ®ç”¨recvå‡½æ•°ï¼Œç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ç”¨sendå‡½æ•°ï¼Œæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ–°è¿æ¥å’Œå®¢æˆ·ç«¯æ˜¯å¦æœ‰æ–°æ•°æ®å¯ä»¥ç”¨IO multiplexingæŠ€æœ¯ï¼ˆIOå¤ç”¨ï¼‰çš„selectã€pollã€epollç­‰socket APIã€‚ç¡®å®æ˜¯è¿™æ ·çš„ï¼Œè¿™äº›åŸºç¡€çš„socket APIæ„æˆäº†æœåŠ¡å™¨ç½‘ç»œé€šä¿¡çš„åœ°åŸºï¼Œä¸ç®¡ç½‘ç»œé€šä¿¡æ¡†æ¶è®¾è®¡çš„å¦‚ä½•å·§å¦™ï¼Œéƒ½æ˜¯åœ¨è¿™äº›åŸºç¡€çš„socket APIçš„åŸºç¡€ä¸Šæ„å»ºçš„ã€‚ä½†æ˜¯å¦‚ä½•å·§å¦™åœ°ç»„ç»‡è¿™äº›åŸºç¡€çš„socket APIï¼Œæ‰æ˜¯é—®é¢˜çš„å…³é”®ã€‚æˆ‘ä»¬è¯´æœåŠ¡å™¨å¾ˆé«˜æ•ˆï¼Œæ”¯æŒé«˜å¹¶å‘ï¼Œå®é™…ä¸Šåªæ˜¯ä¸€ä¸ªæŠ€æœ¯å®ç°æ‰‹æ®µï¼Œä¸ç®¡æ€æ ·ï¼Œä»è½¯ä»¶å¼€å‘çš„è§’åº¦æ¥è®²æ— éå°±æ˜¯ä¸€ä¸ªç¨‹åºè€Œå·²ï¼Œæ‰€ä»¥ï¼Œåªè¦ç¨‹åºèƒ½æœ€å¤§å¯èƒ½åœ°æ»¡è¶³â€œå°½é‡å‡å°‘ç­‰å¾…æˆ–è€…ä¸ç­‰å¾…â€è¿™ä¸€åŸåˆ™å°±æ˜¯é«˜æ•ˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´é«˜æ•ˆä¸æ˜¯â€œå¿™çš„å¿™æ­»ï¼Œé—²çš„é—²æ­»â€ï¼Œè€Œæ˜¯å¤§å®¶éƒ½å¯ä»¥é—²ç€ï¼Œä½†æ˜¯å¦‚æœæœ‰æ´»è¦å¹²ï¼Œå¤§å®¶å°½é‡ä¸€èµ·å¹²ï¼Œè€Œä¸æ˜¯ä¸€éƒ¨åˆ†å¿™ç€ä¾æ¬¡åšäº‹æƒ…123456789ï¼Œå¦å¤–ä¸€éƒ¨åˆ†é—²åœ¨é‚£é‡Œæ— æ‰€äº‹äº‹ã€‚è¯´çš„å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸¾ä¸€äº›ä¾‹å­å…·ä½“æ¥è¯´æ˜ä¸€ä¸‹ã€‚ä¾‹å¦‚ï¼š\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œrecvå‡½æ•°å¦‚æœæ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œçº¿ç¨‹å°±ä¼šé˜»å¡åœ¨é‚£é‡Œï¼›\né»˜è®¤æƒ…å†µä¸‹ï¼Œsendå‡½æ•°ï¼Œå¦‚æœtcpçª—å£ä¸æ˜¯è¶³å¤Ÿå¤§ï¼Œæ•°æ®å‘ä¸å‡ºå»ä¹Ÿä¼šé˜»å¡åœ¨é‚£é‡Œï¼›\nconnectå‡½æ•°é»˜è®¤è¿æ¥å¦å¤–ä¸€ç«¯çš„æ—¶å€™ï¼Œä¹Ÿä¼šé˜»å¡åœ¨é‚£é‡Œï¼›\nåˆæˆ–è€…æ˜¯ç»™å¯¹ç«¯å‘é€ä¸€ä»½æ•°æ®ï¼Œéœ€è¦ç­‰å¾…å¯¹ç«¯å›ç­”ï¼Œå¦‚æœå¯¹æ–¹ä¸€ç›´ä¸åº”ç­”ï¼Œå½“å‰çº¿ç¨‹å°±é˜»å¡åœ¨è¿™é‡Œã€‚\n\nä»¥ä¸Šéƒ½ä¸æ˜¯é«˜æ•ˆæœåŠ¡å™¨çš„å¼€å‘æ€ç»´æ–¹å¼ï¼Œå› ä¸ºä¸Šé¢çš„ä¾‹å­éƒ½ä¸æ»¡è¶³â€œå°½é‡å‡å°‘ç­‰å¾…â€çš„åŸåˆ™ï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦ç­‰å¾…å‘¢ï¼Ÿæœ‰æ²¡ç”¨ä¸€ç§æ–¹æ³•ï¼Œè¿™äº›è¿‡ç¨‹ä¸éœ€è¦ç­‰å¾…ï¼Œæœ€å¥½æ˜¯ä¸ä»…ä¸éœ€è¦ç­‰å¾…ï¼Œè€Œä¸”è¿™äº›äº‹æƒ…å®Œæˆä¹‹åèƒ½é€šçŸ¥æˆ‘ã€‚è¿™æ ·åœ¨è¿™äº›æœ¬æ¥ç”¨äºç­‰å¾…çš„cpuæ—¶é—´ç‰‡å†…ï¼Œæˆ‘å°±å¯ä»¥åšä¸€äº›å…¶ä»–çš„äº‹æƒ…ã€‚æœ‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸‹æ–‡è¦è®¨è®ºçš„IO MultiplexingæŠ€æœ¯ï¼ˆIOå¤ç”¨æŠ€æœ¯ï¼‰ã€‚\nï¼ˆäºŒï¼‰ã€å‡ ç§IOå¤ç”¨æœºåˆ¶çš„æ¯”è¾ƒç›®å‰windowsç³»ç»Ÿæ”¯æŒselectã€WSAAsyncSelectã€WSAEventSelectã€å®Œæˆç«¯å£ï¼ˆIOCPï¼‰ï¼Œlinuxç³»ç»Ÿæ”¯æŒselectã€pollã€epollã€‚è¿™é‡Œæˆ‘ä»¬ä¸å…·ä½“ä»‹ç»æ¯ä¸ªå…·ä½“çš„å‡½æ•°çš„ç”¨æ³•ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ç‚¹æ·±å±‚æ¬¡çš„ä¸œè¥¿ï¼Œä»¥ä¸Šåˆ—ä¸¾çš„APIå‡½æ•°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå±‚æ¬¡ï¼š\n\nå±‚æ¬¡ä¸€ selectå’Œpoll\nå±‚æ¬¡äºŒ WSAAsyncSelectã€WSAEventSelectã€å®Œæˆç«¯å£ï¼ˆIOCPï¼‰ã€epoll\n\nä¸ºä»€ä¹ˆè¿™ä¹ˆåˆ†å‘¢ï¼Ÿå…ˆæ¥ä»‹ç»ç¬¬ä¸€å±‚æ¬¡ï¼Œselectå’Œpollå‡½æ•°æœ¬è´¨ä¸Šè¿˜æ˜¯åœ¨ä¸€å®šæ—¶é—´å†…ä¸»åŠ¨å»æŸ¥è¯¢socketå¥æŸ„ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªä¹Ÿå¯èƒ½æ˜¯å¤šä¸ªï¼‰ä¸Šæ˜¯å¦æœ‰äº‹ä»¶ï¼Œæ¯”å¦‚å¯è¯»äº‹ä»¶ï¼Œå¯å†™äº‹ä»¶æˆ–è€…å‡ºé”™äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´å†…å»ä¸»åŠ¨å»åšè¿™äº›æ£€æµ‹ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…æ£€æµ‹å‡ºä¸€äº›äº‹ä»¶æ¥ï¼Œæˆ‘ä»¬è¿™æ®µæ—¶é—´å°±ç®—æ²¡ç™½èŠ±ï¼Œä½†æ˜¯å€˜è‹¥è¿™æ®µæ—¶é—´å†…æ²¡æœ‰äº‹ä»¶å‘¢ï¼Ÿæˆ‘ä»¬åªèƒ½æ˜¯åšæ— ç”¨åŠŸäº†ï¼Œè¯´ç™½äº†ï¼Œè¿˜æ˜¯åœ¨æµªè´¹æ—¶é—´ï¼Œå› ä¸ºå‡å¦‚ä¸€ä¸ªæœåŠ¡å™¨æœ‰å¤šä¸ªè¿æ¥ï¼Œåœ¨cpuæ—¶é—´ç‰‡æœ‰é™çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬èŠ±è´¹äº†ä¸€å®šçš„æ—¶é—´æ£€æµ‹äº†ä¸€éƒ¨åˆ†socketè¿æ¥ï¼Œå´å‘ç°å®ƒä»¬ä»€ä¹ˆäº‹ä»¶éƒ½æ²¡æœ‰ï¼Œè€Œåœ¨è¿™æ®µæ—¶é—´å†…æˆ‘ä»¬å´æœ‰ä¸€äº›äº‹æƒ…éœ€è¦å¤„ç†ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦èŠ±æ—¶é—´å»åšè¿™ä¸ªæ£€æµ‹å‘¢ï¼ŸæŠŠè¿™ä¸ªæ—¶é—´ç”¨åœ¨åšæˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…ä¸å¥½å—ï¼Ÿæ‰€ä»¥å¯¹äºæœåŠ¡å™¨ç¨‹åºæ¥è¯´ï¼Œè¦æƒ³é«˜æ•ˆï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å…èŠ±è´¹æ—¶é—´ä¸»åŠ¨å»æŸ¥è¯¢ä¸€äº›socketæ˜¯å¦æœ‰äº‹ä»¶ï¼Œè€Œæ˜¯ç­‰è¿™äº›socketæœ‰äº‹ä»¶çš„æ—¶å€™å‘Šè¯‰æˆ‘ä»¬å»å¤„ç†ã€‚è¿™ä¹Ÿå°±æ˜¯å±‚æ¬¡äºŒçš„å„ä¸ªå‡½æ•°åšçš„äº‹æƒ…ï¼Œå®ƒä»¬å®é™…ç›¸å½“äºå˜ä¸»åŠ¨æŸ¥è¯¢æ˜¯å¦æœ‰äº‹ä»¶ä¸ºå½“æœ‰äº‹ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šå‘Šè¯‰æˆ‘ä»¬ï¼Œæ­¤æ—¶æˆ‘ä»¬å†å»å¤„ç†ï¼Œä¹Ÿå°±æ˜¯â€œå¥½é’¢ç”¨åœ¨åˆ€åˆƒâ€ä¸Šäº†ã€‚åªä¸è¿‡å±‚æ¬¡äºŒçš„å‡½æ•°é€šçŸ¥æˆ‘ä»¬çš„æ–¹å¼æ˜¯å„ä¸ç›¸åŒï¼Œæ¯”å¦‚WSAAsyncSelectæ˜¯åˆ©ç”¨windowsçª—å£æ¶ˆæ¯é˜Ÿåˆ—çš„äº‹ä»¶æœºåˆ¶æ¥é€šçŸ¥æˆ‘ä»¬è®¾å®šçš„çª—å£è¿‡ç¨‹å‡½æ•°ï¼ŒIOCPæ˜¯åˆ©ç”¨GetQueuedCompletionStatusè¿”å›æ­£ç¡®çš„çŠ¶æ€ï¼Œepollæ˜¯epoll_waitå‡½æ•°è¿”å›è€Œå·²ã€‚\nä¾‹å¦‚ï¼Œconnectå‡½æ•°è¿æ¥å¦å¤–ä¸€ç«¯ï¼Œå¦‚æœç”¨äºè¿æ¥socketæ˜¯éé˜»å¡çš„ï¼Œé‚£ä¹ˆconnectè™½ç„¶ä¸èƒ½ç«‹åˆ»è¿æ¥å®Œæˆï¼Œä½†æ˜¯ä¹Ÿæ˜¯ä¼šç«‹åˆ»è¿”å›ï¼Œæ— éœ€ç­‰å¾…ï¼Œç­‰è¿æ¥å®Œæˆä¹‹åï¼ŒWSAAsyncSelectä¼šè¿”å›FD_CONNECTäº‹ä»¶å‘Šè¯‰æˆ‘ä»¬è¿æ¥æˆåŠŸï¼Œepollä¼šäº§ç”ŸEPOLLOUTäº‹ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çŸ¥é“è¿æ¥å®Œæˆã€‚ç”šè‡³socketæœ‰æ•°æ®å¯è¯»æ—¶ï¼ŒWSAAsyncSelectäº§ç”ŸFD_READäº‹ä»¶ï¼Œepolläº§ç”ŸEPOLLINäº‹ä»¶ï¼Œç­‰ç­‰ã€‚æ‰€ä»¥æœ‰äº†ä¸Šé¢çš„è®¨è®ºï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ç½‘ç»œé€šä¿¡æ£€æµ‹å¯è¯»å¯å†™æˆ–è€…å‡ºé”™äº‹ä»¶çš„æ­£ç¡®å§¿åŠ¿ã€‚è¿™æ˜¯æˆ‘è¿™é‡Œæå‡ºçš„ç¬¬äºŒä¸ªåŸåˆ™ï¼šå°½é‡å‡å°‘åšæ— ç”¨åŠŸçš„æ—¶é—´ã€‚è¿™ä¸ªåœ¨æœåŠ¡ç¨‹åºèµ„æºå¤Ÿç”¨çš„æƒ…å†µä¸‹å¯èƒ½ä½“ç°ä¸å‡ºæ¥ä»€ä¹ˆä¼˜åŠ¿ï¼Œä½†æ˜¯å¦‚æœæœ‰å¤§é‡çš„ä»»åŠ¡è¦å¤„ç†ï¼Œè¿™é‡Œå°±æˆäº†æ€§èƒ½çš„ä¸€ä¸ªç“¶é¢ˆã€‚\nï¼ˆä¸‰ï¼‰ã€æ£€æµ‹ç½‘ç»œäº‹ä»¶çš„æ­£ç¡®å§¿åŠ¿æ ¹æ®ä¸Šé¢çš„ä»‹ç»ï¼Œç¬¬ä¸€ï¼Œä¸ºäº†é¿å…æ— æ„ä¹‰çš„ç­‰å¾…æ—¶é—´ï¼Œç¬¬äºŒï¼Œä¸é‡‡ç”¨ä¸»åŠ¨æŸ¥è¯¢å„ä¸ªsocketçš„äº‹ä»¶ï¼Œè€Œæ˜¯é‡‡ç”¨ç­‰å¾…æ“ä½œç³»ç»Ÿé€šçŸ¥æˆ‘ä»¬æœ‰äº‹ä»¶çš„çŠ¶æ€çš„ç­–ç•¥ã€‚æˆ‘ä»¬çš„socketéƒ½è¦è®¾ç½®æˆéé˜»å¡çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬å›åˆ°æ ç›®ï¼ˆä¸€ï¼‰ä¸­æåˆ°çš„ä¸ƒä¸ªé—®é¢˜ï¼š\n\nå¦‚ä½•æ£€æµ‹æœ‰æ–°å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\n\nå¦‚ä½•æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ é»˜è®¤acceptå‡½æ•°ä¼šé˜»å¡åœ¨é‚£é‡Œï¼Œå¦‚æœepollæ£€æµ‹åˆ°ä¾¦å¬socketä¸Šæœ‰EPOLLINäº‹ä»¶ï¼Œæˆ–è€…WSAAsyncSelectæ£€æµ‹åˆ°æœ‰FD_ACCEPTäº‹ä»¶ï¼Œé‚£ä¹ˆå°±è¡¨æ˜æ­¤æ—¶æœ‰æ–°è¿æ¥åˆ°æ¥ï¼Œè¿™ä¸ªæ—¶å€™è°ƒç”¨acceptå‡½æ•°ï¼Œå°±ä¸ä¼šé˜»å¡äº†ã€‚å½“ç„¶äº§ç”Ÿçš„æ–°socketä½ åº”è¯¥ä¹Ÿè®¾ç½®æˆéé˜»å¡çš„ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨æ–°socketä¸Šæ”¶å‘æ•°æ®äº†ã€‚\n ã€€ã€€\n\nå¦‚ä½•æ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ•°æ®å‘æ¥ï¼Ÿ\n\nå¦‚ä½•æ”¶å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Ÿ åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥åœ¨socketä¸Šæœ‰å¯è¯»äº‹ä»¶çš„æ—¶å€™æ‰å»æ”¶å–æ•°æ®ï¼Œè¿™æ ·æˆ‘ä»¬è°ƒç”¨recvæˆ–è€…readå‡½æ•°æ—¶ä¸ç”¨ç­‰å¾…ï¼Œè‡³äºä¸€æ¬¡æ€§æ”¶å¤šå°‘æ•°æ®å¥½å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šï¼Œç”šè‡³ä½ å¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢åå¤recvæˆ–è€…readï¼Œå¯¹äºéé˜»å¡æ¨¡å¼çš„socketï¼Œå¦‚æœæ²¡æœ‰æ•°æ®äº†ï¼Œrecvæˆ–è€…readä¹Ÿä¼šç«‹åˆ»è¿”å›ï¼Œé”™è¯¯ç EWOULDBLOCKä¼šè¡¨æ˜å½“å‰å·²ç»æ²¡æœ‰æ•°æ®äº†ã€‚ç¤ºä¾‹ï¼š\n bool CIUSocket::Recv() { int nRet &#x3D; 0; while(true) {     char buff[512];     nRet &#x3D; ::recv(m_hSocket, buff, 512, 0);     if(nRet &#x3D;&#x3D; SOCKET_ERROR)     {         if (::WSAGetLastError() &#x3D;&#x3D; WSAEWOULDBLOCK)            break;         else             return false;     }     else if(nRet &lt; 1)         return false;     m_strRecvBuf.append(buff, nRet);     ::Sleep(1); } return true; }\n\nå¦‚ä½•æ£€æµ‹è¿æ¥å¼‚å¸¸ï¼Ÿå‘ç°è¿æ¥å¼‚å¸¸ä¹‹åï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ åŒæ ·å½“æˆ‘ä»¬æ”¶åˆ°å¼‚å¸¸äº‹ä»¶åä¾‹å¦‚EPOLLERRæˆ–å…³é—­äº‹ä»¶FD_CLOSEï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†æœ‰å¼‚å¸¸äº§ç”Ÿï¼Œæˆ‘ä»¬å¯¹å¼‚å¸¸çš„å¤„ç†ä¸€èˆ¬å°±æ˜¯å…³é—­å¯¹åº”çš„socketã€‚å¦å¤–ï¼Œå¦‚æœsend&#x2F;recvæˆ–è€…read&#x2F;writeå‡½æ•°å¯¹ä¸€ä¸ªsocketè¿›è¡Œæ“ä½œæ—¶ï¼Œå¦‚æœè¿”å›0ï¼Œé‚£è¯´æ˜å¯¹ç«¯å·²ç»å…³é—­äº†socketï¼Œæ­¤æ—¶è¿™è·¯è¿æ¥ä¹Ÿæ²¡å¿…è¦å­˜åœ¨äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å…³é—­å¯¹åº”çš„socketã€‚\n\nå¦‚ä½•ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Ÿ è¿™ä¹Ÿæ˜¯ä¸€é“å¸¸è§çš„ç½‘ç»œé€šä¿¡é¢è¯•é¢˜ï¼ŒæŸä¸€å¹´çš„è…¾è®¯åå°å¼€å‘èŒä½å°±é—®åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ã€‚ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œæ¯”æ”¶æ•°æ®è¦ç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œä¹Ÿæ˜¯éœ€è¦è®²ç‚¹æŠ€å·§çš„ã€‚é¦–å…ˆæˆ‘ä»¬ä¸èƒ½åƒæ³¨å†Œæ£€æµ‹æ•°æ®å¯è¯»äº‹ä»¶ä¸€æ ·ä¸€å¼€å§‹å°±æ³¨å†Œæ£€æµ‹æ•°æ®å¯å†™äº‹ä»¶ï¼Œå› ä¸ºå¦‚æœæ£€æµ‹å¯å†™çš„è¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªè¦å¯¹ç«¯æ­£å¸¸æ”¶å–æ•°æ®ï¼Œæˆ‘ä»¬çš„socketå°±éƒ½æ˜¯å¯å†™çš„ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®ç›‘å¬å¯å†™äº‹ä»¶ï¼Œä¼šå¯¼è‡´é¢‘ç¹åœ°è§¦å‘å¯å†™äº‹ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æ­¤æ—¶å¹¶ä¸ä¸€å®šæœ‰æ•°æ®éœ€è¦å‘é€ã€‚æ‰€ä»¥æ­£ç¡®çš„åšæ³•æ˜¯ï¼šå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™å…ˆå°è¯•ç€å»å‘é€ï¼Œå¦‚æœå‘é€ä¸äº†æˆ–è€…åªå‘é€å‡ºå»éƒ¨åˆ†ï¼Œå‰©ä¸‹çš„æˆ‘ä»¬éœ€è¦å°†å…¶ç¼“å­˜èµ·æ¥ï¼Œç„¶åå†è®¾ç½®æ£€æµ‹è¯¥socketä¸Šå¯å†™äº‹ä»¶ï¼Œä¸‹æ¬¡å¯å†™äº‹ä»¶äº§ç”Ÿæ—¶ï¼Œå†ç»§ç»­å‘é€ï¼Œå¦‚æœè¿˜æ˜¯ä¸èƒ½å®Œå…¨å‘å‡ºå»ï¼Œåˆ™ç»§ç»­è®¾ç½®ä¾¦å¬å¯å†™äº‹ä»¶ï¼Œå¦‚æ­¤å¾€å¤ï¼Œä¸€ç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½å‘å‡ºå»ä¸ºæ­¢ã€‚ä¸€æ—¦æ‰€æœ‰æ•°æ®éƒ½å‘å‡ºå»ä»¥åï¼Œæˆ‘ä»¬è¦ç§»é™¤ä¾¦å¬å¯å†™äº‹ä»¶ï¼Œé¿å…æ— ç”¨çš„å¯å†™äº‹ä»¶é€šçŸ¥ã€‚ä¸çŸ¥é“ä½ æ³¨æ„åˆ°æ²¡æœ‰ï¼Œå¦‚æœæŸæ¬¡åªå‘å‡ºå»éƒ¨åˆ†æ•°æ®ï¼Œå‰©ä¸‹çš„æ•°æ®åº”è¯¥æš‚ä¸”å­˜èµ·æ¥ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç¼“å†²åŒºæ¥å­˜æ”¾è¿™éƒ¨åˆ†æ•°æ®ï¼Œè¿™ä¸ªç¼“å†²åŒºæˆ‘ä»¬ç§°ä¸ºâ€œå‘é€ç¼“å†²åŒºâ€ã€‚å‘é€ç¼“å†²åŒºä¸ä»…å­˜æ”¾æœ¬æ¬¡æ²¡æœ‰å‘å®Œçš„æ•°æ®ï¼Œè¿˜ç”¨æ¥å­˜æ”¾åœ¨å‘é€è¿‡ç¨‹ä¸­ï¼Œä¸Šå±‚åˆä¼ æ¥çš„æ–°çš„éœ€è¦å‘é€çš„æ•°æ®ã€‚ä¸ºäº†ä¿è¯é¡ºåºï¼Œæ–°çš„æ•°æ®åº”è¯¥è¿½åŠ åœ¨å½“å‰å‰©ä¸‹çš„æ•°æ®çš„åé¢ï¼Œå‘é€çš„æ—¶å€™ä»å‘é€ç¼“å†²åŒºçš„å¤´éƒ¨å¼€å§‹å‘é€ã€‚ä¹Ÿå°±æ˜¯è¯´å…ˆæ¥çš„å…ˆå‘é€ï¼Œåæ¥çš„åå‘é€ã€‚\n ã€€ã€€\n\nå¦‚ä½•åœ¨ç»™å®¢æˆ·ç«¯å‘å®Œæ•°æ®åå…³é—­è¿æ¥ï¼Ÿ è¿™ä¸ªé—®é¢˜æ¯”è¾ƒéš¾å¤„ç†ï¼Œå› ä¸ºè¿™é‡Œçš„â€œå‘é€å®Œâ€ä¸ä¸€å®šæ˜¯çœŸæ­£çš„å‘é€å®Œï¼Œæˆ‘ä»¬è°ƒç”¨sendæˆ–è€…writeå‡½æ•°å³ä½¿æˆåŠŸï¼Œä¹Ÿåªæ˜¯å‘æ“ä½œç³»ç»Ÿçš„åè®®æ ˆé‡Œé¢æˆåŠŸå†™å…¥æ•°æ®ï¼Œè‡³äºèƒ½å¦è¢«å‘å‡ºå»ã€ä½•æ—¶è¢«å‘å‡ºå»å¾ˆéš¾åˆ¤æ–­ï¼Œå‘å‡ºå»å¯¹æ–¹æ˜¯å¦æ”¶åˆ°å°±æ›´éš¾åˆ¤æ–­äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›®å‰åªèƒ½ç®€å•åœ°è®¤ä¸ºsendæˆ–è€…writeè¿”å›æˆ‘ä»¬å‘å‡ºæ•°æ®çš„å­—èŠ‚æ•°å¤§å°ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºâ€œå‘å®Œæ•°æ®â€äº†ã€‚ç„¶åè°ƒç”¨closeç­‰socket APIå…³é—­è¿æ¥ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è°ƒç”¨shutdownå‡½æ•°æ¥å®ç°æ‰€è°“çš„â€œåŠå…³é—­â€ã€‚å…³äºå…³é—­è¿æ¥çš„è¯é¢˜ï¼Œæˆ‘ä»¬å†å•ç‹¬å¼€ä¸€ä¸ªå°çš„æ ‡é¢˜æ¥ä¸“é—¨è®¨è®ºä¸€ä¸‹ã€‚\n\n\nï¼ˆå››ï¼‰è¢«åŠ¨å…³é—­è¿æ¥å’Œä¸»åŠ¨å…³é—­è¿æ¥åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œè¢«åŠ¨å…³é—­è¿æ¥æ˜¯ç”±äºæˆ‘ä»¬æ£€æµ‹åˆ°äº†è¿æ¥çš„å¼‚å¸¸äº‹ä»¶ï¼Œæ¯”å¦‚EPOLLERRï¼Œæˆ–è€…å¯¹ç«¯å…³é—­è¿æ¥ï¼Œsendæˆ–recvè¿”å›0ï¼Œè¿™ä¸ªæ—¶å€™è¿™è·¯è¿æ¥å·²ç»æ²¡æœ‰å­˜åœ¨å¿…è¦çš„æ„ä¹‰äº†ï¼Œæˆ‘ä»¬è¢«è¿«å…³é—­è¿æ¥ã€‚\nè€Œä¸»åŠ¨å…³é—­è¿æ¥ï¼Œæ˜¯æˆ‘ä»¬ä¸»åŠ¨è°ƒç”¨close&#x2F;closesocketæ¥å…³é—­è¿æ¥ã€‚æ¯”å¦‚å®¢æˆ·ç«¯ç»™æˆ‘ä»¬å‘é€éæ³•çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€äº›ç½‘ç»œæ”»å‡»çš„å°è¯•æ€§æ•°æ®åŒ…ã€‚è¿™ä¸ªæ—¶å€™å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬å…³é—­socketè¿æ¥ã€‚\nï¼ˆäº”ï¼‰å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºä¸Šé¢å·²ç»ä»‹ç»äº†å‘é€ç¼“å†²åŒºäº†ï¼Œå¹¶è¯´æ˜äº†å…¶å­˜åœ¨çš„æ„ä¹‰ã€‚æ¥æ”¶ç¼“å†²åŒºä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œå½“æ”¶åˆ°æ•°æ®ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œè§£åŒ…ï¼Œä½†æ˜¯è¿™æ ·å¹¶ä¸å¥½ï¼Œç†ç”±ä¸€ï¼šé™¤éä¸€äº›çº¦å®šä¿—ç§°çš„åè®®æ ¼å¼ï¼Œæ¯”å¦‚httpåè®®ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨çš„ä¸šåŠ¡çš„åè®®éƒ½æ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ•°æ®åŒ…é‡Œé¢çš„æ•°æ®æ ¼å¼çš„è§£è¯»åº”è¯¥æ˜¯ä¸šåŠ¡å±‚çš„äº‹æƒ…ï¼Œå’Œç½‘ç»œé€šä¿¡å±‚åº”è¯¥è§£è€¦ï¼Œä¸ºäº†ç½‘ç»œå±‚æ›´åŠ é€šç”¨ï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“ä¸Šå±‚åè®®é•¿æˆä»€ä¹ˆæ ·å­ï¼Œå› ä¸ºä¸åŒçš„åè®®æ ¼å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå®ƒä»¬ä¸å…·ä½“çš„ä¸šåŠ¡æœ‰å…³ã€‚ç†ç”±äºŒï¼šå³ä½¿çŸ¥é“åè®®æ ¼å¼ï¼Œæˆ‘ä»¬åœ¨ç½‘ç»œå±‚è¿›è¡Œè§£åŒ…å¤„ç†å¯¹åº”çš„ä¸šåŠ¡ï¼Œå¦‚æœè¿™ä¸ªä¸šåŠ¡å¤„ç†æ¯”è¾ƒè€—æ—¶ï¼Œæ¯”å¦‚éœ€è¦è¿›è¡Œå¤æ‚çš„è¿ç®—ï¼Œæˆ–è€…è¿æ¥æ•°æ®åº“è¿›è¡Œè´¦å·å¯†ç éªŒè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç½‘ç»œçº¿ç¨‹ä¼šéœ€è¦å¤§é‡æ—¶é—´æ¥å¤„ç†è¿™äº›ä»»åŠ¡ï¼Œè¿™æ ·å…¶å®ƒç½‘ç»œäº‹ä»¶å¯èƒ½æ²¡æ³•åŠæ—¶å¤„ç†ã€‚é‰´äºä»¥ä¸ŠäºŒç‚¹ï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦ä¸€ä¸ªæ¥æ”¶ç¼“å†²åŒºï¼Œå°†æ”¶å–åˆ°çš„æ•°æ®æ”¾åˆ°è¯¥ç¼“å†²åŒºé‡Œé¢å»ï¼Œå¹¶ç”±ä¸“é—¨çš„ä¸šåŠ¡çº¿ç¨‹æˆ–è€…ä¸šåŠ¡é€»è¾‘å»ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®ï¼Œå¹¶è§£åŒ…å¤„ç†ä¸šåŠ¡ã€‚\nè¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºè¯¥è®¾è®¡æˆå¤šå¤§çš„å®¹é‡ï¼Ÿè¿™æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜äº†ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šé¢„åˆ†é…çš„å†…å­˜å¤ªå°ä¸å¤Ÿç”¨ï¼Œå¤ªå¤§çš„è¯å¯èƒ½ä¼šé€ æˆæµªè´¹ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯åƒstringã€vectorä¸€æ ·ï¼Œè®¾è®¡å‡ºä¸€ä¸ªå¯ä»¥åŠ¨æ€å¢é•¿çš„ç¼“å†²åŒºï¼ŒæŒ‰éœ€åˆ†é…ï¼Œä¸å¤Ÿè¿˜å¯ä»¥æ‰©å±•ã€‚\néœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè¯´çš„å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºæ˜¯æ¯ä¸€ä¸ªsocketè¿æ¥éƒ½å­˜åœ¨ä¸€ä¸ªã€‚è¿™æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„è®¾è®¡æ–¹æ¡ˆã€‚\nï¼ˆå…­ï¼‰åè®®çš„è®¾è®¡é™¤äº†ä¸€äº›é€šç”¨çš„åè®®ï¼Œå¦‚httpã€ftpåè®®ä»¥å¤–ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨åè®®éƒ½æ˜¯æ ¹æ®ä¸šåŠ¡åˆ¶å®šçš„ã€‚åè®®è®¾è®¡å¥½äº†ï¼Œæ•°æ®åŒ…çš„æ ¼å¼å°±æ ¹æ®åè®®æ¥è®¾ç½®ã€‚æˆ‘ä»¬çŸ¥é“tcp&#x2F;ipåè®®æ˜¯æµå¼æ•°æ®ï¼Œæ‰€ä»¥æµå¼æ•°æ®å°±æ˜¯åƒæµæ°´ä¸€æ ·ï¼Œæ•°æ®åŒ…ä¸æ•°æ®åŒ…ä¹‹é—´æ²¡æœ‰æ˜æ˜¾çš„ç•Œé™ã€‚æ¯”å¦‚Aç«¯ç»™Bç«¯è¿ç»­å‘äº†ä¸‰ä¸ªæ•°æ®åŒ…ï¼Œæ¯ä¸ªæ•°æ®åŒ…éƒ½æ˜¯50ä¸ªå­—èŠ‚ï¼ŒBç«¯å¯èƒ½å…ˆæ”¶åˆ°10ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°140ä¸ªå­—èŠ‚ï¼›æˆ–è€…å…ˆæ”¶åˆ°20ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°20ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°110ä¸ªå­—èŠ‚ï¼›ä¹Ÿå¯èƒ½ä¸€æ¬¡æ€§æ”¶åˆ°150ä¸ªå­—èŠ‚ã€‚è¿™150ä¸ªå­—èŠ‚å¯ä»¥ä»¥ä»»ä½•å­—èŠ‚æ•°ç›®ç»„åˆå’Œæ¬¡æ•°è¢«Bæ”¶åˆ°ã€‚æ‰€ä»¥æˆ‘ä»¬è®¨è®ºåè®®çš„è®¾è®¡ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•ç•Œå®šåŒ…çš„ç•Œé™ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶ç«¯å¦‚ä½•çŸ¥é“æ¯ä¸ªåŒ…æ•°æ®çš„å¤§å°ã€‚ç›®å‰å¸¸ç”¨æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹æ³•ï¼šï¼‘. å›ºå®šå¤§å°ï¼Œè¿™ç§æ–¹æ³•å°±æ˜¯å‡å®šæ¯ä¸€ä¸ªåŒ…çš„å¤§å°éƒ½æ˜¯å›ºå®šå­—èŠ‚æ•°ç›®ï¼Œä¾‹å¦‚ä¸Šæ–‡ä¸­è®¨è®ºçš„æ¯ä¸ªåŒ…å¤§å°éƒ½æ˜¯50ä¸ªå­—èŠ‚ï¼Œæ¥æ”¶ç«¯æ¯æ”¶æ°”50ä¸ªå­—èŠ‚å°±å½“æˆä¸€ä¸ªåŒ…ã€‚ï¼’. æŒ‡å®šåŒ…ç»“æŸç¬¦ï¼Œä¾‹å¦‚ä»¥ä¸€ä¸ª\\r\\n(æ¢è¡Œç¬¦å’Œå›è½¦ç¬¦)ç»“æŸï¼Œè¿™æ ·å¯¹ç«¯åªè¦æ”¶åˆ°è¿™æ ·çš„ç»“æŸç¬¦ï¼Œå°±å¯ä»¥è®¤ä¸ºæ”¶åˆ°äº†ä¸€ä¸ªåŒ…ï¼Œæ¥ä¸‹æ¥çš„æ•°æ®æ˜¯ä¸‹ä¸€ä¸ªåŒ…çš„å†…å®¹ã€‚ï¼“. æŒ‡å®šåŒ…çš„å¤§å°ï¼Œè¿™ç§æ–¹æ³•ç»“åˆäº†ä¸Šè¿°ä¸¤ç§æ–¹æ³•ï¼Œä¸€èˆ¬åŒ…å¤´æ˜¯å›ºå®šå¤§å°ï¼ŒåŒ…å¤´ä¸­æœ‰ä¸€ä¸ªå­—æ®µæŒ‡å®šåŒ…ä½“æˆ–è€…æ•´ä¸ªå¤§çš„å¤§å°ï¼Œå¯¹ç«¯æ”¶åˆ°æ•°æ®ä»¥åå…ˆè§£æåŒ…å¤´ä¸­çš„å­—æ®µå¾—åˆ°åŒ…ä½“æˆ–è€…æ•´ä¸ªåŒ…çš„å¤§å°ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå¤§å°å»ç•Œå®šæ•°æ®çš„ç•Œçº¿ã€‚\nåè®®è¦è®¨è®ºçš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œè®¾è®¡åè®®çš„æ—¶å€™è¦å°½é‡æ–¹ä¾¿è§£åŒ…ï¼Œä¹Ÿå°±æ˜¯è¯´åè®®çš„æ ¼å¼å­—æ®µåº”è¯¥å°½é‡æ¸…æ™°æ˜äº†ã€‚\nåè®®è¦è®¨è®ºçš„ç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯ï¼Œæ ¹æ®åè®®ç»„è£…çš„å•ä¸ªæ•°æ®åŒ…åº”è¯¥å°½é‡å°ï¼Œæ³¨æ„è¿™é‡ŒæŒ‡çš„æ˜¯å•ä¸ªæ•°æ®åŒ…ï¼Œè¿™æ ·æœ‰å¦‚ä¸‹å¥½å¤„ï¼šç¬¬ä¸€ã€å¯¹äºä¸€äº›ç§»åŠ¨ç«¯è®¾å¤‡æ¥è¯´ï¼Œå…¶æ•°æ®å¤„ç†èƒ½åŠ›å’Œå¸¦å®½èƒ½åŠ›æœ‰é™ï¼Œå°çš„æ•°æ®ä¸ä»…èƒ½åŠ å¿«å¤„ç†é€Ÿåº¦ï¼ŒåŒæ—¶èŠ‚çœå¤§é‡æµé‡è´¹ç”¨ï¼›ç¬¬äºŒã€å¦‚æœå•ä¸ªæ•°æ®åŒ…è¶³å¤Ÿå°çš„è¯ï¼Œå¯¹é¢‘ç¹è¿›è¡Œç½‘ç»œé€šä¿¡çš„æœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œå¯ä»¥å¤§å¤§å‡å°å…¶å¸¦å®½å‹åŠ›ï¼Œå…¶æ‰€åœ¨çš„ç³»ç»Ÿä¹Ÿèƒ½ä½¿ç”¨æ›´å°‘çš„å†…å­˜ã€‚è¯•æƒ³ï¼šå‡å¦‚ä¸€ä¸ªè‚¡ç¥¨æœåŠ¡å™¨ï¼Œå¦‚æœä¸€åªè‚¡ç¥¨çš„æ•°æ®åŒ…æ˜¯100ä¸ªå­—èŠ‚æˆ–è€…1000ä¸ªå­—èŠ‚ï¼Œé‚£åŒæ ·æ˜¯10000åªè‚¡ç¥¨åŒºåˆ«å‘¢ï¼Ÿ\nåè®®è¦è®¨è®ºçš„ç¬¬å››ä¸ªé—®é¢˜æ˜¯ï¼Œå¯¹äºæ•°å€¼ç±»å‹ï¼Œæˆ‘ä»¬åº”è¯¥æ˜¾å¼åœ°æŒ‡å®šæ•°å€¼çš„é•¿åº¦ï¼Œæ¯”å¦‚longå‹ï¼Œåœ¨32ä½æœºå™¨ä¸Šæ˜¯32ä½4ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¦‚æœåœ¨64ä½æœºå™¨ä¸Šï¼Œå°±å˜æˆäº†64ä½8ä¸ªå­—èŠ‚äº†ã€‚è¿™æ ·åŒæ ·æ˜¯ä¸€ä¸ªlongå‹ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹å¯èƒ½å› ä¸ºæœºå™¨ä½æ•°çš„ä¸åŒä¼šç”¨ä¸åŒçš„é•¿åº¦å»è§£ç ã€‚æ‰€ä»¥å»ºè®®æœ€å¥½ï¼Œåœ¨æ¶‰åŠåˆ°è·¨å¹³å°ä½¿ç”¨çš„åè®®æœ€å¥½æ˜¾å¼åœ°æŒ‡å®šåè®®ä¸­æ•´å‹å­—æ®µçš„é•¿åº¦ï¼Œæ¯”å¦‚int32ã€int64ç­‰ç­‰ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåè®®çš„æ¥å£çš„ä¾‹å­ï¼Œå½“ç„¶javaç¨‹åºå‘˜åº”è¯¥å¾ˆç†Ÿæ‚‰è¿™æ ·çš„æ¥å£ï¼š\ntxtclass BinaryReadStream\n&#123;\nprivate:\n    const char* const ptr;\n    const size_t      len;\n    const char*       cur;\n    BinaryReadStream(const BinaryReadStream&amp;);\n    BinaryReadStream&amp; operator=(const BinaryReadStream&amp;);\npublic:\n    BinaryReadStream(const char* ptr, size_t len);\n    virtual const char* GetData() const;\n    virtual size_t GetSize() const;\n    bool IsEmpty() const;\n    bool ReadString(string* str, size_t maxlen, size_t&amp; outlen);\n    bool ReadCString(char* str, size_t strlen, size_t&amp; len);\n    bool ReadCCString(const char** str, size_t maxlen, size_t&amp; outlen);\n    bool ReadInt32(int32_t&amp; i);\n    bool ReadInt64(int64_t&amp; i);\n    bool ReadShort(short&amp; i);\n    bool ReadChar(char&amp; c);\n    size_t ReadAll(char* szBuffer, size_t iLen) const;\n    bool IsEnd() const;\n    const char* GetCurrent() const&#123; return cur; &#125;\n\npublic:\n    bool ReadLength(size_t &amp; len);\n    bool ReadLengthWithoutOffset(size_t &amp;headlen, size_t &amp; outlen);\n&#125;;\n\nclass BinaryWriteStream\n&#123;\npublic:\n    BinaryWriteStream(string* data);\n    virtual const char* GetData() const;\n    virtual size_t GetSize() const;\n    bool WriteCString(const char* str, size_t len);\n    bool WriteString(const string&amp; str);\n    bool WriteDouble(double value, bool isNULL = false);\n    bool WriteInt64(int64_t value, bool isNULL = false);\n    bool WriteInt32(int32_t i, bool isNULL = false);\n    bool WriteShort(short i, bool isNULL = false);\n    bool WriteChar(char c, bool isNULL = false);\n    size_t GetCurrentPos() const&#123; return m_data-&gt;length(); &#125;\n    void Flush();\n    void Clear();\nprivate:\n    string* m_data;\n&#125;;å…¶ä¸­BinaryWriteStreamæ˜¯ç¼–ç åè®®çš„ç±»ï¼ŒBinaryReadStreamæ˜¯è§£ç åè®®çš„ç±»ã€‚å¯ä»¥æŒ‰ä¸‹é¢è¿™ç§æ–¹å¼æ¥ç¼–ç å’Œè§£ç ã€‚ç¼–ç ï¼š\n123456std::string outbuf;BinaryWriteStream writeStream(&amp;outbuf);writeStream.WriteInt32(msg_type_register);writeStream.WriteInt32(m_seq);writeStream.WriteString(retData);writeStream.Flush();\n\nè§£ç ï¼š\n12345678910111213141516171819BinaryReadStream readStream(strMsg.c_str(), strMsg.length());int32_t cmd;if (!readStream.ReadInt32(cmd))&#123;\treturn false;&#125;//int seq;if (!readStream.ReadInt32(m_seq))&#123;\treturn false;&#125;std::string data;size_t datalength;if (!readStream.ReadString(&amp;data, 0, datalength))&#123;\treturn false;&#125;\n\n\n\n\näºŒã€æœåŠ¡å™¨ç¨‹åºç»“æ„çš„ç»„ç»‡\nä¸Šé¢çš„å…­ä¸ªæ ‡é¢˜ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¾ˆå¤šå…·ä½“çš„ç»†èŠ‚é—®é¢˜ï¼Œç°åœ¨æ˜¯æ—¶å€™è®¨è®ºå°†è¿™äº›ç»†èŠ‚ç»„ç»‡èµ·æ¥äº†ã€‚æ ¹æ®æˆ‘çš„ä¸ªäººç»éªŒï¼Œç›®å‰ä¸»æµçš„æ€æƒ³æ˜¯one thread one loop+reactoræ¨¡å¼ï¼ˆä¹Ÿæœ‰proactoræ¨¡å¼ï¼‰çš„ç­–ç•¥ã€‚é€šä¿—ç‚¹è¯´å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªå¾ªç¯ï¼Œå³åœ¨ä¸€ä¸ªçº¿ç¨‹çš„å‡½æ•°é‡Œé¢ä¸æ–­åœ°å¾ªç¯ä¾æ¬¡åšä¸€äº›äº‹æƒ…ï¼Œè¿™äº›äº‹æƒ…åŒ…æ‹¬æ£€æµ‹ç½‘ç»œäº‹ä»¶ã€è§£åŒ…æ•°æ®äº§ç”Ÿä¸šåŠ¡é€»è¾‘ã€‚æˆ‘ä»¬å…ˆä»æœ€ç®€å•åœ°æ¥è¯´ï¼Œè®¾å®šä¸€äº›çº¿ç¨‹åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢åšç½‘ç»œé€šä¿¡ç›¸å…³çš„äº‹æƒ…ï¼Œä¼ªç å¦‚ä¸‹ï¼š\n123456789101112while(é€€å‡ºæ ‡å¿—)  &#123;  \t//IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶  \t//ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰  \t//å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›      //å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œæ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›      //å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®      //å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥   &#125;  \n\nå¦å¤–è®¾å®šä¸€äº›çº¿ç¨‹å»å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¹¶è§£åŒ…å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè¿™äº›çº¿ç¨‹å¯ä»¥è®¤ä¸ºæ˜¯ä¸šåŠ¡çº¿ç¨‹äº†ï¼Œä¼ªç å¦‚ä¸‹ï¼š\ntxt//ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  ä¸Šé¢çš„ç»“æ„æ˜¯ç›®å‰æœ€é€šç”¨çš„æœåŠ¡å™¨é€»è¾‘ç»“æ„ï¼Œä½†æ˜¯èƒ½ä¸èƒ½å†ç®€åŒ–ä¸€ä¸‹æˆ–è€…è¯´å†ç»¼åˆä¸€ä¸‹å‘¢ï¼Ÿæˆ‘ä»¬è¯•è¯•ï¼Œä½ æƒ³è¿‡è¿™æ ·çš„é—®é¢˜æ²¡æœ‰ï¼šå‡å¦‚ç°åœ¨çš„æœºå™¨æœ‰ä¸¤ä¸ªcpuï¼ˆå‡†ç¡®çš„æ¥è¯´åº”è¯¥æ˜¯ä¸¤ä¸ªæ ¸ï¼‰ï¼Œæˆ‘ä»¬çš„ç½‘ç»œçº¿ç¨‹æ•°é‡æ˜¯2ä¸ªï¼Œä¸šåŠ¡é€»è¾‘çº¿ç¨‹ä¹Ÿæ˜¯2ä¸ªï¼Œè¿™æ ·å¯èƒ½å­˜åœ¨çš„æƒ…å†µå°±æ˜¯ï¼šä¸šåŠ¡çº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œç½‘ç»œçº¿ç¨‹å¹¶æ²¡æœ‰è¿è¡Œï¼Œå®ƒä»¬å¿…é¡»ç­‰å¾…ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œå¹²å˜›è¦å¤šå»ºä¸¤ä¸ªçº¿ç¨‹å‘¢ï¼Ÿé™¤äº†ç¨‹åºç»“æ„ä¸Šå¯èƒ½ç¨å¾®æ¸…æ¥šä¸€ç‚¹ï¼Œå¯¹ç¨‹åºæ€§èƒ½æ²¡æœ‰ä»»ä½•å®è´¨æ€§æé«˜ï¼Œè€Œä¸”ç™½ç™½æµªè´¹cpuæ—¶é—´ç‰‡åœ¨çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç½‘ç»œçº¿ç¨‹ä¸ä¸šåŠ¡é€»è¾‘çº¿ç¨‹åˆå¹¶ï¼Œåˆå¹¶åçš„ä¼ªç çœ‹èµ·æ¥æ˜¯è¿™æ ·å­çš„ï¼š\ntxtwhile(é€€å‡ºæ ‡å¿—)  \n&#123;  \n    //IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶  \n    //ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰  \n      \nã€€ã€€//å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›  \nã€€ã€€//å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œæ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›  \n  \nã€€ã€€//å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®  \n  \nã€€ã€€//å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥  \n  \nã€€ã€€//ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  \n&#125; ä½ æ²¡çœ‹é”™ï¼Œå…¶å®å°±æ˜¯ç®€å•çš„åˆå¹¶ï¼Œåˆå¹¶ä¹‹åå’Œä¸ä»…å¯ä»¥è¾¾åˆ°åŸæ¥åˆå¹¶å‰çš„æ•ˆæœï¼Œè€Œä¸”åœ¨æ²¡æœ‰ç½‘ç»œIOäº‹ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥åŠæ—¶å¤„ç†æˆ‘ä»¬æƒ³å¤„ç†çš„ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶ä¸”å‡å°‘äº†ä¸å¿…è¦çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶é—´ã€‚\næˆ‘ä»¬å†æ›´è¿›ä¸€æ­¥ï¼Œç”šè‡³æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªwhileå¾ªç¯å¢åŠ å…¶å®ƒçš„ä¸€äº›ä»»åŠ¡çš„å¤„ç†ï¼Œæ¯”å¦‚ç¨‹åºçš„é€»è¾‘ä»»åŠ¡é˜Ÿåˆ—ã€å®šæ—¶å™¨äº‹ä»¶ç­‰ç­‰ï¼Œä¼ªç å¦‚ä¸‹ï¼š\ntxtwhile(é€€å‡ºæ ‡å¿—)  \n&#123;  \n    //å®šæ—¶å™¨äº‹ä»¶å¤„ç†  \n\n    //IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶  \n    //ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰  \n\n    //å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›  \n    //å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œæ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›  \n\n    //å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®  \n\n    //å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥  \n\n    //ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  \n\n    //ç¨‹åºè‡ªå®šä¹‰ä»»åŠ¡1  \n\n    //ç¨‹åºè‡ªå®šä¹‰ä»»åŠ¡2  \n&#125; æ³¨æ„ï¼šä¹‹æ‰€ä»¥å°†å®šæ—¶å™¨äº‹ä»¶çš„å¤„ç†æ”¾åœ¨ç½‘ç»œIOäº‹ä»¶çš„æ£€æµ‹ä¹‹å‰ï¼Œæ˜¯å› ä¸ºé¿å…å®šæ—¶å™¨äº‹ä»¶è¿‡æœŸæ—¶é—´å¤ªé•¿ã€‚å‡å¦‚æ”¾åœ¨åé¢çš„è¯ï¼Œå¯èƒ½å‰é¢çš„å¤„ç†è€—è´¹äº†ä¸€ç‚¹æ—¶é—´ï¼Œç­‰åˆ°å¤„ç†å®šæ—¶å™¨äº‹ä»¶æ—¶ï¼Œæ—¶é—´é—´éš”å·²ç»è¿‡å»äº†ä¸å°‘æ—¶é—´ã€‚è™½ç„¶è¿™æ ·å¤„ç†ï¼Œä¹Ÿæ²¡æ³•ä¿è¯å®šæ—¶å™¨äº‹ä»¶ç™¾åˆ†ç™¾ç²¾ç¡®ï¼Œä½†æ˜¯èƒ½å°½é‡ä¿è¯ã€‚å½“ç„¶linuxç³»ç»Ÿä¸‹æä¾›eventfdè¿™æ ·çš„å®šæ—¶å™¨å¯¹è±¡ï¼Œæ‰€æœ‰çš„å®šæ—¶å™¨å¯¹è±¡å°±èƒ½åƒå¤„ç†socketè¿™æ ·çš„fdä¸€æ ·ç»Ÿä¸€æˆå¤„ç†ã€‚è¿™ä¹Ÿæ˜¯ç½‘ç»œåº“libeventçš„æ€æƒ³å¾ˆåƒï¼Œlibeventå°†socketã€å®šæ—¶å™¨ã€ä¿¡å·å°è£…æˆç»Ÿä¸€çš„å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚\nè¯´äº†è¿™ä¹ˆå¤šç†è®ºæ€§çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬æ¥ä¸€æ¬¾æµè¡Œçš„å¼€æºç½‘ç»œåº“muduoæ¥è¯´æ˜å§ï¼ˆä½œè€…ï¼šé™ˆç¡•ï¼‰ï¼ŒåŸåº“æ˜¯åŸºäºboostçš„ï¼Œæˆ‘æ”¹æˆäº†C++11çš„ç‰ˆæœ¬ï¼Œå¹¶ä¿®æ”¹äº†ä¸€äº›bugï¼Œåœ¨æ­¤æ„Ÿè°¢åŸä½œè€…é™ˆç¡•ã€‚\nä¸Šæ–‡ä»‹ç»çš„æ ¸å¿ƒçº¿ç¨‹å‡½æ•°çš„whileå¾ªç¯ä½äºeventloop.cppä¸­ï¼š\ntxtvoid EventLoop::loop()\n&#123;\n    assert(!looping_);\n    assertInLoopThread();\n    looping_ = true;\n    quit_ = false;  \n    LOG_TRACE &lt;&lt; &quot;EventLoop &quot; &lt;&lt; this &lt;&lt; &quot; start looping&quot;;\n    while (!quit_)\n    &#123;\n        activeChannels_.clear();\n        pollReturnTime_ = poller_-&gt;poll(kPollTimeMs, &amp;activeChannels_);\n        ++iteration_;\n        if (Logger::logLevel() &lt;= Logger::TRACE)\n        &#123;\n            printActiveChannels();\n        &#125;\n        // TODO sort channel by priority\n        eventHandling_ = true;\n        for (ChannelList::iterator it = activeChannels_.begin();\n            it != activeChannels_.end(); ++it)\n        &#123;\n            currentActiveChannel_ = *it;\n            currentActiveChannel_-&gt;handleEvent(pollReturnTime_);\n        &#125;\n        currentActiveChannel_ = NULL;\n        eventHandling_ = false;\n        doPendingFunctors();\n\n        if (frameFunctor_)\n        &#123;\n            frameFunctor_();\n        &#125;\t\t\n    &#125;\n\n    LOG_TRACE &lt;&lt; &quot;EventLoop &quot; &lt;&lt; this &lt;&lt; &quot; stop looping&quot;;\n    looping_ = false;\n&#125;poller_-&gt;pollåˆ©ç”¨epollåˆ†ç¦»ç½‘ç»œäº‹ä»¶ï¼Œç„¶åæ¥ç€å¤„ç†åˆ†ç¦»å‡ºæ¥çš„ç½‘ç»œäº‹ä»¶ï¼Œæ¯ä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹åº”ä¸€ä¸ªè¿æ¥ï¼Œå³ä¸€ä¸ªTcpConnectionå’ŒChannelé€šé“å¯¹è±¡ã€‚currentActiveChannel_-&gt;handleEvent(pollReturnTime_)æ ¹æ®æ˜¯å¯è¯»ã€å¯å†™ã€å‡ºé”™äº‹ä»¶æ¥è°ƒç”¨å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¿™äº›å‡½æ•°éƒ½æ˜¯å›è°ƒå‡½æ•°ï¼Œç¨‹åºåˆå§‹åŒ–é˜¶æ®µè®¾ç½®è¿›æ¥çš„ï¼š\ntxtvoid Channel::handleEvent(Timestamp receiveTime)\n&#123;  \n    std::shared_ptr&lt;void&gt; guard;  \n    if (tied_)  \n    &#123;  \n        guard = tie_.lock();  \n        if (guard)  \n        &#123;  \n            handleEventWithGuard(receiveTime);  \n        &#125;  \n    &#125;  \n    else  \n    &#123;  \n        handleEventWithGuard(receiveTime);  \n    &#125;  \n&#125;  \n\nvoid Channel::handleEventWithGuard(Timestamp receiveTime)  \n&#123;  \n    eventHandling_ = true;  \n    LOG_TRACE &lt;&lt; reventsToString();  \n    if ((revents_ &amp; POLLHUP) &amp;&amp; !(revents_ &amp; POLLIN))  \n    &#123;  \n        if (logHup_)  \n        &#123;  \n            LOG_WARN &lt;&lt; &quot;Channel::handle_event() POLLHUP&quot;;  \n        &#125;  \n        if (closeCallback_) closeCallback_();  \n    &#125;\n    if (revents_ &amp; POLLNVAL)  \n    &#123;  \n        LOG_WARN &lt;&lt; &quot;Channel::handle_event() POLLNVAL&quot;;  \n    &#125;  \n\n    if (revents_ &amp; (POLLERR | POLLNVAL))  \n    &#123;  \n        if (errorCallback_) errorCallback_();  \n    &#125;  \n    if (revents_ &amp; (POLLIN | POLLPRI | POLLRDHUP))  \n    &#123;  \n        //å½“æ˜¯ä¾¦å¬socketæ—¶ï¼ŒreadCallback_æŒ‡å‘Acceptor::handleRead  \n        //å½“æ˜¯å®¢æˆ·ç«¯socketæ—¶ï¼Œè°ƒç”¨TcpConnection::handleRead   \n        if (readCallback_) readCallback_(receiveTime);  \n    &#125;  \n    if (revents_ &amp; POLLOUT)  \n    &#123;  \n        //å¦‚æœæ˜¯è¿æ¥çŠ¶æ€æœçš„socketï¼Œåˆ™writeCallback_æŒ‡å‘Connector::handleWrite()  \n        if (writeCallback_) writeCallback_();  \n    &#125;  \n    eventHandling_ = false; \n&#125; å½“ç„¶ï¼Œè¿™é‡Œåˆ©ç”¨äº†Channelå¯¹è±¡çš„â€œå¤šæ€æ€§â€ï¼Œå¦‚æœæ˜¯æ™®é€šsocketï¼Œå¯è¯»äº‹ä»¶å°±ä¼šè°ƒç”¨é¢„å…ˆè®¾ç½®çš„å›è°ƒå‡½æ•°ï¼›ä½†æ˜¯å¦‚æœæ˜¯ä¾¦å¬socketï¼Œåˆ™è°ƒç”¨Aceptorå¯¹è±¡çš„handleRead()æ¥æ¥æ”¶æ–°è¿æ¥ï¼š\n1234567891011121314151617181920212223242526272829303132333435void Acceptor::handleRead()  &#123;      loop_-&gt;assertInLoopThread();      InetAddress peerAddr;      //FIXME loop until no more      int connfd = acceptSocket_.accept(&amp;peerAddr);      if (connfd &gt;= 0)      &#123;          // string hostport = peerAddr.toIpPort();          // LOG_TRACE &lt;&lt; &quot;Accepts of &quot; &lt;&lt; hostport;          //newConnectionCallback_å®é™…æŒ‡å‘TcpServer::newConnection(int sockfd, const InetAddress&amp; peerAddr)          if (newConnectionCallback_)          &#123;              newConnectionCallback_(connfd, peerAddr);          &#125;          else          &#123;              sockets::close(connfd);          &#125;      &#125;      else      &#123;          LOG_SYSERR &lt;&lt; &quot;in Acceptor::handleRead&quot;;          // Read the section named &quot;The special problem of          // accept()ing when you can&#x27;t&quot; in libev&#x27;s doc.          // By Marc Lehmann, author of livev.          if (errno == EMFILE)          &#123;              ::close(idleFd_);              idleFd_ = ::accept(acceptSocket_.fd(), NULL, NULL);              ::close(idleFd_);              idleFd_ = ::open(&quot;/dev/null&quot;, O_RDONLY | O_CLOEXEC);          &#125;      &#125;  &#125;  \n\nä¸»å¾ªç¯é‡Œé¢çš„ä¸šåŠ¡é€»è¾‘å¤„ç†å¯¹åº”ï¼š\ntxtdoPendingFunctors();  \nif (frameFunctor_)  \n&#123;  \n   frameFunctor_();  \n&#125;       123456789101112131415void EventLoop::doPendingFunctors()  &#123;      std::vector&lt;Functor&gt; functors;      callingPendingFunctors_ = true;     &#123;          std::unique_lock&lt;std::mutex&gt; lock(mutex_);          functors.swap(pendingFunctors_);  \t&#125;        for (size_t i = 0; i &lt; functors.size(); ++i)      &#123;          functors[i]();      &#125;      callingPendingFunctors_ = false;&#125; \n\n è¿™é‡Œå¢åŠ ä¸šåŠ¡é€»è¾‘æ˜¯å¢åŠ æ‰§è¡Œä»»åŠ¡çš„å‡½æ•°æŒ‡é’ˆçš„ï¼Œå¢åŠ çš„ä»»åŠ¡ä¿å­˜åœ¨æˆå‘˜å˜é‡pendingFunctors_ä¸­ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼ˆvectorå¯¹è±¡ï¼‰ï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œè°ƒç”¨æ¯ä¸ªå‡½æ•°å°±å¯ä»¥äº†ã€‚ä¸Šé¢çš„ä»£ç å…ˆåˆ©ç”¨ä¸€ä¸ªæ ˆå˜é‡å°†æˆå‘˜å˜é‡pendingFunctors_é‡Œé¢çš„å‡½æ•°æŒ‡é’ˆæ¢è¿‡æ¥ï¼Œæ¥ä¸‹æ¥å¯¹è¿™ä¸ªæ ˆå˜é‡è¿›è¡Œæ“ä½œå°±å¯ä»¥äº†ï¼Œè¿™æ ·å‡å°‘äº†é”çš„ç²’åº¦ã€‚å› ä¸ºæˆå‘˜å˜é‡pendingFunctors_åœ¨å¢åŠ ä»»åŠ¡çš„æ—¶å€™ï¼Œä¹Ÿä¼šè¢«ç”¨åˆ°ï¼Œè®¾è®¡åˆ°å¤šä¸ªçº¿ç¨‹æ“ä½œï¼Œæ‰€ä»¥è¦åŠ é”ï¼Œå¢åŠ ä»»åŠ¡çš„åœ°æ–¹æ˜¯ï¼š\ntxtvoid EventLoop::queueInLoop(const Functor&amp; cb)  \n&#123;  \n    &#123;  \n        std::unique_lock&lt;std::mutex&gt; lock(mutex_);  \n        pendingFunctors_.push_back(cb);  \n    &#125;  \n    if (!isInLoopThread() || callingPendingFunctors_)  \n    &#123;  \n        wakeup();  \n    &#125;  \n&#125;  è€ŒframeFunctor_å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆå°±å¯ä»¥äº†ã€‚å½“ç„¶è¿™é‡Œæœ‰ä¸ªæŠ€å·§æ€§çš„ä¸œè¥¿ï¼Œå³å¢åŠ ä»»åŠ¡çš„æ—¶å€™ï¼Œä¸ºäº†èƒ½å¤Ÿç«‹å³æ‰§è¡Œï¼Œä½¿ç”¨å”¤é†’æœºåˆ¶ï¼Œé€šè¿‡å¾€ä¸€ä¸ªfdé‡Œé¢å†™å…¥ç®€å•çš„å‡ ä¸ªå­—èŠ‚ï¼Œæ¥å”¤é†’epollï¼Œä½¿å…¶ç«‹åˆ»è¿”å›ï¼Œå› ä¸ºæ­¤æ—¶æ²¡æœ‰å…¶å®ƒçš„sockeæœ‰äº‹ä»¶ï¼Œè¿™æ ·æ¥ä¸‹æ¥å°±æ‰§è¡Œåˆšæ‰æ·»åŠ çš„ä»»åŠ¡äº†ã€‚\næˆ‘ä»¬çœ‹ä¸€ä¸‹æ•°æ®æ”¶å–çš„é€»è¾‘ï¼š\n1234567891011121314151617181920void TcpConnection::handleRead(Timestamp receiveTime)  &#123;      loop_-&gt;assertInLoopThread();      int savedErrno = 0;      ssize_t n = inputBuffer_.readFd(channel_-&gt;fd(), &amp;savedErrno);      if (n &gt; 0)      &#123;            messageCallback_(shared_from_this(), &amp;inputBuffer_, receiveTime);      &#125;      else if (n == 0)      &#123;          handleClose();      &#125;      else      &#123;          errno = savedErrno;          LOG_SYSERR &lt;&lt; &quot;TcpConnection::handleRead&quot;;          handleError();      &#125;  &#125;  \n\nå°†æ”¶åˆ°çš„æ•°æ®æ”¾åˆ°æ¥æ”¶ç¼“å†²åŒºé‡Œé¢ï¼Œå°†æ¥æˆ‘ä»¬æ¥è§£åŒ…ï¼š\n123456789101112131415161718192021222324252627void ClientSession::OnRead(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn, Buffer* pBuffer, Timestamp receivTime)  &#123;      while (true)      &#123;          //ä¸å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°          if (pBuffer-&gt;readableBytes() &lt; (size_t)sizeof(msg))          &#123;              LOG_INFO &lt;&lt; &quot;buffer is not enough for a package header, pBuffer-&gt;readableBytes()=&quot; &lt;&lt; pBuffer-&gt;readableBytes() &lt;&lt; &quot;, sizeof(msg)=&quot; &lt;&lt; sizeof(msg);              return;          &#125;         //ä¸å¤Ÿä¸€ä¸ªæ•´åŒ…å¤§å°          msg header;          memcpy(&amp;header, pBuffer-&gt;peek(), sizeof(msg));          if (pBuffer-&gt;readableBytes() &lt; (size_t)header.packagesize + sizeof(msg))              return;          pBuffer-&gt;retrieve(sizeof(msg));          std::string inbuf;          inbuf.append(pBuffer-&gt;peek(), header.packagesize);          pBuffer-&gt;retrieve(header.packagesize);          if (!Process(conn, inbuf.c_str(), inbuf.length()))          &#123;              LOG_WARN &lt;&lt; &quot;Process error, close TcpConnection&quot;;              conn-&gt;forceClose();          &#125;  \t&#125;// end while-loop  &#125; \n\nå…ˆåˆ¤æ–­æ¥æ”¶ç¼“å†²åŒºé‡Œé¢çš„æ•°æ®æ˜¯å¦å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°ï¼Œå¦‚æœå¤Ÿå†åˆ¤æ–­å¤Ÿä¸å¤ŸåŒ…å¤´æŒ‡å®šçš„åŒ…ä½“å¤§å°ï¼Œå¦‚æœè¿˜æ˜¯å¤Ÿçš„è¯ï¼Œæ¥ç€åœ¨Processå‡½æ•°é‡Œé¢å¤„ç†è¯¥åŒ…ã€‚\nå†çœ‹çœ‹å‘é€æ•°æ®çš„é€»è¾‘ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253void TcpConnection::sendInLoop(const void* data, size_t len)  &#123;      loop_-&gt;assertInLoopThread();      ssize_t nwrote = 0;      size_t remaining = len;      bool faultError = false;      if (state_ == kDisconnected)      &#123;          LOG_WARN &lt;&lt; &quot;disconnected, give up writing&quot;;          return;      &#125;      // if no thing in output queue, try writing directly      if (!channel_-&gt;isWriting() &amp;&amp; outputBuffer_.readableBytes() == 0)      &#123;          nwrote = sockets::write(channel_-&gt;fd(), data, len);          if (nwrote &gt;= 0)          &#123;              remaining = len - nwrote;              if (remaining == 0 &amp;&amp; writeCompleteCallback_)              &#123;                  loop_-&gt;queueInLoop(std::bind(writeCompleteCallback_, shared_from_this()));              &#125;          &#125;          else // nwrote &lt; 0          &#123;              nwrote = 0;              if (errno != EWOULDBLOCK)              &#123;                  LOG_SYSERR &lt;&lt; &quot;TcpConnection::sendInLoop&quot;;                  if (errno == EPIPE || errno == ECONNRESET) // FIXME: any others?                  &#123;                      faultError = true;                  &#125;              &#125;          &#125;      &#125;      assert(remaining &lt;= len);      if (!faultError &amp;&amp; remaining &gt; 0)      &#123;          size_t oldLen = outputBuffer_.readableBytes();          if (oldLen + remaining &gt;= highWaterMark_                                      &amp;&amp; oldLen &lt; highWaterMark_              &amp;&amp; highWaterMarkCallback_)          &#123;              loop_-&gt;queueInLoop(std::bind(highWaterMarkCallback_, shared_from_this(), oldLen + remaining));          &#125;          outputBuffer_.append(static_cast&lt;const char*&gt;(data)+nwrote, remaining);          if (!channel_-&gt;isWriting())          &#123;              channel_-&gt;enableWriting();          &#125;      &#125; &#125; \n\nå¦‚æœå‰©ä½™çš„æ•°æ®remainingå¤§äºåˆ™è°ƒç”¨channel_-&gt;enableWriting();å¼€å§‹ç›‘å¬å¯å†™äº‹ä»¶ï¼Œå¯å†™äº‹ä»¶å¤„ç†å¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839void TcpConnection::handleWrite()  &#123;      loop_-&gt;assertInLoopThread();      if (channel_-&gt;isWriting())      &#123;          ssize_t n = sockets::write(channel_-&gt;fd(),              outputBuffer_.peek(),              outputBuffer_.readableBytes());          if (n &gt; 0)          &#123;              outputBuffer_.retrieve(n);              if (outputBuffer_.readableBytes() == 0)              &#123;                  channel_-&gt;disableWriting();                  if (writeCompleteCallback_)                  &#123;                      loop_-&gt;queueInLoop(std::bind(writeCompleteCallback_, shared_from_this()));                  &#125;                  if (state_ == kDisconnecting)                  &#123;                      shutdownInLoop();                  &#125;              &#125;          &#125;          else          &#123;              LOG_SYSERR &lt;&lt; &quot;TcpConnection::handleWrite&quot;;              // if (state_ == kDisconnecting)              // &#123;              //   shutdownInLoop();              // &#125;          &#125;      &#125;      else      &#123;          LOG_TRACE &lt;&lt; &quot;Connection fd = &quot; &lt;&lt; channel_-&gt;fd()              &lt;&lt; &quot; is down, no more writing&quot;;      &#125;  &#125;  \n\nå¦‚æœå‘é€å®Œæ•°æ®ä»¥åè°ƒç”¨channel_-&gt;disableWriting();ç§»é™¤ç›‘å¬å¯å†™äº‹ä»¶ã€‚\nå¾ˆå¤šè¯»è€…å¯èƒ½ä¸€ç›´æƒ³é—®ï¼Œæ–‡ä¸­ä¸æ˜¯è¯´è§£åŒ…æ•°æ®å¹¶å¤„ç†é€»è¾‘æ˜¯ä¸šåŠ¡ä»£ç è€Œéç½‘ç»œé€šä¿¡çš„ä»£ç ï¼Œä½ è¿™é‡Œè²Œä¼¼éƒ½æ··åœ¨ä¸€èµ·äº†ï¼Œå…¶å®æ²¡æœ‰ï¼Œè¿™é‡Œå®é™…çš„ä¸šåŠ¡ä»£ç å¤„ç†éƒ½æ˜¯æ¡†æ¶æ›¾æä¾›çš„å›è°ƒå‡½æ•°é‡Œé¢å¤„ç†çš„ï¼Œå…·ä½“æ€ä¹ˆå¤„ç†ï¼Œç”±æ¡†æ¶ä½¿ç”¨è€…â€”â€”ä¸šåŠ¡å±‚è‡ªå·±å®šä¹‰ã€‚\næ€»ç»“èµ·æ¥ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å‡½æ•°é‡Œä¸€ä¸ªloopé‚£ä¹ˆç‚¹äº‹æƒ…ï¼Œä¸ä¿¡ä½ å†çœ‹æˆ‘æ›¾ç»å·¥ä½œä¸Šçš„ä¸€ä¸ªäº¤æ˜“ç³»ç»ŸæœåŠ¡å™¨é¡¹ç›®ä»£ç ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586void CEventDispatcher::Run()  &#123;      m_bShouldRun = true;      while(m_bShouldRun)      &#123;          DispatchIOs();                SyncTime();          CheckTimer();          DispatchEvents();      &#125;  &#125;  void CEpollReactor::DispatchIOs()  &#123;      DWORD dwSelectTimeOut = SR_DEFAULT_EPOLL_TIMEOUT;      if (HandleOtherTask())      &#123;          dwSelectTimeOut = 0;      &#125;      struct epoll_event ev;      CEventHandlerIdMap::iterator itor = m_mapEventHandlerId.begin();      for(; itor!=m_mapEventHandlerId.end(); itor++)      &#123;          CEventHandler *pEventHandler = (CEventHandler *)(*itor).first;          if(pEventHandler == NULL)&#123;              continue;          &#125;          ev.data.ptr = pEventHandler;          ev.events = 0;          int nReadID, nWriteID;          pEventHandler-&gt;GetIds(&amp;nReadID, &amp;nWriteID);            if (nReadID &gt; 0)          &#123;              ev.events |= EPOLLIN;          &#125;          if (nWriteID &gt; 0)          &#123;              ev.events |= EPOLLOUT;          &#125;          epoll_ctl(m_fdEpoll, EPOLL_CTL_MOD, (*itor).second, &amp;ev);      &#125;      struct epoll_event events[EPOLL_MAX_EVENTS];      int nfds = epoll_wait(m_fdEpoll, events, EPOLL_MAX_EVENTS, dwSelectTimeOut/1000);      for (int i=0; i&lt;nfds; i++)      &#123;          struct epoll_event &amp;evref = events[i];          CEventHandler *pEventHandler = (CEventHandler *)evref.data.ptr;          if ((evref.events|EPOLLIN)!=0 &amp;&amp; m_mapEventHandlerId.find(pEventHandler)!=m_mapEventHandlerId.end())          &#123;              pEventHandler-&gt;HandleInput();          &#125;          if ((evref.events|EPOLLOUT)!=0 &amp;&amp; m_mapEventHandlerId.find(pEventHandler)!=m_mapEventHandlerId.end())          &#123;              pEventHandler-&gt;HandleOutput();          &#125;      &#125; &#125; void CEventDispatcher::DispatchEvents()  &#123;      CEvent event;      CSyncEvent *pSyncEvent;      while(m_queueEvent.PeekEvent(event))      &#123;          int nRetval;         if(event.pEventHandler != NULL)          &#123;              nRetval = event.pEventHandler-&gt;HandleEvent(event.nEventID, event.dwParam, event.pParam);          &#125;          else          &#123;              nRetval = HandleEvent(event.nEventID, event.dwParam, event.pParam);          &#125;          if(event.pAdd != NULL)      //åŒæ­¥æ¶ˆæ¯          &#123;              pSyncEvent=(CSyncEvent *)event.pAdd;              pSyncEvent-&gt;nRetval = nRetval;              pSyncEvent-&gt;sem.UnLock();          &#125;  \t&#125;&#125;\n\nå†çœ‹çœ‹è˜‘è‡è¡—å¼€æºçš„TeamTalkçš„æºç ï¼ˆä»£ç ä¸‹è½½åœ°å€ï¼šhttps://github.com/baloonwj/TeamTalkï¼‰ï¼š\ntxtvoid CEventDispatch::StartDispatch(uint32_t wait_timeout)  \n&#123;  \n    fd_set read_set, write_set, excep_set;  \n    timeval timeout;  \n    timeout.tv_sec = 0;  \n    timeout.tv_usec = wait_timeout * 1000;  // 10 millisecond \n    if(running)  \n        return;  \n    running = true;  \n  \n    while (running) \n    &#123;  \n        _CheckTimer();  \n        _CheckLoop(); \n        if (!m_read_set.fd_count &amp;&amp; !m_write_set.fd_count &amp;&amp; !m_excep_set.fd_count)  \n        &#123;  \n            Sleep(MIN_TIMER_DURATION);  \n            continue;  \n        &#125;  \n  \n        m_lock.lock();  \n        memcpy(&amp;read_set, &amp;m_read_set, sizeof(fd_set));  \n        memcpy(&amp;write_set, &amp;m_write_set, sizeof(fd_set));  \n        memcpy(&amp;excep_set, &amp;m_excep_set, sizeof(fd_set));  \n        m_lock.unlock();  \n\n        int nfds = select(0, &amp;read_set, &amp;write_set, &amp;excep_set, &amp;timeout);  \n\n        if (nfds == SOCKET_ERROR)  \n        &#123;  \n            log(&quot;select failed, error code: %d&quot;, GetLastError());  \n            Sleep(MIN_TIMER_DURATION);  \n            continue;           // select again  \n        &#125;  \n\n        if (nfds == 0)  \n        &#123;  \n            continue;  \n        &#125;  \n\n        for (u_int i = 0; i &lt; read_set.fd_count; i++)  \n        &#123;  \n            //log(&quot;select return read count=%d\\n&quot;, read_set.fd_count);  \n            SOCKET fd = read_set.fd_array[i];  \n            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  \n            if (pSocket)  \n            &#123;  \n                pSocket-&gt;OnRead();  \n                pSocket-&gt;ReleaseRef();  \n            &#125;  \n        &#125;  \n\n        for (u_int i = 0; i &lt; write_set.fd_count; i++)  \n        &#123;  \n            //log(&quot;select return write count=%d\\n&quot;, write_set.fd_count);  \n            SOCKET fd = write_set.fd_array[i];  \n            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  \n            if (pSocket)  \n            &#123;  \n                pSocket-&gt;OnWrite();  \n                pSocket-&gt;ReleaseRef();  \n            &#125;  \n        &#125;  \n\n        for (u_int i = 0; i &lt; excep_set.fd_count; i++)  \n        &#123;  \n            //log(&quot;select return exception count=%d\\n&quot;, excep_set.fd_count);  \n            SOCKET fd = excep_set.fd_array[i];  \n            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  \n            if (pSocket)  \n            &#123;  \n                pSocket-&gt;OnClose();  \n                pSocket-&gt;ReleaseRef();  \n            &#125;  \n        &#125;   \n    &#125; \n&#125;  å†çœ‹filezillaï¼Œä¸€æ¬¾ftpå·¥å…·çš„æœåŠ¡å™¨ç«¯ï¼Œå®ƒé‡‡ç”¨çš„æ˜¯Windowsçš„WSAAsyncSelectæ¨¡å‹ï¼ˆä»£ç ä¸‹è½½åœ°å€ï¼šhttps://github.com/baloonwj/filezillaï¼‰ï¼š\ntxt//Processes event notifications sent by the sockets or the layers\nstatic LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)\n&#123;\n    if (message&gt;=WM_SOCKETEX_NOTIFY)\n    &#123;\n        //Verify parameters\n        ASSERT(hWnd);\n        CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)GetWindowLongPtr(hWnd, GWLP_USERDATA);\n        ASSERT(pWnd);\n        if (!pWnd)\n            return 0;\n\n        if (message &lt; static_cast&lt;UINT&gt;(WM_SOCKETEX_NOTIFY+pWnd-&gt;m_nWindowDataSize)) //Index is within socket storage\n        &#123;\n            //Lookup socket and verify if it&#39;s valid\n            CAsyncSocketEx *pSocket=pWnd-&gt;m_pAsyncSocketExWindowData[message - WM_SOCKETEX_NOTIFY].m_pSocket;\n            SOCKET hSocket = wParam;\n            if (!pSocket)\n                return 0;\n            if (hSocket == INVALID_SOCKET)\n                return 0;\n            if (pSocket-&gt;m_SocketData.hSocket != hSocket)\n                return 0;\n\n            int nEvent = lParam &amp; 0xFFFF;\n            int nErrorCode = lParam &gt;&gt; 16;\n\n            //Dispatch notification\n            if (!pSocket-&gt;m_pFirstLayer) &#123;\n                //Dispatch to CAsyncSocketEx instance\n                switch (nEvent)\n                &#123;\n                case FD_READ:\n                 #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                        &#123;\n                            pSocket-&gt;m_nPendingEvents |= FD_READ;\n                            break;\n                        &#125;\n                        else if (pSocket-&gt;GetState() == attached)\n                            pSocket-&gt;SetState(connected);\n                        if (pSocket-&gt;GetState() != connected)\n                            break;\n                            // Ignore further FD_READ events after FD_CLOSE has been received\n                        if (pSocket-&gt;m_SocketData.onCloseCalled)\n                            break;\n                             #endif //NOSOCKETSTATES\n\n #ifndef NOSOCKETSTATES\n                        if (nErrorCode)\n                            pSocket-&gt;SetState(aborted);\n #endif //NOSOCKETSTATES\n                        if (pSocket-&gt;m_lEvent &amp; FD_READ) &#123;\n                            pSocket-&gt;OnReceive(nErrorCode);\n                        &#125;\n                        break;\n                    case FD_FORCEREAD: //Forceread does not check if there&#39;s data waiting\n #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                        &#123;\n                            pSocket-&gt;m_nPendingEvents |= FD_FORCEREAD;\n                            break;\n                        &#125;\n                        else if (pSocket-&gt;GetState() == attached)\n                            pSocket-&gt;SetState(connected);\n                        if (pSocket-&gt;GetState() != connected)\n                            break;\n #endif //NOSOCKETSTATES\n                        if (pSocket-&gt;m_lEvent &amp; FD_READ)\n                        &#123;\n #ifndef NOSOCKETSTATES\n                            if (nErrorCode)\n                                pSocket-&gt;SetState(aborted);\n #endif //NOSOCKETSTATES\n                            pSocket-&gt;OnReceive(nErrorCode);\n                        &#125;\n                        break;\n                    case FD_WRITE:\n #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                        &#123;\n                            pSocket-&gt;m_nPendingEvents |= FD_WRITE;\n                            break;\n                        &#125;\n                        else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                            pSocket-&gt;SetState(connected);\n                        if (pSocket-&gt;GetState() != connected)\n                            break;\n #endif //NOSOCKETSTATES\n                        if (pSocket-&gt;m_lEvent &amp; FD_WRITE)\n                        &#123;\n #ifndef NOSOCKETSTATES\n                            if (nErrorCode)\n                                pSocket-&gt;SetState(aborted);\n #endif //NOSOCKETSTATES\n                            pSocket-&gt;OnSend(nErrorCode);\n                        &#125;\n                        break;\n                    case FD_CONNECT:\n #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() == connecting)\n                        &#123;\n                            if (nErrorCode &amp;&amp; pSocket-&gt;m_SocketData.nextAddr)\n                            &#123;\n                                if (pSocket-&gt;TryNextProtocol())\n                                    break;\n                            &#125;\n                            pSocket-&gt;SetState(connected);\n                        &#125;\n                        else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                            pSocket-&gt;SetState(connected);\n #endif //NOSOCKETSTATES\n                        if (pSocket-&gt;m_lEvent &amp; FD_CONNECT)\n                            pSocket-&gt;OnConnect(nErrorCode);\n #ifndef NOSOCKETSTATES\n                        if (!nErrorCode)\n                        &#123;\n                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_READ) &amp;&amp; pSocket-&gt;GetState() == connected)\n                                pSocket-&gt;OnReceive(0);\n                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_FORCEREAD) &amp;&amp; pSocket-&gt;GetState() == connected)\n                                pSocket-&gt;OnReceive(0);\n                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_WRITE) &amp;&amp; pSocket-&gt;GetState() == connected)\n                                pSocket-&gt;OnSend(0);\n                        &#125;\n                        pSocket-&gt;m_nPendingEvents = 0;\n #endif\n                        break;\n                    case FD_ACCEPT:\n #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() != listening &amp;&amp; pSocket-&gt;GetState() != attached)\n                            break;\n #endif //NOSOCKETSTATES\n                        if (pSocket-&gt;m_lEvent &amp; FD_ACCEPT)\n                            pSocket-&gt;OnAccept(nErrorCode);\n                        break;\n                    case FD_CLOSE:\n #ifndef NOSOCKETSTATES\n                        if (pSocket-&gt;GetState() != connected &amp;&amp; pSocket-&gt;GetState() != attached)\n                            break;\n                            // If there are still bytes left to read, call OnReceive instead of\n                    // OnClose and trigger a new OnClose\n                    DWORD nBytes = 0;\n                    if (!nErrorCode &amp;&amp; pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))\n                    &#123;\n                        if (nBytes &gt; 0)\n                        &#123;\n                            // Just repeat message.\n                            pSocket-&gt;ResendCloseNotify();\n                            pSocket-&gt;m_SocketData.onCloseCalled = true;\n                            pSocket-&gt;OnReceive(WSAESHUTDOWN);\n                            break;\n                        &#125;\n                    &#125;\n\n                    pSocket-&gt;SetState(nErrorCode ? aborted : closed);\n                     #endif //NOSOCKETSTATES\n                     pSocket-&gt;OnClose(nErrorCode);\n                    break;\n                &#125;\n            &#125;\n            else //Dispatch notification to the lowest layer\n            &#123;\n                if (nEvent == FD_READ)\n                &#123;\n                    // Ignore further FD_READ events after FD_CLOSE has been received\n                    if (pSocket-&gt;m_SocketData.onCloseCalled)\n                        return 0;\n\n                    DWORD nBytes;\n                    if (!pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))\n                        nErrorCode = WSAGetLastError();\n                    if (pSocket-&gt;m_pLastLayer)\n                        pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);\n                &#125;\n                else if (nEvent == FD_CLOSE)\n                &#123;\n                    // If there are still bytes left to read, call OnReceive instead of\n                    // OnClose and trigger a new OnClose\n                    DWORD nBytes = 0;\n                    if (!nErrorCode &amp;&amp; pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))\n                    &#123;\n                        if (nBytes &gt; 0)\n                        &#123;\n                            // Just repeat message.\n                            pSocket-&gt;ResendCloseNotify();\n                            if (pSocket-&gt;m_pLastLayer)\n                                pSocket-&gt;m_pLastLayer-&gt;CallEvent(FD_READ, 0);\n                            return 0;\n                        &#125;\n                    &#125;\n                    pSocket-&gt;m_SocketData.onCloseCalled = true;\n                    if (pSocket-&gt;m_pLastLayer)\n                        pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);\n                &#125;\n                else if (pSocket-&gt;m_pLastLayer)\n                    pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);\n            &#125;\n        &#125;\n        return 0;\n    &#125;\n    else if (message == WM_USER) //Notification event sent by a layer\n    &#123;\n        //Verify parameters, lookup socket and notification message\n        //Verify parameters\n        ASSERT(hWnd);\n        CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)GetWindowLongPtr(hWnd, GWLP_USERDATA);\n        ASSERT(pWnd);\n        if (!pWnd)\n            return 0;\n\n        if (wParam &gt;= static_cast&lt;UINT&gt;(pWnd-&gt;m_nWindowDataSize)) //Index is within socket storage\n        &#123;\n            return 0;\n        &#125;\n\n        CAsyncSocketEx *pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[wParam].m_pSocket;\n        CAsyncSocketExLayer::t_LayerNotifyMsg *pMsg = (CAsyncSocketExLayer::t_LayerNotifyMsg *)lParam;\n        if (!pMsg || !pSocket || pSocket-&gt;m_SocketData.hSocket != pMsg-&gt;hSocket)\n        &#123;\n            delete pMsg;\n            return 0;\n        &#125;\n        int nEvent=pMsg-&gt;lEvent&amp;0xFFFF;\n        int nErrorCode=pMsg-&gt;lEvent&gt;&gt;16;\n\n        //Dispatch to layer\n        if (pMsg-&gt;pLayer)\n            pMsg-&gt;pLayer-&gt;CallEvent(nEvent, nErrorCode);\n        else\n        &#123;\n            //Dispatch to CAsyncSocketEx instance\n            switch (nEvent)\n            &#123;\n            case FD_READ:\n            #ifndef NOSOCKETSTATES\n                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                    &#123;\n                        pSocket-&gt;m_nPendingEvents |= FD_READ;\n                        break;\n                    &#125;\n                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                        pSocket-&gt;SetState(connected);\n                    if (pSocket-&gt;GetState() != connected)\n                        break;\n#endif //NOSOCKETSTATES\n                    if (pSocket-&gt;m_lEvent &amp; FD_READ)\n                    &#123;\n#ifndef NOSOCKETSTATES\n                        if (nErrorCode)\n                            pSocket-&gt;SetState(aborted);\n#endif //NOSOCKETSTATES\n                        pSocket-&gt;OnReceive(nErrorCode);\n                    &#125;\n                    break;\n                case FD_FORCEREAD: //Forceread does not check if there&#39;s data waiting\n#ifndef NOSOCKETSTATES\n                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                    &#123;\n                        pSocket-&gt;m_nPendingEvents |= FD_FORCEREAD;\n                        break;\n                    &#125;\n                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                        pSocket-&gt;SetState(connected);\n                    if (pSocket-&gt;GetState() != connected)\n                        break;\n#endif //NOSOCKETSTATES\n                    if (pSocket-&gt;m_lEvent &amp; FD_READ)\n                    &#123;\n#ifndef NOSOCKETSTATES\n                        if (nErrorCode)\n                            pSocket-&gt;SetState(aborted);\n#endif //NOSOCKETSTATES\n                        pSocket-&gt;OnReceive(nErrorCode);\n                    &#125;\n                    break;\n                case FD_WRITE:\n#ifndef NOSOCKETSTATES\n                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)\n                    &#123;\n                        pSocket-&gt;m_nPendingEvents |= FD_WRITE;\n                        break;\n                    &#125;\n                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                        pSocket-&gt;SetState(connected);\n                    if (pSocket-&gt;GetState() != connected)\n                        break;\n#endif //NOSOCKETSTATES\n                    if (pSocket-&gt;m_lEvent &amp; FD_WRITE)\n                    &#123;\n#ifndef NOSOCKETSTATES\n                        if (nErrorCode)\n                            pSocket-&gt;SetState(aborted);\n#endif //NOSOCKETSTATES\n                        pSocket-&gt;OnSend(nErrorCode);\n                    &#125;\n                    break;\n                case FD_CONNECT:\n#ifndef NOSOCKETSTATES\n                    if (pSocket-&gt;GetState() == connecting)\n                        pSocket-&gt;SetState(connected);\n                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)\n                        pSocket-&gt;SetState(connected);\n#endif //NOSOCKETSTATES\n                    if (pSocket-&gt;m_lEvent &amp; FD_CONNECT)\n                        pSocket-&gt;OnConnect(nErrorCode);\n#ifndef NOSOCKETSTATES\n                    if (!nErrorCode)\n                    &#123;\n                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_READ) &amp;&amp; pSocket-&gt;GetState() == connected) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_READ))\n                            pSocket-&gt;OnReceive(0);\n                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_FORCEREAD) &amp;&amp; pSocket-&gt;GetState() == connected) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_READ))\n                            pSocket-&gt;OnReceive(0);\n                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_WRITE) &amp;&amp; pSocket-&gt;GetState() == connected) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_WRITE))\n                            pSocket-&gt;OnSend(0);\n                    &#125;\n                    pSocket-&gt;m_nPendingEvents = 0;\n#endif //NOSOCKETSTATES\n                    break;\n                case FD_ACCEPT:\n#ifndef NOSOCKETSTATES\n                    if ((pSocket-&gt;GetState() == listening || pSocket-&gt;GetState() == attached) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_ACCEPT))\n#endif //NOSOCKETSTATES\n                    &#123;\n                        pSocket-&gt;OnAccept(nErrorCode);\n                    &#125;\n                    break;\n                case FD_CLOSE:\n#ifndef NOSOCKETSTATES\n                    if ((pSocket-&gt;GetState() == connected || pSocket-&gt;GetState() == attached) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_CLOSE))\n                    &#123;\n                        pSocket-&gt;SetState(nErrorCode?aborted:closed);\n#else\n                    &#123;\n#endif //NOSOCKETSTATES\n                        pSocket-&gt;OnClose(nErrorCode);\n                    &#125;\n                    break;\n                &#125;\n            &#125;\n            delete pMsg;\n            return 0;\n        &#125;\n        else if (message == WM_USER+1)\n        &#123;\n            // WSAAsyncGetHostByName reply\n            // Verify parameters\n        ASSERT(hWnd);\n        CAsyncSocketExHelperWindow *pWnd = (CAsyncSocketExHelperWindow *)GetWindowLongPtr(hWnd, GWLP_USERDATA);\n        ASSERT(pWnd);\n        if (!pWnd)\n            return 0;\n\n        CAsyncSocketEx *pSocket = NULL;\n        for (int i = 0; i &lt; pWnd-&gt;m_nWindowDataSize; ++i) &#123;\n            pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[i].m_pSocket;\n            if (pSocket &amp;&amp; pSocket-&gt;m_hAsyncGetHostByNameHandle &amp;&amp;\n                pSocket-&gt;m_hAsyncGetHostByNameHandle == (HANDLE)wParam &amp;&amp;\n                pSocket-&gt;m_pAsyncGetHostByNameBuffer)\n                break;\n        &#125;\n        if (!pSocket || !pSocket-&gt;m_pAsyncGetHostByNameBuffer)\n            return 0;\n\n        int nErrorCode = lParam &gt;&gt; 16;\n        if (nErrorCode) &#123;\n            pSocket-&gt;OnConnect(nErrorCode);\n            return 0;\n        &#125;\n\n        SOCKADDR_IN sockAddr&#123;&#125;;\n        sockAddr.sin_family = AF_INET;\n        sockAddr.sin_addr.s_addr = ((LPIN_ADDR)((LPHOSTENT)pSocket-&gt;m_pAsyncGetHostByNameBuffer)-&gt;h_addr)-&gt;s_addr;\n\n        sockAddr.sin_port = htons(pSocket-&gt;m_nAsyncGetHostByNamePort);\n\n        BOOL res = pSocket-&gt;Connect((SOCKADDR*)&amp;sockAddr, sizeof(sockAddr));\n        delete [] pSocket-&gt;m_pAsyncGetHostByNameBuffer;\n        pSocket-&gt;m_pAsyncGetHostByNameBuffer = 0;\n        pSocket-&gt;m_hAsyncGetHostByNameHandle = 0;\n\n        if (!res)\n            if (GetLastError() != WSAEWOULDBLOCK)\n                pSocket-&gt;OnConnect(GetLastError());\n        return 0;\n    &#125;\n    else if (message == WM_USER + 2)\n    &#123;\n        //Verify parameters, lookup socket and notification message\n        //Verify parameters\n        if (!hWnd)\n            return 0;\n\n        CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)GetWindowLongPtr(hWnd, GWLP_USERDATA);\n        if (!pWnd)\n            return 0;\n\n        if (wParam &gt;= static_cast&lt;UINT&gt;(pWnd-&gt;m_nWindowDataSize)) //Index is within socket storage\n            return 0;\n\n        CAsyncSocketEx *pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[wParam].m_pSocket;\n        if (!pSocket)\n            return 0;\n\n        // Process pending callbacks\n        std::list&lt;t_callbackMsg&gt; tmp;\n        tmp.swap(pSocket-&gt;m_pendingCallbacks);\n        pSocket-&gt;OnLayerCallback(tmp);\n\n        for (auto &amp; cb : tmp) &#123;\n            delete [] cb.str;\n        &#125;\n    &#125;\n    else if (message == WM_TIMER)\n    &#123;\n        if (wParam != 1)\n            return 0;\n\n        ASSERT(hWnd);\n        CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)GetWindowLongPtr(hWnd, GWLP_USERDATA);\n        ASSERT(pWnd &amp;&amp; pWnd-&gt;m_pThreadData);\n        if (!pWnd || !pWnd-&gt;m_pThreadData)\n            return 0;\n\n        if (pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.empty())\n        &#123;\n            KillTimer(hWnd, 1);\n            return 0;\n        &#125;\n        CAsyncSocketEx* socket = pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.front();\n        pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.pop_front();\n        if (pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.empty())\n            KillTimer(hWnd, 1);\n\n        if (socket)\n            PostMessage(hWnd, socket-&gt;m_SocketData.nSocketIndex + WM_SOCKETEX_NOTIFY, socket-&gt;m_SocketData.hSocket, FD_CLOSE);\n        return 0;\n    &#125;\n    return DefWindowProc(hWnd, message, wParam, lParam);\n&#125;\tä¸Šé¢æˆªå–çš„ä»£ç æ®µï¼Œå¦‚æœä½ å¯¹è¿™äº›é¡¹ç›®ä¸æ˜¯å¾ˆç†Ÿæ‚‰çš„è¯ï¼Œä¼°è®¡ä½ ä¹Ÿæ²¡æœ‰ä»»ä½•å…´è¶£å»ç»†ç»†çœ‹æ¯ä¸€è¡Œä»£ç é€»è¾‘ã€‚ä½†æ˜¯ä½ ä¸€å®šè¦æ˜ç™½æˆ‘æ‰€è¯´çš„è¿™ä¸ªç»“æ„çš„é€»è¾‘ï¼ŒåŸºæœ¬ä¸Šç›®å‰ä¸»æµçš„ç½‘ç»œæ¡†æ¶éƒ½æ˜¯è¿™å¥—åŸç†ã€‚æ¯”å¦‚filezillaçš„ç½‘ç»œé€šä¿¡å±‚åŒæ ·ä¹Ÿè¢«ç”¨åœ¨å¤§åé¼é¼çš„ç”µé©´ï¼ˆeasyMuleï¼‰ä¸­ã€‚\nå…³äºå•ä¸ªæœåŠ¡ç¨‹åºçš„æ¡†æ¶ï¼Œæˆ‘å·²ç»ä»‹ç»å®Œäº†ï¼Œå¦‚æœä½ èƒ½å®Œå…¨ç†è§£æˆ‘è¦è¡¨è¾¾çš„æ„æ€ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¹Ÿèƒ½æ„å»ºå‡ºä¸€å¥—é«˜æ€§èƒ½æœåŠ¡ç¨‹åºæ¥ã€‚\nå¦å¤–ï¼ŒæœåŠ¡å™¨æ¡†æ¶ä¹Ÿå¯ä»¥åœ¨ä¸Šé¢çš„è®¾è®¡æ€è·¯çš„åŸºç¡€ä¸Šå¢åŠ å¾ˆå¤šæœ‰æ„æ€çš„ç»†èŠ‚ï¼Œæ¯”å¦‚æµé‡æ§åˆ¶ã€‚ä¸¾å¦å¤– ä¸€ä¸ªæˆ‘å®é™…åšè¿‡çš„é¡¹ç›®ä¸­çš„ä¾‹å­å§ï¼š\nä¸€èˆ¬å®é™…é¡¹ç›®ä¸­ï¼Œå½“å®¢æˆ·ç«¯è¿æ¥æ•°ç›®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†ç½‘ç»œæ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœåŒæ—¶æœ‰å¤šä¸ªsocketä¸Šæœ‰æ•°æ®è¦å¤„ç†ï¼Œç”±äºcpuæ ¸æ•°æœ‰é™ï¼Œæ ¹æ®ä¸Šé¢å…ˆæ£€æµ‹iOäº‹ä»¶å†å¤„ç†IOäº‹ä»¶å¯èƒ½ä¼šå‡ºç°å·¥ä½œçº¿ç¨‹ä¸€ç›´å¤„ç†å‰å‡ ä¸ªsocketçš„äº‹ä»¶ï¼Œç›´åˆ°å‰å‡ ä¸ªsocketå¤„ç†å®Œæ¯•åå†å¤„ç†åé¢å‡ ä¸ªsocketçš„æ•°æ®ã€‚è¿™å°±ç›¸å½“äºï¼Œä½ å»é¥­åº—åƒé¥­ï¼Œå¤§å®¶éƒ½ç‚¹äº†èœï¼Œä½†æ˜¯æœ‰äº›æ¡Œå­ä¸Šä¸€ç›´åœ¨ä¸Šèœï¼Œè€Œæœ‰äº›æ¡Œå­ä¸Šä¸€ç›´æ²¡æœ‰èœã€‚è¿™æ ·è‚¯å®šä¸å¥½ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•é¿å…è¿™ç§ç°è±¡ï¼š\ntxtint CFtdEngine::HandlePackage(CFTDCPackage *pFTDCPackage, CFTDCSession *pSession)\n&#123;\n    //NET_IO_LOG0(&quot;CFtdEngine::HandlePackage\\n&quot;);\n    FTDC_PACKAGE_DEBUG(pFTDCPackage);\n    if (pFTDCPackage-&gt;GetTID() != FTD_TID_ReqUserLogin)\n    &#123;\n        if (!IsSessionLogin(pSession-&gt;GetSessionID()))\n        &#123;\n            SendErrorRsp(pFTDCPackage, pSession, 1, &quot;å®¢æˆ·æœªç™»å½•&quot;);\n            return 0;\n        &#125;\n    &#125;\n\n    CalcFlux(pSession, pFTDCPackage-&gt;Length());\t//ç»Ÿè®¡æµé‡\n\n    REPORT_EVENT(LOG_DEBUG, &quot;Front/Fgateway&quot;, &quot;ç™»å½•è¯·æ±‚%0x&quot;, pFTDCPackage-&gt;GetTID()); \n\n    int nRet = 0;\n    switch(pFTDCPackage-&gt;GetTID()) \n    &#123;\n\n    case FTD_TID_ReqUserLogin:\n        ///huwpï¼š20070608ï¼šæ£€æŸ¥è¿‡é«˜ç‰ˆæœ¬çš„APIå°†è¢«ç¦æ­¢ç™»å½•\n        if (pFTDCPackage-&gt;GetVersion()&gt;FTD_VERSION)\n        &#123;\n            SendErrorRsp(pFTDCPackage, pSession, 1, &quot;Too High FTD Version&quot;);\n            return 0;\n        &#125;\n        nRet = OnReqUserLogin(pFTDCPackage, (CFTDCSession *)pSession);\n        FTDRequestIndex.incValue();\n        break;\n    case FTD_TID_ReqCheckUserLogin:\n        nRet = OnReqCheckUserLogin(pFTDCPackage, (CFTDCSession *)pSession);\n        FTDRequestIndex.incValue();\n        break;\n    case FTD_TID_ReqSubscribeTopic:\n        nRet = OnReqSubscribeTopic(pFTDCPackage, (CFTDCSession *)pSession);\n        FTDRequestIndex.incValue();\n        break;\t\n    &#125;\n\n    return 0;\n&#125;å½“æœ‰æŸä¸ªsocketä¸Šæœ‰æ•°æ®å¯è¯»æ—¶ï¼Œæ¥ç€æ¥æ”¶è¯¥socketä¸Šçš„æ•°æ®ï¼Œå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£åŒ…ï¼Œç„¶åè°ƒç”¨CalcFlux(pSession, pFTDCPackage-&gt;Length())è¿›è¡Œæµé‡ç»Ÿè®¡ï¼š\n1234567891011121314void CFrontEngine::CalcFlux(CSession *pSession, const int nFlux)&#123;\tTFrontSessionInfo *pSessionInfo = m_mapSessionInfo.Find(pSession-&gt;GetSessionID());\tif (pSessionInfo != NULL)\t&#123;\t\t//æµé‡æ§åˆ¶æ”¹ä¸ºè®¡æ•°\t\tpSessionInfo-&gt;nCommFlux ++; \t\t///è‹¥æµé‡è¶…è¿‡è§„å®šï¼Œåˆ™æŒ‚èµ·è¯¥ä¼šè¯çš„è¯»æ“ä½œ\t\tif (pSessionInfo-&gt;nCommFlux &gt;= pSessionInfo-&gt;nMaxCommFlux)\t\t&#123;\t\t\tpSession-&gt;SuspendRead(true);\t\t&#125;\t&#125;&#125;\n\nè¯¥å‡½æ•°ä¼šå…ˆè®©æŸä¸ªè¿æ¥ä¼šè¯ï¼ˆSessionï¼‰å¤„ç†çš„åŒ…æ•°é‡é€’å¢ï¼Œæ¥ç€åˆ¤æ–­æ˜¯å¦è¶…è¿‡æœ€å¤§åŒ…æ•°é‡ï¼Œåˆ™è®¾ç½®è¯»æŒ‚èµ·æ ‡å¿—ï¼š\n1234void CSession::SuspendRead(bool bSuspend)  &#123;  \tm_bSuspendRead = bSuspend;  &#125;  \n\nè¿™æ ·ä¸‹æ¬¡å°†ä¼šä»æ£€æµ‹çš„socketåˆ—è¡¨ä¸­æ’é™¤è¯¥socketï¼š\n12345678910111213141516171819202122232425262728void CEpollReactor::RegisterIO(CEventHandler *pEventHandler)  &#123;      int nReadID, nWriteID;      pEventHandler-&gt;GetIds(&amp;nReadID, &amp;nWriteID);      if (nWriteID != 0 &amp;&amp; nReadID ==0)      &#123;          nReadID = nWriteID;      &#125;      if (nReadID != 0)      &#123;          m_mapEventHandlerId[pEventHandler] = nReadID;          struct epoll_event ev;          ev.data.ptr = pEventHandler;          if(epoll_ctl(m_fdEpoll, EPOLL_CTL_ADD, nReadID, &amp;ev) != 0)          &#123;              perror(&quot;epoll_ctl EPOLL_CTL_ADD&quot;);          &#125;      &#125;  &#125;  void CSession::GetIds(int *pReadId, int *pWriteId)  &#123;      m_pChannelProtocol-&gt;GetIds(pReadId,pWriteId);      if (m_bSuspendRead)      &#123;          *pReadId = 0;      &#125;  &#125;  \n\nä¹Ÿå°±æ˜¯è¯´ä¸å†æ£€æµ‹è¯¥socketä¸Šæ˜¯å¦æœ‰æ•°æ®å¯è¯»ã€‚ç„¶ååœ¨å®šæ—¶å™¨é‡Œ1ç§’åé‡ç½®è¯¥æ ‡å¿—ï¼Œè¿™æ ·è¿™ä¸ªsocketä¸Šæœ‰æ•°æ®çš„è¯åˆå¯ä»¥é‡æ–°æ£€æµ‹åˆ°äº†ï¼š\n123456789101112131415161718192021222324252627282930313233const int SESSION_CHECK_TIMER_ID    = 9;  const int SESSION_CHECK_INTERVAL    = 1000;  SetTimer(SESSION_CHECK_TIMER_ID, SESSION_CHECK_INTERVAL);  void CFrontEngine::OnTimer(int nIDEvent)  &#123;      if (nIDEvent == SESSION_CHECK_TIMER_ID)      &#123;          CSessionMap::iterator itor = m_mapSession.Begin();          while (!itor.IsEnd())          &#123;              TFrontSessionInfo *pFind = m_mapSessionInfo.Find((*itor)-&gt;GetSessionID());              if (pFind != NULL)              &#123;                  CheckSession(*itor, pFind);              &#125;              itor++;          &#125;      &#125;  &#125;  void CFrontEngine::CheckSession(CSession *pSession, TFrontSessionInfo *pSessionInfo)  &#123;      ///é‡æ–°å¼€å§‹è®¡ç®—æµé‡      pSessionInfo-&gt;nCommFlux -= pSessionInfo-&gt;nMaxCommFlux;      if (pSessionInfo-&gt;nCommFlux &lt; 0)      &#123;          pSessionInfo-&gt;nCommFlux = 0;      &#125;      ///è‹¥æµé‡è¶…è¿‡è§„å®šï¼Œåˆ™æŒ‚èµ·è¯¥ä¼šè¯çš„è¯»æ“ä½œ      pSession-&gt;SuspendRead(pSessionInfo-&gt;nCommFlux &gt;= pSessionInfo-&gt;nMaxCommFlux);  &#125;  \n\nè¿™å°±ç›¸å½“ä¸é¥­åº—é‡Œé¢å…ˆç»™æŸä¸€æ¡Œå®¢äººä¸Šä¸€äº›èœï¼Œè®©ä»–ä»¬å…ˆåƒç€ï¼Œç­‰ä¸Šäº†ä¸€äº›èœä¹‹åä¸ä¼šå†ç»™è¿™æ¡Œç»§ç»­ä¸Šèœäº†ï¼Œè€Œæ˜¯ç»™å…¶å®ƒç©ºæ¡Œä¸Šèœï¼Œå¤§å®¶éƒ½åƒä¸Šåï¼Œç»§ç»­å›æ¥ç»™åŸå…ˆçš„æ¡Œå­ç»§ç»­ä¸Šèœã€‚å®é™…ä¸Šæˆ‘ä»¬çš„é¥­åº—éƒ½æ˜¯è¿™ä¹ˆåšçš„ã€‚ä¸Šé¢çš„ä¾‹å­æ˜¯å•æœåŠ¡æµé‡æ§åˆ¶çš„å®ç°çš„ä¸€ä¸ªéå¸¸å¥½çš„æ€è·¯ï¼Œå®ƒä¿è¯äº†æ¯ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½å‡è¡¡åœ°å¾—åˆ°æœåŠ¡ï¼Œè€Œä¸æ˜¯ä¸€äº›å®¢æˆ·ç«¯ç­‰å¾ˆä¹…æ‰æœ‰å“åº”ã€‚å½“ç„¶ï¼Œè¿™æ ·çš„æŠ€æœ¯ä¸èƒ½é€‚ç”¨äºæœ‰é¡ºåºè¦æ±‚çš„ä¸šåŠ¡ï¼Œä¾‹å¦‚é”€å”®ç³»ç»Ÿï¼Œè¿™äº›ç³»ç»Ÿä¸€èˆ¬æ˜¯å…ˆä¸‹å•å…ˆå¾—åˆ°çš„ã€‚\nå¦å¤–ç°åœ¨çš„æœåŠ¡å™¨ä¸ºäº†åŠ å¿«ï¼©ï¼¯æ“ä½œï¼Œå¤§é‡ä½¿ç”¨ç¼“å­˜æŠ€æœ¯ï¼Œç¼“å­˜å®é™…ä¸Šæ˜¯ä»¥ç©ºé—´æ¢å–æ—¶é—´çš„ç­–ç•¥ã€‚å¯¹äºä¸€äº›åå¤ä½¿ç”¨çš„ï¼Œä½†æ˜¯ä¸ç»å¸¸æ”¹å˜çš„ä¿¡æ¯ï¼Œå¦‚æœä»åŸå§‹åœ°ç‚¹åŠ è½½è¿™äº›ä¿¡æ¯å°±æ¯”è¾ƒè€—æ—¶çš„æ•°æ®ï¼ˆæ¯”å¦‚ä»ç£ç›˜ä¸­ã€ä»æ•°æ®åº“ä¸­ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç¼“å­˜ã€‚æ‰€ä»¥æ—¶ä¸‹åƒredisã€leveldbã€fastdbç­‰å„ç§å†…å­˜æ•°æ®åº“å¤§è¡Œå…¶é“ã€‚å¦‚æœä½ è¦ä»äº‹æœåŠ¡å™¨å¼€å‘ï¼Œä½ è‡³å°‘éœ€è¦æŒæ¡å®ƒä»¬ä¸­çš„å‡ ç§ã€‚\nã€€ã€€é‰´äºç¬”è€…èƒ½åŠ›å’Œç»éªŒæœ‰é™ï¼Œæ–‡ä¸­éš¾å…æœ‰é”™æ¼ä¹‹å¤„ï¼Œæ¬¢è¿ææ„è§ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/C++é«˜æ€§èƒ½æœåŠ¡å™¨ç½‘ç»œæ¡†æ¶è®¾è®¡ç»†èŠ‚","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"f49eefb0c9add12a3ac803e71934ac10","title":"ã€è½¬è½½ã€‘Reactoræ¨¡å¼","content":"Reactoræ¨¡å¼æœ€è¿‘ä¸€ç›´åœ¨çœ‹æ¸¸åŒçš„ã€Šé«˜æ€§èƒ½LinuxæœåŠ¡å™¨ç¼–ç¨‹ã€‹ä¸€ä¹¦ï¼Œä¸‹è½½é“¾æ¥ï¼š http://download.csdn.net/detail/analogous_love/9673008\nä¹¦ä¸Šæ˜¯è¿™ä¹ˆä»‹ç»Reactoræ¨¡å¼çš„ï¼š\n\næŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œæˆ‘å†™ä¸ªç®€å•çš„ç»ƒä¹ ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376/**  *@desc:   ç”¨reactoræ¨¡å¼ç»ƒä¹ æœåŠ¡å™¨ç¨‹åºï¼Œmain.cpp *@author: zhangyl *@date:   2016.11.23 */ #include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;#include &lt;netinet/in.h&gt;#include &lt;arpa/inet.h&gt;  //for htonl() and htons()#include &lt;unistd.h&gt;#include &lt;fcntl.h&gt;#include &lt;sys/epoll.h&gt;#include &lt;signal.h&gt;     //for signal()#include &lt;pthread.h&gt;#include &lt;semaphore.h&gt;#include &lt;list&gt;#include &lt;errno.h&gt;#include &lt;time.h&gt;#include &lt;sstream&gt;#include &lt;iomanip&gt; //for std::setw()/setfill()#include &lt;stdlib.h&gt;  #define WORKER_THREAD_NUM   5 #define min(a, b) ((a &lt;= b) ? (a) : (b))  int g_epollfd = 0;bool g_bStop = false;int g_listenfd = 0;pthread_t g_acceptthreadid = 0;pthread_t g_threadid[WORKER_THREAD_NUM] = &#123; 0 &#125;;pthread_cond_t g_acceptcond;pthread_mutex_t g_acceptmutex; pthread_cond_t g_cond /*= PTHREAD_COND_INITIALIZER*/;pthread_mutex_t g_mutex /*= PTHREAD_MUTEX_INITIALIZER*/; pthread_mutex_t g_clientmutex; std::list&lt;int&gt; g_listClients; void prog_exit(int signo)&#123;    ::signal(SIGINT, SIG_IGN);    //::signal(SIGKILL, SIG_IGN);//è¯¥ä¿¡å·ä¸èƒ½è¢«é˜»å¡ã€å¤„ç†æˆ–è€…å¿½ç•¥    ::signal(SIGTERM, SIG_IGN);     std::cout &lt;&lt; &quot;program recv signal &quot; &lt;&lt; signo &lt;&lt; &quot; to exit.&quot; &lt;&lt; std::endl;     g_bStop = true;     ::epoll_ctl(g_epollfd, EPOLL_CTL_DEL, g_listenfd, NULL);     //TODO: æ˜¯å¦éœ€è¦å…ˆè°ƒç”¨shutdown()ä¸€ä¸‹ï¼Ÿ    ::shutdown(g_listenfd, SHUT_RDWR);    ::close(g_listenfd);    ::close(g_epollfd);     ::pthread_cond_destroy(&amp;g_acceptcond);    ::pthread_mutex_destroy(&amp;g_acceptmutex);        ::pthread_cond_destroy(&amp;g_cond);    ::pthread_mutex_destroy(&amp;g_mutex);     ::pthread_mutex_destroy(&amp;g_clientmutex);&#125; bool create_server_listener(const char* ip, short port)&#123;    g_listenfd = ::socket(AF_INET, SOCK_STREAM | SOCK_NONBLOCK, 0);    if (g_listenfd == -1)        return false;     int on = 1;    ::setsockopt(g_listenfd, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;on, sizeof(on));    ::setsockopt(g_listenfd, SOL_SOCKET, SO_REUSEPORT, (char *)&amp;on, sizeof(on));     struct sockaddr_in servaddr;    memset(&amp;servaddr, 0, sizeof(servaddr));     servaddr.sin_family = AF_INET;    servaddr.sin_addr.s_addr = inet_addr(ip);    servaddr.sin_port = htons(port);    if (::bind(g_listenfd, (sockaddr *)&amp;servaddr, sizeof(servaddr)) == -1)        return false;     if (::listen(g_listenfd, 50) == -1)        return false;     g_epollfd = ::epoll_create(1);    if (g_epollfd == -1)        return false;     struct epoll_event e;    memset(&amp;e, 0, sizeof(e));    e.events = EPOLLIN | EPOLLRDHUP;    e.data.fd = g_listenfd;    if (::epoll_ctl(g_epollfd, EPOLL_CTL_ADD, g_listenfd, &amp;e) == -1)        return false;     return true;&#125; void release_client(int clientfd)&#123;    if (::epoll_ctl(g_epollfd, EPOLL_CTL_DEL, clientfd, NULL) == -1)        std::cout &lt;&lt; &quot;release client socket failed as call epoll_ctl failed&quot; &lt;&lt; std::endl;     ::close(clientfd);&#125; void* accept_thread_func(void* arg)&#123;       while (!g_bStop)    &#123;        ::pthread_mutex_lock(&amp;g_acceptmutex);        ::pthread_cond_wait(&amp;g_acceptcond, &amp;g_acceptmutex);        //::pthread_mutex_lock(&amp;g_acceptmutex);         //std::cout &lt;&lt; &quot;run loop in accept_thread_func&quot; &lt;&lt; std::endl;         struct sockaddr_in clientaddr;        socklen_t addrlen;        int newfd = ::accept(g_listenfd, (struct sockaddr *)&amp;clientaddr, &amp;addrlen);        ::pthread_mutex_unlock(&amp;g_acceptmutex);        if (newfd == -1)            continue;         std::cout &lt;&lt; &quot;new client connected: &quot; &lt;&lt; ::inet_ntoa(clientaddr.sin_addr) &lt;&lt; &quot;:&quot; &lt;&lt; ::ntohs(clientaddr.sin_port) &lt;&lt; std::endl;         //å°†æ–°socketè®¾ç½®ä¸ºnon-blocking        int oldflag = ::fcntl(newfd, F_GETFL, 0);        int newflag = oldflag | O_NONBLOCK;        if (::fcntl(newfd, F_SETFL, newflag) == -1)        &#123;            std::cout &lt;&lt; &quot;fcntl error, oldflag =&quot; &lt;&lt; oldflag &lt;&lt; &quot;, newflag = &quot; &lt;&lt; newflag &lt;&lt; std::endl;            continue;        &#125;         struct epoll_event e;        memset(&amp;e, 0, sizeof(e));        e.events = EPOLLIN | EPOLLRDHUP | EPOLLET;        e.data.fd = newfd;        if (::epoll_ctl(g_epollfd, EPOLL_CTL_ADD, newfd, &amp;e) == -1)        &#123;            std::cout &lt;&lt; &quot;epoll_ctl error, fd =&quot; &lt;&lt; newfd &lt;&lt; std::endl;        &#125;    &#125;     return NULL;&#125;  void* worker_thread_func(void* arg)&#123;       while (!g_bStop)    &#123;        int clientfd;        ::pthread_mutex_lock(&amp;g_clientmutex);        while (g_listClients.empty())            ::pthread_cond_wait(&amp;g_cond, &amp;g_clientmutex);        clientfd = g_listClients.front();        g_listClients.pop_front();          pthread_mutex_unlock(&amp;g_clientmutex);         //gdbè°ƒè¯•æ—¶ä¸èƒ½å®æ—¶åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œç”¨è¿™ä¸ªå‡½æ•°åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œä½¿ä¿¡æ¯åœ¨å±å¹•ä¸Šå®æ—¶æ˜¾ç¤ºå‡ºæ¥        std::cout &lt;&lt; std::endl;         std::string strclientmsg;        char buff[256];        bool bError = false;        while (true)        &#123;            memset(buff, 0, sizeof(buff));            int nRecv = ::recv(clientfd, buff, 256, 0);            if (nRecv == -1)            &#123;                if (errno == EWOULDBLOCK)                    break;                else                &#123;                    std::cout &lt;&lt; &quot;recv error, client disconnected, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;                    release_client(clientfd);                    bError = true;                    break;                &#125;                                &#125;            //å¯¹ç«¯å…³é—­äº†socketï¼Œè¿™ç«¯ä¹Ÿå…³é—­ã€‚            else if (nRecv == 0)            &#123;                std::cout &lt;&lt; &quot;peer closed, client disconnected, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;                release_client(clientfd);                bError = true;                break;            &#125;             strclientmsg += buff;        &#125;         //å‡ºé”™äº†ï¼Œå°±ä¸è¦å†ç»§ç»­å¾€ä¸‹æ‰§è¡Œäº†        if (bError)            continue;                std::cout &lt;&lt; &quot;client msg: &quot; &lt;&lt; strclientmsg;         //å°†æ¶ˆæ¯åŠ ä¸Šæ—¶é—´æ ‡ç­¾åå‘å›        time_t now = time(NULL);        struct tm* nowstr = localtime(&amp;now);        std::ostringstream ostimestr;        ostimestr &lt;&lt; &quot;[&quot; &lt;&lt; nowstr-&gt;tm_year + 1900 &lt;&lt; &quot;-&quot;                   &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_mon + 1 &lt;&lt; &quot;-&quot;                   &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_mday &lt;&lt; &quot; &quot;                  &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_hour &lt;&lt; &quot;:&quot;                   &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_min &lt;&lt; &quot;:&quot;                   &lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_sec &lt;&lt; &quot;]server reply: &quot;;         strclientmsg.insert(0, ostimestr.str());                while (true)        &#123;            int nSent = ::send(clientfd, strclientmsg.c_str(), strclientmsg.length(), 0);            if (nSent == -1)            &#123;                if (errno == EWOULDBLOCK)                &#123;                    ::sleep(10);                    continue;                &#125;                else                &#123;                    std::cout &lt;&lt; &quot;send error, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;                    release_client(clientfd);                    break;                &#125;                               &#125;                       std::cout &lt;&lt; &quot;send: &quot; &lt;&lt; strclientmsg;            strclientmsg.erase(0, nSent);             if (strclientmsg.empty())                break;        &#125;    &#125;     return NULL;&#125; void daemon_run()&#123;    int pid;    signal(SIGCHLD, SIG_IGN);    //1ï¼‰åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œforkè¿”å›æ–°åˆ›å»ºå­è¿›ç¨‹çš„è¿›ç¨‹IDï¼›    //2ï¼‰åœ¨å­è¿›ç¨‹ä¸­ï¼Œforkè¿”å›0ï¼›    //3ï¼‰å¦‚æœå‡ºç°é”™è¯¯ï¼Œforkè¿”å›ä¸€ä¸ªè´Ÿå€¼ï¼›    pid = fork();    if (pid &lt; 0)    &#123;        std:: cout &lt;&lt; &quot;fork error&quot; &lt;&lt; std::endl;        exit(-1);    &#125;    //çˆ¶è¿›ç¨‹é€€å‡ºï¼Œå­è¿›ç¨‹ç‹¬ç«‹è¿è¡Œ    else if (pid &gt; 0) &#123;        exit(0);    &#125;    //ä¹‹å‰parentå’Œchildè¿è¡Œåœ¨åŒä¸€ä¸ªsessioné‡Œ,parentæ˜¯ä¼šè¯ï¼ˆsessionï¼‰çš„é¢†å¤´è¿›ç¨‹,    //parentè¿›ç¨‹ä½œä¸ºä¼šè¯çš„é¢†å¤´è¿›ç¨‹ï¼Œå¦‚æœexitç»“æŸæ‰§è¡Œçš„è¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹ä¼šæˆä¸ºå­¤å„¿è¿›ç¨‹ï¼Œå¹¶è¢«initæ”¶å…»ã€‚    //æ‰§è¡Œsetsid()ä¹‹å,childå°†é‡æ–°è·å¾—ä¸€ä¸ªæ–°çš„ä¼šè¯(session)idã€‚    //è¿™æ—¶parenté€€å‡ºä¹‹å,å°†ä¸ä¼šå½±å“åˆ°childäº†ã€‚    setsid();    int fd;    fd = open(&quot;/dev/null&quot;, O_RDWR, 0);    if (fd != -1)    &#123;        dup2(fd, STDIN_FILENO);        dup2(fd, STDOUT_FILENO);        dup2(fd, STDERR_FILENO);    &#125;    if (fd &gt; 2)        close(fd); &#125;  int main(int argc, char* argv[])&#123;      short port = 0;    int ch;    bool bdaemon = false;    while ((ch = getopt(argc, argv, &quot;p:d&quot;)) != -1)    &#123;        switch (ch)        &#123;        case &#x27;d&#x27;:            bdaemon = true;            break;        case &#x27;p&#x27;:            port = atol(optarg);            break;        &#125;    &#125;     if (bdaemon)        daemon_run();      if (port == 0)        port = 12345;         if (!create_server_listener(&quot;0.0.0.0&quot;, port))    &#123;        std::cout &lt;&lt; &quot;Unable to create listen server: ip=0.0.0.0, port=&quot; &lt;&lt; port &lt;&lt; &quot;.&quot; &lt;&lt; std::endl;        return -1;    &#125;         //è®¾ç½®ä¿¡å·å¤„ç†    signal(SIGCHLD, SIG_DFL);    signal(SIGPIPE, SIG_IGN);    signal(SIGINT, prog_exit);    //signal(SIGKILL, prog_exit);//è¯¥ä¿¡å·ä¸èƒ½è¢«é˜»å¡ã€å¤„ç†æˆ–è€…å¿½ç•¥     signal(SIGTERM, prog_exit);     ::pthread_cond_init(&amp;g_acceptcond, NULL);    ::pthread_mutex_init(&amp;g_acceptmutex, NULL);     ::pthread_cond_init(&amp;g_cond, NULL);    ::pthread_mutex_init(&amp;g_mutex, NULL);     ::pthread_mutex_init(&amp;g_clientmutex, NULL);         ::pthread_create(&amp;g_acceptthreadid, NULL, accept_thread_func, NULL);    //å¯åŠ¨å·¥ä½œçº¿ç¨‹    for (int i = 0; i &lt; WORKER_THREAD_NUM; ++i)    &#123;        ::pthread_create(&amp;g_threadid[i], NULL, worker_thread_func, NULL);    &#125;     while (!g_bStop)    &#123;               struct epoll_event ev[1024];        int n = ::epoll_wait(g_epollfd, ev, 1024, 10);        if (n == 0)            continue;        else if (n &lt; 0)        &#123;            std::cout &lt;&lt; &quot;epoll_wait error&quot; &lt;&lt; std::endl;            continue;        &#125;         int m = min(n, 1024);        for (int i = 0; i &lt; m; ++i)        &#123;            //é€šçŸ¥æ¥æ”¶è¿æ¥çº¿ç¨‹æ¥æ”¶æ–°è¿æ¥            if (ev[i].data.fd == g_listenfd)                pthread_cond_signal(&amp;g_acceptcond);            //é€šçŸ¥æ™®é€šå·¥ä½œçº¿ç¨‹æ¥æ”¶æ•°æ®            else            &#123;                               pthread_mutex_lock(&amp;g_clientmutex);                              g_listClients.push_back(ev[i].data.fd);                pthread_mutex_unlock(&amp;g_clientmutex);                pthread_cond_signal(&amp;g_cond);                //std::cout &lt;&lt; &quot;signal&quot; &lt;&lt; std::endl;            &#125;                        &#125;     &#125;        return 0;&#125;\n\nç¨‹åºçš„åŠŸèƒ½ä¸€ä¸ªç®€å•çš„echoæœåŠ¡ï¼šå®¢æˆ·ç«¯è¿æ¥ä¸ŠæœåŠ¡å™¨ä¹‹åï¼Œç»™æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼ŒæœåŠ¡å™¨åŠ ä¸Šæ—¶é—´æˆ³ç­‰ä¿¡æ¯åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚\nä½¿ç”¨åˆ°çš„çŸ¥è¯†ç‚¹æœ‰ï¼š\n\næ¡ä»¶å˜é‡\n\nepollçš„è¾¹ç¼˜è§¦å‘æ¨¡å¼\n\n\nç¨‹åºçš„å¤§è‡´æ¡†æ¶æ˜¯ï¼š\n\nä¸»çº¿ç¨‹åªè´Ÿè´£ç›‘å¬ä¾¦å¬socketä¸Šæ˜¯å¦æœ‰æ–°è¿æ¥ï¼Œå¦‚æœæœ‰æ–°è¿æ¥åˆ°æ¥ï¼Œäº¤ç»™ä¸€ä¸ªå«acceptçš„å·¥ä½œçº¿ç¨‹å»æ¥æ”¶æ–°è¿æ¥ï¼Œå¹¶å°†æ–°è¿æ¥socketç»‘å®šåˆ°ä¸»çº¿ç¨‹ä½¿ç”¨epollfdä¸Šå»ã€‚\nä¸»çº¿ç¨‹å¦‚æœä¾¦å¬åˆ°å®¢æˆ·ç«¯çš„socketä¸Šæœ‰å¯è¯»äº‹ä»¶ï¼Œåˆ™é€šçŸ¥å¦å¤–äº”ä¸ªå·¥ä½œçº¿ç¨‹å»æ¥æ”¶å¤„ç†å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®åŠ ä¸Šæ—¶é—´æˆ³åå‘å›ç»™å®¢æˆ·ç«¯ã€‚\nå¯ä»¥é€šè¿‡ä¼ é€’-p portæ¥è®¾ç½®ç¨‹åºçš„ç›‘å¬ç«¯å£å·ï¼›å¯ä»¥é€šè¿‡ä¼ é€’-dæ¥ä½¿ç¨‹åºä»¥daemonæ¨¡å¼è¿è¡Œåœ¨åå°ã€‚è¿™ä¹Ÿæ˜¯æ ‡å‡†linux daemonæ¨¡å¼çš„ä¹¦å†™æ–¹æ³•ã€‚\n\nç¨‹åºéš¾ç‚¹å’Œéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼š\n\næ¡ä»¶å˜é‡ä¸ºäº†é˜²æ­¢è™šå‡å”¤é†’ï¼Œä¸€å®šè¦åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢è°ƒç”¨pthread_cond_wait()å‡½æ•°ï¼Œæˆ‘åœ¨worker_thread_func()ä¸­ä½¿ç”¨äº†ï¼š\n\n12while (g_listClients.empty())  \t::pthread_cond_wait(&amp;g_cond, &amp;g_clientmutex); \n\nåœ¨accept_thread_func()å‡½æ•°é‡Œé¢æˆ‘æ²¡æœ‰ä½¿ç”¨å¾ªç¯ï¼Œè¿™æ ·ä¼šæœ‰é—®é¢˜å—ï¼Ÿ\n\nä½¿ç”¨æ¡ä»¶å˜é‡pthread_cond_wait()å‡½æ•°çš„æ—¶å€™ä¸€å®šè¦å…ˆè·å¾—ä¸è¯¥æ¡ä»¶å˜é‡ç›¸å…³çš„mutexï¼Œå³åƒä¸‹é¢è¿™æ ·çš„ç»“æ„ï¼š\n\n123456789mutex_lock(...); while (condition is true)    ::pthread_cond_wait(...); //è¿™é‡Œå¯ä»¥æœ‰å…¶ä»–ä»£ç ...mutex_unlock(...); //è¿™é‡Œå¯ä»¥æœ‰å…¶ä»–ä»£ç ...\n\nå› ä¸ºpthread_cond_wait()å¦‚æœé˜»å¡çš„è¯ï¼Œå®ƒè§£é”ç›¸å…³mutexå’Œé˜»å¡å½“å‰çº¿ç¨‹è¿™ä¸¤ä¸ªåŠ¨ä½œåŠ åœ¨ä¸€èµ·æ˜¯åŸå­çš„ã€‚\n\nä½œä¸ºæœåŠ¡å™¨ç«¯ç¨‹åºæœ€å¥½å¯¹ä¾¦å¬socketè°ƒç”¨setsocketopt()è®¾ç½®SO_REUSEADDRå’ŒSO_REUSEPORTä¸¤ä¸ªæ ‡å¿—ï¼Œå› ä¸ºæœåŠ¡ç¨‹åºæœ‰æ—¶å€™ä¼šéœ€è¦é‡å¯ï¼ˆæ¯”å¦‚è°ƒè¯•çš„æ—¶å€™å°±ä¼šä¸æ–­é‡å¯ï¼‰ï¼Œå¦‚æœä¸è®¾ç½®è¿™ä¸¤ä¸ªæ ‡å¿—çš„è¯ï¼Œç»‘å®šç«¯å£æ—¶å°±ä¼šè°ƒç”¨å¤±è´¥ã€‚å› ä¸ºä¸€ä¸ªç«¯å£ä½¿ç”¨åï¼Œå³ä½¿ä¸å†ä½¿ç”¨ï¼Œå› ä¸ºå››æ¬¡æŒ¥æ‰‹è¯¥ç«¯å£å¤„äºTIME_WAITçŠ¶æ€ï¼Œæœ‰å¤§çº¦2minçš„MSLï¼ˆMaximum Segment Lifetimeï¼Œæœ€å¤§å­˜æ´»æœŸï¼‰ã€‚è¿™2minå†…ï¼Œè¯¥ç«¯å£æ˜¯ä¸èƒ½è¢«é‡å¤ä½¿ç”¨çš„ã€‚ä½ çš„æœåŠ¡å™¨ç¨‹åºä¸Šæ¬¡ä½¿ç”¨äº†è¿™ä¸ªç«¯å£å·ï¼Œæ¥ç€é‡å¯ï¼Œå› ä¸ºè¿™ä¸ªç¼˜æ•…ï¼Œä½ å†æ¬¡ç»‘å®šè¿™ä¸ªç«¯å£å°±ä¼šå¤±è´¥ï¼ˆbindå‡½æ•°è°ƒç”¨å¤±è´¥ï¼‰ã€‚è¦ä¸ä½ å°±æ¯æ¬¡é‡å¯æ—¶éœ€è¦ç­‰å¾…2minåå†è¯•ï¼ˆè¿™åœ¨é¢‘ç¹é‡å¯ç¨‹åºè°ƒè¯•æ˜¯éš¾ä»¥æ¥æ”¶çš„ï¼‰ï¼Œæˆ–è€…è®¾ç½®è¿™ç§SO_REUSEADDRå’ŒSO_REUSEPORTç«‹å³å›æ”¶ç«¯å£ä½¿ç”¨ã€‚\n\nå…¶å®ï¼ŒSO_REUSEADDRåœ¨Windowsä¸Šå’ŒUnixå¹³å°ä¸Šè¿˜æœ‰äº›ç»†å¾®çš„åŒºåˆ«ï¼Œæˆ‘åœ¨libeventæºç ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š\n12345678910111213int evutil_make_listen_socket_reuseable(evutil_socket_t sock)&#123;#ifndef WIN32\tint one = 1;\t/* REUSEADDR on Unix means, &quot;don&#x27;t hang on to this address after the\t * listener is closed.&quot;  On Windows, though, it means &quot;don&#x27;t keep other\t * processes from binding to this address while we&#x27;re using it. */\treturn setsockopt(sock, SOL_SOCKET, SO_REUSEADDR, (void*) &amp;one,\t    (ev_socklen_t)sizeof(one));#else\treturn 0;#endif&#125; \n\næ³¨æ„æ³¨é‡Šéƒ¨åˆ†ï¼Œåœ¨Unixå¹³å°ä¸Šè®¾ç½®è¿™ä¸ªé€‰é¡¹æ„å‘³ç€ï¼Œä»»æ„è¿›ç¨‹å¯ä»¥å¤ç”¨è¯¥åœ°å€ï¼›è€Œåœ¨windowsï¼Œä¸è¦é˜»æ­¢å…¶ä»–è¿›ç¨‹å¤ç”¨è¯¥åœ°å€ã€‚ä¹Ÿå°±æ˜¯åœ¨åœ¨Unixå¹³å°ä¸Šï¼Œå¦‚æœä¸è®¾ç½®è¿™ä¸ªé€‰é¡¹ï¼Œä»»æ„è¿›ç¨‹åœ¨ä¸€å®šæ—¶é—´å†…ï¼Œä¸èƒ½bindè¯¥åœ°å€ï¼›åœ¨windowså¹³å°ä¸Šï¼Œåœ¨ä¸€å®šæ—¶é—´å†…ï¼Œå…¶ä»–è¿›ç¨‹ä¸èƒ½bindè¯¥åœ°å€ï¼Œè€Œæœ¬è¿›ç¨‹å´å¯ä»¥å†æ¬¡bindè¯¥åœ°å€ã€‚\n\nepoll_waitå¯¹æ–°è¿æ¥socketä½¿ç”¨çš„æ˜¯è¾¹ç¼˜è§¦å‘æ¨¡å¼EPOLLETï¼ˆedge triggerï¼‰ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„æ°´å¹³è§¦å‘æ¨¡å¼ï¼ˆlevel trigger)ã€‚å› ä¸ºå¦‚æœé‡‡å–æ°´å¹³è§¦å‘æ¨¡å¼çš„è¯ï¼Œä¸»çº¿ç¨‹æ£€æµ‹åˆ°æŸä¸ªå®¢æˆ·ç«¯socketæ•°æ®å¯è¯»æ—¶ï¼Œé€šçŸ¥å·¥ä½œçº¿ç¨‹å»æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ä¸»çº¿ç¨‹ç»§ç»­å¾ªç¯ï¼Œåªè¦åœ¨å·¥ä½œçº¿ç¨‹æ²¡æœ‰å°†è¯¥socketä¸Šæ•°æ®å…¨éƒ¨æ”¶å®Œï¼Œæˆ–è€…åœ¨å·¥ä½œçº¿ç¨‹æ”¶å–æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æœ‰æ–°æ•°æ®åˆ°æ¥ï¼Œä¸»çº¿ç¨‹ä¼šç»§ç»­å‘é€šçŸ¥ï¼ˆé€šè¿‡pthread_cond_signal()ï¼‰å‡½æ•°ï¼Œå†æ¬¡é€šçŸ¥å·¥ä½œçº¿ç¨‹æ”¶å–æ•°æ®ã€‚è¿™æ ·ä¼šå¯èƒ½å¯¼è‡´å¤šä¸ªå·¥ä½œçº¿ç¨‹åŒæ—¶è°ƒç”¨recvå‡½æ•°æ”¶å–è¯¥å®¢æˆ·ç«¯socketä¸Šçš„æ•°æ®ï¼Œè¿™æ ·äº§ç”Ÿçš„ç»“æœå°†ä¼šå¯¼è‡´æ•°æ®é”™ä¹±ã€‚\n\nç›¸åï¼Œé‡‡å–è¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼Œåªæœ‰ç­‰æŸä¸ªå·¥ä½œçº¿ç¨‹å°†é‚£ä¸ªå®¢æˆ·ç«¯socketä¸Šæ•°æ®å…¨éƒ¨æ”¶å–å®Œæ¯•ï¼Œä¸»çº¿ç¨‹çš„epoll_waitæ‰å¯èƒ½ä¼šå†æ¬¡è§¦å‘æ¥é€šçŸ¥å·¥ä½œçº¿ç¨‹ç»§ç»­æ”¶å–é‚£ä¸ªå®¢æˆ·ç«¯socketæ–°æ¥çš„æ•°æ®ã€‚\n\nä»£ç ä¸­æœ‰è¿™æ ·ä¸€è¡Œï¼š\n 12//gdbè°ƒè¯•æ—¶ä¸èƒ½å®æ—¶åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œç”¨è¿™ä¸ªå‡½æ•°åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œä½¿ä¿¡æ¯åœ¨å±å¹•ä¸Šå®æ—¶æ˜¾ç¤ºå‡ºæ¥ std::cout &lt;&lt; std::endl;\n\nå¦‚æœä¸åŠ ä¸Šè¿™ä¸€è¡Œï¼Œæ­£å¸¸è¿è¡ŒæœåŠ¡å™¨ç¨‹åºï¼Œç¨‹åºä¸­è¦æ‰“å°åˆ°æ§åˆ¶å°çš„ä¿¡æ¯éƒ½ä¼šæ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœç”¨gdbè°ƒè¯•çŠ¶æ€ä¸‹ï¼Œç¨‹åºçš„æ‰€æœ‰è¾“å‡ºå°±ä¸æ˜¾ç¤ºäº†ã€‚æˆ‘ä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯gdbçš„ä¸€ä¸ªbugï¼Œæ‰€ä»¥è¿™é‡ŒåŠ ä¸Šstd::endlæ¥è¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦å¹¶flushæ ‡å‡†è¾“å‡ºï¼Œè®©è¾“å‡ºæ˜¾ç¤ºå‡ºæ¥ã€‚ï¼ˆstd::endlä¸ä»…æ˜¯è¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦è€Œä¸”æ˜¯åŒæ—¶åˆ·æ–°è¾“å‡ºï¼Œç›¸å½“äºfflush()å‡½æ•°ï¼‰ã€‚\nç¨‹åºæˆ‘éƒ¨ç½²èµ·æ¥äº†ï¼Œä½ å¯ä»¥ä½¿ç”¨linuxçš„ncå‘½ä»¤æˆ–è‡ªå·±å†™ç¨‹åºè¿æ¥æœåŠ¡å™¨æ¥æŸ¥çœ‹ç¨‹åºæ•ˆæœï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨telnetå‘½ä»¤ï¼Œæ–¹æ³•ï¼š\nLinux:\n1nc 120.55.94.78 12345\n\næˆ–\n1telnet 120.55.94.78 12345\n\nç„¶åå°±å¯ä»¥ç»™æœåŠ¡å™¨è‡ªç”±å‘é€æ•°æ®äº†ï¼ŒæœåŠ¡å™¨ä¼šç»™ä½ å‘é€çš„ä¿¡æ¯åŠ ä¸Šæ—¶é—´æˆ³è¿”å›ç»™ä½ ã€‚æ•ˆæœå¦‚å›¾ï¼š\n\nå¦å¤–æˆ‘å°†è¿™ä¸ªä»£ç æ”¹å†™äº†æˆçº¯C++11ç‰ˆæœ¬ï¼Œä½¿ç”¨CMakeç¼–è¯‘ï¼Œä¸ºäº†æ”¯æŒç¼–è¯‘å¿…é¡»åŠ ä¸Šè¿™-std&#x3D;c++11ï¼š\nCMakeLists.txtä»£ç å¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324cmake_minimum_required(VERSION 2.8) PROJECT(myreactorserver) AUX_SOURCE_DIRECTORY(./ SRC_LIST)SET(EXECUTABLE_OUTPUT_PATH ./) ADD_DEFINITIONS(-g -W -Wall -Wno-deprecated -DLINUX -D_REENTRANT -D_FILE_OFFSET_BITS=64 -DAC_HAS_INFO -DAC_HAS_WARNING -DAC_HAS_ERROR -DAC_HAS_CRITICAL -DTIXML_USE_STL -DHAVE_CXX_STDHEADERS $&#123;CMAKE_CXX_FLAGS&#125; -std=c++11) INCLUDE_DIRECTORIES(./)LINK_DIRECTORIES(./) set(main.cppmyreator.cpp) ADD_EXECUTABLE(myreactorserver $&#123;SRC_LIST&#125;) TARGET_LINK_LIBRARIES(myreactorserver pthread)\n\nmyreactor.hæ–‡ä»¶å†…å®¹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/** *@desc: myreactorå¤´æ–‡ä»¶, myreactor.h *@author: zhangyl *@date: 2016.12.03 */#ifndef __MYREACTOR_H__#define __MYREACTOR_H__ #include &lt;list&gt;#include &lt;memory&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;condition_variable&gt; #define WORKER_THREAD_NUM   5 class CMyReactor&#123;public:\tCMyReactor();\t~CMyReactor(); \tbool init(const char* ip, short nport);\tbool uninit(); \tbool close_client(int clientfd); \tstatic void* main_loop(void* p); private:\t//no copyable\tCMyReactor(const CMyReactor&amp; rhs);\tCMyReactor&amp; operator = (const CMyReactor&amp; rhs); \tbool create_server_listener(const char* ip, short port);\t\tstatic void accept_thread_proc(CMyReactor* pReatcor);\tstatic void worker_thread_proc(CMyReactor* pReatcor); private:\t//C11è¯­æ³•å¯ä»¥åœ¨è¿™é‡Œåˆå§‹åŒ–\tint\t\t\t\t\t\t\t m_listenfd = 0;\tint\t\t\t\t\t\t\t m_epollfd  = 0;\tbool\t\t\t\t\t\t m_bStop    = false;\t\tstd::shared_ptr&lt;std::thread&gt; m_acceptthread;\tstd::shared_ptr&lt;std::thread&gt; m_workerthreads[WORKER_THREAD_NUM];\t\tstd::condition_variable\t\t m_acceptcond;\tstd::mutex\t\t\t\t\t m_acceptmutex; \tstd::condition_variable\t\t m_workercond ;\tstd::mutex\t\t\t\t\t m_workermutex; \tstd::list&lt;int&gt;\t\t\t\t m_listClients;&#125;; #endif //!__MYREACTOR_H__\n\nmyreactor.cppæ–‡ä»¶å†…å®¹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326/**  *@desc: myreactorå®ç°æ–‡ä»¶, myreactor.cpp *@author: zhangyl *@date: 2016.12.03 */#include &quot;myreactor.h&quot;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;sys/types.h&gt;#include &lt;sys/socket.h&gt;#include &lt;netinet/in.h&gt;#include &lt;arpa/inet.h&gt;  //for htonl() and htons()#include &lt;fcntl.h&gt;#include &lt;sys/epoll.h&gt;#include &lt;list&gt;#include &lt;errno.h&gt;#include &lt;time.h&gt;#include &lt;sstream&gt;#include &lt;iomanip&gt; //for std::setw()/setfill()#include &lt;unistd.h&gt; #define min(a, b) ((a &lt;= b) ? (a) : (b)) CMyReactor::CMyReactor()&#123;\t//m_listenfd = 0;\t//m_epollfd = 0;\t//m_bStop = false;&#125; CMyReactor::~CMyReactor()&#123; &#125; bool CMyReactor::init(const char* ip, short nport)&#123;\tif (!create_server_listener(ip, nport))\t&#123;\t\tstd::cout &lt;&lt; &quot;Unable to bind: &quot; &lt;&lt; ip &lt;&lt; &quot;:&quot; &lt;&lt; nport &lt;&lt; &quot;.&quot; &lt;&lt; std::endl;\t\treturn false;\t&#125;  \tstd::cout &lt;&lt; &quot;main thread id = &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; \t//å¯åŠ¨æ¥æ”¶æ–°è¿æ¥çš„çº¿ç¨‹\tm_acceptthread.reset(new std::thread(CMyReactor::accept_thread_proc, this));\t\t//å¯åŠ¨å·¥ä½œçº¿ç¨‹\tfor (auto&amp; t : m_workerthreads)\t&#123;\t\tt.reset(new std::thread(CMyReactor::worker_thread_proc, this));\t&#125;  \treturn true;&#125; bool CMyReactor::uninit()&#123;\tm_bStop = true;\tm_acceptcond.notify_one();\tm_workercond.notify_all(); \tm_acceptthread-&gt;join();\tfor (auto&amp; t : m_workerthreads)\t&#123;\t\tt-&gt;join();\t&#125; \t::epoll_ctl(m_epollfd, EPOLL_CTL_DEL, m_listenfd, NULL); \t//TODO: æ˜¯å¦éœ€è¦å…ˆè°ƒç”¨shutdown()ä¸€ä¸‹ï¼Ÿ\t::shutdown(m_listenfd, SHUT_RDWR);\t::close(m_listenfd);\t::close(m_epollfd); \treturn true;&#125; bool CMyReactor::close_client(int clientfd)&#123;\tif (::epoll_ctl(m_epollfd, EPOLL_CTL_DEL, clientfd, NULL) == -1)\t&#123;\t\tstd::cout &lt;&lt; &quot;close client socket failed as call epoll_ctl failed&quot; &lt;&lt; std::endl;\t\t//return false;\t&#125;\t\t \t::close(clientfd); \treturn true;&#125;  void* CMyReactor::main_loop(void* p)&#123;\tstd::cout &lt;&lt; &quot;main thread id = &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl;\t\tCMyReactor* pReatcor = static_cast&lt;CMyReactor*&gt;(p);\t\twhile (!pReatcor-&gt;m_bStop)\t&#123;\t\tstruct epoll_event ev[1024];\t\tint n = ::epoll_wait(pReatcor-&gt;m_epollfd, ev, 1024, 10);\t\tif (n == 0)\t\t\tcontinue;\t\telse if (n &lt; 0)\t\t&#123;\t\t\tstd::cout &lt;&lt; &quot;epoll_wait error&quot; &lt;&lt; std::endl;\t\t\tcontinue;\t\t&#125; \t\tint m = min(n, 1024);\t\tfor (int i = 0; i &lt; m; ++i)\t\t&#123;\t\t\t//é€šçŸ¥æ¥æ”¶è¿æ¥çº¿ç¨‹æ¥æ”¶æ–°è¿æ¥\t\t\tif (ev[i].data.fd == pReatcor-&gt;m_listenfd)\t\t\t\tpReatcor-&gt;m_acceptcond.notify_one();\t\t\t//é€šçŸ¥æ™®é€šå·¥ä½œçº¿ç¨‹æ¥æ”¶æ•°æ®\t\t\telse\t\t\t&#123;\t\t\t\t&#123;\t\t\t\t\tstd::unique_lock&lt;std::mutex&gt; guard(pReatcor-&gt;m_workermutex);\t\t\t\t\tpReatcor-&gt;m_listClients.push_back(ev[i].data.fd);\t\t\t\t&#125;\t\t\t\t\t\t\t\t\t\t\t\tpReatcor-&gt;m_workercond.notify_one();\t\t\t\t//std::cout &lt;&lt; &quot;signal&quot; &lt;&lt; std::endl;\t\t\t&#125;// end if \t\t&#125;// end for-loop\t&#125;// end while \tstd::cout &lt;&lt; &quot;main loop exit ...&quot; &lt;&lt; std::endl; \treturn NULL;&#125; void CMyReactor::accept_thread_proc(CMyReactor* pReatcor)&#123;\tstd::cout &lt;&lt; &quot;accept thread, thread id = &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; \twhile (true)\t&#123;\t\tint newfd;\t\tstruct sockaddr_in clientaddr;\t\tsocklen_t addrlen;\t\t&#123;\t\t\tstd::unique_lock&lt;std::mutex&gt; guard(pReatcor-&gt;m_acceptmutex);\t\t\tpReatcor-&gt;m_acceptcond.wait(guard);\t\t\tif (pReatcor-&gt;m_bStop)\t\t\t\tbreak; \t\t\t//std::cout &lt;&lt; &quot;run loop in accept_thread_proc&quot; &lt;&lt; std::endl;\t\t\t\t\t\tnewfd = ::accept(pReatcor-&gt;m_listenfd, (struct sockaddr *)&amp;clientaddr, &amp;addrlen);\t\t&#125;\t\tif (newfd == -1)\t\t\tcontinue; \t\tstd::cout &lt;&lt; &quot;new client connected: &quot; &lt;&lt; ::inet_ntoa(clientaddr.sin_addr) &lt;&lt; &quot;:&quot; &lt;&lt; ::ntohs(clientaddr.sin_port) &lt;&lt; std::endl; \t\t//å°†æ–°socketè®¾ç½®ä¸ºnon-blocking\t\tint oldflag = ::fcntl(newfd, F_GETFL, 0);\t\tint newflag = oldflag | O_NONBLOCK;\t\tif (::fcntl(newfd, F_SETFL, newflag) == -1)\t\t&#123;\t\t\tstd::cout &lt;&lt; &quot;fcntl error, oldflag =&quot; &lt;&lt; oldflag &lt;&lt; &quot;, newflag = &quot; &lt;&lt; newflag &lt;&lt; std::endl;\t\t\tcontinue;\t\t&#125; \t\tstruct epoll_event e;\t\tmemset(&amp;e, 0, sizeof(e));\t\te.events = EPOLLIN | EPOLLRDHUP | EPOLLET;\t\te.data.fd = newfd;\t\tif (::epoll_ctl(pReatcor-&gt;m_epollfd, EPOLL_CTL_ADD, newfd, &amp;e) == -1)\t\t&#123;\t\t\tstd::cout &lt;&lt; &quot;epoll_ctl error, fd =&quot; &lt;&lt; newfd &lt;&lt; std::endl;\t\t&#125;\t&#125; \tstd::cout &lt;&lt; &quot;accept thread exit ...&quot; &lt;&lt; std::endl;&#125; void CMyReactor::worker_thread_proc(CMyReactor* pReatcor)&#123;\tstd::cout &lt;&lt; &quot;new worker thread, thread id = &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl; \twhile (true)\t&#123;\t\tint clientfd;\t\t&#123;\t\t\tstd::unique_lock&lt;std::mutex&gt; guard(pReatcor-&gt;m_workermutex);\t\t\twhile (pReatcor-&gt;m_listClients.empty())\t\t\t&#123;\t\t\t\tif (pReatcor-&gt;m_bStop)\t\t\t\t&#123;\t\t\t\t\tstd::cout &lt;&lt; &quot;worker thread exit ...&quot; &lt;&lt; std::endl;\t\t\t\t\treturn;\t\t\t\t&#125;\t\t\t\t\t\t\t\t\tpReatcor-&gt;m_workercond.wait(guard);\t\t\t&#125;\t\t\t\t\t\t\tclientfd = pReatcor-&gt;m_listClients.front();\t\t\tpReatcor-&gt;m_listClients.pop_front();\t\t&#125; \t\t//gdbè°ƒè¯•æ—¶ä¸èƒ½å®æ—¶åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œç”¨è¿™ä¸ªå‡½æ•°åˆ·æ–°æ ‡å‡†è¾“å‡ºï¼Œä½¿ä¿¡æ¯åœ¨å±å¹•ä¸Šå®æ—¶æ˜¾ç¤ºå‡ºæ¥\t\tstd::cout &lt;&lt; std::endl; \t\tstd::string strclientmsg;\t\tchar buff[256];\t\tbool bError = false;\t\twhile (true)\t\t&#123;\t\t\tmemset(buff, 0, sizeof(buff));\t\t\tint nRecv = ::recv(clientfd, buff, 256, 0);\t\t\tif (nRecv == -1)\t\t\t&#123;\t\t\t\tif (errno == EWOULDBLOCK)\t\t\t\t\tbreak;\t\t\t\telse\t\t\t\t&#123;\t\t\t\t\tstd::cout &lt;&lt; &quot;recv error, client disconnected, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;\t\t\t\t\tpReatcor-&gt;close_client(clientfd);\t\t\t\t\tbError = true;\t\t\t\t\tbreak;\t\t\t\t&#125; \t\t\t&#125;\t\t\t//å¯¹ç«¯å…³é—­äº†socketï¼Œè¿™ç«¯ä¹Ÿå…³é—­ã€‚\t\t\telse if (nRecv == 0)\t\t\t&#123;\t\t\t\tstd::cout &lt;&lt; &quot;peer closed, client disconnected, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;\t\t\t\tpReatcor-&gt;close_client(clientfd);\t\t\t\tbError = true;\t\t\t\tbreak;\t\t\t&#125; \t\t\tstrclientmsg += buff;\t\t&#125; \t\t//å‡ºé”™äº†ï¼Œå°±ä¸è¦å†ç»§ç»­å¾€ä¸‹æ‰§è¡Œäº†\t\tif (bError)\t\t\tcontinue; \t\tstd::cout &lt;&lt; &quot;client msg: &quot; &lt;&lt; strclientmsg; \t\t//å°†æ¶ˆæ¯åŠ ä¸Šæ—¶é—´æ ‡ç­¾åå‘å›\t\ttime_t now = time(NULL);\t\tstruct tm* nowstr = localtime(&amp;now);\t\tstd::ostringstream ostimestr;\t\tostimestr &lt;&lt; &quot;[&quot; &lt;&lt; nowstr-&gt;tm_year + 1900 &lt;&lt; &quot;-&quot;\t\t\t&lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_mon + 1 &lt;&lt; &quot;-&quot;\t\t\t&lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_mday &lt;&lt; &quot; &quot;\t\t\t&lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_hour &lt;&lt; &quot;:&quot;\t\t\t&lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_min &lt;&lt; &quot;:&quot;\t\t\t&lt;&lt; std::setw(2) &lt;&lt; std::setfill(&#x27;0&#x27;) &lt;&lt; nowstr-&gt;tm_sec &lt;&lt; &quot;]server reply: &quot;; \t\tstrclientmsg.insert(0, ostimestr.str()); \t\twhile (true)\t\t&#123;\t\t\tint nSent = ::send(clientfd, strclientmsg.c_str(), strclientmsg.length(), 0);\t\t\tif (nSent == -1)\t\t\t&#123;\t\t\t\tif (errno == EWOULDBLOCK)\t\t\t\t&#123;\t\t\t\t\tstd::this_thread::sleep_for(std::chrono::milliseconds(10));\t\t\t\t\tcontinue;\t\t\t\t&#125;\t\t\t\telse\t\t\t\t&#123;\t\t\t\t\tstd::cout &lt;&lt; &quot;send error, fd = &quot; &lt;&lt; clientfd &lt;&lt; std::endl;\t\t\t\t\tpReatcor-&gt;close_client(clientfd);\t\t\t\t\tbreak;\t\t\t\t&#125; \t\t\t&#125; \t\t\tstd::cout &lt;&lt; &quot;send: &quot; &lt;&lt; strclientmsg;\t\t\tstrclientmsg.erase(0, nSent); \t\t\tif (strclientmsg.empty())\t\t\t\tbreak;\t\t&#125;\t&#125;&#125; bool CMyReactor::create_server_listener(const char* ip, short port)&#123;\tm_listenfd = ::socket(AF_INET, SOCK_STREAM | SOCK_NONBLOCK, 0);\tif (m_listenfd == -1)\t\treturn false; \tint on = 1;\t::setsockopt(m_listenfd, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;on, sizeof(on));\t::setsockopt(m_listenfd, SOL_SOCKET, SO_REUSEPORT, (char *)&amp;on, sizeof(on)); \tstruct sockaddr_in servaddr;\tmemset(&amp;servaddr, 0, sizeof(servaddr));\tservaddr.sin_family = AF_INET;\tservaddr.sin_addr.s_addr = inet_addr(ip);\tservaddr.sin_port = htons(port);\tif (::bind(m_listenfd, (sockaddr *)&amp;servaddr, sizeof(servaddr)) == -1)\t\treturn false; \tif (::listen(m_listenfd, 50) == -1)\t\treturn false; \tm_epollfd = ::epoll_create(1);\tif (m_epollfd == -1)\t\treturn false; \tstruct epoll_event e;\tmemset(&amp;e, 0, sizeof(e));\te.events = EPOLLIN | EPOLLRDHUP;\te.data.fd = m_listenfd;\tif (::epoll_ctl(m_epollfd, EPOLL_CTL_ADD, m_listenfd, &amp;e) == -1)\t\treturn false; \treturn true;&#125;\n\nmain.cppæ–‡ä»¶å†…å®¹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899/**  *@desc:   ç”¨reactoræ¨¡å¼ç»ƒä¹ æœåŠ¡å™¨ç¨‹åº *@author: zhangyl *@date:   2016.12.03 */ #include &lt;iostream&gt;#include &lt;signal.h&gt;     //for signal()#include&lt;unistd.h&gt;#include &lt;stdlib.h&gt;\t\t//for exit()#include &lt;sys/types.h&gt;#include &lt;sys/stat.h&gt;#include &lt;fcntl.h&gt;#include &quot;myreactor.h&quot; CMyReactor g_reator; void prog_exit(int signo)&#123;    std::cout &lt;&lt; &quot;program recv signal &quot; &lt;&lt; signo &lt;&lt; &quot; to exit.&quot; &lt;&lt; std::endl;  \tg_reator.uninit();&#125; void daemon_run()&#123;    int pid;    signal(SIGCHLD, SIG_IGN);    //1ï¼‰åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œforkè¿”å›æ–°åˆ›å»ºå­è¿›ç¨‹çš„è¿›ç¨‹IDï¼›    //2ï¼‰åœ¨å­è¿›ç¨‹ä¸­ï¼Œforkè¿”å›0ï¼›    //3ï¼‰å¦‚æœå‡ºç°é”™è¯¯ï¼Œforkè¿”å›ä¸€ä¸ªè´Ÿå€¼ï¼›    pid = fork();    if (pid &lt; 0)    &#123;        std:: cout &lt;&lt; &quot;fork error&quot; &lt;&lt; std::endl;        exit(-1);    &#125;    //çˆ¶è¿›ç¨‹é€€å‡ºï¼Œå­è¿›ç¨‹ç‹¬ç«‹è¿è¡Œ    else if (pid &gt; 0) &#123;        exit(0);    &#125;    //ä¹‹å‰parentå’Œchildè¿è¡Œåœ¨åŒä¸€ä¸ªsessioné‡Œ,parentæ˜¯ä¼šè¯ï¼ˆsessionï¼‰çš„é¢†å¤´è¿›ç¨‹,    //parentè¿›ç¨‹ä½œä¸ºä¼šè¯çš„é¢†å¤´è¿›ç¨‹ï¼Œå¦‚æœexitç»“æŸæ‰§è¡Œçš„è¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹ä¼šæˆä¸ºå­¤å„¿è¿›ç¨‹ï¼Œå¹¶è¢«initæ”¶å…»ã€‚    //æ‰§è¡Œsetsid()ä¹‹å,childå°†é‡æ–°è·å¾—ä¸€ä¸ªæ–°çš„ä¼šè¯(session)idã€‚    //è¿™æ—¶parenté€€å‡ºä¹‹å,å°†ä¸ä¼šå½±å“åˆ°childäº†ã€‚    setsid();    int fd;    fd = open(&quot;/dev/null&quot;, O_RDWR, 0);    if (fd != -1)    &#123;        dup2(fd, STDIN_FILENO);        dup2(fd, STDOUT_FILENO);        dup2(fd, STDERR_FILENO);    &#125;    if (fd &gt; 2)        close(fd);&#125;  int main(int argc, char* argv[])&#123;  \t//è®¾ç½®ä¿¡å·å¤„ç†\tsignal(SIGCHLD, SIG_DFL);\tsignal(SIGPIPE, SIG_IGN);\tsignal(SIGINT, prog_exit);\tsignal(SIGKILL, prog_exit);\tsignal(SIGTERM, prog_exit);\t\tshort port = 0;\tint ch;\tbool bdaemon = false;\twhile ((ch = getopt(argc, argv, &quot;p:d&quot;)) != -1)\t&#123;\t\tswitch (ch)\t\t&#123;\t\tcase &#x27;d&#x27;:\t\t\tbdaemon = true;\t\t\tbreak;\t\tcase &#x27;p&#x27;:\t\t\tport = atol(optarg);\t\t\tbreak;\t\t&#125;\t&#125; \tif (bdaemon)\t\tdaemon_run();  \tif (port == 0)\t\tport = 12345; \t\tif (!g_reator.init(&quot;0.0.0.0&quot;, 12345))\t\treturn -1;    \tg_reator.main_loop(&amp;g_reator);     return 0;&#125;\n\nå®Œæ•´å®ä¾‹ä»£ç ä¸‹è½½åœ°å€ï¼š\næ™®é€šç‰ˆæœ¬ï¼šhttps://pan.baidu.com/s/1o82Mkno\nC++11ç‰ˆæœ¬ï¼šhttps://pan.baidu.com/s/1dEJdrih\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/Reactoræ¨¡å¼","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"429b34147de6862baa596a57a6482f88","title":"ã€è½¬è½½ã€‘ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥","content":"ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥æœåŠ¡å™¨ç«¯ä¸ºäº†èƒ½æµç•…å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯é“¾æ¥ï¼Œä¸€èˆ¬åœ¨æŸä¸ªçº¿ç¨‹Aé‡Œé¢acceptæ–°çš„å®¢æˆ·ç«¯è¿æ¥å¹¶ç”Ÿæˆæ–°è¿æ¥çš„socket fdï¼Œç„¶åå°†è¿™äº›æ–°è¿æ¥çš„socketfdç»™å¦å¤–å¼€çš„æ•°ä¸ªå·¥ä½œçº¿ç¨‹B1ã€B2ã€B3ã€B4ï¼Œè¿™äº›å·¥ä½œçº¿ç¨‹å¤„ç†è¿™äº›æ–°è¿æ¥ä¸Šçš„ç½‘ç»œIOäº‹ä»¶ï¼ˆå³æ”¶å‘æ•°æ®ï¼‰ï¼ŒåŒæ—¶ï¼Œè¿˜å¤„ç†ç³»ç»Ÿä¸­çš„å¦å¤–ä¸€äº›äº‹åŠ¡ã€‚è¿™é‡Œæˆ‘ä»¬å°†çº¿ç¨‹Aç§°ä¸ºä¸»çº¿ç¨‹ï¼ŒB1ã€B2ã€B3ã€B4ç­‰ç§°ä¸ºå·¥ä½œçº¿ç¨‹ã€‚å·¥ä½œçº¿ç¨‹çš„ä»£ç æ¡†æ¶ä¸€èˆ¬å¦‚ä¸‹ï¼š\n12345678while (!m_bQuit) &#123;      epoll_or_select_func();        handle_io_events();        handle_other_things();&#125;  \n\nåœ¨epoll_or_select_func()ä¸­é€šè¿‡select()æˆ–è€…poll&#x2F;epoll()å»æ£€æµ‹socket fdä¸Šçš„ioäº‹ä»¶ï¼Œè‹¥å­˜åœ¨è¿™äº›äº‹ä»¶åˆ™ä¸‹ä¸€æ­¥handle_io_events()æ¥å¤„ç†è¿™äº›äº‹ä»¶ï¼ˆæ”¶å‘æ•°æ®ï¼‰ï¼Œåšå®Œä¹‹åå¯èƒ½è¿˜è¦åšä¸€äº›ç³»ç»Ÿå…¶ä»–çš„ä»»åŠ¡ï¼Œå³è°ƒç”¨handle_other_things()ã€‚\nè¿™æ ·åšæœ‰ä¸‰ä¸ªå¥½å¤„ï¼š\n\nçº¿ç¨‹Aåªéœ€è¦å¤„ç†æ–°è¿æ¥çš„åˆ°æ¥å³å¯ï¼Œä¸ç”¨å¤„ç†ç½‘ç»œIOäº‹ä»¶ã€‚ç”±äºç½‘ç»œIOäº‹ä»¶å¤„ç†ä¸€èˆ¬ç›¸å¯¹æ¯”è¾ƒæ…¢ï¼Œå¦‚æœåœ¨çº¿ç¨‹Aé‡Œé¢æ—¢å¤„ç†æ–°è¿æ¥åˆå¤„ç†ç½‘ç»œIOï¼Œåˆ™å¯èƒ½ç”±äºçº¿ç¨‹å¿™äºå¤„ç†IOäº‹ä»¶ï¼Œè€Œæ— æ³•åŠæ—¶å¤„ç†å®¢æˆ·ç«¯çš„æ–°è¿æ¥ï¼Œè¿™æ˜¯å¾ˆä¸å¥½çš„ã€‚\n\nçº¿ç¨‹Aæ¥æ”¶çš„æ–°è¿æ¥ï¼Œå¯ä»¥æ ¹æ®ä¸€å®šçš„è´Ÿè½½å‡è¡¡åŸåˆ™å°†æ–°çš„socket fdåˆ†é…ç»™å·¥ä½œçº¿ç¨‹ã€‚å¸¸ç”¨çš„ç®—æ³•ï¼Œæ¯”å¦‚round robinï¼Œå³è½®è¯¢æœºåˆ¶ï¼Œå³ï¼Œå‡è®¾ä¸è€ƒè™‘ä¸­é€”æœ‰è¿æ¥æ–­å¼€çš„æƒ…å†µï¼Œä¸€ä¸ªæ–°è¿æ¥æ¥äº†åˆ†é…ç»™B1ï¼Œåˆæ¥ä¸€ä¸ªåˆ†é…ç»™B2ï¼Œå†æ¥ä¸€ä¸ªåˆ†é…ç»™B3ï¼Œå†æ¥ä¸€ä¸ªåˆ†é…ç»™B4ã€‚å¦‚æ­¤åå¤ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹Aè®°å½•äº†å„ä¸ªå·¥ä½œçº¿ç¨‹ä¸Šçš„socket fdæ•°é‡ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§åŒ–åœ°æ¥å¹³è¡¡èµ„æºï¼Œé¿å…ä¸€äº›å·¥ä½œçº¿ç¨‹â€œå¿™æ­»â€ï¼Œå¦å¤–ä¸€äº›å·¥ä½œçº¿ç¨‹â€œé—²æ­»â€çš„ç°è±¡ã€‚\n\nå³ä½¿å·¥ä½œçº¿ç¨‹ä¸æ»¡è½½çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥è®©å·¥ä½œçº¿ç¨‹åšå…¶ä»–çš„äº‹æƒ…ã€‚æ¯”å¦‚ç°åœ¨æœ‰å››ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä½†åªæœ‰ä¸‰ä¸ªè¿æ¥ã€‚é‚£ä¹ˆçº¿ç¨‹B4å°±å¯ä»¥åœ¨handle_other_thing()åšä¸€äº›å…¶ä»–äº‹æƒ…ã€‚\n\n\nä¸‹é¢è®¨è®ºä¸€ä¸ªå¾ˆé‡è¦çš„æ•ˆç‡é—®é¢˜ï¼š\nåœ¨ä¸Šè¿°whileå¾ªç¯é‡Œé¢ï¼Œepoll_or_selec_func()ä¸­çš„epoll_wait&#x2F;poll&#x2F;selectç­‰å‡½æ•°ä¸€èˆ¬è®¾ç½®äº†ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å¦‚æœè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º0ï¼Œé‚£ä¹ˆåœ¨æ²¡æœ‰ä»»ä½•ç½‘ç»œIOæ—¶é—´å’Œå…¶ä»–ä»»åŠ¡å¤„ç†çš„æƒ…å†µä¸‹ï¼Œè¿™äº›å·¥ä½œçº¿ç¨‹å®é™…ä¸Šä¼šç©ºè½¬ï¼Œç™½ç™½åœ°æµªè´¹cpuæ—¶é—´ç‰‡ã€‚å¦‚æœè®¾ç½®çš„è¶…æ—¶æ—¶é—´å¤§äº0ï¼Œåœ¨æ²¡æœ‰ç½‘ç»œIOæ—¶é—´çš„æƒ…å†µï¼Œepoll_wait&#x2F;poll&#x2F;selectä»ç„¶è¦æŒ‚èµ·æŒ‡å®šæ—¶é—´æ‰èƒ½è¿”å›ï¼Œå¯¼è‡´handle_other_thing()ä¸èƒ½åŠæ—¶æ‰§è¡Œï¼Œå½±å“å…¶ä»–ä»»åŠ¡ä¸èƒ½åŠæ—¶å¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–ä»»åŠ¡ä¸€æ—¦äº§ç”Ÿï¼Œå…¶å¤„ç†èµ·æ¥å…·æœ‰ä¸€å®šçš„å»¶æ—¶æ€§ã€‚è¿™æ ·ä¹Ÿä¸å¥½ã€‚é‚£å¦‚ä½•è§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿ\nå…¶å®æˆ‘ä»¬æƒ³è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç½‘ç»œIOæ—¶é—´å’Œå…¶ä»–ä»»åŠ¡è¦å¤„ç†ï¼Œé‚£ä¹ˆè¿™äº›å·¥ä½œçº¿ç¨‹æœ€å¥½ç›´æ¥æŒ‚èµ·è€Œä¸æ˜¯ç©ºè½¬ï¼›å¦‚æœæœ‰å…¶ä»–ä»»åŠ¡è¦å¤„ç†ï¼Œè¿™äº›å·¥ä½œçº¿ç¨‹è¦ç«‹åˆ»èƒ½å¤„ç†è¿™äº›ä»»åŠ¡è€Œä¸æ˜¯åœ¨epoll_wait&#x2F;poll&#x2F;selecæŒ‚èµ·æŒ‡å®šæ—¶é—´åæ‰å¼€å§‹å¤„ç†è¿™äº›ä»»åŠ¡ã€‚\næˆ‘ä»¬é‡‡å–å¦‚ä¸‹æ–¹æ³•æ¥è§£å†³è¯¥é—®é¢˜ï¼Œä»¥linuxä¸ºä¾‹ï¼Œä¸ç®¡epoll_fdä¸Šæœ‰æ²¡æœ‰æ–‡ä»¶æè¿°ç¬¦fdï¼Œæˆ‘ä»¬éƒ½ç»™å®ƒç»‘å®šä¸€ä¸ªé»˜è®¤çš„fdï¼Œè¿™ä¸ªfdè¢«ç§°ä¸ºå”¤é†’fdã€‚å½“æˆ‘ä»¬éœ€è¦å¤„ç†å…¶ä»–ä»»åŠ¡çš„æ—¶å€™ï¼Œå‘è¿™ä¸ªå”¤é†’fdä¸Šéšä¾¿å†™å…¥1ä¸ªå­—èŠ‚çš„ï¼Œè¿™æ ·è¿™ä¸ªfdç«‹å³å°±å˜æˆå¯è¯»çš„äº†ï¼Œepoll_wait()&#x2F;poll()&#x2F;select()å‡½æ•°ç«‹å³è¢«å”¤é†’ï¼Œå¹¶è¿”å›ï¼Œæ¥ä¸‹æ¥é©¬ä¸Šå°±èƒ½æ‰§è¡Œhandle_other_thing()ï¼Œå…¶ä»–ä»»åŠ¡å¾—åˆ°å¤„ç†ã€‚åä¹‹ï¼Œæ²¡æœ‰å…¶ä»–ä»»åŠ¡ä¹Ÿæ²¡æœ‰ç½‘ç»œIOäº‹ä»¶æ—¶ï¼Œepoll_or_select_func()å°±æŒ‚åœ¨é‚£é‡Œä»€ä¹ˆä¹Ÿä¸åšã€‚\nè¿™ä¸ªå”¤é†’fdï¼Œåœ¨linuxå¹³å°ä¸Šå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•å®ç°ï¼š\n\nç®¡é“pipeï¼Œåˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå°†ç®¡é“ç»‘å®šåˆ°epoll_fdä¸Šã€‚éœ€è¦æ—¶ï¼Œå‘ç®¡é“ä¸€ç«¯å†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå·¥ä½œçº¿ç¨‹ç«‹å³è¢«å”¤é†’ã€‚\n\nlinux 2.6æ–°å¢çš„eventfdï¼š\n\n\n1int eventfd(unsigned int initval, int flags); \n\næ­¥éª¤ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå°†ç”Ÿæˆçš„eventfdç»‘å®šåˆ°epoll_fdä¸Šã€‚éœ€è¦æ—¶ï¼Œå‘è¿™ä¸ªeventfdä¸Šå†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå·¥ä½œçº¿ç¨‹ç«‹å³è¢«å”¤é†’ã€‚\n\nç¬¬ä¸‰ç§æ–¹æ³•æœ€æ–¹ä¾¿ã€‚å³linuxç‰¹æœ‰çš„socketpairï¼Œsocketpairæ˜¯ä¸€å¯¹ç›¸äº’è¿æ¥çš„socketï¼Œç›¸å½“äºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œæ¯ä¸€ç«¯éƒ½å¯ä»¥è¯»å†™æ•°æ®ã€‚\n\n1int socketpair(int domain, int type, int protocol, int sv[2]);\n\n\n\nè°ƒç”¨è¿™ä¸ªå‡½æ•°è¿”å›çš„ä¸¤ä¸ªsocketå¥æŸ„å°±æ˜¯sv[0]ï¼Œå’Œsv[1]ï¼Œåœ¨ä¸€ä¸ªå…¶ä¸­ä»»ä½•ä¸€ä¸ªå†™å…¥å­—èŠ‚ï¼Œåœ¨å¦å¤–ä¸€ä¸ªæ”¶å–å­—èŠ‚ã€‚\nå°†æ”¶å–çš„å­—èŠ‚çš„socketç»‘å®šåˆ°epoll_fdä¸Šã€‚éœ€è¦æ—¶ï¼Œå‘å¦å¤–ä¸€ä¸ªå†™å…¥çš„socketä¸Šå†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå·¥ä½œçº¿ç¨‹ç«‹å³è¢«å”¤é†’ã€‚å¦‚æœæ˜¯ä½¿ç”¨socketpairï¼Œé‚£ä¹ˆdomainå‚æ•°ä¸€å®šè¦è®¾ç½®æˆAFX_UNIXã€‚\nç”±äºåœ¨windowsï¼Œselectå‡½æ•°åªæ”¯æŒæ£€æµ‹socketè¿™ä¸€ç§fdï¼Œæ‰€ä»¥Windowsä¸Šä¸€èˆ¬åªèƒ½ç”¨æ–¹æ³•3çš„åŸç†ã€‚è€Œä¸”éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸¤ä¸ªsocketï¼Œç„¶åä¸€ä¸ªè¿æ¥å¦å¤–ä¸€ä¸ªï¼Œå°†è¯»å–çš„é‚£ä¸€æ®µç»‘å®šåˆ°selectçš„fdä¸Šå»ã€‚è¿™åœ¨å†™è·¨ä¸¤ä¸ªå¹³å°ä»£ç æ—¶ï¼Œéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"f6cf431fde3fe424d56db6051dddeb05","title":"ã€è½¬è½½ã€‘å¦‚ä½•è®¾è®¡æ–­çº¿è‡ªåŠ¨é‡è¿æœºåˆ¶","content":"å¦‚ä½•è®¾è®¡æ–­çº¿è‡ªåŠ¨é‡è¿æœºåˆ¶åœ¨æœ‰è¿æ¥ä¾èµ–å…³ç³»çš„æœåŠ¡ä¸æœåŠ¡ä¹‹é—´ï¼Œæˆ–å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ï¼Œæ— è®ºæ˜¯å‡ºäºæ–¹ä¾¿ä½¿ç”¨ã€é™ä½è¿ç»´æˆæœ¬ã€æé«˜å·¥ä½œæ•ˆç‡ï¼ˆæœåŠ¡ä¸æœåŠ¡ä¹‹é—´ï¼‰ï¼Œè¿˜æ˜¯ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼ˆå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ï¼‰è‡ªåŠ¨é‡è¿æœºåˆ¶é€šå¸¸éƒ½æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ã€‚\n\næƒ…æ™¯ä¸€\n\nå¯¹äºä¸€ç»„æœåŠ¡ä¹‹é—´ï¼Œå¦‚æœå…¶ä¸­ä¸€äº›æœåŠ¡ï¼ˆä¸»åŠ¨è¿æ¥æ–¹ï¼Œä¸‹æ–‡ä»¥ A ä»£ç§°ï¼‰éœ€è¦ä¸å¦å¤–ä¸€äº›æœåŠ¡ï¼ˆè¢«è¿æ¥æ–¹ï¼Œä¸‹æ–‡ä»¥ B ä»£ç§°ï¼‰å»ºç«‹ TCP é•¿è¿æ¥ï¼Œå¦‚æœ A æ²¡æœ‰è‡ªåŠ¨è¿æ¥ B çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆåœ¨éƒ¨ç½²æˆ–è€…æµ‹è¯•è¿™äº›æœåŠ¡çš„æ—¶å€™ï¼Œå¿…é¡»å…ˆå¯åŠ¨ Bï¼Œå†å¯åŠ¨ Aï¼Œå› ä¸ºä¸€æ—¦å…ˆå¯åŠ¨ Aï¼ŒA æ­¤æ—¶å»å°è¯•è¿æ¥ Bï¼ˆç”±äº B è¿˜æ²¡æœ‰å¯åŠ¨ï¼‰ä¼šå¤±è´¥ï¼Œä¹‹å A å†ä¹Ÿä¸ä¼šå»è¿æ¥ Bäº†ï¼ˆå³ä½¿éšå B è¢«å¯åŠ¨äº†ï¼‰ï¼Œä»è€Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™æ˜¯ç¼ºç‚¹ä¸€ã€‚\n\næƒ…æ™¯äºŒ\n\nå³ä½¿éƒ¨ç½²æˆ–æµ‹è¯•çš„æ—¶å€™ï¼Œå…ˆå¯åŠ¨äº† Bï¼Œå†å¯åŠ¨ Aï¼ŒA ä¸ B ä¹‹é—´çš„è¿æ¥åœ¨è¿è¡ŒæœŸé—´å†…ï¼Œå¯èƒ½ç”±äºç½‘ç»œæ³¢åŠ¨ç­‰åŸå› å¯¼è‡´ A ä¸ B ä¹‹é—´è¿æ¥æ–­å¼€ï¼Œä¹‹åæ•´ä¸ªç³»ç»Ÿä¹Ÿä¸èƒ½å†æ­£å¸¸å·¥ä½œäº†ã€‚è¿™æ˜¯ç¼ºç‚¹äºŒã€‚\n\næƒ…æ™¯ä¸‰\n\nå¦‚æœæˆ‘ä»¬æƒ³å‡çº§ Bï¼Œæ›´æ–°å®Œç¨‹åºåï¼Œé‡å¯ Bï¼Œä¹Ÿå¿…é¡»é‡å¯ Aã€‚å¦‚æœè¿™ç§ä¾èµ–é“¾æ¯”è¾ƒé•¿ï¼ˆä¾‹å¦‚ A è¿æ¥ Bï¼ŒB è¿æ¥ Cï¼ŒC è¿æ¥ Dï¼ŒD è¿æ¥ Eï¼Œç­‰ç­‰ï¼‰ï¼Œé‚£ä¹ˆæ›´æ–°æŸä¸ªç¨‹åºçš„æ•ˆç‡å’Œæˆæœ¬ä¼šéå¸¸é«˜ã€‚è¿™æ˜¯ç¼ºç‚¹ä¸‰ã€‚\n\næƒ…æ™¯å››\n\nå¯¹äºå®¢æˆ·ç«¯è½¯ä»¶æ¥è¯´ï¼Œå¦‚æœå› ä¸ºç”¨æˆ·çš„ç½‘ç»œçŸ­æš‚æ•…éšœå¯¼è‡´å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å¤±å»è¿æ¥ï¼Œç­‰ç½‘ç»œæ¢å¤åï¼Œè¾ƒå¥½çš„ç”¨æˆ·ä½“éªŒæ˜¯å®¢æˆ·ç«¯èƒ½æ£€æµ‹åˆ°ç”¨æˆ·ç½‘ç»œå˜åŒ–åï¼Œè‡ªåŠ¨ä¸æœåŠ¡å™¨é‡è¿ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½åŠæ—¶æ”¶åˆ°æœ€æ–°çš„æ¶ˆæ¯ã€‚\nä»¥ä¸Šå››ä¸ªæƒ…æ™¯è¯´æ˜äº†æ–­çº¿è‡ªåŠ¨é‡è¿åŠŸèƒ½çš„é‡è¦æ€§ï¼Œé‚£å¦‚ä½•å»è®¾è®¡å¥½çš„æ–­çº¿é‡è¿æœºåˆ¶å‘¢ï¼Ÿ\né‡è¿æœ¬èº«çš„åŠŸèƒ½å¼€å‘å¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ socket å‡½æ•° connect å‡½æ•°ï¼Œä¸æ–­å»â€œé‡è¯•â€ã€‚è¿™é‡Œçš„â€œé‡è¯•â€æˆ‘ä½¿ç”¨äº†åŒå¼•å·ï¼Œæ˜¯ä¸ºäº†è¯´æ˜é‡è¯•çš„æŠ€å·§éå¸¸æœ‰è®²ç©¶ï¼š\n\nå¯¹äºæœåŠ¡å™¨ç«¯ç¨‹åºï¼Œä¾‹å¦‚ A è¿æ¥ Bï¼Œå¦‚æœè¿æ¥ä¸ä¸Šï¼Œæ•´ä¸ªç³»ç»Ÿå°†æ— æ³•å·¥ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å‘ A æœåŠ¡æ—¶ï¼Œé‡è¿çš„é€»è¾‘å¯ä»¥å¾ˆç®€å•ï¼Œå³ A ä¸€æ—¦å‘ç°ä¸ B æ–­å¼€äº†è¿æ¥ï¼Œå°±ç«‹å³å°è¯•ä¸ B é‡æ–°è¿æ¥ï¼Œå¦‚æœè¿æ¥ä¸ä¸Šï¼Œéš”ä¸€æ®µæ—¶é—´å†é‡è¯•ï¼ˆä¸€èˆ¬è®¾ç½®ä¸º 3 ç§’æˆ– 5 ç§’å³å¯ï¼‰ï¼Œä¸€ç›´åˆ°è¿æ¥æˆåŠŸä¸ºæ­¢ã€‚å½“ç„¶ï¼ŒæœŸé—´å¯ä»¥ä¸æ–­å‘é€æŠ¥è­¦é‚®ä»¶æˆ–è€…æŒç»­è¾“å‡ºé”™è¯¯æ—¥å¿—ï¼Œæ¥å¼•èµ·å¼€å‘æˆ–è€…è¿ç»´äººå‘˜çš„å°½å¿«å¹²é¢„ï¼Œä»¥ä¾¿å°½æ—©æ’æŸ¥å’Œè§£å†³è¿æ¥ä¸ä¸Šçš„åŸå› ã€‚\nå¯¹äºå®¢æˆ·ç«¯è½¯ä»¶ï¼Œä»¥ä¸Šåšæ³•ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸æ˜¯æœ€ä¼˜çš„ã€‚å®¢æˆ·ç«¯æ‰€å¤„çš„ç½‘ç»œç¯å¢ƒæ¯”æœåŠ¡å™¨ç¨‹åºæ‰€å¤„çš„ç½‘ç»œç¯å¢ƒä¸€èˆ¬è¦æ¶åŠ£çš„å¤šï¼Œç­‰é—´éš”çš„å®šæ—¶å»é‡è¿ï¼Œä¸€èˆ¬ä½œç”¨ä¸å¤§ï¼ˆä¾‹å¦‚ç”¨æˆ·æ‹”æ‰äº†ç½‘çº¿ï¼‰ã€‚å› æ­¤ï¼Œå¯¹äºå®¢æˆ·ç«¯è½¯ä»¶ï¼Œä¸€èˆ¬å‡ºç°æ–­çº¿ï¼Œä¼šå°è¯•å»é‡è¿ï¼Œå¦‚æœè¿æ¥ä¸ä¸Šï¼Œä¼šéš”ä¸ªæ¯”å‰ä¸€æ¬¡æ—¶é—´æ›´é•¿çš„æ—¶é—´é—´éš”å»é‡è¿ï¼Œä¾‹å¦‚è¿™ä¸ªæ—¶é—´é—´éš”å¯ä»¥æ˜¯ 2 ç§’ã€4 ç§’ã€8 ç§’ã€16ç§’ç­‰ç­‰ã€‚ä½†æ˜¯ï¼Œè¿™æ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œéšç€é‡è¿æ¬¡æ•°çš„å˜å¤šï¼Œé‡è¿çš„æ—¶é—´é—´éš”ä¼šè¶Šæ¥è¶Šå¤§ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªæœ€å¤§é‡è¿æ—¶é—´é—´éš”ï¼Œä¹‹åæ¢å¤åˆ°ä¹‹å‰è¾ƒå°çš„æ—¶é—´é—´éš”ï¼‰ã€‚å¦‚æœç½‘ç»œæ­¤æ—¶å·²ç»æ¢å¤ï¼ˆä¾‹å¦‚ç”¨æˆ·é‡æ–°æ’ä¸Šç½‘çº¿ï¼‰ï¼Œæˆ‘ä»¬çš„ç¨‹åºéœ€è¦ç­‰å¾…ä¸€ä¸ªå¾ˆé•¿çš„æ—¶é—´é—´éš”ï¼ˆå¦‚ 16 ç§’ï¼‰æ‰èƒ½æ¢å¤è¿æ¥ï¼Œè¿™åŒæ ·ä¸åˆ©äºç”¨æˆ·ä½“éªŒã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœç½‘ç»œå‘ç”Ÿæ³¢åŠ¨ï¼Œæˆ‘ä»¬çš„ç¨‹åºå¯ä»¥æ£€æµ‹ç½‘ç»œçŠ¶æ€ï¼Œå¦‚æœç½‘ç»œçŠ¶æ€æ¢å¤æ­£å¸¸æ­¤æ—¶åº”è¯¥ç«‹å³è¿›è¡Œä¸€æ¬¡é‡è¿ï¼Œè€Œä¸æ˜¯ä¸€æˆä¸å˜åœ°æŒ‰ç…§è®¾ç½®çš„æ—¶é—´é—´éš”å»é‡è¿ã€‚\n\n\næ“ä½œç³»ç»Ÿæä¾›äº†æ£€æµ‹ç½‘ç»œçŠ¶æ€å˜åŒ–çš„ API å‡½æ•°ï¼Œä¾‹å¦‚å¯¹äº Windows å¯ä»¥ä½¿ç”¨ IsNetworkAlive() å‡½æ•°å»æ£€æµ‹ï¼Œå¯¹äº Androidï¼Œç½‘ç»œå˜åŒ–æ—¶ä¼šå‘é€æ¶ˆæ¯ç±»å‹æ˜¯ WifiManager.NETWORK_STATE_CHANGED_ACTION çš„å¹¿æ’­é€šçŸ¥ã€‚\n\nå¦å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå®¢æˆ·ç«¯ç½‘ç»œæ–­å¼€ï¼Œä¸€èˆ¬ä¼šåœ¨ç•Œé¢æŸä¸ªåœ°æ–¹æ˜¾å¼åœ°å‘Šè¯‰ç”¨æˆ·å½“å‰è¿æ¥çŠ¶æ€ï¼Œå¹¶æé†’å½“å‰æ­£åœ¨è¿›è¡Œæ–­çº¿é‡è¿ï¼Œä¸”åº”è¯¥æœ‰ä¸€ä¸ªå¯ä»¥è®©ç”¨æˆ·æ”¾å¼ƒæ–­çº¿é‡è¿æˆ–è€…ç«‹å³è¿›è¡Œä¸€æ¬¡æ–­çº¿é‡è¿çš„åŠŸèƒ½ã€‚\nç»¼ä¸Šæ‰€è¿°ï¼Œæ€»ç»“èµ·æ¥ï¼Œå¯¹äºæœåŠ¡å™¨ç¨‹åºä¹‹é—´çš„é‡è¿å¯ä»¥è®¾è®¡æˆç­‰æ—¶é—´é—´éš”çš„å®šæ—¶é‡è¿ï¼Œå¯¹äºå®¢æˆ·ç«¯ç¨‹åºè¦ç»“åˆä¾æ¬¡æ”¾å¤§é‡è¿æ—¶é—´é—´éš”ã€ç½‘ç»œçŠ¶æ€å˜åŒ–ç«‹å³é‡è¿æˆ–ç”¨æˆ·ä¸»åŠ¨å‘èµ·é‡è¿è¿™ä¸‰ä¸ªå› ç´ æ¥è®¾è®¡ã€‚\nä¸éœ€è¦é‡è¿çš„æƒ…å½¢ä¸éœ€è¦é‡è¿ä¸€èˆ¬æœ‰ä»¥ä¸‹æƒ…å½¢ï¼š\n\nç”¨æˆ·ä½¿ç”¨å®¢æˆ·ç«¯ä¸»åŠ¨æ”¾å¼ƒé‡è¿ï¼›\n\nå› ä¸ºä¸€äº›ä¸šåŠ¡ä¸Šçš„è§„å®šï¼Œç¦æ­¢å®¢æˆ·ç«¯é‡è¿ï¼›\nä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæŸä¸ªç³»ç»ŸåŒä¸€æ—¶åˆ»åŒä¸€ä¸ªè´¦æˆ·åªå…è®¸ç™»é™†ä¸€ä¸ªï¼ŒæŸä¸ªè´¦æˆ·åœ¨æœºå™¨ A ä¸Šç™»é™†ï¼Œæ­¤æ—¶æ¥ç€åˆåœ¨æœºå™¨ B ä¸Šç™»é™†ï¼Œæ­¤æ—¶ A å°†è¢«æœåŠ¡å™¨è¸¢ä¸‹çº¿ï¼Œé‚£ä¹ˆæ­¤æ—¶ A å®¢æˆ·ç«¯çš„é€»è¾‘å°±åº”è¯¥ç¦æ­¢è‡ªåŠ¨é‡è¿ã€‚\n\n\næŠ€æœ¯ä¸Šçš„æ–­çº¿é‡è¿å’Œä¸šåŠ¡ä¸Šçš„æ–­çº¿é‡è¿è¿™é‡Œè¯´çš„æŠ€æœ¯ä¸Šçš„é‡è¿ï¼ŒæŒ‡çš„æ˜¯è°ƒç”¨ connect å‡½æ•°è¿æ¥ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¤§å¤šæ•°ç³»ç»Ÿå…‰æœ‰æŠ€æœ¯ä¸Šçš„é‡è¿æˆåŠŸï¼ˆå³ connect è¿æ¥æˆåŠŸï¼‰æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ï¼Œç½‘ç»œè¿æ¥æˆåŠŸä»¥åï¼Œæ¥ä¸‹æ¥è¿˜å¾—å†æ¬¡å‘æœåŠ¡å™¨å‘é€è´¦å·éªŒè¯ä¿¡æ¯ç­‰ç­‰ï¼ˆå¦‚ç™»é™†æ•°æ®åŒ…ï¼‰ï¼Œåªæœ‰è¿™äº›æ•°æ®éªŒç­¾æˆåŠŸåï¼Œæ‰èƒ½ç®—æ˜¯çœŸæ­£çš„é‡è¿æˆåŠŸï¼Œè¿™é‡Œè¯´çš„å‘é€è´¦å·éªŒè¯ä¿¡æ¯å¹¶éªŒç­¾æˆåŠŸå°±æ˜¯ä¸šåŠ¡ä¸Šçš„é‡è¿æˆåŠŸã€‚å¤æ‚çš„ç³»ç»Ÿå¯èƒ½ä¼šéœ€è¦è¿ç»­å¥½å‡ é“éªŒç­¾æµç¨‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡æ–­çº¿é‡è¿æœºåˆ¶çš„æ—¶å€™ï¼Œä¸ä»…è¦è€ƒè™‘æŠ€æœ¯ä¸Šçš„é‡è¿ï¼Œè¿˜è¦è€ƒè™‘ä¸šåŠ¡ä¸Šçš„é‡è¿ã€‚åªæœ‰å®Œæ•´åœ°åŒ…å«è¿™ä¸¤ä¸ªæµç¨‹ï¼Œæ‰ç®—æ˜¯è¾ƒä¼˜çš„æ–­çº¿è‡ªåŠ¨é‡è¿åŠŸèƒ½ã€‚\næœ¬èŠ‚ä»‹ç»çš„çŸ¥è¯†ç‚¹ä¸»è¦æ˜¯æ€è·¯æ€§çš„å†…å®¹ï¼Œä¸€æ—¦ææ¸…æ¥šäº†æ€è·¯ï¼ŒæŠ€æœ¯ä¸Šå®ç°èµ·æ¥å¹¶ä¸ä¼šå­˜åœ¨ä»€ä¹ˆå›°éš¾ï¼Œå› æ­¤æœ¬èŠ‚æ²¡æœ‰ç»™å‡ºå…·ä½“çš„ä»£ç ç¤ºä¾‹ã€‚\næ¬¢è¿å…³æ³¨å…¬ä¼—å·ã€easyserverdevã€ï¼Œæœ¬å…¬ä¼—å·æ¨å´‡åŸºç¡€å­¦ä¹ ä¸åŸç†ç†è§£ï¼Œä¸è°ˆå¤§è€Œç©ºçš„æ¶æ„ä¸æŠ€æœ¯æœ¯è¯­ï¼Œåˆ†äº«æ¥åœ°æ°”çš„æœåŠ¡å™¨å¼€å‘å®æˆ˜æŠ€å·§ä¸é¡¹ç›®ç»éªŒï¼Œå®å®åœ¨åœ¨åˆ†äº«å¯ç”¨äºå®é™…ç¼–ç çš„ç¼–ç¨‹çŸ¥è¯†ã€‚åŒæ—¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥åŠ å…¥æˆ‘çš„ QQ ç¾¤578019391ã€‚\n\næ–‡ç« å·²äº2019-08-12ä¿®æ”¹\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/å¦‚ä½•è®¾è®¡æ–­çº¿è‡ªåŠ¨é‡è¿æœºåˆ¶","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"109d28235b9c7b6892c4c14f9b41b157","title":"ã€è½¬è½½ã€‘å®ä¾‹ï¼šä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»","content":"å®ä¾‹ï¼šä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»æœ¬æ–‡å°†ä»‹ç»æˆ‘æ›¾ç»åšè¿‡çš„ä¸€ä¸ªé¡¹ç›®çš„æœåŠ¡å™¨æ¶æ„å’ŒæœåŠ¡å™¨ç¼–ç¨‹çš„ä¸€äº›é‡è¦ç»†èŠ‚ã€‚\nä¸€ã€ç¨‹åºè¿è¡Œç¯å¢ƒæ“ä½œç³»ç»Ÿï¼šCentos 7.0\nç¼–è¯‘å™¨ï¼šgcc&#x2F;g++ 4.8.3ã€cmake 2.8.11\nmysqlæ•°æ®åº“ï¼š5.5.47\né¡¹ç›®ä»£ç ç®¡ç†å·¥å…·ï¼šVisual Studio 2013\nä¸€ã€ç¨‹åºç»“æ„è¯¥ç¨‹åºæ€»å…±æœ‰ 17 ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­åˆ†ä¸º 9 ä¸ªæ•°æ®åº“å·¥ä½œçº¿ç¨‹ D å’Œä¸€ä¸ªæ—¥å¿—çº¿ç¨‹ Lï¼Œ6 ä¸ªæ™®é€šå·¥ä½œçº¿ç¨‹ Wï¼Œä¸€ä¸ªä¸»çº¿ç¨‹ Mã€‚ï¼ˆä»¥ä¸‹ä¼šç”¨è¿™äº›å­—æ¯æ¥ä»£æŒ‡è¿™äº›çº¿ç¨‹ï¼‰\nï¼ˆä¸€ï¼‰ã€æ•°æ®åº“å·¥ä½œçº¿ç¨‹çš„ç”¨é€”9 ä¸ªæ•°æ®åº“å·¥ä½œçº¿ç¨‹åœ¨çº¿ç¨‹å¯åŠ¨ä¹‹åˆï¼Œä¸ mysql å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªçº¿ç¨‹éƒ½ä¸ mysql ä¿æŒä¸€è·¯è¿æ¥ï¼Œå…± 9 ä¸ªæ•°æ®åº“è¿æ¥ã€‚\næ¯ä¸ªæ•°æ®åº“å·¥ä½œçº¿ç¨‹åŒæ—¶å­˜åœ¨ä¸¤ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼Œç¬¬ä¸€ä¸ªé˜Ÿåˆ— A å­˜æ”¾éœ€è¦æ‰§è¡Œæ•°æ®åº“å¢åˆ æŸ¥æ”¹æ“ä½œçš„ä»»åŠ¡ sqlTaskï¼Œç¬¬äºŒä¸ªé˜Ÿåˆ— B å­˜æ”¾ sqlTask æ‰§è¡Œå®Œæˆåçš„ç»“æœã€‚sqlTask æ‰§è¡Œå®Œæˆåç«‹å³æ”¾å…¥ç»“æœé˜Ÿåˆ—ä¸­ï¼Œå› è€Œç»“æœé˜Ÿåˆ—ä¸­ä»»åŠ¡ä¹Ÿæ˜¯ä¸€ä¸ªä¸ªçš„éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚å¤§è‡´ä¼ªä»£ç å¦‚ä¸‹ï¼š\n123456789101112131415void db_thread_func()  &#123;      while (!m_bExit)      &#123;          if (NULL != (pTask = m_sqlTask.Pop()))          &#123;              //ä»m_sqlTaskä¸­å–å‡ºçš„ä»»åŠ¡å…ˆæ‰§è¡Œå®Œæˆåï¼ŒpTaskå°†æºå¸¦ç»“æœæ•°æ®              pTask-&gt;Execute();                          //å¾—åˆ°ç»“æœåï¼Œç«‹åˆ»å°†è¯¥ä»»åŠ¡æ”¾å…¥ç»“æœä»»åŠ¡é˜Ÿåˆ—              m_resultTask.Push(pTask);              continue;          &#125;          sleep(1000);      &#125;//end while-loop  &#125;  \n\nç°åœ¨çš„é—®é¢˜æ¥äº†ï¼š\n\nä»»åŠ¡é˜Ÿåˆ— A ä¸­çš„ä»»åŠ¡ä»ä½•è€Œæ¥ï¼Œç›®å‰åªæœ‰æ¶ˆè´¹è€…ï¼Œæ²¡æœ‰ç”Ÿäº§è€…ï¼Œé‚£ä¹ˆç”Ÿäº§è€…æ˜¯è°ï¼Ÿ\nä»»åŠ¡é˜Ÿåˆ— B ä¸­çš„ä»»åŠ¡å°†å»ä½•æ–¹ï¼Œç›®å‰åªæœ‰ç”Ÿäº§è€…æ²¡æœ‰æ¶ˆè´¹è€…ã€‚\n\nè¿™ä¸¤ä¸ªé—®é¢˜å…ˆæ”¾ä¸€ä¼šå„¿ï¼Œç­‰åˆ°åé¢æˆ‘å†æ¥å›ç­”ã€‚\nï¼ˆäºŒï¼‰å·¥ä½œçº¿ç¨‹å’Œä¸»çº¿ç¨‹åœ¨ä»‹ç»ä¸»çº¿ç¨‹å’Œå·¥ä½œçº¿ç¨‹å…·ä½“åšä»€ä¹ˆæ—¶ï¼Œæˆ‘ä»¬ä»‹ç»ä¸‹æœåŠ¡å™¨ç¼–ç¨‹ä¸­å¸¸å¸¸æŠ½è±¡å‡ºæ¥çš„å‡ ä¸ªæ¦‚å¿µï¼ˆè¿™é‡Œä»¥ tcp è¿æ¥ä¸ºä¾‹ï¼‰ï¼š\n\nTcpServer å³ Tcp æœåŠ¡ï¼ŒæœåŠ¡å™¨éœ€è¦ç»‘å®šipåœ°å€å’Œç«¯å£å·ï¼Œå¹¶åœ¨è¯¥ç«¯å£å·ä¸Šä¾¦å¬å®¢æˆ·ç«¯çš„è¿æ¥ï¼ˆå¾€å¾€ç”±ä¸€ä¸ªæˆå‘˜å˜é‡ TcpListener æ¥ç®¡ç†ä¾¦å¬ç»†èŠ‚ï¼‰ã€‚æ‰€ä»¥ä¸€ä¸ª TcpServer è¦åšçš„å°±æ˜¯è¿™äº›å·¥ä½œã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¯å½“æœ‰æ–°è¿æ¥åˆ°æ¥æ—¶ï¼ŒTcpServer éœ€è¦æ¥æ”¶æ–°è¿æ¥ï¼Œå½“å¤šä¸ªæ–°è¿æ¥å­˜åœ¨æ—¶ï¼ŒTcpServer éœ€è¦æœ‰æ¡ä¸ç´Šåœ°ç®¡ç†è¿™äº›è¿æ¥ï¼šè¿æ¥çš„å»ºç«‹ã€æ–­å¼€ç­‰ï¼Œå³äº§ç”Ÿå’Œç®¡ç†ä¸‹æ–‡ä¸­è¯´çš„ TcpConnection å¯¹è±¡ã€‚\nä¸€ä¸ªè¿æ¥å¯¹åº”ä¸€ä¸ª TcpConnection å¯¹è±¡ï¼ŒTcpConnection å¯¹è±¡ç®¡ç†ç€è¿™ä¸ªè¿æ¥çš„ä¸€äº›ä¿¡æ¯ï¼šå¦‚è¿æ¥çŠ¶æ€ã€æœ¬ç«¯å’Œå¯¹ç«¯çš„ ip åœ°å€å’Œç«¯å£å·ç­‰ã€‚\næ•°æ®é€šé“å¯¹è±¡ Channelï¼ŒChannel è®°å½•äº† socket çš„å¥æŸ„ï¼Œå› è€Œæ˜¯ä¸€ä¸ªè¿æ¥ä¸Šæ‰§è¡Œæ•°æ®æ”¶å‘çš„çœŸæ­£æ‰§è¡Œè€…ï¼ŒChannel å¯¹è±¡ä¸€èˆ¬ä½œä¸º TcpConnection çš„æˆå‘˜å˜é‡ã€‚\nTcpSession å¯¹è±¡ï¼Œæ˜¯å°† Channel æ”¶å–çš„æ•°æ®è¿›è¡Œè§£åŒ…ï¼Œæˆ–è€…å¯¹å‡†å¤‡å¥½çš„æ•°æ®è¿›è¡Œè£…åŒ…ï¼Œå¹¶ä¼ ç»™ Channel å‘é€ã€‚\n\nå½’çº³èµ·æ¥ï¼šä¸€ä¸ª TcpServer ä¾é  TcpListener å¯¹æ–°è¿æ¥çš„ä¾¦å¬å’Œå¤„ç†ï¼Œä¾é  TcpConnection å¯¹è±¡å¯¹è¿æ¥ä¸Šçš„æ•°æ®è¿›è¡Œç®¡ç†ï¼ŒTcpConnection å®é™…ä¾é  Channel å¯¹æ•°æ®è¿›è¡Œæ”¶å‘ï¼Œä¾é  TcpSession å¯¹æ•°æ®è¿›è¡Œè£…åŒ…å’Œè§£åŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª TcpServer å­˜åœ¨ä¸€ä¸ª TcpListenerï¼Œå¯¹åº”å¤šä¸ª TcpConnectionï¼Œæœ‰å‡ ä¸ªTcpConnection å°±æœ‰å‡ ä¸ª TcpSessionï¼ŒåŒæ—¶ä¹Ÿå°±æœ‰å‡ ä¸ª Channelã€‚\nä»¥ä¸Šè¯´çš„ TcpServerã€TcpListenerã€TcpConnectionã€Channel å’Œ TcpSession æ˜¯æœåŠ¡å™¨æ¡†æ¶çš„ç½‘ç»œå±‚ã€‚ä¸€ä¸ªå¥½çš„ç½‘ç»œæ¡†æ¶ï¼Œåº”è¯¥åšåˆ°ä¸ä¸šåŠ¡ä»£ç è„±è€¦ã€‚å³ä¸Šå±‚ä»£ç åªéœ€è¦æ‹¿åˆ°æ•°æ®ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸ç”¨å…³æ³¨æ•°æ®çš„æ”¶å‘å’Œç½‘ç»œæ•°æ®åŒ…çš„å°åŒ…å’Œè§£åŒ…ä»¥åŠç½‘ç»œçŠ¶æ€çš„å˜åŒ–ï¼ˆæ¯”å¦‚ç½‘ç»œæ–­å¼€ä¸é‡è¿ï¼‰ã€‚\næ‹¿æ•°æ®çš„å‘é€æ¥è¯´ï¼š\nå½“ä¸šåŠ¡é€»è¾‘å°†æ•°æ®äº¤ç»™ TcpSessionï¼ŒTcpSession å°†æ•°æ®è£…å¥½åŒ…åï¼ˆè£…åŒ…è¿‡ç¨‹åå¯ä»¥æœ‰ä¸€äº›åŠ å¯†æˆ–å‹ç¼©æ“ä½œï¼‰ï¼Œäº¤ç»™ TcpConnection::SendData()ï¼Œè€ŒTcpConnection::SendData() å®é™…æ˜¯è°ƒç”¨ **Channel::SendData()**ï¼Œå› ä¸º Channel å«æœ‰ socket å¥æŸ„ï¼Œæ‰€ä»¥ Channel::SendData() çœŸæ­£è°ƒç”¨send()&#x2F;sendto()&#x2F;write() æ–¹æ³•å°†æ•°æ®å‘å‡ºå»ã€‚\nå¯¹äºæ•°æ®çš„æ¥æ”¶ï¼Œç¨å¾®æœ‰ä¸€ç‚¹ä¸åŒï¼š\né€šè¿‡ select()&#x2F;poll()&#x2F;epoll() ç­‰IO multiplexæŠ€æœ¯ï¼Œç¡®å®šå¥½äº†å“ªäº› TcpConnection ä¸Šæœ‰æ•°æ®åˆ°æ¥åï¼Œæ¿€æ´»è¯¥ TcpConnection çš„ Channel å¯¹è±¡å»è°ƒç”¨recv()&#x2F;recvfrom()&#x2F;read() æ¥æ”¶å–æ•°æ®ã€‚æ•°æ®æ”¶åˆ°ä»¥åï¼Œå°†æ•°æ®äº¤ç”± TcpSessionæ¥å¤„ç†ï¼Œæœ€ç»ˆäº¤ç»™ä¸šåŠ¡å±‚ã€‚æ³¨æ„æ•°æ®æ”¶å–ã€è§£åŒ…ä¹ƒè‡³äº¤ç»™ä¸šåŠ¡å±‚æ˜¯ä¸€å®šè¦åˆ†å¼€çš„ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼šæœ€å¥½ä¸è¦è§£åŒ…å¹¶äº¤ç»™ä¸šåŠ¡å±‚å’Œæ•°æ®æ”¶å–çš„é€»è¾‘æ”¾åœ¨ä¸€èµ·ã€‚å› ä¸ºæ•°æ®æ”¶å–æ˜¯ IO æ“ä½œï¼Œè€Œè§£åŒ…å’Œäº¤ç»™ä¸šåŠ¡å±‚æ˜¯é€»è¾‘è®¡ç®—æ“ä½œã€‚IO æ“ä½œä¸€èˆ¬æ¯”é€»è¾‘è®¡ç®—è¦æ…¢ã€‚åˆ°åº•å¦‚ä½•å®‰æ’è¦æ ¹æ®æœåŠ¡å™¨ä¸šåŠ¡æ¥å–èˆï¼Œä¹Ÿå°±æ˜¯è¯´ä½ è¦æƒ³å¥½ä½ çš„æœåŠ¡å™¨ç¨‹åºçš„æ€§èƒ½ç“¶é¢ˆåœ¨ç½‘ç»œ IO è¿˜æ˜¯é€»è¾‘è®¡ç®—ï¼Œå³ä½¿æ˜¯ç½‘ç»œ IOï¼Œä¹Ÿå¯ä»¥åˆ†ä¸ºä¸Šè¡Œæ“ä½œå’Œä¸‹è¡Œæ“ä½œï¼Œä¸Šè¡Œæ“ä½œå³å®¢æˆ·ç«¯å‘æ•°æ®ç»™æœåŠ¡å™¨ï¼Œä¸‹è¡Œå³æœåŠ¡å™¨å‘æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚æœ‰æ—¶å€™æ•°æ®ä¸Šè¡Œå°‘ï¼Œä¸‹è¡Œå¤§ã€‚ï¼ˆå¦‚æ¸¸æˆæœåŠ¡å™¨ï¼Œä¸€ä¸ª npc ç§»åŠ¨äº†ä½ç½®ï¼Œä¸Šè¡Œæ˜¯è¯¥å®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨è‡ªå·±æœ€æ–°ä½ç½®ï¼Œè€Œä¸‹è¡Œç¡®æ˜¯æœåŠ¡å™¨è¦å‘Šè¯‰åœ¨åœºçš„æ¯ä¸ªå®¢æˆ·ç«¯ï¼‰ã€‚\nåœ¨æˆ‘çš„æ–‡ç« ã€Šä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥ã€‹ä¸­ä»‹ç»äº†ï¼Œå·¥ä½œçº¿ç¨‹çš„æµç¨‹ï¼š\n12345678while (!m_bQuit)  &#123;      epoll_or_select_func();      handle_io_events();      handle_other_things();  &#125;\n\n\nå…¶ä¸­ epoll_or_select_func() å³æ˜¯ä¸Šæ–‡æ‰€è¯´çš„é€šè¿‡ select()&#x2F;poll()&#x2F;epoll() ç­‰ IO multiplex æŠ€æœ¯ï¼Œç¡®å®šå¥½äº†å“ªäº› TcpConnection ä¸Šæœ‰æ•°æ®åˆ°æ¥ã€‚æˆ‘çš„æœåŠ¡å™¨ä»£ç ä¸­ä¸€èˆ¬åªä¼šç›‘æµ‹ socket å¯è¯»äº‹ä»¶ï¼Œè€Œä¸ä¼šç›‘æµ‹ socket å¯å†™äº‹ä»¶ã€‚è‡³äºå¦‚ä½•å‘æ•°æ®ï¼Œæ–‡ç« åé¢ä¼šä»‹ç»ã€‚æ‰€ä»¥å¯¹äºå¯è¯»äº‹ä»¶ï¼Œä»¥ epoll ä¸ºä¾‹ï¼Œè¿™é‡Œéœ€è¦è®¾ç½®çš„æ ‡è¯†ä½æ˜¯ï¼š\n\nEPOLLIN æ™®é€šå¯è¯»äº‹ä»¶ï¼ˆå½“è¿æ¥æ­£å¸¸æ—¶ï¼Œäº§ç”Ÿè¿™ä¸ªäº‹ä»¶ï¼Œrecv()&#x2F;read()å‡½æ•°è¿”å›æ”¶åˆ°çš„å­—èŠ‚æ•°ï¼›å½“è¿æ¥å…³é—­ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°è¿”å›0ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è®¾ç½®è¿™ä¸ªæ ‡è¯†å·²ç»å¯ä»¥ç›‘æµ‹åˆ°æ–°æ¥æ•°æ®å’Œå¯¹ç«¯å…³é—­äº‹ä»¶ï¼‰\nEPOLLRDHUP å¯¹ç«¯å…³é—­äº‹ä»¶ï¼ˆlinux man æ‰‹å†Œä¸Šè¯´è¿™ä¸ªäº‹ä»¶å¯ä»¥ç›‘æµ‹å¯¹ç«¯å…³é—­ï¼Œä½†æˆ‘å®é™…è°ƒè¯•æ—¶å‘é€å³ä½¿å¯¹ç«¯å…³é—­ä¹Ÿæ²¡è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œä»ç„¶æ˜¯EPOLLINï¼Œåªä¸è¿‡æ­¤æ—¶è°ƒç”¨recv()&#x2F;read()å‡½æ•°ï¼Œè¿”å›å€¼ä¼šä¸º0ï¼Œæ‰€ä»¥å®é™…é¡¹ç›®ä¸­æ˜¯å¦å¯ä»¥é€šè¿‡è®¾ç½®è¿™ä¸ªæ ‡è¯†æ¥ç›‘æµ‹å¯¹ç«¯å…³é—­ï¼Œä»ç„¶å¾…è€ƒè¯ï¼‰\nEPOLLPRI å¸¦å¤–æ•°æ®\n\nmuduo é‡Œé¢å°† epoll_wait çš„è¶…æ—¶äº‹ä»¶è®¾ç½®ä¸º 1 æ¯«ç§’ï¼Œæˆ‘çš„å¦ä¸€ä¸ªé¡¹ç›®å°† epoll_wait è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º 10 æ¯«ç§’ã€‚è¿™ä¸¤ä¸ªæ•°å€¼ä¾›å¤§å®¶å‚è€ƒã€‚\nè¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå·¥ä½œçº¿ç¨‹å’Œä¸»çº¿ç¨‹éƒ½æ˜¯ä¸Šæ–‡ä»£ç ä¸­çš„é€»è¾‘ï¼Œä¸»çº¿ç¨‹ç›‘å¬ä¾¦å¬socket ä¸Šçš„å¯è¯»äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯ç›‘æµ‹æ˜¯å¦æœ‰æ–°è¿æ¥æ¥äº†ã€‚ä¸»çº¿ç¨‹å’Œæ¯ä¸ªå·¥ä½œçº¿ç¨‹ä¸Šéƒ½å­˜åœ¨ä¸€ä¸ª epollfdã€‚å¦‚æœæ–°è¿æ¥æ¥äº†ï¼Œåˆ™åœ¨ä¸»çº¿ç¨‹çš„ handle_io_events() ä¸­æ¥å—æ–°è¿æ¥ã€‚äº§ç”Ÿçš„æ–°è¿æ¥çš„socketå¥æŸ„æŒ‚æ¥åˆ°å“ªä¸ªçº¿ç¨‹çš„ epollfd ä¸Šå‘¢ï¼Ÿè¿™é‡Œé‡‡å–çš„åšæ³•æ˜¯ round-robin ç®—æ³•ï¼Œå³å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ CWorkerThreadManager è®°å½•äº†å„ä¸ªå·¥ä½œçº¿ç¨‹ä¸Šå·¥ä½œçŠ¶æ€ã€‚ä¼ªç å¤§è‡´å¦‚ä¸‹ï¼š\n12345678void attach_new_fd(int newsocketfd)  &#123;      workerthread = get_next_worker_thread(next);      workerthread.attach_to_epollfd(newsocketfd);      ++next;      if (next &gt; max_worker_thread_num)          next = 0;  &#125;  \n\nå³å…ˆä»ç¬¬ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„ epollfd å¼€å§‹æŒ‚æ¥æ–°æ¥ socketï¼Œæ¥ç€ç´¯åŠ ç´¢å¼•ï¼Œè¿™æ ·ä¸‹æ¬¡å°±æ˜¯ç¬¬äºŒä¸ªå·¥ä½œçº¿ç¨‹äº†ã€‚å¦‚æœæ‰€ä»¥è¶…å‡ºå·¥ä½œçº¿ç¨‹æ•°ç›®ï¼Œåˆ™ä»ç¬¬ä¸€ä¸ªå·¥ä½œé‡æ–°å¼€å§‹ã€‚è¿™é‡Œè§£å†³äº†æ–°è¿æ¥ socket â€œè´Ÿè½½å‡è¡¡â€çš„é—®é¢˜ã€‚åœ¨å®é™…ä»£ç ä¸­è¿˜æœ‰ä¸ªéœ€è¦æ³¨æ„çš„ç»†èŠ‚å°±æ˜¯ï¼šepoll_wait çš„å‡½æ•°ä¸­çš„ struct epoll_event æ•°é‡å¼€å§‹åˆ°åº•è¦è®¾ç½®å¤šå°‘ä¸ªæ‰åˆç†ï¼Ÿå­˜åœ¨çš„é¡¾è™‘æ˜¯ï¼Œå¤šäº†æµªè´¹ï¼Œå°‘äº†ä¸å¤Ÿç”¨ï¼Œæˆ‘åœ¨æ›¾ç»ä¸€ä¸ªé¡¹ç›®ä¸­ç›´æ¥ç”¨çš„æ˜¯ 4096ï¼š\n1234const int EPOLL_MAX_EVENTS = 4096;  const int dwSelectTimeout = 10000;  struct epoll_event events[EPOLL_MAX_EVENTS];  int nfds = epoll_wait(m_fdEpoll, events, EPOLL_MAX_EVENTS, dwSelectTimeout / 1000);\n\n\næˆ‘åœ¨é™ˆç¡•çš„ muduo ç½‘ç»œåº“ä¸­å‘ç°ä½œè€…æ‰ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ€è·¯ï¼Œå³åŠ¨æ€æ‰©å¼ æ•°é‡ï¼šå¼€å§‹æ˜¯ n ä¸ªï¼Œå½“å‘ç°æœ‰äº‹ä»¶çš„ fd æ•°é‡å·²ç»åˆ°è¾¾ n ä¸ªåï¼Œå°† struct epoll_event æ•°é‡è°ƒæ•´æˆ 2n ä¸ªï¼Œä¸‹æ¬¡å¦‚æœè¿˜ä¸å¤Ÿï¼Œåˆ™å˜æˆ 4n ä¸ªï¼Œä»¥æ­¤ç±»æ¨ï¼Œä½œè€…å·§å¦™åœ°åˆ©ç”¨ stl::vector åœ¨å†…å­˜ä¸­çš„è¿ç»­æ€§æ¥å®ç°äº†è¿™ç§æ€è·¯ï¼š\n123456789101112131415//åˆå§‹åŒ–ä»£ç   std::vector&lt;struct epoll_event&gt; events_(16);  //çº¿ç¨‹å¾ªç¯é‡Œé¢çš„ä»£ç   while (m_bExit)  &#123;      int numEvents = ::epoll_wait(epollfd_, &amp;*events_.begin(), static_cast&lt;int&gt;(events_.size()), 1);      if (numEvents &gt; 0)      &#123;          if (static_cast&lt;size_t&gt;(numEvents) == events_.size())          &#123;              events_.resize(events_.size() * 2);          &#125;      &#125;  &#125;\n\nè¯»åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½è§‰å¾—å·¥ä½œçº¿ç¨‹æ‰€åšçš„å·¥ä½œä¹Ÿä¸è¿‡å°±æ˜¯è°ƒç”¨ handle_io_events() æ¥æ¥æ”¶ç½‘ç»œæ•°æ®ï¼Œå…¶å®ä¸ç„¶ï¼Œå·¥ä½œçº¿ç¨‹ä¹Ÿå¯ä»¥åšç¨‹åºä¸šåŠ¡é€»è¾‘ä¸Šçš„ä¸€äº›å·¥ä½œã€‚ä¹Ÿå°±æ˜¯åœ¨ handle_other_things() é‡Œé¢ã€‚é‚£å¦‚ä½•å°†è¿™äº›å·¥ä½œåŠ åˆ° handle_other_things() ä¸­å»åšå‘¢ï¼Ÿå†™ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä»»åŠ¡å…ˆæ”¾å…¥é˜Ÿåˆ—ï¼Œå†è®© handle_other_things() ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¥åšï¼Ÿæˆ‘åœ¨è¯¥é¡¹ç›®ä¸­ä¹Ÿå€Ÿé‰´äº†muduoåº“çš„åšæ³•ã€‚å³ handle_other_things() ä¸­è°ƒç”¨ä¸€ç³»åˆ—å‡½æ•°æŒ‡é’ˆï¼Œä¼ªç å¦‚ä¸‹ï¼š\n1234567891011121314void do_other_things()  &#123;      somefunc();  &#125;//m_functorsæ˜¯ä¸€ä¸ªstl::vector,å…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ  void somefunc()  &#123;      for (size_t i = 0; i &lt; m_functors.size(); ++i)      &#123;          m_functors[i]();      &#125;      m_functors.clear();  &#125;\n\nå½“ä»»åŠ¡äº§ç”Ÿæ—¶ï¼Œåªè¦æˆ‘ä»¬å°†æ‰§è¡Œä»»åŠ¡çš„å‡½æ•° push_back åˆ° m_functors è¿™ä¸ª stl::vector å¯¹è±¡ä¸­å³å¯ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œå¦‚æœæ˜¯å…¶ä»–çº¿ç¨‹äº§ç”Ÿçš„ä»»åŠ¡ï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œ m_functorsï¼Œå¿…ç„¶è¦åŠ é”ï¼Œè¿™ä¹Ÿä¼šå½±å“æ•ˆç‡ã€‚muduo æ˜¯è¿™æ ·åšçš„ï¼š\n12345678910111213141516171819void add_task(const Functor&amp; cb)  &#123;      std::unique_lock&lt;std::mutex&gt; lock(mutex_);      m_functors.push_back(cb);     &#125;  void do_task()  &#123;      std::vector&lt;Functor&gt; functors;      &#123;          std::unique_lock&lt;std::mutex&gt; lock(mutex_);          functors.swap(m_functors);      &#125;      for (size_t i = 0; i &lt; functors.size(); ++i)      &#123;          functors[i]();      &#125;  &#125;\n\n\nçœ‹åˆ°æ²¡æœ‰ï¼Œåˆ©ç”¨ä¸€ä¸ªæ ˆå˜é‡ functors å°† m_functors ä¸­çš„ä»»åŠ¡å‡½æ•°æŒ‡é’ˆå€’æ¢ï¼ˆswapï¼‰è¿‡æ¥äº†ï¼Œè¿™æ ·å¤§å¤§å‡å°äº†å¯¹ m_functors æ“ä½œæ—¶çš„åŠ é”ç²’åº¦ã€‚å‰åå˜åŒ–ï¼šå˜åŒ–å‰ï¼Œç›¸å½“äºåŸæ¥ A ç»™ B å¤šå°‘ä¸œè¥¿ï¼ŒB æ¶ˆè€—å¤šå°‘ï¼ŒA ç»™çš„æ—¶å€™ï¼ŒB ä¸èƒ½æ¶ˆè€—ï¼›B æ¶ˆè€—çš„æ—¶å€™Aä¸èƒ½ç»™ã€‚ç°åœ¨å˜æˆAå°†ä¸œè¥¿æ”¾åˆ°ç¯®å­é‡Œé¢å»ï¼ŒB ä»ç¯®å­é‡Œé¢æ‹¿ï¼ŒB å¦‚æœæ‹¿å»ä¸€éƒ¨åˆ†åï¼Œåªæœ‰æ¶ˆè€—å®Œäº†æ‰ä¼šæ¥æ‹¿ï¼Œæˆ–è€… A é€šçŸ¥ B å»ç¯®å­é‡Œé¢æ‹¿ï¼Œè€Œ B å¿™ç¢Œæ—¶ï¼ŒA æ˜¯ä¸ä¼šé€šçŸ¥ B æ¥æ‹¿ï¼Œè¿™ä¸ªæ—¶å€™ A åªç®¡å°†ä¸œè¥¿æ”¾åœ¨ç¯®å­é‡Œé¢å°±å¯ä»¥äº†ã€‚\n1234567891011121314151617181920212223242526272829bool bBusy = false;  void add_task(const Functor&amp; cb)  &#123;      std::unique_lock&lt;std::mutex&gt; lock(mutex_);      m_functors_.push_back(cb);      //Bä¸å¿™ç¢Œæ—¶åªç®¡å¾€ç¯®å­é‡Œé¢åŠ ï¼Œä¸è¦é€šçŸ¥B      if (!bBusy)      &#123;          wakeup_to_do_task();      &#125;  &#125;  void do_task()  &#123;      bBusy = true;      std::vector&lt;Functor&gt; functors;      &#123;          std::unique_lock&lt;std::mutex&gt; lock(mutex_);          functors.swap(pendingFunctors_);      &#125;      for (size_t i = 0; i &lt; functors.size(); ++i)      &#123;          functors[i]();      &#125;      bBusy = false;  &#125;\n\n\nçœ‹ï¼Œå¤šå·§å¦™çš„åšæ³•ï¼\nå› ä¸ºæ¯ä¸ªå·¥ä½œçº¿ç¨‹éƒ½å­˜åœ¨ä¸€ä¸ª m_functorsï¼Œç°åœ¨é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•å°†äº§ç”Ÿçš„ä»»åŠ¡å‡è¡¡åœ°åˆ†é…ç»™æ¯ä¸ªå·¥ä½œçº¿ç¨‹ã€‚è¿™ä¸ªåšæ³•ç±»ä¼¼ä¸Šæ–‡ä¸­å¦‚ä½•å°†æ–°è¿æ¥çš„ socket å¥æŸ„æŒ‚è½½åˆ°å·¥ä½œçº¿ç¨‹çš„ epollfd ä¸Šï¼Œä¹Ÿæ˜¯ round-robin ç®—æ³•ã€‚ä¸Šæ–‡å·²ç»æè¿°ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚\nè¿˜æœ‰ç§æƒ…å†µï¼Œå°±æ˜¯å¸Œæœ›ä»»åŠ¡äº§ç”Ÿæ—¶ï¼Œå·¥ä½œçº¿ç¨‹èƒ½å¤Ÿç«‹é©¬æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œè€Œä¸æ˜¯ç­‰ epoll_wait è¶…æ—¶è¿”å›ä¹‹åã€‚è¿™ä¸ªæ—¶å€™çš„åšæ³•ï¼Œå°±æ˜¯ä½¿ç”¨ä¸€äº›æŠ€å·§å”¤é†’epoll_waitï¼ŒLinux ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ socketpair æˆ– timereventã€eventfd ç­‰æŠ€å·§ã€‚\nä¸Šæ–‡ä¸­ç•™ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š\n\næ•°æ®åº“çº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—Aä¸­çš„ä»»åŠ¡ä»ä½•è€Œæ¥ï¼Œç›®å‰åªæœ‰æ¶ˆè´¹è€…ï¼Œæ²¡æœ‰ç”Ÿäº§è€…ï¼Œé‚£ä¹ˆç”Ÿäº§è€…æ˜¯è°ï¼Ÿ\næ•°æ®åº“çº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—Bä¸­çš„ä»»åŠ¡å°†å»ä½•æ–¹ï¼Œç›®å‰åªæœ‰ç”Ÿäº§è€…æ²¡æœ‰æ¶ˆè´¹è€…ã€‚\nä¸šåŠ¡å±‚çš„æ•°æ®å¦‚ä½•å‘é€å‡ºå»ï¼Ÿ\n\né—®é¢˜ 1 çš„ç­”æ¡ˆæ˜¯ï¼šä¸šåŠ¡å±‚äº§ç”Ÿä»»åŠ¡å¯èƒ½ä¼šäº¤ç»™æ•°æ®åº“ä»»åŠ¡é˜Ÿåˆ—Aï¼Œè¿™é‡Œçš„ä¸šåŠ¡å±‚ä»£ç å¯èƒ½å°±æ˜¯å·¥ä½œçº¿ç¨‹ä¸­ do_other_things() å‡½æ•°æ‰§è¡Œä½“ä¸­çš„è°ƒç”¨ã€‚è‡³äºäº¤ç»™è¿™ä¸ª 9 ä¸ªæ•°æ®åº“çº¿ç¨‹çš„å“ªä¸€ä¸ªçš„ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ ·é‡‡ç”¨äº† round-robin ç®—æ³•ã€‚æ‰€ä»¥å°±å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ CDbThreadManager æ¥ç®¡ç†è¿™ä¹ä¸ªæ•°æ®åº“çº¿ç¨‹ã€‚ä¸‹é¢çš„ä¼ªç æ˜¯å‘æ•°æ®åº“å·¥ä½œçº¿ç¨‹ä¸­åŠ å…¥ä»»åŠ¡ï¼š\n123456789bool CDbThreadManager::AddTask(IMysqlTask* poTask )  &#123;      if (m_index &gt;= m_dwThreadsCount)      &#123;          m_index = 0;      &#125;      return m_aoMysqlThreads[m_index++].AddTask(poTask);  &#125;\n\n\nåŒç†é—®é¢˜ 2 ä¸­çš„æ¶ˆè´¹è€…ä¹Ÿå¯èƒ½å°±æ˜¯ do_other_things() å‡½æ•°æ‰§è¡Œä½“ä¸­çš„è°ƒç”¨ã€‚\nç°åœ¨æ¥è¯´é—®é¢˜ 3ï¼Œä¸šåŠ¡å±‚çš„æ•°æ®äº§ç”Ÿåï¼Œç»è¿‡ TcpSession è£…åŒ…åï¼Œéœ€è¦å‘é€çš„è¯ï¼Œäº§ç”Ÿä»»åŠ¡ä¸¢ç»™å·¥ä½œçº¿ç¨‹çš„ do_other_things()ï¼Œç„¶ååœ¨ç›¸å…³çš„ Channel é‡Œé¢å‘é€ï¼Œå› ä¸ºæ²¡æœ‰ç›‘æµ‹è¯¥ socket ä¸Šçš„å¯å†™äº‹ä»¶ï¼Œæ‰€ä»¥è¯¥æ•°æ®å¯èƒ½è°ƒç”¨ send() æˆ–è€… write() æ—¶ä¼šé˜»å¡ï¼Œæ²¡å…³ç³»ï¼Œsleep() ä¸€ä¼šå„¿ï¼Œç»§ç»­å‘é€ï¼Œä¸€ç›´å°è¯•ï¼Œåˆ°æ•°æ®å‘å‡ºå»ã€‚ä¼ªç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829bool Channel::Send()  &#123;      int offset = 0;      while (true)      &#123;          int n = ::send(socketfd, buf + offset, length - offset);          if (n == -1)          &#123;              if (errno == EWOULDBLOCK)              &#123;                  ::sleep(100);                  continue;              &#125;          &#125;          //å¯¹æ–¹å…³é—­äº†socketï¼Œè¿™ç«¯å»ºè®®ä¹Ÿå…³é—­          else if (n == 0)          &#123;              close(socketfd);              return false;          &#125;          offset += n;          if (offset &gt;= length)              break;      &#125;      return true;      &#125;\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/å®ä¾‹ï¼šä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"dadb03aa4cb6e4085adc0ea3361dcdbd","title":"ã€è½¬è½½ã€‘å¿ƒè·³åŒ…æœºåˆ¶è®¾è®¡è¯¦è§£","content":"å¿ƒè·³åŒ…æœºåˆ¶è®¾è®¡è¯¦è§£å­˜åœ¨ä¸‹é¢ä¸¤ç§æƒ…å½¢ï¼š\næƒ…å½¢ä¸€ï¼šä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ä»¥åï¼Œå¦‚æœé•¿æœŸæ²¡æœ‰å’ŒæœåŠ¡å™¨æœ‰æ•°æ®æ¥å¾€ï¼Œå¯èƒ½ä¼šè¢«é˜²ç«å¢™ç¨‹åºå…³é—­è¿æ¥ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³è¦è¢«å…³é—­è¿æ¥ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªå³æ—¶é€šè®¯è½¯ä»¶ï¼Œå¦‚æœæœåŠ¡å™¨æ²¡æœ‰æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬ç¡®å®ä¸ä¼šå’ŒæœåŠ¡å™¨æœ‰ä»»ä½•æ•°æ®äº¤æ¢ï¼Œä½†æ˜¯å¦‚æœè¿æ¥è¢«å…³é—­äº†ï¼Œæœ‰æ–°æ¶ˆæ¯æ¥æ—¶ï¼Œæˆ‘ä»¬å†ä¹Ÿæ²¡æ³•æ”¶åˆ°äº†ï¼Œè¿™å°±è¿èƒŒäº†â€œå³æ—¶é€šè®¯â€çš„è®¾è®¡è¦æ±‚ã€‚\næƒ…å½¢äºŒï¼šé€šå¸¸æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¸æŸä¸ªå®¢æˆ·ç«¯ä¸€èˆ¬ä¸æ˜¯ä½äºåŒä¸€ä¸ªç½‘ç»œï¼Œå…¶ä¹‹é—´å¯èƒ½ç»è¿‡æ•°ä¸ªè·¯ç”±å™¨å’Œäº¤æ¢æœºï¼Œå¦‚æœå…¶ä¸­æŸä¸ªå¿…ç»è·¯ç”±å™¨æˆ–è€…äº¤æ¢å™¨å‡ºç°äº†æ•…éšœï¼Œå¹¶ä¸”ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ¢å¤ï¼Œå¯¼è‡´è¿™ä¹‹é—´çš„é“¾è·¯ä¸å†ç•…é€šï¼Œè€Œæ­¤æ—¶æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´ä¹Ÿæ²¡æœ‰æ•°æ®è¿›è¡Œäº¤æ¢ï¼Œç”±äº TCP è¿æ¥æ˜¯çŠ¶æ€æœºï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œæ— è®ºæ˜¯å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨éƒ½æ— æ³•æ„ŸçŸ¥ä¸å¯¹æ–¹çš„è¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œè¿™ç±»è¿æ¥æˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œæ­»é“¾â€ã€‚\næƒ…å½¢ä¸€ä¸­çš„åº”ç”¨åœºæ™¯è¦æ±‚å¿…é¡»ä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ­£å¸¸ï¼Œå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„â€œä¿æ´»â€œã€‚å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œå½“æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æœ‰æ•ˆä¸šåŠ¡æ•°æ®æ¥å¾€æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™å¯¹ç«¯å‘é€å¿ƒè·³åŒ…å³å¯å®ç°ä¿æ´»ã€‚\næƒ…å½¢äºŒä¸­çš„æ­»é“¾ï¼Œåªè¦æˆ‘ä»¬æ­¤æ—¶ä»»æ„ä¸€ç«¯ç»™å¯¹ç«¯å‘é€ä¸€ä¸ªæ•°æ®åŒ…å³å¯æ£€æµ‹é“¾è·¯æ˜¯å¦æ­£å¸¸ï¼Œè¿™ç±»æ•°æ®åŒ…æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºâ€å¿ƒè·³åŒ…â€ï¼Œè¿™ç§æ“ä½œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå¿ƒè·³æ£€æµ‹â€ã€‚é¡¾åæ€ä¹‰ï¼Œå¦‚æœä¸€ä¸ªäººæ²¡æœ‰å¿ƒè·³äº†ï¼Œå¯èƒ½å·²ç»æ­»äº¡äº†ï¼›ä¸€ä¸ªè¿æ¥é•¿æ—¶é—´æ²¡æœ‰æ­£å¸¸æ•°æ®æ¥å¾€ï¼Œä¹Ÿæ²¡æœ‰å¿ƒè·³åŒ…æ¥å¾€ï¼Œå°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªè¿æ¥å·²ç»ä¸å­˜åœ¨ï¼Œä¸ºäº†èŠ‚çº¦æœåŠ¡å™¨è¿æ¥èµ„æºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…³é—­ socketï¼Œå›æ”¶è¿æ¥èµ„æºã€‚\næ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œè®©æˆ‘å†å¼ºè°ƒä¸€ä¸‹ï¼Œå¿ƒè·³æ£€æµ‹ä¸€èˆ¬æœ‰ä¸¤ä¸ªä½œç”¨ï¼š\n\nä¿æ´»\næ£€æµ‹æ­»é“¾\n\nTCP keepalive é€‰é¡¹æ“ä½œç³»ç»Ÿçš„ TCP&#x2F;IP åè®®æ ˆå…¶å®æä¾›äº†è¿™ä¸ªçš„åŠŸèƒ½ï¼Œå³ keepalive é€‰é¡¹ã€‚åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç å¯ç”¨ä¸€ä¸ª socket çš„å¿ƒè·³æ£€æµ‹ï¼ˆå³æ¯éš”ä¸€å®šæ—¶é—´é—´éš”å‘é€ä¸€ä¸ªå¿ƒè·³æ£€æµ‹åŒ…ç»™å¯¹ç«¯ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š\n123//on æ˜¯ 1 è¡¨ç¤ºæ‰“å¼€ keepalive é€‰é¡¹ï¼Œä¸º 0 è¡¨ç¤ºå…³é—­ï¼Œ0 æ˜¯é»˜è®¤å€¼int on = 1;setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, &amp;on, sizeof(on));\n\nä½†æ˜¯ï¼Œå³ä½¿å¼€å¯äº†è¿™ä¸ªé€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹é»˜è®¤å‘é€å¿ƒè·³æ£€æµ‹æ•°æ®åŒ…çš„æ—¶é—´é—´éš”æ˜¯ 7200 ç§’ï¼ˆ2 å°æ—¶ï¼‰ï¼Œè¿™æ—¶é—´é—´éš”å®åœ¨æ˜¯å¤ªé•¿äº†ï¼Œä¸å…·æœ‰å®ç”¨æ€§ã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§ç»­è®¾ç½® keepalive ç›¸å…³çš„ä¸‰ä¸ªé€‰é¡¹æ¥æ”¹å˜è¿™ä¸ªæ—¶é—´é—´éš”ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ TCP_KEEPIDLEã€TCP_KEEPINTVL å’Œ TCP_KEEPCNTï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12345678910//å‘é€ keepalive æŠ¥æ–‡çš„æ—¶é—´é—´éš”int val = 7200;setsockopt(fd, IPPROTO_TCP, TCP_KEEPIDLE, &amp;val, sizeof(val));//ä¸¤æ¬¡é‡è¯•æŠ¥æ–‡çš„æ—¶é—´é—´éš”int interval = 75;setsockopt(fd, IPPROTO_TCP, TCP_KEEPINTVL, &amp;interval, sizeof(interval));int cnt = 9;setsockopt(fd, IPPROTO_TCP, TCP_KEEPCNT, &amp;cnt, sizeof(cnt));\n\nTCP_KEEPIDLE é€‰é¡¹è®¾ç½®äº†å‘é€ keepalive æŠ¥æ–‡çš„æ—¶é—´é—´éš”ï¼Œå‘é€æ—¶å¦‚æœå¯¹ç«¯å›å¤ ACKã€‚åˆ™æœ¬ç«¯ TCP åè®®æ ˆè®¤ä¸ºè¯¥è¿æ¥ä¾ç„¶å­˜æ´»ï¼Œç»§ç»­ç­‰ 7200 ç§’åå†å‘é€ keepalive æŠ¥æ–‡ï¼›å¦‚æœå¯¹ç«¯å›å¤ RESETï¼Œè¯´æ˜å¯¹ç«¯è¿›ç¨‹å·²ç»é‡å¯ï¼Œæœ¬ç«¯çš„åº”ç”¨ç¨‹åºåº”è¯¥å…³é—­è¯¥è¿æ¥ã€‚\nå¦‚æœå¯¹ç«¯æ²¡æœ‰ä»»ä½•å›å¤ï¼Œåˆ™æœ¬ç«¯åšé‡è¯•ï¼Œå¦‚æœé‡è¯• 9 æ¬¡ï¼ˆTCP_KEEPCNT å€¼ï¼‰ï¼ˆå‰åé‡è¯•é—´éš”ä¸º 75 ç§’ï¼ˆTCP_KEEPINTVL å€¼ï¼‰ï¼‰ä»ç„¶ä¸å¯è¾¾ï¼Œåˆ™å‘åº”ç”¨ç¨‹åºè¿”å› ETIMEOUTï¼ˆæ— ä»»ä½•åº”ç­”ï¼‰æˆ– EHOST é”™è¯¯ä¿¡æ¯ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ Linux ç³»ç»Ÿä¸Šçš„ä¸Šè¿°ä¸‰ä¸ªå€¼çš„è®¾ç½®æƒ…å†µï¼š\n1234[root@iZ238vnojlyZ ~]# sysctl -a | grep keepalivenet.ipv4.tcp_keepalive_intvl = 75net.ipv4.tcp_keepalive_probes = 9net.ipv4.tcp_keepalive_time = 7200\n\nåœ¨ Windows ç³»ç»Ÿè®¾ç½® keepalive åŠå¯¹åº”é€‰é¡¹çš„ä»£ç ç•¥æœ‰ä¸åŒï¼š\n12345678910111213//å¼€å¯ keepalive é€‰é¡¹const char on = 1;setsockopt(socket, SOL_SOCKET, SO_KEEPALIVE, (char *)&amp;on, sizeof(on);// è®¾ç½®è¶…æ—¶è¯¦ç»†ä¿¡æ¯DWORD cbBytesReturned;tcp_keepalive klive;// å¯ç”¨ä¿æ´»klive.onoff = 1;klive.keepalivetime = 7200;// é‡è¯•é—´éš”ä¸º10ç§’klive.keepaliveinterval = 1000 * 10; WSAIoctl(socket, SIO_KEEPALIVE_VALS, &amp;klive, sizeof(tcp_keepalive), NULL, 0, &amp;cbBytesReturned, NULL, NULL);\n\nåº”ç”¨å±‚çš„å¿ƒè·³åŒ…æœºåˆ¶è®¾è®¡ç”±äº keepalive é€‰é¡¹éœ€è¦ä¸ºæ¯ä¸ªè¿æ¥ä¸­çš„ socket å¼€å¯ï¼Œè¿™ä¸ä¸€å®šæ˜¯å¿…é¡»çš„ï¼Œå¯èƒ½ä¼šäº§ç”Ÿå¤§é‡æ— æ„ä¹‰çš„å¸¦å®½æµªè´¹ï¼Œä¸” keepalive é€‰é¡¹ä¸èƒ½ä¸åº”ç”¨å±‚å¾ˆå¥½åœ°äº¤äº’ï¼Œå› æ­¤ä¸€èˆ¬å®é™…çš„æœåŠ¡å¼€å‘ä¸­ï¼Œè¿˜æ˜¯å»ºè®®è¯»è€…åœ¨åº”ç”¨å±‚è®¾è®¡è‡ªå·±çš„å¿ƒè·³åŒ…æœºåˆ¶ã€‚é‚£ä¹ˆå¦‚ä½•è®¾è®¡å‘¢ï¼Ÿ\nä»æŠ€æœ¯æ¥è®²ï¼Œå¿ƒè·³åŒ…å…¶å®å°±æ˜¯ä¸€ä¸ªé¢„å…ˆè§„å®šå¥½æ ¼å¼çš„æ•°æ®åŒ…ï¼Œåœ¨ç¨‹åºä¸­å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šæ—¶å‘é€å³å¯ï¼Œè¿™æ˜¯æœ€ç®€å•çš„å®ç°æ€è·¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœé€šä¿¡çš„ä¸¤ç«¯æœ‰é¢‘ç¹çš„æ•°æ®æ¥å¾€ï¼Œæ­¤æ—¶åˆ°äº†ä¸‹ä¸€ä¸ªå‘å¿ƒè·³åŒ…çš„æ—¶é—´ç‚¹äº†ï¼Œæ­¤æ—¶å‘é€ä¸€ä¸ªå¿ƒè·³åŒ…ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªæµé‡çš„æµªè´¹ï¼Œæ—¢ç„¶é€šä¿¡åŒæ–¹ä¸æ–­æœ‰æ­£å¸¸çš„ä¸šåŠ¡æ•°æ®åŒ…æ¥å¾€ï¼Œè¿™äº›æ•°æ®åŒ…æœ¬èº«å°±å¯ä»¥èµ·åˆ°ä¿æ´»ä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æµªè´¹æµé‡å»å‘é€è¿™äº›å¿ƒè·³åŒ…å‘¢ï¼Ÿæ‰€ä»¥ï¼Œå¯¹äºç”¨äºä¿æ´»çš„å¿ƒè·³åŒ…ï¼Œæˆ‘ä»¬æœ€ä½³åšæ³•æ˜¯ï¼Œè®¾ç½®ä¸€ä¸ªä¸Šæ¬¡åŒ…æ—¶é—´ï¼Œæ¯æ¬¡æ”¶æ•°æ®å’Œå‘æ•°æ®æ—¶ï¼Œéƒ½æ›´æ–°ä¸€ä¸‹è¿™ä¸ªåŒ…æ—¶é—´ï¼Œè€Œå¿ƒè·³æ£€æµ‹è®¡æ—¶å™¨æ¯æ¬¡æ£€æµ‹æ—¶ï¼Œå°†è¿™ä¸ªåŒ…æ—¶é—´ä¸å½“å‰ç³»ç»Ÿæ—¶é—´åšä¸€ä¸ªå¯¹æ¯”ï¼Œå¦‚æœæ—¶é—´é—´éš”å¤§äºå…è®¸çš„æœ€å¤§æ—¶é—´é—´éš”ï¼ˆå®é™…å¼€å‘ä¸­æ ¹æ®éœ€æ±‚è®¾ç½®æˆ 15 ~ 45 ç§’ä¸ç­‰ï¼‰ï¼Œåˆ™å‘é€ä¸€æ¬¡å¿ƒè·³åŒ…ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå°±æ˜¯åœ¨ä¸å¯¹ç«¯ä¹‹é—´ï¼Œæ²¡æœ‰æ•°æ®æ¥å¾€è¾¾åˆ°ä¸€å®šæ—¶é—´é—´éš”æ—¶æ‰å‘é€ä¸€æ¬¡å¿ƒè·³åŒ…ã€‚\nå‘å¿ƒè·³åŒ…çš„ä¼ªç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132bool CIUSocket::Send()&#123;    int nSentBytes = 0;    int nRet = 0;    while (true)    &#123;        nRet = ::send(m_hSocket, m_strSendBuf.c_str(), m_strSendBuf.length(), 0);        if (nRet == SOCKET_ERROR)        &#123;            if (::WSAGetLastError() == WSAEWOULDBLOCK)                break;            else            &#123;                LOG_ERROR(&quot;Send data error, disconnect server:%s, port:%d.&quot;, m_strServer.c_str(), m_nPort);                Close();                return false;            &#125;        &#125;        else if (nRet &lt; 1)        &#123;            //ä¸€æ—¦å‡ºç°é”™è¯¯å°±ç«‹åˆ»å…³é—­Socket            LOG_ERROR(&quot;Send data error, disconnect server:%s, port:%d.&quot;, m_strServer.c_str(), m_nPort);            Close();            return false;        &#125;        m_strSendBuf.erase(0, nRet);        if (m_strSendBuf.empty())            break;        ::Sleep(1);    &#125;    &#123;        //è®°å½•ä¸€ä¸‹æœ€è¿‘ä¸€æ¬¡å‘åŒ…æ—¶é—´        std::lock_guard&lt;std::mutex&gt; guard(m_mutexLastDataTime);        m_nLastDataTime = (long)time(NULL);    &#125;    return true;&#125;bool CIUSocket::Recv()&#123;    int nRet = 0;    char buff[10 * 1024];    while (true)    &#123;        nRet = ::recv(m_hSocket, buff, 10 * 1024, 0);        if (nRet == SOCKET_ERROR)                //ä¸€æ—¦å‡ºç°é”™è¯¯å°±ç«‹åˆ»å…³é—­Socket        &#123;            if (::WSAGetLastError() == WSAEWOULDBLOCK)                break;            else            &#123;                LOG_ERROR(&quot;Recv data error, errorNO=%d.&quot;, ::WSAGetLastError());                //Close();                return false;            &#125;        &#125;        else if (nRet &lt; 1)        &#123;            LOG_ERROR(&quot;Recv data error, errorNO=%d.&quot;, ::WSAGetLastError());            //Close();            return false;        &#125;        m_strRecvBuf.append(buff, nRet);        ::Sleep(1);    &#125;    &#123;        std::lock_guard&lt;std::mutex&gt; guard(m_mutexLastDataTime);        //è®°å½•ä¸€ä¸‹æœ€è¿‘ä¸€æ¬¡æ”¶åŒ…æ—¶é—´        m_nLastDataTime = (long)time(NULL);    &#125;    return true;&#125;void CIUSocket::RecvThreadProc()&#123;    LOG_INFO(&quot;Recv data thread start...&quot;);    int nRet;    //ä¸Šç½‘æ–¹å¼     DWORD   dwFlags;    BOOL    bAlive;    while (!m_bStop)    &#123;        //æ£€æµ‹åˆ°æ•°æ®åˆ™æ”¶æ•°æ®        nRet = CheckReceivedData();        //å‡ºé”™        if (nRet == -1)        &#123;            m_pRecvMsgThread-&gt;NotifyNetError();        &#125;        //æ— æ•°æ®        else if (nRet == 0)        &#123;                       long nLastDataTime = 0;            &#123;                std::lock_guard&lt;std::mutex&gt; guard(m_mutexLastDataTime);                nLastDataTime = m_nLastDataTime;            &#125;            if (m_nHeartbeatInterval &gt; 0)            &#123;                //å½“å‰ç³»ç»Ÿæ—¶é—´ä¸ä¸Šä¸€æ¬¡æ”¶å‘æ•°æ®åŒ…çš„æ—¶é—´é—´éš”è¶…è¿‡äº†m_nHeartbeatInterval                //åˆ™å‘ä¸€æ¬¡å¿ƒè·³åŒ…                if (time(NULL) - nLastDataTime &gt;= m_nHeartbeatInterval)                    SendHeartbeatPackage();            &#125;        &#125;        //æœ‰æ•°æ®        else if (nRet == 1)        &#123;            if (!Recv())            &#123;                m_pRecvMsgThread-&gt;NotifyNetError();                continue;            &#125;            DecodePackages();        &#125;// end if    &#125;// end while-loop    LOG_INFO(&quot;Recv data thread finish...&quot;);&#125;\n\nåŒç†ï¼Œæ£€æµ‹å¿ƒè·³åŒ…çš„ä¸€ç«¯ï¼Œåº”è¯¥æ˜¯åœ¨ä¸å¯¹ç«¯æ²¡æœ‰æ•°æ®æ¥å¾€è¾¾åˆ°ä¸€å®šæ—¶é—´é—´éš”æ—¶æ‰åšä¸€æ¬¡å¿ƒè·³æ£€æµ‹ã€‚\nå¿ƒè·³æ£€æµ‹ä¸€ç«¯çš„ä¼ªç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465void BusinessSession::send(const char* pData, int dataLength)&#123;    bool sent = TcpSession::send(pData, dataLength);    //å‘é€å®Œæ•°æ®æ›´æ–°ä¸‹å‘åŒ…æ—¶é—´    updateHeartbeatTime();      &#125;void BusinessSession::handlePackge(char* pMsg, int msgLength, bool&amp; closeSession, std::vector&lt;std::string&gt;&amp; vectorResponse)&#123;    //å¯¹æ•°æ®åˆæ³•æ€§è¿›è¡Œæ ¡éªŒ    if (pMsg == NULL || pMsg[0] == 0 || msgLength &lt;= 0 || msgLength &gt; MAX_DATA_LENGTH)    &#123;        //éæ³•åˆºæ¢è¯·æ±‚ï¼Œä¸åšä»»ä½•åº”ç­”ï¼Œç›´æ¥å…³é—­è¿æ¥        closeSession = true;        return;    &#125;    //æ›´æ–°ä¸‹æ”¶åŒ…æ—¶é—´    updateHeartbeatTime();    //çœç•¥åŒ…å¤„ç†ä»£ç ...&#125;void BusinessSession::updateHeartbeatTime()&#123;    std::lock_guard&lt;std::mutex&gt; scoped_guard(m_mutexForlastPackageTime);    m_lastPackageTime = (int64_t)time(nullptr);&#125;bool BusinessSession::doHeartbeatCheck()&#123;    const Config&amp; cfg = Singleton&lt;Config&gt;::Instance();    int64_t now = (int64_t)time(nullptr);    std::lock_guard&lt;std::mutex&gt; lock_guard(m_mutexForlastPackageTime);    if (now - m_lastPackageTime &gt;= cfg.m_nMaxClientDataInterval)    &#123;        //å¿ƒè·³åŒ…æ£€æµ‹ï¼Œè¶…æ—¶ï¼Œå…³é—­è¿æ¥        LOGE(&quot;heartbeat expired, close session&quot;);        shutdown();        return true;    &#125;    return false;&#125;void TcpServer::checkSessionHeartbeat()&#123;    int64_t now = (int64_t)time(nullptr);    if (now - m_nLastCheckHeartbeatTime &gt;= m_nHeartbeatCheckInterval)    &#123;        m_spSessionManager-&gt;checkSessionHeartbeat();        m_nLastCheckHeartbeatTime = (int64_t)time(nullptr);    &#125;      &#125;void SessionManager::checkSessionHeartbeat()&#123;       std::lock_guard&lt;std::mutex&gt; scoped_lock(m_mutexForSession);    for (const auto&amp; iter : m_mapSessions)    &#123;        //è¿™é‡Œè°ƒç”¨ BusinessSession::doHeartbeatCheck()        iter.second-&gt;doHeartbeatCheck();    &#125;  &#125;\n\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸€èˆ¬æ˜¯å®¢æˆ·ç«¯ä¸»åŠ¨ç»™æœåŠ¡å™¨ç«¯å‘é€å¿ƒè·³åŒ…ï¼ŒæœåŠ¡å™¨ç«¯åšå¿ƒè·³æ£€æµ‹å†³å®šæ˜¯å¦æ–­å¼€è¿æ¥ã€‚è€Œä¸æ˜¯åè¿‡æ¥ï¼Œä»å®¢æˆ·ç«¯çš„è§’åº¦æ¥è¯´ï¼Œå®¢æˆ·ç«¯ä¸ºäº†è®©è‡ªå·±å¾—åˆ°æœåŠ¡å™¨ç«¯çš„æ­£å¸¸æœåŠ¡æœ‰å¿…è¦ä¸»åŠ¨å’ŒæœåŠ¡å™¨ä¿æŒè¿æ¥çŠ¶æ€æ­£å¸¸ï¼Œè€ŒæœåŠ¡å™¨ç«¯ä¸ä¼šå±€é™äºæŸä¸ªç‰¹å®šçš„å®¢æˆ·ç«¯ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¸èƒ½ä¸»åŠ¨å’Œå…¶ä¿æŒè¿æ¥ï¼Œé‚£ä¹ˆå°±ä¼šä¸»åŠ¨å›æ”¶ä¸è¯¥å®¢æˆ·ç«¯çš„è¿æ¥ã€‚å½“ç„¶ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ°å®¢æˆ·ç«¯çš„å¿ƒè·³åŒ…æ—¶åº”è¯¥ç»™å®¢æˆ·ç«¯ä¸€ä¸ªå¿ƒè·³åº”ç­”ã€‚\n\nå¸¦ä¸šåŠ¡æ•°æ®çš„å¿ƒè·³åŒ…ä¸Šé¢ä»‹ç»çš„å¿ƒè·³åŒ…æ˜¯ä»çº¯æŠ€æœ¯çš„è§’åº¦æ¥è¯´çš„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å®šæ—¶æˆ–è€…ä¸å®šæ—¶ä»æœåŠ¡å™¨ç«¯æ›´æ–°ä¸€äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ç±»æ•°æ®æ”¾åœ¨å¿ƒè·³åŒ…ä¸­ï¼Œå®šæ—¶æˆ–è€…ä¸å®šæ—¶æ›´æ–°ã€‚\nè¿™ç±»å¸¦ä¸šåŠ¡æ•°æ®çš„å¿ƒè·³åŒ…ï¼Œå°±ä¸å†æ˜¯çº¯ç²¹æŠ€æœ¯ä¸Šçš„ä½œç”¨äº†ï¼ˆè¿™é‡Œè¯´çš„æŠ€æœ¯çš„ä½œç”¨æŒ‡çš„ä¸Šæ–‡ä¸­ä»‹ç»çš„å¿ƒè·³åŒ…èµ·ä¿æ´»å’Œæ£€æµ‹æ­»é“¾ä½œç”¨ï¼‰ã€‚\nè¿™ç±»å¿ƒè·³åŒ…å®ç°ä¹Ÿå¾ˆå®¹æ˜“ï¼Œå³åœ¨å¿ƒè·³åŒ…æ•°æ®ç»“æ„é‡Œé¢åŠ ä¸Šéœ€è¦çš„ä¸šåŠ¡å­—æ®µä¿¡æ¯ï¼Œç„¶ååœ¨å®šæ—¶å™¨ä¸­å®šæ—¶å‘é€ï¼Œå®¢æˆ·ç«¯å‘ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨åœ¨åº”ç­”å¿ƒè·³åŒ…ä¸­å¡«ä¸Šçº¦å®šçš„ä¸šåŠ¡æ•°æ®ä¿¡æ¯å³å¯ã€‚\nå¿ƒè·³åŒ…ä¸æµé‡é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤šæ•°åº”ç”¨åœºæ™¯ä¸‹ï¼Œä¸æœåŠ¡å™¨ç«¯ä¿æŒè¿æ¥çš„å¤šä¸ªå®¢æˆ·ç«¯ä¸­ï¼ŒåŒä¸€æ—¶é—´æ®µæ´»è·ƒç”¨æˆ·ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯ä¸æœåŠ¡å™¨æœ‰é¢‘ç¹æ•°æ®æ¥å¾€çš„å®¢æˆ·ç«¯ï¼‰ä¸€èˆ¬ä¸ä¼šå¤ªå¤šã€‚å½“è¿æ¥æ•°è¾ƒå¤šæ—¶ï¼Œè¿›å‡ºæœåŠ¡å™¨ç¨‹åºçš„æ•°æ®åŒ…é€šå¸¸éƒ½æ˜¯å¿ƒè·³åŒ…ï¼ˆä¸ºäº†ä¿æ´»ï¼‰ã€‚æ‰€ä»¥ä¸ºäº†å‡è½»ç½‘ç»œä»£ç å‹åŠ›ï¼ŒèŠ‚çœæµé‡ï¼Œå°¤å…¶æ˜¯é’ˆå¯¹ä¸€äº› 3&#x2F;4 G æ‰‹æœºåº”ç”¨ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡å¿ƒè·³åŒ…æ•°æ®æ ¼å¼æ—¶åº”è¯¥å°½é‡å‡å°å¿ƒè·³åŒ…çš„æ•°æ®å¤§å°ã€‚\nå¿ƒè·³åŒ…ä¸è°ƒè¯•å¦‚å‰æ–‡æ‰€è¿°ï¼Œå¯¹äºå¿ƒè·³åŒ…ï¼ŒæœåŠ¡å™¨ç«¯çš„é€»è¾‘ä¸€èˆ¬æ˜¯åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯å¿ƒè·³åŒ…æ—¶ä¼šä¸»åŠ¨æ–­å¼€è¿æ¥ã€‚åœ¨æˆ‘ä»¬å¼€å‘è°ƒè¯•ç¨‹åºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†ç¨‹åºé€šè¿‡æ–­ç‚¹ä¸­æ–­ä¸‹æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½æ˜¯å‡ ç§’åˆ°å‡ åç§’ä¸ç­‰ã€‚ç­‰ç¨‹åºæ¢å¤æ‰§è¡Œæ—¶ï¼Œè¿æ¥å¯èƒ½å› ä¸ºå¿ƒè·³æ£€æµ‹é€»è¾‘å·²ç»è¢«æ–­å¼€ã€‚\nè°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ›´å¤šçš„å…³æ³¨çš„æ˜¯ä¸šåŠ¡æ•°æ®å¤„ç†çš„é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œä¸æƒ³è¢«ä¸€å †æ— æ„ä¹‰çš„å¿ƒè·³åŒ…æ•°æ®å¹²æ‰°å®çº¿ã€‚\né‰´äºä»¥ä¸Šä¸¤ç‚¹åŸå› ï¼Œæˆ‘ä»¬ä¸€èˆ¬åœ¨è°ƒè¯•æ¨¡å¼ä¸‹å…³é—­æˆ–è€…ç¦ç”¨å¿ƒè·³åŒ…æ£€æµ‹æœºåˆ¶ã€‚ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š\n1234567891011121314ChatSession::ChatSession(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn, int sessionid) :TcpSession(conn), m_id(sessionid),m_seq(0),m_isLogin(false)&#123;    m_userinfo.userid = 0;    m_lastPackageTime = time(NULL);//è¿™é‡Œè®¾ç½®äº†éè°ƒè¯•æ¨¡å¼ä¸‹æ‰å¼€å¯å¿ƒè·³åŒ…æ£€æµ‹åŠŸèƒ½#ifndef _DEBUG    EnableHearbeatCheck();#endif&#125;\n\nå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å°†å¼€å¯å¿ƒè·³æ£€æµ‹çš„å¼€å…³åšæˆé…ç½®ä¿¡æ¯æ”¾å…¥ç¨‹åºé…ç½®æ–‡ä»¶ä¸­ã€‚\nå¿ƒè·³åŒ…ä¸æ—¥å¿—å®é™…ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå°†ç¨‹åºæ”¶åˆ°çš„å’Œå‘å‡ºå»çš„æ•°æ®åŒ…å†™å…¥æ—¥å¿—ä¸­ï¼Œä½†æ˜¯æ— ä¸šåŠ¡ä¿¡æ¯çš„å¿ƒè·³åŒ…ä¿¡æ¯æ˜¯ä¸ªä¾‹å¤–ï¼Œä¸€èˆ¬ä¼šåˆ»æ„ä¸å†™å…¥æ—¥å¿—ï¼Œè¿™æ˜¯å› ä¸ºå¿ƒè·³åŒ…æ•°æ®ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œå¦‚æœå†™å…¥æ—¥å¿—ä¼šå¯¼è‡´æ—¥å¿—æ–‡ä»¶å˜å¾—å¾ˆå¤§ï¼Œä¸”å……æ–¥å¤§é‡æ— æ„ä¹‰çš„å¿ƒè·³åŒ…æ—¥å¿—ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨å†™æ—¥å¿—æ—¶ä¼šå±è”½å¿ƒè·³åŒ…ä¿¡æ¯å†™å…¥ã€‚\næˆ‘è¿™é‡Œçš„å»ºè®®æ˜¯ï¼Œå¯ä»¥å°†å¿ƒè·³åŒ…ä¿¡æ¯æ˜¯å¦å†™å…¥æ—¥å¿—åšæˆä¸€ä¸ªé…ç½®å¼€å…³ï¼Œä¸€èˆ¬å¤„äºå…³é—­çŠ¶æ€ï¼Œæœ‰éœ€è¦æ—¶å†å¼€å¯ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ª WebSocket æœåŠ¡ï¼Œping å’Œ pong æ˜¯å¿ƒè·³åŒ…æ•°æ®ï¼Œä¸‹é¢ç¤ºä¾‹ä»£ç æŒ‰éœ€è¾“å‡ºå¿ƒè·³æ—¥å¿—ä¿¡æ¯ï¼š\n12345678910111213141516void BusinessSession::send(std::string_view strResponse)&#123;       bool success = WebSocketSession::send(strResponse);    if (success)    &#123;        bool enablePingPongLog = Singleton&lt;Config&gt;::Instance().m_bPingPongLogEnabled;        //å…¶ä»–æ¶ˆæ¯æ­£å¸¸æ‰“å°ï¼Œå¿ƒè·³æ¶ˆæ¯æŒ‰éœ€æ‰“å°        if (strResponse != &quot;pong&quot; || enablePingPongLog)        &#123;            LOGI(&quot;msg sent to client [%s], sessionId: %s, session: 0x%0x, clientId: %s, accountId: %s, frontId: %s, msg: %s&quot;,                 getClientInfo(), m_strSessionId.c_str(), (int64_t)this, m_strClientID.c_str(), m_strAccountID.c_str(), BusinessSession::m_strFrontId.c_str(), strResponse.data());        &#125;    &#125;&#125;\n\néœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä»¥ä¸Šç¤ºä¾‹ä»£ç ä½¿ç”¨ C&#x2F;C++ è¯­è¨€ç¼–å†™ï¼Œä½†æ˜¯æœ¬èŠ‚ä»‹ç»çš„å¿ƒè·³åŒ…æœºåˆ¶è®¾è®¡æ€è·¯å’Œæ³¨æ„äº‹é¡¹æ˜¯æ™®é€‚æ€§åŸç†ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–ç¼–ç¨‹è¯­è¨€ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/å¿ƒè·³åŒ…æœºåˆ¶è®¾è®¡è¯¦è§£","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"ce0a6a8a156c3a000bce90a0bc7659bd","title":"ã€è½¬è½½ã€‘æ—¥å¿—ç³»ç»Ÿçš„è®¾è®¡","content":"æ—¥å¿—ç³»ç»Ÿçš„è®¾è®¡ä¸ºä»€ä¹ˆéœ€è¦æ—¥å¿—å®é™…çš„è½¯ä»¶é¡¹ç›®äº§å‡ºéƒ½æœ‰ä¸€ä¸ªæµç¨‹ï¼Œå³å…ˆå¼€å‘ã€æµ‹è¯•ï¼Œå†å‘å¸ƒç”Ÿäº§ï¼Œç”±äºäººçš„å› ç´ ï¼Œæ—¢ç„¶æ˜¯è½¯ä»¶äº§å“å°±ä¸å¯èƒ½ç™¾åˆ†ç™¾æ²¡æœ‰ bug æˆ–è€…é€»è¾‘é”™è¯¯ï¼Œå¯¹äºå·²ç»å‘å¸ƒåˆ°ç”Ÿäº§çš„é¡¹ç›®ï¼Œä¸€æ—¦æŸä¸ªæ—¶åˆ»äº§ç”Ÿéé¢„æœŸçš„ç»“æœï¼Œæˆ‘ä»¬å°±éœ€è¦å»å®šä½å’Œæ’æŸ¥é—®é¢˜ã€‚ä½†æ˜¯ä¸€èˆ¬æ­£å¼çš„ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡å™¨æˆ–è€…äº§å“æ˜¯ä¸å…è®¸å¼€å‘äººå‘˜é€šè¿‡é™„åŠ è°ƒè¯•å™¨å»æ’æŸ¥é—®é¢˜çš„ï¼Œä¸»è¦æœ‰å¦‚ä¸‹å¯èƒ½åŸå› ï¼š\n\nåœ¨å¾ˆå¤šäº’è”ç½‘ä¼ä¸šï¼Œå¼€å‘éƒ¨é—¨ã€æµ‹è¯•éƒ¨åˆ†å’Œäº§å“è¿ç»´éƒ¨é—¨æ˜¯åˆ†å·¥æ˜ç¡®çš„ï¼Œè½¯ä»¶äº§å“ä¸€æ—¦å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒä»¥åï¼Œå°†å…¨éƒ¨äº¤ç”±è¿ç»´éƒ¨é—¨äººå‘˜å»ç®¡ç†å’Œç»´æŠ¤ï¼Œè€ŒåŸæ¥å¼€å‘æ­¤äº§å“çš„å¼€å‘äººå‘˜ä¸å†æ‹¥æœ‰ç›¸å…³çš„æ“ä½œç¨‹åºçš„æƒé™ã€‚\nå¯¹äºå·²ç»ä¸Šäº†ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡ï¼Œå…¶æ•°æ®å’Œç¨‹åºç¨³å®šæ€§æ˜¯å…¬å¸çš„æ ¸å¿ƒäº§å€¼æ‰€åœ¨ï¼Œä¸€èˆ¬ä¸æ•¢æˆ–ä¸å…è®¸è¢«å¼€å‘äººå‘˜éšæ„è°ƒè¯•æˆ–è€…æ“ä½œï¼Œä»¥å…é€ æˆæŸå¤±ã€‚\nå‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡ï¼Œä¸€èˆ¬ä¸ºäº†è®©ç¨‹åºæ‰§è¡Œæ•ˆç‡æ›´é«˜ã€æ–‡ä»¶ä½“ç§¯æ›´å°ï¼Œéƒ½æ˜¯å»æ‰è°ƒè¯•ç¬¦å·åçš„ç‰ˆæœ¬ï¼Œä¸æ–¹ä¾¿ä¹Ÿä¸åˆ©äºè°ƒè¯•ã€‚\n\næ—¢ç„¶æˆ‘ä»¬æ— æ³•é€šè¿‡è°ƒè¯•å™¨å»è°ƒè¯•ï¼Œè¿™ä¸ªæ—¶å€™ä¸ºäº†è·Ÿè¸ªå’Œå›å¿†å½“æ—¶çš„ç¨‹åºè¡Œä¸ºè¿›è€Œå®šä½é—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦æ—¥å¿—ç³»ç»Ÿã€‚\né€€ä¸€æ­¥è¯´ï¼Œå³ä½¿åœ¨å¼€å‘æˆ–è€…æµ‹è¯•ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç¨‹åºé™„åŠ åˆ°è°ƒè¯•å™¨ä¸Šå»è°ƒè¯•ï¼Œä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šçš„ç¨‹åºè¡Œä¸ºï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡è®¾ç½®æ–­ç‚¹ï¼Œè®©ç¨‹åºåœ¨æŸä¸ªæ—¶åˆ»æš‚åœä¸‹æ¥è¿›è¡Œè°ƒè¯•ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæŸäº›ç½‘ç»œé€šä¿¡åŠŸèƒ½ï¼Œå¦‚æœæš‚åœæ—¶é—´è¿‡é•¿ï¼ˆç›¸å¯¹äºæŸäº›ç¨‹åºé€»è¾‘æ¥è¯´ï¼‰ï¼Œé€šä¿¡çš„å¯¹ç«¯å¯èƒ½ç”±äºå½¼ç«¯æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å“åº”è€Œæ–­å¼€è¿æ¥ï¼Œå¯¼è‡´ç¨‹åºé€»è¾‘æ— æ³•è¿›å…¥æˆ‘ä»¬æƒ³è¦çš„æ‰§è¡Œæµä¸­å»ï¼›å†ä¾‹å¦‚ï¼Œå¯¹äºä¸€äº›é«˜é¢‘æ“ä½œï¼ˆå¦‚å¿ƒè·³åŒ…ã€å®šæ—¶å™¨ã€ç•Œé¢ç»˜åˆ¶ä¸‹çš„æŸäº›é«˜é¢‘é‡å¤è¡Œä¸ºï¼‰ï¼Œå¯èƒ½åœ¨å°‘é‡æ¬¡æ•°ä¸‹æ— æ³•è§¦å‘æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºï¼Œè€Œé€šè¿‡æ–­ç‚¹çš„æš‚åœæ–¹å¼ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡å¤æ“ä½œå‡ åæ¬¡ã€ä¸Šç™¾æ¬¡ç”šè‡³æ›´å¤šï¼Œè¿™æ ·æ’æŸ¥é—®é¢˜æ•ˆç‡æ˜¯éå¸¸ä½ä¸‹çš„ã€‚å¯¹äºè¿™ç±»æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰“å°æ—¥å¿—ï¼Œå°†å½“æ—¶çš„ç¨‹åºè¡Œä¸ºä¸Šä¸‹æ–‡ç°åœºè®°å½•ä¸‹æ¥ï¼Œç„¶åä»æ—¥å¿—ç³»ç»Ÿä¸­æ‰¾åˆ°æŸæ¬¡ä¸æ­£å¸¸çš„è¡Œä¸ºçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚è¿™ä¹Ÿæ˜¯æ—¥å¿—çš„å¦å¤–ä¸€ä¸ªä½œç”¨ã€‚\næœ¬æ–‡å°†ä»æŠ€æœ¯å’Œä¸šåŠ¡ä¸Šä¸¤ä¸ªæ–¹é¢æ¥ä»‹ç»æ—¥å¿—ç³»ç»Ÿç›¸å…³çš„è®¾è®¡ä¸å¼€å‘ï¼Œæ‰€è°“æŠ€æœ¯ä¸Šï¼Œå°±æ˜¯å¦‚ä½•ä»ç¨‹åºå¼€å‘çš„è§’åº¦è®¾è®¡ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§ã€æ€§èƒ½ä¼˜è¶Šã€ä½¿ç”¨æ–¹ä¾¿çš„æ—¥å¿—ç³»ç»Ÿï¼›è€Œä¸šåŠ¡ä¸Šï¼Œæ˜¯æŒ‡æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿæ—¶ï¼Œåº”è¯¥å»è®°å½•å“ªäº›è¡Œä¸ºå’Œæ•°æ®ï¼Œæ—¢ç®€æ´ã€ä¸å•°å—¦ï¼Œåˆæ–¹ä¾¿éœ€è¦æ—¶å¿«é€Ÿå‡†ç¡®åœ°å®šä½åˆ°é—®é¢˜ã€‚\næ—¥å¿—ç³»ç»Ÿçš„æŠ€æœ¯ä¸Šçš„å®ç°æ—¥å¿—çš„æœ€åˆçš„åŸå‹å³å°†ç¨‹åºè¿è¡Œçš„çŠ¶æ€æ‰“å°å‡ºæ¥ï¼Œå¯¹äº C&#x2F;C++ è¿™é—¨è¯­è¨€æ¥è¯´ï¼Œå³å¯ä»¥åˆ©ç”¨ printfã€std::cout ç­‰æ§åˆ¶å°è¾“å‡ºå‡½æ•°ï¼Œå°†æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œè¿™ç±»ç®€å•çš„æƒ…å½¢æˆ‘ä»¬ä¸åœ¨æ­¤è¿‡å¤šèµ˜è¿°ã€‚\nå¯¹äºå•†ä¸šé¡¹ç›®ï¼Œä¸ºäº†æ–¹ä¾¿æ’æŸ¥é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸å°†æ—¥å¿—å†™åˆ°æ§åˆ¶å°ï¼Œè€Œæ˜¯è¾“å‡ºåˆ°æ–‡ä»¶æˆ–è€…æ•°æ®åº“ç³»ç»Ÿã€‚ä¸ç®¡å“ªä¸€ç§ï¼Œå…¶æ€è·¯åŸºæœ¬ä¸Šä¸€è‡´ï¼Œæˆ‘ä»¬è¿™é‡Œä»¥å†™æ–‡ä»¶ä¸ºä¾‹æ¥è¯¦ç»†ä»‹ç»ã€‚\nåŒæ­¥å†™æ—¥å¿—æ‰€è°“åŒæ­¥å†™æ—¥å¿—ï¼ŒæŒ‡çš„æ˜¯åœ¨è¾“å‡ºæ—¥å¿—çš„åœ°æ–¹ï¼Œå°†æ—¥å¿—å³æ—¶å†™å…¥åˆ°æ–‡ä»¶ä¸­å»ã€‚æ ¹æ®ç¬”è€…çš„ç»éªŒï¼Œè¿™ç§è®¾è®¡å¹¿æ³›åœ°ç”¨äºç›¸å½“å¤šçš„çš„å®¢æˆ·ç«¯è½¯ä»¶ã€‚ç¬”è€…æ›¾ä»äº‹è¿‡æ•°å¹´çš„å®¢æˆ·ç«¯å¼€å‘ï¼ˆåŒ…æ‹¬ PCã€å®‰å“è½¯ä»¶ï¼‰ï¼Œè®¾è®¡è¿‡ä¸€äº›åŠŸèƒ½å¤æ‚çš„é‡‘èå®¢æˆ·ç«¯äº§å“ï¼Œåœ¨è¿™äº›ç³»ç»Ÿä¸­é‡‡ç”¨çš„å°±æ˜¯è¿™ç§åŒæ­¥å†™æ—¥å¿—çš„æ–¹å¼ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼å…¶ä¸»è¦åŸå› å°±æ˜¯è®¾è®¡ç®€å•ï¼Œè€Œåˆä¸ä¼šå½±å“ç”¨æˆ·ä½¿ç”¨ä½“éªŒã€‚è¯´åˆ°è¿™é‡Œè¯»è€…å¯èƒ½æœ‰è¿™æ ·ä¸€ä¸ªç–‘é—®ï¼šä¸€èˆ¬çš„å®¢æˆ·ç«¯è½¯ä»¶ï¼Œä¸€èˆ¬å­˜åœ¨ç•Œé¢ï¼Œè€Œç•Œé¢éƒ¨åˆ†æ‰€å±çš„é€»è¾‘å°±æ˜¯ç¨‹åºçš„ä¸»çº¿ç¨‹ï¼Œå¦‚æœé‡‡å–è¿™ç§åŒæ­¥å†™æ—¥å¿—çš„æ–¹å¼ï¼Œå½“å†™æ—¥å¿—æ—¶ï¼Œå†™æ–‡ä»¶æ˜¯ç£ç›˜ IO æ“ä½œï¼Œç›¸æ¯”è¾ƒç¨‹åºå…¶ä»–éƒ¨åˆ†æ˜¯ CPU æ“ä½œï¼Œå‰è€…è¦æ…¢å¾ˆå¤šï¼Œè¿™æ ·åŠ¿å¿…é€ æˆCPUç­‰å¾…ï¼Œè¿›è€Œå¯¼è‡´ä¸»çº¿ç¨‹â€œå¡â€åœ¨å†™æ–‡ä»¶å¤„ï¼Œè¿›è€Œé€ æˆç•Œé¢å¡é¡¿ï¼Œä»è€Œå¯¼è‡´ç”¨æˆ·ä½¿ç”¨è½¯ä»¶çš„ä½“éªŒä¸å¥½ã€‚è¯»è€…çš„è¿™ç§é¡¾è™‘ç¡®å®æ˜¯å­˜åœ¨çš„ã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒè¿™ç§é—®é¢˜ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š\n\nå¯¹äºå®¢æˆ·ç«¯ç¨‹åºï¼Œå³ä½¿åœ¨ä¸»çº¿ç¨‹ï¼ˆUI çº¿ç¨‹ï¼‰ä¸­åŒæ­¥å†™æ–‡ä»¶ï¼Œå…¶å•æ¬¡æˆ–è€…å‡ æ¬¡ç£ç›˜æ“ä½œç´¯åŠ æ—¶é—´ï¼Œä¸äººï¼ˆç”¨æˆ·ï¼‰çš„å¯æ„ŸçŸ¥æ—¶é—´ç›¸æ¯”ï¼Œä¹Ÿæ˜¯éå¸¸å°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·æ ¹æœ¬æ„Ÿè§‰ä¸åˆ°è¿™ç§åŒæ­¥å†™æ–‡ä»¶é€ æˆçš„å»¶è¿Ÿã€‚å½“ç„¶ï¼Œè¿™é‡Œä¹Ÿç»™æ‚¨ä¸€ä¸ªæé†’å°±æ˜¯ï¼Œå¦‚æœåœ¨ UI çº¿ç¨‹é‡Œé¢å†™æ—¥å¿—ï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›é«˜é¢‘æ“ä½œä¸­ï¼ˆå¦‚ Windows çš„ç•Œé¢ç»˜åˆ¶æ¶ˆæ¯ WM_PAINT å¤„ç†é€»è¾‘ä¸­ï¼‰ï¼Œä¸€å®šè¦æ§åˆ¶å†™æ—¥å¿—çš„é•¿åº¦å’Œæ¬¡æ•°ï¼Œå¦åˆ™å°±ä¼šå› é¢‘ç¹å†™æ–‡ä»¶æˆ–ä¸€æ¬¡å†™å…¥æ•°æ®è¿‡å¤§è€Œå¯¹ç•Œé¢é€ æˆå¡é¡¿ã€‚\nå®¢æˆ·ç«¯ç¨‹åºé™¤äº† UI çº¿ç¨‹ï¼Œè¿˜æœ‰å…¶ä»–ä¸ç•Œé¢æ— å…³çš„å·¥ä½œçº¿ç¨‹ï¼Œåœ¨è¿™äº›çº¿ç¨‹ä¸­ç›´æ¥å†™æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸ä¼šå¯¹ç”¨æˆ·çš„ä½“éªŒäº§ç”Ÿä»€ä¹ˆå½±å“ã€‚\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚\næ—¥å¿—ç±»çš„ .h æ–‡ä»¶\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** *@desc:   IULog.h *@author: zhangyl *@date:   2014.12.25 */#ifndef __LOG_H__#define __LOG_H__enum LOG_LEVEL&#123;    LOG_LEVEL_INFO,    LOG_LEVEL_WARNING,    LOG_LEVEL_ERROR&#125;;//æ³¨æ„ï¼šå¦‚æœæ‰“å°çš„æ—¥å¿—ä¿¡æ¯ä¸­æœ‰ä¸­æ–‡ï¼Œåˆ™æ ¼å¼åŒ–å­—ç¬¦ä¸²è¦ç”¨_T()å®åŒ…è£¹èµ·æ¥ï¼Œ#define LOG_INFO(...)     CIULog::Log(LOG_LEVEL_INFO, __FUNCSIG__,__LINE__, __VA_ARGS__)#define LOG_WARNING(...)  CIULog::Log(LOG_LEVEL_WARNING, __FUNCSIG__, __LINE__,__VA_ARGS__)#define LOG_ERROR(...)    CIULog::Log(LOG_LEVEL_ERROR, __FUNCSIG__,__LINE__, __VA_ARGS__)class CIULog&#123;public:    static bool Init(bool bToFile, bool bTruncateLongLog, PCTSTR pszLogFileName);    static void Uninit();    static void SetLevel(LOG_LEVEL nLevel);    //ä¸è¾“å‡ºçº¿ç¨‹IDå·å’Œæ‰€åœ¨å‡½æ•°ç­¾åã€è¡Œå·    static bool Log(long nLevel, PCTSTR pszFmt, ...);    //è¾“å‡ºçº¿ç¨‹IDå·å’Œæ‰€åœ¨å‡½æ•°ç­¾åã€è¡Œå·    static bool Log(long nLevel, PCSTR pszFunctionSig, int nLineNo, PCTSTR pszFmt, ...);        //æ³¨æ„:pszFunctionSigå‚æ•°ä¸ºAnsicç‰ˆæœ¬    static bool Log(long nLevel, PCSTR pszFunctionSig, int nLineNo, PCSTR pszFmt, ...);private:    CIULog() = delete;    ~CIULog() = delete;    CIULog(const CIULog&amp; rhs) = delete;    CIULog&amp; operator=(const CIULog&amp; rhs) = delete;    static void GetTime(char* pszTime, int nTimeStrLength);private:    static bool             m_bToFile;              //æ—¥å¿—å†™å…¥æ–‡ä»¶è¿˜æ˜¯å†™åˆ°æ§åˆ¶å°      static HANDLE           m_hLogFile;    static bool             m_bTruncateLongLog;     //é•¿æ—¥å¿—æ˜¯å¦æˆªæ–­    static LOG_LEVEL        m_nLogLevel;            //æ—¥å¿—çº§åˆ«&#125;;#endif // !__LOG_H__\n\næ—¥å¿—çš„ cpp æ–‡ä»¶\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332/** *@desc:   IULog.cpp *@author: zhangyl *@date:   2014.12.25 */#include &quot;stdafx.h&quot;#include &quot;IULog.h&quot;#include &quot;EncodingUtil.h&quot;#include &lt;tchar.h&gt;#ifndef LOG_OUTPUT#define LOG_OUTPUT#endif#define MAX_LINE_LENGTH 256bool CIULog::m_bToFile = false;bool CIULog::m_bTruncateLongLog = false;HANDLE CIULog::m_hLogFile = INVALID_HANDLE_VALUE;LOG_LEVEL CIULog::m_nLogLevel = LOG_LEVEL_INFO;bool CIULog::Init(bool bToFile, bool bTruncateLongLog, PCTSTR pszLogFileName)&#123;#ifdef LOG_OUTPUT    m_bToFile = bToFile;    m_bTruncateLongLog = bTruncateLongLog;    if (pszLogFileName == NULL || pszLogFileName[0] == NULL)        return FALSE;    TCHAR szHomePath[MAX_PATH] = &#123;0&#125;;    ::GetModuleFileName(NULL, szHomePath, MAX_PATH);    for (int i = _tcslen(szHomePath); i &gt;= 0; --i)    &#123;        if (szHomePath[i] == _T(&#x27;\\\\&#x27;))        &#123;            szHomePath[i] = _T(&#x27;\\0&#x27;);            break;        &#125;    &#125;    TCHAR szLogDirectory[MAX_PATH] = &#123; 0 &#125;;    _stprintf_s(szLogDirectory, _T(&quot;%s\\\\Logs\\\\&quot;), szHomePath);    DWORD dwAttr = ::GetFileAttributes(szLogDirectory);    if (!((dwAttr != 0xFFFFFFFF) &amp;&amp; (dwAttr &amp; FILE_ATTRIBUTE_DIRECTORY)))    &#123;        TCHAR cPath[MAX_PATH] = &#123; 0 &#125;;        TCHAR cTmpPath[MAX_PATH] = &#123; 0 &#125;;        TCHAR* lpPos = NULL;        TCHAR cTmp = _T(&#x27;\\0&#x27;);        _tcsncpy_s(cPath, szLogDirectory, MAX_PATH);        for (int i = 0; i &lt; (int)_tcslen(cPath); i++)        &#123;            if (_T(&#x27;\\\\&#x27;) == cPath[i])                cPath[i] = _T(&#x27;/&#x27;);        &#125;        lpPos = _tcschr(cPath, _T(&#x27;/&#x27;));        while (lpPos != NULL)        &#123;            if (lpPos == cPath)            &#123;                lpPos++;            &#125;            else            &#123;                cTmp = *lpPos;                *lpPos = _T(&#x27;\\0&#x27;);                _tcsncpy_s(cTmpPath, cPath, MAX_PATH);                ::CreateDirectory(cTmpPath, NULL);                *lpPos = cTmp;                lpPos++;            &#125;            lpPos = _tcschr(lpPos, _T(&#x27;/&#x27;));        &#125;    &#125;    m_hLogFile = ::CreateFile(pszLogFileName, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, NULL, CREATE_NEW, FILE_ATTRIBUTE_NORMAL, NULL);    if (m_hLogFile == INVALID_HANDLE_VALUE)        return false;#endif // end LOG_OUTPUT    return true;&#125;void CIULog::Uninit()&#123;#ifdef LOG_OUTPUT    if(m_hLogFile != INVALID_HANDLE_VALUE)    &#123;        ::CloseHandle(m_hLogFile);        m_hLogFile = INVALID_HANDLE_VALUE;    &#125;#endif //end LOG_OUTPUT&#125;void CIULog::SetLevel(LOG_LEVEL nLevel)&#123;    m_nLogLevel = nLevel;&#125;bool CIULog::Log(long nLevel, PCTSTR pszFmt, ...)&#123;#ifdef LOG_OUTPUT    if (nLevel &lt; m_nLogLevel)        return false;    char szTime[64] = &#123; 0 &#125;;    GetTime(szTime,ARRAYSIZE(szTime));    std::string strDebugInfo(szTime);    std::string strLevel(&quot;[INFO]&quot;);    if (nLevel == LOG_LEVEL_WARNING)        strLevel = &quot;[Warning]&quot;;    else if (nLevel == LOG_LEVEL_ERROR)        strLevel = &quot;[Error]&quot;;    strDebugInfo += strLevel;    //å½“å‰çº¿ç¨‹ä¿¡æ¯    char szThreadID[32] = &#123; 0 &#125;;    DWORD dwThreadID = ::GetCurrentThreadId();    sprintf_s(szThreadID, ARRAYSIZE(szThreadID), &quot;[ThreadID: %u]&quot;, dwThreadID);      strDebugInfo += szThreadID;    //logæ­£æ–‡    std::wstring strLogMsg;    va_list ap;    va_start(ap, pszFmt);    int nLogMsgLength = _vsctprintf(pszFmt, ap);    //å®¹é‡å¿…é¡»ç®—ä¸Šæœ€åä¸€ä¸ª\\0    if ((int)strLogMsg.capacity() &lt; nLogMsgLength + 1)    &#123;        strLogMsg.resize(nLogMsgLength + 1);    &#125;    _vstprintf_s((TCHAR*)strLogMsg.data(), strLogMsg.capacity(), pszFmt, ap);    va_end(ap);    //stringå†…å®¹æ­£ç¡®ä½†lengthä¸å¯¹ï¼Œæ¢å¤ä¸€ä¸‹å…¶length    std::wstring strMsgFormal;    strMsgFormal.append(strLogMsg.c_str(), nLogMsgLength);    //å¦‚æœæ—¥å¿—å¼€å¯æˆªæ–­ï¼Œé•¿æ—¥å¿—åªå–å‰MAX_LINE_LENGTHä¸ªå­—ç¬¦    if (m_bTruncateLongLog)        strMsgFormal = strMsgFormal.substr(0, MAX_LINE_LENGTH);    std::string strLogMsgAscii;    strLogMsgAscii = EncodeUtil::UnicodeToAnsi(strMsgFormal);    strDebugInfo += strLogMsgAscii;    strDebugInfo += &quot;\\r\\n&quot;;    if(m_bToFile)    &#123;        if(m_hLogFile == INVALID_HANDLE_VALUE)            return false;        ::SetFilePointer(m_hLogFile, 0, NULL, FILE_END);        DWORD dwBytesWritten = 0;               ::WriteFile(m_hLogFile, strDebugInfo.c_str(), strDebugInfo.length(), &amp;dwBytesWritten, NULL);        ::FlushFileBuffers(m_hLogFile);        return true;    &#125;    ::OutputDebugStringA(strDebugInfo.c_str());#endif // end LOG_OUTPUT    return true;&#125;bool CIULog::Log(long nLevel, PCSTR pszFunctionSig, int nLineNo, PCTSTR pszFmt, ...)&#123;#ifdef LOG_OUTPUT    if (nLevel &lt; m_nLogLevel)        return false;    //æ—¶é—´    char szTime[64] = &#123; 0 &#125;;    GetTime(szTime, ARRAYSIZE(szTime));    std::string strDebugInfo(szTime);    //é”™è¯¯çº§åˆ«    std::string strLevel(&quot;[INFO]&quot;);    if (nLevel == LOG_LEVEL_WARNING)        strLevel = &quot;[Warning]&quot;;    else if (nLevel == LOG_LEVEL_ERROR)        strLevel = &quot;[Error]&quot;;    strDebugInfo += strLevel;    //å½“å‰çº¿ç¨‹ä¿¡æ¯    char szThreadID[32] = &#123;0&#125;;    DWORD dwThreadID = ::GetCurrentThreadId();    sprintf_s(szThreadID, ARRAYSIZE(szThreadID), &quot;[ThreadID: %u]&quot;, dwThreadID);    strDebugInfo += szThreadID;    //å‡½æ•°ç­¾å    char szFuncSig[512] = &#123; 0 &#125;;    sprintf_s(szFuncSig, &quot;[%s:%d]&quot;, pszFunctionSig, nLineNo);    strDebugInfo += szFuncSig;    //logæ­£æ–‡    std::wstring strLogMsg;    va_list ap;    va_start(ap, pszFmt);    int nLogMsgLength = _vsctprintf(pszFmt, ap);    //å®¹é‡å¿…é¡»ç®—ä¸Šæœ€åä¸€ä¸ª\\0     if ((int)strLogMsg.capacity() &lt; nLogMsgLength + 1)    &#123;        strLogMsg.resize(nLogMsgLength + 1);    &#125;    _vstprintf_s((TCHAR*)strLogMsg.data(), strLogMsg.capacity(), pszFmt, ap);    va_end(ap);    //stringå†…å®¹æ­£ç¡®ä½†lengthä¸å¯¹ï¼Œæ¢å¤ä¸€ä¸‹å…¶length    std::wstring strMsgFormal;    strMsgFormal.append(strLogMsg.c_str(), nLogMsgLength);    //å¦‚æœæ—¥å¿—å¼€å¯æˆªæ–­ï¼Œé•¿æ—¥å¿—åªå–å‰MAX_LINE_LENGTHä¸ªå­—ç¬¦    if (m_bTruncateLongLog)        strMsgFormal = strMsgFormal.substr(0, MAX_LINE_LENGTH);    std::string strLogMsgAscii;    strLogMsgAscii = EncodeUtil::UnicodeToAnsi(strMsgFormal);    strDebugInfo += strLogMsgAscii;    strDebugInfo += &quot;\\r\\n&quot;;    if(m_bToFile)    &#123;        if(m_hLogFile == INVALID_HANDLE_VALUE)            return false;        ::SetFilePointer(m_hLogFile, 0, NULL, FILE_END);        DWORD dwBytesWritten = 0;        ::WriteFile(m_hLogFile, strDebugInfo.c_str(), strDebugInfo.length(), &amp;dwBytesWritten, NULL);        ::FlushFileBuffers(m_hLogFile);        return true;    &#125;    ::OutputDebugStringA(strDebugInfo.c_str());#endif // end LOG_OUTPUT    return true;&#125;bool CIULog::Log(long nLevel, PCSTR pszFunctionSig, int nLineNo, PCSTR pszFmt, ...)&#123;#ifdef LOG_OUTPUT    if (nLevel &lt; m_nLogLevel)        return false;    //æ—¶é—´    char szTime[64] = &#123; 0 &#125;;    GetTime(szTime, ARRAYSIZE(szTime));    std::string strDebugInfo(szTime);    //é”™è¯¯çº§åˆ«    std::string strLevel(&quot;[INFO]&quot;);    if (nLevel == LOG_LEVEL_WARNING)        strLevel = &quot;[Warning]&quot;;    else if (nLevel == LOG_LEVEL_ERROR)        strLevel = &quot;[Error]&quot;;    strDebugInfo += strLevel;    //å½“å‰çº¿ç¨‹ä¿¡æ¯    char szThreadID[32] = &#123;0&#125;;    DWORD dwThreadID = ::GetCurrentThreadId();    sprintf_s(szThreadID, ARRAYSIZE(szThreadID), &quot;[ThreadID: %u]&quot;, dwThreadID);    strDebugInfo += szThreadID;    //å‡½æ•°ç­¾å    char szFuncSig[512] = &#123; 0 &#125;;    sprintf_s(szFuncSig, &quot;[%s:%d]&quot;, pszFunctionSig, nLineNo);    strDebugInfo += szFuncSig;    //æ—¥å¿—æ­£æ–‡    std::string strLogMsg;    va_list ap;    va_start(ap, pszFmt);    int nLogMsgLength = _vscprintf(pszFmt, ap);    //å®¹é‡å¿…é¡»ç®—ä¸Šæœ€åä¸€ä¸ª\\0    if ((int)strLogMsg.capacity() &lt; nLogMsgLength + 1)    &#123;        strLogMsg.resize(nLogMsgLength + 1);    &#125;    vsprintf_s((char*)strLogMsg.data(), strLogMsg.capacity(), pszFmt, ap);    va_end(ap);    //stringå†…å®¹æ­£ç¡®ä½†lengthä¸å¯¹ï¼Œæ¢å¤ä¸€ä¸‹å…¶length    std::string strMsgFormal;    strMsgFormal.append(strLogMsg.c_str(), nLogMsgLength);    //å¦‚æœæ—¥å¿—å¼€å¯æˆªæ–­ï¼Œé•¿æ—¥å¿—åªå–å‰MAX_LINE_LENGTHä¸ªå­—ç¬¦    if (m_bTruncateLongLog)        strMsgFormal = strMsgFormal.substr(0, MAX_LINE_LENGTH);    strDebugInfo += strMsgFormal;    strDebugInfo += &quot;\\r\\n&quot;;    if(m_bToFile)    &#123;        if(m_hLogFile == INVALID_HANDLE_VALUE)            return false;        ::SetFilePointer(m_hLogFile, 0, NULL, FILE_END);        DWORD dwBytesWritten = 0;        ::WriteFile(m_hLogFile, strDebugInfo.c_str(), strDebugInfo.length(), &amp;dwBytesWritten, NULL);        ::FlushFileBuffers(m_hLogFile);        return true;    &#125;    ::OutputDebugStringA(strDebugInfo.c_str());#endif // end LOG_OUTPUT    return true;&#125;void CIULog::GetTime(char* pszTime, int nTimeStrLength)&#123;    SYSTEMTIME st = &#123;0&#125;;    ::GetLocalTime(&amp;st);    sprintf_s(pszTime, nTimeStrLength, &quot;[%04d-%02d-%02d %02d:%02d:%02d:%04d]&quot;, st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond, st.wMilliseconds);&#125;\n\nä¸Šè¿°ä»£ç ä¸­æ ¹æ®æ—¥å¿—çº§åˆ«å®šä¹‰äº†ä¸‰ä¸ªå® LOG_INFOã€LOG_WARNINGã€LOG_ERRORï¼Œå¦‚æœè¦ä½¿ç”¨è¯¥æ—¥å¿—æ¨¡å—ï¼Œåªéœ€è¦åœ¨ç¨‹åºå¯åŠ¨å¤„çš„åœ°æ–¹è°ƒç”¨ CIULog::Init å‡½æ•°åˆå§‹åŒ–æ—¥å¿—ï¼š\n12345SYSTEMTIME st = &#123;0&#125;;::GetLocalTime(&amp;st);TCHAR szLogFileName[MAX_PATH] = &#123;0&#125;;_stprintf_s(szLogFileName, MAX_PATH, _T(&quot;%s\\\\Logs\\\\%04d%02d%02d%02d%02d%02d.log&quot;), g_szHomePath, st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);CIULog::Init(true, false, szLogFileName);\n\nå½“ç„¶ï¼Œæœ€ä½³çš„åšæ³•ï¼Œåœ¨ç¨‹åºé€€å‡ºçš„åœ°æ–¹ï¼Œè°ƒç”¨ CIULog::Uninit å›æ”¶æ—¥å¿—æ¨¡å—ç›¸å…³çš„èµ„æºï¼š\n1CIULog::Uninit();\n\nåœ¨åšå¥½è¿™äº›å‡†å¤‡å·¥ä½œä»¥åï¼Œå¦‚æœä½ æƒ³åœ¨ç¨‹åºçš„æŸä¸ªåœ°æ–¹å†™ä¸€æ¡æ—¥å¿—ï¼Œåªéœ€è¦è¿™æ ·å†™ï¼š\n123456//æ‰“å°ä¸€æ¡ INFO çº§åˆ«çš„æ—¥å¿—LOG_INFO(&quot;Request logon: Account=%s, Password=*****, Status=%d, LoginType=%d.&quot;, pLoginRequest-&gt;m_szAccountName, pLoginRequest-&gt;m_szPassword, pLoginRequest-&gt;m_nStatus, (long)pLoginRequest-&gt;m_nLoginType);//æ‰“å°ä¸€æ¡ WARNING çº§åˆ«çš„æ—¥å¿—LOG_WARN(&quot;Some warning...&quot;);//æ‰“å°ä¸€æ¡ ERROR çº§åˆ«çš„æ—¥å¿—LOG_ERROR(&quot;Recv data error, errorNO=%d.&quot;, ::WSAGetLastError());\n\nå…³äº CIULog è¿™ä¸ªæ—¥å¿—æ¨¡å—ç±»ï¼Œå¦‚æœè¯»è€…è¦æƒ³å®é™…è¿è¡ŒæŸ¥çœ‹æ•ˆæœï¼Œå¯ä»¥ä»é“¾æ¥ï¼ˆhttps://github.com/baloonwj/flamingo/tree/master/flamingoclient ï¼‰ä¸‹è½½å®Œæ•´çš„é¡¹ç›®ä»£ç æ¥è¿è¡Œã€‚è¯¥æ—¥å¿—è¾“å‡ºæ•ˆæœå¦‚ä¸‹ï¼š\n12345[2018-11-09 23:52:54:0826][INFO][ThreadID: 7252][bool __thiscall CIUSocket::Login(const char *,const char *,int,int,int,class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &amp;):1107]Request logon: Account=zhangy, Password=*****, Status=76283204, LoginType=1.[2018-11-09 23:52:56:0352][INFO][ThreadID: 5828][void __thiscall CIUSocket::SendThreadProc(void):794]Recv data thread start...[2018-11-09 23:52:56:0385][INFO][ThreadID: 6032][void __thiscall CSendMsgThread::HandleUserBasicInfo(const class CUserBasicInfoRequest *):298]Request to get userinfo.[2018-11-09 23:52:56:0355][INFO][ThreadID: 7140][void __thiscall CIUSocket::RecvThreadProc(void):842]Recv data thread start...[2018-11-09 23:52:57:0254][INFO][ThreadID: 7220][int __thiscall CRecvMsgThread::HandleFriendListInfo(const class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &amp;):593]Recv user basic info, info count=1.\n\nå¤šçº¿ç¨‹åŒæ­¥å†™æ—¥å¿—å‡ºç°çš„é—®é¢˜ä¸€ä»ä¸Šé¢çš„æ—¥å¿—è¾“å‡ºæ¥çœ‹ï¼Œè¿™ç§åŒæ­¥çš„æ—¥å¿—è¾“å‡ºæ–¹å¼ï¼Œä¹Ÿå­˜åœ¨æ—¶é—´é¡ºåºä¸æ­£ç¡®çš„é—®é¢˜ï¼ˆæ—¶é—´æˆ³å¤§çš„æ—¥å¿—æ¯”æ—¶é—´æˆ³å°çš„æ—¥å¿—é å‰ï¼‰ã€‚è¿™æ˜¯ç”±äºå¤šçº¿ç¨‹åŒæ—¶å†™æ—¥å¿—åˆ°åŒä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œäº§ç”Ÿæ—¥å¿—çš„æ—¶é—´å’Œå®é™…å†™å…¥ç£ç›˜çš„æ—¶é—´ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚ä¸‹å›¾è§£é‡Šäº†è¯¥ç°è±¡å‡ºç°çš„æ ¹æºï¼š\n\nå¤šçº¿ç¨‹å†™åŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å‡ºç°å…ˆäº§ç”Ÿçš„æ—¥å¿—åå†™å…¥åˆ°æ–‡ä»¶ä¸­çš„ç°è±¡\nå¥½åœ¨è¿™ç§æ—¶é—´é¡ºåºä¸æ­£ç¡®åªä¼šå‡ºç°åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´ï¼Œå¯¹äºåŒä¸€ä¸ªçº¿ç¨‹çš„ä¸åŒæ—¶é—´çš„æ—¥å¿—è®°å½•é¡ºåºè‚¯å®šæ˜¯æ­£ç¡®çš„ã€‚æ‰€ä»¥è¿™ç§æ—¥æœŸé”™ä¹±ç°è±¡ï¼Œå¹¶ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨æ—¥å¿—ã€‚\nå¤šçº¿ç¨‹åŒæ­¥å†™æ—¥å¿—å‡ºç°çš„é—®é¢˜äºŒå¤šçº¿ç¨‹åŒæ—¶å†™å…¥åŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å‡è®¾çº¿ç¨‹ A å†™æŸä¸€ä¸ªæ—¶åˆ»è¿½åŠ æ—¥å¿—å†…å®¹ä¸º â€œAAAAAâ€ ï¼Œçº¿ç¨‹ B åœ¨åŒä¸€æ—¶åˆ»è¿½åŠ æ—¥å¿—å†…å®¹ä¸º â€œBBBBBâ€ ï¼Œçº¿ç¨‹ C åœ¨åŒä¸€æ—¶åˆ»è¿½åŠ æ—¥å¿—å†…å®¹ä¸º â€œCCCCCâ€ ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„æ—¥å¿—æ–‡ä»¶ä¸­çš„å†…å®¹ä¼šä¸ä¼šå‡ºç° â€œAABBCCABCAACCBBâ€ è¿™ç§æ ¼å¼ï¼Ÿ\nåœ¨ç±» Unix ç³»ç»Ÿä¸Šï¼ˆåŒ…æ‹¬ Linuxï¼‰ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹å†…é’ˆå¯¹åŒä¸€ä¸ª FILE* çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ç±»æ“ä½œç³»ç»Ÿä¸Šå¾—åˆ°çš„æ—¥å¿—ç»“æœ Aã€Bã€C å„ä¸ªå­—æ¯ç»„ä¸€å®šæ˜¯è¿ç»­åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆå¾—åˆ°çš„æ—¥å¿—å†…å®¹å¯èƒ½æ˜¯ â€œAAAAACCCCCBBBBBâ€ æˆ– â€œAAAAABBBBBCCCCCâ€ ç­‰è¿™ç§è¿ç»­çš„æ ¼å¼ï¼Œç»ä¸ä¼šå‡ºç° Aã€Bã€C å­—æ¯äº¤é”™ç›¸é—´çš„ç°è±¡ã€‚\nè€Œåœ¨Windowsç³»ç»Ÿä¸Šï¼Œå¯¹äº FILE* çš„æ“ä½œå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯ç¬”è€…åšäº†å¤§é‡å®éªŒï¼Œåœ¨ Windows ç³»ç»Ÿä¸Šä¹Ÿæ²¡æœ‰å‡ºç°è¿™ç§ Aã€Bã€C å­—æ¯ç›¸é—´çš„ç°è±¡ã€‚ï¼ˆå…³äºè¿™ä¸ªé—®é¢˜çš„è®¨è®ºï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œï¼šhttps://www.zhihu.com/question/40472431 ï¼‰\nè¿™ç§åŒæ­¥æ—¥å¿—çš„å®ç°æ–¹å¼ï¼Œä¸€èˆ¬ç”¨äºä½é¢‘å†™æ—¥å¿—çš„è½¯ä»¶ç³»ç»Ÿä¸­ï¼ˆå¦‚å®¢æˆ·ç«¯è½¯ä»¶ï¼‰ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥è®¤ä¸ºè¿™ç§å¤šçº¿ç¨‹åŒæ—¶å†™æ—¥å¿—åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æ˜¯å¯è¡Œçš„ã€‚\nå¼‚æ­¥å†™æ—¥å¿—å½“ç„¶ï¼Œå¯¹äºæ€§èƒ½è¦æ±‚ä¸é«˜çš„åº”ç”¨ï¼ˆå¦‚å¤§å¤šæ•°å®¢æˆ·ç«¯ç¨‹åºã€æŸäº›å¹¶å‘æ•°é‡ä¸é«˜çš„æœåŠ¡ï¼‰æ¥è¯´ï¼Œè¿™ç§åŒæ­¥å†™æ—¥å¿—çš„å®ç°æ–¹å¼æ˜¯å¯ä»¥æ»¡è¶³è¦æ±‚çš„ã€‚ä½†æ˜¯å¯¹äº QPS è¦æ±‚å¾ˆé«˜æˆ–è€…å¯¹æ€§èƒ½æœ‰ä¸€å®šè¦æ±‚çš„æœåŠ¡å™¨ç¨‹åºï¼ŒåŒæ­¥å†™æ—¥å¿—ç­‰å¾…ç£ç›˜ IO çš„å®Œæˆå¯¹äºæœåŠ¡çš„å…³é”®æ€§é€»è¾‘çš„å¿«é€Ÿæ‰§è¡Œå’ŒåŠæ—¶å“åº”æ€§ä¼šé€ æˆä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚ä¸ºäº†å‡å°è¿™ç§æŸå¤±ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¼‚æ­¥æ—¥å¿—ã€‚\næ‰€è°“å¼‚æ­¥å†™æ—¥å¿—ï¼Œä¸åŒæ­¥å†™æ—¥å¿—ç›¸åï¼Œå³äº§ç”Ÿæ—¥å¿—çš„åœ°æ–¹ï¼Œä¸ä¼šå°†æ—¥å¿—å®æ—¶å†™å…¥åˆ°æ–‡ä»¶ä¸­å»ï¼Œè€Œæ˜¯é€šè¿‡ä¸€äº›çº¿ç¨‹åŒæ­¥æŠ€æœ¯å°†æ—¥å¿—å…ˆæš‚å­˜ä¸‹æ¥ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªä¸“é—¨çš„æ—¥å¿—å†™å…¥çº¿ç¨‹å»å°†è¿™äº›ç¼“å­˜çš„æ—¥å¿—å†™å…¥åˆ°ç£ç›˜ä¸­å»ï¼Œè¿™æ ·çš„è¯ï¼ŒåŸæ¥è¾“å‡ºæ—¥å¿—çš„çº¿ç¨‹å°±ä¸å­˜åœ¨ç­‰å¾…å†™æ—¥å¿—åˆ°ç£ç›˜è¿™æ ·çš„æ•ˆç‡æŸè€—äº†ã€‚è¿™æœ¬è´¨ä¸Šï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œäº§ç”Ÿæ—¥å¿—çš„çº¿ç¨‹æ˜¯ç”Ÿäº§è€…ï¼Œå°†æ—¥å¿—å†™å…¥æ–‡ä»¶çš„çº¿ç¨‹æ˜¯æ¶ˆè´¹è€…ã€‚å½“ç„¶ï¼Œå¯¹äºæ—¥å¿—çš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œæˆ‘è¿™é‡Œæåˆ°â€œä¸€ä¸ªâ€æˆ–â€œå¤šä¸ªâ€æ—¥å¿—çº¿ç¨‹ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœå¤šä¸ªæ—¥å¿—æ¶ˆè´¹çº¿ç¨‹ï¼Œæˆ‘ä»¬åˆè¦è€ƒè™‘å¤šä¸ªçº¿ç¨‹å¯èƒ½ä¼šé€ æˆå†™æ—¥å¿—çš„æ—¶é—´é¡ºåºé”™ä½ï¼ˆæ—¶é—´è¾ƒæ™šçš„æ—¥å¿—å†™åœ¨æ—¶é—´è¾ƒæ—©çš„æ—¥å¿—å‰é¢ï¼‰ï¼Œè¿™åœ¨ä¸Šæ–‡ä¸­å·²ç»è®¨è®ºè¿‡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\næ€»ç»“èµ·æ¥ï¼Œä¸ºäº†æ–¹ä¾¿è¯»è€…ç†è§£å’Œç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå¼‚æ­¥å†™æ—¥å¿—çš„é€»è¾‘ä¸€èˆ¬å­˜åœ¨ä¸€ç»„ä¸“é—¨å†™æ—¥å¿—çš„çº¿ç¨‹ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰ï¼Œç¨‹åºçš„å…¶ä»–çº¿ç¨‹ä¸ºè¿™äº›æ—¥å¿—çº¿ç¨‹ç”Ÿäº§æ—¥å¿—ã€‚\nè‡³äºå…¶ä»–çº¿ç¨‹å¦‚ä½•å°†äº§ç”Ÿçš„æ—¥å¿—äº¤ç»™æ—¥å¿—çº¿ç¨‹ï¼Œè¿™å°±æ˜¯å¤šçº¿ç¨‹ä¹‹é—´èµ„æºåŒæ­¥çš„é—®é¢˜äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥å­˜å‚¨å…¶ä»–çº¿ç¨‹äº§ç”Ÿçš„æ—¥å¿—ï¼Œæ—¥å¿—çº¿ç¨‹ä»è¯¥é˜Ÿåˆ—ä¸­å–å‡ºæ—¥å¿—ï¼Œç„¶åå°†æ—¥å¿—å†…å®¹å†™å…¥æ–‡ä»¶ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯æ—¥å¿—ç”Ÿäº§çº¿ç¨‹å°†æ¯æ¬¡äº§ç”Ÿçš„æ—¥å¿—ä¿¡æ¯æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—æ—¶ã€æ—¥å¿—å†™å…¥çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºæ—¥å¿—æ—¶ï¼Œéƒ½ä½¿ç”¨ä¸€ä¸ª**äº’æ–¥ä½“( mutex )**ä¿æŠ¤èµ·æ¥ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼ˆC++11 ä»£ç ï¼‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121/** *@desc: AsyncLogger.cpp *@author: zhangyl *@date: 2018.11.10 */#include &quot;stdafx.h&quot;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;list&gt;#include &lt;string&gt;#include &lt;sstream&gt;#include &lt;iostream&gt;//ä¿æŠ¤é˜Ÿåˆ—çš„äº’æ–¥ä½“std::mutex log_mutex;std::list&lt;std::string&gt; cached_logs;FILE* log_file = NULL;bool init_log_file()&#123;    //ä»¥è¿½åŠ å†…å®¹çš„å½¢å¼å†™å…¥æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º    log_file = fopen(&quot;my.log&quot;, &quot;a+&quot;);    return log_file != NULL;&#125;void uninit_log_file()&#123;    if (log_file != NULL)        fclose(log_file);&#125;bool write_log_tofile(const std::string&amp; line)&#123;    if (log_file == NULL)        return false;    if (fwrite((void*)line.c_str(), 1, line.length(), log_file) != line.length())        return false;    //å°†æ—¥å¿—ç«‹å³å†²åˆ·åˆ°æ–‡ä»¶ä¸­å»    fflush(log_file);    return true;&#125;void log_producer()&#123;    int index = 0;    while (true)    &#123;        ++ index;        std::ostringstream os;        os &lt;&lt; &quot;This is log, index: &quot; &lt;&lt; index &lt;&lt; &quot;, producer threadID: &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; &quot;\\n&quot;;        //ä½¿ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ä¸ºçš„æ˜¯å‡å°é”çš„ç²’åº¦        &#123;            std::lock_guard&lt;std::mutex&gt; lock(log_mutex);            cached_logs.emplace_back(os.str());        &#125;        std::chrono::milliseconds duration(100);        std::this_thread::sleep_for(duration);    &#125;&#125;void log_consumer()&#123;    std::string line;    while (true)    &#123;        //ä½¿ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ä¸ºçš„æ˜¯å‡å°é”çš„ç²’åº¦        &#123;            std::lock_guard&lt;std::mutex&gt; lock(log_mutex);            if (!cached_logs.empty())            &#123;                line = cached_logs.front();                cached_logs.pop_front();            &#125;        &#125;        if (line.empty())        &#123;                    std::chrono::milliseconds duration(1000);            std::this_thread::sleep_for(duration);            continue;        &#125;        write_log_tofile(line);        line.clear();    &#125;&#125;int main(int argc, char* argv[])&#123;    if (!init_log_file())    &#123;        std::cout &lt;&lt; &quot;init log file error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    std::thread log_producer1(log_producer);    std::thread log_producer2(log_producer);    std::thread log_producer3(log_producer);    std::thread log_consumer1(log_consumer);    std::thread log_consumer2(log_consumer);    std::thread log_consumer3(log_consumer);    log_producer1.join();    log_producer2.join();    log_producer3.join();    log_consumer1.join();    log_consumer2.join();    log_consumer3.join();    uninit_log_file();    return 0;&#125;\n\nä¸Šè¿°ä»£ç åˆ†åˆ«æ¨¡æ‹Ÿäº†ä¸‰ä¸ªç”Ÿäº§æ—¥å¿—çš„çº¿ç¨‹ï¼ˆlog_producer1ï½3ï¼‰å’Œä¸‰ä¸ªæ¶ˆè´¹æ—¥å¿—çº¿ç¨‹ï¼ˆlog_consumer1ï½3ï¼‰ã€‚å½“ç„¶ä¸Šè¿°ä»£ç å¯ä»¥ç»§ç»­ä¼˜åŒ–ï¼Œå¦‚æœå½“å‰ç¼“å­˜é˜Ÿåˆ—ä¸­æ²¡æœ‰æ—¥å¿—è®°å½•ï¼Œé‚£ä¹ˆæ¶ˆè´¹æ—¥å¿—çº¿ç¨‹ä¼šåšæ— ç”¨åŠŸã€‚\nä¼˜åŒ–æ–¹æ³•ä¸€å¯ä»¥ä½¿ç”¨æ¡ä»¶å˜é‡ï¼Œå¦‚æœå½“å‰é˜Ÿåˆ—ä¸­æ²¡æœ‰æ—¥å¿—è®°å½•ï¼Œåˆ™å°†æ—¥å¿—æ¶ˆè´¹çº¿ç¨‹æŒ‚èµ·ï¼›å½“ç”Ÿäº§æ—¥å¿—çš„çº¿ç¨‹äº§ç”Ÿäº†æ–°çš„æ—¥å¿—åï¼Œç½®ä¿¡ï¼ˆsignalï¼‰æ¡ä»¶å˜é‡ï¼Œè¿™æ ·æ—¥å¿—æ¶ˆè´¹çº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œä»¥å°†æ—¥å¿—ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¥å¹¶å†™å…¥æ–‡ä»¶ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ä»£ç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126/** *@desc: AsyncLoggerLinux.cpp *@author: zhangyl *@date: 2018.11.10 */#include &quot;stdafx.h&quot;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;condition_variable&gt;#include &lt;list&gt;#include &lt;string&gt;#include &lt;sstream&gt;#include &lt;iostream&gt;std::mutex log_mutex;std::condition_variable log_cv;std::list&lt;std::string&gt; cached_logs;FILE* log_file = NULL;bool init_log_file()&#123;    //ä»¥è¿½åŠ å†…å®¹çš„å½¢å¼å†™å…¥æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º    log_file = fopen(&quot;my.log&quot;, &quot;a+&quot;);    return log_file != NULL;&#125;void uninit_log_file()&#123;    if (log_file != NULL)        fclose(log_file);&#125;bool write_log_tofile(const std::string&amp; line)&#123;    if (log_file == NULL)        return false;    if (fwrite((void*)line.c_str(), 1, line.length(), log_file) != line.length())        return false;    //å°†æ—¥å¿—ç«‹å³å†²åˆ·åˆ°æ–‡ä»¶ä¸­å»    fflush(log_file);    return true;&#125;void log_producer()&#123;    int index = 0;    while (true)    &#123;        ++ index;        std::ostringstream os;        os &lt;&lt; &quot;This is log, index: &quot; &lt;&lt; index &lt;&lt; &quot;, producer threadID: &quot; &lt;&lt; std::this_thread::get_id() &lt;&lt; &quot;\\n&quot;;        //ä½¿ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ä¸ºçš„æ˜¯å‡å°é”çš„ç²’åº¦        &#123;            std::lock_guard&lt;std::mutex&gt; lock(log_mutex);            cached_logs.emplace_back(os.str());            log_cv.notify_one();        &#125;        std::chrono::milliseconds duration(100);        std::this_thread::sleep_for(duration);    &#125;&#125;void log_consumer()&#123;    std::string line;    while (true)    &#123;        //ä½¿ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ä¸ºçš„æ˜¯å‡å°é”çš„ç²’åº¦        &#123;            std::unique_lock&lt;std::mutex&gt; lock(log_mutex);            if (cached_logs.empty())            &#123;                //æ— é™ç­‰å¾…                log_cv.wait(lock);            &#125;            line = cached_logs.front();            cached_logs.pop_front();        &#125;        if (line.empty())        &#123;                    std::chrono::milliseconds duration(1000);            std::this_thread::sleep_for(duration);            continue;        &#125;        write_log_tofile(line);        line.clear();    &#125;&#125;int main(int argc, char* argv[])&#123;    if (!init_log_file())    &#123;        std::cout &lt;&lt; &quot;init log file error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    std::thread log_producer1(log_producer);    std::thread log_producer2(log_producer);    std::thread log_producer3(log_producer);    std::thread log_consumer1(log_consumer);    std::thread log_consumer2(log_consumer);    std::thread log_consumer3(log_consumer);    log_producer1.join();    log_producer2.join();    log_producer3.join();    log_consumer1.join();    log_consumer2.join();    log_consumer3.join();    uninit_log_file();    return 0;&#125;\n\nä¼˜åŒ–æ–¹æ³•äºŒé™¤äº†æ¡ä»¶å˜é‡ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¿¡å·é‡æ¥è®¾è®¡æˆ‘ä»¬çš„å¼‚æ­¥æ—¥å¿—ç³»ç»Ÿï¼Œä¿¡å·é‡æ˜¯å¸¦æœ‰èµ„æºè®¡æ•°çš„çº¿ç¨‹åŒæ­¥å¯¹è±¡ï¼Œå½“æ¯äº§ç”Ÿä¸€æ¡æ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬å°†ä¿¡å·é‡èµ„æºè®¡æ•°è‡ªå¢1ï¼Œæ—¥å¿—æ¶ˆè´¹çº¿ç¨‹é»˜è®¤æ˜¯ç­‰å¾…è¿™ä¸ªä¿¡å·é‡æ˜¯å¦å—ä¿¡ï¼Œå¦‚æœå—ä¿¡ï¼Œæ¯å”¤é†’ä¸€ä¸ªæ—¥å¿—æ¶ˆè´¹çº¿ç¨‹ï¼Œä¿¡å·é‡å­—æ•°è®¡æ•°å°†è‡ªåŠ¨å‡1ã€‚é€šä¿—åœ°è¯´å°±æ˜¯ç”Ÿæˆè€…æ¯ç”Ÿäº§ä¸€ä¸ªèµ„æºï¼Œå°±å°†èµ„æºè®¡æ•°åŠ 1ï¼Œè€Œæ¶ˆè´¹è€…æ¯æ¶ˆè´¹ä¸€ä¸ªèµ„æºæ•°é‡ï¼Œå°±å°†èµ„æºè®¡æ•°å‡ä¸€ï¼›å¦‚æœå½“å‰èµ„æºè®¡æ•°å·²ç»ä¸º0ï¼Œåˆ™æ¶ˆè´¹è€…å°†è‡ªåŠ¨æŒ‚èµ·ã€‚\nç”±äº C++ 11 æ²¡æœ‰æä¾›å¯¹ä¸åŒå¹³å°çš„ä¿¡å·é‡å¯¹è±¡çš„å°è£…ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ†åˆ«ç»™å‡º Windows å’Œ Linux ä¸¤ä¸ªå¹³å°çš„å®ç°ä»£ç ï¼Œè¯»è€…å¯ä»¥æ ¹æ®éœ€è¦æ¥å­¦ä¹ å…¶ä¸­ä¸€ä¸ªæˆ–ä¸¤ä¸ªåŒæ—¶å­¦ä¹ ã€‚æ³¨æ„ï¼Œä¸ºäº†ä¿æŒä»£ç é£æ ¼ä¸€è‡´ï¼Œå¯¹äºçº¿ç¨‹å’Œè¯»å†™æ–‡ä»¶ç›¸å…³å‡½æ•°ï¼Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå¹³å°ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥ç³»ç»Ÿå¹³å°ç›¸å…³çš„ API æ¥å£ï¼Œè€Œä¸å†ä½¿ç”¨ C++ 11 çš„ç›¸å…³å‡½æ•°å’Œç±»åº“ã€‚\nWindows å¹³å°ä»£ç \n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145/** *@desc: AsyncLogger.cppï¼ŒWindowsç‰ˆæœ¬ *@author: zhangyl *@date: 2018.11.10 */#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;list&gt;#include &lt;string&gt;#include &lt;iostream&gt;#include &lt;sstream&gt;std::list&lt;std::string&gt; cached_logs;CRITICAL_SECTION g_cs;HANDLE g_hSemaphore = NULL;HANDLE g_hLogFile = INVALID_HANDLE_VALUE;bool Init()&#123;    InitializeCriticalSection(&amp;g_cs);    //å‡è®¾èµ„æºæ•°é‡ä¸Šé™æ˜¯0xFFFFFFFF    g_hSemaphore = CreateSemaphore(NULL, 0, 0xFFFFFFFF, NULL);    //å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º    g_hLogFile = CreateFile(_T(&quot;my.log&quot;), GENERIC_WRITE, FILE_SHARE_READ, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);    if (g_hLogFile == INVALID_HANDLE_VALUE)        return false;    return true;&#125;void Uninit()&#123;    DeleteCriticalSection(&amp;g_cs);    if (g_hSemaphore != NULL)        CloseHandle(g_hSemaphore);    if (g_hLogFile != INVALID_HANDLE_VALUE)        CloseHandle(g_hLogFile);&#125;bool WriteLogToFile(const std::string&amp; line)&#123;    if (g_hLogFile == INVALID_HANDLE_VALUE)        return false;    DWORD dwBytesWritten;    //å¦‚æœå¯¹äºæ¯”è¾ƒé•¿çš„æ—¥å¿—ï¼Œåº”è¯¥åˆ†æ®µå†™å…¥ï¼Œå› ä¸ºå•æ¬¡å†™å…¥å¯èƒ½åªèƒ½å†™å…¥éƒ¨åˆ†ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œé€»è¾‘ä»ç®€    if (!WriteFile(g_hLogFile, line.c_str(), line.length(), &amp;dwBytesWritten, NULL) || dwBytesWritten != line.length())        return false;    //å°†æ—¥å¿—ç«‹å³å†²åˆ·åˆ°æ–‡ä»¶ä¸­å»    FlushFileBuffers(g_hLogFile);    return true;&#125;DWORD CALLBACK LogProduceThreadProc(LPVOID lpThreadParameter)&#123;    int index = 0;    while (true)    &#123;        ++ index;        std::ostringstream os;        os &lt;&lt; &quot;This is log, index: &quot; &lt;&lt; index &lt;&lt; &quot;, producer threadID: &quot; &lt;&lt; GetCurrentThreadId() &lt;&lt; &quot;\\n&quot;;        EnterCriticalSection(&amp;g_cs);               cached_logs.emplace_back(os.str());        LeaveCriticalSection(&amp;g_cs);        ReleaseSemaphore(g_hSemaphore, 1, NULL);        Sleep(100);    &#125;    return 0;&#125;DWORD CALLBACK LogConsumeThreadProc(LPVOID lpThreadParameter)&#123;    std::string line;    while (true)    &#123;             //æ— é™ç­‰å¾…        WaitForSingleObject(g_hSemaphore, INFINITE);        EnterCriticalSection(&amp;g_cs);        if (!cached_logs.empty())        &#123;            line = cached_logs.front();            cached_logs.pop_front();        &#125;             LeaveCriticalSection(&amp;g_cs);                  if (line.empty())        &#123;                    Sleep(1000);            continue;        &#125;        WriteLogToFile(line);        line.clear();    &#125;&#125;int main(int argc, char* argv[])&#123;    if (!Init())    &#123;        std::cout &lt;&lt; &quot;init log file error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    HANDLE hProducers[3];    for (int i = 0; i &lt; sizeof(hProducers) / sizeof(hProducers[0]); ++i)    &#123;        hProducers[i] = CreateThread(NULL, 0, LogProduceThreadProc, NULL, 0, NULL);    &#125;    HANDLE hConsumers[3];    for (int i = 0; i &lt; sizeof(hConsumers) / sizeof(hConsumers[0]); ++i)    &#123;        hConsumers[i] = CreateThread(NULL, 0, LogConsumeThreadProc, NULL, 0, NULL);    &#125;    //ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹é€€å‡º    for (int i = 0; i &lt; sizeof(hProducers) / sizeof(hProducers[0]); ++i)    &#123;        WaitForSingleObject(hProducers[i], INFINITE);    &#125;    //ç­‰å¾…ç”Ÿäº§è€…çº¿ç¨‹é€€å‡º    for (int i = 0; i &lt; sizeof(hConsumers) / sizeof(hConsumers[0]); ++i)    &#123;        WaitForSingleObject(hConsumers[i], INFINITE);    &#125;    Uninit();    return 0;&#125;\n\nä¸Šè¿°ä»£ç ï¼Œåœ¨å¤šçº¿ç¨‹å‘é˜Ÿåˆ—ä¸­å¢åŠ æ—¥å¿—è®°å½•å’Œä»é˜Ÿåˆ—ä¸­å–å‡ºæ—¥å¿—è®°å½•ä½¿ç”¨äº†Windowsçš„ä¸Šçš„ä¸´ç•ŒåŒºï¼ˆCRITICAL_SECTIONï¼Œæœ‰çš„ä¹¦ä¸Šè¯‘ä½œâ€œå…³é”®æ®µâ€ï¼‰å¯¹è±¡æ¥å¯¹é˜Ÿåˆ—è¿›è¡Œä¿æŠ¤ã€‚\nLinux å¹³å°ä»£ç \n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140/** *@desc: AsyncLogger.cppï¼Œlinuxç‰ˆæœ¬ *@author: zhangyl *@date: 2018.11.10 */#include &lt;unistd.h&gt;#include &lt;list&gt;#include &lt;stdio.h&gt;#include &lt;pthread.h&gt;#include &lt;semaphore.h&gt;#include &lt;string&gt;#include &lt;iostream&gt;#include &lt;sstream&gt;std::list&lt;std::string&gt; cached_logs;pthread_mutex_t log_mutex = PTHREAD_MUTEX_INITIALIZER;sem_t           log_semphore;FILE* plogfile = NULL;bool init()&#123;    pthread_mutex_init(&amp;log_mutex, NULL);    //åˆå§‹ä¿¡å·é‡èµ„æºæ•°ç›®æ˜¯0    sem_init(&amp;log_semphore, 0, 0);    //å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º    plogfile = fopen(&quot;my.log&quot;, &quot;a++&quot;);    return plogfile != NULL;&#125;void uninit()&#123;    pthread_mutex_destroy(&amp;log_mutex);    sem_destroy(&amp;log_semphore);    if (plogfile != NULL)        fclose(plogfile);&#125;bool write_log_to_file(const std::string&amp; line)&#123;    if (plogfile == NULL)        return false;    //å¦‚æœå¯¹äºæ¯”è¾ƒé•¿çš„æ—¥å¿—ï¼Œåº”è¯¥åˆ†æ®µå†™å…¥ï¼Œå› ä¸ºå•æ¬¡å†™å…¥å¯èƒ½åªèƒ½å†™å…¥éƒ¨åˆ†ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œé€»è¾‘ä»ç®€    if (fwrite((void*)line.c_str(), 1, line.length(), plogfile) != line.length())        return false;    //å°†æ—¥å¿—ç«‹å³å†²åˆ·åˆ°æ–‡ä»¶ä¸­å»    fflush(plogfile);    return true;&#125;void* producer_thread_proc(void* arg)&#123;    int index = 0;    while (true)    &#123;        ++ index;        std::ostringstream os;        os &lt;&lt; &quot;This is log, index: &quot; &lt;&lt; index &lt;&lt; &quot;, producer threadID: &quot; &lt;&lt; pthread_self() &lt;&lt; &quot;\\n&quot;;        pthread_mutex_lock(&amp;log_mutex);        cached_logs.push_back(os.str());        pthread_mutex_unlock(&amp;log_mutex);        sem_post(&amp;log_semphore);        usleep(100000);    &#125;&#125;void* consumer_thread_proc(void* arg)&#123;    std::string line;    while (true)    &#123;             //æ— é™ç­‰å¾…        sem_wait(&amp;log_semphore);        pthread_mutex_lock(&amp;log_mutex);        if (!cached_logs.empty())        &#123;            line = cached_logs.front();            cached_logs.pop_front();        &#125;             pthread_mutex_unlock(&amp;log_mutex);        if (line.empty())        &#123;                    sleep(1);            continue;        &#125;        write_log_to_file(line);        line.clear();    &#125;&#125;int main(int argc, char* argv[])&#123;    if (!init())    &#123;        std::cout &lt;&lt; &quot;init log file error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    pthread_t producer_thread_id[3];    for (int i = 0; i &lt; sizeof(producer_thread_id) / sizeof(producer_thread_id[0]); ++i)    &#123;        pthread_create(&amp;producer_thread_id[i], NULL, producer_thread_proc, NULL);    &#125;    pthread_t consumer_thread_id[3];    for (int i = 0; i &lt; sizeof(consumer_thread_id) / sizeof(consumer_thread_id[0]); ++i)    &#123;        pthread_create(&amp;consumer_thread_id[i], NULL, consumer_thread_proc, NULL);    &#125;    //ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹é€€å‡º    for (int i = 0; i &lt; sizeof(producer_thread_id) / sizeof(producer_thread_id[0]); ++i)    &#123;        pthread_join(producer_thread_id[i], NULL);    &#125;    //ç­‰å¾…ç”Ÿäº§è€…çº¿ç¨‹é€€å‡º    for (int i = 0; i &lt; sizeof(consumer_thread_id) / sizeof(consumer_thread_id[0]); ++i)    &#123;        pthread_join(consumer_thread_id[i], NULL);    &#125;    uninit();    return 0;&#125;\n\næˆ‘ä»¬ä½¿ç”¨ g++ ç¼–è¯‘å™¨ç¼–è¯‘ä¸Šè¿°ä»£ç ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆå¯ç§»æ¤æ€§æ–‡ä»¶ AsyncLoggerLinuxï¼š\n1g++ -g -o AsyncLoggerLinux AsyncLoggerLinux.cpp -lpthread\n\næ¥ç€æ‰§è¡Œç”Ÿæˆçš„ AsyncLoggerLinux æ–‡ä»¶ï¼Œç„¶åç”Ÿæˆçš„æ—¥å¿—æ•ˆæœå¦‚ä¸‹ï¼š\n12345678910111213141516This is log, index: 1, producer threadID: 140512358795008This is log, index: 1, producer threadID: 140512367187712This is log, index: 1, producer threadID: 140512375580416This is log, index: 2, producer threadID: 140512358795008This is log, index: 2, producer threadID: 140512367187712This is log, index: 2, producer threadID: 140512375580416This is log, index: 3, producer threadID: 140512358795008This is log, index: 3, producer threadID: 140512367187712This is log, index: 3, producer threadID: 140512375580416This is log, index: 4, producer threadID: 140512358795008This is log, index: 4, producer threadID: 140512367187712This is log, index: 4, producer threadID: 140512375580416This is log, index: 5, producer threadID: 140512358795008This is log, index: 5, producer threadID: 140512367187712This is log, index: 5, producer threadID: 140512375580416//çœç•¥...\n\n\nå½“ç„¶ï¼Œæ‚¨å¯èƒ½éœ€è¦åŒæ—¶èƒ½åœ¨ Windows å’Œ Linux åŒæ—¶è¿è¡Œçš„ä»£ç ï¼Œæˆ‘ä»¬è‡ªç„¶è€Œç„¶æƒ³åˆ°ç”¨ C++11 è¯­æ³•çš„ä¿¡å·é‡ï¼Œç”±äº C++ 11 æœ¬èº«æ²¡æœ‰æä¾›ç°æˆçš„ä¿¡å·é‡åº“ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ©ç”¨std::mutexã€std::condition_variableæ¨¡æ‹Ÿä¸€ä¸‹ä¿¡å·é‡çš„åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸å†è¯¦ç»†ä»‹ç»äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œå°è¯•ä¸€ä¸‹ã€‚\n\nä»¥ä¸Šå°±æ˜¯å¼‚æ­¥æ—¥å¿—çš„åŸºæœ¬åŸç†ï¼Œåœ¨è¿™ä¸ªåŸç†çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ å¾ˆå¤šçš„ç‰¹æ€§ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/æ—¥å¿—ç³»ç»Ÿçš„è®¾è®¡","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"244b4809351f4fc8c6cac7d22fa4014d","title":"ã€è½¬è½½ã€‘é”™è¯¯ç ç³»ç»Ÿçš„è®¾è®¡","content":"é”™è¯¯ç ç³»ç»Ÿçš„è®¾è®¡\næœ¬æ–‡ä»‹ç»æœåŠ¡å™¨å¼€å‘ä¸­ä¸€ç»„æœåŠ¡ä¸­é”™è¯¯ç ç³»ç»Ÿçš„è®¾è®¡ç†å¿µä¸å®è·µï¼Œå¦‚æœè¯»è€…ä»æ¥æ²¡æƒ³è¿‡æˆ–è€…æ²¡æ¥è§¦è¿‡è¿™ç§è®¾è®¡ç†å¿µï¼Œå»ºè®®è®¤çœŸä½“ä¼šä¸€ä¸‹è¿™ç§è®¾è®¡æ€è·¯çš„ä¼˜ç‚¹ã€‚\n\né”™è¯¯ç çš„ä½œç”¨è¯»è€…å¦‚æœæœ‰ä½¿ç”¨è¿‡ä¸­å›½ç”µä¿¡çš„å®½å¸¦è´¦å·ä¸Šç½‘çš„ç»å†ï¼Œå¦‚æœæˆ‘ä»¬ç™»é™†ä¸æˆåŠŸï¼Œä¸€èˆ¬æœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ç ï¼Œå¦‚651ã€678ã€‚ç„¶åï¼Œæˆ‘ä»¬æ‰“ä¸­å›½ç”µä¿¡çš„å®¢æœç”µè¯ï¼Œå®¢æœä¼šè¯¢é—®æˆ‘ä»¬é”™è¯¯ç æ˜¯å¤šå°‘ï¼Œé€šè¿‡é”™è¯¯ç ä»–ä»¬çš„æŠ€æœ¯äººå‘˜å°±å¤§è‡´çŸ¥é“äº†é”™è¯¯åŸå› ï¼›å¹¶ä¸”é€šè¿‡é”™è¯¯ç ï¼Œä»–ä»¬å°±çŸ¥é“åˆ°åº•æ˜¯ç”µä¿¡çš„æœåŠ¡å™¨é—®é¢˜è¿˜æ˜¯å®½å¸¦ç”¨æˆ·è‡ªå·±çš„è®¾å¤‡æˆ–è€…æ“ä½œé—®é¢˜ï¼Œå¦‚æœæ˜¯ç”¨æˆ·è‡ªå·±çš„é—®é¢˜ï¼Œä»–ä»¬ä¸€èˆ¬ä¼šå°è¯•æ•™ç”¨æˆ·å¦‚ä½•æ“ä½œï¼Œè€Œä¸æ˜¯å†’ç„¶å°±æ´¾é£ç»´ä¿®äººå‘˜ä¸Šé—¨ï¼Œè¿™æ ·ä¸ä»…èƒ½å°½æ—©è§£å†³é—®é¢˜åŒæ—¶ä¹ŸèŠ‚çº¦äº†äººåŠ›æˆæœ¬ã€‚\nå†ä¸¾å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ—¥å¸¸æµè§ˆç½‘é¡µï¼Œå½“WebæœåŠ¡å™¨æ­£å¸¸è¿”å›é¡µé¢æ—¶ï¼ŒçŠ¶æ€ç ä¸€èˆ¬æ˜¯200(OK)ï¼Œè€Œå½“é¡µé¢ä¸å­˜åœ¨æ—¶ï¼Œé”™è¯¯ç ä¸€èˆ¬æ˜¯404ï¼Œå¦å¤–åƒ503ç­‰é”™è¯¯éƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„ã€‚\né€šè¿‡ä»¥ä¸Šä¸¤ä¸ªä¾‹å­ï¼Œè¯»è€…åº”è¯¥èƒ½æ˜ç™½ï¼Œå¯¹äºæœåŠ¡å™¨ç³»ç»Ÿæ¥è¯´ï¼Œè®¾è®¡ä¸€å¥—å¥½çš„é”™è¯¯ç æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œå¯ä»¥åœ¨ç”¨æˆ·è¯·æ±‚å‡ºé—®é¢˜æ—¶è¿…é€Ÿå®šä½å¹¶è§£å†³é—®é¢˜ã€‚å…·ä½“åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼š\n\nå¯ä»¥è¿…é€Ÿå®šä½æ˜¯ç”¨æˆ·â€œè¾“å…¥â€é—®é¢˜è¿˜æ˜¯æœåŠ¡å™¨è‡ªèº«çš„é—®é¢˜ã€‚\n\næ‰€è°“çš„ç”¨æˆ·â€œè¾“å…¥â€é—®é¢˜ï¼Œæ˜¯æŒ‡ç”¨æˆ·çš„ä¸å½“æ“ä½œï¼Œè¿™é‡Œçš„â€œç”¨æˆ·çš„ä¸å½“æ“ä½œâ€å¯èƒ½æ˜¯å› ä¸ºå®¢æˆ·ç«¯è½¯ä»¶æœ¬èº«çš„é€»è¾‘é”™è¯¯æˆ–æ¼æ´ï¼Œä¹Ÿå¯èƒ½æ˜¯ä½¿ç”¨å®¢æˆ·ç«¯çš„äººçš„éæ³•æ“ä½œï¼Œè€Œå®¢æˆ·ç«¯è½¯ä»¶åœ¨è®¾è®¡ä¸Šå› ä¸ºè€ƒè™‘ä¸å‘¨è€Œç¼ºä¹æœ‰æ•ˆæ€§æ ¡éªŒï¼Œè¿™ä¸¤ç±»æƒ…å½¢éƒ½å¯èƒ½ä¼šäº§ç”Ÿéæ³•çš„æ•°æ®ï¼Œå¹¶ä¸”ç›´æ¥å‘ç»™æœåŠ¡å™¨ã€‚ä¸€ä¸ªå¥½çš„æœåŠ¡ç«¯ç³»ç»Ÿä¸èƒ½å‡è®¾å®¢æˆ·ç«¯çš„è¯·æ±‚æ•°æ®ä¸€å®šæ˜¯åˆæ³•çš„ï¼Œå¿…é¡»å¯¹ä¼ è¿‡æ¥çš„æ•°æ®åšæœ‰æ•ˆæ€§æ ¡éªŒã€‚æœåŠ¡å™¨æ²¡æœ‰ä¹‰åŠ¡ä¸€å®šç»™éæ³•çš„è¯·æ±‚åšå‡ºåº”ç­”ï¼Œå› æ­¤è¯·æ±‚çš„æœ€ç»ˆç»“æœæ˜¯æœåŠ¡å™¨ä¸åº”ç­”æˆ–ç»™å®¢æˆ·ç«¯ä¸æƒ³è¦çš„åº”ç­”ã€‚\nä»¥ä¸Šé¢çš„ä¾‹å­ä¸ºä¾‹ï¼Œå®½å¸¦ç”¨æˆ·è¾“å…¥äº†æ— æ•ˆçš„ç”¨æˆ·åæˆ–è€…å¯†ç é€ æˆæœåŠ¡å™¨æ‹’ç»è®¿é—®ï¼›ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥äº†ä¸€ä¸ªæ— æ•ˆçš„ç½‘å€ç­‰ã€‚è¿™ç±»é”™è¯¯ï¼Œéƒ½æ˜¯éœ€è¦ç”¨æˆ·è‡ªå·±è§£å†³æˆ–è€…ç”¨æˆ·å¯ä»¥è‡ªå·±è§£å†³çš„ã€‚å¦‚æœé”™è¯¯ç å¯ä»¥åæ˜ å‡ºè¿™ç±»é”™è¯¯ï¼Œé‚£ä¹ˆåœ¨å®é™…æœåŠ¡å™¨è¿ç»´çš„è¿‡ç¨‹ä¸­ï¼Œå½“ç”¨æˆ·åé¦ˆè¿™ä¸€ç±»æ•…éšœæ—¶ï¼Œæˆ‘ä»¬é€šè¿‡æœåŠ¡å™¨å†…éƒ¨äº§ç”Ÿçš„é”™è¯¯ç æˆ–è€…åº”ç­”ç»™å®¢æˆ·ç«¯çš„é”™è¯¯ç ï¼Œå‡†ç¡®å¿«é€Ÿåœ°ç¡®å®šé—®é¢˜åŸå› ã€‚å¦‚æœæ˜¯ç”¨æˆ·éæ³•è¯·æ±‚é€ æˆçš„ï¼Œå¯ä»¥è®©ç”¨æˆ·è‡ªè¡Œè§£å†³ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„â€œç”¨æˆ·â€ï¼Œå¯ä»¥ä»£æŒ‡äººï¼Œä¹Ÿå¯ä»¥ä»£æŒ‡ä½¿ç”¨æŸä¸ªæœåŠ¡å™¨çš„æ‰€æœ‰ä¸‹æ¸¸æœåŠ¡å’Œå®¢æˆ·ç«¯ã€‚\n\nå¯ä»¥å¿«é€Ÿå®šä½å“ªä¸ªæ­¥éª¤æˆ–å“ªä¸ªæœåŠ¡å‡ºäº†é—®é¢˜ã€‚\nå¯¹äºå•ä¸ªæœåŠ¡ï¼Œå‡è®¾æ”¶åˆ°æŸä¸ªâ€œå®¢æˆ·ç«¯â€è¯·æ±‚æ—¶ï¼Œéœ€è¦ç»å†å¤šä¸ªæ­¥éª¤æ‰èƒ½å®Œæˆï¼Œè€Œè¿™ä¸­é—´ä»»ä½•ä¸€ä¸ªæ­¥éª¤éƒ½å¯èƒ½å‡ºé—®é¢˜ï¼Œåœ¨ä¸åŒæ­¥éª¤å‡ºé”™æ—¶è¿”å›ä¸åŒçš„é”™è¯¯ç ï¼Œé‚£ä¹ˆå°±å¯ä»¥çŸ¥é“æ˜¯å“ªä¸ªæ­¥éª¤å‡ºäº†é—®é¢˜ã€‚\nå…¶æ¬¡ï¼Œä¸€èˆ¬ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ç³»ç»Ÿï¼Œéƒ½ä¸æ˜¯å•ä¸ªæœåŠ¡ï¼Œå¾€å¾€æ˜¯ç”±ä¸€ç»„æœåŠ¡æ„æˆã€‚å¦‚æœå°†é”™è¯¯ç åˆ†æ®µï¼Œæ¯ä¸ªæœåŠ¡çš„é”™è¯¯ç éƒ½æœ‰å„è‡ªçš„èŒƒå›´ï¼Œé‚£ä¹ˆé€šè¿‡é”™è¯¯ç ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å‡†ç¡®åœ°çŸ¥é“æ˜¯å“ªä¸ªæœåŠ¡å‡ºäº†é—®é¢˜ã€‚\n\n\né”™è¯¯ç ç³»ç»Ÿè®¾è®¡å®è·µå‰é¢ä»‹ç»äº†å¤ªå¤šçš„ç†è®ºçŸ¥è¯†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚å‡è®¾å¦‚ä¸‹ä¸€ä¸ªâ€œæ™ºèƒ½é‚®ä»¶ç³»ç»Ÿâ€ï¼Œå…¶ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š\n\nä¸Šå›¾ä¸­çš„æœåŠ¡â€œæ™ºèƒ½é‚®ä»¶åå¸­ç«™ç‚¹â€å’Œâ€œé…ç½®ç«™ç‚¹â€æ˜¯å®¢æˆ·ç«¯ï¼Œâ€æ™ºèƒ½é‚®ä»¶æ“ä½œç»¼åˆæ¥å£â€œå’Œâ€é‚®ä»¶é…ç½®æœåŠ¡â€œæ˜¯å¯¹å®¢æˆ·ç«¯æä¾›æœåŠ¡çš„å‰ç½®æœåŠ¡ï¼Œè¿™ä¸¤ä¸ªå‰ç½®æœåŠ¡åé¢è¿˜ä¾èµ–åé¢çš„æ•°ä¸ªæœåŠ¡ã€‚ç”±äºè¿™é‡Œæˆ‘ä»¬è¦è¯´æ˜çš„æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡é—®é¢˜ï¼Œæ‰€ä»¥å…·ä½“æ¯ä¸ªæœåŠ¡ä½œä½•ç”¨é€”è¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œå½“å®¢æˆ·ç«¯å¾—åˆ°å‰ç½®æœåŠ¡æŸä¸ªä¸æ­£ç¡®åº”ç­”æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ç ï¼Œæˆ‘ä»¬æŒ‰ä»¥ä¸‹è§„åˆ™æ¥è®¾è®¡é”™è¯¯ç ï¼š\n\n\n\næœåŠ¡åç§°\næ­£å€¼é”™è¯¯ç èŒƒå›´\nè´Ÿå€¼é”™è¯¯ç èŒƒå›´\n\n\n\næ™ºèƒ½é‚®ä»¶ç»¼åˆæ“ä½œæ¥å£\n100~199\n-100~-199\n\n\nESæ•°æ®åŒæ­¥æœåŠ¡\n200~299\n-200~-299\n\n\né‚®ä»¶é…ç½®æœåŠ¡\n300~399\n-300~-399\n\n\né‚®ä»¶åŸºç¡€æœåŠ¡\n400~499\n-400~-499\n\n\næˆ‘ä»¬åœ¨è®¾è®¡è¿™å¥—ç³»ç»Ÿæ—¶ï¼Œåšå¦‚ä¸‹è§„å®šï¼š\n\næ‰€æœ‰çš„æ­£å€¼é”™è¯¯ç è¡¨ç¤ºæ‰€åœ¨æœåŠ¡çš„ä¸Šæ¸¸æœåŠ¡å‘æ¥çš„è¯·æ±‚ä¸æ»¡è¶³ä¸šåŠ¡è¦æ±‚ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æŸæ¬¡æ™ºèƒ½é‚®ä»¶åå¸­ç«™ç‚¹å®¢æˆ·ç«¯å¾—åˆ°äº†ä¸€ä¸ªé”™è¯¯ç 101ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç¡®å®šé”™è¯¯äº§ç”Ÿçš„æœåŠ¡å™¨æ˜¯æ™ºèƒ½é‚®ä»¶ç»¼åˆæ“ä½œæ¥å£æœåŠ¡ï¼›å…¶æ¬¡ï¼Œäº§ç”Ÿè¯¥é”™è¯¯çš„åŸå› æ˜¯æ™ºèƒ½é‚®ä»¶åå¸­ç«™ç‚¹å®¢æˆ·ç«¯å‘é€ç»™æ™ºèƒ½é‚®ä»¶ç»¼åˆæ“ä½œæ¥å£æœåŠ¡çš„è¯·æ±‚ä¸æ»¡è¶³è¦æ±‚ï¼Œé€šè¿‡è¿™ä¸ªé”™è¯¯ç æˆ‘ä»¬ç”šè‡³å¯ä»¥è¿›ä¸€æ­¥ç¡®å®šå‘é€çš„è¯·æ±‚å“ªé‡Œä¸ç¬¦åˆè¦æ±‚ã€‚å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ï¼š\n\n\n100 ç”¨æˆ·åä¸å­˜åœ¨\n\n101 å¯†ç æ— æ•ˆ\n\n102 å‘é€çš„é‚®ä»¶æ”¶ä»¶äººéæ³•\n\n103 é‚®ä»¶æ­£æ–‡å«æœ‰éæ³•å­—ç¬¦\nå…¶ä»–ä»ç•¥ï¼Œæ­¤å¤„å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚\n\n\n\næ‰€æœ‰çš„è´Ÿå€¼é”™è¯¯ç è¡¨ç¤ºç¨‹åºå†…éƒ¨é”™è¯¯ã€‚å¦‚ï¼š\n\n\n-100 æ•°æ®åº“æ“ä½œé”™è¯¯\n\n-101 ç½‘ç»œé”™è¯¯\n\n-102 å†…å­˜åˆ†é…å¤±è´¥\n\n-103 ESæ•°æ®åŒæ­¥æœåŠ¡è¿æ¥ä¸ä¸Š\nå…¶ä»–ä»ç•¥ï¼Œæ­¤å¤„å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚\nå¯¹è´Ÿå€¼é”™è¯¯ç çš„ç‰¹æ®Šå¤„ç†\n\né€šè¿‡å‰é¢çš„ä»‹ç»ï¼Œè¯»è€…åº”è¯¥èƒ½çœ‹å‡ºæ­£å€¼é”™è¯¯ç ä¸è´Ÿå€¼é”™è¯¯ç çš„åŒºåˆ«ï¼Œå³æ­£å€¼é”™è¯¯ç ä¸€èˆ¬æ˜¯ç”±è¯·æ±‚æœåŠ¡çš„å®¢æˆ·äº§ç”Ÿï¼Œå¦‚æœå‡ºç°è¿™æ ·çš„é”™è¯¯ï¼Œåº”è¯¥ç”±å®¢æˆ·è‡ªå·±å»è§£å†³é—®é¢˜ï¼›è€Œè´Ÿå€¼é”™è¯¯ç ï¼Œåˆ™ä¸€èˆ¬æ˜¯æœåŠ¡å†…éƒ¨äº§ç”Ÿçš„é”™è¯¯ã€‚å› æ­¤ï¼Œå¦‚æœæ˜¯æ­£å€¼é”™è¯¯ç ï¼Œé”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯ä¸€èˆ¬å¯ä»¥ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼›è€Œå¯¹äºè´Ÿå€¼é”™è¯¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬åªå°†é”™è¯¯ç è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸å¸¦ä¸Šå…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯è¯»è€…åœ¨ä½¿ç”¨å¾ˆå¤šè½¯ä»¶äº§å“æ—¶ï¼Œç»å¸¸ä¼šå¾—åˆ°â€œç½‘ç»œé”™è¯¯â€è¿™ç±»ä¸‡èƒ½é”™è¯¯æç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´å¯¹äºè´Ÿå€¼é”™è¯¯ç çš„é”™è¯¯ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€æ˜¾ç¤ºæˆâ€œç½‘ç»œé”™è¯¯â€æˆ–è€…å…¶ä»–æ¯”è¾ƒå‹å¥½çš„é”™è¯¯æç¤ºã€‚\nè¿™æ ·åšçš„åŸå› æœ‰äºŒï¼š\n\nå®¢æˆ·ç«¯å³ä½¿æ‹¿åˆ°è¿™æ ·çš„é”™è¯¯ä¿¡æ¯ï¼Œä¹Ÿä¸èƒ½å¯¹æ’æŸ¥å’Œè§£å†³é—®é¢˜æä¾›ä»»ä½•å¸®åŠ©ï¼Œå› ä¸ºè¿™äº›é”™è¯¯æ˜¯ç¨‹åºå†…éƒ¨é”™è¯¯æˆ–è€…bugã€‚\nè¿™ç±»é”™è¯¯æœ‰å¯èƒ½æ˜¯ä¼ä¸šå†…éƒ¨çš„è®¾è®¡ç¼ºé™·ï¼Œç›´æ¥æš´éœ²ç»™å®¢æˆ·ï¼Œé™¤äº†è®©å®¢æˆ·å¯¹ä¼ä¸šçš„æŠ€æœ¯å®åŠ›äº§ç”Ÿè´¨ç–‘ä»¥å¤–ï¼Œæ²¡æœ‰ä»»ä½•å…¶ä»–æ­£é¢æ•ˆåº”ã€‚\n\nè€Œä¹‹æ‰€ä»¥å¸¦ä¸Šé”™è¯¯ç ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿å†…éƒ¨æ’æŸ¥å’Œå®šä½é—®é¢˜ã€‚å½“ç„¶ï¼Œç°åœ¨çš„ä¼ä¸šæœåŠ¡ï¼Œå†…éƒ¨ä¹Ÿæœ‰å¤§é‡ç›‘æ§ç³»ç»Ÿï¼Œå¯èƒ½ä¹Ÿä¸ä¼šå†æš´éœ²è¿™æ ·çš„é”™è¯¯ç äº†ã€‚\næ‰©å±•ä¸Šæ–‡ä»‹ç»äº†åˆ©ç”¨é”™è¯¯ç çš„åˆ†æ®µæ¥å®šä½é—®é¢˜çš„æŠ€æœ¯æ€æƒ³ï¼Œå…¶å®ä¸ä»…ä»…æ˜¯é”™è¯¯ç å¯ä»¥åˆ†æ®µï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸€ç»„æœåŠ¡æ—¶ï¼Œä¸šåŠ¡ç±»å‹ä¹Ÿå¯ä»¥é€šè¿‡ç¼–å·æ¥åˆ†æ®µï¼Œè¿™æ ·é€šè¿‡ä¸šåŠ¡å·å°±èƒ½çŸ¥é“å½’å±å“ªä¸ªæœåŠ¡äº†ã€‚\nå¦‚æœè¯»è€…ä»¥å‰æ²¡æ¥è§¦è¿‡è¿™ç§è®¾è®¡æ€æƒ³ï¼Œå¸Œæœ›å¯ä»¥å¥½å¥½çš„æ€è€ƒå’Œä½“ä¼šä¸€ä¸‹ã€‚\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/é”™è¯¯ç ç³»ç»Ÿçš„è®¾è®¡","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"10a9cf5937dc7bc9f3410b780f114a73","title":"ã€è½¬è½½ã€‘é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“","content":"é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“ç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\nè¿™ç¯‡æ–‡ç« ç®—æ˜¯å¯¹è¿™ä¸ªç³»åˆ—çš„ä¸€ä¸ªç³»ç»Ÿæ€§åœ°æ€»ç»“ã€‚æˆ‘ä»¬å°†ä»‹ç»æœåŠ¡å™¨çš„å¼€å‘ï¼Œå¹¶ä»å¤šä¸ªæ–¹é¢æ¢ç©¶å¦‚ä½•å¼€å‘ä¸€æ¬¾é«˜æ€§èƒ½é«˜å¹¶å‘çš„æœåŠ¡å™¨ç¨‹åºã€‚\næ‰€è°“é«˜æ€§èƒ½å°±æ˜¯æœåŠ¡å™¨èƒ½æµç•…åœ°å¤„ç†å„ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥å¹¶å°½é‡ä½å»¶è¿Ÿåœ°åº”ç­”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼›æ‰€è°“é«˜å¹¶å‘ï¼ŒæŒ‡çš„æ˜¯æœåŠ¡å™¨å¯ä»¥åŒæ—¶æ”¯æŒå¤šçš„å®¢æˆ·ç«¯è¿æ¥ï¼Œä¸”è¿™äº›å®¢æˆ·ç«¯åœ¨è¿æ¥æœŸé—´å†…ä¼šä¸æ–­ä¸æœåŠ¡å™¨æœ‰æ•°æ®æ¥å¾€ã€‚\nè¿™ç¯‡æ–‡ç« å°†ä»ä¸¤ä¸ªæ–¹é¢æ¥ä»‹ç»ï¼Œä¸€ä¸ªæ˜¯æœåŠ¡å™¨çš„æ¡†æ¶ï¼Œå³å•ä¸ªæœåŠ¡å™¨ç¨‹åºçš„ä»£ç ç»„ç»‡ç»“æ„ï¼›å¦å¤–ä¸€ä¸ªæ˜¯ä¸€ç»„æœåŠ¡ç¨‹åºçš„å¦‚ä½•ç»„ç»‡ä¸äº¤äº’ï¼Œå³æ¶æ„ã€‚æ³¨æ„ï¼šæœ¬æ–‡ä»¥ä¸‹å†…å®¹ä¸­çš„å®¢æˆ·ç«¯æ˜¯ç›¸å¯¹æ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯è¿æ¥åˆ°å½“å‰è®¨è®ºçš„æœåŠ¡ç¨‹åºçš„ç»ˆç«¯ï¼Œæ‰€ä»¥è¿™é‡Œçš„å®¢æˆ·ç«¯æ—¢å¯èƒ½æ˜¯æˆ‘ä»¬ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å®¢æˆ·ç«¯ç¨‹åºï¼Œä¹Ÿå¯èƒ½æ˜¯è¿æ¥è¯¥æœåŠ¡çš„å…¶ä»–æœåŠ¡å™¨ç¨‹åºã€‚\nä¸€ã€æ¡†æ¶ç¯‡æŒ‰ä¸Šé¢ä»‹ç»çš„æ€è·¯ï¼Œæˆ‘ä»¬å…ˆä»å•ä¸ªæœåŠ¡ç¨‹åºçš„ç»„ç»‡ç»“æ„å¼€å§‹ä»‹ç»ã€‚\nï¼ˆä¸€ï¼‰ã€ç½‘ç»œé€šä¿¡æ—¢ç„¶æ˜¯æœåŠ¡å™¨ç¨‹åºè‚¯å®šä¼šæ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡éƒ¨åˆ†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç¨‹åºçš„ç½‘ç»œé€šä¿¡æ¨¡å—è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿ\nç¬”è€…è®¤ä¸ºè‡³å°‘è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š\n\nå¦‚ä½•æ£€æµ‹æœ‰æ–°å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\nå¦‚ä½•æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\nå¦‚ä½•æ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ•°æ®å‘æ¥ï¼Ÿ\nå¦‚ä½•æ”¶å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Ÿ\nå¦‚ä½•æ£€æµ‹è¿æ¥å¼‚å¸¸ï¼Ÿå‘ç°è¿æ¥å¼‚å¸¸ä¹‹åï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ\nå¦‚ä½•ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Ÿ\nå¦‚ä½•åœ¨ç»™å®¢æˆ·ç«¯å‘å®Œæ•°æ®åå…³é—­è¿æ¥ï¼Ÿ\n\nç¨å¾®æœ‰ç‚¹ç½‘ç»œåŸºç¡€çš„äººï¼Œéƒ½èƒ½å›ç­”ä¸Šé¢è¯´çš„å…¶ä¸­å‡ ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ç”¨socket APIçš„acceptå‡½æ•°ï¼Œæ”¶å–å®¢æˆ·ç«¯æ•°æ®ç”¨recvå‡½æ•°ï¼Œç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ç”¨sendå‡½æ•°ï¼Œæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ–°è¿æ¥å’Œå®¢æˆ·ç«¯æ˜¯å¦æœ‰æ–°æ•°æ®å¯ä»¥ç”¨IO multiplexingæŠ€æœ¯ï¼ˆIOå¤ç”¨ï¼‰çš„selectã€pollã€epollç­‰socket APIã€‚ç¡®å®æ˜¯è¿™æ ·çš„ï¼Œè¿™äº›åŸºç¡€çš„socket APIæ„æˆäº†æœåŠ¡å™¨ç½‘ç»œé€šä¿¡çš„åœ°åŸºï¼Œä¸ç®¡ç½‘ç»œé€šä¿¡æ¡†æ¶è®¾è®¡çš„å¦‚ä½•å·§å¦™ï¼Œéƒ½æ˜¯åœ¨è¿™äº›åŸºç¡€çš„socket APIçš„åŸºç¡€ä¸Šæ„å»ºçš„ã€‚ä½†æ˜¯å¦‚ä½•å·§å¦™åœ°ç»„ç»‡è¿™äº›åŸºç¡€çš„socket APIï¼Œæ‰æ˜¯é—®é¢˜çš„å…³é”®ã€‚æˆ‘ä»¬è¯´æœåŠ¡å™¨å¾ˆé«˜æ•ˆï¼Œæ”¯æŒé«˜å¹¶å‘ï¼Œå®é™…ä¸Šåªæ˜¯ä¸€ä¸ªæŠ€æœ¯å®ç°æ‰‹æ®µï¼Œä¸ç®¡æ€æ ·ä»è½¯ä»¶å¼€å‘çš„è§’åº¦æ¥è®²æ— éå°±æ˜¯ä¸€ä¸ªç¨‹åºè€Œå·²ï¼Œæ‰€ä»¥ï¼Œåªè¦ç¨‹åºèƒ½æœ€å¤§å¯èƒ½åœ°æ»¡è¶³â€œå°½é‡å‡å°‘ç­‰å¾…â€å°±æ˜¯é«˜æ•ˆã€‚ä¹Ÿå°±æ˜¯è¯´é«˜æ•ˆä¸æ˜¯â€œå¿™çš„å¿™æ­»ï¼Œé—²çš„é—²æ­»â€ï¼Œè€Œæ˜¯å¤§å®¶éƒ½å¯ä»¥é—²ç€ï¼Œä½†æ˜¯å¦‚æœæœ‰æ´»è¦å¹²ï¼Œå¤§å®¶å°½é‡ä¸€èµ·å¹²ï¼Œè€Œä¸æ˜¯ä¸€éƒ¨åˆ†å¿™ç€ä¾æ¬¡åšäº‹æƒ…123456789ï¼Œå¦å¤–ä¸€éƒ¨åˆ†é—²åœ¨é‚£é‡Œæ— æ‰€äº‹äº‹ã€‚è¯´çš„å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸¾ä¸€äº›ä¾‹å­å…·ä½“æ¥è¯´æ˜ä¸€ä¸‹ã€‚\næ¯”å¦‚é»˜è®¤recvå‡½æ•°å¦‚æœæ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œçº¿ç¨‹å°±ä¼šé˜»å¡åœ¨é‚£é‡Œï¼›é»˜è®¤sendå‡½æ•°ï¼Œå¦‚æœtcpçª—å£ä¸æ˜¯è¶³å¤Ÿå¤§ï¼Œæ•°æ®å‘ä¸å‡ºå»ä¹Ÿä¼šé˜»å¡åœ¨é‚£é‡Œï¼›connectå‡½æ•°é»˜è®¤è¿æ¥å¦å¤–ä¸€ç«¯çš„æ—¶å€™ï¼Œä¹Ÿä¼šé˜»å¡åœ¨é‚£é‡Œï¼›åˆæˆ–è€…æ˜¯ç»™å¯¹ç«¯å‘é€ä¸€ä»½æ•°æ®ï¼Œéœ€è¦ç­‰å¾…å¯¹ç«¯å›ç­”ï¼Œå¦‚æœå¯¹æ–¹ä¸€ç›´ä¸åº”ç­”ï¼Œå½“å‰çº¿ç¨‹å°±é˜»å¡åœ¨è¿™é‡Œã€‚ä»¥ä¸Šéƒ½ä¸æ˜¯é«˜æ•ˆæœåŠ¡å™¨çš„å¼€å‘æ€ç»´æ–¹å¼ï¼Œå› ä¸ºä¸Šé¢çš„ä¾‹å­éƒ½ä¸æ»¡è¶³â€œå°½é‡å‡å°‘ç­‰å¾…â€çš„åŸåˆ™ï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦ç­‰å¾…å‘¢ï¼Ÿæœ‰æ²¡ç”¨ä¸€ç§æ–¹æ³•ï¼Œè¿™äº›è¿‡ç¨‹ä¸éœ€è¦ç­‰å¾…ï¼Œæœ€å¥½æ˜¯ä¸ä»…ä¸éœ€è¦ç­‰å¾…ï¼Œè€Œä¸”è¿™äº›äº‹æƒ…å®Œæˆä¹‹åèƒ½é€šçŸ¥æˆ‘ã€‚è¿™æ ·åœ¨è¿™äº›æœ¬æ¥ç”¨äºç­‰å¾…çš„cpuæ—¶é—´ç‰‡å†…ï¼Œæˆ‘å°±å¯ä»¥åšä¸€äº›å…¶ä»–çš„äº‹æƒ…ã€‚æœ‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸‹æ–‡è¦è®¨è®ºçš„IO MultiplexingæŠ€æœ¯ï¼ˆIOå¤ç”¨æŠ€æœ¯ï¼‰ã€‚\nï¼ˆäºŒï¼‰ã€å‡ ç§IOå¤ç”¨æœºåˆ¶çš„æ¯”è¾ƒç›®å‰windowsç³»ç»Ÿæ”¯æŒselectã€WSAAsyncSelectã€WSAEventSelectã€å®Œæˆç«¯å£ï¼ˆIOCPï¼‰ï¼Œlinuxç³»ç»Ÿæ”¯æŒselectã€pollã€epollã€‚è¿™é‡Œæˆ‘ä»¬ä¸å…·ä½“ä»‹ç»æ¯ä¸ªå…·ä½“çš„å‡½æ•°çš„ç”¨æ³•ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ç‚¹æ·±å±‚æ¬¡çš„ä¸œè¥¿ï¼Œä»¥ä¸Šåˆ—ä¸¾çš„APIå‡½æ•°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå±‚æ¬¡ï¼š\n\nå±‚æ¬¡ä¸€ selectå’Œpoll\nå±‚æ¬¡äºŒ WSAAsyncSelectã€WSAEventSelectã€å®Œæˆç«¯å£ï¼ˆIOCPï¼‰ã€epoll\n\nä¸ºä»€ä¹ˆè¿™ä¹ˆåˆ†å‘¢ï¼Ÿå…ˆæ¥ä»‹ç»ç¬¬ä¸€å±‚æ¬¡ï¼Œselectå’Œpollå‡½æ•°æœ¬è´¨ä¸Šè¿˜æ˜¯åœ¨ä¸€å®šæ—¶é—´å†…ä¸»åŠ¨å»æŸ¥è¯¢socketå¥æŸ„ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªä¹Ÿå¯èƒ½æ˜¯å¤šä¸ªï¼‰ä¸Šæ˜¯å¦æœ‰äº‹ä»¶ï¼Œæ¯”å¦‚å¯è¯»äº‹ä»¶ï¼Œå¯å†™äº‹ä»¶æˆ–è€…å‡ºé”™äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´å†…å»ä¸»åŠ¨å»åšè¿™äº›æ£€æµ‹ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…æ£€æµ‹å‡ºä¸€äº›äº‹ä»¶æ¥ï¼Œæˆ‘ä»¬è¿™æ®µæ—¶é—´å°±ç®—æ²¡ç™½èŠ±ï¼Œä½†æ˜¯å€˜è‹¥è¿™æ®µæ—¶é—´å†…æ²¡æœ‰äº‹ä»¶å‘¢ï¼Ÿæˆ‘ä»¬åªèƒ½æ˜¯åšæ— ç”¨åŠŸäº†ï¼Œè¯´ç™½äº†ï¼Œè¿˜æ˜¯åœ¨æµªè´¹æ—¶é—´ï¼Œå› ä¸ºå‡å¦‚ä¸€ä¸ªæœåŠ¡å™¨æœ‰å¤šä¸ªè¿æ¥ï¼Œåœ¨cpuæ—¶é—´ç‰‡æœ‰é™çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬èŠ±è´¹äº†ä¸€å®šçš„æ—¶é—´æ£€æµ‹äº†ä¸€éƒ¨åˆ†socketè¿æ¥ï¼Œå´å‘ç°å®ƒä»¬ä»€ä¹ˆäº‹ä»¶éƒ½æ²¡æœ‰ï¼Œè€Œåœ¨è¿™æ®µæ—¶é—´å†…æˆ‘ä»¬å´æœ‰ä¸€äº›äº‹æƒ…éœ€è¦å¤„ç†ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦èŠ±æ—¶é—´å»åšè¿™ä¸ªæ£€æµ‹å‘¢ï¼ŸæŠŠè¿™ä¸ªæ—¶é—´ç”¨åœ¨åšæˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…ä¸å¥½å—ï¼Ÿæ‰€ä»¥å¯¹äºæœåŠ¡å™¨ç¨‹åºæ¥è¯´ï¼Œè¦æƒ³é«˜æ•ˆï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å…èŠ±è´¹æ—¶é—´ä¸»åŠ¨å»æŸ¥è¯¢ä¸€äº›socketæ˜¯å¦æœ‰äº‹ä»¶ï¼Œè€Œæ˜¯ç­‰è¿™äº›socketæœ‰äº‹ä»¶çš„æ—¶å€™å‘Šè¯‰æˆ‘ä»¬å»å¤„ç†ã€‚è¿™ä¹Ÿå°±æ˜¯å±‚æ¬¡äºŒçš„å„ä¸ªå‡½æ•°åšçš„äº‹æƒ…ï¼Œå®ƒä»¬å®é™…ç›¸å½“äºå˜ä¸»åŠ¨æŸ¥è¯¢æ˜¯å¦æœ‰äº‹ä»¶ä¸ºå½“æœ‰äº‹ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šå‘Šè¯‰æˆ‘ä»¬ï¼Œæ­¤æ—¶æˆ‘ä»¬å†å»å¤„ç†ï¼Œä¹Ÿå°±æ˜¯â€œå¥½é’¢ç”¨åœ¨åˆ€åˆƒâ€ä¸Šäº†ã€‚åªä¸è¿‡å±‚æ¬¡äºŒçš„å‡½æ•°é€šçŸ¥æˆ‘ä»¬çš„æ–¹å¼æ˜¯å„ä¸ç›¸åŒï¼Œæ¯”å¦‚WSAAsyncSelectæ˜¯åˆ©ç”¨windowsæ¶ˆæ¯é˜Ÿåˆ—çš„äº‹ä»¶æœºåˆ¶æ¥é€šçŸ¥æˆ‘ä»¬è®¾å®šçš„çª—å£è¿‡ç¨‹å‡½æ•°ï¼ŒIOCPæ˜¯åˆ©ç”¨GetQueuedCompletionStatusè¿”å›æ­£ç¡®çš„çŠ¶æ€ï¼Œepollæ˜¯epoll_waitå‡½æ•°è¿”å›è€Œå·²ã€‚\næ¯”å¦‚connectå‡½æ•°è¿æ¥å¦å¤–ä¸€ç«¯ï¼Œå¦‚æœè¿æ¥socketæ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆconnectè™½ç„¶ä¸èƒ½ç«‹åˆ»è¿æ¥å®Œæˆï¼Œä½†æ˜¯ä¹Ÿæ˜¯ä¼šç«‹åˆ»è¿”å›ï¼Œæ— éœ€ç­‰å¾…ï¼Œç­‰è¿æ¥å®Œæˆä¹‹åï¼ŒWSAAsyncSelectä¼šè¿”å›FD_CONNECTäº‹ä»¶å‘Šè¯‰æˆ‘ä»¬è¿æ¥æˆåŠŸï¼Œepollä¼šäº§ç”ŸEPOLLOUTäº‹ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çŸ¥é“è¿æ¥å®Œæˆã€‚ç”šè‡³socketæœ‰æ•°æ®å¯è¯»æ—¶ï¼ŒWSAAsyncSelectäº§ç”ŸFD_READäº‹ä»¶ï¼Œepolläº§ç”ŸEPOLLINäº‹ä»¶ï¼Œç­‰ç­‰ã€‚\næ‰€ä»¥æœ‰äº†ä¸Šé¢çš„è®¨è®ºï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ç½‘ç»œé€šä¿¡æ£€æµ‹å¯è¯»å¯å†™æˆ–è€…å‡ºé”™äº‹ä»¶çš„æ­£ç¡®å§¿åŠ¿ã€‚è¿™æ˜¯æˆ‘è¿™é‡Œæå‡ºçš„ç¬¬äºŒä¸ªåŸåˆ™ï¼šå°½é‡å‡å°‘åšæ— ç”¨åŠŸçš„æ—¶é—´ã€‚è¿™ä¸ªåœ¨æœåŠ¡ç¨‹åºèµ„æºå¤Ÿç”¨çš„æƒ…å†µä¸‹å¯èƒ½ä½“ç°ä¸å‡ºæ¥ä»€ä¹ˆä¼˜åŠ¿ï¼Œä½†æ˜¯å¦‚æœæœ‰å¤§é‡çš„ä»»åŠ¡è¦å¤„ç†ï¼Œä¸ªäººè§‰å¾—è¿™ä¸ªå¯èƒ½å¸¦æ¥æ— ç”¨ã€‚\nï¼ˆä¸‰ï¼‰ã€æ£€æµ‹ç½‘ç»œäº‹ä»¶çš„æ­£ç¡®å§¿åŠ¿æ ¹æ®ä¸Šé¢çš„ä»‹ç»ï¼Œç¬¬ä¸€ï¼Œä¸ºäº†é¿å…æ— æ„ä¹‰çš„ç­‰å¾…æ—¶é—´ï¼Œç¬¬äºŒï¼Œä¸é‡‡ç”¨ä¸»åŠ¨æŸ¥è¯¢å„ä¸ªsocketçš„äº‹ä»¶ï¼Œè€Œæ˜¯é‡‡ç”¨ç­‰å¾…æ“ä½œç³»ç»Ÿé€šçŸ¥æˆ‘ä»¬æœ‰äº‹ä»¶çš„çŠ¶æ€çš„ç­–ç•¥ã€‚æˆ‘ä»¬çš„socketéƒ½è¦è®¾ç½®æˆå¼‚æ­¥çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬å›åˆ°æ ç›®ï¼ˆä¸€ï¼‰ä¸­æåˆ°çš„ä¸ƒä¸ªé—®é¢˜ï¼š\n\nå¦‚ä½•æ£€æµ‹æœ‰æ–°å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\n\nå¦‚ä½•æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Ÿ\né»˜è®¤acceptå‡½æ•°ä¼šé˜»å¡åœ¨é‚£é‡Œï¼Œå¦‚æœepollæ£€æµ‹åˆ°ä¾¦å¬socketä¸Šæœ‰EPOLLINäº‹ä»¶ï¼Œæˆ–è€…WSAAsyncSelectæ£€æµ‹åˆ°æœ‰FD_ACCEPTäº‹ä»¶ï¼Œé‚£ä¹ˆå°±è¡¨æ˜æ­¤æ—¶æœ‰æ–°è¿æ¥åˆ°æ¥ï¼Œè¿™ä¸ªæ—¶å€™è°ƒç”¨acceptå‡½æ•°ï¼Œå°±ä¸ä¼šé˜»å¡äº†ã€‚å½“ç„¶äº§ç”Ÿçš„æ–°socketä½ åº”è¯¥ä¹Ÿè®¾ç½®æˆéé˜»å¡çš„ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨æ–°socketä¸Šæ”¶å‘æ•°æ®äº†ã€‚\n\nå¦‚ä½•æ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ•°æ®å‘æ¥ï¼Ÿ\n\nå¦‚ä½•æ”¶å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Ÿ\nåŒç†ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥åœ¨socketä¸Šæœ‰å¯è¯»äº‹ä»¶çš„æ—¶å€™æ‰å»æ”¶å–æ•°æ®ï¼Œè¿™æ ·æˆ‘ä»¬è°ƒç”¨recvæˆ–è€…readå‡½æ•°æ—¶ä¸ç”¨ç­‰å¾…ã€‚\nè‡³äºä¸€æ¬¡æ€§æ”¶å¤šå°‘æ•°æ®å¥½å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šï¼Œç”šè‡³ä½ å¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢åå¤recvæˆ–è€…readï¼Œå¯¹äºéé˜»å¡æ¨¡å¼çš„socketï¼Œå¦‚æœæ²¡æœ‰æ•°æ®äº†ï¼Œrecvæˆ–è€…readä¹Ÿä¼šç«‹åˆ»è¿”å›ï¼Œé”™è¯¯ç EWOULDBLOCKä¼šè¡¨æ˜å½“å‰å·²ç»æ²¡æœ‰æ•°æ®äº†ã€‚ç¤ºä¾‹ï¼š\n1234567891011121314151617181920212223242526 1bool CIUSocket::Recv()   2&#123;   3    int nRet = 0;   4 5    while(true)   6    &#123;   7        char buff[512];   8        nRet = ::recv(m_hSocket, buff, 512, 0); 9     //ä¸€æ—¦å‡ºç°é”™è¯¯å°±ç«‹åˆ»å…³é—­Socket    10    if(nRet == SOCKET_ERROR)11    &#123;  12        if (::WSAGetLastError() == WSAEWOULDBLOCK)  13           break;   14        else  15            return false;  16    &#125;  17    else if(nRet &lt; 1)  18        return false;  1920        m_strRecvBuf.append(buff, nRet);  2122        ::Sleep(1);  23    &#125;   2425    return true;  26&#125;  \n\nå¦‚ä½•æ£€æµ‹è¿æ¥å¼‚å¸¸ï¼Ÿå‘ç°è¿æ¥å¼‚å¸¸ä¹‹åï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ\nåŒæ ·å½“æˆ‘ä»¬æ”¶åˆ°å¼‚å¸¸äº‹ä»¶åä¾‹å¦‚EPOLLERRæˆ–å…³é—­äº‹ä»¶FD_CLOSEï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†æœ‰å¼‚å¸¸äº§ç”Ÿï¼Œæˆ‘ä»¬å¯¹å¼‚å¸¸çš„å¤„ç†ä¸€èˆ¬å°±æ˜¯å…³é—­å¯¹åº”çš„socketã€‚å¦å¤–ï¼Œå¦‚æœsend&#x2F;recvæˆ–è€…read&#x2F;writeå‡½æ•°å¯¹ä¸€ä¸ªsocketè¿›è¡Œæ“ä½œæ—¶ï¼Œå¦‚æœè¿”å›0ï¼Œé‚£è¯´æ˜å¯¹ç«¯å·²ç»å…³é—­äº†socketï¼Œæ­¤æ—¶è¿™è·¯è¿æ¥ä¹Ÿæ²¡å¿…è¦å­˜åœ¨äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å…³é—­å¯¹åº”çš„socketã€‚\n\nå¦‚ä½•ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Ÿ\nç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œæ¯”æ”¶æ•°æ®è¦ç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œä¹Ÿæ˜¯éœ€è¦è®²ç‚¹æŠ€å·§çš„ã€‚é¦–å…ˆæˆ‘ä»¬ä¸èƒ½åƒæ£€æµ‹æ•°æ®å¯è¯»ä¸€æ ·æ£€æµ‹æ•°æ®å¯å†™ï¼Œå› ä¸ºå¦‚æœæ£€æµ‹å¯å†™çš„è¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªè¦å¯¹ç«¯æ­£å¸¸æ”¶å–æ•°æ®ï¼Œæˆ‘ä»¬çš„socketå°±éƒ½æ˜¯å¯å†™çš„ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®ç›‘å¬å¯å†™äº‹ä»¶ï¼Œä¼šå¯¼è‡´é¢‘ç¹åœ°è§¦å‘å¯å†™äº‹ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æ­¤æ—¶å¹¶ä¸ä¸€å®šæœ‰æ•°æ®éœ€è¦å‘é€ã€‚æ‰€ä»¥æ­£ç¡®çš„åšæ³•æ˜¯ï¼šå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™å…ˆå°è¯•ç€å»å‘é€ï¼Œå¦‚æœå‘é€ä¸äº†æˆ–è€…åªå‘é€å‡ºå»éƒ¨åˆ†ï¼Œå‰©ä¸‹çš„æˆ‘ä»¬éœ€è¦å°†å…¶ç¼“å­˜èµ·æ¥ï¼Œç„¶åè®¾ç½®æ£€æµ‹è¯¥socketä¸Šå¯å†™äº‹ä»¶ï¼Œä¸‹æ¬¡å¯å†™äº‹ä»¶äº§ç”Ÿæ—¶ï¼Œå†ç»§ç»­å‘é€ï¼Œå¦‚æœè¿˜æ˜¯ä¸èƒ½å®Œå…¨å‘å‡ºå»ï¼Œåˆ™ç»§ç»­è®¾ç½®ä¾¦å¬å¯å†™äº‹ä»¶ï¼Œå¦‚æ­¤å¾€å¤ï¼Œä¸€ç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½å‘å‡ºå»ä¸ºæ­¢ã€‚ä¸€æ—¦æ‰€æœ‰æ•°æ®éƒ½å‘å‡ºå»ä»¥åï¼Œæˆ‘ä»¬è¦ç§»é™¤ä¾¦å¬å¯å†™äº‹ä»¶ï¼Œé¿å…æ— ç”¨çš„å¯å†™äº‹ä»¶é€šçŸ¥ã€‚ä¸çŸ¥é“ä½ æ³¨æ„åˆ°æ²¡æœ‰ï¼Œå¦‚æœæŸæ¬¡åªå‘å‡ºå»éƒ¨åˆ†æ•°æ®ï¼Œå‰©ä¸‹çš„æ•°æ®åº”è¯¥æš‚ä¸”å­˜èµ·æ¥ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç¼“å†²åŒºæ¥å­˜æ”¾è¿™éƒ¨åˆ†æ•°æ®ï¼Œè¿™ä¸ªç¼“å†²åŒºæˆ‘ä»¬ç§°ä¸ºâ€œå‘é€ç¼“å†²åŒºâ€ã€‚å‘é€ç¼“å†²åŒºä¸ä»…å­˜æ”¾æœ¬æ¬¡æ²¡æœ‰å‘å®Œçš„æ•°æ®ï¼Œè¿˜ç”¨æ¥å­˜æ”¾åœ¨å‘é€è¿‡ç¨‹ä¸­ï¼Œä¸Šå±‚åˆä¼ æ¥çš„æ–°çš„éœ€è¦å‘é€çš„æ•°æ®ã€‚ä¸ºäº†ä¿è¯é¡ºåºï¼Œæ–°çš„æ•°æ®åº”è¯¥è¿½åŠ åœ¨å½“å‰å‰©ä¸‹çš„æ•°æ®çš„åé¢ï¼Œå‘é€çš„æ—¶å€™ä»å‘é€ç¼“å†²åŒºçš„å¤´éƒ¨å¼€å§‹å‘é€ã€‚ä¹Ÿå°±æ˜¯è¯´å…ˆæ¥çš„å…ˆå‘é€ï¼Œåæ¥çš„åå‘é€ã€‚\n\nå¦‚ä½•åœ¨ç»™å®¢æˆ·ç«¯å‘å®Œæ•°æ®åå…³é—­è¿æ¥ï¼Ÿ\nè¿™ä¸ªé—®é¢˜æ¯”è¾ƒéš¾å¤„ç†ï¼Œå› ä¸ºè¿™é‡Œçš„â€œå‘é€å®Œâ€ä¸ä¸€å®šæ˜¯çœŸæ­£çš„å‘é€å®Œï¼Œæˆ‘ä»¬è°ƒç”¨sendæˆ–è€…writeå‡½æ•°å³ä½¿æˆåŠŸï¼Œä¹Ÿåªæ˜¯å‘æ“ä½œç³»ç»Ÿçš„åè®®æ ˆé‡Œé¢æˆåŠŸå†™å…¥æ•°æ®ï¼Œè‡³äºèƒ½å¦è¢«å‘å‡ºå»ã€ä½•æ—¶è¢«å‘å‡ºå»å¾ˆéš¾åˆ¤æ–­ï¼Œå‘å‡ºå»å¯¹æ–¹æ˜¯å¦æ”¶åˆ°å°±æ›´éš¾åˆ¤æ–­äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›®å‰åªèƒ½ç®€å•åœ°è®¤ä¸ºsendæˆ–è€…writeè¿”å›æˆ‘ä»¬å‘å‡ºæ•°æ®çš„å­—èŠ‚æ•°å¤§å°ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºâ€œå‘å®Œæ•°æ®â€äº†ã€‚ç„¶åè°ƒç”¨closeç­‰socket APIå…³é—­è¿æ¥ã€‚å…³é—­è¿æ¥çš„è¯é¢˜ï¼Œæˆ‘ä»¬å†å•ç‹¬å¼€ä¸€ä¸ªå°çš„æ ‡é¢˜æ¥ä¸“é—¨è®¨è®ºä¸€ä¸‹ã€‚\n\n\nï¼ˆå››ï¼‰è¢«åŠ¨å…³é—­è¿æ¥å’Œä¸»åŠ¨å…³é—­è¿æ¥åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œè¢«åŠ¨å…³é—­è¿æ¥æ˜¯ç”±äºæˆ‘ä»¬æ£€æµ‹åˆ°äº†è¿æ¥çš„å¼‚å¸¸äº‹ä»¶ï¼Œæ¯”å¦‚EPOLLERRï¼Œæˆ–è€…å¯¹ç«¯å…³é—­è¿æ¥ï¼Œsendæˆ–recvè¿”å›0ï¼Œè¿™ä¸ªæ—¶å€™è¿™è·¯è¿æ¥å·²ç»æ²¡æœ‰å­˜åœ¨å¿…è¦çš„æ„ä¹‰äº†ï¼Œæˆ‘ä»¬è¢«è¿«å…³é—­è¿æ¥ã€‚\nè€Œä¸»åŠ¨å…³é—­è¿æ¥ï¼Œæ˜¯æˆ‘ä»¬ä¸»åŠ¨è°ƒç”¨close&#x2F;closesocketæ¥å…³é—­è¿æ¥ã€‚æ¯”å¦‚å®¢æˆ·ç«¯ç»™æˆ‘ä»¬å‘é€éæ³•çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€äº›ç½‘ç»œæ”»å‡»çš„å°è¯•æ€§æ•°æ®åŒ…ã€‚è¿™ä¸ªæ—¶å€™å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬å…³é—­socketè¿æ¥ã€‚\nï¼ˆäº”ï¼‰å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºä¸Šé¢å·²ç»ä»‹ç»äº†å‘é€ç¼“å†²åŒºäº†ï¼Œå¹¶è¯´æ˜äº†å…¶å­˜åœ¨çš„æ„ä¹‰ã€‚æ¥æ”¶ç¼“å†²åŒºä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œå½“æ”¶åˆ°æ•°æ®ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œè§£åŒ…ï¼Œä½†æ˜¯è¿™æ ·å¹¶ä¸å¥½ï¼Œ\n\nç†ç”±ä¸€ï¼šé™¤éä¸€äº›çº¦å®šä¿—ç§°çš„åè®®æ ¼å¼ï¼Œæ¯”å¦‚httpåè®®ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨çš„ä¸šåŠ¡çš„åè®®éƒ½æ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ•°æ®åŒ…é‡Œé¢çš„æ•°æ®æ ¼å¼çš„è§£è¯»åº”è¯¥æ˜¯ä¸šåŠ¡å±‚çš„äº‹æƒ…ï¼Œå’Œç½‘ç»œé€šä¿¡å±‚åº”è¯¥è§£è€¦ï¼Œä¸ºäº†ç½‘ç»œå±‚æ›´åŠ é€šç”¨ï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“ä¸Šå±‚åè®®é•¿æˆä»€ä¹ˆæ ·å­ï¼Œå› ä¸ºä¸åŒçš„åè®®æ ¼å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå®ƒä»¬ä¸å…·ä½“çš„ä¸šåŠ¡æœ‰å…³ã€‚\nç†ç”±äºŒï¼šå³ä½¿çŸ¥é“åè®®æ ¼å¼ï¼Œæˆ‘ä»¬åœ¨ç½‘ç»œå±‚è¿›è¡Œè§£åŒ…å¤„ç†å¯¹åº”çš„ä¸šåŠ¡ï¼Œå¦‚æœè¿™ä¸ªä¸šåŠ¡å¤„ç†æ¯”è¾ƒè€—æ—¶ï¼Œæ¯”å¦‚è¯»å–ç£ç›˜æ–‡ä»¶ï¼Œæˆ–è€…è¿æ¥æ•°æ®åº“è¿›è¡Œè´¦å·å¯†ç éªŒè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç½‘ç»œçº¿ç¨‹ä¼šéœ€è¦å¤§é‡æ—¶é—´æ¥å¤„ç†è¿™äº›ä»»åŠ¡ï¼Œè¿™æ ·å…¶å®ƒç½‘ç»œäº‹ä»¶å¯èƒ½æ²¡æ³•åŠæ—¶å¤„ç†ã€‚é‰´äºä»¥ä¸ŠäºŒç‚¹ï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦ä¸€ä¸ªæ¥æ”¶ç¼“å†²åŒºï¼Œå°†æ”¶å–åˆ°çš„æ•°æ®æ”¾åˆ°è¯¥ç¼“å†²åŒºé‡Œé¢å»ï¼Œå¹¶ç”±ä¸“é—¨çš„ä¸šåŠ¡çº¿ç¨‹æˆ–è€…ä¸šåŠ¡é€»è¾‘å»ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®ï¼Œå¹¶è§£åŒ…å¤„ç†ä¸šåŠ¡ã€‚\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºè¯¥è®¾è®¡æˆå¤šå¤§çš„å®¹é‡ï¼Ÿè¿™æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜äº†ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šé¢„åˆ†é…çš„å†…å­˜å¤ªå°ä¸å¤Ÿç”¨ï¼Œå¤ªå¤§çš„è¯å¯èƒ½ä¼šé€ æˆæµªè´¹ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯åƒstringã€vectorä¸€æ ·ï¼Œè®¾è®¡å‡ºä¸€ä¸ªå¯ä»¥åŠ¨æ€å¢é•¿çš„ç¼“å†²åŒºï¼ŒæŒ‰éœ€åˆ†é…ï¼Œä¸å¤Ÿè¿˜å¯ä»¥æ‰©å±•ã€‚\néœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè¯´çš„å‘é€ç¼“å†²åŒºå’Œæ¥æ”¶ç¼“å†²åŒºæ˜¯æ¯ä¸€ä¸ªsocketè¿æ¥éƒ½å­˜åœ¨ä¸€ä¸ªã€‚è¿™æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„è®¾è®¡æ–¹æ¡ˆã€‚\nï¼ˆå…­ï¼‰åè®®çš„è®¾è®¡é™¤äº†ä¸€äº›é€šç”¨çš„åè®®ï¼Œå¦‚httpã€ftpåè®®ä»¥å¤–ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨åè®®éƒ½æ˜¯æ ¹æ®ä¸šåŠ¡åˆ¶å®šçš„ã€‚åè®®è®¾è®¡å¥½äº†ï¼Œæ•°æ®åŒ…çš„æ ¼å¼å°±æ ¹æ®åè®®æ¥è®¾ç½®ã€‚æˆ‘ä»¬çŸ¥é“tcp&#x2F;ipåè®®æ˜¯æµå¼æ•°æ®ï¼Œæ‰€ä»¥æµå¼æ•°æ®å°±æ˜¯åƒæµæ°´ä¸€æ ·ï¼Œæ•°æ®åŒ…ä¸æ•°æ®åŒ…ä¹‹é—´æ²¡æœ‰æ˜æ˜¾çš„ç•Œé™ã€‚æ¯”å¦‚Aç«¯ç»™Bç«¯è¿ç»­å‘äº†ä¸‰ä¸ªæ•°æ®åŒ…ï¼Œæ¯ä¸ªæ•°æ®åŒ…éƒ½æ˜¯50ä¸ªå­—èŠ‚ï¼ŒBç«¯å¯èƒ½å…ˆæ”¶åˆ°10ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°140ä¸ªå­—èŠ‚ï¼›æˆ–è€…å…ˆæ”¶åˆ°20ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°20ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°110ä¸ªå­—èŠ‚ï¼›ä¹Ÿå¯èƒ½ä¸€æ¬¡æ€§æ”¶åˆ°150ä¸ªå­—èŠ‚ã€‚è¿™150ä¸ªå­—èŠ‚å¯ä»¥ä»¥ä»»ä½•å­—èŠ‚æ•°ç›®ç»„åˆå’Œæ¬¡æ•°è¢«Bæ”¶åˆ°ã€‚\næ‰€ä»¥æˆ‘ä»¬è®¨è®ºåè®®çš„è®¾è®¡ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•ç•Œå®šåŒ…çš„ç•Œçº¿ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶ç«¯å¦‚ä½•çŸ¥é“æ¯ä¸ªåŒ…æ•°æ®çš„å¤§å°ã€‚ç›®å‰å¸¸ç”¨æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹æ³•ï¼š\n\nå›ºå®šå¤§å°ï¼Œè¿™ç§æ–¹æ³•å°±æ˜¯å‡å®šæ¯ä¸€ä¸ªåŒ…çš„å¤§å°éƒ½æ˜¯å›ºå®šå­—èŠ‚æ•°ç›®ï¼Œæ¯”å¦‚ä¸Šæ–‡ä¸­è®¨è®ºçš„æ¯ä¸ªåŒ…å¤§å°éƒ½æ˜¯50ä¸ªå­—èŠ‚ï¼Œæ¥æ”¶ç«¯æ¯æ”¶æ°”50ä¸ªå­—èŠ‚å°±å½“æˆä¸€ä¸ªåŒ…ï¼›\næŒ‡å®šåŒ…ç»“æŸç¬¦ï¼Œæ¯”å¦‚ä»¥ä¸€ä¸ª\\r\\n(æ¢è¡Œç¬¦å’Œå›è½¦ç¬¦)ç»“æŸï¼Œè¿™æ ·å¯¹ç«¯åªè¦æ”¶åˆ°è¿™æ ·çš„ç»“æŸç¬¦ï¼Œå°±å¯ä»¥è®¤ä¸ºæ”¶åˆ°äº†ä¸€ä¸ªåŒ…ï¼Œæ¥ä¸‹æ¥çš„æ•°æ®æ˜¯ä¸‹ä¸€ä¸ªåŒ…çš„å†…å®¹ï¼›\næŒ‡å®šåŒ…çš„å¤§å°ï¼Œè¿™ç§æ–¹æ³•ç»“åˆäº†ä¸Šè¿°ä¸¤ç§æ–¹æ³•ï¼Œä¸€èˆ¬åŒ…å¤´æ˜¯å›ºå®šå¤§å°ï¼ŒåŒ…å¤´ä¸­æœ‰ä¸€ä¸ªå­—æ®µæŒ‡å®šåŒ…ä½“æˆ–è€…æ•´ä¸ªå¤§çš„å¤§å°ï¼Œå¯¹ç«¯æ”¶åˆ°æ•°æ®ä»¥åå…ˆè§£æåŒ…å¤´ä¸­çš„å­—æ®µå¾—åˆ°åŒ…ä½“æˆ–è€…æ•´ä¸ªåŒ…çš„å¤§å°ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå¤§å°å»ç•Œå®šæ•°æ®çš„ç•Œçº¿ã€‚\n\nåè®®è¦è®¨è®ºçš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œè®¾è®¡åè®®çš„æ—¶å€™è¦å°½é‡æ–¹ä¾¿è§£åŒ…ï¼Œä¹Ÿå°±æ˜¯è¯´åè®®çš„æ ¼å¼å­—æ®µåº”è¯¥å°½é‡æ¸…æ™°æ˜äº†ã€‚\nåè®®è¦è®¨è®ºçš„ç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯ï¼Œæ ¹æ®åè®®ç»„è£…çš„æ•°æ®åŒ…åº”è¯¥å°½é‡å°ï¼Œè¿™æ ·æœ‰å¦‚ä¸‹å¥½å¤„ï¼š\n\nç¬¬ä¸€ã€å¯¹äºä¸€äº›ç§»åŠ¨ç«¯è®¾å¤‡æ¥è¯´ï¼Œå…¶æ•°æ®å¤„ç†èƒ½åŠ›å’Œå¸¦å®½èƒ½åŠ›æœ‰é™ï¼Œå°çš„æ•°æ®ä¸ä»…èƒ½åŠ å¿«å¤„ç†é€Ÿåº¦ï¼ŒåŒæ—¶èŠ‚çœå¤§é‡æµé‡è´¹ç”¨ï¼›\nç¬¬äºŒã€å¦‚æœå•ä¸ªæ•°æ®åŒ…è¶³å¤Ÿå°çš„è¯ï¼Œå¯¹é¢‘ç¹è¿›è¡Œç½‘ç»œé€šä¿¡çš„æœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œå¯ä»¥å¤§å¤§å‡å°å…¶å¸¦å®½å‹åŠ›ï¼Œå…¶æ‰€åœ¨çš„ç³»ç»Ÿä¹Ÿèƒ½ä½¿ç”¨æ›´å°‘çš„å†…å­˜ã€‚è¯•æƒ³ï¼šå‡å¦‚ä¸€ä¸ªè‚¡ç¥¨æœåŠ¡å™¨ï¼Œå¦‚æœä¸€åªè‚¡ç¥¨çš„æ•°æ®åŒ…æ˜¯100ä¸ªå­—èŠ‚æˆ–è€…1000ä¸ªå­—èŠ‚ï¼Œé‚£100åªè‚¡ç¥¨å’Œ10000åªè‚¡ç¥¨åŒºåˆ«å‘¢ï¼Ÿ\n\nåè®®è¦è®¨è®ºçš„ç¬¬å››ä¸ªé—®é¢˜æ˜¯ï¼Œå¯¹äºæ•°å€¼ç±»å‹ï¼Œæˆ‘ä»¬åº”è¯¥æ˜¾å¼åœ°æŒ‡å®šæ•°å€¼çš„é•¿åº¦ï¼Œæ¯”å¦‚longå‹ï¼Œå¦‚æœåœ¨32ä½æœºå™¨ä¸Šæ˜¯32ä½çš„4ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¦‚æœåœ¨64ä½æœºå™¨ä¸Šï¼Œå°±å˜æˆäº†64ä½8ä¸ªå­—èŠ‚äº†ã€‚è¿™æ ·åŒæ ·æ˜¯ä¸€ä¸ªlongå‹ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹å¯èƒ½ä¼šç”¨ä¸åŒçš„é•¿åº¦å»è§£ç ã€‚æ‰€ä»¥å»ºè®®æœ€å¥½åœ¨æ¶‰åŠåˆ°è·¨å¹³å°ä½¿ç”¨çš„åè®®æœ€å¥½æ˜¾å¼åœ°æŒ‡å®šåè®®ä¸­æ•´å‹å­—æ®µçš„é•¿åº¦ï¼Œæ¯”å¦‚int32,int64ç­‰ç­‰ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåè®®çš„æ¥å£çš„ä¾‹å­ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 1class BinaryReadStream   2&#123;   3    private:   4        const char* const ptr;   5        const size_t      len;   6        const char*       cur;   7        BinaryReadStream(const BinaryReadStream&amp;);   8        BinaryReadStream&amp; operator=(const BinaryReadStream&amp;);   910    public:  11        BinaryReadStream(const char* ptr, size_t len);  12        virtual const char* GetData() const;  13        virtual size_t GetSize() const;  14        bool IsEmpty() const;  15        bool ReadString(string* str,16                        size_t maxlen,17                        size_t&amp; outlen);  18        bool ReadCString(char* str,  19                         size_t strlen,20                         size_t&amp; len);  21        bool ReadCCString(const char** str,      22                          size_t maxlen,23                          size_t&amp; outlen);  24        bool ReadInt32(int32_t&amp; i);  25        bool ReadInt64(int64_t&amp; i);  26        bool ReadShort(short&amp; i);  27        bool ReadChar(char&amp; c);  28        size_t ReadAll(char* szBuffer, size_t iLen) const;  29        bool IsEnd() const;  30        const char* GetCurrent() const&#123; return cur; &#125;  3132    public:  33        bool ReadLength(size_t &amp; len);  34        bool ReadLengthWithoutOffset(size_t &amp;headlen,35                                     size_t &amp; outlen);  36    &#125;;  3738    class BinaryWriteStream  39    &#123;  40    public:  41        BinaryWriteStream(string* data);  42        virtual const char* GetData() const;  43        virtual size_t GetSize() const;  44        bool WriteCString(const char* str, size_t len);  45        bool WriteString(const string&amp; str);  46        bool WriteDouble(double value, bool isNULL = false);  47        bool WriteInt64(int64_t value, bool isNULL = false);  48        bool WriteInt32(int32_t i, bool isNULL = false);  49        bool WriteShort(short i, bool isNULL = false);  50        bool WriteChar(char c, bool isNULL = false);  51        size_t GetCurrentPos() const&#123; return m_data-&gt;length(); &#125;  52        void Flush();  53        void Clear();  54    private:  55        string* m_data;  56   &#125;;  \n\nå…¶ä¸­BinaryWriteStreamæ˜¯ç¼–ç åè®®çš„ç±»ï¼ŒBinaryReadStreamæ˜¯è§£ç åè®®çš„ç±»ã€‚å¯ä»¥æŒ‰ä¸‹é¢è¿™ç§æ–¹å¼æ¥ç¼–ç å’Œè§£ç ã€‚\nç¼–ç ï¼š\n1234561std::string outbuf;  2BinaryWriteStream writeStream(&amp;outbuf);  3writeStream.WriteInt32(msg_type_register);  4writeStream.WriteInt32(m_seq);  5writeStream.WriteString(retData);  6writeStream.Flush(); \n\nè§£ç ï¼š\n1234567891011121314151617181920 1BinaryReadStream readStream(strMsg.c_str(), 2                            strMsg.length());   3int32_t cmd;   4if (!readStream.ReadInt32(cmd))   5&#123;   6    return false;   7&#125;   8 9//int seq;  10if (!readStream.ReadInt32(m_seq))  11&#123;  12    return false;  13&#125;  1415std::string data;  16size_t datalength;  17if (!readStream.ReadString(&amp;data, 0, datalength))  18&#123;  19    return false;  20&#125;  \n\nï¼ˆä¸ƒï¼‰ã€æœåŠ¡å™¨ç¨‹åºç»“æ„çš„ç»„ç»‡ä¸Šé¢çš„å…­ä¸ªæ ‡é¢˜ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¾ˆå¤šå…·ä½“çš„ç»†èŠ‚é—®é¢˜ï¼Œç°åœ¨æ˜¯æ—¶å€™è®¨è®ºå°†è¿™äº›ç»†èŠ‚ç»„ç»‡èµ·æ¥äº†ã€‚æ ¹æ®æˆ‘çš„ä¸ªäººç»éªŒï¼Œç›®å‰ä¸»æµçš„æ€æƒ³æ˜¯one thread one loopçš„ç­–ç•¥ã€‚é€šä¿—ç‚¹è¯´å°±æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹çš„å‡½æ•°é‡Œé¢ä¸æ–­åœ°å¾ªç¯ä¾æ¬¡åšä¸€äº›äº‹æƒ…ï¼Œè¿™äº›äº‹æƒ…åŒ…æ‹¬æ£€æµ‹ç½‘ç»œäº‹ä»¶ã€è§£åŒ…æ•°æ®äº§ç”Ÿä¸šåŠ¡é€»è¾‘ã€‚æˆ‘ä»¬å…ˆä»æœ€ç®€å•åœ°æ¥è¯´ï¼Œè®¾å®šä¸€äº›çº¿ç¨‹åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢åšç½‘ç»œé€šä¿¡ç›¸å…³çš„äº‹æƒ…ï¼Œä¼ªç å¦‚ä¸‹ï¼š\n123456789101112 1while(é€€å‡ºæ ‡å¿—)   2&#123;   3    //IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶   4    //ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰   5 6    //å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›   7    //å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œæ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›   8 9    //å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®  1011    //å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥   12&#125; \n\n&#96; å¦å¤–è®¾å®šä¸€äº›çº¿ç¨‹å»å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¹¶è§£åŒ…å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè¿™äº›çº¿ç¨‹å¯ä»¥è®¤ä¸ºæ˜¯ä¸šåŠ¡çº¿ç¨‹äº†ï¼Œä¼ªç å¦‚ä¸‹ï¼š\n11//ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  \n\nä¸Šé¢çš„ç»“æ„æ˜¯ç›®å‰æœ€é€šç”¨çš„æœåŠ¡å™¨é€»è¾‘ç»“æ„ï¼Œä½†æ˜¯èƒ½ä¸èƒ½å†ç®€åŒ–ä¸€ä¸‹æˆ–è€…è¯´å†ç»¼åˆä¸€ä¸‹å‘¢ï¼Ÿæˆ‘ä»¬è¯•è¯•ï¼Œä½ æƒ³è¿‡è¿™æ ·çš„é—®é¢˜æ²¡æœ‰ï¼šå‡å¦‚ç°åœ¨çš„æœºå™¨æœ‰ä¸¤ä¸ªcpuï¼Œæˆ‘ä»¬çš„ç½‘ç»œçº¿ç¨‹æ•°é‡æ˜¯2ä¸ªï¼Œä¸šåŠ¡é€»è¾‘çº¿ç¨‹ä¹Ÿæ˜¯2ä¸ªï¼Œè¿™æ ·å¯èƒ½å­˜åœ¨çš„æƒ…å†µå°±æ˜¯ï¼šä¸šåŠ¡çº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œç½‘ç»œçº¿ç¨‹å¹¶æ²¡æœ‰è¿è¡Œï¼Œå®ƒä»¬å¿…é¡»ç­‰å¾…ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œå¹²å˜›è¦å¤šå»ºä¸¤ä¸ªçº¿ç¨‹å‘¢ï¼Ÿé™¤äº†ç¨‹åºç»“æ„ä¸Šå¯èƒ½ç¨å¾®æ¸…æ¥šä¸€ç‚¹ï¼Œå¯¹ç¨‹åºæ€§èƒ½æ²¡æœ‰ä»»ä½•å®è´¨æ€§æé«˜ï¼Œè€Œä¸”ç™½ç™½æµªè´¹cpuæ—¶é—´ç‰‡åœ¨çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç½‘ç»œçº¿ç¨‹ä¸ä¸šåŠ¡é€»è¾‘çº¿ç¨‹åˆå¹¶ï¼Œåˆå¹¶åçš„ä¼ªç çœ‹èµ·æ¥æ˜¯è¿™æ ·å­çš„ï¼š\n123456789101112131415 1while(é€€å‡ºæ ‡å¿—)   2&#123;   3    //IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶   4    //ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰   5 6    //å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›   7    //å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œ 8    //æ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›   910    //å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®  1112    //å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥  1314    //ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  15&#125;  \n\n&#96;ä½ æ²¡çœ‹é”™ï¼Œå…¶å®å°±æ˜¯ç®€å•çš„åˆå¹¶ï¼Œåˆå¹¶ä¹‹åå’Œä¸ä»…å¯ä»¥è¾¾åˆ°åŸæ¥åˆå¹¶å‰çš„æ•ˆæœï¼Œè€Œä¸”åœ¨æ²¡æœ‰ç½‘ç»œIOäº‹ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥åŠæ—¶å¤„ç†æˆ‘ä»¬æƒ³å¤„ç†çš„ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶ä¸”å‡å°‘äº†ä¸å¿…è¦çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶é—´ã€‚\næˆ‘ä»¬å†æ›´è¿›ä¸€æ­¥ï¼Œç”šè‡³æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªwhileå¾ªç¯å¢åŠ å…¶å®ƒçš„ä¸€äº›ä»»åŠ¡çš„å¤„ç†ï¼Œæ¯”å¦‚ç¨‹åºçš„é€»è¾‘ä»»åŠ¡é˜Ÿåˆ—ã€å®šæ—¶å™¨äº‹ä»¶ç­‰ç­‰ï¼Œä¼ªç å¦‚ä¸‹ï¼š\n123456789101112131415161718192021 1while(é€€å‡ºæ ‡å¿—)   2&#123;   3    //å®šæ—¶å™¨äº‹ä»¶å¤„ç†   4 5    //IOå¤ç”¨æŠ€æœ¯æ£€æµ‹socketå¯è¯»äº‹ä»¶ã€å‡ºé”™äº‹ä»¶   6    //ï¼ˆå¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œåˆ™ä¹Ÿæ£€æµ‹å¯å†™äº‹ä»¶ï¼‰   7 8    //å¦‚æœæœ‰å¯è¯»äº‹ä»¶ï¼Œå¯¹äºä¾¦å¬socketåˆ™æ¥æ”¶æ–°è¿æ¥ï¼›   9    //å¯¹äºæ™®é€šsocketåˆ™æ”¶å–è¯¥socketä¸Šçš„æ•°æ®ï¼Œ10    //æ”¶å–çš„æ•°æ®å­˜å…¥å¯¹åº”çš„æ¥æ”¶ç¼“å†²åŒºï¼Œå¦‚æœå‡ºé”™åˆ™å…³é—­è¿æ¥ï¼›  1112    //å¦‚æœæœ‰æ•°æ®è¦å‘é€ï¼Œæœ‰å¯å†™äº‹ä»¶ï¼Œåˆ™å‘é€æ•°æ®  1314    //å¦‚æœæœ‰å‡ºé”™äº‹ä»¶ï¼Œå…³é—­è¯¥è¿æ¥  1516    //ä»æ¥æ”¶ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è§£åŒ…ï¼Œåˆ†è§£æˆä¸åŒçš„ä¸šåŠ¡æ¥å¤„ç†  1718    //ç¨‹åºè‡ªå®šä¹‰ä»»åŠ¡1  1920    //ç¨‹åºè‡ªå®šä¹‰ä»»åŠ¡2  21&#125; \n\næ³¨æ„ï¼šä¹‹æ‰€ä»¥å°†å®šæ—¶å™¨äº‹ä»¶çš„å¤„ç†æ”¾åœ¨ç½‘ç»œIOäº‹ä»¶çš„æ£€æµ‹ä¹‹å‰ï¼Œæ˜¯å› ä¸ºé¿å…å®šæ—¶å™¨äº‹ä»¶è¿‡æœŸæ—¶é—´å¤ªé•¿ã€‚å‡å¦‚æ”¾åœ¨åé¢çš„è¯ï¼Œå¯èƒ½å‰é¢çš„å¤„ç†è€—è´¹äº†ä¸€ç‚¹æ—¶é—´ï¼Œç­‰åˆ°å¤„ç†å®šæ—¶å™¨äº‹ä»¶æ—¶ï¼Œæ—¶é—´é—´éš”å·²ç»è¿‡å»äº†ä¸å°‘æ—¶é—´ã€‚è™½ç„¶è¿™æ ·å¤„ç†ï¼Œä¹Ÿæ²¡æ³•ä¿è¯å®šæ—¶å™¨äº‹ä»¶ç™¾åˆ†ç™¾ç²¾ç¡®ï¼Œä½†æ˜¯èƒ½å°½é‡ä¿è¯ã€‚\nï¼ˆå…«ï¼‰é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2â€”â€”ä»¥flamigoæœåŠ¡å™¨ä»£ç ä¸ºä¾‹ç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\nè¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥ä»¥flamingoçš„æœåŠ¡å™¨ç¨‹åºçš„ç½‘ç»œæ¡†æ¶è®¾è®¡ä¸ºä¾‹æ¥éªŒè¯ä¸Šè¿°ä»‹ç»çš„ç†è®ºã€‚flamingoçš„ç½‘ç»œæ¡†æ¶æ˜¯åŸºäºé™ˆç¡•çš„muduoåº“ï¼Œæ”¹æˆC++11çš„ç‰ˆæœ¬ï¼Œå¹¶ä¿®æ”¹äº†ä¸€äº›bugã€‚åœ¨æ­¤æ„Ÿè°¢åŸä½œè€…é™ˆç¡•ã€‚flamingoçš„æºç å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ï¼šhttps://github.com/baloonwj/flamingoï¼Œæ‰“ä¸å¼€githubçš„å¯ä»¥ç§»æ­¥csdnï¼šhttp://download.csdn.net/detail/analogous_love/9805797ã€‚\nä¸Šæ–‡ä»‹ç»çš„æ ¸å¿ƒçº¿ç¨‹å‡½æ•°çš„whileå¾ªç¯ä½äºeventloop.cppä¸­ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940 1void EventLoop::loop()   2&#123;   3    assert(!looping_);   4    assertInLoopThread();   5    looping_ = true;   6    quit_ = false; 7  // FIXME: what if someone calls quit() before loop() ?   8    LOG_TRACE &lt;&lt; &quot;EventLoop &quot; &lt;&lt; this &lt;&lt; &quot; start looping&quot;;   910    while (!quit_)  11    &#123;  12        activeChannels_.clear();  13        pollReturnTime_ = poller_-&gt;poll(kPollTimeMs,14                                        &amp;activeChannels_);  15        ++iteration_;  16        if (Logger::logLevel() &lt;= Logger::TRACE)  17        &#123;  18            printActiveChannels();  19        &#125;  20        // TODO sort channel by priority  21        eventHandling_ = true;  22        for (ChannelList::iterator it = activeChannels_.begin();  23            it != activeChannels_.end(); ++it)  24        &#123;  25            currentActiveChannel_ = *it;  26            currentActiveChannel_-&gt;handleEvent(pollReturnTime_);  27        &#125;  28        currentActiveChannel_ = NULL;  29        eventHandling_ = false;  30        doPendingFunctors();  3132        if (frameFunctor_)  33        &#123;  34            frameFunctor_();  35        &#125;         36    &#125;  3738    LOG_TRACE &lt;&lt; &quot;EventLoop &quot; &lt;&lt; this &lt;&lt; &quot; stop looping&quot;;  39    looping_ = false;  40&#125; \n\npoller_-&gt;pollåˆ©ç”¨epollåˆ†ç¦»ç½‘ç»œäº‹ä»¶ï¼Œç„¶åæ¥ç€å¤„ç†åˆ†ç¦»å‡ºæ¥çš„ç½‘ç»œäº‹ä»¶ï¼Œæ¯ä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹åº”ä¸€ä¸ªè¿æ¥ï¼Œå³ä¸€ä¸ªTcpConnectionå’ŒChannelé€šé“å¯¹è±¡ã€‚**currentActiveChannel_-&gt;handleEvent(pollReturnTime_)**æ ¹æ®æ˜¯å¯è¯»ã€å¯å†™ã€å‡ºé”™äº‹ä»¶æ¥è°ƒç”¨å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¿™äº›å‡½æ•°éƒ½æ˜¯å›è°ƒå‡½æ•°ï¼Œç¨‹åºåˆå§‹åŒ–é˜¶æ®µè®¾ç½®è¿›æ¥çš„ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 1void Channel::handleEvent(Timestamp receiveTime)   2&#123;   3    std::shared_ptr&lt;void&gt; guard;   4    if (tied_)   5    &#123;   6        guard = tie_.lock();   7        if (guard)   8        &#123;   9            handleEventWithGuard(receiveTime);  10        &#125;  11    &#125;  12    else  13    &#123;  14        handleEventWithGuard(receiveTime);  15    &#125;  16&#125;  1718void Channel::handleEventWithGuard(Timestamp receiveTime)  19&#123;  20    eventHandling_ = true;  21    LOG_TRACE &lt;&lt; reventsToString();  22    if ((revents_ &amp; POLLHUP) &amp;&amp; !(revents_ &amp; POLLIN))  23    &#123;  24        if (logHup_)  25        &#123;  26            LOG_WARN &lt;&lt; &quot;Channel::handle_event() POLLHUP&quot;;  27        &#125;  28        if (closeCallback_) closeCallback_();  29    &#125;  3031    if (revents_ &amp; POLLNVAL)  32    &#123;  33        LOG_WARN &lt;&lt; &quot;Channel::handle_event() POLLNVAL&quot;;  34    &#125;  3536    if (revents_ &amp; (POLLERR | POLLNVAL))  37    &#123;  38        if (errorCallback_) errorCallback_();  39    &#125;  40    if (revents_ &amp; (POLLIN | POLLPRI | POLLRDHUP))  41    &#123;  42        //å½“æ˜¯ä¾¦å¬socketæ—¶ï¼ŒreadCallback_æŒ‡å‘Acceptor::handleRead  43        //å½“æ˜¯å®¢æˆ·ç«¯socketæ—¶ï¼Œè°ƒç”¨TcpConnection::handleRead   44        if (readCallback_) readCallback_(receiveTime);  45    &#125;  46    if (revents_ &amp; POLLOUT)  47    &#123;  48        //å¦‚æœæ˜¯è¿æ¥çŠ¶æ€æœçš„socketï¼Œ49        //åˆ™writeCallback_æŒ‡å‘Connector::handleWrite()  50        if (writeCallback_) writeCallback_();  51    &#125;  52    eventHandling_ = false;  53&#125;  \n\nå½“ç„¶ï¼Œè¿™é‡Œåˆ©ç”¨äº†Channelå¯¹è±¡çš„â€œå¤šæ€æ€§â€\n\nå¦‚æœæ˜¯æ™®é€šsocketï¼Œå¯è¯»äº‹ä»¶å°±ä¼šè°ƒç”¨é¢„å…ˆè®¾ç½®çš„å›è°ƒå‡½æ•°ï¼›\nä½†æ˜¯å¦‚æœæ˜¯ä¾¦å¬socketï¼Œåˆ™è°ƒç”¨Aceptorå¯¹è±¡çš„handleRead()æ¥æ¥æ”¶æ–°è¿æ¥ï¼š\n\n123456789101112131415161718192021222324252627282930313233343536 1void Acceptor::handleRead()   2&#123;   3    loop_-&gt;assertInLoopThread();   4    InetAddress peerAddr;   5    //FIXME loop until no more   6    int connfd = acceptSocket_.accept(&amp;peerAddr);   7    if (connfd &gt;= 0)   8    &#123;   9        // string hostport = peerAddr.toIpPort();  10        // LOG_TRACE &lt;&lt; &quot;Accepts of &quot; &lt;&lt; hostport;  11        //newConnectionCallback_å®é™…æŒ‡å‘:12        //TcpServer::newConnection(int sockfd, const InetAddress&amp; peerAddr)  13        if (newConnectionCallback_)  14        &#123;  15            newConnectionCallback_(connfd, peerAddr);  16        &#125;  17        else  18        &#123;  19            sockets::close(connfd);  20        &#125;  21    &#125;  22    else  23    &#123;  24        LOG_SYSERR &lt;&lt; &quot;in Acceptor::handleRead&quot;;  25        // Read the section named &quot;The special problem of  26        // accept()ing when you can&#x27;t&quot; in libev&#x27;s doc.  27        // By Marc Lehmann, author of livev.  28        if (errno == EMFILE)  29        &#123;  30            ::close(idleFd_);  31            idleFd_ = ::accept(acceptSocket_.fd(), NULL, NULL);  32            ::close(idleFd_);  33            idleFd_ = ::open(&quot;/dev/null&quot;, O_RDONLY | O_CLOEXEC);  34        &#125;  35    &#125;  36&#125;\n\nä¸»å¾ªç¯é‡Œé¢çš„ä¸šåŠ¡é€»è¾‘å¤„ç†å¯¹åº”ï¼š\n123456789101112131415161718192021222324 1doPendingFunctors();   2 3if (frameFunctor_)   4&#123;   5   frameFunctor_();   6&#125;          7 8 9void EventLoop::doPendingFunctors()  10&#123;  11    std::vector&lt;Functor&gt; functors;  12    callingPendingFunctors_ = true;  1314    &#123;  15        std::unique_lock&lt;std::mutex&gt; lock(mutex_);  16        functors.swap(pendingFunctors_);  17    &#125;  1819    for (size_t i = 0; i &lt; functors.size(); ++i)  20    &#123;  21        functors[i]();  22    &#125;  23    callingPendingFunctors_ = false;  24&#125;  \n\nè¿™é‡Œå¢åŠ ä¸šåŠ¡é€»è¾‘æ˜¯å¢åŠ æ‰§è¡Œä»»åŠ¡çš„å‡½æ•°æŒ‡é’ˆçš„ï¼Œå¢åŠ çš„ä»»åŠ¡ä¿å­˜åœ¨æˆå‘˜å˜é‡pendingFunctors_ä¸­ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼ˆvectorå¯¹è±¡ï¼‰ï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œè°ƒç”¨æ¯ä¸ªå‡½æ•°å°±å¯ä»¥äº†ã€‚ä¸Šé¢çš„ä»£ç å…ˆåˆ©ç”¨ä¸€ä¸ªæ ˆå˜é‡å°†æˆå‘˜å˜é‡pendingFunctors_é‡Œé¢çš„å‡½æ•°æŒ‡é’ˆæ¢è¿‡æ¥ï¼Œæ¥ä¸‹æ¥å¯¹è¿™ä¸ªæ ˆå˜é‡è¿›è¡Œæ“ä½œå°±å¯ä»¥äº†ï¼Œè¿™æ ·å‡å°‘äº†é”çš„ç²’åº¦ã€‚\nå› ä¸ºæˆå‘˜å˜é‡pendingFunctors_åœ¨å¢åŠ ä»»åŠ¡çš„æ—¶å€™ï¼Œä¹Ÿä¼šè¢«ç”¨åˆ°ï¼Œè®¾è®¡åˆ°å¤šä¸ªçº¿ç¨‹æ“ä½œï¼Œæ‰€ä»¥è¦åŠ é”ï¼Œå¢åŠ ä»»åŠ¡çš„åœ°æ–¹æ˜¯ï¼š\n123456789101112 1void EventLoop::queueInLoop(const Functor&amp; cb)   2&#123;   3    &#123;   4        std::unique_lock&lt;std::mutex&gt; lock(mutex_);   5        pendingFunctors_.push_back(cb);   6    &#125;   7 8    if (!isInLoopThread() || callingPendingFunctors_)   9    &#123;  10        wakeup();  11    &#125;  12&#125;\n\nè€Œ**frameFunctor_**å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆå°±å¯ä»¥äº†ã€‚å½“ç„¶è¿™é‡Œæœ‰ä¸ªæŠ€å·§æ€§çš„ä¸œè¥¿ï¼Œå³å¢åŠ ä»»åŠ¡çš„æ—¶å€™ï¼Œä¸ºäº†èƒ½å¤Ÿç«‹å³æ‰§è¡Œï¼Œä½¿ç”¨å”¤é†’æœºåˆ¶ï¼Œé€šè¿‡å¾€ä¸€ä¸ªfdé‡Œé¢å†™å…¥ç®€å•çš„å‡ ä¸ªå­—èŠ‚ï¼Œæ¥å”¤é†’epollï¼Œä½¿å…¶ç«‹åˆ»è¿”å›ï¼Œå› ä¸ºæ­¤æ—¶æ²¡æœ‰å…¶å®ƒçš„sockeæœ‰äº‹ä»¶ï¼Œè¿™æ ·æ¥ä¸‹æ¥å°±æ‰§è¡Œåˆšæ‰æ·»åŠ çš„ä»»åŠ¡äº†ã€‚\næˆ‘ä»¬çœ‹ä¸€ä¸‹æ•°æ®æ”¶å–çš„é€»è¾‘ï¼š\n12345678910111213141516171819202122232425 1void TcpConnection::handleRead(Timestamp receiveTime)   2&#123;   3    loop_-&gt;assertInLoopThread();   4    int savedErrno = 0;   5    ssize_t n = inputBuffer_.readFd(channel_-&gt;fd(), &amp;savedErrno);   6    if (n &gt; 0)   7    &#123;   8        /*messageCallback_æŒ‡å‘ 9       CTcpSession::OnRead(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn,10                           Buffer* pBuffer, 11                           Timestamp receiveTime)*/  12        messageCallback_(shared_from_this(),13                         &amp;inputBuffer_, receiveTime);  14    &#125;  15    else if (n == 0)  16    &#123;  17        handleClose();  18    &#125;  19    else  20    &#123;  21        errno = savedErrno;  22        LOG_SYSERR &lt;&lt; &quot;TcpConnection::handleRead&quot;;  23        handleError();  24    &#125;  25&#125; \n\nå°†æ”¶åˆ°çš„æ•°æ®æ”¾åˆ°æ¥æ”¶ç¼“å†²åŒºé‡Œé¢ï¼Œå°†æ¥æˆ‘ä»¬æ¥è§£åŒ…ï¼š\n1234567891011121314151617181920212223242526272829 1void ClientSession::OnRead(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn, Buffer* pBuffer, Timestamp receivTime)   2&#123;   3    while (true)   4    &#123;   5        //ä¸å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°   6        if (pBuffer-&gt;readableBytes() &lt; (size_t)sizeof(msg))   7        &#123;   8            LOG_INFO &lt;&lt; &quot;buffer is not enough for a package header, pBuffer-&gt;readableBytes()=&quot; &lt;&lt; pBuffer-&gt;readableBytes() &lt;&lt; &quot;, sizeof(msg)=&quot; &lt;&lt; sizeof(msg);   9            return;  10        &#125;  1112        //ä¸å¤Ÿä¸€ä¸ªæ•´åŒ…å¤§å°  13        msg header;  14        memcpy(&amp;header, pBuffer-&gt;peek(), sizeof(msg));  15        if (pBuffer-&gt;readableBytes() &lt; (size_t)header.packagesize + sizeof(msg))  16            return;  1718        pBuffer-&gt;retrieve(sizeof(msg));  19        std::string inbuf;  20        inbuf.append(pBuffer-&gt;peek(), header.packagesize);  21        pBuffer-&gt;retrieve(header.packagesize);  22        if (!Process(conn, inbuf.c_str(), inbuf.length()))  23        &#123;  24            LOG_WARN &lt;&lt; &quot;Process error, close TcpConnection&quot;;  25            conn-&gt;forceClose();  26        &#125;  27    &#125;// end while-loop  2829&#125;  \n\nå…ˆåˆ¤æ–­æ¥æ”¶ç¼“å†²åŒºé‡Œé¢çš„æ•°æ®æ˜¯å¦å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°ï¼Œå¦‚æœå¤Ÿå†åˆ¤æ–­å¤Ÿä¸å¤ŸåŒ…å¤´æŒ‡å®šçš„åŒ…ä½“å¤§å°ï¼Œå¦‚æœè¿˜æ˜¯å¤Ÿçš„è¯ï¼Œæ¥ç€åœ¨Processå‡½æ•°é‡Œé¢å¤„ç†è¯¥åŒ…ã€‚\nå†çœ‹çœ‹å‘é€æ•°æ®çš„é€»è¾‘ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960 1void TcpConnection::sendInLoop(const void* data,  2                               size_t len)   3&#123;   4    loop_-&gt;assertInLoopThread();   5    ssize_t nwrote = 0;   6    size_t remaining = len;   7    bool faultError = false;   8    if (state_ == kDisconnected)   9    &#123;  10        LOG_WARN &lt;&lt; &quot;disconnected, give up writing&quot;;  11        return;  12    &#125;  13    // if no thing in output queue, try writing directly  14    if (!channel_-&gt;isWriting() &amp;&amp; outputBuffer_.readableBytes() == 0)  15    &#123;  16        nwrote = sockets::write(channel_-&gt;fd(), data, len);  17        if (nwrote &gt;= 0)  18        &#123;  19            remaining = len - nwrote;  20            if (remaining == 0 &amp;&amp; writeCompleteCallback_)  21            &#123;  22                loop_-&gt;queueInLoop(std::bind(writeCompleteCallback_, 23                                             shared_from_this()));  24            &#125;  25        &#125;  26        else // nwrote &lt; 0  27        &#123;  28            nwrote = 0;  29            if (errno != EWOULDBLOCK)  30            &#123;  31                LOG_SYSERR &lt;&lt; &quot;TcpConnection::sendInLoop&quot;;32                // FIXME: any others?   33                if (errno == EPIPE || errno == ECONNRESET)  34                &#123;  35                    faultError = true;  36                &#125;  37            &#125;  38        &#125;  39    &#125;  4041    assert(remaining &lt;= len);  42    if (!faultError &amp;&amp; remaining &gt; 0)  43    &#123;  44        size_t oldLen = outputBuffer_.readableBytes();  45        if (oldLen + remaining &gt;= highWaterMark_                          46            &amp;&amp; oldLen &lt; highWaterMark_  47            &amp;&amp; highWaterMarkCallback_)  48        &#123;  49            loop_-&gt;queueInLoop(std::bind(highWaterMarkCallback_,50                                         shared_from_this(),51                                         oldLen + remaining));  52        &#125;  53        outputBuffer_.append(static_cast&lt;const char*&gt;(data)+nwrote,54                             remaining);  55        if (!channel_-&gt;isWriting())  56        &#123;  57            channel_-&gt;enableWriting();  58        &#125;  59    &#125;  60&#125; \n\nå¦‚æœå‰©ä½™çš„æ•°æ®remainingå¤§äºåˆ™è°ƒç”¨**channel_-&gt;enableWriting();**å¼€å§‹ç›‘å¬å¯å†™äº‹ä»¶ï¼Œå¯å†™äº‹ä»¶å¤„ç†å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940 1void TcpConnection::handleWrite()   2&#123;   3    loop_-&gt;assertInLoopThread();   4    if (channel_-&gt;isWriting())   5    &#123;   6        ssize_t n = sockets::write(channel_-&gt;fd(),   7            outputBuffer_.peek(),   8            outputBuffer_.readableBytes());   9        if (n &gt; 0)  10        &#123;  11            outputBuffer_.retrieve(n);  12            if (outputBuffer_.readableBytes() == 0)  13            &#123;  14                channel_-&gt;disableWriting();  15                if (writeCompleteCallback_)  16                &#123;  17                    loop_-&gt;queueInLoop(std::bind(writeCompleteCallback_, 18                                       shared_from_this()));  19                &#125;   20                if (state_ == kDisconnecting)  21                &#123;  22                    shutdownInLoop();  23                &#125;  24            &#125;  25        &#125;  26        else  27        &#123;  28            LOG_SYSERR &lt;&lt; &quot;TcpConnection::handleWrite&quot;;  29            // if (state_ == kDisconnecting)  30            // &#123;  31            //   shutdownInLoop();  32            // &#125;  33        &#125;  34    &#125;  35    else  36    &#123;  37        LOG_TRACE &lt;&lt; &quot;Connection fd = &quot; &lt;&lt; channel_-&gt;fd()  38            &lt;&lt; &quot; is down, no more writing&quot;;  39    &#125;  40&#125;\n\nå¦‚æœå‘é€å®Œæ•°æ®ä»¥åè°ƒç”¨channel_-&gt;disableWriting();ç§»é™¤ç›‘å¬å¯å†™äº‹ä»¶ã€‚\nå¾ˆå¤šè¯»è€…å¯èƒ½ä¸€ç›´æƒ³é—®ï¼Œæ–‡ä¸­ä¸æ˜¯è¯´è§£åŒ…æ•°æ®å¹¶å¤„ç†é€»è¾‘æ˜¯ä¸šåŠ¡ä»£ç è€Œéç½‘ç»œé€šä¿¡çš„ä»£ç ï¼Œä½ è¿™é‡Œè²Œä¼¼éƒ½æ··åœ¨ä¸€èµ·äº†ï¼Œå…¶å®æ²¡æœ‰ï¼Œè¿™é‡Œå®é™…çš„ä¸šåŠ¡ä»£ç å¤„ç†éƒ½æ˜¯æ¡†æ¶æ›¾æä¾›çš„å›è°ƒå‡½æ•°é‡Œé¢å¤„ç†çš„ï¼Œå…·ä½“æ€ä¹ˆå¤„ç†ï¼Œç”±æ¡†æ¶ä½¿ç”¨è€…â€”â€”ä¸šåŠ¡å±‚è‡ªå·±å®šä¹‰ã€‚\næ€»ç»“èµ·æ¥ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å‡½æ•°é‡Œä¸€ä¸ªloopé‚£ä¹ˆç‚¹äº‹æƒ…ï¼Œä¸ä¿¡ä½ å†çœ‹æˆ‘æ›¾ç»å·¥ä½œä¸Šçš„ä¸€ä¸ªäº¤æ˜“ç³»ç»Ÿé¡¹ç›®ä»£ç ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798 1void CEventDispatcher::Run()   2&#123;   3    m_bShouldRun = true;   4    while(m_bShouldRun)   5    &#123;   6        DispatchIOs();         7        SyncTime();   8        CheckTimer();   9        DispatchEvents();  10    &#125;  11&#125;  121314void CEpollReactor::DispatchIOs()  15&#123;  16    DWORD dwSelectTimeOut = SR_DEFAULT_EPOLL_TIMEOUT;  17    if (HandleOtherTask())  18    &#123;  19        dwSelectTimeOut = 0;  20    &#125;  2122    struct epoll_event ev;  23    CEventHandlerIdMap::iterator itor = m_mapEventHandlerId.begin();  24    for(; itor!=m_mapEventHandlerId.end(); itor++)  25    &#123;  26        CEventHandler *pEventHandler = (CEventHandler *)(*itor).first;  27        if(pEventHandler == NULL)&#123;  28            continue;  29        &#125;  30        ev.data.ptr = pEventHandler;  31        ev.events = 0;  32        int nReadID, nWriteID;  33        pEventHandler-&gt;GetIds(&amp;nReadID, &amp;nWriteID);    34        if (nReadID &gt; 0)  35        &#123;  36            ev.events |= EPOLLIN;  37        &#125;  38        if (nWriteID &gt; 0)  39        &#123;  40            ev.events |= EPOLLOUT;  41        &#125;  4243        epoll_ctl(m_fdEpoll, EPOLL_CTL_MOD, (*itor).second, &amp;ev);  44    &#125;  4546    struct epoll_event events[EPOLL_MAX_EVENTS];  4748    int nfds = epoll_wait(m_fdEpoll, events, 49                          EPOLL_MAX_EVENTS, 50                          dwSelectTimeOut/1000);  5152    for (int i=0; i&lt;nfds; i++)  53    &#123;  54        struct epoll_event &amp;evref = events[i];  55        CEventHandler *pEventHandler = (CEventHandler *)evref.data.ptr;  56        if ((evref.events|EPOLLIN)!=0 &amp;&amp; 57             m_mapEventHandlerId.find(pEventHandler)!=m_mapEventHandlerId.end())  58        &#123;  59            pEventHandler-&gt;HandleInput();  60        &#125;  61        if ((evref.events|EPOLLOUT)!=0 &amp;&amp;62             m_mapEventHandlerId.find(pEventHandler)!=m_mapEventHandlerId.end())  63        &#123;  64            pEventHandler-&gt;HandleOutput();  65        &#125;  66    &#125;     67&#125;  686970void CEventDispatcher::DispatchEvents()  71&#123;  72    CEvent event;  73    CSyncEvent *pSyncEvent;  74    while(m_queueEvent.PeekEvent(event))  75    &#123;  76        int nRetval;  7778        if(event.pEventHandler != NULL)  79        &#123;  80            nRetval = event.pEventHandler-&gt;HandleEvent(event.nEventID,81                                                       event.dwParam,82                                                       event.pParam);  83        &#125;  84        else  85        &#123;  86            nRetval = HandleEvent(event.nEventID,87                                  event.dwParam, 88                                  event.pParam);  89        &#125;  9091        if(event.pAdd != NULL)      //åŒæ­¥æ¶ˆæ¯  92        &#123;  93            pSyncEvent=(CSyncEvent *)event.pAdd;  94            pSyncEvent-&gt;nRetval = nRetval;  95            pSyncEvent-&gt;sem.UnLock();  96        &#125;  97    &#125;  98&#125;  \n\nå†çœ‹çœ‹è˜‘è‡è¡—å¼€æºçš„TeamTalkçš„æºç ï¼ˆä»£ç ä¸‹è½½åœ°å€ï¼šhttps://github.com/baloonwj/TeamTalkï¼‰ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889 1void CEventDispatch::StartDispatch(uint32_t wait_timeout)   2&#123;   3    fd_set read_set, write_set, excep_set;   4    timeval timeout;   5    timeout.tv_sec = 0; 6    // 10 millisecond     7    timeout.tv_usec = wait_timeout * 1000; 8 9    if(running)  10        return;  11    running = true;  1213    while (running)  14   &#123;  15        _CheckTimer();  16        _CheckLoop();  1718        if (!m_read_set.fd_count &amp;&amp; 19            !m_write_set.fd_count &amp;&amp;20            !m_excep_set.fd_count)  21        &#123;  22            Sleep(MIN_TIMER_DURATION);  23            continue;  24        &#125;  2526        m_lock.lock();  27        memcpy(&amp;read_set, &amp;m_read_set, 28               sizeof(fd_set));  29        memcpy(&amp;write_set, &amp;m_write_set, 30               sizeof(fd_set));  31        memcpy(&amp;excep_set, &amp;m_excep_set, 32               sizeof(fd_set));  33        m_lock.unlock();  3435        int nfds = select(0, &amp;read_set, 36                          &amp;write_set,37                          &amp;excep_set,38                          &amp;timeout);  3940        if (nfds == SOCKET_ERROR)  41        &#123;  42            log(&quot;select failed, error code: %d&quot;, GetLastError());  43            Sleep(MIN_TIMER_DURATION);  44            continue;           // select again  45        &#125;  4647        if (nfds == 0)  48        &#123;  49            continue;  50        &#125;  5152        for (u_int i = 0; i &lt; read_set.fd_count; i++)  53        &#123;  54            //log(&quot;select return read count=%d\\n&quot;, read_set.fd_count);  55            SOCKET fd = read_set.fd_array[i];  56            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  57            if (pSocket)  58            &#123;  59                pSocket-&gt;OnRead();  60                pSocket-&gt;ReleaseRef();  61            &#125;  62        &#125;  6364        for (u_int i = 0; i &lt; write_set.fd_count; i++)  65        &#123;  66            //log(&quot;select return write count=%d\\n&quot;, write_set.fd_count);  67            SOCKET fd = write_set.fd_array[i];  68            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  69            if (pSocket)  70            &#123;  71                pSocket-&gt;OnWrite();  72                pSocket-&gt;ReleaseRef();  73            &#125;  74        &#125;  7576        for (u_int i = 0; i &lt; excep_set.fd_count; i++)  77        &#123;  78            //log(&quot;select return exception count=%d\\n&quot;, excep_set.fd_count);  79            SOCKET fd = excep_set.fd_array[i];  80            CBaseSocket* pSocket = FindBaseSocket((net_handle_t)fd);  81            if (pSocket)  82            &#123;  83                pSocket-&gt;OnClose();  84                pSocket-&gt;ReleaseRef();  85            &#125;  86        &#125;  8788    &#125;  89&#125;\n\n****ç”±äºå…¬ä¼—å·æ–‡ç« å­—æ•°æœ‰é™ï¼Œæ‚¨å¯ä»¥æ¥ç€é˜…è¯»ä¸‹******ä¸€ç¯‡:**ã€ŠæœåŠ¡å™¨ç«¯ç¼–ç¨‹å¿ƒå¾—ï¼ˆå…«ï¼‰â€”â€”é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3â€”â€”ä»¥flamigoæœåŠ¡å™¨ä»£ç ä¸ºä¾‹ã€‹ã€‚\nç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\nï¼ˆå…«ï¼‰é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3â€”â€”ä»¥flamigoæœåŠ¡å™¨ä»£ç ä¸ºä¾‹ç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\nå†çœ‹filezillaï¼Œä¸€æ¬¾ftpå·¥å…·çš„æœåŠ¡å™¨ç«¯ï¼Œå®ƒé‡‡ç”¨çš„æ˜¯Windowsçš„WSAAsyncSelectæ¨¡å‹ï¼ˆä»£ç ä¸‹è½½åœ°å€ï¼šhttps://github.com/baloonwj/filezillaï¼‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469  1//Processes event notifications sent by the sockets or the layers    2    static LRESULT CALLBACK WindowProc(HWND hWnd,  3                                       UINT message,  4                                       WPARAM wParam,  5                                       LPARAM lParam)    6    &#123;    7        if (message&gt;=WM_SOCKETEX_NOTIFY)    8        &#123;    9            //Verify parameters   10            ASSERT(hWnd);   11            CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *) 12                                              GetWindowLongPtr(hWnd, GWLP_USERDATA);   13            ASSERT(pWnd);   14            if (!pWnd)   15                return 0;   16            //Index is within socket storage   17            if (message &lt; static_cast&lt;UINT&gt;(WM_SOCKETEX_NOTIFY+pWnd-&gt;m_nWindowDataSize))  18            &#123;   19                //Lookup socket and verify if it&#x27;s valid   20                CAsyncSocketEx *pSocket=pWnd-&gt;m_pAsyncSocketExWindowData[message - WM_SOCKETEX_NOTIFY].m_pSocket;   21                SOCKET hSocket = wParam;   22                if (!pSocket)   23                    return 0;   24                if (hSocket == INVALID_SOCKET)   25                    return 0;   26                if (pSocket-&gt;m_SocketData.hSocket != hSocket)   27                    return 0;   28 29                int nEvent = lParam &amp; 0xFFFF;   30                int nErrorCode = lParam &gt;&gt; 16;   31 32                //Dispatch notification   33                if (!pSocket-&gt;m_pFirstLayer) &#123;   34                    //Dispatch to CAsyncSocketEx instance   35                    switch (nEvent)   36                    &#123;   37                    case FD_READ:   38#ifndef NOSOCKETSTATES   39                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)   40                        &#123;   41                            pSocket-&gt;m_nPendingEvents |= FD_READ;   42                            break;   43                        &#125;   44                        else if (pSocket-&gt;GetState() == attached)   45                            pSocket-&gt;SetState(connected);   46                        if (pSocket-&gt;GetState() != connected)   47                            break;   48 49                        // Ignore further FD_READ events after FD_CLOSE has been received   50                        if (pSocket-&gt;m_SocketData.onCloseCalled)   51                            break;   52#endif //NOSOCKETSTATES   53 54#ifndef NOSOCKETSTATES   55                        if (nErrorCode)   56                            pSocket-&gt;SetState(aborted);   57#endif //NOSOCKETSTATES   58                        if (pSocket-&gt;m_lEvent &amp; FD_READ) &#123;   59                            pSocket-&gt;OnReceive(nErrorCode);   60                        &#125;   61                        break;   62                    case FD_FORCEREAD: //Forceread does not check if there&#x27;s data waiting   63#ifndef NOSOCKETSTATES   64                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)   65                        &#123;   66                            pSocket-&gt;m_nPendingEvents |= FD_FORCEREAD;   67                            break;   68                        &#125;   69                        else if (pSocket-&gt;GetState() == attached)   70                            pSocket-&gt;SetState(connected);   71                        if (pSocket-&gt;GetState() != connected)   72                            break;   73#endif //NOSOCKETSTATES   74                        if (pSocket-&gt;m_lEvent &amp; FD_READ)   75                        &#123;   76#ifndef NOSOCKETSTATES   77                            if (nErrorCode)   78                                pSocket-&gt;SetState(aborted);   79#endif //NOSOCKETSTATES   80                            pSocket-&gt;OnReceive(nErrorCode);   81                        &#125;   82                        break;   83                    case FD_WRITE:   84#ifndef NOSOCKETSTATES   85                        if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)   86                        &#123;   87                            pSocket-&gt;m_nPendingEvents |= FD_WRITE;   88                            break;   89                        &#125;   90                        else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)   91                            pSocket-&gt;SetState(connected);   92                        if (pSocket-&gt;GetState() != connected)   93                            break;   94#endif //NOSOCKETSTATES   95                        if (pSocket-&gt;m_lEvent &amp; FD_WRITE)   96                        &#123;   97#ifndef NOSOCKETSTATES   98                            if (nErrorCode)   99                                pSocket-&gt;SetState(aborted);  100#endif //NOSOCKETSTATES  101                            pSocket-&gt;OnSend(nErrorCode);  102                        &#125;  103                        break;  104                    case FD_CONNECT:  105#ifndef NOSOCKETSTATES  106                        if (pSocket-&gt;GetState() == connecting)  107                        &#123;  108                            if (nErrorCode &amp;&amp; pSocket-&gt;m_SocketData.nextAddr)  109                            &#123;  110                                if (pSocket-&gt;TryNextProtocol())  111                                    break;  112                            &#125;  113                            pSocket-&gt;SetState(connected);  114                        &#125;  115                        else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)  116                            pSocket-&gt;SetState(connected);  117#endif //NOSOCKETSTATES  118                        if (pSocket-&gt;m_lEvent &amp; FD_CONNECT)  119                            pSocket-&gt;OnConnect(nErrorCode);  120#ifndef NOSOCKETSTATES  121                        if (!nErrorCode)  122                        &#123;  123                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_READ) &amp;&amp;124                                 pSocket-&gt;GetState() == connected)  125                                pSocket-&gt;OnReceive(0);  126                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_FORCEREAD) &amp;&amp;127                                 pSocket-&gt;GetState() == connected)  128                                pSocket-&gt;OnReceive(0);  129                            if ((pSocket-&gt;m_nPendingEvents&amp;FD_WRITE) &amp;&amp;130                                 pSocket-&gt;GetState() == connected)  131                                pSocket-&gt;OnSend(0);  132                        &#125;  133                        pSocket-&gt;m_nPendingEvents = 0;  134#endif  135                        break;  136                    case FD_ACCEPT:  137#ifndef NOSOCKETSTATES  138                        if (pSocket-&gt;GetState() != listening &amp;&amp;139                            pSocket-&gt;GetState() != attached)  140                            break;  141#endif //NOSOCKETSTATES  142                        if (pSocket-&gt;m_lEvent &amp; FD_ACCEPT)  143                            pSocket-&gt;OnAccept(nErrorCode);  144                        break;  145                    case FD_CLOSE:  146#ifndef NOSOCKETSTATES  147                        if (pSocket-&gt;GetState() != connected &amp;&amp;148                            pSocket-&gt;GetState() != attached)  149                            break;  150151                        // If there are still bytes left to read,152                        // call OnReceive instead of  153                        // OnClose and trigger a new OnClose  154                        DWORD nBytes = 0;  155                        if (!nErrorCode &amp;&amp; pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))  156                        &#123;  157                            if (nBytes &gt; 0)  158                            &#123;  159                                // Just repeat message.  160                                pSocket-&gt;ResendCloseNotify();  161                                pSocket-&gt;m_SocketData.onCloseCalled = true;  162                                pSocket-&gt;OnReceive(WSAESHUTDOWN);  163                                break;  164                            &#125;  165                        &#125;  166167                        pSocket-&gt;SetState(nErrorCode ? aborted : closed);  168#endif //NOSOCKETSTATES  169                        pSocket-&gt;OnClose(nErrorCode);  170                        break;  171                    &#125;  172                &#125;  173                else //Dispatch notification to the lowest layer  174                &#123;  175                    if (nEvent == FD_READ)  176                    &#123;  177                        // Ignore further FD_READ events after FD_CLOSE has been received  178                        if (pSocket-&gt;m_SocketData.onCloseCalled)  179                            return 0;  180181                        DWORD nBytes;  182                        if (!pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))  183                            nErrorCode = WSAGetLastError();  184                        if (pSocket-&gt;m_pLastLayer)  185                            pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);  186                    &#125;  187                    else if (nEvent == FD_CLOSE)  188                    &#123;  189                        // If there are still bytes left to read,190                        // call OnReceive instead of  191                        // OnClose and trigger a new OnClose  192                        DWORD nBytes = 0;  193                        if (!nErrorCode &amp;&amp; pSocket-&gt;IOCtl(FIONREAD, &amp;nBytes))  194                        &#123;  195                            if (nBytes &gt; 0)  196                            &#123;  197                                // Just repeat message.  198                                pSocket-&gt;ResendCloseNotify();  199                                if (pSocket-&gt;m_pLastLayer)  200                                    pSocket-&gt;m_pLastLayer-&gt;CallEvent(FD_READ, 0);  201                                return 0;  202                            &#125;  203                        &#125;  204                        pSocket-&gt;m_SocketData.onCloseCalled = true;  205                        if (pSocket-&gt;m_pLastLayer)  206                            pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);  207                    &#125;  208                    else if (pSocket-&gt;m_pLastLayer)  209                        pSocket-&gt;m_pLastLayer-&gt;CallEvent(nEvent, nErrorCode);  210                &#125;  211            &#125;  212            return 0;  213        &#125;  214        else if (message == WM_USER) //Notification event sent by a layer  215        &#123;  216            //Verify parameters, lookup socket and notification message  217            //Verify parameters  218            ASSERT(hWnd);  219            CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)220                                              GetWindowLongPtr(hWnd, GWLP_USERDATA);  221            ASSERT(pWnd);  222            if (!pWnd)  223                return 0;  224             //Index is within socket storage  225            if (wParam &gt;= static_cast&lt;UINT&gt;(pWnd-&gt;m_nWindowDataSize))226            &#123;  227                return 0;  228            &#125;  229230            CAsyncSocketEx *pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[wParam].m_pSocket;  231            CAsyncSocketExLayer::t_LayerNotifyMsg *pMsg = (CAsyncSocketExLayer::t_LayerNotifyMsg *)lParam;  232            if (!pMsg || !pSocket || pSocket-&gt;m_SocketData.hSocket != pMsg-&gt;hSocket)  233            &#123;  234                delete pMsg;  235                return 0;  236            &#125;  237            int nEvent=pMsg-&gt;lEvent&amp;0xFFFF;  238            int nErrorCode=pMsg-&gt;lEvent&gt;&gt;16;  239240            //Dispatch to layer  241            if (pMsg-&gt;pLayer)  242                pMsg-&gt;pLayer-&gt;CallEvent(nEvent, nErrorCode);  243            else  244            &#123;  245                //Dispatch to CAsyncSocketEx instance  246                switch (nEvent)  247                &#123;  248                case FD_READ:  249#ifndef NOSOCKETSTATES  250                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)  251                    &#123;  252                        pSocket-&gt;m_nPendingEvents |= FD_READ;  253                        break;  254                    &#125;  255                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)  256                        pSocket-&gt;SetState(connected);  257                    if (pSocket-&gt;GetState() != connected)  258                        break;  259#endif //NOSOCKETSTATES  260                    if (pSocket-&gt;m_lEvent &amp; FD_READ)  261                    &#123;  262#ifndef NOSOCKETSTATES  263                        if (nErrorCode)  264                            pSocket-&gt;SetState(aborted);  265#endif //NOSOCKETSTATES  266                        pSocket-&gt;OnReceive(nErrorCode);  267                    &#125;  268                    break; 269                //Forceread does not check if there&#x27;s data waiting  270                case FD_FORCEREAD:  271#ifndef NOSOCKETSTATES  272                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)  273                    &#123;  274                        pSocket-&gt;m_nPendingEvents |= FD_FORCEREAD;  275                        break;  276                    &#125;  277                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)  278                        pSocket-&gt;SetState(connected);  279                    if (pSocket-&gt;GetState() != connected)  280                        break;  281#endif //NOSOCKETSTATES  282                    if (pSocket-&gt;m_lEvent &amp; FD_READ)  283                    &#123;  284#ifndef NOSOCKETSTATES  285                        if (nErrorCode)  286                            pSocket-&gt;SetState(aborted);  287#endif //NOSOCKETSTATES  288                        pSocket-&gt;OnReceive(nErrorCode);  289                    &#125;  290                    break;  291                case FD_WRITE:  292#ifndef NOSOCKETSTATES  293                    if (pSocket-&gt;GetState() == connecting &amp;&amp; !nErrorCode)  294                    &#123;  295                        pSocket-&gt;m_nPendingEvents |= FD_WRITE;  296                        break;  297                    &#125;  298                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)  299                        pSocket-&gt;SetState(connected);  300                    if (pSocket-&gt;GetState() != connected)  301                        break;  302#endif //NOSOCKETSTATES  303                    if (pSocket-&gt;m_lEvent &amp; FD_WRITE)  304                    &#123;  305#ifndef NOSOCKETSTATES  306                        if (nErrorCode)  307                            pSocket-&gt;SetState(aborted);  308#endif //NOSOCKETSTATES  309                        pSocket-&gt;OnSend(nErrorCode);  310                    &#125;  311                    break;  312                case FD_CONNECT:  313#ifndef NOSOCKETSTATES  314                    if (pSocket-&gt;GetState() == connecting)  315                        pSocket-&gt;SetState(connected);  316                    else if (pSocket-&gt;GetState() == attached &amp;&amp; !nErrorCode)  317                        pSocket-&gt;SetState(connected);  318#endif //NOSOCKETSTATES  319                    if (pSocket-&gt;m_lEvent &amp; FD_CONNECT)  320                        pSocket-&gt;OnConnect(nErrorCode);  321#ifndef NOSOCKETSTATES  322                    if (!nErrorCode)  323                    &#123;  324                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_READ) &amp;&amp;325                              pSocket-&gt;GetState() == connected) &amp;&amp;326                              (pSocket-&gt;m_lEvent &amp; FD_READ))  327                            pSocket-&gt;OnReceive(0);  328                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_FORCEREAD) &amp;&amp;329                              pSocket-&gt;GetState() == connected) &amp;&amp;330                              (pSocket-&gt;m_lEvent &amp; FD_READ))  331                             pSocket-&gt;OnReceive(0);  332                        if (((pSocket-&gt;m_nPendingEvents&amp;FD_WRITE) &amp;&amp;333                              pSocket-&gt;GetState() == connected) &amp;&amp;334                              (pSocket-&gt;m_lEvent &amp; FD_WRITE))  335                            pSocket-&gt;OnSend(0);  336                    &#125;  337                    pSocket-&gt;m_nPendingEvents = 0;  338#endif //NOSOCKETSTATES  339                    break;  340                case FD_ACCEPT:  341#ifndef NOSOCKETSTATES  342                    if ((pSocket-&gt;GetState() == listening || pSocket-&gt;GetState() == attached) &amp;&amp; (pSocket-&gt;m_lEvent &amp; FD_ACCEPT))  343#endif //NOSOCKETSTATES  344                    &#123;  345                        pSocket-&gt;OnAccept(nErrorCode);  346                    &#125;  347                    break;  348                case FD_CLOSE:  349#ifndef NOSOCKETSTATES  350                    if ((pSocket-&gt;GetState() == connected ||351                         pSocket-&gt;GetState() == attached) &amp;&amp;352                         (pSocket-&gt;m_lEvent &amp; FD_CLOSE))  353                    &#123;  354                        pSocket-&gt;SetState(nErrorCode?aborted:closed);  355#else  356                    &#123;  357#endif //NOSOCKETSTATES  358                        pSocket-&gt;OnClose(nErrorCode);  359                    &#125;  360                    break;  361                &#125;  362            &#125;  363            delete pMsg;  364            return 0;  365        &#125;  366        else if (message == WM_USER+1)  367        &#123;  368            // WSAAsyncGetHostByName reply  369370            // Verify parameters  371            ASSERT(hWnd);  372            CAsyncSocketExHelperWindow *pWnd = (CAsyncSocketExHelperWindow *)373                                                GetWindowLongPtr(hWnd, GWLP_USERDATA);  374            ASSERT(pWnd);  375            if (!pWnd)  376                return 0;  377378            CAsyncSocketEx *pSocket = NULL;  379            for (int i = 0; i &lt; pWnd-&gt;m_nWindowDataSize; ++i) &#123;  380                pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[i].m_pSocket;  381                if (pSocket &amp;&amp; pSocket-&gt;m_hAsyncGetHostByNameHandle &amp;&amp;  382                    pSocket-&gt;m_hAsyncGetHostByNameHandle == (HANDLE)wParam &amp;&amp;  383                    pSocket-&gt;m_pAsyncGetHostByNameBuffer)  384                    break;  385            &#125;  386            if (!pSocket || !pSocket-&gt;m_pAsyncGetHostByNameBuffer)  387                return 0;  388389            int nErrorCode = lParam &gt;&gt; 16;  390            if (nErrorCode) &#123;  391                pSocket-&gt;OnConnect(nErrorCode);  392                return 0;  393            &#125;  394395            SOCKADDR_IN sockAddr&#123;&#125;;  396            sockAddr.sin_family = AF_INET;  397            sockAddr.sin_addr.s_addr = ((LPIN_ADDR)((LPHOSTENT)pSocket-&gt;m_pAsyncGetHostByNameBuffer)-&gt;h_addr)-&gt;s_addr;  398399            sockAddr.sin_port = htons(pSocket-&gt;m_nAsyncGetHostByNamePort);  400401            BOOL res = pSocket-&gt;Connect((SOCKADDR*)&amp;sockAddr, sizeof(sockAddr));  402            delete [] pSocket-&gt;m_pAsyncGetHostByNameBuffer;  403            pSocket-&gt;m_pAsyncGetHostByNameBuffer = 0;  404            pSocket-&gt;m_hAsyncGetHostByNameHandle = 0;  405406            if (!res)  407                if (GetLastError() != WSAEWOULDBLOCK)  408                    pSocket-&gt;OnConnect(GetLastError());  409            return 0;  410        &#125;  411        else if (message == WM_USER + 2)  412        &#123;  413            //Verify parameters, lookup socket and notification message  414            //Verify parameters  415            if (!hWnd)  416                return 0;  417418            CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)419                                              GetWindowLongPtr(hWnd, GWLP_USERDATA);  420            if (!pWnd)  421                return 0;  422423            if (wParam &gt;= static_cast&lt;UINT&gt;(pWnd-&gt;m_nWindowDataSize)) //Index is within socket storage  424                return 0;  425426            CAsyncSocketEx *pSocket = pWnd-&gt;m_pAsyncSocketExWindowData[wParam].m_pSocket;  427            if (!pSocket)  428                return 0;  429430            // Process pending callbacks  431            std::list&lt;t_callbackMsg&gt; tmp;  432            tmp.swap(pSocket-&gt;m_pendingCallbacks);  433            pSocket-&gt;OnLayerCallback(tmp);  434435            for (auto &amp; cb : tmp) &#123;  436                delete [] cb.str;  437            &#125;  438        &#125;  439        else if (message == WM_TIMER)  440        &#123;  441            if (wParam != 1)  442                return 0;  443444            ASSERT(hWnd);  445            CAsyncSocketExHelperWindow *pWnd=(CAsyncSocketExHelperWindow *)446                                              GetWindowLongPtr(hWnd, GWLP_USERDATA);  447            ASSERT(pWnd &amp;&amp; pWnd-&gt;m_pThreadData);  448            if (!pWnd || !pWnd-&gt;m_pThreadData)  449                return 0;  450451            if (pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.empty())  452            &#123;  453                KillTimer(hWnd, 1);  454                return 0;  455            &#125;  456            CAsyncSocketEx* socket = pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.front();  457            pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.pop_front();  458            if (pWnd-&gt;m_pThreadData-&gt;layerCloseNotify.empty())  459                KillTimer(hWnd, 1);  460461            if (socket)  462                PostMessage(hWnd,463                            socket-&gt;m_SocketData.nSocketIndex + WM_SOCKETEX_NOTIFY, 464                            socket-&gt;m_SocketData.hSocket,465                            FD_CLOSE);  466            return 0;  467        &#125;  468        return DefWindowProc(hWnd, message, wParam, lParam);  469    &#125; \n\nå…³äºå•ä¸ªæœåŠ¡ç¨‹åºçš„æ¡†æ¶ï¼Œæˆ‘å·²ç»ä»‹ç»å®Œäº†ï¼Œå¦‚æœä½ èƒ½å®Œå…¨ç†è§£æˆ‘è¦è¡¨è¾¾çš„æ„æ€ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¹Ÿèƒ½æ„å»ºå‡ºä¸€å¥—é«˜æ€§èƒ½æœåŠ¡ç¨‹åºæ¥ã€‚\nï¼ˆå…«ï¼‰é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4â€”â€”ä»¥flamigoæœåŠ¡å™¨ä»£ç ä¸ºä¾‹ç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\näºŒã€æ¶æ„ç¯‡ä¸€ä¸ªé¡¹ç›®çš„æœåŠ¡å™¨ç«¯å¾€å¾€ç”±å¾ˆå¤šæœåŠ¡ç»„æˆï¼Œå°±ç®—å•ä¸ªæœåŠ¡åœ¨æ€§èƒ½ä¸Šåšåˆ°æè‡´ï¼Œæ”¯æŒçš„å¹¶å‘æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡å¦‚ä¸€ä¸ªèŠå¤©æœåŠ¡å™¨ï¼Œæ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯æ˜¯1kï¼Œé‚£å¯¹äºä¸€ä¸ª8Gçš„å†…å­˜çš„æœºå™¨ï¼Œåœ¨ä¸è€ƒè™‘å…¶å®ƒçš„æƒ…å†µä¸‹810241024*1024 &#x2F; 100 &#x3D; 1024ï¼Œå®é™…æœ‰838ä¸‡ï¼Œä½†å®é™…è¿™åªæ˜¯éå¸¸ç†æƒ³çš„æƒ…å†µã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦éœ€è¦æŸä¸ªæœåŠ¡éƒ¨ç½²å¤šå¥—ï¼Œå°±å•ä¸ªæœåŠ¡çš„å®ç°æ¥è®²è¿˜æ˜¯ã€Šæ¡†æ¶ç¯‡ã€‹ä¸­ä»‹ç»çš„ã€‚\n1\næˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š\nè¿™æ˜¯è˜‘è‡è¡—TeamTalkçš„æœåŠ¡å™¨æ¶æ„ã€‚\nMsgServeræ˜¯èŠå¤©æœåŠ¡ï¼Œå¯ä»¥éƒ¨ç½²å¤šå¥—ï¼Œæ¯ä¸ªèŠå¤©æœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½ä¼šå‘Šè¯‰loginSeverå’ŒrouteSeverè‡ªå·±çš„ipåœ°å€å’Œç«¯å£å·ï¼Œå½“æœ‰ç”¨æˆ·ä¸Šçº¿æˆ–è€…ä¸‹çº¿çš„æ—¶å€™ï¼ŒMsgServerä¹Ÿä¼šå‘Šè¯‰loginSeverå’ŒrouteSeverè‡ªå·±ä¸Šé¢æœ€æ–°çš„ç”¨æˆ·æ•°é‡å’Œç”¨æˆ·idåˆ—è¡¨ã€‚\nç°åœ¨ä¸€ä¸ªç”¨æˆ·éœ€è¦ç™»å½•ï¼Œå…ˆè¿æ¥loginServerï¼ŒloginServeræ ¹æ®è®°å½•çš„å„ä¸ªMsgServerä¸Šçš„ç”¨æˆ·æƒ…å†µï¼Œè¿”å›ä¸€ä¸ªæœ€å°è´Ÿè½½çš„MsgServerçš„ipåœ°å€å’Œç«¯å£å·ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†åˆ©ç”¨è¿™ä¸ªipåœ°å€å’Œç«¯å£å·å»ç™»å½•MsgServerã€‚å½“èŠå¤©æ—¶ï¼Œä½äºA MsgServerä¸Šçš„ç”¨æˆ·ç»™å¦å¤–ä¸€ä¸ªç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œå¦‚æœè¯¥ç”¨æˆ·ä¸åœ¨åŒä¸€ä¸ªMsgServerä¸Šï¼ŒMsgServerå°†æ¶ˆæ¯è½¬å‘ç»™RouteServerï¼ŒRouteServeræ ¹æ®è‡ªå·±è®°å½•çš„ç”¨æˆ·idä¿¡æ¯æ‰¾åˆ°ç›®æ ‡ç”¨æˆ·æ‰€åœ¨çš„MsgServerå¹¶è½¬å‘ç»™å¯¹åº”çš„MsgServerã€‚\n2\nä¸Šé¢æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å†æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚è¿™ä¸ªä¾‹å­æ˜¯å•ä¸ªæœåŠ¡çš„ç­–ç•¥ï¼Œå®é™…æœåŠ¡å™¨åœ¨å¤„ç†ç½‘ç»œæ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœåŒæ—¶æœ‰å¤šä¸ªsocketä¸Šæœ‰æ•°æ®è¦å¤„ç†ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€ç›´æœåŠ¡å‰å‡ ä¸ªsocketï¼Œç›´åˆ°å‰å‡ ä¸ªsocketå¤„ç†å®Œæ¯•åå†å¤„ç†åé¢å‡ ä¸ªsocketçš„æ•°æ®ã€‚è¿™å°±ç›¸å½“äºï¼Œä½ å»é¥­åº—åƒé¥­ï¼Œå¤§å®¶éƒ½ç‚¹äº†èœï¼Œä½†æ˜¯æœ‰äº›æ¡Œå­ä¸Šä¸€ç›´åœ¨ä¸Šèœï¼Œè€Œæœ‰äº›æ¡Œå­ä¸Šä¸€ç›´æ²¡æœ‰èœã€‚è¿™æ ·è‚¯å®šä¸å¥½ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•é¿å…è¿™ç§ç°è±¡ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950 1int CFtdEngine::HandlePackage(CFTDCPackage *pFTDCPackage, 2                              CFTDCSession *pSession)   3&#123;   4    //NET_IO_LOG0(&quot;CFtdEngine::HandlePackage\\n&quot;);   5    FTDC_PACKAGE_DEBUG(pFTDCPackage);   6 7    if (pFTDCPackage-&gt;GetTID() != FTD_TID_ReqUserLogin)   8    &#123;   9        if (!IsSessionLogin(pSession-&gt;GetSessionID()))  10        &#123;  11            SendErrorRsp(pFTDCPackage, pSession, 1, &quot;å®¢æˆ·æœªç™»å½•&quot;);  12            return 0;  13        &#125;  14    &#125;  1516    CalcFlux(pSession, pFTDCPackage-&gt;Length());  //ç»Ÿè®¡æµé‡  1718    REPORT_EVENT(LOG_DEBUG, &quot;Front/Fgateway&quot;, &quot;ç™»å½•è¯·æ±‚%0x&quot;,19                  pFTDCPackage-&gt;GetTID());   2021    int nRet = 0;  22    switch(pFTDCPackage-&gt;GetTID())   23    &#123;  2425    case FTD_TID_ReqUserLogin:  26        ///huwpï¼š20070608ï¼šæ£€æŸ¥è¿‡é«˜ç‰ˆæœ¬çš„APIå°†è¢«ç¦æ­¢ç™»å½•  27        if (pFTDCPackage-&gt;GetVersion()&gt;FTD_VERSION)  28        &#123;  29            SendErrorRsp(pFTDCPackage, pSession, 1,30                         &quot;Too High FTD Version&quot;);  31            return 0;  32        &#125;  33        nRet = OnReqUserLogin(pFTDCPackage,34                             (CFTDCSession *)pSession);  35        FTDRequestIndex.incValue();  36        break;  37    case FTD_TID_ReqCheckUserLogin:  38        nRet = OnReqCheckUserLogin(pFTDCPackage, 39                                  (CFTDCSession *)pSession);  40        FTDRequestIndex.incValue();  41        break;  42    case FTD_TID_ReqSubscribeTopic:  43        nRet = OnReqSubscribeTopic(pFTDCPackage, 44                                  (CFTDCSession *)pSession);  45        FTDRequestIndex.incValue();  46        break;    47    &#125;  4849    return 0;  50&#125;\n\nå½“æœ‰æŸä¸ªsocketä¸Šæœ‰æ•°æ®å¯è¯»æ—¶ï¼Œæ¥ç€æ¥æ”¶è¯¥socketä¸Šçš„æ•°æ®ï¼Œå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£åŒ…ï¼Œç„¶åè°ƒç”¨CalcFlux(pSession, pFTDCPackage-&gt;Length())è¿›è¡Œæµé‡ç»Ÿè®¡ï¼š\n1234567891011121314 1void CFrontEngine::CalcFlux(CSession *pSession, const int nFlux)   2&#123;   3    TFrontSessionInfo *pSessionInfo = m_mapSessionInfo.Find(pSession-&gt;GetSessionID());   4    if (pSessionInfo != NULL)   5    &#123;   6        //æµé‡æ§åˆ¶æ”¹ä¸ºè®¡æ•°   7        pSessionInfo-&gt;nCommFlux ++;    8        ///è‹¥æµé‡è¶…è¿‡è§„å®šï¼Œåˆ™æŒ‚èµ·è¯¥ä¼šè¯çš„è¯»æ“ä½œ   9        if (pSessionInfo-&gt;nCommFlux &gt;= pSessionInfo-&gt;nMaxCommFlux)  10        &#123;  11            pSession-&gt;SuspendRead(true);  12        &#125;  13    &#125;  14&#125; \n\nè¯¥å‡½æ•°ä¼šå…ˆè®©æŸä¸ªè¿æ¥ä¼šè¯ï¼ˆSessionï¼‰å¤„ç†çš„åŒ…æ•°é‡é€’å¢ï¼Œæ¥ç€åˆ¤æ–­æ˜¯å¦è¶…è¿‡æœ€å¤§åŒ…æ•°é‡ï¼Œåˆ™è®¾ç½®è¯»æŒ‚èµ·æ ‡å¿—ï¼š\n12341void CSession::SuspendRead(bool bSuspend)  2&#123;  3    m_bSuspendRead = bSuspend;  4&#125;  \n\nè¿™æ ·ä¸‹æ¬¡å°†ä¼šä»æ£€æµ‹çš„socketåˆ—è¡¨ä¸­æ’é™¤è¯¥socketï¼š\n1234567891011121314151617181920212223242526272829 1void CEpollReactor::RegisterIO(CEventHandler *pEventHandler)   2&#123;   3    int nReadID, nWriteID;   4    pEventHandler-&gt;GetIds(&amp;nReadID, &amp;nWriteID);   5    if (nWriteID != 0 &amp;&amp; nReadID ==0)   6    &#123;   7        nReadID = nWriteID;   8    &#125;   9    if (nReadID != 0)  10    &#123;  11        m_mapEventHandlerId[pEventHandler] = nReadID;  12        struct epoll_event ev;  13        ev.data.ptr = pEventHandler;  14        if(epoll_ctl(m_fdEpoll, EPOLL_CTL_ADD, nReadID, &amp;ev) != 0)  15        &#123;  16            perror(&quot;epoll_ctl EPOLL_CTL_ADD&quot;);  17        &#125;  18    &#125;  19&#125;  202122void CSession::GetIds(int *pReadId, int *pWriteId)  23&#123;  24    m_pChannelProtocol-&gt;GetIds(pReadId,pWriteId);  25    if (m_bSuspendRead)  26    &#123;  27        *pReadId = 0;  28    &#125;  29&#125;\n\nä¹Ÿå°±æ˜¯è¯´ä¸å†æ£€æµ‹è¯¥socketä¸Šæ˜¯å¦æœ‰æ•°æ®å¯è¯»ã€‚ç„¶ååœ¨å®šæ—¶å™¨é‡Œ1ç§’åé‡ç½®è¯¥æ ‡å¿—ï¼Œè¿™æ ·è¿™ä¸ªsocketä¸Šæœ‰æ•°æ®çš„è¯åˆå¯ä»¥é‡æ–°æ£€æµ‹åˆ°äº†ï¼š\n123456789101112131415161718192021222324252627282930313233343536 1const int SESSION_CHECK_TIMER_ID    = 9;   2const int SESSION_CHECK_INTERVAL    = 1000;   3 4 5SetTimer(SESSION_CHECK_TIMER_ID, SESSION_CHECK_INTERVAL);   6 7 8void CFrontEngine::OnTimer(int nIDEvent)   9&#123;  10    if (nIDEvent == SESSION_CHECK_TIMER_ID)  11    &#123;  12        CSessionMap::iterator itor = m_mapSession.Begin();  13        while (!itor.IsEnd())  14        &#123;  15            TFrontSessionInfo *pFind = m_mapSessionInfo.Find((*itor)-&gt;GetSessionID());  16            if (pFind != NULL)  17            &#123;  18                CheckSession(*itor, pFind);  19            &#125;  20            itor++;  21        &#125;  22    &#125;  23&#125;  2425void CFrontEngine::CheckSession(CSession *pSession,26                                TFrontSessionInfo *pSessionInfo)  27&#123;  28    ///é‡æ–°å¼€å§‹è®¡ç®—æµé‡  29    pSessionInfo-&gt;nCommFlux -= pSessionInfo-&gt;nMaxCommFlux;  30    if (pSessionInfo-&gt;nCommFlux &lt; 0)  31    &#123;  32        pSessionInfo-&gt;nCommFlux = 0;  33    &#125;  34    ///è‹¥æµé‡è¶…è¿‡è§„å®šï¼Œåˆ™æŒ‚èµ·è¯¥ä¼šè¯çš„è¯»æ“ä½œ  35    pSession-&gt;SuspendRead(pSessionInfo-&gt;nCommFlux &gt;= pSessionInfo-&gt;nMaxCommFlux);36&#125;\n\nè¿™å°±ç›¸å½“ä¸é¥­åº—é‡Œé¢å…ˆç»™æŸä¸€æ¡Œå®¢äººä¸Šä¸€äº›èœï¼Œè®©ä»–ä»¬å…ˆåƒç€ï¼Œç­‰ä¸Šäº†ä¸€äº›èœä¹‹åä¸ä¼šå†ç»™è¿™æ¡Œç»§ç»­ä¸Šèœäº†ï¼Œè€Œæ˜¯ç»™å…¶å®ƒç©ºæ¡Œä¸Šèœï¼Œå¤§å®¶éƒ½åƒä¸Šåï¼Œç»§ç»­å›æ¥ç»™åŸå…ˆçš„æ¡Œå­ç»§ç»­ä¸Šèœã€‚å®é™…ä¸Šæˆ‘ä»¬çš„é¥­åº—éƒ½æ˜¯è¿™ä¹ˆåšçš„ã€‚ä¸Šé¢çš„ä¾‹å­æ˜¯å•æœåŠ¡æµé‡æ§åˆ¶çš„å®ç°çš„ä¸€ä¸ªéå¸¸å¥½çš„æ€è·¯ï¼Œå®ƒä¿è¯äº†æ¯ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½å‡è¡¡åœ°å¾—åˆ°æœåŠ¡ï¼Œè€Œä¸æ˜¯ä¸€äº›å®¢æˆ·ç«¯ç­‰å¾ˆä¹…æ‰æœ‰å“åº”ã€‚\n3\nå¦å¤–åŠ å¿«æœåŠ¡å™¨å¤„ç†é€Ÿåº¦çš„ç­–ç•¥å¯èƒ½å°±æ˜¯ç¼“å­˜äº†ï¼Œç¼“å­˜å®é™…ä¸Šæ˜¯ä»¥ç©ºé—´æ¢å–æ—¶é—´çš„ç­–ç•¥ã€‚å¯¹äºä¸€äº›åå¤ä½¿ç”¨çš„ï¼Œä½†æ˜¯ä¸ç»å¸¸æ”¹å˜çš„ä¿¡æ¯ï¼Œå¦‚æœä»åŸå§‹åœ°ç‚¹åŠ è½½è¿™äº›ä¿¡æ¯å°±æ¯”è¾ƒè€—æ—¶çš„æ•°æ®ï¼ˆæ¯”å¦‚ä»ç£ç›˜ä¸­ã€ä»æ•°æ®åº“ä¸­ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç¼“å­˜ã€‚\næ‰€ä»¥æ—¶ä¸‹åƒredisã€leveldbã€fastdbç­‰å„ç§å†…å­˜æ•°æ®åº“å¤§è¡Œå…¶é“ã€‚æˆ‘åœ¨flamingoä¸­ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯éƒ½æ˜¯ç¼“å­˜åœ¨èŠå¤©æœåŠ¡ç¨‹åºä¸­çš„ï¼Œè€Œæ–‡ä»¶æœåŠ¡å¯åŠ¨æ—¶ä¼šå»åŠ è½½æŒ‡å®šç›®å½•é‡Œé¢çš„æ‰€æœ‰ç¨‹åºåç§°ï¼Œè¿™äº›æ–‡ä»¶çš„åç§°éƒ½æ˜¯md5ï¼Œä¸ºè¯¥æ–‡ä»¶å†…å®¹çš„md5ã€‚è¿™æ ·å½“å®¢æˆ·ç«¯ä¸Šä¼ äº†æ–°æ–‡ä»¶è¯·æ±‚æ—¶ï¼Œå¦‚æœå…¶ä¼ ä¸Šæ¥çš„æ–‡ä»¶md5å·²ç»ä½äºç¼“å­˜ä¸­ï¼Œåˆ™è¡¨æ˜è¯¥æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šå·²ç»å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™æœåŠ¡å™¨å°±ä¸å¿…å†æ¥æ”¶è¯¥æ–‡ä»¶äº†ï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·ç«¯æ–‡ä»¶å·²ç»ä¸Šä¼ æˆåŠŸäº†ã€‚\nè¯´äº†è¿™ä¹ˆå¤šï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªæœåŠ¡å™¨çš„æ¶æ„ï¼Œå¾€å¾€æ›´å¤šå–å†³äºå…¶å…·ä½“çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬è¦åœ¨ç»“åˆå½“å‰çš„æƒ…å†µæ¥å®é™…å»ç»„ç»‡é“ºæ’ï¼Œæ²¡æœ‰ä¸€å¥—ç³»ç»Ÿæ˜¯ä¸‡èƒ½çš„ã€‚å¤šæ€è€ƒï¼Œå¤šå®è·µï¼Œå¤šæ€»ç»“ï¼Œç›¸ä¿¡å¾ˆå¿«ä½ ä¹Ÿèƒ½æ‹¥æœ‰å¾ˆä¸é”™çš„æ¶æ„èƒ½åŠ›ã€‚\né‰´äºç¬”è€…èƒ½åŠ›å’Œç»éªŒæœ‰é™ï¼Œæ–‡ä¸­éš¾å…æœ‰é”™æ¼ä¹‹å¤„ï¼Œæ¬¢è¿ææ„è§ã€‚ äº¤æµQQç¾¤ï¼š49114021\næœ¬ç³»åˆ—å®Œ\nç³»åˆ—ç›®å½•\nç¬¬01ç¯‡ ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„åˆ†å·¥\nç¬¬02ç¯‡ Reactoræ¨¡å¼\nç¬¬03ç¯‡ ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºçš„æ¶æ„ä»‹ç»\nç¬¬04ç¯‡ å¦‚ä½•å°†socketè®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼\nç¬¬05ç¯‡ å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½æ—¥å¿—\nç¬¬06ç¯‡ å…³äºç½‘ç»œç¼–ç¨‹çš„ä¸€äº›å®ç”¨æŠ€å·§å’Œç»†èŠ‚\nç¬¬07ç¯‡ å¼€æºä¸€æ¬¾å³æ—¶é€šè®¯è½¯ä»¶çš„æºç \nç¬¬08ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“1\nç¬¬09ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“2\nç¬¬10ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“3\nç¬¬11ç¯‡ é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“4\næ¬¢è¿å…³æ³¨å…¬ä¼—å·ã€easyserverdevã€ã€‚å¦‚æœæœ‰ä»»ä½•æŠ€æœ¯æˆ–è€…èŒä¸šæ–¹é¢çš„é—®é¢˜éœ€è¦æˆ‘æä¾›å¸®åŠ©ï¼Œå¯é€šè¿‡è¿™ä¸ªå…¬ä¼—å·ä¸æˆ‘å–å¾—è”ç³»ï¼Œæ­¤å…¬ä¼—å·ä¸ä»…åˆ†äº«é«˜æ€§èƒ½æœåŠ¡å™¨å¼€å‘ç»éªŒå’Œæ•…äº‹ï¼ŒåŒæ—¶ä¹Ÿå…è´¹ä¸ºå¹¿å¤§æŠ€æœ¯æœ‹å‹æä¾›æŠ€æœ¯ç­”ç–‘å’ŒèŒä¸šè§£æƒ‘ï¼Œæ‚¨æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥åœ¨å¾®ä¿¡å…¬ä¼—å·ç›´æ¥ç•™è¨€ï¼Œæˆ‘ä¼šå°½å¿«å›å¤æ‚¨ã€‚\n\n","slug":"è½¬è½½/é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡/é«˜æ€§èƒ½æœåŠ¡å™¨æ¶æ„è®¾è®¡æ€»ç»“","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"c++,é«˜æ€§èƒ½æœåŠ¡å™¨æ¡†æ¶è®¾è®¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"6f9f848d419f584cbff23ed4ace411b4","title":"ã€è½¬è½½ã€‘Linuxtcpdumpä½¿ç”¨ä»‹ç»","content":"Linux tcpdump ä½¿ç”¨ä»‹ç»tcpdump æ˜¯ Linux ç³»ç»Ÿæä¾›ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŠ“åŒ…å·¥å…·ï¼Œç†Ÿç»ƒä½¿ç”¨å®ƒï¼Œå¯¹æˆ‘ä»¬æ’æŸ¥ç½‘ç»œé—®é¢˜éå¸¸æœ‰ç”¨ã€‚å¦‚æœä½ çš„æœºå™¨ä¸Šè¿˜æ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š\n1yum install tcpdump\n\nå¦‚æœè¦ä½¿ç”¨ tcpdump å‘½ä»¤å¿…é¡»å…·æœ‰ sudo æƒé™ã€‚\ntcpdump å¸¸ç”¨çš„é€‰é¡¹æœ‰ï¼š\n\n-i æŒ‡å®šè¦æ•è·çš„ç›®æ ‡ç½‘å¡åï¼Œç½‘å¡åå¯ä»¥ä½¿ç”¨å‰é¢ç« èŠ‚ä¸­ä»‹ç»çš„ ifconfig å‘½ä»¤è·å¾—ï¼›å¦‚æœè¦æŠ“æ‰€æœ‰ç½‘å¡çš„ä¸Šçš„åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ any å…³é”®å­—ã€‚\n1234## æŠ“å–ç½‘å¡ens33ä¸Šçš„åŒ…tcpdump -i ens33## æŠ“å–æ‰€æœ‰ç½‘å¡ä¸Šçš„åŒ…tcpdump -i any\n\n-X ä»¥ ASCII å’Œåå…­è¿›åˆ¶çš„å½¢å¼è¾“å‡ºæ•è·çš„æ•°æ®åŒ…å†…å®¹ï¼Œå‡å»é“¾è·¯å±‚çš„åŒ…å¤´ä¿¡æ¯ï¼›**-XX** ä»¥ ASCII å’Œåå…­è¿›åˆ¶çš„å½¢å¼è¾“å‡ºæ•è·çš„æ•°æ®åŒ…å†…å®¹ï¼ŒåŒ…æ‹¬é“¾è·¯å±‚çš„åŒ…å¤´ä¿¡æ¯ã€‚\n\n-n ä¸è¦å°† ip åœ°å€æ˜¾ç¤ºæˆåˆ«åçš„å½¢å¼ï¼›**-nn** ä¸è¦å°† ip åœ°å€å’Œç«¯å£ä»¥åˆ«åçš„å½¢å¼æ˜¾ç¤ºã€‚\n\n-S ä»¥ç»å¯¹å€¼æ˜¾ç¤ºåŒ…çš„ ISN å·ï¼ˆåŒ…åºåˆ—å·ï¼‰ï¼Œé»˜è®¤ä»¥ä¸Šä¸€åŒ…çš„åç§»é‡æ˜¾ç¤ºã€‚\n\n-vv æŠ“åŒ…çš„ä¿¡æ¯è¯¦ç»†åœ°æ˜¾ç¤ºï¼›**-vvv** æŠ“åŒ…çš„ä¿¡æ¯æ›´è¯¦ç»†åœ°æ˜¾ç¤ºã€‚\n\n-w å°†æŠ“å–çš„åŒ…çš„åŸå§‹ä¿¡æ¯ï¼ˆä¸è§£æï¼Œä¹Ÿä¸è¾“å‡ºï¼‰å†™å…¥æ–‡ä»¶ä¸­ï¼Œåè·Ÿæ–‡ä»¶åï¼š\n1tcpdump -i any -w filename  \n\n-r ä»åˆ©ç”¨ -w é€‰é¡¹ä¿å­˜çš„åŒ…æ–‡ä»¶ä¸­è¯»å–æ•°æ®åŒ…ä¿¡æ¯ã€‚\n\n\né™¤äº†å¯ä»¥ä½¿ç”¨é€‰é¡¹ä»¥å¤–ï¼Œtcpdump è¿˜æ”¯æŒå„ç§æ•°æ®åŒ…è¿‡æ»¤çš„è¡¨è¾¾å¼ï¼Œå¸¸è§çš„å½¢å¼å¦‚ä¸‹ï¼š\n123456789101112131415## ä»…æ˜¾ç¤ºç»è¿‡ç«¯å£ 8888 ä¸Šçš„æ•°æ®åŒ…ï¼ˆåŒ…æ‹¬tcp:8888å’Œudp:8888ï¼‰tcpdump -i any &#x27;port 8888&#x27;## ä»…æ˜¾ç¤ºç»è¿‡ç«¯å£æ˜¯ tcp:8888 ä¸Šçš„æ•°æ®åŒ…tcpdump -i any &#x27;tcp port 8888&#x27;## ä»…æ˜¾ç¤ºä»æºç«¯å£æ˜¯ tcp:8888 çš„æ•°æ®åŒ…tcpdump -i any &#x27;tcp src port 8888&#x27;## ä»…æ˜¾ç¤ºæºç«¯å£æ˜¯ tcp:8888 æˆ–ç›®æ ‡ç«¯å£æ˜¯ udp:9999 çš„åŒ… tcpdump -i any &#x27;tcp src port 8888 or udp dst port 9999&#x27;## ä»…æ˜¾ç¤ºåœ°å€æ˜¯127.0.0.1 ä¸”æºç«¯å£æ˜¯ tcp:9999 çš„åŒ… ï¼Œä»¥ ASCII å’Œåå…­è¿›åˆ¶æ˜¾ç¤ºè¯¦ç»†è¾“å‡ºï¼Œ## ä¸æ˜¾ç¤º ip åœ°å€å’Œç«¯å£å·çš„åˆ«åtcpdump -i any &#x27;src host 127.0.0.1 and tcp src port 9999&#x27; -XX -nn -vv\n\nä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ªå…·ä½“çš„æ“ä½œå®ä¾‹æ¥æ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨ tcpdump çš„æŠ“åŒ…è¿‡ç¨‹ã€‚\nå®ä¾‹ä¸€ ï¼šè¿æ¥ä¸€ä¸ªæ­£å¸¸çš„ä¾¦å¬ç«¯å£\nå‡è®¾æˆ‘çš„æœåŠ¡å™¨ç«¯çš„åœ°å€æ˜¯ 127.0.0.0.1:12345ï¼Œä½¿ç”¨ nc å‘½ä»¤åœ¨ä¸€ä¸ª shell çª—å£åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºå¹¶åœ¨è¿™ä¸ªåœ°å€ä¸Šè¿›è¡Œä¾¦å¬ã€‚\n1nc â€“v -l 127.0.0.0.112345\n\næ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nåœ¨å¦å¤–ä¸€ä¸ª shell çª—å£å¼€å¯ tcpdump æŠ“åŒ…ï¼š\n1tcpdump -i any &#x27;port 12345&#x27; -XX -nn -vv\n\næ•ˆæœå¦‚ä¸‹ï¼š\n\nç„¶åå†å¼€ä¸€ä¸ª shell çª—å£ï¼Œåˆ©ç”¨ nc å‘½ä»¤åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯å»è¿æ¥æœåŠ¡å™¨ï¼š\n1nc -v 127.0.0.1 12345\n\næ•ˆæœå¦‚ä¸‹ï¼š\n\næˆ‘ä»¬æŠ“åˆ°çš„åŒ…å¦‚ä¸‹ï¼š\n\nç”±äºæˆ‘ä»¬æ²¡æœ‰åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å‘é€ä»»ä½•æ¶ˆæ¯ï¼Œå…¶å®æŠ“åˆ°çš„åŒ…å°±æ˜¯ TCP è¿æ¥çš„ä¸‰æ¬¡æ¡æ‰‹æ•°æ®åŒ…ï¼Œåˆ†æå¦‚ä¸‹ï¼š\nä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ˜¯å®¢æˆ·ç«¯å…ˆç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ª SYNï¼Œç„¶åæœåŠ¡å™¨åº”ç­”ä¸€ä¸ª SYN + ACKï¼Œåº”ç­”çš„åºåˆ—å·æ˜¯é€’å¢ 1 çš„ï¼Œè¡¨ç¤ºåº”ç­”å“ªä¸ªè¯·æ±‚ï¼Œå³ä» 4004096087 é€’å¢åˆ° 4004096088ï¼Œæ¥ç€å®¢æˆ·ç«¯å†åº”ç­”ä¸€ä¸ª ACKã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°å‘åŒ…åºåˆ—å·å’Œåº”ç­”åºåˆ—å·éƒ½å˜æˆ 1äº†ï¼Œè¿™æ˜¯ tcpdump ä½¿ç”¨ç›¸å¯¹åºå·ï¼Œæˆ‘ä»¬åŠ ä¸Š -S é€‰é¡¹åå°±å˜æˆç»å¯¹åºåˆ—å·äº†ã€‚\næˆ‘ä»¬æŒ‰ Ctrl + C ä¸­æ–­ tcpdump æŠ“åŒ…è¿‡ç¨‹ï¼Œå¹¶åœæ­¢ç”¨ nc å¼€å¯çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç¨‹åºï¼Œç„¶ååœ¨å‰é¢çš„ tcpdump å‘½ä»¤åé¢åŠ ä¸Š -S é€‰é¡¹é‡æ–°å¼€å¯æŠ“åŒ…ï¼Œä½¿ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š\n1tcpdump -i any &#x27;port 12345&#x27; -XX -nn -vv -S\n\nç„¶åå†æŒ‰é¡ºåºç”¨ nc å‘½ä»¤å†æ¬¡å¯åŠ¨ä¸‹æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ç¨‹åºã€‚å†æ¬¡å¾—åˆ°æŠ“åŒ…ç»“æœï¼š\n\nè¿™æ¬¡å¾—åˆ°çš„åŒ…çš„åºå·å°±æ˜¯ç»å¯¹åºå·äº†ã€‚\nå®ä¾‹äºŒï¼šè¿æ¥ä¸€ä¸ªä¸å­˜åœ¨çš„ä¾¦å¬ç«¯å£\nå®ä¾‹ä¸€æ¼”ç¤ºçš„æ˜¯æ­£å¸¸çš„ TCP è¿æ¥ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ•è·åˆ°çš„æ•°æ®åŒ…ã€‚å‡å¦‚æˆ‘ä»¬è¿æ¥çš„æœåŠ¡å™¨ ip åœ°å€å­˜åœ¨ï¼Œä½†ç›‘å¬ç«¯å£å·ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬çœ‹ä¸‹ tcpdump æŠ“åŒ…ç»“æœã€‚é™¤äº†åœ¨ä¸€ä¸ª shell çª—å£å¯åŠ¨ä¸€ä¸ª tcpdump æŠ“åŒ…ç›‘æµ‹ï¼Œåœ¨å¦å¤–ä¸€ä¸ª shell çª—å£ç”¨ nc å‘½ä»¤å»è¿æ¥ä¸€ä¸ªä¸å­˜åœ¨çš„ä¾¦å¬ç«¯å£å³å¯ã€‚\n\næŠ“åŒ…æ•°æ®å¦‚ä¸‹ï¼š\n\nè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯å‘é€ SYNï¼ŒæœåŠ¡å™¨åº”ç­” ACK+RSTï¼Œè¿™ä¸ªåº”ç­”åŒ…ä¼šå¯¼è‡´å®¢æˆ·ç«¯çš„ connect è¿æ¥å¤±è´¥è¿”å›ã€‚\nå®ä¾‹ä¸‰ï¼šè¿æ¥ä¸€ä¸ªå¾ˆé¥è¿œçš„ ipï¼Œæˆ–è€…ç½‘ç»œç¹å¿™çš„æƒ…å½¢\nå®é™…æƒ…å½¢ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ç§æƒ…å†µå°±æ˜¯å®¢æˆ·ç«¯è®¿é—®ä¸€ä¸ªå¾ˆé¥è¿œçš„ ipï¼Œæˆ–è€…ç½‘ç»œç¹å¿™ï¼ŒæœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯å‘é€çš„ TCP ä¸‰æ¬¡æ¡æ‰‹çš„ç½‘ç»œ SYN æŠ¥æ–‡æ²¡æœ‰åº”ç­”ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ\næˆ‘ä»¬é€šè¿‡è®¾ç½®é˜²ç«å¢™è§„åˆ™æ¥æ¨¡æ‹Ÿä¸€ä¸‹è¿™ç§æƒ…å†µã€‚ä½¿ç”¨ iptables -F å…ˆå°†é˜²ç«å¢™çš„å·²æœ‰è§„åˆ™éƒ½æ¸…ç†æ‰ï¼Œç„¶åç»™é˜²ç«å¢™çš„ INPUT é“¾ä¸Šå¢åŠ ä¸€ä¸ªè§„åˆ™ï¼šä¸¢å¼ƒæœ¬åœ°ç½‘å¡ loï¼ˆä¹Ÿå°±æ˜¯ 127.0.0.1 è¿™ä¸ªå›ç¯åœ°å€ï¼‰ä¸Šçš„æ‰€æœ‰ SYN åŒ…ã€‚\n12iptables -Fiptables -I INPUT -p tcp --syn -i lo -j DROP\n\n\n\nå¦‚æœè¯»è€…å¯¹ CentOS çš„é˜²ç«å¢™ iptables å‘½ä»¤æœ‰å…´è¶£ï¼Œå¯ä»¥ä½¿ç”¨ man iptables åœ¨ man æ‰‹å†Œä¸­æŸ¥çœ‹æ›´è¯¦ç»†çš„å¸®åŠ©ã€‚\n\nåœ¨å¼€å¯ tcpdump æŠ“åŒ…ä¹‹åå’Œè®¾ç½®é˜²ç«å¢™è§„åˆ™ä¹‹åï¼Œåˆ©ç”¨ nc å‘½ä»¤å»è¿æ¥ 127.0.0.1:12345 è¿™ä¸ªåœ°å€ã€‚æ•´ä¸ªè¿‡ç¨‹æ“ä½œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n\næ¥ç€ï¼Œæˆ‘ä»¬å¾—åˆ° tcpdump æŠ“åˆ°çš„æ•°æ®åŒ…å¦‚ä¸‹ï¼š\n\né€šè¿‡æŠ“åŒ…æ•°æ®æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šå¦‚æœè¿æ¥ä¸ä¸Šï¼Œä¸€å…±é‡è¯•äº† 5 æ¬¡ï¼Œé‡è¯•çš„æ—¶é—´é—´éš”æ˜¯ 1 ç§’ï¼Œ2ç§’ï¼Œ4ç§’ï¼Œ8ç§’ï¼Œ16ç§’ï¼Œæœ€åè¿”å›è¶…æ—¶å¤±è´¥ã€‚è¿™ä¸ªé‡è¯•æ¬¡æ•°åœ¨ &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_syn_retries å†…æ ¸å‚æ•°ä¸­è®¾ç½®ï¼Œé»˜è®¤ä¸º 6 ã€‚\n\nTCP å››æ¬¡æŒ¥æ‰‹ä¸ä¸‰æ¬¡æ¡æ‰‹åŸºæœ¬ä¸Šç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸è´´å‡º tcpdump æŠ“åŒ…çš„è¯¦æƒ…äº†ï¼Œå¼ºçƒˆå»ºè®®ä¸ç†Ÿæ‚‰è¿™å—çš„è¯»è€…å®é™…ç»ƒä¹ ä¸€éã€‚\n\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/Linuxtcpdumpä½¿ç”¨ä»‹ç»","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e29cafb5ee3b6ecc425a0d63d3989d66","title":"ã€è½¬è½½ã€‘Linuxç½‘ç»œæ•…éšœæ’æŸ¥çš„ç‘å£«å†›åˆ€","content":"Linux ç½‘ç»œæ•…éšœæ’æŸ¥çš„ç‘å£«å†›åˆ€nc å³ netcat å‘½ä»¤ï¼Œè¿™ä¸ªå·¥å…·åœ¨æ’æŸ¥ç½‘ç»œæ•…éšœæ—¶éå¸¸æœ‰ç”¨ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå› è€Œè¢«ä¸šç»©ç§°ä¸ºç½‘ç»œç•Œçš„â€œç‘å£«å†›åˆ€â€ï¼Œè¯·è¯»è€…åŠ¡å¿…æŒæ¡ã€‚é»˜è®¤ç³»ç»Ÿæ˜¯æ²¡æœ‰è¿™ä¸ªå‘½ä»¤çš„ï¼Œä½ éœ€è¦å®‰è£…ä¸€ä¸‹ï¼Œå®‰è£…æ–¹æ³•ï¼š\n1yum install nc\n\nnc å‘½ä»¤å¸¸è§çš„ç”¨æ³•æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºè¢«å…¶ä»–å®¢æˆ·ç«¯è¿æ¥ï¼Œæˆ–è€…æ¨¡æ‹Ÿä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥å…¶ä»–æœåŠ¡å™¨ï¼Œè¿æ¥ä¹‹åå°±å¯ä»¥è¿›è¡Œæ•°æ®æ”¶å‘ã€‚æˆ‘ä»¬æ¥é€ä¸€ä»‹ç»ä¸€ä¸‹ï¼š\n\næ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡å™¨ç¨‹åº\nä½¿ç”¨ -l é€‰é¡¹ï¼ˆå•è¯ listen çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼‰åœ¨æŸä¸ª ip åœ°å€å’Œç«¯å£å·ä¸Šå¼€å¯ä¸€ä¸ªä¾¦å¬æœåŠ¡ï¼Œä»¥ä¾¿è®©å…¶ä»–å®¢æˆ·ç«¯è¿æ¥ã€‚é€šå¸¸ä¸ºäº†æ˜¾ç¤ºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œä¼šå¸¦ä¸Š -v é€‰é¡¹ã€‚\nç¤ºä¾‹å¦‚ä¸‹ï¼š\n123[root@iZ238vnojlyZ ~]# nc -v -l 127.0.0.1 6000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on 127.0.0.1:6000\n\nè¿™æ ·å°±åœ¨ 6000 ç«¯å£å¼€å¯äº†ä¸€ä¸ªä¾¦å¬æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ 127.0.0.1:6000 å»è¿æ¥ä¸Šå»ï¼›å¦‚æœä½ çš„æœºå™¨å¯ä»¥è¢«å¤–ç½‘è®¿é—®ï¼Œä½ å¯ä»¥ä½¿ç”¨ 0.0.0.0 è¿™æ ·çš„ä¾¦å¬åœ°å€ï¼Œç¤ºä¾‹ï¼š\n123[root@iZ238vnojlyZ ~]# nc -v -l 0.0.0.0 6000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on 0.0.0.0:6000\n\næ¨¡æ‹Ÿä¸€ä¸ªå®¢æˆ·ç«¯ç¨‹åº\nç”¨ nc å‘½ä»¤æ¨¡æ‹Ÿä¸€ä¸ªå®¢æˆ·ç«¯ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ -l é€‰é¡¹ï¼Œç›´æ¥å†™ä¸Š ip åœ°å€ï¼ˆæˆ–åŸŸåï¼Œnc å‘½ä»¤å¯ä»¥è‡ªåŠ¨è§£æåŸŸåï¼‰å’Œç«¯å£å·å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\n1234## è¿æ¥ç™¾åº¦ web æœåŠ¡å™¨[root@iZ238vnojlyZ ~]# nc -v www.baidu.com 80Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Connected to 115.239.211.112:80.\n\nè¾“å‡ºæç¤ºæˆ‘ä»¬æˆåŠŸè¿æ¥ä¸Šç™¾åº¦ Web æœåŠ¡å™¨ã€‚\n\n\næˆ‘ä»¬çŸ¥é“å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ä¸€èˆ¬éƒ½æ˜¯æ“ä½œç³»ç»Ÿéšæœºåˆ†é…ä¸€ä¸ªå¯ç”¨çš„ç«¯å£å·è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šå»ï¼Œä½¿ç”¨ nc å‘½ä»¤ä½œä¸ºå®¢æˆ·ç«¯æ—¶å¯ä»¥ä½¿ç”¨ -p é€‰é¡¹æŒ‡å®šä½¿ç”¨å“ªä¸ªç«¯å£å·è¿æ¥æœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ¬åœ° 5555 ç«¯å£è¿æ¥ç™¾åº¦çš„ Web æœåŠ¡å™¨ï¼Œå¯ä»¥è¿™ä¹ˆè¾“å…¥ï¼š\n123[root@iZ238vnojlyZ ~]# nc -v -p 5555 www.baidu.com 80Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Connected to 115.239.211.112:80.\n\nå†å¼€ä¸€ä¸ª shell çª—å£ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šæ–‡ä¸­ä»‹ç»çš„ lsof å‘½ä»¤éªŒè¯ä¸€ä¸‹ï¼Œæ˜¯å¦ç¡®å®é€šè¿‡ 5555 ç«¯å£è¿æ¥ä¸Šäº†ç™¾åº¦ Web æœåŠ¡å™¨ã€‚\n12[root@iZ238vnojlyZ ~]# lsof -Pni | grep ncnc        32610    root    3u  IPv4 113369437      0t0  TCP 120.55.94.78:5555-&gt;115.239.211.112:80 (ESTABLISHED)\n\nç»“æœç¡®å®å¦‚æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚\nå½“ç„¶ï¼Œå½“ä½¿ç”¨ nc å‘½ä»¤ä¸å¯¹ç«¯å»ºç«‹è¿æ¥åï¼Œæˆ‘ä»¬å¯ä»¥å‘é€æ¶ˆæ¯ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹\n\nä½¿ç”¨ nc -v -l 0.0.0.0 6000 æ¨¡æ‹Ÿä¸€ä¸ªä¾¦å¬æœåŠ¡ï¼Œå†æ–°å»ºä¸€ä¸ª shell çª—å£åˆ©ç”¨ nc -v 127.0.0.1 6000 æ¨¡æ‹Ÿä¸€ä¸ªå®¢æˆ·ç«¯ç¨‹åºè¿æ¥åˆšæ‰çš„æœåŠ¡å™¨ã€‚\næ­¤æ—¶åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±å¯ä»¥ç›¸äº’å‘æ¶ˆæ¯äº†ã€‚æˆ‘ä»¬å¯ä»¥è¾¾åˆ°ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ IM è½¯ä»¶èŠå¤©æ•ˆæœï¼š\n\nå®¢æˆ·ç«¯æ•ˆæœï¼š\n\næœåŠ¡å™¨ç«¯æ•ˆæœï¼š\n\n\næœä½ åœ¨ä½¿ç”¨ nc å‘½ä»¤å‘æ¶ˆæ¯æ—¶ä¸å°å¿ƒè¾“å…¥é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨ Ctrl + Backspace é”®åˆ é™¤ã€‚\n\nnc å‘½ä»¤é»˜è®¤ä¼šå°† \\n ä½œä¸ºæ¯æ¡æ¶ˆæ¯çš„ç»“æŸæ ‡å¿—ï¼Œå¦‚æœä½ æŒ‡å®šäº† -C é€‰é¡¹ï¼Œå°†ä¼šä½¿ç”¨ \\r\\n ä½œä¸ºæ¶ˆæ¯ç»“æŸæ ‡å¿—ã€‚\nnc å‘½ä»¤ä¸ä»…å¯ä»¥å‘æ¶ˆæ¯ï¼ŒåŒæ—¶ä¹Ÿèƒ½å‘æ–‡ä»¶ã€‚æˆ‘ä»¬ä¹Ÿæ¥æ¼”ç¤ºä¸€ä¸‹ï¼š\néœ€è¦æ³¨æ„çš„æ˜¯æ˜¯æ¥æ”¶æ–‡ä»¶çš„ä¸€æ–¹æ˜¯æœåŠ¡å™¨ç«¯ï¼Œå‘é€æ–‡ä»¶çš„ä¸€æ–¹æ˜¯å®¢æˆ·ç«¯ã€‚\n\næœåŠ¡å™¨ç«¯å‘½ä»¤ï¼š\n1nc -l ipåœ°å€ ç«¯å£å· &gt; æ¥æ”¶çš„æ–‡ä»¶å\n\nå®¢æˆ·ç«¯å‘½ä»¤ï¼š\n1nc ipåœ°å€ ç«¯å£å· &lt; å‘é€çš„æ–‡ä»¶å\n\næœåŠ¡å™¨ç«¯æ•ˆæœï¼š\n\nå®¢æˆ·ç«¯æ•ˆæœï¼š\n\n\næ„ï¼šè¿™é‡Œå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæ–‡ä»¶å« index.htmlï¼ŒæœåŠ¡å™¨ç«¯ä»¥æ–‡ä»¶å xxx.html æ¥ä¿å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´æœåŠ¡å™¨ç«¯ä¿å­˜æ¥æ”¶çš„æ–‡ä»¶åæ—¶ä¸ä¸€å®šè¦ä½¿ç”¨å®¢æˆ·ç«¯å‘é€çš„æ–‡ä»¶åã€‚\n\næ ¹æ®ä¸Šé¢çš„ä»‹ç»ï¼Œå½“æˆ‘ä»¬éœ€è¦è°ƒè¯•æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨æˆ–è€…å®¢æˆ·ç«¯ç¨‹åºæ—¶ï¼Œåˆä¸æƒ³è‡ªå·±å¼€å‘ç›¸åº”çš„å¯¹ç«¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ nc å‘½ä»¤å»æ¨¡æ‹Ÿã€‚\nå½“ç„¶ï¼Œnc å‘½ä»¤éå¸¸å¼ºå¤§ï¼Œå…¶åŠŸèƒ½è¿œéæœ¬èŠ‚ä»‹ç»çš„è¿™äº›ï¼Œè¯»è€…å¦‚æœæœ‰å…´è¶£å¯ä»¥å» nc çš„ man æ‰‹å†Œä¸Šè·å–æ›´å¤šçš„ä¿¡æ¯ã€‚\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/Linuxç½‘ç»œæ•…éšœæ’æŸ¥çš„ç‘å£«å†›åˆ€","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c9d344dfed244a58bff8099c6790dfe5","title":"ã€è½¬è½½ã€‘ä»æŠ“åŒ…çš„è§’åº¦åˆ†æconnectå‡½æ•°çš„è¿æ¥è¿‡ç¨‹","content":"ä»æŠ“åŒ…çš„è§’åº¦åˆ†æconnect()å‡½æ•°çš„è¿æ¥è¿‡ç¨‹è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä»tcpè¿æ¥å»ºç«‹çš„è§’åº¦æ¥åˆ†æå®¢æˆ·ç«¯ç¨‹åºå¦‚ä½•åˆ©ç”¨connectå‡½æ•°å’ŒæœåŠ¡ç«¯ç¨‹åºå»ºç«‹tcpè¿æ¥çš„ï¼Œäº†è§£connectå‡½æ•°åœ¨å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ä¸­åº•å±‚åè®®æ ˆåšäº†å“ªäº›äº‹æƒ…ã€‚\ntcpä¸‰æ¬¡æ¡æ‰‹åœ¨æ­£å¼ä»‹ç»connectå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹tcpä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œä¸‹é¢è¿™ä¸ªå®éªŒæ˜¯å®¢æˆ·ç«¯é€šè¿‡telnetè¿œç¨‹ç™»å½•æœåŠ¡ç«¯çš„ä¾‹å­ï¼Œtelnetåè®®æ˜¯åŸºäºtcpåè®®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡wiresharkæŠ“åŒ…å·¥å…·çœ‹åˆ°å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œ12.1.1.1æ˜¯å®¢æˆ·ç«¯çš„ipåœ°å€ï¼Œ12.1.1.2æ˜¯æœåŠ¡ç«¯çš„ipåœ°å€ã€‚\n\nä¸‹é¢æ˜¯æˆ‘ä»¬é€šè¿‡wiresharkæŠ“å–åˆ°çš„tcpä¸‰æ¬¡æ¡æ‰‹çš„æ•°æ®åŒ…ï¼š\n\næˆ‘ä»¬çœ‹åˆ°å®¢æˆ·ç«¯è¿œç¨‹ç™»å½•æœåŠ¡ç«¯æ—¶ï¼Œé¦–å…ˆå‘é€äº†ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œå…¶ä¸­ç›®æ ‡ç«¯å£ä¸º23ï¼ˆè¿œç¨‹ç™»å½•telnetåè®®ä½¿ç”¨23ç«¯å£ï¼‰ï¼Œåˆå§‹åºå·seq &#x3D; 0ï¼Œå¹¶è®¾ç½®è‡ªå·±çš„çª—å£rwnd &#x3D; 4128ï¼ˆrwndæ˜¯ä¸€ä¸ªå¯¹ç«¯é€šå‘Šçš„æ¥æ”¶çª—å£ï¼Œç”¨äºæµé‡æ§åˆ¶ï¼‰ã€‚\nç„¶åæœåŠ¡ç«¯å›å¤äº†ä¸€ä¸ªSYN + ACKæŠ¥æ–‡ï¼Œåˆå§‹åºå·seq &#x3D; 0ï¼Œack &#x3D; 1ï¼ˆåœ¨å‰ä¸€ä¸ªåŒ…çš„seqåŸºç¡€ä¸ŠåŠ 1ï¼‰ï¼ŒåŒæ—¶ä¹Ÿè®¾ç½®è‡ªå·±çš„çª—å£rwnd &#x3D; 4128ã€‚\nç„¶åå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„SYN + ACKæŠ¥æ–‡æ—¶ï¼Œå›å¤äº†ä¸€ä¸ªACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºç¡®è®¤å»ºç«‹tcpè¿æ¥ï¼Œåºå·ä¸ºseq &#x3D; 1ï¼Œ **ack &#x3D; 1**ï¼ˆåœ¨å‰ä¸€ä¸ªåŒ…çš„seqåŸºç¡€ä¸ŠåŠ 1ï¼‰*ï¼Œ è®¾ç½®çª—å£rwnd &#x3D; 4128*ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å·²ç»å»ºç«‹tcpè¿æ¥ã€‚\nconnectå‡½æ•°å‰é¢æˆ‘ä»¬åœ¨ä»‹ç»tcpä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™è¯´è¿‡ï¼Œå®¢æˆ·ç«¯åœ¨è·ŸæœåŠ¡ç«¯å»ºç«‹tcpè¿æ¥æ—¶ï¼Œé€šå¸¸æ˜¯ç”±å®¢æˆ·ç«¯ä¸»åŠ¨å‘ç›®æ ‡æœåŠ¡ç«¯å‘èµ·tcpè¿æ¥å»ºç«‹è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¢«åŠ¨æ¥å—tcpè¿æ¥è¯·æ±‚ï¼›åŒæ—¶æœåŠ¡ç«¯ä¹Ÿä¼šå‘èµ·tcpè¿æ¥å»ºç«‹è¯·æ±‚ï¼Œè¡¨ç¤ºæœåŠ¡ç«¯å¸Œæœ›å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œç„¶åå®¢æˆ·ç«¯ä¼šæ¥å—è¿æ¥å¹¶å‘é€ä¸€ä¸ªç¡®è®¤ï¼Œè¿™æ ·åŒæ–¹å°±å·²ç»å»ºç«‹å¥½è¿æ¥ï¼Œå¯ä»¥å¼€å§‹é€šä¿¡ã€‚\nè¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼šå¯èƒ½æœ‰çš„å°ä¼™ä¼´ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼Œä¸ºå•¥æœåŠ¡ç«¯ä¹Ÿè¦è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥å‘¢ï¼Ÿå…¶å®è¿™è·Ÿtcpé‡‡ç”¨å…¨åŒå·¥é€šä¿¡çš„æ–¹å¼æœ‰å…³ã€‚å¯¹äºå…¨åŒå·¥é€šä¿¡ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸¤ç«¯å¯ä»¥åŒæ—¶æ”¶å‘æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\næˆ‘ä»¬å†å›åˆ°æ­£é¢˜ï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œè‚¯å®šä¹Ÿæœ‰å¯¹åº”çš„å‡½æ•°åšåˆ°è·Ÿä¸Šé¢ä¸€æ ·çš„äº‹æƒ…ï¼Œæ²¡é”™ï¼Œå°±æ˜¯connectï¼ˆè¿æ¥ï¼‰ã€‚é¡¾åæ€ä¹‰ï¼Œconnectå‡½æ•°å°±æ˜¯ç”¨äºå®¢æˆ·ç«¯ç¨‹åºå’ŒæœåŠ¡ç«¯ç¨‹åºå»ºç«‹tcpè¿æ¥çš„ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨connectå‡½æ•°è·ŸæœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œè‚¯å®šè¦æŒ‡å®šä¸€ä¸ªipåœ°å€å’Œç«¯å£å·ï¼ˆç›¸å½“äºå®¢æˆ·ç«¯çš„èº«ä»½æ ‡è¯†ï¼‰ï¼Œè¦ä¸ç„¶æœåŠ¡ç«¯éƒ½ä¸çŸ¥é“ä½ æ˜¯è°ï¼Ÿå‡­ä»€ä¹ˆè·Ÿä½ å»ºç«‹è¿æ¥ã€‚åŒæ—¶è¿˜å¾—æŒ‡æ˜æœåŠ¡ç«¯çš„ipåœ°å€å’Œç«¯å£å·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¦è·Ÿè°å»ºç«‹è¿æ¥ã€‚\nconnectå‡½æ•°åŸå‹ï¼š\n1int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen);\n\nå‚æ•°è¯´æ˜ï¼šsockfdï¼šå®¢æˆ·ç«¯çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦addrï¼šè¦è¿æ¥çš„å¥—æ¥å­—åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ªä¼ å…¥å‚æ•°ï¼ŒæŒ‡å®šäº†è¦è¿æ¥çš„å¥—æ¥å­—åœ°å€ä¿¡æ¯ï¼ˆä¾‹å¦‚IPåœ°å€å’Œç«¯å£å·ï¼‰addrlenï¼šæ˜¯ä¸€ä¸ªä¼ å…¥å‚æ•°ï¼Œå‚æ•°addrçš„å¤§å°ï¼Œå³sizeof(addr)\nè¿”å›å€¼è¯´æ˜ï¼šè¿æ¥å»ºç«‹æˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1å¹¶è®¾ç½®errno\nconnectå‡½æ•°åœ¨å»ºç«‹tcpè¿æ¥çš„è¿‡ç¨‹ä¸­ç”¨åˆ°äº†ä¸€ä¸ªéå¸¸é‡è¦çš„é˜Ÿåˆ—ï¼Œé‚£å°±æ˜¯æœªå†³è¿æ¥é˜Ÿåˆ—ï¼Œè¿™ä¸ªé˜Ÿåˆ—ç”¨æ¥ç®¡ç†tcpçš„è¿æ¥ï¼ŒåŒ…æ‹¬å·²å®Œæˆä¸‰æ¬¡æ¡æ‰‹çš„tcpè¿æ¥å’Œæœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹çš„tcpè¿æ¥ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹æœªå†³è¿æ¥é˜Ÿåˆ—ã€‚\næœªå†³è¿æ¥é˜Ÿåˆ—æœªå†³è¿æ¥é˜Ÿåˆ—æ˜¯æŒ‡æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œä½†æ˜¯å°šæœªè¢«å¤„ç†ï¼ˆä¹Ÿå°±æ˜¯æœªè¢«acceptï¼Œåé¢ä¼šè¯´ï¼‰çš„è¿æ¥ï¼Œå¯ä»¥ç†è§£ä¸ºæœªå†³è¿æ¥é˜Ÿåˆ—æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè¿™ä¸ªå®¹å™¨å­˜å‚¨ç€è¿™äº›å°šæœªè¢«å¤„ç†çš„é“¾æ¥ã€‚\nå½“ä¸€ä¸ªå®¢æˆ·ç«¯è¿›ç¨‹ä½¿ç”¨ connect å‡½æ•°å‘èµ·è¯·æ±‚åï¼ŒæœåŠ¡å™¨è¿›ç¨‹å°±ä¼šæ”¶åˆ°è¿æ¥è¯·æ±‚ï¼Œç„¶åæ£€æŸ¥æœªå†³è¿æ¥é˜Ÿåˆ—æ˜¯å¦æœ‰ç©ºä½ï¼Œå¦‚æœæœªå†³é˜Ÿåˆ—æ»¡äº†ï¼Œå°±ä¼šæ‹’ç»è¿æ¥ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯è°ƒç”¨çš„connect å‡½æ•°è¿”å›å¤±è´¥ã€‚\nå¦‚æœæœªå†³è¿æ¥é˜Ÿåˆ—æœ‰ç©ºä½ï¼Œå°±å°†è¯¥è¿æ¥åŠ å…¥æœªå†³è¿æ¥é˜Ÿåˆ—ã€‚å½“ connect å‡½æ•°æˆåŠŸè¿”å›åï¼Œè¡¨æ˜tcpçš„â€œä¸‰æ¬¡æ¡æ‰‹â€è¿æ¥å·²å®Œæˆï¼Œæ­¤æ—¶acceptå‡½æ•°è·å–åˆ°ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥å¹¶è¿”å›ã€‚\n\nåœ¨ä¸Šå›¾ä¸­ï¼Œåœ¨æœªå†³è¿æ¥é˜Ÿåˆ—ä¸­åˆåˆ†ä¸º2ä¸ªé˜Ÿåˆ—ï¼š\næœªå®Œæˆé˜Ÿåˆ—ï¼ˆæœªå†³é˜Ÿåˆ—ï¼‰ï¼šå³å®¢æˆ·ç«¯å·²ç»å‘å‡ºSYNæŠ¥æ–‡å¹¶åˆ°è¾¾æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨tcpä¸‰æ¬¡æ¡æ‰‹è¿æ¥å®Œæˆä¹‹å‰ï¼Œè¿™äº›å¥—æ¥å­—å¤„äºSYN_RCVDçŠ¶æ€ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™äº›å¥—æ¥å­—åŠ å…¥åˆ°æœªå®Œæˆé˜Ÿåˆ—ã€‚\nå·²å®Œæˆé˜Ÿåˆ—ï¼šå³åˆšåˆšå®Œæˆtcpä¸‰æ¬¡æ¡æ‰‹çš„tcpè¿æ¥ï¼Œè¿™äº›å¥—æ¥å­—å¤„äºESTABLISHEDçŠ¶æ€ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™äº›å¥—æ¥å­—åŠ å…¥åˆ°å·²å®Œæˆé˜Ÿåˆ—ã€‚\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿æ¥å»ºç«‹çš„å…·ä½“è¿‡ç¨‹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n\næœåŠ¡ç«¯é¦–å…ˆè°ƒç”¨listenå‡½æ•°ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åè°ƒç”¨acceptå‡½æ•°é˜»å¡ç­‰å¾…å–å‡ºæœªå†³è¿æ¥é˜Ÿåˆ—ä¸­çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œå¦‚æœæœªå†³è¿æ¥é˜Ÿåˆ—ä¸€ç›´ä¸ºç©ºï¼Œè¿™æ„å‘³ç€æ²¡æœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œé‚£ä¹ˆacceptå°±ä¼šä¸€ç›´é˜»å¡ã€‚\nå½“å®¢æˆ·ç«¯ä¸€è°ƒç”¨connectå‡½æ•°å‘èµ·è¿æ¥æ—¶ï¼Œå¦‚æœå®Œæˆtcpä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆacceptå‡½æ•°ä¼šå–å‡ºä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼ˆæ³¨æ„ï¼šæ˜¯å·²ç»å»ºç«‹å¥½çš„è¿æ¥ï¼‰ç„¶åç«‹å³è¿”å›ã€‚\nä¸Šé¢å°±æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ¨ç½‘ç»œä¸­çš„çŠ¶æ€å˜è¿çš„å…·ä½“è¿‡ç¨‹ï¼Œå‰é¢æˆ‘ä»¬åœ¨å­¦ä¹ tcpä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ä¸­è¿˜çŸ¥é“ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™ä¼šè®¾ç½®è‡ªå·±çš„ä¸€ä¸ªæ¥æ”¶ç¼“å†²åŒºçª—å£rwndçš„å¤§å°ã€‚\næœåŠ¡ç«¯åœ¨å‘é€SYN + ACKæ•°æ®æŠ¥æ–‡æ—¶ä¼šè®¾ç½®å¹¶å‘ŠçŸ¥å¯¹æ–¹è‡ªå·±çš„æ¥æ”¶ç¼“å†²åŒºçª—å£å¤§å°ï¼Œå®¢æˆ·ç«¯åœ¨å‘é€ACKæ•°æ®æŠ¥æ–‡æ—¶ä¹Ÿä¼šè®¾ç½®å¹¶å‘ŠçŸ¥å¯¹æ–¹è‡ªå·±çš„æ¥æ”¶ç¼“å†²åŒºçª—å£å¤§å°ã€‚\næ³¨æ„ï¼Œacceptå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå·²ç»å®Œæˆtcpä¸‰æ¬¡æ¡æ‰‹çš„å®¢æˆ·ç«¯è¿æ¥ã€‚å¦‚æœåœ¨ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ä¸­(æœ€åä¸€æ­¥)ï¼ŒæœåŠ¡ç«¯æ²¡æœ‰æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ACKï¼Œåˆ™è¯´æ˜ä¸‰æ¬¡æ¡æ‰‹è¿˜æ²¡æœ‰å»ºç«‹å®Œæˆï¼Œacceptå‡½æ•°ä¾ç„¶ä¼šé˜»å¡ã€‚\nå…³äºtcpä¸‰æ¬¡æ¡æ‰‹è¿æ¥å»ºç«‹çš„å‡ ç§çŠ¶æ€ï¼šSYN_SENTï¼ŒSYN_RCVDï¼ŒESTABLISHEDã€‚SYN_SENTï¼šå½“å®¢æˆ·ç«¯è°ƒç”¨connectå‡½æ•°å‘æœåŠ¡ç«¯å‘é€SYNåŒ…æ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šè¿›å…¥ SYN_SENTçŠ¶æ€ï¼Œå¹¶ä¸”è¿˜ä¼šç­‰å¾…æœåŠ¡å™¨å‘é€ç¬¬äºŒä¸ªSYN + ACKåŒ…ï¼Œå› æ­¤SYN_SENTçŠ¶æ€å°±æ˜¯è¡¨ç¤ºå®¢æˆ·ç«¯å·²ç»å‘é€SYNåŒ…ã€‚\nSYN_RCVDï¼šå½“æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„SYNåŒ…å¹¶ç¡®è®¤æ—¶ï¼ŒæœåŠ¡ç«¯å°±ä¼šè¿›å…¥ SYN_RCVDçŠ¶æ€ï¼Œè¿™æ˜¯tcpä¸‰æ¬¡æ¡æ‰‹å»ºç«‹çš„ä¸€ä¸ªå¾ˆçŸ­æš‚çš„ä¸­é—´çŠ¶æ€ï¼Œä¸€èˆ¬å¾ˆéš¾çœ‹åˆ°ï¼Œ SYN_RCVDçŠ¶æ€è¡¨ç¤ºæœåŠ¡ç«¯å·²ç»ç¡®è®¤æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„SYNåŒ…ã€‚\nESTABLISHEDï¼šè¯¥çŠ¶æ€è¡¨ç¤ºtcpä¸‰æ¬¡æ¡æ‰‹è¿æ¥å»ºç«‹å®Œæˆã€‚\nå¯¹äºè¿™ä¸¤ä¸ªé˜Ÿåˆ—éœ€è¦æ³¨æ„å‡ ç‚¹æ³¨æ„ï¼š\n1. æœªå®Œæˆé˜Ÿåˆ—å’Œå·²å®Œæˆé˜Ÿåˆ—çš„æ€»å’Œä¸è¶…è¿‡listenå‡½æ•°çš„backlogå‚æ•°çš„å¤§å°ã€‚listenå‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š\n1int listen(int sockfd, int backlog);\n\n2. ä¸€æ—¦è¯¥è¿æ¥çš„tcpä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œå°±ä¼šä»æœªå®Œæˆé˜Ÿåˆ—åŠ å…¥åˆ°å·²å®Œæˆé˜Ÿåˆ—ä¸­\n3. å¦‚æœæœªå†³è¿æ¥é˜Ÿåˆ—å·²æ»¡ï¼Œå½“åˆæ¥æ”¶åˆ°ä¸€ä¸ªå®¢æˆ·ç«¯SYNæ—¶ï¼ŒæœåŠ¡ç«¯çš„tcpå°†ä¼šå¿½ç•¥è¯¥SYNï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šç†å®¢æˆ·ç«¯çš„SYNï¼Œä½†æ˜¯æœåŠ¡ç«¯å¹¶ä¸ä¼šå‘é€RSTæŠ¥æ–‡ï¼ŒåŸå› æ˜¯ï¼šå®¢æˆ·ç«¯tcpå¯ä»¥é‡ä¼ SYNï¼Œå¹¶æœŸæœ›åœ¨è¶…æ—¶å‰æœªå†³è¿æ¥é˜Ÿåˆ—æ‰¾åˆ°ç©ºä½ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œè¿™å½“ç„¶æ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çœ‹åˆ°çš„ã€‚å¦‚æœæœåŠ¡ç«¯ç›´æ¥å‘é€ä¸€ä¸ªRSTçš„è¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„connectå‡½æ•°å°†ä¼šç«‹å³è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œè€Œä¸ä¼šè®©tcpæœ‰æœºä¼šé‡ä¼ SYNï¼Œæ˜¾ç„¶æˆ‘ä»¬ä¹Ÿå¹¶ä¸å¸Œæœ›è¿™æ ·åšã€‚\nä½†æ˜¯ä¸æ’é™¤æœ‰äº›linuxå®ç°åœ¨æœªå†³è¿æ¥é˜Ÿåˆ—æ»¡æ—¶ï¼Œçš„ç¡®ä¼šå‘é€RSTã€‚ä½†æ˜¯è¿™ç§åšæ³•æ˜¯ä¸æ­£ç¡®çš„ï¼Œå› æ­¤æˆ‘ä»¬æœ€å¥½å¿½ç•¥è¿™ç§æƒ…å†µï¼Œå¤„ç†è¿™ç§é¢å¤–æƒ…å†µçš„ä»£ç ä¹Ÿä¼šé™ä½å®¢æˆ·ç«¯ç¨‹åºçš„å¥å£®æ€§ã€‚\nconnectå‡½æ•°å‡ºé”™æƒ…å†µç”±äºconnectå‡½æ•°æ˜¯åœ¨å»ºç«‹tcpè¿æ¥æˆåŠŸæˆ–å¤±è´¥æ‰è¿”å›ï¼Œè¿”å›æˆåŠŸçš„æƒ…å†µæœ¬æ–‡ä¸Šé¢å·²ç»ä»‹ç»è¿‡äº†ã€‚è¿™é‡Œæˆ‘ä»¬ä»‹ç»connectå‡½æ•°è¿”å›å¤±è´¥çš„å‡ ç§æƒ…å†µï¼šç¬¬ä¸€ç§å½“å®¢æˆ·ç«¯å‘é€äº†SYNæŠ¥æ–‡åï¼Œæ²¡æœ‰æ”¶åˆ°ç¡®è®¤åˆ™è¿”å›ETIMEDOUTé”™è¯¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¤±è´¥ä¸€æ¬¡å¹¶ä¸ä¼šé©¬ä¸Šè¿”å›ETIMEDOUTé”™è¯¯ã€‚å³å½“ä½ è°ƒç”¨äº†connectå‡½æ•°ï¼Œå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œæ²¡æœ‰æ”¶åˆ°ç¡®è®¤å°±ç­‰6såå†å‘ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œè¿˜æ²¡æœ‰æ”¶åˆ°å°±ç­‰24så†å‘ä¸€ä¸ªï¼ˆä¸åŒçš„linuxç³»ç»Ÿè®¾ç½®çš„æ—¶é—´å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œè¿™é‡Œä»¥BSDç³»ç»Ÿä¸ºä¸»ï¼‰ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ç´¯åŠ çš„ï¼Œå¦‚æœæ€»å…±ç­‰äº†75såè¿˜æ˜¯æ²¡æ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°†è¿”å›ETIMEDOUTé”™è¯¯ã€‚\nå¯¹äºlinuxç³»ç»Ÿï¼Œæ”¹å˜è¿™ä¸ªç³»ç»Ÿä¸Šé™å€¼ä¹Ÿæ¯”è¾ƒå®¹æ˜“ï¼Œç”±äºéœ€è¦æ”¹å˜ç³»ç»Ÿé…ç½®å‚æ•°ï¼Œä½ éœ€è¦rootæƒé™ã€‚ç›¸å…³çš„å‘½ä»¤æ˜¯sysctl net.ipv4.tcp_syn_retries(é’ˆå¯¹äºipv4)ã€‚åœ¨è®¾ç½®è¯¥å€¼æ—¶è¿˜æ˜¯è¦æ¯”è¾ƒä¿å®ˆçš„ï¼Œå› ä¸ºæ¯æ¬¡synåŒ…é‡è¯•çš„é—´éš”éƒ½ä¼šå¢å¤§(æ¯”å¦‚BSDç±»çš„ç³»ç»Ÿå®ç°ä¸­é—´éš”ä¼šä»¥2åˆ°3å€å¢åŠ )ï¼Œæ‰€æœ‰tcp_syn_retriesçš„ä¸€ä¸ªå¾®å°å˜åŒ–å¯¹connectè¶…æ—¶æ—¶é—´çš„å½±å“éƒ½éå¸¸å¤§ï¼Œä¸è¿‡æ‰©å¤§è¿™ä¸ªå€¼ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆåå¤„ï¼Œå› ä¸ºä½ ä»£ç ä¸­è®¾ç½®çš„è¶…æ—¶å€¼éƒ½èƒ½å¤Ÿç”Ÿæ•ˆã€‚ä½†æ˜¯å¦‚æœä»£ç ä¸­æ²¡æœ‰è®¾ç½®connectçš„è¶…æ—¶å€¼ï¼Œé‚£ä¹ˆconnectå°±ä¼šé˜»å¡å¾ˆä¹…ï¼Œä½ å‘ç°å¯¹ç«¯æœºå™¨downæ‰çš„é—´éš”å°±æ›´é•¿ã€‚ä½œè€…å»ºè®®è®¾ç½®è¿™ä¸ªå€¼åˆ°6æˆ–è€…7ï¼Œæœ€å¤š8ã€‚6å¯¹åº”çš„connectè¶…æ—¶ä¸º45sï¼Œ7å¯¹åº”90sï¼Œ8å¯¹åº”190sã€‚\nä½ èƒ½é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹è¯¥å€¼:\n1sysctl -w net.ipv4.tcp_syn_retries=6\n\næŸ¥çœ‹è¯¥å€¼çš„å‘½ä»¤æ˜¯:\n1sysctl net.ipv4.tcp_syn_retries\n\nå¦‚æœå¸Œæœ›é‡å¯åç”Ÿæ•ˆï¼Œå°†net.ipv4.tcp_syn_retries &#x3D; 6æ”¾å…¥**&#x2F;etc&#x2F;sysctl.conf**ä¸­ã€‚\nè¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯å‘ç”Ÿåœ¨æœåŠ¡ç«¯çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å½“å‰æ‰€å¤„ç½‘ç»œç¯å¢ƒæµé‡è´Ÿè½½è¿‡é«˜ï¼Œç½‘ç»œæ‹¥å¡äº†ï¼Œç„¶åæœåŠ¡ç«¯æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„SYNæŠ¥æ–‡å´æ¥ä¸åŠå“åº”ï¼Œæˆ–è€…å‘é€çš„å“åº”æŠ¥æ–‡åœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­è€æ˜¯ä¸¢å¤±ï¼Œå¯¼è‡´å®¢æˆ·ç«¯è¿Ÿè¿Ÿæ”¶ä¸åˆ°ç¡®è®¤ï¼Œæœ€åè¿”å›ETIMEDOUTé”™è¯¯ã€‚\næˆ‘ä»¬å¯ä»¥ç®€å•å¤ç°ä¸€ä¸‹è¿™ç§æƒ…å†µï¼Œè¿™ä¸ªå®éªŒæ˜¯åŸºäºCentOSç³»ç»Ÿè¿›è¡Œçš„ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\né¦–å…ˆé€šè¿‡iptables -FæŠŠCentosä¸Šçš„é˜²ç«å¢™è§„åˆ™æ¸…ç†æ‰ï¼Œç„¶åå†é€šè¿‡iptables -I INPUT -p tcp â€“syn -i lo -j DROPå‘½ä»¤æŠŠæœ¬åœ°çš„æ‰€æœ‰SYNåŒ…éƒ½è¿‡æ»¤æ‰ï¼ˆæ¨¡æ‹ŸæœåŠ¡ç«¯å½“å‰ç½‘ç»œä¸ç¨³å®šï¼‰ã€‚\n\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n121iptables -F2iptables -I INPUT -p tcp --syn -i lo -j DROP\n\n\nç„¶åé€šè¿‡ncå‘½ä»¤å‘æœ¬åœ°çš„ç¯å›åœ°å€127.0.0.1å‘èµ·tcpè¿æ¥è¯·æ±‚ï¼ˆç›¸å½“äºè‡ªå·±è·Ÿè‡ªå·±å‘èµ·tcpè¿æ¥ï¼‰ï¼Œæ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯è·ŸæœåŠ¡ç«¯å‘èµ·tcpè¿æ¥ï¼Œä½†æ˜¯æœåŠ¡å™¨ç«¯å°±æ˜¯ä¸å“åº”ï¼Œæœ€åå¯¼è‡´å®¢æˆ·ç«¯çš„tcpè¿æ¥å»ºç«‹è¯·æ±‚è¶…æ—¶ï¼Œå¹¶ç»ˆæ­¢tcpè¿æ¥ã€‚\n \n\nç„¶åå†é€šè¿‡tcpdumpå·¥å…·æŠŠå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹tcpè¿æ¥è¿‡ç¨‹ä¸­çš„æ•°æ®æŠ¥éƒ½æŠ“å–ä¸‹æ¥ï¼Œç”±äºæˆ‘ä»¬è®¾ç½®çš„æœåŠ¡å™¨ä¾¦å¬ç«¯å£å·æ˜¯10086ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡tcpdump -i any port 10086å‘½ä»¤æ¥è¿‡æ»¤æ‰€æœ‰ç½‘å¡çš„10086ç«¯å£çš„æ•°æ®åŒ…ã€‚\n \n å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œlocalhost.39299ä»£è¡¨å®¢æˆ·ç«¯ï¼Œlocalhost.10086ä»£è¡¨æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯æ€»å…±å‘æœåŠ¡ç«¯å‘é€äº†6ä¸ªSYNæŠ¥æ–‡ï¼Œè¿™6ä¸ªSYNåŒ…çš„é—´éš”æ—¶é—´åˆ†åˆ«æ˜¯1sï¼Œ2sï¼Œ4sï¼Œ8sï¼Œ16sï¼Œè¿™äº›æ—¶é—´ç´¯ç§¯åŠ èµ·æ¥æ€»å…±ä¸º31sï¼Œå…¶å®å®¢æˆ·ç«¯åœ¨å‘é€æœ€åä¸€ä¸ªSYNæŠ¥æ–‡æ—¶è¿˜ç­‰å¾…äº†ä¸€æ®µæ—¶é—´ï¼Œç„¶åæ‰è¶…æ—¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯åœ¨å‘é€äº†ç¬¬ä¸€ä¸ªSYNæŠ¥æ–‡æ—¶ï¼Œä¼šè®¾ç½®äº†ä¸€ä¸ªè®¡æ—¶å™¨å¹¶å¼€å§‹è®¡æ—¶ï¼Œåœ¨æœ€åä¸€ä¸ªSYNæŠ¥æ–‡è¿˜æ²¡æ”¶åˆ°æœåŠ¡ç«¯çš„ç¡®è®¤æ—¶ï¼Œè¿™ä¸ªè®¡æ—¶å™¨å°±ä¼šè¶…æ—¶ï¼Œç„¶åå…³é—­tcpè¿æ¥ã€‚\n\n\nç¬¬äºŒç§å®¢æˆ·ç«¯è¿æ¥ä¸€ä¸ªæœåŠ¡å™¨æ²¡æœ‰ä¾¦å¬çš„ç«¯å£ã€‚\nè¿‡ç¨‹æ˜¯ï¼šå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªSYNæŠ¥æ–‡åï¼Œç„¶åæœåŠ¡ç«¯å›å¤äº†ä¸€ä¸ªRSTæŠ¥æ–‡ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸çš„tcpè¿æ¥ï¼ŒæœåŠ¡ç«¯å‘é€äº†RSTæŠ¥æ–‡é‡ç½®è¿™ä¸ªå¼‚å¸¸çš„tcpè¿æ¥ã€‚\nè¿™ç§æƒ…å†µä¸€èˆ¬ä¸ºæ‹’ç»è¿æ¥è¯·æ±‚ï¼Œæ¯”å¦‚ï¼šå®¢æˆ·ç«¯æƒ³å’ŒæœåŠ¡ç«¯å»ºç«‹tcpè¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ä¸­ä½¿ç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨æˆ–æ²¡æœ‰ä¾¦å¬çš„ç«¯å£ï¼ˆæ¯”å¦‚ï¼šè¿™ä¸ªç«¯å£è¶…å‡º65535çš„èŒƒå›´ï¼‰ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å°±å¯ä»¥å‘é€RSTæŠ¥æ–‡æ®µæ‹’ç»è¿™ä¸ªè¯·æ±‚ã€‚\n\næ‹’ç»è¿æ¥ä¸€èˆ¬æ˜¯ç”±æœåŠ¡å™¨ä¸»åŠ¨å‘èµ·çš„ï¼Œå› ä¸ºå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚è¿æ¥æºå¸¦çš„ç›®çš„ç«¯å£ï¼Œå¯èƒ½æœåŠ¡å™¨å¹¶æ²¡æœ‰å¼€å¯LISTENçŠ¶æ€ã€‚å› æ­¤æœåŠ¡å™¨åœ¨æ”¶åˆ°è¿™æ ·çš„æŠ¥æ–‡æ®µåä¼šå‘é€ä¸€ä¸ªRSTæŠ¥æ–‡æ®µï¼Œåœ¨è¿™ä¸ªæŠ¥æ–‡é‡ŒæŠŠRSTå’ŒACKéƒ½ç½®ä¸º1ï¼Œå®ƒç¡®è®¤äº†SYNæŠ¥æ–‡æ®µå¹¶åŒæ—¶é‡ç½®äº†è¯¥tcpè¿æ¥ï¼Œç„¶åæœåŠ¡å™¨ç­‰å¾…å¦ä¸€ä¸ªè¿æ¥ã€‚å®¢æˆ·ç«¯åœ¨æ”¶åˆ°RST+ACKæŠ¥æ–‡æ®µåå°±ä¼šè¿›å…¥CLOSEDçŠ¶æ€ã€‚\nè¿™é‡Œä»¥é€šè¿‡20000ä¸å­˜åœ¨çš„ç«¯å£è¿œç¨‹ç™»å½•ä¸ºä¾‹ï¼š\n\ntcpdumpæŠ“å–åˆ°çš„æ•°æ®åŒ…å¦‚ä¸‹ï¼š\n1234113:35:08.609549 IP 192.168.98.137.49057 &gt; 192.168.0.102.dnp: Flags [S], seq 2919679902, win 14600, options [mss 1460,sackOK,TS val 39134059 ecr 0,nop,wscale 6], length 0213:35:09.610018 IP 192.168.98.137.49057 &gt; 192.168.0.102.dnp: Flags [S], seq 2919679902, win 14600, options [mss 1460,sackOK,TS val 39135059 ecr 0,nop,wscale 6], length 0313:35:09.610115 IP 192.168.0.102.dnp &gt; 192.168.98.137.49057: Flags [R.], seq 1766537774, ack 2919679903, win 64240, length 0413:35:10.610188 IP 192.168.0.102.dnp &gt; 192.168.98.137.49057: Flags [R.], seq 3482791532, ack 1, win 64240, length 0\n\né€šè¿‡åˆ†ætcpdumpå·¥å…·æŠ“å–çš„æ•°æ®å‘ç°ï¼ŒRSTæŠ¥æ–‡æ®µä¸æºå¸¦æ•°æ®ã€‚\nç¬¬ä¸‰ç§å¦‚æœå®¢æˆ·ç«¯è°ƒç”¨connectå‡½æ•°å‘æœåŠ¡ç«¯å‘é€äº†ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œè¿™ä¸ªSYNæŠ¥æ–‡åœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­ç»è¿‡æŸä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ­£å¥½è¿™ä¸ªè·¯ç”±å™¨å‡ºé—®é¢˜äº†ï¼Œç¼ºå°‘åˆ°è¾¾ç›®çš„åœ°çš„è·¯ç”±ï¼Œä¸èƒ½æŠŠè¿™ä¸ªSYNæŠ¥æ–‡è½¬å‘ç»™ç›®çš„åœ°å€ï¼Œé‚£ä¹ˆè¯¥è·¯ç”±å™¨ä¼šä¸¢å¼ƒè¿™ä¸ªSYNæŠ¥æ–‡ï¼Œå¹¶åŒæ—¶ç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªDestination unreachableï¼ˆä¸»æœºä¸å¯è¾¾ï¼‰çš„ICMPå·®é”™æŠ¥æ–‡ã€‚å®¢æˆ·ç«¯çš„linuxå†…æ ¸ä¼šä¿å­˜è¿™ä¸ªDestination unreachableçš„ICMPå·®é”™æŠ¥æ–‡ï¼ŒåŒæ—¶æŒ‰ç¬¬ä¸€ç§æƒ…å†µç»§ç»­å‘é€SYNæŠ¥æ–‡ï¼Œå¦‚æœåœ¨è§„å®šçš„æ—¶é—´è¶…æ—¶åè¿˜æ²¡æ”¶åˆ°æœåŠ¡ç«¯çš„å“åº”æŠ¥æ–‡ï¼Œé‚£ä¹ˆlinuxå†…æ ¸ä¼šæŠŠä¿å­˜çš„ICMPå·®é”™æŠ¥æ–‡ä½œä¸ºEHOSTUNREACHæˆ–ENETUNREACHé”™è¯¯è¿”å›ç»™å®¢æˆ·ç«¯çš„åº”ç”¨è¿›ç¨‹ã€‚\nä¸‹é¢çš„è¿™ä¸ªå®éªŒå°±æ˜¯ç”¨æ¥è¯´æ˜ç¬¬ä¸‰ç§æƒ…å†µï¼Œå¸®åŠ©ç†è§£ï¼Œå¤§å®¶èƒ½çœ‹æ˜ç™½å°±è¡Œäº†ï¼Œå¯ä»¥ä¸ç”¨å»åšè¿™ä¸ªå®éªŒï¼Œå½“ç„¶ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å»æ¨¡æ‹Ÿä¸€ä¸‹ã€‚\n\nç„¶åclientè¿œç¨‹ç™»å½•serveræˆåŠŸã€‚\n\nä¸Šå›¾ä¸­æ²¡æœ‰æŒ‡å®štelnetç«¯å£å·ï¼Œä½¿ç”¨é»˜è®¤ç«¯å£å·23ã€‚\nè¿™æ˜¯æŠ“å–åˆ°çš„æ•°æ®åŒ…ï¼Œclientåœ¨è¿œç¨‹ç™»å½•serveræ—¶ï¼Œå‘èµ·äº†SYNè¿æ¥è¯·æ±‚ã€‚\n\nç°åœ¨æˆ‘ä»¬æ¥æ¨¡æ‹Ÿclientè®¾å¤‡å‡ºæ•…éšœï¼Œåˆ é™¤R1è®¾å¤‡åˆ°serverçš„è·¯ç”±ä¿¡æ¯\n1no ip route 12.1.3.0 255.255.255.0 12.1.2.2\n\nclientå†ç™»å½•serveræ—¶å°±ä¼šå¤±è´¥ï¼Œæˆ‘ä»¬ä»æŠ“å–åˆ°çš„æ•°æ®åŒ…å¯ä»¥å‘ç°ï¼Œclientå‘é€äº†ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œç„¶åR1è®¾å¤‡æ”¶åˆ°è¿™ä¸ªSYNæŠ¥æ–‡æ—¶ï¼Œå‘ç°è‡ªå·±ä¸èƒ½åˆ°è¾¾serverï¼Œäºæ˜¯ä¼šæŠŠè¿™ä¸ªSYNæŠ¥æ–‡ä¸¢å¼ƒæ‰ï¼Œå¹¶å‘clientå‘é€äº†ä¸€ä¸ªç›®æ ‡ä¸»æœºä¸å¯è¾¾çš„ICMPå·®é”™æŠ¥æ–‡ï¼Œäºæ˜¯clientå‘é€äº†RSTæŠ¥æ–‡æ¥å…³é—­è¿™æ¡å¼‚å¸¸çš„tcpè¿æ¥ã€‚\n\nå­¦ä¹ çŸ¥è¯†ä¸ä»…è¦çŸ¥å…¶ç„¶ä¹Ÿè¦çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œè¿™æ˜¯æˆ‘æƒ³é€šè¿‡è¿™ç¯‡æ–‡ç« ä¼ è¾¾çš„ä¸€ä¸ªç†å¿µï¼Œæ–‡ä¸­ä¸€æ­¥æ­¥çš„å®éªŒæ¢ç´¢ä½“ç°äº†å­¦ä¹ çŸ¥è¯†åŠ¨æ‰‹å®è·µçš„é‡è¦æ€§ï¼Œè¿™æ˜¯éå¸¸å€¼å¾—æå€¡çš„ã€‚\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/ä»æŠ“åŒ…çš„è§’åº¦åˆ†æconnectå‡½æ•°çš„è¿æ¥è¿‡ç¨‹","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"a6f27f59fbfda9509fed1c4003d071f5","title":"ã€è½¬è½½ã€‘åšJavaæˆ–è€…C++å¼€å‘éƒ½åº”è¯¥çŸ¥é“çš„lsofå‘½ä»¤","content":"åš Java æˆ–è€… C++ å¼€å‘éƒ½åº”è¯¥çŸ¥é“çš„ lsof å‘½ä»¤lsof å‘½ä»¤æ˜¯ Linux ç³»ç»Ÿçš„æ‰©å±•å·¥å…·ï¼Œå®ƒçš„å«ä¹‰æ˜¯ list opened filedesciptor ï¼ˆåˆ—å‡ºå·²ç»æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼‰ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰çš„ä¸èµ„æºå¥æŸ„ç›¸å…³çš„ä¸œè¥¿éƒ½å¯ä»¥ç»Ÿä¸€æŠ½è±¡æˆæ–‡ä»¶æè¿°ç¬¦ï¼ˆfiledescriptorï¼Œç®€ç§° fdï¼‰ã€‚ä¸€ä¸ªæ–‡ä»¶å¥æŸ„æ˜¯ä¸€ä¸ª fdï¼Œä¸€ä¸ª socket å¯¹è±¡ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸º fd ç­‰ç­‰ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œç³»ç»Ÿæ˜¯ä¸å­˜åœ¨è¿™ä¸ªå‘½ä»¤çš„ï¼Œä½ éœ€è¦å®‰è£…ä¸€ä¸‹ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š\n1yum install lsof\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ•ˆæœï¼š\n12345678910111213141516171819202122COMMAND     PID   TID    USER   FD      TYPE             DEVICE  SIZE/OFF       NODE NAMEsystemd       1          root  cwd       DIR              202,1      4096          2 /nscd        453   469    nscd    8u  netlink                          0t0      11017 ROUTEnscd        453   470    nscd  cwd       DIR              202,1      4096          2 /nscd        453   470    nscd  rtd       DIR              202,1      4096          2 /nscd        453   470    nscd  txt       REG              202,1    180272     146455 /usr/sbin/nscdnscd        453   470    nscd  mem       REG              202,1    217032     401548 /var/db/nscd/hostsnscd        453   470    nscd  mem       REG              202,1     90664     132818 /usr/lib64/libz.so.1.2.7nscd        453   470    nscd  mem       REG              202,1     68192     133155 /usr/lib64/libbz2.so.1.0.6nscd        453   470    nscd  mem       REG              202,1    153192     133002 /usr/lib64/liblzma.so.5.0.99nscd        453   470    nscd  mem       REG              202,1     91496     133088 nscd        453   471    nscd    5u  a_inode                0,9         0       4796 [eventpoll]nscd        453   471    nscd    6r      REG              202,1    217032     401548 /var/db/nscd/hostsnscd        453   471    nscd    7u     unix 0xffff880037497440       0t0      11015 /var/run/nscd/socketnscd        453   471    nscd    8u  netlink                          0t0      11017 ROUTEimgserver   611       zhangyl  cwd       DIR              202,1      4096    1059054 /home/zhangyl/flamingoserverimgserver   611       zhangyl  rtd       DIR              202,1      4096          2 /imgserver   611       zhangyl  txt       REG              202,1   4788917    1057044 /home/zhangyl/flamingoserver/imgserverimgserver   611       zhangyl   24u  a_inode                0,9         0       4796 [eventfd]imgserver   611       zhangyl   25u     IPv4           55707643       0t0        TCP *:commtact-http (LISTEN)imgserver   611       zhangyl   26r      CHR                1,3       0t0       4800 /dev/nullimgserver   611   613 zhangyl   32w      REG              202,1    131072    2754609 /home/zhangyl/flamingoserver/imgcache/258bfb8945288a117d98d440986d7a03\n\nç»“æœæ˜¾ç¤ºä¸­åˆ—å‡ºäº†å„ä¸ªè¿›ç¨‹æ‰“å¼€çš„å„ç§ fd ç±»å‹ï¼Œå¯¹äº Uinx Socketï¼Œlsof å‘½ä»¤ä¼šæ˜¾ç¤ºå‡ºå…¶è¯¦ç»†çš„è·¯å¾„ï¼Œæ‰“å¼€çš„æ–‡ä»¶ fd äº¦æ˜¯å¦‚æ­¤ã€‚\nä½¿ç”¨ lsof å‘½ä»¤æœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ï¼š\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œlsof çš„è¾“å‡ºæ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ grep å‘½ä»¤è¿‡æ»¤æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹çš„è¿›ç¨‹æ‰“å¼€çš„ fd ä¿¡æ¯ï¼Œå¦‚ï¼š\n1lsof -i | grep myapp\n\næˆ–è€…ä½¿ç”¨ lsof -p pid ä¹Ÿèƒ½è¿‡æ»¤å‡ºæŒ‡å®šçš„è¿›ç¨‹æ‰“å¼€çš„ fd ä¿¡æ¯ï¼š\n12345678910111213141516171819202122[root@iZ238vnojlyZ ~]# lsof -p 26621COMMAND     PID    USER   FD      TYPE   DEVICE SIZE/OFF    NODE NAMEchatserve 26621 zhangyl  cwd       DIR    202,1     4096 1059054 /home/zhangyl/flamingoserverchatserve 26621 zhangyl  rtd       DIR    202,1     4096       2 /chatserve 26621 zhangyl  txt       REG    202,1  8027035 1051942 /home/zhangyl/flamingoserver/chatserverchatserve 26621 zhangyl  mem       REG    202,1    61928  141417 /usr/lib64/libnss_files-2.17.sochatserve 26621 zhangyl  mem       REG    202,1    44096  143235 /usr/lib64/librt-2.17.sochatserve 26621 zhangyl  mem       REG    202,1    19520  137064 /usr/lib64/libdl-2.17.sochatserve 26621 zhangyl  mem       REG    202,1  2112384  132824 /usr/lib64/libc-2.17.sochatserve 26621 zhangyl  mem       REG    202,1   142304  132850 /usr/lib64/libpthread-2.17.sochatserve 26621 zhangyl  mem       REG    202,1    88720  135291 /usr/lib64/libgcc_s-4.8.5-20150702.so.1chatserve 26621 zhangyl  mem       REG    202,1  1141560  137077 /usr/lib64/libm-2.17.sochatserve 26621 zhangyl  mem       REG    202,1   999944  140059 /usr/lib64/libstdc++.so.6.0.19chatserve 26621 zhangyl  mem       REG    202,1  9879756  269001 /usr/lib64/mysql/libmysqlclient.so.20.3.4chatserve 26621 zhangyl  mem       REG    202,1   164440  133622 /usr/lib64/ld-2.17.sochatserve 26621 zhangyl    0u      CHR      1,3      0t0    4800 /dev/nullchatserve 26621 zhangyl    1u      CHR      1,3      0t0    4800 /dev/nullchatserve 26621 zhangyl    2u      CHR      1,3      0t0    4800 /dev/nullchatserve 26621 zhangyl    3u  a_inode      0,9        0    4796 [eventpoll]chatserve 26621 zhangyl    4u  a_inode      0,9        0    4796 [timerfd]chatserve 26621 zhangyl    5u  a_inode      0,9        0    4796 [eventfd]chatserve 26621 zhangyl    7u  a_inode      0,9        0    4796 [eventpoll]\n\nlsof å‘½ä»¤åªèƒ½æŸ¥çœ‹åˆ°å½“å‰ç”¨æˆ·æœ‰æƒé™æŸ¥çœ‹åˆ°çš„è¿›ç¨‹ fd ä¿¡æ¯ï¼Œå¯¹äºå…¶æ²¡æœ‰æƒé™çš„è¿›ç¨‹ï¼Œæœ€å³è¾¹ä¸€åˆ—ä¼šæ˜¾ç¤º â€œPermission deniedâ€ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š\n12345678sshd      26759          root  cwd   unknown                              /proc/26759/cwd (readlink: Permission denied)sshd      26759          root  rtd   unknown                              /proc/26759/root (readlink: Permission denied)sshd      26759          root  txt   unknown                              /proc/26759/exe (readlink: Permission denied)sshd      26759          root NOFD                                        /proc/26759/fd (opendir: Permission denied)bash      26761          root  cwd   unknown                              /proc/26761/cwd (readlink: Permission denied)bash      26761          root  rtd   unknown                              /proc/26761/root (readlink: Permission denied)bash      26761          root  txt   unknown                              /proc/26761/exe (readlink: Permission denied)bash      26761          root NOFD                                        /proc/26761/fd (opendir: Permission denied)\n\nlsof å‘½ä»¤ç¬¬ä¸€æ è¿›ç¨‹ååœ¨æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé»˜è®¤æ˜¾ç¤ºå‰ n ä¸ªå­—ç¬¦ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬éœ€è¦æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹åä»¥æ–¹ä¾¿è¿‡æ»¤çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ +c é€‰é¡¹ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š\n12#æœ€å·¦ä¾§çš„ç¨‹åºåæœ€å¤§æ˜¾ç¤º 15 ä¸ªå­—ç¬¦[zhangyl@iZ238vnojlyZ ~]$ lsof +c 15\n\nå½“ç„¶ï¼Œå¦‚æœä½ è®¾ç½®å€¼å¤ªå¤§ï¼Œ lsof ä¾¿ä¸ä¼šé‡‡ç”¨ä½ è®¾ç½®çš„æœ€å¤§å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨é»˜è®¤æœ€å¤§å€¼ã€‚\n\n\nä¸Šæ–‡ä¹Ÿä»‹ç»äº†ï¼Œsocket ä¹Ÿæ˜¯ä¸€ç§ fdï¼Œå¦‚æœéœ€è¦ä»…æ˜¾ç¤ºç³»ç»Ÿçš„ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œä½¿ç”¨çš„æ˜¯ -i é€‰é¡¹å³å¯ï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥å½¢è±¡åœ°æ˜¾ç¤ºå‡ºç³»ç»Ÿå½“å‰çš„å‡ºå…¥è¿æ¥æƒ…å†µï¼š\n\nçœ‹åˆ°å›¾ä¸­çš„è¿æ¥æ–¹å‘äº†å§ï¼Ÿ\nå½“ç„¶ï¼Œå’Œ netstat å‘½ä»¤ä¸€æ ·ï¼Œlsof -i é»˜è®¤ä¹Ÿä¼šæ˜¾ç¤º ip åœ°å€å’Œç«¯å£å·çš„åˆ«åï¼Œæˆ‘ä»¬åªè¦ä½¿ç”¨ -n å’Œ -P é€‰é¡¹å°±èƒ½ç›¸å¯¹åº”åœ°æ˜¾ç¤º ip åœ°å€å’Œç«¯å£å·äº†ï¼Œç»¼åˆèµ·æ¥å°±æ˜¯ lsof -Pniï¼š\n\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/åšJavaæˆ–è€…C++å¼€å‘éƒ½åº”è¯¥çŸ¥é“çš„lsofå‘½ä»¤","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"70272bd95bde5e7c3c1990babcaab3a0","title":"ã€è½¬è½½ã€‘åˆ©ç”¨telnetå‘½ä»¤å‘ç”µå­é‚®ä»¶","content":"åˆ©ç”¨ telnet å‘½ä»¤å‘ç”µå­é‚®ä»¶telnet å‘½ä»¤æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ç½‘ç»œè°ƒè¯•å‘½ä»¤ä¹‹ä¸€ã€‚å¦‚æœä½ çš„æœºå™¨ä¸Šè¿˜æ²¡æœ‰å®‰è£… telnet å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ä¸€ä¸‹ï¼š\n1yum install telnet \n\nå¦‚æœä¸€ä¸ªæœåŠ¡ç¨‹åºå¯¹å¤–å¼€å¯äº†ä¾¦å¬æœåŠ¡ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ telnet ip port æ¥è¿æ¥ä¸Šå»ï¼Œä¾‹å¦‚ï¼š\n1234[root@localhost ~]# telnet 120.55.94.78 8888Trying 120.55.94.78...Connected to 120.55.94.78.Escape character is &#x27;^]&#x27;.\n\n\nå¦‚æœä¸æŒ‡å®šç«¯å£å·ï¼Œtelnet ä¼šä½¿ç”¨é»˜è®¤ 23 å·ç«¯å£ã€‚\n\nåè¿‡æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ telnet å‘½ä»¤å»æ£€æµ‹æŒ‡å®š ip åœ°å€å’Œç«¯å£å·çš„ä¾¦å¬æœåŠ¡æ˜¯å¦å­˜åœ¨ã€‚çŸ¥é“è¿™ç‚¹å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå»æ£€æµ‹ä¸€ä¸ªæœåŠ¡æ˜¯å¦å¯ä»¥æ­£å¸¸è¿æ¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æŸæ¬¡ä»æŸå¤„å¾—åˆ°ä¸€ä¸ªä»£ç ä¸‹è½½åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ª svn åœ°å€ï¼šsvn:&#x2F;&#x2F;120.55.94.78&#x2F;mycode&#x2F;mybookã€‚ä¸ºäº†æ£€æµ‹è¿™ä¸ª svn æœåŠ¡æ˜¯å¦è¿˜èƒ½æ­£å¸¸å¯¹å¤–æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ ping å‘½ä»¤å»æ£€æµ‹ä¸€ä¸‹åˆ°è¾¾è¿™ä¸ª ipï¼š120.55.94.78 çš„ç½‘ç»œæ˜¯å¦ç•…é€šï¼š\n1234567891011[root@localhost ~]# ping 120.55.94.78PING 120.55.94.78 (120.55.94.78) 56(84) bytes of data.64 bytes from 120.55.94.78: icmp_seq=1 ttl=128 time=15.3 ms64 bytes from 120.55.94.78: icmp_seq=2 ttl=128 time=14.3 ms64 bytes from 120.55.94.78: icmp_seq=3 ttl=128 time=16.4 ms64 bytes from 120.55.94.78: icmp_seq=4 ttl=128 time=16.1 ms64 bytes from 120.55.94.78: icmp_seq=5 ttl=128 time=15.5 ms^C--- 120.55.94.78 ping statistics ---5 packets transmitted, 5 received, 0% packet loss, time 4007msrtt min/avg/max/mdev = 14.343/15.568/16.443/0.723 ms\n\nå¦‚æœç½‘ç»œç•…é€šï¼Œæˆ‘ä»¬å†ç”¨ telnet å»è¿æ¥ä¸Šå»ï¼Œç”±äº svn æœåŠ¡å™¨ä½¿ç”¨çš„é»˜è®¤ç«¯å£æ˜¯ 3690ï¼Œæˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š\n12345[root@localhost ~]# telnet 120.55.94.78 3690Trying 120.55.94.78...Connected to 120.55.94.78.Escape character is &#x27;^]&#x27;.( success ( 2 2 ( ) ( edit-pipeline svndiff1 absent-entries commit-revprops depth log-revprops atomic-revprops partial-replay ) ) ) \n\nå¦‚ä¸Šæ‰€ç¤ºï¼Œè¯æ˜è¿™ä¸ª svn æœåŠ¡æ˜¯æ­£å¸¸å¼€å¯å¯¹å¤–æœåŠ¡çš„ã€‚åä¹‹ï¼Œå¦‚æœ telnet å‘½ä»¤è¿ä¸ä¸Šï¼Œè¯´æ˜è¿™ä¸ªæœåŠ¡ä¸èƒ½è¢«å¤–éƒ¨ç½‘ç»œæ­£å¸¸è¿æ¥ï¼Œæˆ‘ä»¬å°±æ²¡å¿…è¦å»åšè¿›ä¸€æ­¥çš„å°è¯•äº†ã€‚\nåŒæ ·çš„é“ç†ï¼Œå¯¹äºä¸€ä¸ª Web æœåŠ¡ï¼Œå¦‚ baidu.comï¼Œç”±äºæˆ‘ä»¬å¹³å¸¸éƒ½å¯ä»¥é€šè¿‡ www.baidu.com å»è®¿é—®ç™¾åº¦çš„é¡µé¢ï¼ŒWeb æœåŠ¡å™¨é»˜è®¤çš„ç«¯å£å·æ˜¯ 80ï¼Œæˆ‘ä»¬ä½¿ç”¨ telnet www.baidu.com 80 åº”è¯¥ä¹Ÿå¯ä»¥è¿æ¥æˆåŠŸçš„ï¼š\n12345678[root@localhost ~]# telnet www.baidu.com 80Trying 115.239.211.112...Connected to www.baidu.com.Escape character is &#x27;^]&#x27;.helloHTTP/1.1 400 Bad RequestConnection closed by foreign host.\n\næˆ‘ä»¬ä½¿ç”¨ telnet å‘½ä»¤è¿æ¥ä¸Šä»¥åï¼Œæˆ‘ä»¬éšæ„å‘é€äº†ä¸€ä¸ª hello æ¶ˆæ¯ï¼Œç”±äºæ˜¯éæ³•çš„ http è¯·æ±‚ï¼Œè¢«æœåŠ¡å™¨å…³é—­äº†è¿æ¥ã€‚\ntelnet å‘½ä»¤ä¸ä»…å¯ä»¥è¿æ¥æŸä¸ªæœåŠ¡å™¨ï¼Œè¿˜èƒ½ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œè¿™é€šå¸¸ç”¨äºæ“ä½œä¸€äº›æ¥å—çº¯æ–‡æœ¬æ•°æ®çš„æœåŠ¡å™¨ç¨‹åºï¼Œå¦‚ FTP æœåŠ¡ã€é‚®ä»¶æœåŠ¡ç­‰ç­‰ã€‚ä¸ºäº†æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨ telnet å‘½ä»¤æ”¶å‘æ•°æ®ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ©ç”¨ telnet å‘½ä»¤æ¥æ¨¡æ‹Ÿç»™æŸä¸ªé‚®ç®±å‘é€ä¸€å°é‚®ä»¶ï¼Œå‘é€é‚®ä»¶æˆ‘ä»¬é€šå¸¸ä½¿ç”¨çš„æ˜¯ SMTP åè®®ï¼Œè¯¥åè®®é»˜è®¤ä½¿ç”¨çš„ç«¯å£ä¸º 25ã€‚\nå‡è®¾æˆ‘ä»¬çš„å‘ä»¶åœ°å€æ˜¯ï¼š&#116;&#x65;&#x73;&#x74;&#x66;&#111;&#x72;&#x6d;&#x79;&#x62;&#111;&#111;&#107;&#64;&#49;&#54;&#51;&#x2e;&#x63;&#111;&#109;ï¼Œæ”¶ä»¶åœ°å€æ˜¯ï¼š&#x62;&#97;&#x6c;&#108;&#x6f;&#x6f;&#x6e;&#x77;&#106;&#x40;&#113;&#113;&#46;&#x63;&#111;&#109;ã€‚\nå…¶ä¸­å‘ä»¶åœ°å€æ˜¯ä¸€ä¸ª 163 é‚®ç®±ï¼Œå¦‚æœä½ æ²¡æœ‰çš„è¯å¯ä»¥å»ç”³è¯·ä¸€ä¸ªï¼Œç”³è¯·åè¿›å…¥é‚®ç®±ï¼Œåœ¨è®¾ç½®é¡µé¢è·å¾—ç½‘æ˜“é‚®ç®±çš„ smtp æœåŠ¡çš„æœåŠ¡å™¨åœ°å€ï¼š\n\næˆ‘ä»¬å¾—åˆ°çš„åœ°å€ smptp åœ°å€æ˜¯ smtp.163.comï¼Œç«¯å£å·æ˜¯ 25ã€‚\nåŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¼€å¯å®¢æˆ·ç«¯æˆæƒï¼Œè®¾ç½®ä¸€ä¸ªå®¢æˆ·ç«¯æˆæƒç ï¼š\n\næˆ‘ä»¬è¿™é‡Œå°†æˆæƒç è®¾ç½®ä¸º 2019hhxxttxsã€‚\n\næ—©äº›å¹´å¾ˆå¤šé‚®ä»¶æœåŠ¡å™¨å…è®¸åœ¨å…¶ä»–å®¢æˆ·ç«¯ç™»é™†åªéœ€è¦è¾“å…¥æ­£ç¡®çš„é‚®ä»¶æœåŠ¡å™¨åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥äº†ï¼Œåæ¥å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¾ˆå¤šé‚®ç®±é‡‡ç”¨äº†æˆæƒç æœºåˆ¶ï¼Œåœ¨å…¶ä»–ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ç™»é™†è¯¥é‚®ç®±æ—¶éœ€è¦è¾“å…¥æˆæƒç ï¼ˆä¸æ˜¯å¯†ç ï¼‰ï¼Œä¸”éœ€è¦ç”¨æˆ·ä¸»åŠ¨æ‰“å¼€å…è®¸ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ç™»é™†çš„é…ç½®é€‰é¡¹ã€‚\n\né…ç½®å®Œæˆä»¥åï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥åˆ©ç”¨ telnet å‘½ä»¤è¿æ¥ 163 é‚®ä»¶æœåŠ¡å™¨å¹¶å‘é€é‚®ä»¶äº†ï¼Œç”±äºåœ¨ç™»é™†çš„è¿‡ç¨‹ä¸­éœ€è¦éªŒè¯ç”¨æˆ·åå’Œæˆæƒç ï¼Œè€Œä¸”ç”¨æˆ·åå’Œæˆæƒç å¿…é¡»ä½¿ç”¨ base64 ç¼–ç ä¹‹åçš„ï¼Œæˆ‘ä»¬å…ˆå°†ç”¨æˆ·åå’Œæˆæƒç çš„ base64 ç å‡†å¤‡å¥½ï¼Œç”¨çš„æ—¶å€™ç›´æ¥æ‹·è´è¿‡å»ï¼š\n\n\n\nåŸæ–‡\nbase64 ç \n\n\n\ntestformybook\ndGVzdGZvcm15Ym9vaw&#x3D;&#x3D;\n\n\n2019hhxxttxs\nMjAxOWhoeHh0dHhz\n\n\nå¦‚æœä½ ä¸çŸ¥é“ base64 ç¼–ç çš„åŸç†ï¼Œå¯ä»¥ä»ç½‘ä¸Šæœç´¢æ‰¾ä¸€ä¸ª base64 ç¼–è§£ç å·¥å…·ï¼Œä¾‹å¦‚ï¼šhttps://base64.supfree.net/ã€‚\nåœ¨æ•´ä¸ªæ¼”ç¤ºè¿‡ç¨‹æˆ‘ä»¬ä¸€å…±éœ€è¦ä½¿ç”¨å¦‚ä¸‹ SMTP åè®®å‘½ä»¤ï¼š\n\n\n\nå‘½ä»¤\nå«ä¹‰\n\n\n\nhelo\nå‘ smtp æœåŠ¡å™¨å‘é€é—®å€™ä¿¡æ¯\n\n\nauth login\nè¯·æ±‚ç™»é™†éªŒè¯\n\n\ndata\nè¯·æ±‚è¾“å…¥é‚®ä»¶æ­£æ–‡\n\n\nSMTP åè®® æ˜¯æ–‡æœ¬åè®®ï¼Œæ¯ä¸€ä¸ªæ•°æ®åŒ…ä»¥ \\r\\n ç»“æŸï¼ˆWindows ç³»ç»Ÿä¸‹é»˜è®¤æ¢è¡Œç¬¦ï¼‰ã€‚\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¼”ç¤ºè¿‡ç¨‹ï¼š\n1234567891011121314151617181920212223242526272829[root@localhost ~]# telnet smtp.163.com 25Trying 220.181.12.14...Connected to smtp.163.com.Escape character is &#x27;^]&#x27;.220 163.com Anti-spam GT for Coremail System (163com[20141201])helo 163.com250 OKauth login334 dXNlcm5hbWU6dGVzdGZvcm15Ym9vaw==334 UGFzc3dvcmQ6MjAxOWhoeHh0dHhz235 Authentication successfulmail from: &lt;testformybook@163.com&gt;250 Mail OKrcpt to:  &lt;balloonwj@qq.com&gt;250 Mail OKdata354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;from:testformybook@163.comto: balloonwj@qq.comsubject: TestHello, this is a message from 163..250 Mail OK queued as smtp10,DsCowADHAgQS1IBcwtExJA--.62308S2 1551946998Connection closed by foreign host.[root@localhost ~]# \n\næˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸Šè¿°æ“ä½œè¿‡ç¨‹ï¼š\n\nä½¿ç”¨ telnet smtp.163.com 25 è¿æ¥ 163 é‚®ä»¶æœåŠ¡å™¨ï¼›è¿æ¥æˆåŠŸä»¥åï¼ŒæœåŠ¡å™¨ç»™æˆ‘ä»¬å‘é€äº†ä¸€æ¡æ¬¢è¿æ¶ˆæ¯ï¼š\n1220 163.com Anti-spam GT for Coremail System (163com[20141201])\\r\\n\n\næ¥ç€ï¼Œå¿…é¡»å‘æœåŠ¡å™¨å‘é€ä¸€æ¡é—®å€™æ¶ˆæ¯ï¼Œä½¿ç”¨ helo 163.comï¼Œå½“ç„¶ 163.com è¿™ä¸ªæ˜¯é—®å€™å†…å®¹ï¼Œå¯ä»¥éšæ„å¡«å†™ï¼Œç„¶åå›è½¦ï¼Œæœ€ç»ˆç»„æˆçš„æ•°æ®åŒ…å†…å®¹æ˜¯ï¼š\n1helo 163.com\\r\\n\n\næ¥ç€æœåŠ¡å™¨ä¼šå›å¤ä¸€æ¡çŠ¶æ€ç æ˜¯ 250 çš„æ¶ˆæ¯ï¼Œè¿™é‡Œæ˜¯ï¼š\n1250 OK\\r\\n\n\næˆ‘ä»¬å†è¾“å…¥å‘½ä»¤ auth login è¯·æ±‚éªŒè¯ï¼Œç„¶åæŒ‰å›è½¦ï¼Œå®é™…å‘é€ç»™æœåŠ¡å™¨çš„æ˜¯ï¼š\n1auth login\\r\\n\n\næœåŠ¡å™¨åº”ç­”çŠ¶æ€ç  334ï¼š\n1334 dXNlcm5hbWU6\\r\\n\n\ndXNlcm5hbWU6 æ˜¯å­—ç¬¦ä¸² **username: ** çš„ base64 ç ã€‚\n\næˆ‘ä»¬è¾“å…¥æˆ‘ä»¬çš„ç”¨æˆ·å testformybook çš„ base64 ç ï¼Œç„¶åæŒ‰å›è½¦ï¼š\n1dGVzdGZvcm15Ym9vaw==\\r\\n\n\næœåŠ¡å™¨åº”ç­”çŠ¶æ€ç  334ï¼š\n1334 UGFzc3dvcmQ6\\r\\n\n\nUGFzc3dvcmQ6 æ˜¯å­—ç¬¦ä¸² Password: çš„ base64 ç ã€‚è¿™é‡Œå®é™…ä¸Šè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„æ˜¯ä¸Šæ–‡ä»‹ç»çš„æˆæƒç ï¼Œè€Œä¸æ˜¯å¯†ç ã€‚\n\næˆ‘ä»¬è¾“å…¥ MjAxOWhoeHh0dHhzï¼Œå¹¶å›è½¦ï¼š\n1MjAxOWhoeHh0dHhz\\r\\n\n\næœåŠ¡å™¨æç¤ºæˆ‘ä»¬æˆæƒæˆåŠŸï¼ˆåº”ç­”çŠ¶æ€ç  235ï¼‰ï¼š\n1235 Authentication successful\\r\\n\n\næ¥ç€è¾“å…¥é‚®ä»¶çš„å‘ä»¶åœ°å€å’Œæ”¶ä»¶åœ°å€ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šç»™æˆ‘ä»¬å“åº”çš„åº”ç­”ï¼ˆåº”ç­”çŠ¶æ€ç  250ï¼‰ï¼š\n1234mail from: &lt;testformybook@163.com&gt;\\r\\n250 Mail OK\\r\\nrcpt to:  &lt;balloonwj@qq.com&gt;\\r\\n250 Mail OK\\r\\n\n\næ¥ç€è¾“å…¥ data å‘½ä»¤è®¾ç½®é‚®ä»¶çš„ä¸»é¢˜ã€æ­£æ–‡ã€å¯¹æ–¹æ”¶åˆ°é‚®ä»¶åæ˜¾ç¤ºçš„çš„å‘ä»¶äººä¿¡æ¯ç­‰ï¼š\n12data\\r\\n354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;\n\næœåŠ¡å™¨åº”ç­” 354ï¼Œå¹¶ä¸”æç¤ºï¼Œå¦‚æœç¡®å®šç»“æŸè¾“å…¥é‚®ä»¶æ­£æ–‡å°±å…ˆæŒ‰ä¸€ä¸ªå›è½¦é”®ï¼Œå†è¾“å…¥ä¸€ä¸ªç‚¹ **.**ï¼Œå†æ¥ç€å›è½¦ï¼Œè¿™æ ·é‚®ä»¶å°±å‘é€å‡ºå»äº†ã€‚\n\næœåŠ¡å™¨åº”ç­” 250ï¼š\n1250 Mail OK queued as smtp10,DsCowADHAgQS1IBcwtExJA--.62308S2 1551946998\n\nå¦‚æœæˆ‘ä»¬æƒ³é€€å‡ºï¼Œè¾“å…¥ quit æˆ– close éƒ½å¯ä»¥ã€‚\n\n\næœ€ç»ˆï¼Œè¿™å°é‚®ä»¶å°±å‘å‡ºå»äº†ï¼Œæˆ‘ä»¬å» &#98;&#97;&#x6c;&#x6c;&#111;&#111;&#x6e;&#119;&#106;&#x40;&#x71;&#113;&#46;&#x63;&#111;&#x6d; è¿™ä¸ªé‚®ç®±æŸ¥çœ‹ä¸€ä¸‹ï¼š\n\n\nå¦‚æœä½ åœ¨å®é™…å®éªŒæ—¶ï¼Œå¯¹ç«¯æ²¡æœ‰æ”¶åˆ°é‚®ä»¶ï¼Œè¯·æŸ¥çœ‹ä¸‹ä½ çš„åƒåœ¾ç®±æˆ–è€…é‚®ç®±ååƒåœ¾é‚®ä»¶è®¾ç½®ï¼Œæœ‰å¯èƒ½è¢«é‚®ç®±ååƒåœ¾é‚®ä»¶æœºåˆ¶ç»™æ‹¦æˆªäº†ã€‚\n\nä¸Šè¿°åœ¨ç»„è£… SMTP åè®®åŒ…æ—¶æ¶‰åŠåˆ°å¾ˆå¤šçŠ¶æ€ç ï¼Œå¸¸è§çš„ SMTP çŠ¶æ€ç å«ä¹‰å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223211 å¸®åŠ©è¿”å›ç³»ç»ŸçŠ¶æ€214 å¸®åŠ©ä¿¡æ¯220 æœåŠ¡å‡†å¤‡å°±ç»ª221 å…³é—­è¿æ¥235 ç”¨æˆ·éªŒè¯æˆåŠŸ250 è¯·æ±‚æ“ä½œå°±ç»ª251 ç”¨æˆ·ä¸åœ¨æœ¬åœ°ï¼Œè½¬å¯„åˆ°å…¶ä»–è·¯å¾„334 ç­‰å¾…ç”¨æˆ·è¾“å…¥éªŒè¯ä¿¡æ¯354 å¼€å§‹é‚®ä»¶è¾“å…¥421 æœåŠ¡ä¸å¯ç”¨450 æ“ä½œæœªæ‰§è¡Œï¼Œé‚®ç®±å¿™451 æ“ä½œä¸­æ­¢ï¼Œæœ¬åœ°é”™è¯¯452 æ“ä½œæœªæ‰§è¡Œï¼Œå­˜å‚¨ç©ºé—´ä¸è¶³500 å‘½ä»¤ä¸å¯è¯†åˆ«æˆ–è¯­è¨€é”™è¯¯501 å‚æ•°è¯­æ³•é”™è¯¯502 å‘½ä»¤ä¸æ”¯æŠ€503 å‘½ä»¤é¡ºåºé”™è¯¯504 å‘½ä»¤å‚æ•°ä¸æ”¯æŒ550 æ“ä½œæœªæ‰§è¡Œï¼Œé‚®ç®±ä¸å¯ç”¨551 éæœ¬åœ°ç”¨æˆ·552 ä¸­æ­¢å­˜å‚¨ç©ºé—´ä¸è¶³553 æ“ä½œæœªæ‰§è¡Œï¼Œé‚®ç®±åä¸æ­£ç¡®554 ä¼ è¾“å¤±è´¥\n\n\nç”±äºæˆ‘ä»¬ä½¿ç”¨çš„å¼€å‘æœºå™¨ä»¥ Windows å±…å¤šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒWindows ç³»ç»Ÿçš„ telnet å‘½ä»¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ã€æ§åˆ¶é¢æ¿ã€‘- ã€ç¨‹åºã€‘- ã€ç¨‹åºå’ŒåŠŸèƒ½ã€‘- ã€æ‰“å¼€æˆ–å…³é—­WindowsåŠŸèƒ½ã€‘ä¸­æ‰“å¼€telnetåŠŸèƒ½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/åˆ©ç”¨telnetå‘½ä»¤å‘ç”µå­é‚®ä»¶","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"cc903e63e370e497adde4ee0456deec1","title":"ã€è½¬è½½ã€‘æœåŠ¡å™¨å¼€å‘ä¸­ç½‘ç»œæ•°æ®åˆ†æä¸æ•…éšœæ’æŸ¥ç»éªŒæ¼«è°ˆ","content":"æœåŠ¡å™¨å¼€å‘ä¸­ç½‘ç»œæ•°æ®åˆ†æä¸æ•…éšœæ’æŸ¥ç»éªŒæ¼«è°ˆâ€‹      \nä¸€ã€ æ“ä½œç³»ç»Ÿæä¾›çš„ç½‘ç»œæ¥å£\nä¸ºäº†èƒ½æ›´å¥½çš„æ’æŸ¥ç½‘ç»œé€šä¿¡é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç†Ÿæ‚‰æ“ä½œç³»ç»Ÿæä¾›çš„ä»¥ä¸‹ç½‘ç»œæ¥å£å‡½æ•°ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼š\n\n\n\næ¥å£å‡½æ•°åç§°\næ¥å£å‡½æ•°æè¿°\næ¥å£å‡½æ•°ç­¾å\n\n\n\nsocket\nåˆ›å»ºå¥—æ¥å­—\nint socket(int domain, int type, int  protocol);\n\n\nconnect\nè¿æ¥ä¸€ä¸ªæœåŠ¡å™¨åœ°å€\nint connect(int sockfd, const struct  sockaddr *addr,          socklen_t addrlen);\n\n\nsend\nå‘é€æ•°æ®\nssize_t send(int sockfd, const void *buf,  size_t len, int flags);\n\n\nrecv\næ”¶å–æ•°æ®\nssize_t recv(int sockfd, void *buf,  size_t len, int flags);\n\n\naccept\næ¥æ”¶è¿æ¥\nint accept4(int sockfd, struct sockaddr  *addr,          socklen_t *addrlen, int  flags);\n\n\nshutdown\nå…³é—­æ”¶å‘é“¾è·¯\nint shutdown(int sockfd, int how);\n\n\nclose\nå…³é—­å¥—æ¥å­—\nint close(int fd);\n\n\nsetsockopt\nè®¾ç½®å¥—æ¥å­—é€‰é¡¹\nint setsockopt(int sockfd, int level, int  optname,           const void *optval,  socklen_t optlen);\n\n\næ³¨æ„ï¼šè¿™é‡Œä»¥bekeleyæä¾›çš„æ ‡å‡†ä¸ºä¾‹ï¼Œä¸åŒ…æ‹¬ç‰¹å®šæ“ä½œç³»ç»Ÿä¸Šç‰¹æœ‰çš„æ¥å£å‡½æ•°ï¼ˆå¦‚Windowså¹³å°çš„WSASendï¼Œlinuxçš„accept4ï¼‰ï¼Œä¹Ÿä¸åŒ…æ‹¬å®é™…ä¸ç½‘ç»œæ•°æ®æ¥å¾€ä¸ç›¸å…³çš„å‡½æ•°ï¼ˆå¦‚selectã€linuxçš„epollï¼‰ï¼Œè¿™é‡Œåªè®¨è®ºä¸tcpç›¸å…³çš„æ¥å£å‡½æ•°ï¼Œåƒä¸udpç›¸å…³çš„å‡½æ•°sendto&#x2F;recvfromç­‰å‡½æ•°ä¸æ­¤ç±»ä¼¼ã€‚\nä¸‹é¢è®¨è®ºä¸€ä¸‹ä»¥ä¸Šå‡½æ•°çš„ä¸€äº›ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š\n1 ä»¥ä¸Šå‡½æ•°å¦‚æœè°ƒç”¨å‡ºé”™åï¼Œè¿”å›å€¼å‡ä¸º-1ï¼›ä½†æ˜¯è¿”å›å€¼æ˜¯-1ï¼Œä¸ä¸€å®šä»£è¡¨å‡ºé”™ï¼Œè¿™è¿˜å¾—æ ¹æ®å¯¹åº”çš„å¥—æ¥å­—æ¨¡å¼ï¼ˆé˜»å¡ä¸éé˜»å¡æ¨¡å¼ï¼‰ã€‚\n2 é»˜è®¤ä½¿ç”¨çš„socketå‡½æ•°åˆ›å»ºçš„å¥—æ¥å­—æ˜¯é˜»å¡æ¨¡å¼çš„ï¼Œå¯ä»¥è°ƒç”¨ç›¸å…³æ¥å£å‡½æ•°å°†å…¶è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼ï¼ˆWindowså¹³å°å¯ä»¥ä½¿ç”¨ioctlsocketå‡½æ•°ï¼Œlinuxå¹³å°å¯ä»¥ä½¿ç”¨fcntlå‡½æ•°ï¼Œå…·ä½“è®¾ç½®æ–¹æ³•å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ï¼‰ã€‚é˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼çš„å¥—æ¥å­—ï¼Œå¯¹æœåŠ¡å™¨çš„è¿æ¥æœåŠ¡å™¨å’Œç½‘ç»œæ•°æ®çš„æ”¶å‘è¡Œä¸ºå½±å“å¾ˆå¤§ã€‚è¯¦æƒ…å¦‚ä¸‹ï¼š\né˜»å¡æ¨¡å¼ä¸‹ï¼Œconnectå‡½æ•°å¦‚æœä¸èƒ½ç«‹åˆ»è¿ä¸ŠæœåŠ¡å™¨ï¼Œä¼šå¯¼è‡´æ‰§è¡Œæµé˜»å¡åœ¨é‚£é‡Œä¸€ä¼šå„¿ï¼Œç›´åˆ°connectè¿æ¥æˆåŠŸæˆ–å¤±è´¥æˆ–ç½‘ç»œè¶…æ—¶ï¼›è€Œéé˜»å¡æ¨¡å¼ä¸‹ï¼Œæ— è®ºæ˜¯å¦è¿æ¥æˆåŠŸconnectå°†ç«‹å³è¿”å›ï¼Œæ­¤æ—¶å¦‚æœæœªè¿æ¥æˆåŠŸï¼Œè¿”å›å€¼å°†æ˜¯-1ï¼Œé”™è¯¯ç æ˜¯EINPROGRESSï¼Œè¡¨ç¤ºè¿æ¥æ“ä½œä»ç„¶åœ¨è¿›è¡Œä¸­ã€‚Linuxå¹³å°åç»­å¯ä»¥é€šè¿‡ä½¿ç”¨select&#x2F;pollç­‰å‡½æ•°æ£€æµ‹è¯¥socketæ˜¯å¦å¯å†™æ¥åˆ¤æ–­è¿æ¥æ˜¯å¦æˆåŠŸã€‚\né˜»å¡å¥—æ¥å­—æ¨¡å¼ä¸‹ï¼Œsendå‡½æ•°å¦‚æœç”±äºå¯¹ç«¯tcpçª—å£å¤ªå°ï¼Œä¸è¶³ä»¥å°†å…¨éƒ¨æ•°æ®å‘é€å‡ºå»ï¼Œå°†é˜»å¡æ‰§è¡Œæµï¼Œç›´åˆ°å‡ºé”™æˆ–è¶…æ—¶æˆ–è€…å…¨éƒ¨å‘é€å‡ºå»ä¸ºæ­¢ï¼›åŒç†recvå‡½æ•°å¦‚æœå½“å‰åè®®æ ˆç³»ç»Ÿç¼“å†²åŒºä¸­æ— æ•°æ®å¯è¯»ï¼Œä¹Ÿä¼šé˜»å¡æ‰§è¡Œæµï¼Œç›´åˆ°å‡ºé”™æˆ–è€…è¶…æ—¶æˆ–è€…è¯»å–åˆ°æ•°æ®ã€‚sendå’Œrecvå‡½æ•°çš„è¶…æ—¶æ—¶é—´å¯ä»¥å‚è€ƒä¸‹æ–‡å…³äºå¸¸ç”¨socketé€‰é¡¹çš„ä»‹ç»ã€‚\néé˜»å¡å¥—æ¥å­—æ¨¡å¼ä¸‹ï¼Œå¦‚æœç”±äºå¯¹ç«¯tcpçª—å£å¤ªå°ï¼Œä¸è¶³ä»¥å°†æ•°æ®å‘å‡ºå»ï¼Œå®ƒå°†ç«‹åˆ»è¿”å›ï¼Œä¸ä¼šé˜»å¡æ‰§è¡Œæµï¼Œæ­¤æ—¶è¿”å›å€¼ä¸º-1ï¼Œé”™è¯¯ç æ˜¯EAGAINæˆ–EWOULDBLOCKï¼Œè¡¨ç¤ºå½“å‰æ•°æ®å‘ä¸å‡ºå»ï¼Œå¸Œæœ›ä½ ä¸‹æ¬¡å†è¯•ã€‚ä½†æ˜¯è¿”å›å€¼å¦‚æœæ˜¯-1ï¼Œä¹Ÿå¯èƒ½æ˜¯çœŸæ­£çš„å‡ºé”™äº†ï¼Œä¹Ÿå¯èƒ½å¾—åˆ°é”™è¯¯ç EINTRï¼Œè¡¨ç¤ºè¢«linuxä¿¡å·ä¸­æ–­äº†ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚recvå‡½æ•°ä¸sendå‡½æ•°æƒ…å½¢ä¸€æ ·ã€‚\n3 sendå‡½æ•°è™½ç„¶åç§°å«â€œsendâ€ï¼Œä½†æ˜¯å…¶å¹¶ä¸æ˜¯å°†æ•°æ®å‘é€åˆ°ç½‘ç»œä¸Šå»ï¼Œåªæ˜¯å°†æ•°æ®ä»åº”ç”¨å±‚ç¼“å†²åŒºä¸­æ‹·è´åˆ°åè®®æ ˆå†…æ ¸ç¼“å†²åŒºä¸­ï¼Œå…·ä½“ä»€ä¹ˆæ—¶å€™å‘é€åˆ°ç½‘ç»œä¸Šå»ï¼Œä¸åè®®æ ˆæœ¬èº«è¡Œä¸ºæœ‰å…³ç³»ï¼ˆsocketé€‰é¡¹nagleç®—æ³•ä¸è¿™ä¸ªæœ‰å…³ç³»ï¼Œä¸‹æ–‡ä»‹ç»å¸¸è§å¥—æ¥å­—é€‰é¡¹æ—¶ä¼šä»‹ç»ï¼‰ï¼Œè¿™ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œæ‰€ä»¥å³ä½¿sendå‡½æ•°è¿”å›ä¸€ä¸ªå¤§äº0çš„å€¼nï¼Œä¹Ÿä¸èƒ½è¡¨æ˜å·²ç»æœ‰nä¸ªå­—èŠ‚å‘é€åˆ°ç½‘ç»œä¸Šå»äº†ã€‚åŒæ ·çš„é“ç†ï¼Œrecvå‡½æ•°ä¹Ÿä¸æ˜¯ä»ç½‘ç»œä¸Šæ”¶å–æ•°æ®ï¼Œåªæ˜¯ä»åè®®æ ˆå†…æ ¸ç¼“å†²åŒºæ‹·è´æ•°æ®è‡³åº”ç”¨å±‚ç¼“å†²åŒºï¼Œå¹¶ä¸æ˜¯çœŸæ­£åœ°ä»ç½‘ç»œä¸Šæ”¶æ•°æ®ï¼Œæ‰€ä»¥ï¼Œè°ƒç”¨recvæ—¶ï¼Œæ“ä½œç³»ç»Ÿçš„åè®®æ ˆå·²ç»å°†æ•°æ®ä»ç½‘ç»œä¸Šæ”¶åˆ°è‡ªå·±çš„å†…æ ¸ç¼“å†²åŒºä¸­äº†ï¼Œrecvä»…ä»…æ˜¯ä¸€æ¬¡æ•°æ®æ‹·è´æ“ä½œè€Œå·²ã€‚\n4 ç”±äºå¥—æ¥å­—å®ç°æ˜¯æ”¶å‘å…¨åŒå·¥çš„ï¼Œæ”¶å’Œå‘é€šé“ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¼šç›¸äº’å½±å“ï¼Œshutdownå‡½æ•°æ˜¯ç”¨æ¥é€‰æ‹©å…³é—­socketæ”¶å‘é€šé“ä¸­æŸä¸€è·¯ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸¤è·¯éƒ½å…³é—­ï¼‰ï¼Œå…¶howå‚æ•°å–å€¼ä¸€èˆ¬æœ‰ä¸‰ä¸ªï¼šSHUT_RD&#x2F;SHUT_WR&#x2F;SHUT_RDWRï¼ŒSHUT_RDè¡¨ç¤ºå…³é—­æ”¶æ¶ˆæ¯é“¾è·¯ï¼Œå³è¯¥å¥—æ¥å­—ä¸èƒ½å†æ”¶å–æ•°æ®ï¼ŒåŒç†SHUT_WRè¡¨ç¤ºå…³é—­å¥—æ¥å­—å‘æ¶ˆæ¯é“¾è·¯ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç­‰å¾…ç¼“å†²åŒºä¸­æ•°æ®å‘é€å®Œåå†å…³é—­è¿æ¥æ€ä¹ˆåŠï¼Ÿè¿™é‡Œå°±è¦ç”¨åˆ°å¥—æ¥å­—é€‰é¡¹LINGERï¼Œå…³äºè¿™ä¸ªé€‰é¡¹è¯·å‚è€ƒä¸‹æ–‡å¸¸è§çš„å¥—æ¥å­—é€‰é¡¹ä»‹ç»ã€‚æœ€åï¼ŒSHUT_RDWRåŒæ—¶å…³é—­æ”¶æ¶ˆæ¯é“¾è·¯å’Œå‘æ¶ˆæ¯é“¾è·¯ã€‚é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼Œshutdownå‡½æ•°å¹¶ä¸ä¼šè¦æ±‚æ“ä½œç³»ç»Ÿåº•å±‚å›æ”¶å¥—æ¥å­—ç­‰èµ„æºï¼ŒçœŸæ­£ä¼šå›æ”¶èµ„æºæ˜¯closeå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¦æ±‚æ“ä½œç³»ç»Ÿå›æ”¶ç›¸å…³å¥—æ¥å­—èµ„æºï¼Œå¹¶é‡Šæ”¾å¯¹ipåœ°å€ä¸ç«¯å£å·äºŒå…ƒç»„çš„å ç”¨ï¼Œä½†æ˜¯ç”±äºtcpå››æ¬¡æŒ¥æ‰‹æœ€åä¸€ä¸ªé˜¶æ®µæœ‰ä¸ªTIME_WAITçŠ¶æ€ï¼ˆå…³äºè¿™ä¸ªçŠ¶æ€ä¸‹æ–‡ä»‹ç»tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡å›æ”¶æ—¶ä¼šè¯¦ç»†ä»‹ç»ï¼‰ï¼Œå¯¼è‡´ä¸è¯¥socketç›¸å…³çš„ç«¯å£å·èµ„æºä¸ä¼šè¢«ç«‹å³é‡Šæ”¾ï¼Œæœ‰æ—¶å€™ä¸ºäº†è¾¾åˆ°é‡Šæ”¾ç«¯å£ç”¨æ¥å¤ç”¨ï¼Œæˆ‘ä»¬ä¼šè®¾ç½®å¥—æ¥å­—é€‰é¡¹SOL_REUSEPORTï¼ˆå…³äºè¿™ä¸ªé€‰é¡¹ï¼Œä¸‹æ–‡ä¼šä»‹ç»ï¼‰ã€‚ç»¼åˆèµ·æ¥ï¼Œæˆ‘ä»¬å…³é—­ä¸€ä¸ªå¥—æ¥å­—ï¼Œä¸€èˆ¬ä¼šå…ˆè°ƒç”¨shutdownå‡½æ•°å†è°ƒç”¨closeå‡½æ•°ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä¼˜é›…å…³é—­ï¼š\n\n5 å¸¸è§çš„å¥—æ¥å­—é€‰é¡¹\nä¸¥æ ¼æ„ä¹‰ä¸Šè¯´å¥—æ¥å­—é€‰é¡¹æ˜¯æœ‰ä¸åŒå±‚çº§çš„ï¼ˆlevelï¼‰ï¼Œå¦‚socketçº§åˆ«ã€TCPçº§åˆ«ã€IPçº§åˆ«ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸åŒºåˆ†å…·ä½“çš„çº§åˆ«ã€‚\n\nSO_SNDTIMEOä¸SO_RCVTIMEO\n\nè¿™ä¸¤ä¸ªé€‰é¡¹ç”¨äºè®¾ç½®é˜»å¡æ¨¡å¼ä¸‹å¥—æ¥å­—ï¼ŒSO_SNDTIMEOç”¨äºåœ¨sendæ•°æ®ç”±äºå¯¹ç«¯tcpçª—å£å¤ªå°ï¼Œå‘ä¸å‡ºå»è€Œæœ€å¤§çš„é˜»å¡æ—¶é•¿ï¼›SO_RCVTIMEOç”¨äºrecvå‡½æ•°å› æ¥å—ç¼“å†²åŒºæ— æ•°æ®è€Œé˜»å¡çš„æœ€å¤§é˜»å¡æ—¶é•¿ã€‚å¦‚æœä½ éœ€è¦è·å–å®ƒä»¬çš„é»˜è®¤å€¼ï¼Œè¯·ä½¿ç”¨getsockoptå‡½æ•°ã€‚\n\nTCP_NODELAY\n\næ“ä½œç³»ç»Ÿåº•å±‚åè®®æ ˆé»˜è®¤æœ‰è¿™æ ·ä¸€ä¸ªæœºåˆ¶ï¼Œä¸ºäº†å‡å°‘ç½‘ç»œé€šä¿¡æ¬¡æ•°ï¼Œä¼šå°†sendç­‰å‡½æ•°æäº¤ç»™tcpåè®®æ ˆçš„å¤šä¸ªå°çš„æ•°æ®åŒ…åˆå¹¶æˆä¸€ä¸ªå¤§çš„æ•°æ®åŒ…ï¼Œæœ€åå†ä¸€æ¬¡æ€§å‘å‡ºå»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ è°ƒç”¨sendå‡½æ•°å¾€å†…æ ¸åè®®æ ˆç¼“å†²åŒºæ‹·è´äº†ä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªæ•°æ®ä¹Ÿè®¸ä¸ä¼šé©¬ä¸Šå‘åˆ°ç½‘ç»œä¸Šå»ï¼Œè€Œæ˜¯è¦ç­‰åˆ°åè®®æ ˆç¼“å†²åŒºç§¯ç´¯åˆ°ä¸€å®šé‡çš„æ•°æ®åæ‰ä¼šä¸€æ¬¡æ€§å‘å‡ºå»ï¼Œæˆ‘ä»¬æŠŠè¿™ç§æœºåˆ¶å«åšnagleç®—æ³•ã€‚é»˜è®¤æ‰“å¼€äº†è¿™ä¸ªæœºåˆ¶ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å…³é—­è¿™ç§æœºåˆ¶ï¼Œè®©sendçš„æ•°æ®èƒ½å¤Ÿç«‹åˆ»å‘å‡ºå»ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…³é—­è¿™ä¸ªç®—æ³•ï¼Œè¿™å°±å¯ä»¥é€šè¿‡è®¾ç½®å¥—æ¥å­—é€‰é¡¹TCP_NODELAYï¼Œå³å…³é—­nagleç®—æ³•ã€‚\n\nSO_LINGER\n\nlingerè¿™ä¸ªå•è¯æœ¬èº«çš„æ„æ€ï¼Œæ˜¯â€œæš‚åœã€é€—ç•™â€ã€‚è¿™ä¸ªé€‰é¡¹çš„ç”¨å¤„æ˜¯ç”¨äºè§£å†³ï¼Œå½“éœ€è¦å…³é—­å¥—æ¥å­—æ—¶ï¼Œåè®®æ ˆå‘é€ç¼“å†²åŒºä¸­å°šæœ‰æœªå‘é€å‡ºå»çš„æ•°æ®ï¼Œç­‰å¾…è¿™äº›æ•°æ®å‘å®Œçš„æœ€é•¿ç­‰å¾…æ—¶é—´ã€‚\n\nSO_REUSEADDR&#x2F;SO_REUSEPORT\n\nä¸€ä¸ªç«¯å£ï¼Œå°¤å…¶æ˜¯ä½œä¸ºæœåŠ¡å™¨ç«¯ç«¯å£åœ¨å››æ¬¡æŒ¥æ‰‹çš„æœ€åä¸€æ­¥ï¼Œæœ‰ä¸€ä¸ªä¸ºTIME_WAITçš„çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¸€èˆ¬æŒç»­2MSLï¼ˆMSLï¼Œmaximum segment lifeï¼Œ æœ€å¤§ç”Ÿå­˜å‘¨æœŸï¼ŒRFCä¸Šå»ºè®®æ˜¯2åˆ†é’Ÿï¼‰ã€‚è¿™ä¸ªçŠ¶æ€å­˜åœ¨åŸå› å¦‚ä¸‹ï¼š1. ä¿è¯å‘å‡ºå»çš„ackèƒ½è¢«é€è¾¾ï¼ˆè¶…æ—¶ä¼šé‡å‘ackï¼‰2. è®©è¿Ÿæ¥çš„æŠ¥æ–‡æœ‰è¶³å¤Ÿçš„æ—¶é—´è¢«ä¸¢å¼ƒï¼Œåè¿‡æ¥è¯´ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥ç«‹åˆ»å¤ç”¨è¿™ä¸ªåœ°å€å’Œç«¯å£å·ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ”¶åˆ°è€çš„è¿æ¥è¿Ÿæ¥çš„æ•°æ®ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¥½çš„ã€‚ä¸ºäº†ç«‹å³å›æ”¶å¤ç”¨ç«¯å£å·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼€å¯å¥—æ¥å­—SO_REUSEADDR&#x2F;SO_REUSEPORTã€‚\n\nSO_KEEPALIVE\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªè¿æ¥é•¿æ—¶é—´æ²¡æœ‰æ•°æ®æ¥å¾€ï¼Œä¼šè¢«ç³»ç»Ÿé˜²ç«å¢™ä¹‹ç±»çš„æœåŠ¡å…³é—­ã€‚ä¸ºäº†é¿å…è¿™ç§ç°è±¡ï¼Œå°¤å…¶æ˜¯ä¸€äº›éœ€è¦é•¿è¿æ¥çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¿ƒè·³åŒ…æœºåˆ¶ï¼Œå³å®šæ—¶ä»ä¸¤ç«¯å®šæ—¶å‘ä¸€ç‚¹æ•°æ®ï¼Œè¿™ç§è¡Œä¸ºå«åšâ€œä¿æ´»â€ã€‚è€Œtcpåè®®æ ˆæœ¬èº«ä¹Ÿæä¾›äº†è¿™ç§æœºåˆ¶ï¼Œé‚£å°±æ˜¯è®¾ç½®å¥—æ¥å­—SO_KEEPALIVEé€‰é¡¹ï¼Œå¼€å¯è¿™ä¸ªé€‰é¡¹åï¼Œtcpåè®®æ ˆä¼šå®šæ—¶å‘é€å¿ƒè·³åŒ…æ¢é’ˆï¼Œä½†æ˜¯è¿™ä¸ªé»˜è®¤æ—¶é—´æ¯”è¾ƒé•¿ï¼ˆ2ä¸ªå°æ—¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­é€šè¿‡ç›¸å…³é€‰é¡¹æ”¹å˜è¿™ä¸ªé»˜è®¤å€¼ã€‚\nâ€‹      \näºŒã€å¸¸ç”¨çš„ç½‘ç»œæ•…éšœæ’æŸ¥å·¥å…·1.ping\npingå‘½ä»¤å¯ç”¨äºæµ‹è¯•ç½‘ç»œæ˜¯å¦è¿é€šã€‚\n2.telnet\nå‘½ä»¤ä½¿ç”¨æ ¼å¼ï¼š\n1telnet  ipæˆ–åŸŸå port\n\nä¾‹å¦‚ï¼š\n123telnet 120.55.94.78 8888telnet www.baidu.com 80\n\nç»“åˆpingå’Œtelnetå‘½ä»¤æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­ä¸€ä¸ªæœåŠ¡å™¨åœ°å€ä¸Šçš„æŸä¸ªç«¯å£å·æ˜¯å¦å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ã€‚\nç”±äºæˆ‘ä»¬ä½¿ç”¨çš„å¼€å‘æœºå™¨ä»¥windowså±…å¤šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œwindowsç³»ç»Ÿçš„telnetå‘½ä»¤æ˜¯æ²¡æœ‰æ‰“å¼€çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ã€æ§åˆ¶é¢æ¿ã€‘- ã€ç¨‹åºã€‘- ã€ç¨‹åºå’ŒåŠŸèƒ½ã€‘- ã€æ‰“å¼€æˆ–å…³é—­WindowsåŠŸèƒ½ã€‘ä¸­æ‰“å¼€telnetåŠŸèƒ½ã€‚\n\n3.hostå‘½ä»¤\nhost å‘½ä»¤å¯ä»¥è§£æåŸŸåå¾—åˆ°å¯¹åº”çš„ipåœ°å€ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦å¾—åˆ°www.baidu.comè¿™ä¸ªåŸŸåçš„ipåœ°å€ï¼Œå¯ä»¥è¾“å…¥ï¼š\n\n å¾—åˆ°www.google.comçš„ipåœ°å€å¯ä»¥è¾“å…¥ï¼š\n\n4 .netstatå‘½ä»¤\nå¸¸è§çš„é€‰é¡¹æœ‰ï¼š\n-a (all)æ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹ï¼Œnetstaté»˜è®¤ä¸æ˜¾ç¤ºLISTENç›¸å…³\n-t (tcp)ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹\n-u (udp)ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹\n-n æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–æˆæ•°å­—ã€‚(é‡è¦)\n-l ä»…åˆ—å‡ºæœ‰åœ¨ Listen (ç›‘å¬) çš„æœå‹™çŠ¶æ€\n-p æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æ¥çš„ç¨‹åºå(macOSä¸­è¡¨ç¤ºåè®® -p protocol)\n-r æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯ï¼Œè·¯ç”±è¡¨\n-e æ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ï¼Œä¾‹å¦‚uidç­‰\n-s æŒ‰å„ä¸ªåè®®è¿›è¡Œç»Ÿè®¡ (é‡è¦)\n-c æ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´ï¼Œæ‰§è¡Œè¯¥netstatå‘½ä»¤ã€‚\n5. lsofå‘½ä»¤\nlsofï¼Œå³list opened filedescriptorï¼Œå³åˆ—å‡ºå½“å‰æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ï¼Œsocketä¹Ÿæ˜¯ä¸€ç§file descriptorï¼Œå¸¸è§çš„é€‰é¡¹æ˜¯:\n-i åˆ—å‡ºç³»ç»Ÿæ‰“å¼€çš„socket fd\n-P ä¸è¦æ˜¾ç¤ºç«¯å£å·åˆ«å\n-n ä¸è¦æ˜¾ç¤ºipåœ°å€åˆ«åï¼ˆå¦‚localhostä¼šç”¨127.0.0.1æ¥ä»£æ›¿ï¼‰\n+c w ç¨‹åºåˆ—åç§°æœ€å¤§å¯ä»¥æ˜¾ç¤ºåˆ°wä¸ªå­—ç¬¦ã€‚\nå¸¸è§çš„é€‰é¡¹ç»„åˆä¸ºlsof â€“i â€“Pnï¼š\n\nå¯ä»¥çœ‹åˆ°åˆ—å‡ºäº†å½“å‰ä¾¦å¬çš„socketï¼Œå’Œè¿æ¥socketçš„tcpçŠ¶æ€ã€‚\n6.pstack\nä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œè¿™ä¸ªä¸ç®—ç½‘ç»œæ’æŸ¥æ•…éšœå’Œè°ƒè¯•å‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹æŸä¸ªè¿›ç¨‹çš„çº¿ç¨‹æ•°é‡å’Œçº¿ç¨‹è°ƒç”¨å †æ ˆæ˜¯å¦è¿è¡Œæ­£å¸¸ã€‚æŒ‡ä»¤ä½¿ç”¨æ ¼å¼ï¼š\n1pstack pid\n\nå³ï¼Œpstack è¿›ç¨‹å·ï¼Œå¦‚ï¼š\n\n7.ncå‘½ä»¤\nå³netcatå‘½ä»¤ï¼Œè¿™ä¸ªå·¥å…·åœ¨æ’æŸ¥ç½‘ç»œæ•…éšœæ—¶éå¸¸æœ‰ç”¨ï¼Œå› è€Œè¢«ä¸šç»©ç§°ä¸ºç½‘ç»œç•Œçš„â€œç‘å£«å†›åˆ€â€ã€‚å¸¸è§çš„ç”¨æ³•å¦‚ä¸‹ï¼š\n\næ¨¡æ‹ŸæœåŠ¡å™¨ç«¯åœ¨æŒ‡å®šipåœ°å€å’Œç«¯å£å·ä¸Šä¾¦å¬\n\n1nc â€“l 0.0.0.0 8888\n\n\næ¨¡æ‹Ÿå®¢æˆ·ç«¯è¿æ¥åˆ°æŒ‡å®šipåœ°å€å’Œç«¯å£å·\n\n1nc 0.0.0.0 8888\n\næˆ‘ä»¬çŸ¥é“å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ä¸€èˆ¬éƒ½æ˜¯æ“ä½œç³»ç»Ÿéšæœºåˆ†é…ä¸€ä¸ªå¯ç”¨çš„ç«¯å£å·è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šå»ï¼Œè¿™ä¸ªæŒ‡ä»¤ç”šè‡³å¯ä»¥æŒ‡å®šä½¿ç”¨å“ªä¸ªç«¯å£å·è¿æ¥ï¼Œå¦‚ï¼š\n1nc â€“p 12345 127.0.0.1 8888\n\nå®¢æˆ·ç«¯ä½¿ç”¨ç«¯å£12345å»è¿æ¥æœåŠ¡å™¨127.0.0.1::8888ã€‚\n\nä½¿ç”¨ncå‘½ä»¤å‘æ¶ˆæ¯å’Œå‘æ–‡ä»¶\n\nå®¢æˆ·ç«¯\n\næœåŠ¡å™¨\n\n8 .tcpdump\nè¿™ä¸ªæ˜¯linuxç³»ç»Ÿè‡ªå¸¦çš„æŠ“åŒ…å·¥å…·ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œé»˜è®¤éœ€è¦å¼€å¯rootæƒé™æ‰èƒ½ä½¿ç”¨ã€‚\n\nå…¶å¸¸è§çš„é€‰é¡¹æœ‰ï¼š\n-i æŒ‡å®šç½‘å¡\n-X â€“XX æ‰“å°åå…­è¿›åˆ¶çš„ç½‘ç»œæ•°æ®åŒ…\n-n â€“nn ä¸æ˜¾ç¤ºipåœ°å€å’Œç«¯å£çš„åˆ«å\n-S ä»¥ç»å¯¹å€¼æ˜¾ç¤ºåŒ…çš„ISNå·ï¼ˆåŒ…åºåˆ—å·ï¼‰\nå¸¸ç”¨çš„è¿‡æ»¤æ¡ä»¶æœ‰å¦‚ä¸‹å½¢å¼ï¼š\n12345tcpdump â€“i any â€˜port 8888â€™tcpdump â€“i any â€˜tcp port 8888â€™tcpdump â€“i any â€˜tcp src port 8888â€™tcpdump â€“i any â€˜tcp src port 8888 and udp dst port 9999â€™tcpdump -i any &#x27;src host 127.0.0.1 and tcp src port 12345&#x27; -XX -nn -vv\n\nå…³äºtcpdumpå‘½ä»¤æ¥ä¸‹æ¥å°†ä¼šä»¥å¯¹tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹çš„åŒ…æ•°æ®è¿›è¡ŒæŠ“åŒ…æ¥åˆ†æã€‚\nä¸‰ã€ tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹è§£æç†Ÿç»ƒåœ°æŒæ¡tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹çš„æ¯ä¸€ä¸ªç»†èŠ‚æ˜¯æˆ‘ä»¬æ’æŸ¥ç½‘ç»œé—®é¢˜çš„åŸºç¡€ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥é€šè¿‡tcpdumpæŠ“åŒ…èƒ½å®æˆ˜ä¸€ä¸‹ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œå‡è®¾æˆ‘çš„æœåŠ¡å™¨ç«¯çš„åœ°å€æ˜¯ 127.0.0.0.1 : 12345ï¼Œä½¿ç”¨ncå‘½ä»¤åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºå¹¶åœ¨è¿™ä¸ªåœ°å€ä¸Šè¿›è¡Œä¾¦å¬ï¼š\n1nc â€“v -l 127.0.0.0.112345\n\n\nç„¶ååœ¨å®¢æˆ·ç«¯æœºå™¨ä¸Šå¼€å¯tcpdumpå·¥å…·ï¼š\n\nç„¶ååœ¨å®¢æˆ·ç«¯ä½¿ç”¨ncå‘½ä»¤åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯å»è¿æ¥æœåŠ¡å™¨ï¼š\n\næˆ‘ä»¬æŠ“åˆ°çš„åŒ…å¦‚ä¸‹ï¼š\n\nå›¾ç‰‡çœ‹ä¸æ¸…ï¼Œå¯ä»¥æ”¾å¤§æ¥çœ‹ã€‚ä¸Šé¢æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼š\nä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ˜¯å®¢æˆ·ç«¯å…ˆç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªSYNï¼Œç„¶åæœåŠ¡å™¨åº”ç­”ä¸€ä¸ªSYN+ACKï¼Œåº”ç­”çš„åºåˆ—å·æ˜¯é€’å¢1çš„ï¼Œè¡¨ç¤ºåº”ç­”å“ªä¸ªè¯·æ±‚ï¼Œå³ä»4004096087é€’å¢åˆ°4004096088ï¼Œæ¥ç€å®¢æˆ·ç«¯å†åº”ç­”ä¸€ä¸ªACKã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°å‘åŒ…åºåˆ—å·å’Œåº”ç­”åºåˆ—å·éƒ½å˜æˆ1äº†ï¼Œè¿™æ˜¯tcpdumpä½¿ç”¨ç›¸å¯¹åºå·ï¼Œæˆ‘ä»¬åŠ ä¸Š-Sé€‰é¡¹åå°±å˜æˆç»å¯¹åºåˆ—å·äº†ã€‚\n\n è¿™æ˜¯æ­£å¸¸çš„tcpä¸‰æ¬¡æ¡æ‰‹ï¼Œå‡å¦‚æˆ‘ä»¬è¿æ¥çš„æœåŠ¡å™¨ipåœ°å€å­˜åœ¨ï¼Œä½†ç›‘å¬ç«¯å£å·å¹¶ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬çœ‹ä¸‹tcpdumpæŠ“åŒ…ç»“æœï¼š\n\nè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯å‘é€SYNï¼ŒæœåŠ¡å™¨åº”ç­”ACK+RSTï¼š\n\n è¿™ä¸ªåº”ç­”åŒ…ä¼šå¯¼è‡´å®¢æˆ·ç«¯çš„connectè¿æ¥å¤±è´¥ã€‚\nè¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯å®¢æˆ·ç«¯è®¿é—®ä¸€ä¸ªå¾ˆé¥è¿œçš„ipï¼Œæˆ–è€…ç½‘ç»œç¹å¿™ï¼ŒæœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯å‘é€çš„ç½‘ç»œSYNæŠ¥æ–‡æ²¡æœ‰åº”ç­”ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ\n\næˆ‘ä»¬å…ˆå°†é˜²ç«å¢™çš„å·²æœ‰è§„åˆ™éƒ½æ¸…ç†æ‰: iptables -F\nç„¶åç»™é˜²ç«å¢™çš„INPUTé“¾ä¸Šå¢åŠ ä¸€ä¸ªè§„åˆ™ï¼Œä¸¢å¼ƒæœ¬åœ°ç½‘å¡loï¼ˆä¹Ÿå°±æ˜¯127.0.0.1è¿™ä¸ªå›ç¯åœ°å€ï¼‰ä¸Šçš„æ‰€æœ‰SYNåŒ…ã€‚\n\n æ¥ç€ï¼Œæˆ‘ä»¬çœ‹åˆ°tcpdumpæŠ“åˆ°çš„æ•°æ®åŒ…å¦‚ä¸‹ï¼š\n\n è¿æ¥ä¸ä¸Šï¼Œä¸€å…±é‡è¯•äº†5æ¬¡ï¼Œé‡è¯•çš„æ—¶é—´é—´éš”æ˜¯1ç§’ï¼Œ2ç§’ï¼Œ4ç§’ï¼Œ8ç§’ï¼Œ16ç§’ï¼Œæœ€åè¿”å›å¤±è´¥ã€‚è¿™ä¸ªé‡è¯•æ¬¡æ•°åœ¨&#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_syn_retries å†…æ ¸å‚æ•°ä¸­è®¾ç½®ï¼Œé»˜è®¤ä¸º6ã€‚\nå››æ¬¡æŒ¥æ‰‹ä¸ä¸‰æ¬¡æ¡æ‰‹åŸºæœ¬ä¸Šç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸è´´å‡ºtcpdumpæŠ“åŒ…çš„è¯¦æƒ…äº†ã€‚å®é™…çš„ç½‘ç»œå¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯é«˜QPSçš„æœåŠ¡å™¨ç¨‹åºï¼Œå¯èƒ½åœ¨åœ¨æœåŠ¡å™¨ç¨‹åºæ‰€åœ¨çš„ç³»ç»Ÿä¸Šç•™ä¸‹å¤§é‡éESTABLISHEDçš„ä¸­é—´çŠ¶æ€ï¼Œå¦‚CLOSE_WAIT&#x2F;TIME_WAITï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤æ¥ç»Ÿè®¡è¿™äº›çŠ¶æ€ä¿¡æ¯ï¼š\nnetstat -n | awk â€˜&#x2F;^tcp&#x2F; {++S[$NF]} END {for(a in S) print a, S[a]}â€™ \nå¾—åˆ°ç»“æœå¯èƒ½ç±»ä¼¼ï¼š\n\nè®©æˆ‘ä»¬å†è´´ä¸€å¼ tcpä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹æ›´æ¸…æ™°çš„å›¾å§ã€‚\n\n ä¸‹é¢çœ‹ä¸‹ä¸€èˆ¬æ¯”è¾ƒå…³å¿ƒçš„ä¸‰ç§TCPçŠ¶æ€\n\nSYN_RECV\n\næœåŠ¡ç«¯æ”¶åˆ°å»ºç«‹è¿æ¥çš„SYNæ²¡æœ‰æ”¶åˆ°ACKåŒ…çš„æ—¶å€™å¤„åœ¨SYN_RECVçŠ¶æ€ã€‚æœ‰ä¸¤ä¸ªç›¸å…³ç³»ç»Ÿé…ç½®ï¼š\n1 net.ipv4.tcp_synack_retriesï¼Œæ•´å½¢ï¼Œé»˜è®¤å€¼æ˜¯5\nå¯¹äºè¿œç«¯çš„è¿æ¥è¯·æ±‚SYNï¼Œå†…æ ¸ä¼šå‘é€SYN ï¼‹ ACKæ•°æ®æŠ¥ï¼Œä»¥ç¡®è®¤æ”¶åˆ°ä¸Šä¸€ä¸ª SYNè¿æ¥è¯·æ±‚åŒ…ã€‚è¿™æ˜¯ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶çš„ç¬¬äºŒä¸ªæ­¥éª¤ã€‚è¿™é‡Œå†³å®šå†…æ ¸åœ¨æ”¾å¼ƒè¿æ¥ä¹‹å‰æ‰€é€å‡ºçš„ SYN+ACK æ•°ç›®ã€‚ä¸åº”è¯¥å¤§äº255ï¼Œé»˜è®¤å€¼æ˜¯5ï¼Œå¯¹åº”äº180ç§’å·¦å³æ—¶é—´ã€‚é€šå¸¸æˆ‘ä»¬ä¸å¯¹è¿™ä¸ªå€¼è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›TCPè¿æ¥ä¸è¦å› ä¸ºå¶å°”çš„ä¸¢åŒ…è€Œæ— æ³•å»ºç«‹ã€‚\n2 net.ipv4.tcp_syncookies\nä¸€èˆ¬æœåŠ¡å™¨éƒ½ä¼šè®¾ç½®net.ipv4.tcp_syncookies&#x3D;1æ¥é˜²æ­¢SYN Floodæ”»å‡»ã€‚å‡è®¾ä¸€ä¸ªç”¨æˆ·å‘æœåŠ¡å™¨å‘é€äº†SYNæŠ¥æ–‡åçªç„¶æ­»æœºæˆ–æ‰çº¿ï¼Œé‚£ä¹ˆæœåŠ¡å™¨åœ¨å‘å‡ºSYN+ACKåº”ç­”æŠ¥æ–‡åæ˜¯æ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯çš„ACKæŠ¥æ–‡çš„ï¼ˆç¬¬ä¸‰æ¬¡æ¡æ‰‹æ— æ³•å®Œæˆï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹æœåŠ¡å™¨ç«¯ä¸€èˆ¬ä¼šé‡è¯•ï¼ˆå†æ¬¡å‘é€SYN+ACKç»™å®¢æˆ·ç«¯ï¼‰å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´åä¸¢å¼ƒè¿™ä¸ªæœªå®Œæˆçš„è¿æ¥ï¼Œè¿™æ®µæ—¶é—´çš„é•¿åº¦æˆ‘ä»¬ç§°ä¸ºSYN Timeoutï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ—¶é—´æ˜¯åˆ†é’Ÿçš„æ•°é‡çº§ï¼ˆå¤§çº¦ä¸º30ç§’-2åˆ†é’Ÿï¼‰ã€‚è¿™äº›å¤„åœ¨SYNC_RECVçš„TCPè¿æ¥ç§°ä¸ºåŠè¿æ¥ï¼Œå¹¶å­˜å‚¨åœ¨å†…æ ¸çš„åŠè¿æ¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨å†…æ ¸æ”¶åˆ°å¯¹ç«¯å‘é€çš„ackåŒ…æ—¶ä¼šæŸ¥æ‰¾åŠè¿æ¥é˜Ÿåˆ—ï¼Œå¹¶å°†ç¬¦åˆçš„requst_sockä¿¡æ¯å­˜å‚¨åˆ°å®Œæˆä¸‰æ¬¡æ¡æ‰‹çš„è¿æ¥çš„é˜Ÿåˆ—ä¸­ï¼Œç„¶ååˆ é™¤æ­¤åŠè¿æ¥ã€‚å¤§é‡SYNC_RECVçš„TCPè¿æ¥ä¼šå¯¼è‡´åŠè¿æ¥é˜Ÿåˆ—æº¢å‡ºï¼Œè¿™æ ·åç»­çš„è¿æ¥å»ºç«‹è¯·æ±‚ä¼šè¢«å†…æ ¸ç›´æ¥ä¸¢å¼ƒï¼Œè¿™å°±æ˜¯SYN Floodæ”»å‡»ã€‚èƒ½å¤Ÿæœ‰æ•ˆé˜²èŒƒSYN Floodæ”»å‡»çš„æ‰‹æ®µä¹‹ä¸€ï¼Œå°±æ˜¯SYN Cookieã€‚SYN CookieåŸç†ç”±D. J. Bernstainå’Œ Eric Schenkå‘æ˜ã€‚SYN Cookieæ˜¯å¯¹TCPæœåŠ¡å™¨ç«¯çš„ä¸‰æ¬¡æ¡æ‰‹åè®®ä½œä¸€äº›ä¿®æ”¹ï¼Œä¸“é—¨ç”¨æ¥é˜²èŒƒSYN Floodæ”»å‡»çš„ä¸€ç§æ‰‹æ®µã€‚å®ƒçš„åŸç†æ˜¯ï¼Œåœ¨TCPæœåŠ¡å™¨æ”¶åˆ°SYNåŒ…å¹¶è¿”å›SYN+ACKåŒ…æ—¶ï¼Œä¸åˆ†é…ä¸€ä¸ªä¸“é—¨çš„æ•°æ®åŒºï¼Œè€Œæ˜¯æ ¹æ®è¿™ä¸ªSYNåŒ…è®¡ç®—å‡ºä¸€ä¸ªcookieå€¼ã€‚åœ¨æ”¶åˆ°ACKåŒ…æ—¶ï¼ŒTCPæœåŠ¡å™¨åœ¨æ ¹æ®é‚£ä¸ªcookieå€¼æ£€æŸ¥è¿™ä¸ªTCP ACKåŒ…çš„åˆæ³•æ€§ã€‚å¦‚æœåˆæ³•ï¼Œå†åˆ†é…ä¸“é—¨çš„æ•°æ®åŒºè¿›è¡Œå¤„ç†æœªæ¥çš„TCPè¿æ¥ã€‚è§‚æµ‹æœåŠ¡ä¸ŠSYN_RECVè¿æ¥ä¸ªæ•°ä¸ºï¼š7314ï¼Œå¯¹äºä¸€ä¸ªé«˜å¹¶å‘è¿æ¥çš„é€šè®¯æœåŠ¡å™¨ï¼Œè¿™ä¸ªæ•°å­—æ¯”è¾ƒæ­£å¸¸ã€‚\n\nCLOSE_WAIT\n\nå‘èµ·TCPè¿æ¥å…³é—­çš„ä¸€æ–¹ç§°ä¸ºclientï¼Œè¢«åŠ¨å…³é—­çš„ä¸€æ–¹ç§°ä¸ºserverã€‚è¢«åŠ¨å…³é—­çš„serveræ”¶åˆ°FINåï¼Œä½†æœªå‘å‡ºACKçš„TCPçŠ¶æ€æ˜¯CLOSE_WAITã€‚å‡ºç°è¿™ç§çŠ¶å†µä¸€èˆ¬éƒ½æ˜¯ç”±äºserverç«¯ä»£ç çš„é—®é¢˜ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šå‡ºç°å¤§é‡CLOSE_WAITï¼Œåº”è¯¥è¦è€ƒè™‘æ£€æŸ¥ä»£ç ã€‚\n\nTIME_WAIT\n\næ ¹æ®ä¸‰æ¬¡æ¡æ‰‹æ–­å¼€è¿æ¥è§„å®šï¼Œå‘èµ·socketä¸»åŠ¨å…³é—­çš„ä¸€æ–¹ socketå°†è¿›å…¥TIME_WAITçŠ¶æ€ã€‚TIME_WAITçŠ¶æ€å°†æŒç»­2MSLã€‚TIME_WAITçŠ¶æ€ä¸‹çš„socketä¸èƒ½è¢«å›æ”¶ä½¿ç”¨ã€‚ å…·ä½“ç°è±¡æ˜¯å¯¹äºä¸€ä¸ªå¤„ç†å¤§é‡çŸ­è¿æ¥çš„æœåŠ¡å™¨ï¼Œå¦‚æœæ˜¯ç”±æœåŠ¡å™¨ä¸»åŠ¨å…³é—­å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå°†å¯¼è‡´æœåŠ¡å™¨ç«¯å­˜åœ¨å¤§é‡çš„å¤„äºTIME_WAITçŠ¶æ€çš„socketï¼Œ ç”šè‡³æ¯”å¤„äºEstablishedçŠ¶æ€ä¸‹çš„socketå¤šçš„å¤šï¼Œä¸¥é‡å½±å“æœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ï¼Œç”šè‡³è€—å°½å¯ç”¨çš„socketï¼Œåœæ­¢æœåŠ¡ã€‚TIME_WAITæ˜¯TCPåè®®ç”¨ä»¥ä¿è¯è¢«é‡æ–°åˆ†é…çš„socketä¸ä¼šå—åˆ°ä¹‹å‰æ®‹ç•™çš„å»¶è¿Ÿé‡å‘æŠ¥æ–‡å½±å“çš„æœºåˆ¶,æ˜¯å¿…è¦çš„é€»è¾‘ä¿è¯ã€‚å’ŒTIME_WAITçŠ¶æ€æœ‰å…³çš„ç³»ç»Ÿå‚æ•°æœ‰ä¸€èˆ¬ç”±3ä¸ªï¼Œæœ¬æœºè®¾ç½®å¦‚ä¸‹ï¼š\n1234567891011net.ipv4.tcp_tw_recycle = 1net.ipv4.tcp_tw_reuse = 1net.ipv4.tcp_fin_timeout = 30net.ipv4.tcp_fin_timeoutï¼Œé»˜è®¤60sï¼Œå‡å°fin_timeoutï¼Œå‡å°‘TIME_WAITè¿æ¥æ•°é‡ã€‚net.ipv4.tcp_tw_reuse = 1è¡¨ç¤ºå¼€å¯é‡ç”¨ã€‚å…è®¸å°†TIME-WAIT socketsé‡æ–°ç”¨äºæ–°çš„TCPè¿æ¥ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ï¼›net.ipv4.tcp_tw_recycle = 1è¡¨ç¤ºå¼€å¯TCPè¿æ¥ä¸­TIME-WAIT socketsçš„å¿«é€Ÿå›æ”¶ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\n\næˆ‘ä»¬è¿™é‡Œæ€»ç»“ä¸€ä¸‹è¿™äº›ä¸tcpçŠ¶æ€çš„é€‰é¡¹ï¼š\n\nnet.ipv4.tcp_syncookies&#x3D;1 è¡¨ç¤ºå¼€å¯SYN Cookiesã€‚å½“å‡ºç°SYNç­‰å¾…é˜Ÿåˆ—æº¢å‡ºæ—¶ï¼Œå¯ç”¨cookieæ¥å¤„ç†ï¼Œå¯é˜²èŒƒå°‘é‡çš„SYNæ”»å‡»ã€‚é»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\n\nnet.ipv4.tcp_tw_reuse&#x3D;1 è¡¨ç¤ºå¼€å¯é‡ç”¨ã€‚å…è®¸å°†TIME-WAITå¥—æ¥å­—é‡æ–°ç”¨äºæ–°çš„TCPè¿æ¥ã€‚é»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\n\nnet.ipv4.tcp_tw_recycle&#x3D;1 è¡¨ç¤ºå¼€å¯TCPè¿æ¥ä¸­TIME-WAITå¥—æ¥å­—çš„å¿«é€Ÿå›æ”¶ã€‚é»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚**\n\nnet.ipv4.tcp_fin_timeout&#x3D;30 è¡¨ç¤ºå¦‚æœå¥—æ¥å­—ç”±æœ¬ç«¯è¦æ±‚å…³é—­ï¼Œè¿™ä¸ªå‚æ•°å†³å®šäº†å®ƒä¿æŒåœ¨FIN-WAIT-2çŠ¶æ€çš„æ—¶é—´ã€‚\n\nnet.ipv4.tcp_keepalive_time&#x3D;1200 è¡¨ç¤ºå½“keepaliveå¯ç”¨æ—¶ï¼ŒTCPå‘é€keepaliveæ¶ˆæ¯çš„é¢‘åº¦ã€‚é»˜è®¤æ˜¯2å°æ—¶ï¼Œè¿™é‡Œæ”¹ä¸º20åˆ†é’Ÿã€‚\n\nnet.ipv4.ip_local_port_range&#x3D;1024 65000 è¡¨ç¤ºå‘å¤–è¿æ¥çš„ç«¯å£èŒƒå›´ã€‚é»˜è®¤å€¼å¾ˆå°ï¼š32768ï½61000ï¼Œæ”¹ä¸º1024ï½65000ã€‚\n\nnet.ipv4.tcp_max_syn_backlog&#x3D;8192 è¡¨ç¤ºSYNé˜Ÿåˆ—çš„é•¿åº¦ï¼Œé»˜è®¤ä¸º1024ï¼ŒåŠ å¤§é˜Ÿåˆ—é•¿åº¦ä¸º8192ï¼Œå¯ä»¥å®¹çº³æ›´å¤šç­‰å¾…è¿æ¥çš„ç½‘ç»œè¿æ¥æ•°ã€‚\n\nnet.ipv4.tcp_max_tw_buckets&#x3D;5000 è¡¨ç¤ºç³»ç»ŸåŒæ—¶ä¿æŒTIME_WAITå¥—æ¥å­—çš„æœ€å¤§æ•°é‡ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•° å­—ï¼ŒTIME_WAITå¥—æ¥å­—å°†ç«‹åˆ»è¢«æ¸…é™¤å¹¶æ‰“å°è­¦å‘Šä¿¡æ¯ã€‚é»˜è®¤ä¸º180000ï¼Œæ”¹ä¸º5000ã€‚\n\n\næ³¨æ„\nä¸Šæ–‡ä¸­ç”¨çº¢è‰²å­—ä½“æ ‡è¯†å‡ºæ¥çš„ä¸¤ä¸ªå‚æ•°ï¼š\n123net.ipv4.tcp_tw_recyclenet.ipv4.tcp_tw_reuse\n\n\n\nåœ¨å®é™…linuxå†…æ ¸å‚æ•°è°ƒä¼˜æ—¶å¹¶ä¸å»ºè®®å¼€å¯ã€‚è‡³äºåŸå› ï¼Œæˆ‘ä¼šå•ç‹¬ç”¨ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»ã€‚\n\nå››ã€ å…³äºè·¨ç³»ç»Ÿä¸è·¨è¯­è¨€ä¹‹é—´çš„ç½‘ç»œé€šä¿¡è¿é€šé—®é¢˜å¦‚ä½•åœ¨Javaè¯­è¨€ä¸­å»è§£æC++çš„ç½‘ç»œæ•°æ®åŒ…ï¼Œå¦‚ä½•åœ¨C++ä¸­è§£æJavaçš„ç½‘ç»œæ•°æ®åŒ…ï¼Œå¯¹äºå¾ˆå¤šäººæ¥è¯´æ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„äº‹æƒ…ï¼Œæ‰€ä»¥åªèƒ½å˜ç€æ³•å­ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“ã€‚å…¶å®ä½¿ç”¨tcpdumpå·¥å…·å¯ä»¥å¾ˆå®¹æ˜“è§£å†³ä¸åˆ†æã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®å­—èŠ‚åºåˆ—è¿™æ ·ä¸€ä¸ªæ¦‚å¿µï¼Œå³æˆ‘ä»¬è¯´çš„å¤§ç«¯ç¼–ç (big endian)å’Œå°ç«¯ç¼–ç (little endian)ï¼Œx86å’Œx64ç³»åˆ—çš„cpuä½¿ç”¨å°ç«¯ç¼–ç ï¼Œè€Œæ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œä»¥åŠJavaè¯­è¨€ä¸­ï¼Œä½¿ç”¨çš„æ˜¯å¤§ç«¯ç¼–ç ã€‚é‚£ä¹ˆè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ\næˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œçœ‹ä¸€ä¸ªx64æœºå™¨ä¸Šçš„32ä½æ•°å€¼åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼ï¼š\n\ni åœ¨å†…å­˜ä¸­çš„åœ°å€åºåˆ—æ˜¯0x003CF7C4~ 0x003CF7C8ï¼Œå€¼ä¸º40 e2 01 00ã€‚\n\n åå…­è¿›åˆ¶0001e240æ­£å¥½ç­‰äº10è¿›åˆ¶123456ï¼Œä¹Ÿå°±æ˜¯è¯´å°ç«¯ç¼–ç ä¸­æƒé‡é«˜çš„çš„å­—èŠ‚å€¼å­˜å‚¨åœ¨å†…å­˜åœ°å€é«˜ï¼ˆåœ°å€å€¼è¾ƒå¤§ï¼‰çš„ä½ç½®ï¼Œæƒé‡å€¼ä½çš„å­—èŠ‚å€¼å­˜å‚¨åœ¨å†…å­˜åœ°å€ä½ï¼ˆåœ°å€å€¼è¾ƒå°ï¼‰çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é«˜é«˜ä½ä½ã€‚\nç›¸åï¼Œå¤§ç«¯ç¼–ç çš„è§„åˆ™åº”è¯¥æ˜¯é«˜ä½ä½é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´æƒå€¼é«˜å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜åœ°å€ä½çš„ä½ç½®ï¼Œæƒå€¼ä½çš„å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜åœ°å€é«˜çš„ä½ç½®ã€‚\næ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ä¸ªC++ç¨‹åºçš„int32å€¼123456ä¸ä½œè½¬æ¢åœ°ä¼ ç»™Javaç¨‹åºï¼Œé‚£ä¹ˆJavaæŒ‰ç…§å¤§ç«¯ç¼–ç çš„å½¢å¼è¯»å‡ºæ¥çš„å€¼æ˜¯ï¼šåå…­è¿›åˆ¶40E20100 &#x3D; åè¿›åˆ¶1088553216ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä¹ˆåœ¨å‘é€æ–¹å°†æ•°æ®è½¬æ¢æˆç½‘ç»œå­—èŠ‚åºï¼ˆå¤§ç«¯ç¼–ç ï¼‰ï¼Œè¦ä¹ˆåœ¨æ¥æ”¶ç«¯å†è¿›è¡Œè½¬æ¢ã€‚\nä¸‹é¢çœ‹ä¸€ä¸‹å¦‚æœC++ç«¯ä¼ é€ä¸€ä¸ªå¦‚ä¸‹æ•°æ®ç»“æ„ï¼ŒJavaç«¯è¯¥å¦‚ä½•è§£æï¼ˆç”±äºJavaä¸­æ˜¯æ²¡æœ‰æŒ‡é’ˆçš„ï¼Œä¹Ÿæ— æ³•æ“ä½œå†…å­˜åœ°å€ï¼Œå¯¼è‡´å¾ˆå¤šäººæ— ä»ä¸‹æ‰‹ï¼‰ï¼Œä¸‹é¢åˆ©ç”¨tcpdumpæ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ€è·¯ã€‚\næˆ‘ä»¬å®¢æˆ·ç«¯å‘é€çš„æ•°æ®åŒ…ï¼š\n\nå…¶ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š\n\n åˆ©ç”¨tcpdumpæŠ“åˆ°çš„åŒ…å¦‚ä¸‹ï¼š\n\næ”¾å¤§ä¸€ç‚¹ï¼š\n\n æˆ‘ä»¬ç™½è‰²æ ‡è¯†å‡ºæ¥å°±æ˜¯æˆ‘ä»¬æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚è¿™é‡Œæˆ‘æƒ³è¯´æ˜ä¸¤ç‚¹ï¼š\n\nå¦‚æœæˆ‘ä»¬çŸ¥é“å‘é€ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå†æ¯”ç…§æ¥æ”¶ç«¯æ”¶åˆ°çš„å­—èŠ‚æµï¼Œæˆ‘ä»¬å°±èƒ½æ£€æµ‹æ•°æ®åŒ…çš„å®Œæ•´æ€§ï¼Œæˆ–è€…åˆ©ç”¨è¿™ä¸ªæ¥æ’æŸ¥ä¸€äº›é—®é¢˜ï¼›\nå¯¹äºJavaç¨‹åºåªè¦æŒ‰ç…§è¿™ä¸ªé¡ºåºï¼Œå…ˆåˆ©ç”¨java.net.Socketçš„è¾“å‡ºæµjava.io.DataOutputStreamå¯¹è±¡readByteã€readInt32ã€readInt32ã€readBytesã€readBytesæ–¹æ³•ä¾æ¬¡è¯»å‡ºä¸€ä¸ªcharã€int32ã€int32ã€16ä¸ªå­—èŠ‚çš„å­—èŠ‚æ•°ç»„ã€63ä¸ªå­—èŠ‚æ•°ç»„å³å¯ï¼Œä¸ºäº†è¿˜åŸåƒint32è¿™æ ·çš„æ•´å½¢å€¼ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å°ç«¯ç¼–ç å‘å¤§ç«¯ç¼–ç çš„è½¬æ¢ã€‚\n\nå‚è€ƒèµ„æ–™ï¼š\n\nã€ŠTCP&#x2F;IPè¯¦è§£å·ä¸€ï¼šåè®®ã€‹\nã€ŠTCP&#x2F;IPè¯¦è§£å·äºŒï¼šå®ç°ã€‹\næ¸¸åŒã€ŠLinuxé«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹ã€‹\nhttps://man.cx/?page=iptables(8)\nhttps://vincent.bernat.im/en/blog/2014-tcp-time-wait-state-linux\nhttps://blog.csdn.net/chinalinuxzend/article/details/1792184\nhttps://www.zhihu.com/question/29212769\nhttps://blog.csdn.net/launch_225/article/details/9211731\nhttps://www.cnblogs.com/splenday/articles/7668589.html\nhttp://man.linuxde.net/ss\nhttp://www.cnxct.com/coping-with-the-tcp-time_wait-state-on-busy-linux-servers-in-chinese-and-dont-enable-tcp_tw_recycle/\nhttps://www.cnblogs.com/xkus/p/7463135.html\n\n","slug":"è½¬è½½/å­¦ä¹ èµ„æ–™/æœåŠ¡å™¨å¼€å‘ä¸­ç½‘ç»œæ•°æ®åˆ†æä¸æ•…éšœæ’æŸ¥ç»éªŒæ¼«è°ˆ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™","author_index":"é˜¿æœ¨å¤§å”"},{"id":"f803883e87085e50bdcf47ed5c086db3","title":"ã€è½¬è½½ã€‘Linuxepollæ¨¡å‹ï¼ˆå«LTæ¨¡å¼å’ŒETæ¨¡å¼è¯¦è§£ï¼‰","content":"Linux epoll æ¨¡å‹ï¼ˆå«LT æ¨¡å¼å’Œ ET æ¨¡å¼è¯¦è§£ï¼‰ç»¼åˆ select å’Œ poll çš„ä¸€äº›ä¼˜ç¼ºç‚¹ï¼ŒLinux ä»å†…æ ¸ 2.6 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†æ›´é«˜æ•ˆçš„ epoll æ¨¡å‹ï¼Œæœ¬èŠ‚æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç» epoll æ¨¡å‹ã€‚\nè¦æƒ³ä½¿ç”¨ epoll æ¨¡å‹ï¼Œå¿…é¡»å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª epollfdï¼Œè¿™éœ€è¦ä½¿ç”¨ epoll_create å‡½æ•°å»åˆ›å»ºï¼š\n123#include &lt;sys/epoll.h&gt;int epoll_create(int size);\n\nå‚æ•° size ä» Linux 2.6.8 ä»¥åå°±ä¸å†ä½¿ç”¨ï¼Œä½†æ˜¯å¿…é¡»è®¾ç½®ä¸€ä¸ªå¤§äº 0 çš„å€¼ã€‚epoll_create å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›ä¸€ä¸ªéè´Ÿå€¼çš„ epollfdï¼Œè°ƒç”¨å¤±è´¥è¿”å› -1ã€‚\næœ‰äº† epollfd ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬éœ€è¦æ£€æµ‹äº‹ä»¶çš„å…¶ä»– fd ç»‘å®šåˆ°è¿™ä¸ª epollfd ä¸Šï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå·²ç»ç»‘å®šä¸Šå»çš„ fd çš„äº‹ä»¶ç±»å‹ï¼Œæˆ–è€…åœ¨ä¸éœ€è¦æ—¶å°† fd ä» epollfd ä¸Šè§£ç»‘ï¼Œè¿™éƒ½å¯ä»¥ä½¿ç”¨ epoll_ctl å‡½æ•°ï¼š\n1int epoll_ctl(int epfd, int op, int fd, struct epoll_event* event);\n\nå‚æ•°è¯´æ˜ï¼š\n\nå‚æ•° epfd å³ä¸Šæ–‡æåˆ°çš„ epollfdï¼›\n\nå‚æ•° opï¼Œæ“ä½œç±»å‹ï¼Œå–å€¼æœ‰ EPOLL_CTL_ADDã€EPOLL_CTL_MOD å’Œ EPOLL_CTL_DELï¼Œåˆ†åˆ«è¡¨ç¤ºå‘ epollfd ä¸Šæ·»åŠ ã€ä¿®æ”¹å’Œç§»é™¤ä¸€ä¸ªå…¶ä»– fdï¼Œå½“å–å€¼æ˜¯ EPOLL_CTL_DELï¼Œç¬¬å››ä¸ªå‚æ•° event å¿½ç•¥ä¸è®¡ï¼Œå¯ä»¥è®¾ç½®ä¸º NULLï¼›\n\nå‚æ•° fdï¼Œå³éœ€è¦è¢«æ“ä½œçš„ fdï¼›\n\nå‚æ•° eventï¼Œè¿™æ˜¯ä¸€ä¸ª epoll_event ç»“æ„ä½“çš„åœ°å€ï¼Œepoll_event ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š\n12345struct epoll_event&#123;  uint32_t     events;      /* éœ€è¦æ£€æµ‹çš„ fd äº‹ä»¶ï¼Œå–å€¼ä¸ poll å‡½æ•°ä¸€æ · */  epoll_data_t data;        /* ç”¨æˆ·è‡ªå®šä¹‰æ•°æ® */&#125;;\n\nepoll_event ç»“æ„ä½“çš„ data å­—æ®µçš„ç±»å‹æ˜¯ epoll_data_tï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå­—æ®µè®¾ç½®ä¸€ä¸ªè‡ªå·±çš„è‡ªå®šä¹‰æ•°æ®ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Union å¯¹è±¡ï¼Œåœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸­å…¶å¤§å°æ˜¯ 8 å­—èŠ‚ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n1234567typedef union epoll_data&#123;  void*         ptr;  int          fd;  uint32_t     u32;  uint64_t     u64;&#125; epoll_data_t;\n\nå‡½æ•°è¿”å›å€¼ï¼šepoll_ctl è°ƒç”¨æˆåŠŸè¿”å› 0ï¼Œè°ƒç”¨å¤±è´¥è¿”å› -1ï¼Œä½ å¯ä»¥é€šè¿‡ errno é”™è¯¯ç è·å–å…·ä½“çš„é”™è¯¯åŸå› ã€‚\n\n\nåˆ›å»ºäº† epollfdï¼Œè®¾ç½®å¥½æŸä¸ª fd ä¸Šéœ€è¦æ£€æµ‹äº‹ä»¶å¹¶å°†è¯¥ fd ç»‘å®šåˆ° epollfd ä¸Šå»åï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨ epoll_wait æ£€æµ‹äº‹ä»¶äº†ï¼Œepoll_wait å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š\n1int epoll_wait(int epfd, struct epoll_event* events, int maxevents, int timeout);\n\nå‚æ•°çš„å½¢å¼å’Œ poll å‡½æ•°å¾ˆç±»ä¼¼ï¼Œå‚æ•° events æ˜¯ä¸€ä¸ª epoll_event ç»“æ„æ•°ç»„çš„é¦–åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ªè¾“å‡ºå‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æˆåŠŸåï¼Œevents ä¸­å­˜æ”¾çš„æ˜¯ä¸å°±ç»ªäº‹ä»¶ç›¸å…³ epoll_event ç»“æ„ä½“æ•°ç»„ï¼›å‚æ•° maxevents æ˜¯æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ï¼›timeout æ˜¯è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼Œå¦‚æœè®¾ç½®ä¸º 0ï¼Œepoll_wait ä¼šç«‹å³è¿”å›ã€‚\nå½“ epoll_wait è°ƒç”¨æˆåŠŸä¼šè¿”å›æœ‰äº‹ä»¶çš„ fd æ•°ç›®ï¼›å¦‚æœè¿”å› 0 è¡¨ç¤ºè¶…æ—¶ï¼›è°ƒç”¨å¤±è´¥è¿”å› -1ã€‚\nepoll_wait ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435while (true)&#123;    epoll_event epoll_events[1024];    int n = epoll_wait(epollfd, epoll_events, 1024, 1000);    if (n &lt; 0)    &#123;        //è¢«ä¿¡å·ä¸­æ–­        if (errno == EINTR)            continue;        //å‡ºé”™ï¼Œé€€å‡º        break;    &#125;    else if (n == 0)    &#123;        //è¶…æ—¶ï¼Œç»§ç»­        continue;    &#125;    for (size_t i = 0; i &lt; n; ++i)    &#123;        // å¤„ç†å¯è¯»äº‹ä»¶        if (epoll_events[i].events &amp; POLLIN)        &#123;        &#125;        // å¤„ç†å¯å†™äº‹ä»¶        else if (epoll_events[i].events &amp; POLLOUT)        &#123;        &#125;        //å¤„ç†å‡ºé”™äº‹ä»¶        else if (epoll_events[i].events &amp; POLLERR)        &#123;        &#125;    &#125;&#125;\n\nepoll_wait ä¸ poll çš„åŒºåˆ«é€šè¿‡å‰é¢ä»‹ç» poll ä¸ epoll_wait å‡½æ•°çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š\nepoll_wait å‡½æ•°è°ƒç”¨å®Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ event å‚æ•°ä¸­æ‹¿åˆ°æ‰€æœ‰æœ‰äº‹ä»¶å°±ç»ªçš„ fdï¼Œç›´æ¥å¤„ç†å³å¯ï¼ˆevent å‚æ•°ä»…ä»…æ˜¯ä¸ªå‡ºå‚ï¼‰ï¼›è€Œ poll å‡½æ•°çš„äº‹ä»¶é›†åˆè°ƒç”¨å‰åæ•°é‡éƒ½æœªæ”¹å˜ï¼Œåªä¸è¿‡è°ƒç”¨å‰æˆ‘ä»¬é€šè¿‡ pollfd ç»“æ„ä½“çš„ events å­—æ®µè®¾ç½®å¾…æ£€æµ‹äº‹ä»¶ï¼Œè°ƒç”¨åæˆ‘ä»¬éœ€è¦é€šè¿‡ pollfd ç»“æ„ä½“çš„ revents å­—æ®µå»æ£€æµ‹å°±ç»ªçš„äº‹ä»¶ï¼ˆ å‚æ•° fds æ—¢æ˜¯å…¥å‚ä¹Ÿæ˜¯å‡ºå‚ï¼‰ã€‚\nä¸¾ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼ŒæŸäººä¸æ–­ç»™ä½ ä¸€äº›è‹¹æœï¼Œè¿™äº›è‹¹æœæœ‰ç”Ÿæœ‰ç†Ÿï¼Œè°ƒç”¨ epoll_wait ç›¸å½“äºï¼š\n121. ä½ æŠŠè‹¹æœæŒ¨ä¸ªæŠ•å…¥åˆ° epoll æœºå™¨ä¸­(è°ƒç”¨ epoll_ctl);2. è°ƒç”¨ epoll_wait åŠ å·¥ï¼Œä½ ç›´æ¥é€šè¿‡å¦å¤–ä¸€ä¸ªè¢‹å­å°±èƒ½æ‹¿åˆ°æ‰€æœ‰ç†Ÿè‹¹æœã€‚\n\nè°ƒç”¨ poll ç›¸å½“äºï¼š\n121. æŠŠæ”¶åˆ°çš„è‹¹æœè£…å…¥ä¸€ä¸ªè¢‹å­é‡Œé¢ç„¶åè°ƒç”¨ poll åŠ å·¥ï¼›2. è°ƒç”¨ç»“æŸåï¼Œæ‹¿åˆ°åŸæ¥çš„è¢‹å­ï¼Œè¢‹å­ä¸­è¿˜æ˜¯åŸæ¥é‚£ä¹ˆå¤šè‹¹æœï¼Œåªä¸è¿‡ç†Ÿè‹¹æœè¢«è´´ä¸Šäº†æ ‡ç­¾çº¸ï¼Œä½ è¿˜æ˜¯éœ€è¦æŒ¨ä¸ªå»æŸ¥çœ‹æ ‡ç­¾çº¸æŒ‘é€‰ç†Ÿè‹¹æœã€‚ \n\nå½“ç„¶ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ï¼Œpoll å‡½æ•°çš„æ•ˆç‡ä¸å¦‚ epoll_waitï¼Œä¸€èˆ¬åœ¨ fd æ•°é‡æ¯”è¾ƒå¤šï¼Œä½†æŸæ®µæ—¶é—´å†…ï¼Œå°±ç»ªäº‹ä»¶ fd æ•°é‡è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œepoll_wait æ‰ä¼šä½“ç°å‡ºå®ƒçš„ä¼˜åŠ¿ï¼Œä¹Ÿå°±æ˜¯è¯´ socket è¿æ¥æ•°é‡è¾ƒå¤§æ—¶è€Œæ´»è·ƒè¿æ¥è¾ƒå°‘æ—¶ epoll æ¨¡å‹æ›´é«˜æ•ˆã€‚\nLT æ¨¡å¼å’Œ ET æ¨¡å¼ä¸ poll çš„äº‹ä»¶å®ç›¸æ¯”ï¼Œepoll æ–°å¢äº†ä¸€ä¸ªäº‹ä»¶å® EPOLLETï¼Œè¿™å°±æ˜¯æ‰€è°“çš„è¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼ˆEdge Triggerï¼ŒETï¼‰ï¼Œè€Œé»˜è®¤çš„æ¨¡å¼æˆ‘ä»¬ç§°ä¸º æ°´å¹³è§¦å‘æ¨¡å¼ï¼ˆLevel Triggerï¼ŒLTï¼‰ã€‚è¿™ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼š\n\nå¯¹äºæ°´å¹³è§¦å‘æ¨¡å¼ï¼Œä¸€ä¸ªäº‹ä»¶åªè¦æœ‰ï¼Œå°±ä¼šä¸€ç›´è§¦å‘ï¼›\nå¯¹äºè¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼Œåªæœ‰ä¸€ä¸ªäº‹ä»¶ä»æ— åˆ°æœ‰æ‰ä¼šè§¦å‘ã€‚\n\nè¿™ä¸¤ä¸ªè¯æ±‡æ¥è‡ªç”µå­¦æœ¯è¯­ï¼Œä½ å¯ä»¥å°† fd ä¸Šæœ‰æ•°æ®è®¤ä¸ºæ˜¯é«˜ç”µå¹³ï¼Œæ²¡æœ‰æ•°æ®è®¤ä¸ºæ˜¯ä½ç”µå¹³ï¼Œå°† fd å¯å†™è®¤ä¸ºæ˜¯é«˜ç”µå¹³ï¼Œfd ä¸å¯å†™è®¤ä¸ºæ˜¯ä½ç”µå¹³ã€‚é‚£ä¹ˆæ°´å¹³æ¨¡å¼çš„è§¦å‘æ¡ä»¶æ˜¯çŠ¶æ€å¤„äºé«˜ç”µå¹³ï¼Œè€Œè¾¹ç¼˜æ¨¡å¼æ˜¯çŠ¶æ€æ”¹ä¸ºé«˜ç”µå¹³ï¼Œå³ï¼š\næ°´å¹³æ¨¡å¼çš„è§¦å‘æ¡ä»¶\n121. ä½ç”µå¹³ =&gt; é«˜ç”µå¹³2. é«˜ç”µå¹³ =&gt; é«˜ç”µå¹³\n\nè¾¹ç¼˜æ¨¡å¼çš„è§¦å‘æ¡ä»¶\n11. ä½ç”µå¹³ =&gt; é«˜ç”µå¹³\n\nè¯´çš„æœ‰ç‚¹æŠ½è±¡ï¼Œä»¥ socket çš„è¯»äº‹ä»¶ä¸ºä¾‹ï¼Œå¯¹äºæ°´å¹³æ¨¡å¼ï¼Œåªè¦ socket ä¸Šæœ‰æœªè¯»å®Œçš„æ•°æ®ï¼Œå°±ä¼šä¸€ç›´äº§ç”Ÿ POLLIN äº‹ä»¶ï¼›è€Œå¯¹äºè¾¹ç¼˜æ¨¡å¼ï¼Œsocket ä¸Šç¬¬ä¸€æ¬¡æœ‰æ•°æ®ä¼šè§¦å‘ä¸€æ¬¡ï¼Œåç»­ socket ä¸Šå­˜åœ¨æ•°æ®ä¹Ÿä¸ä¼šå†è§¦å‘ï¼Œé™¤éæŠŠæ•°æ®è¯»å®Œåï¼Œå†æ¬¡äº§ç”Ÿæ•°æ®æ‰ä¼šç»§ç»­è§¦å‘ã€‚å¯¹äº socket å†™äº‹ä»¶ï¼Œå¦‚æœ socket çš„ TCP çª—å£ä¸€ç›´ä¸é¥±å’Œï¼Œä¼šä¸€ç›´è§¦å‘ POLLOUT äº‹ä»¶ï¼›è€Œå¯¹äºè¾¹ç¼˜æ¨¡å¼ï¼Œåªä¼šè§¦å‘ä¸€æ¬¡ï¼Œé™¤é TCP çª—å£ç”±ä¸é¥±å’Œå˜æˆé¥±å’Œå†ä¸€æ¬¡å˜æˆä¸é¥±å’Œï¼Œæ‰ä¼šå†æ¬¡è§¦å‘ POLLOUT äº‹ä»¶ã€‚\nsocket å¯è¯»äº‹ä»¶æ°´å¹³æ¨¡å¼è§¦å‘æ¡ä»¶ï¼š\n121. socketä¸Šæ— æ•°æ® =&gt; socketä¸Šæœ‰æ•°æ®2. socketä¸Šæœ‰æ•°æ® =&gt; socketä¸Šæœ‰æ•°æ®\n\nsocket å¯è¯»äº‹ä»¶è¾¹ç¼˜æ¨¡å¼è§¦å‘æ¡ä»¶ï¼š\n11. socketä¸Šæ— æ•°æ® =&gt; socketä¸Šæœ‰æ•°æ®\n\nsocket å¯å†™äº‹ä»¶æ°´å¹³æ¨¡å¼è§¦å‘æ¡ä»¶ï¼š\n121. socketå¯å†™   =&gt; socketå¯å†™2. socketä¸å¯å†™ =&gt; socketå¯å†™\n\nsocket å¯å†™äº‹ä»¶è¾¹ç¼˜æ¨¡å¼è§¦å‘æ¡ä»¶ï¼š\n11. socketä¸å¯å†™ =&gt; socketå¯å†™\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¯¹äºä¸€ä¸ªéé˜»å¡ socketï¼Œå¦‚æœä½¿ç”¨ epoll è¾¹ç¼˜æ¨¡å¼å»æ£€æµ‹æ•°æ®æ˜¯å¦å¯è¯»ï¼Œè§¦å‘å¯è¯»äº‹ä»¶ä»¥åï¼Œä¸€å®šè¦ä¸€æ¬¡æ€§æŠŠ socket ä¸Šçš„æ•°æ®æ”¶å–å¹²å‡€æ‰è¡Œï¼Œä¹Ÿå°±æ˜¯ä¸€å®šè¦å¾ªç¯è°ƒç”¨ recv å‡½æ•°ç›´åˆ° recv å‡ºé”™ï¼Œé”™è¯¯ç æ˜¯EWOULDBLOCKï¼ˆEAGAIN ä¸€æ ·ï¼‰ï¼›å¦‚æœä½¿ç”¨æ°´å¹³æ¨¡å¼ï¼Œåˆ™ä¸ç”¨ï¼Œä½ å¯ä»¥æ ¹æ®ä¸šåŠ¡ä¸€æ¬¡æ€§æ”¶å–å›ºå®šçš„å­—èŠ‚æ•°ï¼Œæˆ–è€…æ”¶å®Œä¸ºæ­¢ã€‚è¾¹ç¼˜æ¨¡å¼ä¸‹æ”¶å–æ•°æ®çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425bool TcpSession::RecvEtMode()&#123;    //æ¯æ¬¡åªæ”¶å–256ä¸ªå­—èŠ‚    char buff[256];    while (true)    &#123;               int nRecv = ::recv(clientfd_, buff, 256, 0);        if (nRecv == -1)        &#123;            if (errno == EWOULDBLOCK)                return true;            else if (errno == EINTR)                continue;            return false;        &#125;        //å¯¹ç«¯å…³é—­äº†socket        else if (nRecv == 0)            return false;        inputBuffer_.add(buff, (size_t)nRecv);    &#125;    return true;&#125;\n\næœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª epoll æ¨¡å‹çš„å®Œæ•´ä¾‹å­ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189/** * æ¼”ç¤º epoll é€šä¿¡æ¨¡å‹ï¼Œepoll_server.cpp * zhangyl 2019.03.16 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;fcntl.h&gt;#include &lt;sys/epoll.h&gt;#include &lt;poll.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;vector&gt;#include &lt;errno.h&gt;int main(int argc, char* argv[])&#123;    //åˆ›å»ºä¸€ä¸ªä¾¦å¬socket    int listenfd = socket(AF_INET, SOCK_STREAM, 0);    if (listenfd == -1)    &#123;        std::cout &lt;&lt; &quot;create listen socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //å°†ä¾¦å¬socketè®¾ç½®ä¸ºéé˜»å¡çš„    int oldSocketFlag = fcntl(listenfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    if (fcntl(listenfd, F_SETFL,  newSocketFlag) == -1)    &#123;        close(listenfd);        std::cout &lt;&lt; &quot;set listenfd to nonblock error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //åˆå§‹åŒ–æœåŠ¡å™¨åœ°å€    struct sockaddr_in bindaddr;    bindaddr.sin_family = AF_INET;    bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);    bindaddr.sin_port = htons(3000);    if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    //å¯åŠ¨ä¾¦å¬    if (listen(listenfd, SOMAXCONN) == -1)    &#123;        std::cout &lt;&lt; &quot;listen error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    //å¤ç”¨åœ°å€å’Œç«¯å£å·    int on = 1;    setsockopt(listenfd, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;on, sizeof(on));    setsockopt(listenfd, SOL_SOCKET, SO_REUSEPORT, (char *)&amp;on, sizeof(on));    //åˆ›å»ºepollfd    int epollfd = epoll_create(1);    if (epollfd == -1)    &#123;        std::cout &lt;&lt; &quot;create epollfd error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    epoll_event listen_fd_event;    listen_fd_event.events = POLLIN;    listen_fd_event.data.fd = listenfd;    //å°†ä¾¦å¬socketç»‘å®šåˆ°epollfdä¸Šå»    if(epoll_ctl(epollfd, EPOLL_CTL_ADD, listenfd, &amp;listen_fd_event) == -1)    &#123;        std::cout &lt;&lt; &quot;epoll_ctl error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    int n;    while (true)    &#123;               epoll_event epoll_events[1024];        n = epoll_wait(epollfd, epoll_events, 1024, 1000);        if (n &lt; 0)        &#123;            //è¢«ä¿¡å·ä¸­æ–­            if (errno == EINTR)                continue;            //å‡ºé”™ï¼Œé€€å‡º            break;        &#125;        else if (n == 0)        &#123;            //è¶…æ—¶ï¼Œç»§ç»­            continue;        &#125;        for (size_t i = 0; i &lt; n; ++i)        &#123;            // äº‹ä»¶å¯è¯»            if (epoll_events[i].events &amp; POLLIN)            &#123;                if (epoll_events[i].data.fd == listenfd)                &#123;                    //ä¾¦å¬socketï¼Œæ¥å—æ–°è¿æ¥                    struct sockaddr_in clientaddr;                    socklen_t clientaddrlen = sizeof(clientaddr);                    //æ¥å—å®¢æˆ·ç«¯è¿æ¥, å¹¶åŠ å…¥åˆ°fdsé›†åˆä¸­                    int clientfd = accept(listenfd, (struct sockaddr *)&amp;clientaddr, &amp;clientaddrlen);                    if (clientfd != -1)                    &#123;                        //å°†å®¢æˆ·ç«¯socketè®¾ç½®ä¸ºéé˜»å¡çš„                        int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);                        int newSocketFlag = oldSocketFlag | O_NONBLOCK;                        if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)                        &#123;                            close(clientfd);                            std::cout &lt;&lt; &quot;set clientfd to nonblock error.&quot; &lt;&lt; std::endl;                                                &#125;                        else                        &#123;                            epoll_event client_fd_event;                            client_fd_event.events = POLLIN;                            client_fd_event.data.fd = clientfd;                                                     if(epoll_ctl(epollfd, EPOLL_CTL_ADD, clientfd, &amp;client_fd_event) != -1)                            &#123;                                std::cout &lt;&lt; &quot;new client accepted, clientfd: &quot; &lt;&lt; clientfd &lt;&lt; std::endl;                            &#125;                            else                            &#123;                                std::cout &lt;&lt; &quot;add client fd to epollfd error.&quot; &lt;&lt; std::endl;                                close(clientfd);                                                        &#125;                        &#125;                           &#125;                &#125;                else                 &#123;                    //æ™®é€šclientfd,æ”¶å–æ•°æ®                    char buf[64] = &#123; 0 &#125;;                    int m = recv(epoll_events[i].data.fd, buf, 64, 0);                    if (m == 0)                    &#123;                        //å¯¹ç«¯å…³é—­äº†è¿æ¥ï¼Œä»epollfdä¸Šç§»é™¤clientfd                        if(epoll_ctl(epollfd, EPOLL_CTL_DEL, epoll_events[i].data.fd, NULL) != -1)                        &#123;                            std::cout &lt;&lt; &quot;client disconnected, clientfd: &quot; &lt;&lt; epoll_events[i].data.fd &lt;&lt; std::endl;                        &#125;                        close(epoll_events[i].data.fd);                    &#125;                    else if (m &lt; 0)                    &#123;                                                                   //å‡ºé”™ï¼Œä»epollfdä¸Šç§»é™¤clientfd                        if (errno != EWOULDBLOCK &amp;&amp; errno != EINTR)                        &#123;                            if(epoll_ctl(epollfd, EPOLL_CTL_DEL, epoll_events[i].data.fd, NULL) != -1)                            &#123;                                std::cout &lt;&lt; &quot;client disconnected, clientfd: &quot; &lt;&lt; epoll_events[i].data.fd &lt;&lt; std::endl;                            &#125;                            close(epoll_events[i].data.fd);                        &#125;                    &#125;                    else                    &#123;                        //æ­£å¸¸æ”¶åˆ°æ•°æ®                        std::cout &lt;&lt; &quot;recv from client: &quot; &lt;&lt; buf &lt;&lt; &quot;, clientfd: &quot; &lt;&lt; epoll_events[i].data.fd &lt;&lt; std::endl;                    &#125;                &#125;            &#125;            else if (epoll_events[i].events &amp; POLLERR)            &#123;                //TODO: æš‚ä¸”ä¸å¤„ç†            &#125;        &#125;// end  outer-for-loop    &#125;// end  while-loop    //å…³é—­ä¾¦å¬socket    //ï¼ˆç†è®ºä¸Šåº”è¯¥å…³é—­åŒ…æ‹¬æ‰€æœ‰clientfdåœ¨å†…çš„fdï¼Œä½†è¿™é‡Œåªæ˜¯ä¸ºäº†æ¼”ç¤ºé—®é¢˜ï¼Œå°±ä¸å†™é¢å¤–çš„ä»£ç æ¥å¤„ç†å•¦ï¼‰    close(listenfd);                return 0;&#125;\n\nç¼–è¯‘ä¸Šè¿°ç¨‹åºç”Ÿæˆ epoll_server å¹¶å¯åŠ¨ï¼Œç„¶åä½¿ç”¨ nc å‘½ä»¤å¯åŠ¨ä¸‰ä¸ªå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘æ•°æ®æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/Linuxepollæ¨¡å‹ï¼ˆå«LTæ¨¡å¼å’ŒETæ¨¡å¼è¯¦è§£ï¼‰","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"2a3c3c9ace4b4758d78bedda5e2402e0","title":"ã€è½¬è½½ã€‘TCPåè®®å¦‚ä½•è§£å†³ç²˜åŒ…ã€åŠåŒ…é—®é¢˜","content":"TCP åè®®å¦‚ä½•è§£å†³ç²˜åŒ…ã€åŠåŒ…é—®é¢˜ä¸€  TCP åè®®æ˜¯æµå¼åè®®å¾ˆå¤šè¯»è€…ä»æ¥è§¦ç½‘ç»œçŸ¥è¯†ä»¥æ¥ï¼Œåº”è¯¥å¬è¯´è¿‡è¿™å¥è¯ï¼šTCP åè®®æ˜¯æµå¼åè®®ã€‚é‚£ä¹ˆè¿™å¥è¯åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ‰€è°“æµå¼åè®®ï¼Œå³åè®®çš„å†…å®¹æ˜¯åƒæµæ°´ä¸€æ ·çš„å­—èŠ‚æµï¼Œå†…å®¹ä¸å†…å®¹ä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„åˆ†ç•Œæ ‡å¿—ï¼Œéœ€è¦æˆ‘ä»¬äººä¸ºåœ°å»ç»™è¿™äº›åè®®åˆ’åˆ†è¾¹ç•Œã€‚\nä¸¾ä¸ªä¾‹å­ï¼ŒA ä¸ B è¿›è¡Œ TCP é€šä¿¡ï¼ŒA å…ˆåç»™ B å‘é€äº†ä¸€ä¸ª 100 å­—èŠ‚å’Œ 200 å­—èŠ‚çš„æ•°æ®åŒ…ï¼Œé‚£ä¹ˆ B æ˜¯å¦‚ä½•æ”¶åˆ°å‘¢ï¼ŸB å¯èƒ½å…ˆæ”¶åˆ° 100 å­—èŠ‚ï¼Œå†æ”¶åˆ° 200 å­—èŠ‚ï¼›ä¹Ÿå¯èƒ½å…ˆæ”¶åˆ° 50 å­—èŠ‚ï¼Œå†æ”¶åˆ° 250 å­—èŠ‚ï¼›æˆ–è€…å…ˆæ”¶åˆ° 100 å­—èŠ‚ï¼Œå†æ”¶åˆ° 100 å­—èŠ‚ï¼Œå†æ”¶åˆ° 200 å­—èŠ‚ï¼›æˆ–è€…å…ˆæ”¶åˆ° 20 å­—èŠ‚ï¼Œå†æ”¶åˆ° 20 å­—èŠ‚ï¼Œå†æ”¶åˆ° 60 å­—èŠ‚ï¼Œå†æ”¶åˆ° 100 å­—èŠ‚ï¼Œå†æ”¶åˆ° 50 å­—èŠ‚ï¼Œå†æ”¶åˆ° 50 å­—èŠ‚â€¦â€¦\nä¸çŸ¥é“è¯»è€…çœ‹å‡ºè§„å¾‹æ²¡æœ‰ï¼Ÿè§„å¾‹å°±æ˜¯ A ä¸€å…±ç»™ B å‘é€äº† 300 å­—èŠ‚ï¼ŒB å¯èƒ½ä»¥ä¸€æ¬¡æˆ–è€…å¤šæ¬¡ä»»æ„å½¢å¼çš„æ€»æ•°ä¸º 300 å­—èŠ‚æ”¶åˆ°ã€‚å‡è®¾ A ç»™ B å‘é€çš„ 100 å­—èŠ‚å’Œ 200 å­—èŠ‚åˆ†åˆ«éƒ½æ˜¯ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¯¹äºå‘é€ç«¯ A æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯å¯ä»¥åŒºåˆ†çš„ï¼Œä½†æ˜¯å¯¹äº B æ¥è¯´ï¼Œå¦‚æœä¸äººä¸ºè§„å®šå¤šé•¿ä¸ºä¸€ä¸ªæ•°æ®åŒ…ï¼ŒB æ¯æ¬¡æ˜¯ä¸çŸ¥é“åº”è¯¥æŠŠæ”¶åˆ°çš„æ•°æ®ä¸­å¤šå°‘å­—èŠ‚ä½œä¸ºä¸€ä¸ªæœ‰æ•ˆçš„æ•°æ®åŒ…çš„ã€‚è€Œè§„å®šæ¯æ¬¡æŠŠå¤šå°‘æ•°æ®å½“æˆä¸€ä¸ªåŒ…å°±æ˜¯åè®®æ ¼å¼è§„èŒƒçš„å†…å®¹ä¹‹ä¸€ã€‚\nç»å¸¸ä¼šæœ‰æ–°æ‰‹å†™å‡ºç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š\nå‘é€ç«¯ï¼š\n1234//...çœç•¥åˆ›å»ºsocketï¼Œå»ºç«‹è¿æ¥ç­‰éƒ¨åˆ†ä¸ç›¸å…³çš„é€»è¾‘...char buf[] = &quot;the quick brown fox jumps over a lazy dog.&quot;;int n = send(socket, buf, strlen(buf), 0);//...çœç•¥å‡ºé”™å¤„ç†é€»è¾‘...\n\næ¥æ”¶ç«¯ï¼š\n12345//çœç•¥åˆ›å»ºsocketï¼Œå»ºç«‹è¿æ¥ç­‰éƒ¨åˆ†ä¸ç›¸å…³çš„é€»è¾‘...char recvBuf[50] = &#123; 0 &#125;;int n = recv(socket, recvBuf, 50, 0);//çœç•¥å‡ºé”™å¤„ç†é€»è¾‘...printf(&quot;recvBuf: %s&quot;, recvBuf);\n\nä¸ºäº†ä¸“æ³¨é—®é¢˜æœ¬èº«çš„è®¨è®ºï¼Œæˆ‘è¿™é‡Œçœç•¥æ‰äº†å»ºç«‹è¿æ¥å’Œéƒ¨åˆ†é”™è¯¯å¤„ç†çš„é€»è¾‘ã€‚ä¸Šè¿°ä»£ç ä¸­å‘é€ç«¯ç»™æ¥æ”¶ç«¯å‘é€äº†ä¸€ä¸²å­—ç¬¦â€the quick brown fox jumps over a lazy dog.â€œï¼Œæ¥æ”¶ç«¯æ”¶åˆ°åå°†å…¶æ‰“å°å‡ºæ¥ã€‚\nç±»ä¼¼è¿™æ ·çš„ä»£ç åœ¨æœ¬æœºä¸€èˆ¬ä¼šå·¥ä½œçš„å¾ˆå¥½ï¼Œæ¥æ”¶ç«¯ä¹Ÿå¦‚æœŸæ‰“å°å‡ºæ¥é¢„æ–™çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä¸€æ”¾åˆ°å±€åŸŸç½‘æˆ–è€…å…¬ç½‘ç¯å¢ƒå°±å‡ºé—®é¢˜äº†ï¼Œå³æ¥æ”¶ç«¯å¯èƒ½æ‰“å°å‡ºæ¥å­—ç¬¦ä¸²å¹¶ä¸å®Œæ•´ï¼›å¦‚æœå‘é€ç«¯è¿ç»­å¤šæ¬¡å‘é€å­—ç¬¦ä¸²ï¼Œæ¥æ”¶ç«¯ä¼šæ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²ä¸å®Œæ•´æˆ–å‡ºç°ä¹±ç ã€‚ä¸å®Œæ•´çš„åŸå› å¾ˆå¥½ç†è§£ï¼Œå³å¯¹ç«¯æŸæ¬¡æ”¶åˆ°çš„æ•°æ®å°äºå®Œæ•´å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ŒrecvBuf æ•°ç»„å¼€å§‹è¢«æ¸…ç©ºæˆ 0ï¼Œæ”¶åˆ°éƒ¨åˆ†å­—ç¬¦ä¸²åï¼Œè¯¥å­—ç¬¦ä¸²çš„æœ«å°¾ä»ç„¶æ˜¯ 0ï¼Œprintf å‡½æ•°å¯»æ‰¾ä»¥ 0 ä¸ºç»“æŸæ ‡å¿—çš„å­—ç¬¦ç»“æŸè¾“å‡ºï¼›ä¹±ç çš„åŸå› æ˜¯å¦‚æœæŸæ¬¡æ”¶å…¥çš„æ•°æ®ä¸ä»…åŒ…å«ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼Œè¿˜åŒ…å«ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²éƒ¨åˆ†å†…å®¹ï¼Œé‚£ä¹ˆ recvBuf æ•°ç»„å°†ä¼šè¢«å¡«æ»¡ï¼Œprintf å‡½æ•°è¾“å‡ºæ—¶ä»ç„¶ä¼šå¯»æ‰¾ä»¥ 0 ä¸ºç»“æŸæ ‡å¿—çš„å­—ç¬¦ç»“æŸè¾“å‡ºï¼Œè¿™æ ·è¯»å–çš„å†…å­˜å°±è¶Šç•Œäº†ï¼Œä¸€ç›´æ‰¾åˆ°ä¸ºæ­¢ï¼Œè€Œè¶Šç•Œåçš„å†…å­˜å¯èƒ½æ˜¯ä¸€äº›ä¸å¯è¯»å­—ç¬¦ï¼Œæ˜¾ç¤ºå‡ºæ¥åå°±ä¹±ç äº†ã€‚\næˆ‘ä¸¾è¿™ä¸ªä¾‹å­å¸Œæœ›ä½ æ˜ç™½ èƒ½å¯¹TCP åè®®æ˜¯æµå¼åè®®æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦äººä¸ºåœ°åœ¨å‘é€ç«¯å’Œæ¥æ”¶ç«¯è§„å®šæ¯ä¸€æ¬¡çš„å­—èŠ‚æµè¾¹ç•Œï¼Œä»¥ä¾¿æ¥æ”¶ç«¯çŸ¥é“ä»ä»€ä¹ˆä½ç½®å–å‡ºå¤šå°‘å­—èŠ‚æ¥å½“æˆä¸€ä¸ªæ•°æ®åŒ…å»è§£æï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è®¾è®¡ç½‘ç»œé€šä¿¡åè®®æ ¼å¼çš„è¦åšçš„å·¥ä½œä¹‹ä¸€ã€‚\näºŒ å¦‚ä½•è§£å†³ç²˜åŒ…é—®é¢˜ç½‘ç»œé€šä¿¡ç¨‹åºå®é™…å¼€å‘ä¸­ï¼Œæˆ–è€…æŠ€æœ¯é¢è¯•æ—¶ï¼Œé¢è¯•å®˜é€šå¸¸ä¼šé—®çš„æ¯”è¾ƒå¤šçš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šç½‘ç»œé€šä¿¡æ—¶ï¼Œå¦‚ä½•è§£å†³ç²˜åŒ…ï¼Ÿ\n\næœ‰çš„é¢è¯•å®˜å¯èƒ½ä¼šè¿™ä¹ˆé—®ï¼šç½‘ç»œé€šä¿¡æ—¶ï¼Œå¦‚ä½•è§£å†³ç²˜åŒ…ã€ä¸¢åŒ…æˆ–è€…åŒ…ä¹±åºé—®é¢˜ï¼Ÿè¿™ä¸ªé—®é¢˜å…¶å®æ˜¯é¢è¯•å®˜åœ¨è€ƒå¯Ÿé¢è¯•è€…çš„ç½‘ç»œåŸºç¡€çŸ¥è¯†ï¼Œå¦‚æœæ˜¯ TCP åè®®ï¼Œåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œæ˜¯ä¸å­˜åœ¨ä¸¢åŒ…å’ŒåŒ…ä¹±åºé—®é¢˜çš„ï¼ŒTCP é€šä¿¡æ˜¯å¯é é€šä¿¡æ–¹å¼ï¼ŒTCP åè®®æ ˆé€šè¿‡åºåˆ—å·å’ŒåŒ…é‡ä¼ ç¡®è®¤æœºåˆ¶ä¿è¯æ•°æ®åŒ…çš„æœ‰åºå’Œä¸€å®šè¢«æ­£ç¡®å‘åˆ°ç›®çš„åœ°ï¼›å¦‚æœæ˜¯ UDP åè®®ï¼Œå¦‚æœä¸èƒ½æ¥å—å°‘é‡ä¸¢åŒ…ï¼Œé‚£å°±è¦è‡ªå·±åœ¨ UDP çš„åŸºç¡€ä¸Šå®ç°ç±»ä¼¼ TCP è¿™ç§æœ‰åºå’Œå¯é ä¼ è¾“æœºåˆ¶äº†ï¼ˆä¾‹å¦‚ RTPåè®®ã€RUDP åè®®ï¼‰ã€‚æ‰€ä»¥ï¼Œé—®é¢˜æ‹†è§£åï¼Œåªå‰©ä¸‹å¦‚ä½•è§£å†³ç²˜åŒ…çš„é—®é¢˜ã€‚\n\nå…ˆæ¥è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ç²˜åŒ…ï¼Œæ‰€è°“ç²˜åŒ…å°±æ˜¯è¿ç»­ç»™å¯¹ç«¯å‘é€ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šçš„æ•°æ®åŒ…ï¼Œå¯¹ç«¯åœ¨ä¸€æ¬¡æ”¶å–ä¸­å¯èƒ½æ”¶åˆ°çš„æ•°æ®åŒ…å¤§äº 1 ä¸ªï¼Œå¤§äº 1 ä¸ªï¼Œå¯èƒ½æ˜¯å‡ ä¸ªï¼ˆåŒ…æ‹¬ä¸€ä¸ªï¼‰åŒ…åŠ ä¸ŠæŸä¸ªåŒ…çš„éƒ¨åˆ†ï¼Œæˆ–è€…å¹²è„†å°±æ˜¯å‡ ä¸ªå®Œæ•´çš„åŒ…åœ¨ä¸€èµ·ã€‚å½“ç„¶ï¼Œä¹Ÿå¯èƒ½æ”¶åˆ°çš„æ•°æ®åªæ˜¯ä¸€ä¸ªåŒ…çš„éƒ¨åˆ†ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬ä¹Ÿå«åŠåŒ…ã€‚\næ— è®ºæ˜¯åŠåŒ…è¿˜æ˜¯ç²˜åŒ…é—®é¢˜ï¼Œå…¶æ ¹æºæ˜¯ä¸Šæ–‡ä»‹ç»ä¸­ TCP åè®®æ˜¯æµå¼æ•°æ®æ ¼å¼ã€‚è§£å†³é—®é¢˜çš„æ€è·¯è¿˜æ˜¯æƒ³åŠæ³•ä»æ”¶åˆ°çš„æ•°æ®ä¸­æŠŠåŒ…ä¸åŒ…çš„è¾¹ç•Œç»™åŒºåˆ†å‡ºæ¥ã€‚é‚£ä¹ˆå¦‚ä½•åŒºåˆ†å‘¢ï¼Ÿç›®å‰ä¸»è¦æœ‰ä¸‰ç§æ–¹æ³•ï¼š\nå›ºå®šåŒ…é•¿çš„æ•°æ®åŒ…\né¡¾åæ€ä¹‰ï¼Œå³æ¯ä¸ªåè®®åŒ…çš„é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥è§„å®šæ¯ä¸ªåè®®åŒ…çš„å¤§å°æ˜¯ 64 ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡æ”¶æ»¡ 64 ä¸ªå­—èŠ‚ï¼Œå°±å–å‡ºæ¥è§£æï¼ˆå¦‚æœä¸å¤Ÿï¼Œå°±å…ˆå­˜èµ·æ¥ï¼‰ã€‚\nè¿™ç§é€šä¿¡åè®®çš„æ ¼å¼ç®€å•ä½†çµæ´»æ€§å·®ã€‚å¦‚æœåŒ…å†…å®¹ä¸è¶³æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå‰©ä½™çš„ç©ºé—´éœ€è¦å¡«å……ç‰¹æ®Šçš„ä¿¡æ¯ï¼Œå¦‚ \\0ï¼ˆå¦‚æœä¸å¡«å……ç‰¹æ®Šå†…å®¹ï¼Œå¦‚ä½•åŒºåˆ†åŒ…é‡Œé¢çš„æ­£å¸¸å†…å®¹ä¸å¡«å……ä¿¡æ¯å‘¢ï¼Ÿï¼‰ï¼›å¦‚æœåŒ…å†…å®¹è¶…è¿‡æŒ‡å®šå­—èŠ‚æ•°ï¼Œåˆå¾—åˆ†åŒ…åˆ†ç‰‡ï¼Œéœ€è¦å¢åŠ é¢å¤–å¤„ç†é€»è¾‘â€”â€”åœ¨å‘é€ç«¯è¿›è¡Œåˆ†åŒ…åˆ†ç‰‡ï¼Œåœ¨æ¥æ”¶ç«¯é‡æ–°ç»„è£…åŒ…ç‰‡ï¼ˆåˆ†åŒ…å’Œåˆ†ç‰‡å†…å®¹åœ¨æ¥ä¸‹æ¥ä¼šè¯¦ç»†ä»‹ç»ï¼‰ã€‚\nä»¥æŒ‡å®šå­—ç¬¦ï¼ˆä¸²ï¼‰ä¸ºåŒ…çš„ç»“æŸæ ‡å¿—\nè¿™ç§åè®®åŒ…æ¯”è¾ƒå¸¸è§ï¼Œå³å­—èŠ‚æµä¸­é‡åˆ°ç‰¹æ®Šçš„ç¬¦å·å€¼æ—¶å°±è®¤ä¸ºåˆ°ä¸€ä¸ªåŒ…çš„æœ«å°¾äº†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰çš„ FTPåè®®ï¼Œå‘é‚®ä»¶çš„ SMTP åè®®ï¼Œä¸€ä¸ªå‘½ä»¤æˆ–è€…ä¸€æ®µæ•°æ®åé¢åŠ ä¸Šâ€\\r\\nâ€ï¼ˆå³æ‰€è°“çš„ CRLFï¼‰è¡¨ç¤ºä¸€ä¸ªåŒ…çš„ç»“æŸã€‚å¯¹ç«¯æ”¶åˆ°åï¼Œæ¯é‡åˆ°ä¸€ä¸ªâ€\\r\\nâ€œå°±æŠŠä¹‹å‰çš„æ•°æ®å½“åšä¸€ä¸ªæ•°æ®åŒ…ã€‚\nè¿™ç§åè®®ä¸€èˆ¬ç”¨äºä¸€äº›åŒ…å«å„ç§å‘½ä»¤æ§åˆ¶çš„åº”ç”¨ä¸­ï¼Œå…¶ä¸è¶³ä¹‹å¤„å°±æ˜¯å¦‚æœåè®®æ•°æ®åŒ…å†…å®¹éƒ¨åˆ†éœ€è¦ä½¿ç”¨åŒ…ç»“æŸæ ‡å¿—å­—ç¬¦ï¼Œå°±éœ€è¦å¯¹è¿™äº›å­—ç¬¦åšè½¬ç æˆ–è€…è½¬ä¹‰æ“ä½œï¼Œä»¥å…è¢«æ¥æ”¶æ–¹é”™è¯¯åœ°å½“æˆåŒ…ç»“æŸæ ‡å¿—è€Œè¯¯è§£æã€‚\nåŒ…å¤´ + åŒ…ä½“æ ¼å¼\nè¿™ç§æ ¼å¼çš„åŒ…ä¸€èˆ¬åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³åŒ…å¤´å’ŒåŒ…ä½“ï¼ŒåŒ…å¤´æ˜¯å›ºå®šå¤§å°çš„ï¼Œä¸”åŒ…å¤´ä¸­å¿…é¡»å«æœ‰ä¸€ä¸ªå­—æ®µæ¥è¯´æ˜æ¥ä¸‹æ¥çš„åŒ…ä½“æœ‰å¤šå¤§ã€‚\nä¾‹å¦‚ï¼š\n12345struct msg_header&#123;  int32_t bodySize;  int32_t cmd;&#125;;\n\nè¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„åŒ…å¤´æ ¼å¼ï¼ŒbodySize æŒ‡å®šäº†è¿™ä¸ªåŒ…çš„åŒ…ä½“æ˜¯å¤šå¤§ã€‚ç”±äºåŒ…å¤´å¤§å°æ˜¯å›ºå®šçš„ï¼ˆè¿™é‡Œæ˜¯ size(int32_t) + sizeof(int32_t) &#x3D; 8 å­—èŠ‚ï¼‰ï¼Œå¯¹ç«¯å…ˆæ”¶å–åŒ…å¤´å¤§å°å­—èŠ‚æ•°ç›®ï¼ˆå½“ç„¶ï¼Œå¦‚æœä¸å¤Ÿè¿˜æ˜¯å…ˆç¼“å­˜èµ·æ¥ï¼Œç›´åˆ°æ”¶å¤Ÿä¸ºæ­¢ï¼‰ï¼Œç„¶åè§£æåŒ…å¤´ï¼Œæ ¹æ®åŒ…å¤´ä¸­æŒ‡å®šçš„åŒ…ä½“å¤§å°æ¥æ”¶å–åŒ…ä½“ï¼Œç­‰åŒ…ä½“æ”¶å¤Ÿäº†ï¼Œå°±ç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„åŒ…æ¥å¤„ç†ã€‚åœ¨æœ‰äº›å®ç°ä¸­ï¼ŒåŒ…å¤´ä¸­çš„ bodySizeå¯èƒ½è¢«å¦å¤–ä¸€ä¸ªå« packageSize çš„å­—æ®µä»£æ›¿ï¼Œè¿™ä¸ªå­—æ®µçš„å«ä¹‰æ˜¯æ•´ä¸ªåŒ…çš„å¤§å°ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªè¦ç”¨ packageSize å‡å»åŒ…å¤´å¤§å°ï¼ˆè¿™é‡Œæ˜¯ sizeof(msg_header)ï¼‰å°±èƒ½ç®—å‡ºåŒ…ä½“çš„å¤§å°ï¼ŒåŸç†åŒä¸Šã€‚\n\nåœ¨ä½¿ç”¨å¤§å¤šæ•°ç½‘ç»œåº“æ—¶ï¼Œé€šå¸¸ä½ éœ€è¦æ ¹æ®åè®®æ ¼å¼è‡ªå·±ç»™æ•°æ®åŒ…åˆ†ç•Œå’Œè§£æï¼Œä¸€èˆ¬çš„ç½‘ç»œåº“ä¸æä¾›è¿™ç§åŠŸèƒ½æ˜¯å‡ºäºéœ€è¦æ”¯æŒä¸åŒçš„åè®®ï¼Œç”±äºåè®®çš„ä¸ç¡®å®šæ€§ï¼Œå› æ­¤æ²¡æ³•é¢„å…ˆæä¾›å…·ä½“è§£åŒ…ä»£ç ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯ç»å¯¹çš„ï¼Œä¹Ÿæœ‰ä¸€äº›ç½‘ç»œåº“æä¾›äº†è¿™ç§åŠŸèƒ½ã€‚åœ¨ Java Netty ç½‘ç»œæ¡†æ¶ä¸­ï¼Œæä¾›äº†FixedLengthFrameDecoder ç±»å»å¤„ç†é•¿åº¦æ˜¯å®šé•¿çš„åè®®åŒ…ï¼Œæä¾›äº† DelimiterBasedFrameDecoder ç±»å»å¤„ç†æŒ‰ç‰¹æ®Šå­—ç¬¦ä½œä¸ºç»“æŸç¬¦çš„åè®®åŒ…ï¼Œæä¾› ByteToMessageDecoder å»å¤„ç†è‡ªå®šä¹‰æ ¼å¼çš„åè®®åŒ…ï¼ˆå¯ç”¨æ¥å¤„ç†åŒ…å¤´ + åŒ…ä½“ è¿™ç§æ ¼å¼çš„æ•°æ®åŒ…ï¼‰ï¼Œç„¶è€Œåœ¨ç»§æ‰¿ ByteToMessageDecoder  å­ç±»ä¸­ä½ éœ€è¦æ ¹æ®ä½ çš„åè®®å…·ä½“æ ¼å¼é‡å†™ decode() æ–¹æ³•æ¥å¯¹æ•°æ®åŒ…è§£åŒ…ã€‚\n\nè¿™ä¸‰ç§åŒ…æ ¼å¼ï¼Œå¸Œæœ›è¯»è€…èƒ½åœ¨ç†è§£å…¶åŸç†å’Œä¼˜ç¼ºç‚¹çš„åŸºç¡€ä¸Šæ·±å…¥æŒæ¡ã€‚\nä¸‰ è§£åŒ…ä¸å¤„ç†åœ¨ç†è§£äº†å‰é¢ä»‹ç»çš„æ•°æ®åŒ…çš„ä¸‰ç§æ ¼å¼åï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹é’ˆå¯¹ä¸Šè¿°ä¸‰ç§æ ¼å¼çš„æ•°æ®åŒ…æŠ€æœ¯ä¸Šåº”è¯¥å¦‚ä½•å¤„ç†ã€‚å…¶å¤„ç†æµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥åŒ…å¤´ + åŒ…ä½“ è¿™ç§æ ¼å¼çš„æ•°æ®åŒ…æ¥è¯´æ˜ã€‚å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š\n\nå‡è®¾æˆ‘ä»¬çš„åŒ…å¤´æ ¼å¼å¦‚ä¸‹ï¼š\n12345678//å¼ºåˆ¶ä¸€å­—èŠ‚å¯¹é½#pragma pack(push, 1)//åè®®å¤´struct msg&#123;       int32_t  bodysize;         //åŒ…ä½“å¤§å°  &#125;;#pragma pack(pop)\n\né‚£ä¹ˆä¸Šé¢çš„æµç¨‹å®ç°ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546//åŒ…æœ€å¤§å­—èŠ‚æ•°é™åˆ¶ä¸º10M#define MAX_PACKAGE_SIZE    10 * 1024 * 1024void ChatSession::OnRead(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn, Buffer* pBuffer, Timestamp receivTime)&#123;    while (true)    &#123;        //ä¸å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°        if (pBuffer-&gt;readableBytes() &lt; (size_t)sizeof(msg))        &#123;            //LOGI &lt;&lt; &quot;buffer is not enough for a package header, pBuffer-&gt;readableBytes()=&quot; &lt;&lt; pBuffer-&gt;readableBytes() &lt;&lt; &quot;, sizeof(msg)=&quot; &lt;&lt; sizeof(msg);            return;        &#125;        //å–åŒ…å¤´ä¿¡æ¯        msg header;        memcpy(&amp;header, pBuffer-&gt;peek(), sizeof(msg));        //åŒ…å¤´æœ‰é”™è¯¯ï¼Œç«‹å³å…³é—­è¿æ¥        if (header.bodysize &lt;= 0 || header.bodysize &gt; MAX_PACKAGE_SIZE)        &#123;            //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹            LOGE(&quot;Illegal package, bodysize: %lld, close TcpConnection, client: %s&quot;, header.bodysize, conn-&gt;peerAddress().toIpPort().c_str());            conn-&gt;forceClose();            return;        &#125;        //æ”¶åˆ°çš„æ•°æ®ä¸å¤Ÿä¸€ä¸ªå®Œæ•´çš„åŒ…        if (pBuffer-&gt;readableBytes() &lt; (size_t)header.bodysize + sizeof(msg))            return;        pBuffer-&gt;retrieve(sizeof(msg));        //inbufç”¨æ¥å­˜æ”¾å½“å‰è¦å¤„ç†çš„åŒ…        std::string inbuf;        inbuf.append(pBuffer-&gt;peek(), header.bodysize);        pBuffer-&gt;retrieve(header.bodysize);                  //è§£åŒ…å’Œä¸šåŠ¡å¤„ç†        if (!Process(conn, inbuf.c_str(), inbuf.length()))        &#123;            //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹            LOGE(&quot;Process package error, close TcpConnection, client: %s&quot;, conn-&gt;peerAddress().toIpPort().c_str());            conn-&gt;forceClose();            return;        &#125;                  &#125;// end while-loop&#125;\n\nä¸Šè¿°æµç¨‹ä»£ç çš„å¤„ç†è¿‡ç¨‹å’Œæµç¨‹å›¾ä¸­æ˜¯ä¸€è‡´çš„ï¼ŒpBuffer è¿™é‡Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¥æ”¶ç¼“å†²åŒºï¼Œè¿™é‡Œçš„ä»£ç ï¼Œå·²ç»å°†æ”¶åˆ°çš„æ•°æ®æ”¾å…¥äº†è¿™ä¸ªç¼“å†²åŒºï¼Œæ‰€ä»¥åˆ¤æ–­å½“å‰å·²æ”¶å–çš„å­—èŠ‚æ•°ç›®åªéœ€è¦ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„ç›¸åº”æ–¹æ³•å³å¯ã€‚ä¸Šè¿°ä»£ç æœ‰äº›ç»†èŠ‚æˆ‘éœ€è¦å¼ºè°ƒä¸€ä¸‹ï¼š\n\nå–åŒ…å¤´æ—¶ï¼Œä½ åº”è¯¥æ‹·è´ä¸€ä»½æ•°æ®åŒ…å¤´å¤§å°çš„æ•°æ®å‡ºæ¥ï¼Œè€Œä¸æ˜¯ä»ç¼“å†²åŒº pBuffer ä¸­ç›´æ¥å°†æ•°æ®å–å‡ºæ¥ï¼ˆå³å–å‡ºæ¥çš„æ•°æ®ä» pBuffer ä¸­ç§»é™¤ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºå€˜è‹¥æ¥ä¸‹æ¥æ ¹æ®åŒ…å¤´ä¸­çš„å­—æ®µå¾—åˆ°åŒ…ä½“å¤§å°æ—¶ï¼Œå¦‚æœå‰©ä½™æ•°æ®ä¸å¤Ÿä¸€ä¸ªåŒ…ä½“å¤§å°ï¼Œä½ åˆå¾—æŠŠè¿™ä¸ªåŒ…å¤´æ•°æ®æ”¾å›ç¼“å†²åŒºã€‚ä¸ºäº†é¿å…è¿™ç§ä¸å¿…è¦çš„æ“ä½œï¼Œåªæœ‰ç¼“å†²åŒºæ•°æ®å¤§å°å¤Ÿæ•´ä¸ªåŒ…çš„å¤§å°ï¼ˆä»£ç ä¸­ï¼šheader.bodysize + sizeof(msg)ï¼‰ä½ æ‰éœ€è¦æŠŠæ•´ä¸ªåŒ…å¤§å°çš„æ•°æ®ä»ç¼“å†²åŒºç§»é™¤ï¼Œè¿™ä¹Ÿæ˜¯è¿™é‡Œçš„ pBuffer-&gt;peek() æ–¹æ³• peek å•è¯çš„å«ä¹‰ï¼ˆä¸­æ–‡å¯ä»¥ç¿»è¯‘æˆâ€œçŸä¸€çœ¼â€æˆ–è€…â€œå·çª¥â€ï¼‰ã€‚\né€šè¿‡åŒ…å¤´å¾—åˆ°åŒ…ä½“å¤§å°æ—¶ï¼Œä½ ä¸€å®šè¦å¯¹ bodysize çš„æ•°å€¼è¿›è¡Œæ ¡éªŒï¼Œæˆ‘è¿™é‡Œè¦æ±‚ bodysize å¿…é¡»å¤§äº 0 ä¸”ä¸å¤§äº 10 * 1024 * 1024ï¼ˆå³ 10 Mï¼‰ã€‚å½“ç„¶ï¼Œå®é™…å¼€å‘ä¸­ï¼Œä½ å¯ä»¥æ ¹æ®ä½ è‡ªå·±çš„éœ€æ±‚è¦å†³å®š bodysize çš„ä¸Šä¸‹é™ï¼ˆåŒ…ä½“å¤§å°æ˜¯ 0 å­—èŠ‚çš„åŒ…åœ¨æŸäº›ä¸šåŠ¡åœºæ™¯ä¸‹æ˜¯å…è®¸çš„ï¼‰ã€‚è®°ä½ï¼Œä¸€å®šè¦åˆ¤æ–­è¿™ä¸ªä¸Šä¸‹é™ï¼Œå› ä¸ºå‡è®¾è¿™æ˜¯ä¸€ä¸ªéæ³•çš„å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œå…¶ bodysize è®¾ç½®äº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ•°å€¼ï¼Œä¾‹å¦‚ 1 * 1024 * 1024 * 1024ï¼ˆå³ 1 Gï¼‰ï¼Œä½ çš„é€»è¾‘ä¼šè®©ä½ ä¸€ç›´ç¼“å­˜è¯¥å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œé‚£ä¹ˆå¾ˆå¿«ä½ çš„æœåŠ¡å™¨å†…å­˜å°†ä¼šè¢«è€—å°½ï¼Œæ“ä½œç³»ç»Ÿåœ¨æ£€æµ‹åˆ°ä½ çš„è¿›ç¨‹å ç”¨å†…å­˜è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ä¼šæ€æ­»ä½ çš„è¿›ç¨‹ï¼Œå¯¼è‡´æœåŠ¡ä¸èƒ½å†æ­£å¸¸å¯¹å¤–æœåŠ¡ã€‚å¦‚æœä½ æ£€æµ‹äº† bodysize å­—æ®µçš„æ˜¯å¦æ»¡è¶³ä½ è®¾ç½®çš„ä¸Šä¸‹é™ï¼Œå¯¹äºéæ³•çš„ bodysizeï¼Œç›´æ¥å…³é—­è¿™è·¯è¿æ¥å³å¯ã€‚è¿™ä¹Ÿæ˜¯æœåŠ¡çš„ä¸€ç§è‡ªæˆ‘ä¿æŠ¤æªæ–½ï¼Œé¿å…å› ä¸ºéæ³•æ•°æ®åŒ…å¸¦æ¥çš„æŸå¤±ã€‚\nä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°æ•´ä¸ªåˆ¤æ–­åŒ…å¤´ã€åŒ…ä½“ä»¥åŠå¤„ç†åŒ…çš„é€»è¾‘æ”¾åœ¨ä¸€ä¸ª while å¾ªç¯é‡Œé¢ï¼Œè¿™æ˜¯å¿…è¦çš„ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ª while å¾ªç¯ï¼Œå½“ä½ ä¸€æ¬¡æ€§æ”¶åˆ°å¤šä¸ªåŒ…æ—¶ï¼Œä½ åªä¼šå¤„ç†ä¸€ä¸ªï¼Œä¸‹æ¬¡æ¥ç€å¤„ç†å°±éœ€è¦ç­‰åˆ°æ–°ä¸€æ‰¹æ•°æ®æ¥ä¸´æ—¶å†æ¬¡è§¦å‘è¿™ä¸ªé€»è¾‘ã€‚è¿™æ ·é€ æˆçš„ç»“æœå°±æ˜¯ï¼Œå¯¹ç«¯ç»™ä½ å‘é€äº†å¤šä¸ªè¯·æ±‚ï¼Œä½ æœ€å¤šåªèƒ½åº”ç­”ä¸€ä¸ªï¼Œåé¢çš„åº”ç­”å¾—ç­‰åˆ°å¯¹ç«¯å†æ¬¡ç»™ä½ å‘é€æ•°æ®æ—¶ã€‚è¿™å°±æ˜¯å¯¹ç²˜åŒ…é€»è¾‘çš„æ­£ç¡®å¤„ç†ã€‚\n\nä»¥ä¸Šé€»è¾‘å’Œä»£ç æ˜¯æœ€åŸºæœ¬çš„ç²˜åŒ…å’ŒåŠåŒ…å¤„ç†æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æŠ€æœ¯ä¸Šçš„è§£åŒ…å¤„ç†é€»è¾‘ï¼ˆä¸šåŠ¡ä¸Šçš„è§£åŒ…å¤„ç†é€»è¾‘åé¢ç« èŠ‚å†ä»‹ç»ï¼‰ã€‚å¸Œæœ›è¯»è€…èƒ½ç†è§£ä»–ä»¬ï¼Œåœ¨ç†è§£äº†ä»–ä»¬çš„åŸºç¡€ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç»™è§£åŒ…æ‹“å±•å¾ˆå¤šåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å†ç»™æˆ‘ä»¬çš„åè®®åŒ…å¢åŠ ä¸€ä¸ªæ”¯æŒå‹ç¼©çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬çš„åŒ…å¤´å˜æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š\n12345678910#pragma pack(push, 1)//åè®®å¤´struct msg&#123;    char     compressflag;     //å‹ç¼©æ ‡å¿—ï¼Œå¦‚æœä¸º1ï¼Œåˆ™å¯ç”¨å‹ç¼©ï¼Œåä¹‹ä¸å¯ç”¨å‹ç¼©    int32_t  originsize;       //åŒ…ä½“å‹ç¼©å‰å¤§å°    int32_t  compresssize;     //åŒ…ä½“å‹ç¼©åå¤§å°    char     reserved[16];       //ä¿ç•™å­—æ®µï¼Œç”¨äºå°†æ¥æ‹“å±•&#125;;#pragma pack(pop)\n\nä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485void ChatSession::OnRead(const std::shared_ptr&lt;TcpConnection&gt;&amp; conn, Buffer* pBuffer, Timestamp receivTime)&#123;    while (true)    &#123;        //ä¸å¤Ÿä¸€ä¸ªåŒ…å¤´å¤§å°        if (pBuffer-&gt;readableBytes() &lt; (size_t)sizeof(msg))        &#123;            //LOGI &lt;&lt; &quot;buffer is not enough for a package header, pBuffer-&gt;readableBytes()=&quot; &lt;&lt; pBuffer-&gt;readableBytes() &lt;&lt; &quot;, sizeof(msg)=&quot; &lt;&lt; sizeof(msg);            return;        &#125;        //å–åŒ…å¤´ä¿¡æ¯        msg header;        memcpy(&amp;header, pBuffer-&gt;peek(), sizeof(msg));        //æ•°æ®åŒ…å‹ç¼©è¿‡        if (header.compressflag == PACKAGE_COMPRESSED)        &#123;            //åŒ…å¤´æœ‰é”™è¯¯ï¼Œç«‹å³å…³é—­è¿æ¥            if (header.compresssize &lt;= 0 || header.compresssize &gt; MAX_PACKAGE_SIZE ||                header.originsize &lt;= 0 || header.originsize &gt; MAX_PACKAGE_SIZE)            &#123;                //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹                LOGE(&quot;Illegal package, compresssize: %lld, originsize: %lld, close TcpConnection, client: %s&quot;,  header.compresssize, header.originsize, conn-&gt;peerAddress().toIpPort().c_str());                conn-&gt;forceClose();                return;            &#125;            //æ”¶åˆ°çš„æ•°æ®ä¸å¤Ÿä¸€ä¸ªå®Œæ•´çš„åŒ…            if (pBuffer-&gt;readableBytes() &lt; (size_t)header.compresssize + sizeof(msg))                return;            pBuffer-&gt;retrieve(sizeof(msg));            std::string inbuf;            inbuf.append(pBuffer-&gt;peek(), header.compresssize);            pBuffer-&gt;retrieve(header.compresssize);            std::string destbuf;            if (!ZlibUtil::UncompressBuf(inbuf, destbuf, header.originsize))            &#123;                LOGE(&quot;uncompress error, client: %s&quot;, conn-&gt;peerAddress().toIpPort().c_str());                conn-&gt;forceClose();                return;            &#125;            //ä¸šåŠ¡é€»è¾‘å¤„ç†            if (!Process(conn, destbuf.c_str(), destbuf.length()))            &#123;                //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹                LOGE(&quot;Process error, close TcpConnection, client: %s&quot;, conn-&gt;peerAddress().toIpPort().c_str());                conn-&gt;forceClose();                return;            &#125;        &#125;        //æ•°æ®åŒ…æœªå‹ç¼©        else        &#123;            //åŒ…å¤´æœ‰é”™è¯¯ï¼Œç«‹å³å…³é—­è¿æ¥            if (header.originsize &lt;= 0 || header.originsize &gt; MAX_PACKAGE_SIZE)            &#123;                //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹                LOGE(&quot;Illegal package, compresssize: %lld, originsize: %lld, close TcpConnection, client: %s&quot;, header.compresssize, header.originsize, conn-&gt;peerAddress().toIpPort().c_str());                conn-&gt;forceClose();                return;            &#125;            //æ”¶åˆ°çš„æ•°æ®ä¸å¤Ÿä¸€ä¸ªå®Œæ•´çš„åŒ…            if (pBuffer-&gt;readableBytes() &lt; (size_t)header.originsize + sizeof(msg))                return;            pBuffer-&gt;retrieve(sizeof(msg));            std::string inbuf;            inbuf.append(pBuffer-&gt;peek(), header.originsize);            pBuffer-&gt;retrieve(header.originsize);            //ä¸šåŠ¡é€»è¾‘å¤„ç†            if (!Process(conn, inbuf.c_str(), inbuf.length()))            &#123;                //å®¢æˆ·ç«¯å‘éæ³•æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å…³é—­ä¹‹                LOGE(&quot;Process error, close TcpConnection, client: %s&quot;, conn-&gt;peerAddress().toIpPort().c_str());                conn-&gt;forceClose();                return;            &#125;        &#125;// end else    &#125;// end while-loop&#125;\n\nè¿™æ®µä»£ç å…ˆæ ¹æ®åŒ…å¤´çš„å‹ç¼©æ ‡å¿—å­—æ®µåˆ¤æ–­åŒ…ä½“æ˜¯å¦æœ‰å‹ç¼©ï¼Œå¦‚æœæœ‰å‹ç¼©ï¼Œåˆ™å–å‡ºåŒ…ä½“å¤§å°å»è§£å‹ï¼Œè§£å‹åçš„æ•°æ®æ‰æ˜¯çœŸæ­£çš„ä¸šåŠ¡æ•°æ®ã€‚æ•´ä¸ªç¨‹åºæ‰§è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/TCPåè®®å¦‚ä½•è§£å†³ç²˜åŒ…ã€åŠåŒ…é—®é¢˜","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"a48f84a55618baa7dd151ec12f4ef58e","title":"ã€è½¬è½½ã€‘bindå‡½æ•°é‡éš¾ç‚¹è§£æ","content":"bind å‡½æ•°é‡éš¾ç‚¹è§£æbind å‡½æ•°å¦‚ä½•é€‰æ‹©ç»‘å®šåœ°å€bind å‡½æ•°çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š\n123456789struct sockaddr_in bindaddr;bindaddr.sin_family = AF_INET;bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);bindaddr.sin_port = htons(3000);if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)&#123;    std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;    return -1;&#125;\n\nå…¶ä¸­ bind çš„åœ°å€æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå®å« INADDR_ANY ï¼Œå…³äºè¿™ä¸ªå®çš„è§£é‡Šå¦‚ä¸‹ï¼š\n12345678If an application does not care what local address is assigned, specify the constant value INADDR_ANY for an IPv4 local addressor the constant value in6addr_any for an IPv6 local address in the sa_data member of the name parameter. This allows the underlying service provider to use any appropriate network address,potentially simplifying application programming in the presence of multihomed hosts (that is, hosts that have more than one network interface and address).\n\næ„è¯‘ä¸€ä¸‹ï¼š\n123å¦‚æœåº”ç”¨ç¨‹åºä¸å…³å¿ƒbindç»‘å®šçš„ipåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨INADDR_ANY(å¦‚æœæ˜¯IPv6ï¼Œåˆ™å¯¹åº”in6addr_any)ï¼Œè¿™æ ·åº•å±‚çš„ï¼ˆåè®®æ ˆï¼‰æœåŠ¡ä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ipåœ°å€ï¼Œè¿™æ ·ä½¿åœ¨ä¸€ä¸ªæœ‰å¤šä¸ªç½‘å¡æœºå™¨ä¸Šé€‰æ‹©ipåœ°å€é—®é¢˜å˜å¾—ç®€å•ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ INADDR_ANY ç›¸å½“äºåœ°å€ 0.0.0.0ã€‚å¯èƒ½è¯»è€…è¿˜æ˜¯ä¸å¤ªæ˜ç™½æˆ‘æƒ³è¡¨è¾¾ä»€ä¹ˆã€‚è¿™é‡Œæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬åœ¨ä¸€å°æœºå™¨ä¸Šå¼€å‘ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºï¼Œä½¿ç”¨ bind å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬æœ‰å¤šä¸ªip åœ°å€å¯ä»¥é€‰æ‹©ã€‚é¦–å…ˆï¼Œè¿™å°æœºå™¨å¯¹å¤–è®¿é—®çš„ipåœ°å€æ˜¯120.55.94.78ï¼Œè¿™å°æœºå™¨åœ¨å½“å‰å±€åŸŸç½‘çš„åœ°å€æ˜¯192.168.1.104ï¼›åŒæ—¶è¿™å°æœºå™¨æœ‰æœ¬åœ°å›ç¯åœ°å€127.0.0.1ã€‚\nå¦‚æœä½ æŒ‡å‘æœ¬æœºä¸Šå¯ä»¥è®¿é—®ï¼Œé‚£ä¹ˆä½  bind å‡½æ•°ä¸­çš„åœ°å€å°±å¯ä»¥ä½¿ç”¨127.0.0.1; å¦‚æœä½ çš„æœåŠ¡åªæƒ³è¢«å±€åŸŸç½‘å†…éƒ¨æœºå™¨è®¿é—®ï¼Œbind å‡½æ•°çš„åœ°å€å¯ä»¥ä½¿ç”¨192.168.1.104ï¼›å¦‚æœ å¸Œæœ›è¿™ä¸ªæœåŠ¡å¯ä»¥è¢«å…¬ç½‘è®¿é—®ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨åœ°å€0.0.0.0æˆ– INADDR_ANYã€‚\nbind å‡½æ•°ç«¯å£å·é—®é¢˜ç½‘ç»œé€šä¿¡ç¨‹åºçš„åŸºæœ¬é€»è¾‘æ˜¯å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œå³ä»å®¢æˆ·ç«¯çš„åœ°å€:ç«¯å£è¿æ¥åˆ°æœåŠ¡å™¨åœ°å€:ç«¯å£ä¸Šï¼Œä»¥ 4.2 å°èŠ‚ä¸­çš„ç¤ºä¾‹ç¨‹åºä¸ºä¾‹ï¼ŒæœåŠ¡å™¨ç«¯çš„ç«¯å£å·ä½¿ç”¨ 3000ï¼Œé‚£å®¢æˆ·ç«¯è¿æ¥æ—¶çš„ç«¯å£å·æ˜¯å¤šå°‘å‘¢ï¼ŸTCP é€šä¿¡åŒæ–¹ä¸­ä¸€èˆ¬æœåŠ¡å™¨ç«¯ç«¯å£å·æ˜¯å›ºå®šçš„ï¼Œè€Œå®¢æˆ·ç«¯ç«¯å£å·æ˜¯è¿æ¥å‘èµ·æ—¶ç”±æ“ä½œç³»ç»Ÿéšæœºåˆ†é…çš„ï¼ˆä¸ä¼šåˆ†é…å·²ç»è¢«å ç”¨çš„ç«¯å£ï¼‰ã€‚ç«¯å£å·æ˜¯ä¸€ä¸ª C short ç±»å‹çš„å€¼ï¼Œå…¶èŒƒå›´æ˜¯0ï½65535ï¼ŒçŸ¥é“è¿™ç‚¹å¾ˆé‡è¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–å†™å‹åŠ›æµ‹è¯•ç¨‹åºæ—¶ï¼Œç”±äºç«¯å£æ•°é‡çš„é™åˆ¶ï¼Œåœ¨æŸå°æœºå™¨ä¸Šç½‘å¡åœ°å€ä¸å˜çš„æƒ…å†µä¸‹å‹åŠ›æµ‹è¯•ç¨‹åºç†è®ºä¸Šæœ€å¤šåªèƒ½å‘èµ·å…­ä¸‡äº”åƒå¤šä¸ªè¿æ¥ã€‚æ³¨æ„æˆ‘è¯´çš„æ˜¯ç†è®ºä¸Šï¼Œåœ¨å®é™…æƒ…å†µä¸‹ï¼Œç”±äºå½“æ—¶çš„æ“ä½œç³»ç»Ÿå¾ˆå¤šç«¯å£å¯èƒ½å·²ç»è¢«å ç”¨ï¼Œå®é™…å¯ä»¥ä½¿ç”¨çš„ç«¯å£æ¯”è¿™ä¸ªæ›´å°‘ï¼Œä¾‹å¦‚ï¼Œä¸€èˆ¬è§„å®šç«¯å£å·åœ¨1024ä»¥ä¸‹çš„ç«¯å£æ˜¯ä¿ç•™ç«¯å£ï¼Œä¸å»ºè®®ç”¨æˆ·ç¨‹åºä½¿ç”¨ã€‚è€Œå¯¹äº Windows ç³»ç»Ÿï¼ŒMSDN ç”šè‡³æ˜ç¡®åœ°è¯´ï¼š\n\nOn Windows Vista and later, the dynamic client port range is a value between 49152 and 65535. This is a change from Windows Server 2003 and earlier where the dynamic client port range was a value between 1025 and 5000.Vista åŠä»¥åçš„Windowsï¼Œå¯ç”¨çš„åŠ¨æ€ç«¯å£èŒƒå›´æ˜¯49152ï½65535ï¼Œè€Œ Windows ServeråŠæ›´æ—©çš„ç³»ç»Ÿï¼Œå¯ä»¥çš„åŠ¨æ€ç«¯å£èŒƒå›´æ˜¯1025~5000ã€‚ï¼ˆä½ å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨æ¥æ”¹å˜è¿™ä¸€è®¾ç½®ï¼Œå‚è€ƒç½‘å€ï¼šhttps://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-bindï¼‰\n\nå¦‚æœå°† bind å‡½æ•°ä¸­çš„ç«¯å£å·è®¾ç½®æˆ0ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¼šéšæœºç»™ç¨‹åºåˆ†é…ä¸€ä¸ªå¯ç”¨çš„ä¾¦å¬ç«¯å£ï¼Œå½“ç„¶æœåŠ¡å™¨ç¨‹åºä¸€èˆ¬ä¸ä¼šè¿™ä¹ˆåšï¼Œå› ä¸ºæœåŠ¡å™¨ç¨‹åºæ˜¯è¦å¯¹å¤–æœåŠ¡çš„ï¼Œå¿…é¡»è®©å®¢æˆ·ç«¯çŸ¥é“ç¡®åˆ‡çš„ipåœ°å€å’Œç«¯å£å·ã€‚\nå¾ˆå¤šäººè§‰å¾—åªæœ‰æœåŠ¡å™¨ç¨‹åºå¯ä»¥è°ƒç”¨ bind å‡½æ•°ç»‘å®šä¸€ä¸ªç«¯å£å·ï¼Œå…¶å®ä¸ç„¶ï¼Œåœ¨ä¸€äº›ç‰¹æ®Šçš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®¢æˆ·ç«¯ç¨‹åºä»¥æŒ‡å®šçš„ç«¯å£å·å»è¿æ¥æœåŠ¡å™¨ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ç¨‹åºä¸­è°ƒç”¨ bind å‡½æ•°ç»‘å®šä¸€ä¸ªå…·ä½“çš„ç«¯å£ã€‚\næˆ‘ä»¬ç”¨ä»£ç æ¥å®é™…éªŒè¯ä¸€ä¸‹ä¸Šè·¯æ‰€è¯´çš„ï¼Œä¸ºäº†èƒ½çœ‹åˆ°è¿æ¥çŠ¶æ€ï¼Œæˆ‘ä»¬å°†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…³é—­socketçš„ä»£ç æ³¨é‡Šæ‰ï¼Œè¿™æ ·è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ã€‚\n\næƒ…å½¢ä¸€ï¼šå®¢æˆ·ç«¯ä»£ç ä¸ç»‘å®šç«¯å£\n\nä¿®æ”¹åçš„æœåŠ¡å™¨ä»£ç å¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778/** * TCPæœåŠ¡å™¨é€šä¿¡åŸºæœ¬æµç¨‹ * zhangyl 2018.12.13 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;vector&gt;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªä¾¦å¬socket    int listenfd = socket(AF_INET, SOCK_STREAM, 0);    if (listenfd == -1)    &#123;        std::cout &lt;&lt; &quot;create listen socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.åˆå§‹åŒ–æœåŠ¡å™¨åœ°å€    struct sockaddr_in bindaddr;    bindaddr.sin_family = AF_INET;    bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);    bindaddr.sin_port = htons(3000);    if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //3.å¯åŠ¨ä¾¦å¬    if (listen(listenfd, SOMAXCONN) == -1)    &#123;        std::cout &lt;&lt; &quot;listen error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è®°å½•æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥çš„å®¹å™¨    std::vector&lt;int&gt; clientfds;    while (true)    &#123;        struct sockaddr_in clientaddr;        socklen_t clientaddrlen = sizeof(clientaddr);        //4. æ¥å—å®¢æˆ·ç«¯è¿æ¥        int clientfd = accept(listenfd, (struct sockaddr *)&amp;clientaddr, &amp;clientaddrlen);        if (clientfd != -1)        &#123;                         char recvBuf[32] = &#123;0&#125;;            //5. ä»å®¢æˆ·ç«¯æ¥å—æ•°æ®            int ret = recv(clientfd, recvBuf, 32, 0);            if (ret &gt; 0)             &#123;                std::cout &lt;&lt; &quot;recv data from client, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;                //6. å°†æ”¶åˆ°çš„æ•°æ®åŸå°ä¸åŠ¨åœ°å‘ç»™å®¢æˆ·ç«¯                ret = send(clientfd, recvBuf, strlen(recvBuf), 0);                if (ret != strlen(recvBuf))                    std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;                std::cout &lt;&lt; &quot;send data to client successfully, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;            &#125;             else             &#123;                std::cout &lt;&lt; &quot;recv data error.&quot; &lt;&lt; std::endl;            &#125;            //close(clientfd);            clientfds.push_back(clientfd);        &#125;    &#125;    //7.å…³é—­ä¾¦å¬socket    close(listenfd);    return 0;&#125;\n\nä¿®æ”¹åçš„å®¢æˆ·ç«¯ä»£ç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768/** * TCPå®¢æˆ·ç«¯é€šä¿¡åŸºæœ¬æµç¨‹ * zhangyl 2018.12.13 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //3. å‘æœåŠ¡å™¨å‘é€æ•°æ®    int ret = send(clientfd, SEND_DATA, strlen(SEND_DATA), 0);    if (ret != strlen(SEND_DATA))    &#123;        std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    std::cout &lt;&lt; &quot;send data successfully, data: &quot; &lt;&lt; SEND_DATA &lt;&lt; std::endl;    //4. ä»å®¢æˆ·ç«¯æ”¶å–æ•°æ®    char recvBuf[32] = &#123;0&#125;;    ret = recv(clientfd, recvBuf, 32, 0);    if (ret &gt; 0)     &#123;        std::cout &lt;&lt; &quot;recv data successfully, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;    &#125;     else     &#123;        std::cout &lt;&lt; &quot;recv data error, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;    &#125;    //5. å…³é—­socket    //close(clientfd);    //è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†è®©å®¢æˆ·ç«¯ç¨‹åºä¸é€€å‡º    while (true)     &#123;        sleep(3);    &#125;    return 0;&#125;\n\nå°†ç¨‹åºç¼–è¯‘å¥½åï¼ˆç¼–è¯‘æ–¹æ³•å’Œä¸Šæ–‡ä¸€æ ·ï¼‰ï¼Œæˆ‘ä»¬å…ˆå¯åŠ¨serverï¼Œå†å¯åŠ¨ä¸‰ä¸ªå®¢æˆ·ç«¯ã€‚ç„¶åé€šè¿‡ lsof å‘½ä»¤æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šçš„ TCP è¿æ¥ä¿¡æ¯ï¼Œä¸ºäº†æ›´æ¸…æ¥šåœ°æ˜¾ç¤ºç»“æœï¼Œå·²ç»å°†ä¸ç›¸å…³çš„è¿æ¥ä¿¡æ¯å»æ‰äº†ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š\n123456789[root@localhost ~]# lsof -i -PnCOMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAMEserver   1445 root    3u  IPv4  21568      0t0  TCP *:3000 (LISTEN)server   1445 root    4u  IPv4  21569      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:40818 (ESTABLISHED)server   1445 root    5u  IPv4  21570      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:40820 (ESTABLISHED)server   1445 root    6u  IPv4  21038      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:40822 (ESTABLISHED)client   1447 root    3u  IPv4  21037      0t0  TCP 127.0.0.1:40818-&gt;127.0.0.1:3000 (ESTABLISHED)client   1448 root    3u  IPv4  21571      0t0  TCP 127.0.0.1:40820-&gt;127.0.0.1:3000 (ESTABLISHED)client   1449 root    3u  IPv4  21572      0t0  TCP 127.0.0.1:40822-&gt;127.0.0.1:3000 (ESTABLISHED)\n\nä¸Šé¢çš„ç»“æœæ˜¾ç¤ºï¼Œserver è¿›ç¨‹ï¼ˆè¿›ç¨‹ ID æ˜¯ 1445ï¼‰åœ¨ 3000 ç«¯å£å¼€å¯ä¾¦å¬ï¼Œæœ‰ä¸‰ä¸ª client è¿›ç¨‹ï¼ˆè¿›ç¨‹ ID åˆ†åˆ«æ˜¯1447ã€1448ã€1449ï¼‰åˆ†åˆ«é€šè¿‡ç«¯å£å· 40818ã€40820ã€40822 è¿åˆ° server è¿›ç¨‹ä¸Šçš„ï¼Œä½œä¸ºå®¢æˆ·ç«¯çš„ä¸€æ–¹ï¼Œç«¯å£å·æ˜¯ç³»ç»Ÿéšæœºåˆ†é…çš„ã€‚\n\næƒ…å½¢äºŒï¼šå®¢æˆ·ç«¯ç»‘å®šç«¯å£å· 0\næœåŠ¡å™¨ç«¯ä»£ç ä¿æŒä¸å˜ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸‹å®¢æˆ·ç«¯ä»£ç ï¼š\n1234/** * TCPæœåŠ¡å™¨é€šä¿¡åŸºæœ¬æµç¨‹ * zhangyl 2018.12.13 */\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;  //1.åˆ›å»ºä¸€ä¸ªsocket  int clientfd = socket(AF_INET, SOCK_STREAM, 0);  if (clientfd == -1)  &#123;      std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;      return -1;  &#125;  struct sockaddr_in bindaddr;  bindaddr.sin_family = AF_INET;  bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);  //å°†socketç»‘å®šåˆ°0å·ç«¯å£ä¸Šå»  bindaddr.sin_port = htons(0);  if (bind(clientfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)  &#123;      std::cout &lt;&lt; &quot;bind socket error.&quot; &lt;&lt; std::endl;      return -1;  &#125;  //2.è¿æ¥æœåŠ¡å™¨  struct sockaddr_in serveraddr;  serveraddr.sin_family = AF_INET;  serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);  serveraddr.sin_port = htons(SERVER_PORT);  if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)  &#123;      std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;      return -1;  &#125;  //3. å‘æœåŠ¡å™¨å‘é€æ•°æ®  int ret = send(clientfd, SEND_DATA, strlen(SEND_DATA), 0);  if (ret != strlen(SEND_DATA))  &#123;      std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;      return -1;  &#125;  std::cout &lt;&lt; &quot;send data successfully, data: &quot; &lt;&lt; SEND_DATA &lt;&lt; std::endl;  //4. ä»å®¢æˆ·ç«¯æ”¶å–æ•°æ®  char recvBuf[32] = &#123;0&#125;;  ret = recv(clientfd, recvBuf, 32, 0);  if (ret &gt; 0)   &#123;      std::cout &lt;&lt; &quot;recv data successfully, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;  &#125;   else   &#123;      std::cout &lt;&lt; &quot;recv data error, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;  &#125;  //5. å…³é—­socket  //close(clientfd);  //è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†è®©å®¢æˆ·ç«¯ç¨‹åºä¸é€€å‡º  while (true)   &#123;      sleep(3);  &#125;  return 0;&#125;\n\næˆ‘ä»¬å†æ¬¡ç¼–è¯‘å®¢æˆ·ç«¯ç¨‹åºï¼Œå¹¶å¯åŠ¨ä¸‰ä¸ª client è¿›ç¨‹ï¼Œç„¶åç”¨ lsof å‘½ä»¤æŸ¥çœ‹æœºå™¨ä¸Šçš„ TCP è¿æ¥æƒ…å†µï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š\n123456789[root@localhost ~]# lsof -i -PnCOMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAMEserver   1593 root    3u  IPv4  21807      0t0  TCP *:3000 (LISTEN)server   1593 root    4u  IPv4  21808      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:44220 (ESTABLISHED)server   1593 root    5u  IPv4  19311      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:38990 (ESTABLISHED)server   1593 root    6u  IPv4  21234      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:42365 (ESTABLISHED)client   1595 root    3u  IPv4  22626      0t0  TCP 127.0.0.1:44220-&gt;127.0.0.1:3000 (ESTABLISHED)client   1611 root    3u  IPv4  21835      0t0  TCP 127.0.0.1:38990-&gt;127.0.0.1:3000 (ESTABLISHED)client   1627 root    3u  IPv4  21239      0t0  TCP 127.0.0.1:42365-&gt;127.0.0.1:3000 (ESTABLISHED)\n\né€šè¿‡ä¸Šé¢çš„ç»“æœï¼Œæˆ‘ä»¬å‘ç°ä¸‰ä¸ª client è¿›ç¨‹ä½¿ç”¨çš„ç«¯å£å·ä»ç„¶æ˜¯ç³»ç»Ÿéšæœºåˆ†é…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç»‘å®š 0 å·ç«¯å£å’Œæ²¡æœ‰ç»‘å®šæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\n\næƒ…å½¢ä¸‰ï¼šå®¢æˆ·ç«¯ç»‘å®šä¸€ä¸ªå›ºå®šç«¯å£\næˆ‘ä»¬è¿™é‡Œä½¿ç”¨ 20000 ç«¯å£ï¼Œå½“ç„¶è¯»è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ï¼Œåªè¦ä¿è¯æ‰€é€‰æ‹©çš„ç«¯å£å·å½“å‰æ²¡æœ‰è¢«å…¶ä»–ç¨‹åºå ç”¨å³å¯ï¼ŒæœåŠ¡å™¨ä»£ç ä¿æŒä¸å˜ï¼Œå®¢æˆ·ç«¯ç»‘å®šä»£ç ä¸­çš„ç«¯å£å·ä» 0 æ”¹æˆ 20000ã€‚è¿™é‡Œä¸ºäº†èŠ‚çœç¯‡å¹…ï¼Œåªè´´å‡ºä¿®æ”¹å¤„çš„ä»£ç ï¼š\n12345678910struct sockaddr_in bindaddr;bindaddr.sin_family = AF_INET;bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);//å°†socketç»‘å®šåˆ°20000å·ç«¯å£ä¸Šå»bindaddr.sin_port = htons(20000);if (bind(clientfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)&#123;    std::cout &lt;&lt; &quot;bind socket error.&quot; &lt;&lt; std::endl;    return -1;&#125;\n\nå†æ¬¡é‡æ–°ç¼–è¯‘ç¨‹åºï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªå®¢æˆ·ç«¯åï¼Œæˆ‘ä»¬çœ‹åˆ°æ­¤æ—¶çš„ TCP è¿æ¥çŠ¶æ€ï¼š\n12345[root@localhost testsocket]# lsof -i -PnCOMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAMEserver   1676 root    3u  IPv4  21933      0t0  TCP *:3000 (LISTEN)server   1676 root    4u  IPv4  21934      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:20000 (ESTABLISHED)client   1678 root    3u  IPv4  21336      0t0  TCP 127.0.0.1:20000-&gt;127.0.0.1:3000 (ESTABLISHED)\n\né€šè¿‡ä¸Šé¢çš„ç»“æœï¼Œæˆ‘ä»¬å‘ç° client è¿›ç¨‹ç¡®å®ä½¿ç”¨ 20000 å·ç«¯å£è¿æ¥åˆ° server è¿›ç¨‹ä¸Šå»äº†ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬å†å¼€å¯ä¸€ä¸ª client è¿›ç¨‹ï¼Œæˆ‘ä»¬çŒœæƒ³ç”±äºç«¯å£å· 20000 å·²ç»è¢«å ç”¨ï¼Œæ–°å¯åŠ¨çš„ client ä¼šç”±äºè°ƒç”¨ bind å‡½æ•°å‡ºé”™è€Œé€€å‡ºï¼Œæˆ‘ä»¬å®é™…éªŒè¯ä¸€ä¸‹ï¼š\n123[root@localhost testsocket]# ./client bind socket error.[root@localhost testsocket]# \n\nç»“æœç¡®å®å’Œæˆ‘ä»¬é¢„æƒ³çš„ä¸€æ ·ã€‚\n\n\nåœ¨æŠ€æœ¯é¢è¯•çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™é¢è¯•å®˜ä¼šé—® TCP ç½‘ç»œé€šä¿¡çš„å®¢æˆ·ç«¯ç¨‹åºä¸­çš„ socket æ˜¯å¦å¯ä»¥è°ƒç”¨ bind å‡½æ•°ï¼Œç›¸ä¿¡è¯»åˆ°è¿™é‡Œï¼Œèªæ˜çš„è¯»è€…å·²ç»æœ‰ç­”æ¡ˆäº†ã€‚\nå¦å¤–ï¼ŒLinux çš„ nc å‘½ä»¤æœ‰ä¸ª -p é€‰é¡¹ï¼ˆå­—æ¯ p æ˜¯å°å†™ï¼‰ï¼Œè¿™ä¸ªé€‰é¡¹çš„ä½œç”¨å°±æ˜¯ nc åœ¨æ¨¡æ‹Ÿå®¢æˆ·ç«¯ç¨‹åºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡å®šç«¯å£å·è¿æ¥åˆ°æœåŠ¡å™¨ç¨‹åºä¸Šå»ï¼Œå®ç°åŸç†ç›¸ä¿¡è¯»è€…ä¹Ÿæ˜ç™½äº†ã€‚æˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šé¢çš„æœåŠ¡å™¨ç¨‹åºä¸ºä¾‹ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸ç”¨æˆ‘ä»¬çš„ client ç¨‹åºï¼Œæ”¹ç”¨ nc å‘½ä»¤æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯ã€‚åœ¨ shell ç»ˆç«¯è¾“å…¥ï¼š\n12345[root@localhost testsocket]# nc -v -p 9999 127.0.0.1 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Connected to 127.0.0.1:3000.My name is zhangxfMy name is zhangxf\n\n-v é€‰é¡¹è¡¨ç¤ºè¾“å‡º nc å‘½ä»¤è¿æ¥çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¿™é‡Œè¿æ¥æˆåŠŸä»¥åï¼Œä¼šè¾“å‡ºâ€œ**Ncat: Connected to 127.0.0.1:3000.**â€ æç¤ºå·²ç»è¿æ¥åˆ°æœåŠ¡å™¨çš„ 3000 ç«¯å£ä¸Šå»äº†ã€‚\n-p é€‰é¡¹çš„å‚æ•°å€¼æ˜¯ 9999 è¡¨ç¤ºï¼Œæˆ‘ä»¬è¦æ±‚ nc å‘½ä»¤æœ¬åœ°ä»¥ç«¯å£å· 9999 è¿æ¥æœåŠ¡å™¨ï¼Œæ³¨æ„ä¸è¦ä¸ç«¯å£å· 3000 æ··æ·†ï¼Œ3000 æ˜¯æœåŠ¡å™¨çš„ä¾¦å¬ç«¯å£å·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è¿æ¥çš„ç›®æ ‡ç«¯å£å·ï¼Œ9999 æ˜¯æˆ‘ä»¬å®¢æˆ·ç«¯ä½¿ç”¨çš„ç«¯å£å·ã€‚æˆ‘ä»¬ç”¨ lsof å‘½ä»¤æ¥éªŒè¯ä¸€ä¸‹æˆ‘ä»¬çš„ nc å‘½ä»¤æ˜¯å¦ç¡®å®ä»¥ 9999 ç«¯å£å·è¿æ¥åˆ° server è¿›ç¨‹ä¸Šå»äº†ã€‚\n12345[root@localhost testsocket]# lsof -i -PnCOMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAMEserver   1676 root    3u  IPv4  21933      0t0  TCP *:3000 (LISTEN)server   1676 root    7u  IPv4  22405      0t0  TCP 127.0.0.1:3000-&gt;127.0.0.1:9999 (ESTABLISHED)nc       2005 root    3u  IPv4  22408      0t0  TCP 127.0.0.1:9999-&gt;127.0.0.1:3000 (ESTABLISHED)\n\nç»“æœç¡®å®å¦‚æˆ‘ä»¬æœŸæœ›çš„ä¸€è‡´ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬ç”¨ nc å‘½ä»¤è¿æ¥ä¸Š server è¿›ç¨‹ä»¥åï¼Œæˆ‘ä»¬è¿˜ç»™æœåŠ¡å™¨å‘äº†ä¸€æ¡æ¶ˆæ¯â€My name is zhangxfâ€œï¼Œserver ç¨‹åºæ”¶åˆ°æ¶ˆæ¯åæŠŠè¿™æ¡æ¶ˆæ¯åŸå°ä¸åŠ¨åœ°è¿”è¿˜ç»™æˆ‘ä»¬ï¼Œä»¥ä¸‹æ˜¯ server ç«¯è¿è¡Œç»“æœï¼š\n1234[root@localhost testsocket]# ./server   recv data from client, data: My name is zhangxfsend data to client successfully, data: My name is zhangxf\n\nå…³äº lsof å’Œ nc å‘½ä»¤æˆ‘ä»¬ä¼šåœ¨åé¢çš„ç³»åˆ—æ–‡ç« ä¸­è¯¦ç»†è®²è§£ã€‚\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/bindå‡½æ•°é‡éš¾ç‚¹è§£æ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"424888f17e8d4fef03209498cc4923a5","title":"ã€è½¬è½½ã€‘selectå‡½æ•°é‡éš¾ç‚¹è§£æ","content":"select å‡½æ•°é‡éš¾ç‚¹è§£æselect å‡½æ•°æ˜¯ç½‘ç»œé€šä¿¡ç¼–ç¨‹ä¸­éå¸¸å¸¸ç”¨çš„ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤åº”è¯¥ç†Ÿç»ƒæŒæ¡å®ƒã€‚è™½ç„¶å®ƒæ˜¯ BSD æ ‡å‡†ä¹‹ä¸€çš„ Socket å‡½æ•°ä¹‹ä¸€ï¼Œä½†åœ¨ Linux å’Œ Windows å¹³å°ï¼Œå…¶è¡Œä¸ºè¡¨ç°è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ Linux å¹³å°ä¸Šçš„ select å‡½æ•°ã€‚\nLinux å¹³å°ä¸‹çš„ select å‡½æ•°select å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æµ‹ä¸€ç»„ socket ä¸­æŸä¸ªæˆ–æŸå‡ ä¸ªæ˜¯å¦æœ‰â€œäº‹ä»¶â€ï¼Œè¿™é‡Œçš„â€œäº‹ä»¶â€ä¸€èˆ¬åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç±»ï¼š\n\nå¯è¯»äº‹ä»¶ï¼Œä¸€èˆ¬æ„å‘³ç€å¯ä»¥è°ƒç”¨ recv æˆ– read å‡½æ•°ä»è¯¥ socket ä¸Šè¯»å–æ•°æ®ï¼›å¦‚æœè¯¥ socket æ˜¯ä¾¦å¬ socketï¼ˆå³è°ƒç”¨äº† bind å‡½æ•°ç»‘å®šè¿‡ ip åœ°å€å’Œç«¯å£å·ï¼Œå¹¶è°ƒç”¨äº† listen å¯åŠ¨ä¾¦å¬çš„ socketï¼‰ï¼Œå¯è¯»æ„å‘³ç€æ­¤æ—¶å¯ä»¥æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥åˆ°æ¥ï¼Œæ­¤æ—¶å¯è°ƒç”¨ accept å‡½æ•°æ¥å—æ–°è¿æ¥ã€‚\nå¯å†™äº‹ä»¶ï¼Œä¸€èˆ¬æ„å‘³ç€æ­¤æ—¶è°ƒç”¨ send æˆ– write å‡½æ•°å¯ä»¥å°†æ•°æ®â€œå‘å‡ºå»â€ã€‚\nå¼‚å¸¸äº‹ä»¶ï¼ŒæŸä¸ª socket å‡ºç°å¼‚å¸¸ã€‚\n\nå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š\n12345int select(int nfds,            fd_set *readfds,           fd_set *writefds,           fd_set *exceptfds,           struct timeval *timeout);\n\nå‚æ•°è¯´æ˜ï¼š\n\nå‚æ•° nfdsï¼Œ Linux ä¸‹ socket ä¹Ÿç§° fdï¼Œè¿™ä¸ªå‚æ•°çš„å€¼è®¾ç½®æˆæ‰€æœ‰éœ€è¦ä½¿ç”¨ select å‡½æ•°ç›‘å¬çš„ fd ä¸­æœ€å¤§ fd å€¼åŠ  1ã€‚\n\nå‚æ•° readfdsï¼Œéœ€è¦ç›‘å¬å¯è¯»äº‹ä»¶çš„ fd é›†åˆã€‚\n\nå‚æ•° writefdsï¼Œéœ€è¦ç›‘å¬å¯å†™äº‹ä»¶çš„ fd é›†åˆã€‚\n\nå‚æ•° exceptfdsï¼Œéœ€è¦ç›‘å¬å¼‚å¸¸äº‹ä»¶ fd é›†åˆã€‚\nreadfdsã€writefds å’Œ exceptfds ç±»å‹éƒ½æ˜¯ fd_setï¼Œè¿™æ˜¯ä¸€ä¸ªç»“æ„ä½“ä¿¡æ¯ï¼Œå…¶å®šä¹‰ä½äº &#x2F;usr&#x2F;include&#x2F;sys&#x2F;select.h ä¸­ï¼š\n1234567891011121314151617181920212223242526272829/* The fd_set member is required to be an array of longs.  */typedef long int __fd_mask;/* Some versions of &lt;linux/posix_types.h&gt; define this macros.  */#undef  __NFDBITS/* It&#x27;s easier to assume 8-bit bytes than to get CHAR_BIT.  */#define __NFDBITS       (8 * (int) sizeof (__fd_mask))#define __FD_ELT(d)     ((d) / __NFDBITS)#define __FD_MASK(d)    ((__fd_mask) 1 &lt;&lt; ((d) % __NFDBITS))/* fd_set for select and pselect.  */typedef struct&#123;  /* XPG4.2 requires this member name.  Otherwise avoid the name     from the global namespace.  */#ifdef __USE_XOPEN  __fd_mask fds_bits[__FD_SETSIZE / __NFDBITS];# define __FDS_BITS(set) ((set)-&gt;fds_bits)#else  // åœ¨æˆ‘çš„centOS 7.0 ç³»ç»Ÿä¸­çš„å€¼ï¼š  // __FD_SETSIZE = 1024  //__NFDBITS = 64  __fd_mask __fds_bits[__FD_SETSIZE / __NFDBITS];     # define __FDS_BITS(set) ((set)-&gt;__fds_bits)#endif&#125; fd_set;/* Maximum number of file descriptors in &#x27;fd_set&#x27;.  */#define FD_SETSIZE              __FD_SETSIZE\n\næˆ‘ä»¬å‡è®¾æœªå®šä¹‰å® __USE_XOPENï¼Œå°†ä¸Šé¢çš„ä»£ç æ•´ç†ä¸€ä¸‹ï¼š\n1234typedef struct&#123;   long int __fds_bits[16];     &#125; fd_set;\n\nå°†ä¸€ä¸ª fd æ·»åŠ åˆ° fd_set è¿™ä¸ªé›†åˆä¸­éœ€è¦ä½¿ç”¨ FD_SET å®ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n1void FD_SET(int fd, fd_set *set);\n\nå…¶å®ç°å¦‚ä¸‹ï¼š\n1#define FD_SET(fd,fdsetp) __FD_SET(fd,fdsetp)\n\nFD_SET åœ¨å†…éƒ¨åˆæ˜¯é€šè¿‡å® __FD_SET æ¥å®ç°çš„ï¼Œ**__FD_SET** çš„å®šä¹‰å¦‚ä¸‹ï¼ˆä½äº &#x2F;usr&#x2F;include&#x2F;bits&#x2F;select.h ä¸­ï¼‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839#if defined __GNUC__ &amp;&amp; __GNUC__ &gt;= 2# if __WORDSIZE == 64#  define __FD_ZERO_STOS &quot;stosq&quot;# else#  define __FD_ZERO_STOS &quot;stosl&quot;# endif# define __FD_ZERO(fdsp) \\do &#123;                                                                        \\  int __d0, __d1;                                                           \\  __asm__ __volatile__ (&quot;cld; rep; &quot; __FD_ZERO_STOS                         \\                        : &quot;=c&quot; (__d0), &quot;=D&quot; (__d1)                          \\                        : &quot;a&quot; (0), &quot;0&quot; (sizeof (fd_set)                     \\                                        / sizeof (__fd_mask)),              \\                          &quot;1&quot; (&amp;__FDS_BITS (fdsp)[0])                       \\                        : &quot;memory&quot;);                                        \\&#125; while (0)#else   /* ! GNU CC *//* We don&#x27;t use `memset&#x27; because this would require a prototype and the array isn&#x27;t too big.  */# define __FD_ZERO(set)  \\do &#123;                                                                        \\  unsigned int __i;                                                         \\  fd_set *__arr = (set);                                                    \\  for (__i = 0; __i &lt; sizeof (fd_set) / sizeof (__fd_mask); ++__i)          \\    __FDS_BITS (__arr)[__i] = 0;                                            \\&#125; while (0)#endif  /* GNU CC */#define __FD_SET(d, set) \\((void) (__FDS_BITS (set)[__FD_ELT (d)] |= __FD_MASK (d)))#define __FD_CLR(d, set) \\((void) (__FDS_BITS (set)[__FD_ELT (d)] &amp;= ~__FD_MASK (d)))#define __FD_ISSET(d, set) \\((__FDS_BITS (set)[__FD_ELT (d)] &amp; __FD_MASK (d)) != 0)\n\né‡ç‚¹çœ‹è¿™ä¸€è¡Œï¼š\n1((void) (__FDS_BITS (set)[__FD_ELT (d)] |= __FD_MASK (d)))\n\n__FD_MASK å’Œ __FD_ELT å®åœ¨ä¸Šé¢çš„ä»£ç ä¸­å·²ç»ç»™å‡ºå®šä¹‰ï¼š\n12#define __FD_ELT(d)     ((d) / __NFDBITS)#define __FD_MASK(d)    ((__fd_mask) 1 &lt;&lt; ((d) % __NFDBITS))\n\n__NFDBITS çš„å€¼æ˜¯ 64 ï¼ˆ8 * 8ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ __FD_MASK (d) å…ˆè®¡ç®— fd ä¸ 64 çš„ä½™æ•° nï¼Œç„¶åæ‰§è¡Œ 1 &lt;&lt; nï¼Œè¿™ä¸€æ“ä½œå®é™…ä¸Šæ˜¯å°† fd çš„å€¼æ”¾åœ¨ 0ï½63 è¿™ 64 çš„ä½ç½®ä¸Šå»ï¼Œè¿™ä¸ªä½ç½®ç´¢å¼•å°±æ˜¯ fd ä¸ 64 å–æ¨¡çš„ç»“æœï¼›åŒç† __FD_ELT(d) å°±æ˜¯è®¡ç®—ä½ç½®ç´¢å¼•å€¼äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ç°åœ¨ fd çš„ å€¼æ˜¯ 57ï¼Œé‚£ä¹ˆåœ¨è¿™ 64 ä¸ªä½ç½®çš„ 57 ä½ï¼Œå…¶å€¼åœ¨ 64 ä¸ªé•¿åº¦çš„äºŒè¿›åˆ¶ä¸­ç½®ä½æ˜¯ï¼š\n10000 0010 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n\nè¿™ä¸ªå€¼å°±æ˜¯ 1 &lt;&lt; (57 % 64) å¾—åˆ°çš„æ•°å­—ã€‚\nä½†æ˜¯å‰é¢ fd æ•°ç»„çš„å®šä¹‰æ˜¯ï¼š\n1234typedef struct&#123;   long int __fds_bits[16];    //å¯ä»¥çœ‹æˆæ˜¯128 bitçš„æ•°ç»„ &#125; fd_set;\n\nlong int å  8 ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ª 16 ä¸ª long intï¼Œå¦‚æœæ¢æˆäºŒè¿›åˆ¶çš„ä½(bit)å°±æ˜¯ 8 * 16 &#x3D; 128ï¼Œ ä¹Ÿå°±æ˜¯è¿™ä¸ªæ•°ç»„åªç”¨äº†ä½ 64 ä½ï¼Œ é«˜ 64 ä½å¹¶æ²¡æœ‰ä½¿ç”¨ã€‚è¿™è¯´æ˜åœ¨æˆ‘çš„æœºå™¨ä¸Šï¼Œselect å‡½æ•°æ”¯æŒæ“ä½œçš„æœ€å¤§ fd æ•°é‡æ˜¯ 64ã€‚\nåŒç†ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä» fd_set ä¸Šåˆ é™¤ä¸€ä¸ª fdï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ FD_CLRï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n1void FD_CLR(int fd, fd_set *set);\n\nåŸç†å’Œ FD_SET ç›¸åŒï¼Œå³å°†å¯¹åº”çš„æ ‡å¿—ä½ç”±1å˜0å³å¯ã€‚\nå¦‚æœï¼Œæˆ‘ä»¬éœ€è¦å°† fd_set ä¸­æ‰€æœ‰çš„ fd éƒ½æ¸…æ‰ï¼Œåˆ™ä½¿ç”¨å® FD_ZEROï¼š\n1void FD_ZERO(fd_set *set);\n\nå½“ select å‡½æ•°è¿”å›æ—¶ï¼Œ æˆ‘ä»¬ä½¿ç”¨ FD_ISSET å®æ¥åˆ¤æ–­æŸä¸ª fd æ˜¯å¦æœ‰æˆ‘ä»¬å…³å¿ƒçš„äº‹ä»¶ï¼ŒFD_ISSET å®çš„å®šä¹‰å¦‚ä¸‹ï¼š\n\n\n1int  FD_ISSET(int fd, fd_set *set);\n\nFD_ISSET å®æœ¬è´¨ä¸Šå°±æ˜¯æ£€æµ‹å¯¹åº”çš„ä½ç½®ä¸Šæ˜¯å¦ç½® 1ï¼Œå®ç°å¦‚ä¸‹ï¼š\n12#define __FD_ISSET(d, set) \\    ((__FDS_BITS (set)[__FD_ELT (d)] &amp; __FD_MASK (d)) != 0)\n\n\næé†’ä¸€ä¸‹ï¼š __FD_ELT å’Œ __FD_MASK å®å‰æ–‡çš„ä»£ç å·²ç»ç»™è¿‡å…·ä½“å®ç°äº†ã€‚\n\n\nå‚æ•° timeoutï¼Œè¶…æ—¶æ—¶é—´ï¼Œå³åœ¨è¿™ä¸ªå‚æ•°è®¾å®šçš„æ—¶é—´å†…æ£€æµ‹è¿™äº› fd çš„äº‹ä»¶ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å select å‡½æ•°å°†ç«‹å³è¿”å›ã€‚è¿™æ˜¯ä¸€ä¸ª timeval ç±»å‹ç»“æ„ä½“ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n12345struct timeval &#123;  long    tv_sec;         /* seconds */  long    tv_usec;        /* microseconds */&#125;;\n\nselect å‡½æ•°çš„æ€»è¶…æ—¶æ—¶é—´æ˜¯ timeout-&gt;tv_sec å’Œ timeout-&gt;tv_usec ä¹‹å’Œï¼Œ å‰è€…çš„æ—¶é—´å•ä½æ˜¯ç§’ï¼Œåè€…çš„æ—¶é—´å•ä½æ˜¯å¾®å¦™ã€‚\n\n\nè¯´äº†è¿™ä¹ˆå¤šç†è®ºçŸ¥è¯†ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå…·ä½“çš„ç¤ºä¾‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151/** * selectå‡½æ•°ç¤ºä¾‹ï¼Œserverç«¯, select_server.cpp * zhangyl 2018.12.24 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;sys/time.h&gt;#include &lt;vector&gt;#include &lt;errno.h&gt;//è‡ªå®šä¹‰ä»£è¡¨æ— æ•ˆfdçš„å€¼#define INVALID_FD -1int main(int argc, char* argv[])&#123;    //åˆ›å»ºä¸€ä¸ªä¾¦å¬socket    int listenfd = socket(AF_INET, SOCK_STREAM, 0);    if (listenfd == -1)    &#123;        std::cout &lt;&lt; &quot;create listen socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //åˆå§‹åŒ–æœåŠ¡å™¨åœ°å€    struct sockaddr_in bindaddr;    bindaddr.sin_family = AF_INET;    bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);    bindaddr.sin_port = htons(3000);    if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    //å¯åŠ¨ä¾¦å¬    if (listen(listenfd, SOMAXCONN) == -1)    &#123;        std::cout &lt;&lt; &quot;listen error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    //å­˜å‚¨å®¢æˆ·ç«¯socketçš„æ•°ç»„    std::vector&lt;int&gt; clientfds;    int maxfd = listenfd;    while (true)     &#123;           fd_set readset;        FD_ZERO(&amp;readset);        //å°†ä¾¦å¬socketåŠ å…¥åˆ°å¾…æ£€æµ‹çš„å¯è¯»äº‹ä»¶ä¸­å»        FD_SET(listenfd, &amp;readset);        //å°†å®¢æˆ·ç«¯fdåŠ å…¥åˆ°å¾…æ£€æµ‹çš„å¯è¯»äº‹ä»¶ä¸­å»        int clientfdslength = clientfds.size();        for (int i = 0; i &lt; clientfdslength; ++i)        &#123;            if (clientfds[i] != INVALID_FD)            &#123;                FD_SET(clientfds[i], &amp;readset);            &#125;        &#125;        timeval tm;        tm.tv_sec = 1;        tm.tv_usec = 0;        //æš‚ä¸”åªæ£€æµ‹å¯è¯»äº‹ä»¶ï¼Œä¸æ£€æµ‹å¯å†™å’Œå¼‚å¸¸äº‹ä»¶        int ret = select(maxfd + 1, &amp;readset, NULL, NULL, &amp;tm);        if (ret == -1)        &#123;            //å‡ºé”™ï¼Œé€€å‡ºç¨‹åºã€‚            if (errno != EINTR)                break;        &#125;        else if (ret == 0)        &#123;            //select å‡½æ•°è¶…æ—¶ï¼Œä¸‹æ¬¡ç»§ç»­            continue;        &#125; else &#123;            //æ£€æµ‹åˆ°æŸä¸ªsocketæœ‰äº‹ä»¶            if (FD_ISSET(listenfd, &amp;readset))            &#123;                //ä¾¦å¬socketçš„å¯è¯»äº‹ä»¶ï¼Œåˆ™è¡¨æ˜æœ‰æ–°çš„è¿æ¥åˆ°æ¥                struct sockaddr_in clientaddr;                socklen_t clientaddrlen = sizeof(clientaddr);                //4. æ¥å—å®¢æˆ·ç«¯è¿æ¥                int clientfd = accept(listenfd, (struct sockaddr *)&amp;clientaddr, &amp;clientaddrlen);                if (clientfd == -1)                                 &#123;                               //æ¥å—è¿æ¥å‡ºé”™ï¼Œé€€å‡ºç¨‹åº                    break;                &#125;                //åªæ¥å—è¿æ¥ï¼Œä¸è°ƒç”¨recvæ”¶å–ä»»ä½•æ•°æ®                std:: cout &lt;&lt; &quot;accept a client connection, fd: &quot; &lt;&lt; clientfd &lt;&lt; std::endl;                clientfds.push_back(clientfd);                //è®°å½•ä¸€ä¸‹æœ€æ–°çš„æœ€å¤§fdå€¼ï¼Œä»¥ä¾¿ä½œä¸ºä¸‹ä¸€è½®å¾ªç¯ä¸­selectçš„ç¬¬ä¸€ä¸ªå‚æ•°                if (clientfd &gt; maxfd)                    maxfd = clientfd;            &#125;             else             &#123;                //å‡è®¾å¯¹ç«¯å‘æ¥çš„æ•°æ®é•¿åº¦ä¸è¶…è¿‡63ä¸ªå­—ç¬¦                char recvbuf[64];                int clientfdslength = clientfds.size();                for (int i = 0; i &lt; clientfdslength; ++i)                &#123;                    if (clientfds[i] != -1 &amp;&amp; FD_ISSET(clientfds[i], &amp;readset))                    &#123;                                       memset(recvbuf, 0, sizeof(recvbuf));                        //éä¾¦å¬socketï¼Œåˆ™æ¥æ”¶æ•°æ®                        int length = recv(clientfds[i], recvbuf, 64, 0);                        if (length &lt;= 0 &amp;&amp; errno != EINTR)                        &#123;                            //æ”¶å–æ•°æ®å‡ºé”™äº†                            std::cout &lt;&lt; &quot;recv data error, clientfd: &quot; &lt;&lt; clientfds[i] &lt;&lt; std::endl;                                                        close(clientfds[i]);                            //ä¸ç›´æ¥åˆ é™¤è¯¥å…ƒç´ ï¼Œå°†è¯¥ä½ç½®çš„å…ƒç´ ç½®ä½-1                            clientfds[i] = INVALID_FD;                            continue;                        &#125;                        std::cout &lt;&lt; &quot;clientfd: &quot; &lt;&lt; clientfds[i] &lt;&lt; &quot;, recv data: &quot; &lt;&lt; recvbuf &lt;&lt; std::endl;                                       &#125;                &#125;            &#125;        &#125;    &#125;    //å…³é—­æ‰€æœ‰å®¢æˆ·ç«¯socket    int clientfdslength = clientfds.size();    for (int i = 0; i &lt; clientfdslength; ++i)    &#123;        if (clientfds[i] != INVALID_FD)        &#123;            close(clientfds[i]);        &#125;    &#125;    //å…³é—­ä¾¦å¬socket    close(listenfd);    return 0;&#125;\n\næˆ‘ä»¬ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼š\n12[root@localhost testsocket]# g++ -g -o select_server select_server.cpp [root@localhost testsocket]# ./select_server \n\nç„¶åï¼Œæˆ‘ä»¬å†å¤šå¼€å‡ ä¸ª shell çª—å£ï¼Œæˆ‘ä»¬è¿™é‡Œä¸å†ä¸“é—¨ç¼–å†™å®¢æˆ·ç«¯ç¨‹åºäº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ Linux ä¸‹çš„ nc æŒ‡ä»¤æ¨¡æ‹Ÿå‡ºä¸¤ä¸ªå®¢æˆ·ç«¯ã€‚\nshell çª—å£1ï¼Œè¿æ¥æˆåŠŸä»¥åå‘é€å­—ç¬¦ä¸² hello123ï¼š\n1234[root@localhost ~]# nc -v 127.0.0.1 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Connected to 127.0.0.1:3000.hello123\n\nshell çª—å£2ï¼Œè¿æ¥æˆåŠŸä»¥åå‘é€å­—ç¬¦ä¸² helloworldï¼š\n1234[root@localhost ~]# nc -v 127.0.0.1 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Connected to 127.0.0.1:3000.helloworld\n\næ­¤æ—¶æœåŠ¡å™¨ç«¯è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š\n\næ³¨æ„ï¼Œç”±äº nc å‘é€çš„æ•°æ®æ˜¯æŒ‰æ¢è¡Œç¬¦æ¥åŒºåˆ†çš„ï¼Œæ¯ä¸€ä¸ªæ•°æ®åŒ…é»˜è®¤çš„æ¢è¡Œç¬¦ä»¥\\n ç»“æŸï¼ˆå½“ç„¶ï¼Œä½ å¯ä»¥ -C é€‰é¡¹æ¢æˆ\\r\\nï¼‰ï¼Œæ‰€ä»¥æœåŠ¡å™¨æ”¶åˆ°æ•°æ®åï¼Œæ˜¾ç¤ºå‡ºæ¥çš„æ•°æ®æ¯ä¸€è¡Œä¸‹é¢éƒ½æœ‰ä¸€ä¸ªç©ºç™½è¡Œã€‚\nå½“æ–­å¼€å„ä¸ªå®¢æˆ·ç«¯è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨ç«¯ select å‡½æ•°å¯¹å„ä¸ªå®¢æˆ·ç«¯ fd æ£€æµ‹æ—¶ï¼Œä»ç„¶ä¼šè§¦å‘å¯è¯»äº‹ä»¶ï¼Œæ­¤æ—¶å¯¹è¿™äº› fd è°ƒç”¨ recv å‡½æ•°ä¼šè¿”å› 0ï¼ˆrecv å‡½æ•°è¿”å›0ï¼Œè¡¨æ˜å¯¹ç«¯å…³é—­äº†è¿æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œä¸‹æ–‡æˆ‘ä»¬ä¼šæœ‰ä¸€ç« èŠ‚ä¸“é—¨ä»‹ç»è¿™äº›å‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå…³é—­è¿™äº›è¿æ¥å°±å¯ä»¥äº†ã€‚\nå®¢æˆ·ç«¯æ–­å¼€è¿æ¥åï¼ŒæœåŠ¡å™¨ç«¯çš„è¿è¡Œè¾“å‡ºç»“æœï¼š\n\nä»¥ä¸Šä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ç¨‹åºå®ç°çš„åŸºæœ¬æµç¨‹ï¼Œä»£ç è™½ç„¶ç®€å•ï¼Œä½†æ˜¯éå¸¸å…·æœ‰å…¸å‹æ€§å’Œä»£è¡¨æ€§ï¼Œè€Œä¸”åŒæ ·é€‚ç”¨äºå®¢æˆ·ç«¯ç½‘ç»œé€šä¿¡ï¼Œå¦‚æœç”¨äºå®¢æˆ·ç«¯çš„è¯ï¼Œåªéœ€è¦ç”¨ select æ£€æµ‹è¿æ¥ socket å°±å¯ä»¥äº†ï¼Œå¦‚æœè¿æ¥ socket æœ‰å¯è¯»äº‹ä»¶ï¼Œè°ƒç”¨ recv å‡½æ•°æ¥æ¥æ”¶æ•°æ®ï¼Œå‰©ä¸‹çš„é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ã€‚ä¸Šé¢çš„ä»£ç æˆ‘ä»¬ç”»ä¸€å¼ æµç¨‹å›¾å¦‚ä¸‹ï¼š\n\nå…³äºä¸Šè¿°ä»£ç åœ¨å®é™…å¼€å‘ä¸­æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼Œè¿™é‡Œé€ä¸€æ¥è¯´æ˜ä¸€ä¸‹ï¼š\n1. select å‡½æ•°è°ƒç”¨å‰åä¼šä¿®æ”¹ readfdsã€writefds å’Œ exceptfds è¿™ä¸‰ä¸ªé›†åˆä¸­çš„å†…å®¹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œæ‰€ä»¥å¦‚æœæ‚¨æƒ³ä¸‹æ¬¡è°ƒç”¨ select å¤ç”¨è¿™ä¸ªå˜é‡ï¼Œè®°å¾—åœ¨ä¸‹æ¬¡è°ƒç”¨å‰å†æ¬¡è°ƒç”¨ select å‰å…ˆä½¿ç”¨ FD_ZERO å°†é›†åˆæ¸…é›¶ï¼Œç„¶åè°ƒç”¨ FD_SET å°†éœ€è¦æ£€æµ‹äº‹ä»¶çš„ fd å†æ¬¡æ·»åŠ è¿›å»ã€‚\n\nselect å‡½æ•°è°ƒç”¨ä¹‹åï¼Œreadfdsã€writefds å’Œ exceptfds è¿™ä¸‰ä¸ªé›†åˆä¸­å­˜æ”¾çš„ä¸æ˜¯æˆ‘ä»¬ä¹‹å‰è®¾ç½®è¿›å»çš„ fdï¼Œè€Œæ˜¯æœ‰ç›¸å…³æœ‰è¯»å†™æˆ–å¼‚å¸¸äº‹ä»¶çš„ fdï¼Œä¹Ÿå°±æ˜¯è¯´ select å‡½æ•°ä¼šä¿®æ”¹è¿™ä¸‰ä¸ªå‚æ•°çš„å†…å®¹ï¼Œè¿™ä¹Ÿè¦æ±‚æˆ‘ä»¬å½“ä¸€ä¸ª fd_set è¢« select å‡½æ•°è°ƒç”¨åï¼Œè¿™ä¸ª fd_set å°±å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œä¸‹æ¬¡å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨å®ƒï¼Œå¿…é¡»ä½¿ç”¨ FD_ZERO å®å…ˆæ¸…é›¶ï¼Œå†é‡æ–°å°†æˆ‘ä»¬å…³å¿ƒçš„ fd è®¾ç½®è¿›å»ã€‚è¿™ç‚¹æˆ‘ä»¬ä» FD_ISSET æºç ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼š\n\n12#define __FD_ISSET(d, set) \\   ((__FDS_BITS (set)[__FD_ELT (d)] &amp; __FD_MASK (d)) != 0)\n\nå¦‚æœè°ƒç”¨ select å‡½æ•°ä¹‹åæ²¡æœ‰æ”¹å˜ fd_set é›†åˆï¼Œé‚£ä¹ˆå³ä½¿æŸä¸ª socket ä¸Šæ²¡æœ‰äº‹ä»¶ï¼Œè°ƒç”¨ select å‡½æ•°ä¹‹åæˆ‘ä»¬ç”¨ FD_ISSET æ£€æµ‹ï¼Œä¼šåŸè·¯å¾—åˆ°åŸæ¥è®¾ç½®ä¸Šå»çš„ socketã€‚è¿™æ˜¯å¾ˆå¤šåˆå­¦è€…åœ¨å­¦ä¹  select å‡½æ•°å®¹æ˜“çŠ¯çš„ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥éªŒè¯ä¸€ä¸‹ï¼Œè¿™æ¬¡æˆ‘ä»¬æŠŠ select å‡½æ•°ç”¨åœ¨å®¢æˆ·ç«¯ã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106/** * éªŒè¯è°ƒç”¨selectåå¿…é¡»é‡è®¾fd_setï¼Œselect_client.cpp * zhangyl 2018.12.24 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;errno.h&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000int main(int argc, char* argv[])&#123;    //åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    fd_set readset;    FD_ZERO(&amp;readset);    //å°†ä¾¦å¬socketåŠ å…¥åˆ°å¾…æ£€æµ‹çš„å¯è¯»äº‹ä»¶ä¸­å»    FD_SET(clientfd, &amp;readset);     timeval tm;    tm.tv_sec = 5;    tm.tv_usec = 0;     int ret;    int count = 0;    fd_set backup_readset;    memcpy(&amp;backup_readset, &amp;readset, sizeof(fd_set));    while (true)    &#123;        if (memcmp(&amp;readset, &amp;backup_readset, sizeof(fd_set)) == 0)        &#123;            std::cout &lt;&lt; &quot;equal&quot; &lt;&lt; std::endl;        &#125;        else        &#123;            std::cout &lt;&lt; &quot;not equal&quot; &lt;&lt; std::endl;        &#125;        //æš‚ä¸”åªæ£€æµ‹å¯è¯»äº‹ä»¶ï¼Œä¸æ£€æµ‹å¯å†™å’Œå¼‚å¸¸äº‹ä»¶        ret = select(clientfd + 1, &amp;readset, NULL, NULL, &amp;tm);        std::cout &lt;&lt; &quot;tm.tv_sec: &quot; &lt;&lt; tm.tv_sec &lt;&lt; &quot;, tm.tv_usec: &quot; &lt;&lt; tm.tv_usec &lt;&lt; std::endl;        if (ret == -1)        &#123;            //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™            if (errno != EINTR)                break;        &#125; else if (ret == 0)&#123;            //selectå‡½æ•°è¶…æ—¶            std::cout &lt;&lt; &quot;no event in specific time interval, countï¼š&quot; &lt;&lt; count &lt;&lt; std::endl;            ++count;            continue;        &#125; else &#123;            if (FD_ISSET(clientfd, &amp;readset))            &#123;                //æ£€æµ‹åˆ°å¯è¯»äº‹ä»¶                char recvbuf[32];                memset(recvbuf, 0, sizeof(recvbuf));                //å‡è®¾å¯¹ç«¯å‘æ•°æ®çš„æ—¶å€™ä¸è¶…è¿‡31ä¸ªå­—ç¬¦ã€‚                int n = recv(clientfd, recvbuf, 32, 0);                if (n &lt; 0)                &#123;                    //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™                    if (errno != EINTR)                        break;                &#125; else if (n == 0) &#123;                    //å¯¹ç«¯å…³é—­äº†è¿æ¥                    break;                &#125; else &#123;                    std::cout &lt;&lt; &quot;recv data: &quot; &lt;&lt; recvbuf &lt;&lt; std::endl;                &#125;            &#125;            else             &#123;                std::cout &lt;&lt; &quot;other socket event.&quot; &lt;&lt; std::endl;            &#125;        &#125;    &#125;           //å…³é—­socket    close(clientfd);    return 0;&#125;\n\nåœ¨ shell çª—å£è¾“å…¥ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘ç¨‹åºäº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ select_clientï¼š\n1g++ -g -o select_client select_client.cpp\n\nè¿™æ¬¡äº§ç”Ÿçš„æ˜¯å®¢æˆ·ç«¯ç¨‹åºï¼ŒæœåŠ¡å™¨ç¨‹åºæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ Linux nc å‘½ä»¤æ¥æ¨¡æ‹Ÿä¸€ä¸‹ï¼Œç”±äºå®¢æˆ·ç«¯è¿æ¥çš„æ˜¯ 127.0.0.1:3000 è¿™ä¸ªåœ°å€å’Œç«¯å£å·ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å¦å¤–ä¸€ä¸ªshell çª—å£çš„ nc å‘½ä»¤çš„å‚æ•°å¯ä»¥è¿™ä¹ˆå†™ï¼š\n1nc -v -l 0.0.0.0 3000\n\næ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼šæ¥ç€æˆ‘ä»¬å¯åŠ¨å®¢æˆ·ç«¯ select_clientï¼š\n1[root@myaliyun testsocket]# ./select_client \n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘æ•…æ„å°†å®¢æˆ·ç«¯ä»£ç ä¸­ select å‡½æ•°çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º5ç§’ï¼Œä»¥è¶³å¤Ÿæˆ‘ä»¬åœ¨è¿™ 5 ç§’å†…ç»™å®¢æˆ·ç«¯å‘ä¸€ä¸ªæ•°æ®ã€‚å¦‚æœæˆ‘ä»¬åœ¨ 5 ç§’å†…ç»™å®¢æˆ·ç«¯å‘é€ hello å­—ç¬¦ä¸²ï¼š\n\nå®¢æˆ·ç«¯è¾“å‡ºå¦‚ä¸‹ï¼š\n123456789101112131415161718[root@myaliyun testsocket]# ./select_client equalrecv data: hello...éƒ¨åˆ†æ•°æ®çœç•¥...not equaltm.tv_sec: 0, tm.tv_usec: 0no event in specific time interval, countï¼š31454not equaltm.tv_sec: 0, tm.tv_usec: 0no event in specific time interval, countï¼š31455not equaltm.tv_sec: 0, tm.tv_usec: 0no event in specific time interval, countï¼š31456not equaltm.tv_sec: 0, tm.tv_usec: 0no event in specific time interval, countï¼š31457...éƒ¨åˆ†è¾“å‡ºçœç•¥...\n\né™¤äº†ç¬¬ä¸€æ¬¡ select_client ä¼šè¾“å‡º equal å­—æ ·ï¼Œåé¢å†ä¹Ÿæ²¡è¾“å‡ºï¼Œè€Œ select å‡½æ•°ä»¥åçš„æ‰§è¡Œç»“æœä¹Ÿæ˜¯è¶…æ—¶ï¼Œå³ä½¿æ­¤æ—¶æœåŠ¡å™¨ç«¯å†æ¬¡ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚å› æ­¤éªŒè¯äº†ï¼šselect å‡½æ•°æ‰§è¡Œåï¼Œç¡®å®ä¼šå¯¹ä¸‰ä¸ªå‚æ•°çš„ fd_set è¿›è¡Œä¿®æ”¹ ã€‚select å‡½æ•°ä¿®æ”¹æŸä¸ª fd_set é›†åˆå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸¤å¼ å›¾æ¥è¯´æ˜ä¸€ä¸‹ï¼š\n\n\nå› æ­¤åœ¨è°ƒç”¨ select å‡½æ•°ä»¥åï¼Œ åŸæ¥ä½ç½®çš„çš„æ ‡å¿—ä½å¯èƒ½å·²ç»ä¸å¤å­˜åœ¨ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ä»£ç ä¸­è°ƒç”¨ä¸€æ¬¡ select å‡½æ•°ä»¥åï¼Œå³ä½¿æœåŠ¡å™¨ç«¯å†æ¬¡å‘é€æ•°æ®è¿‡æ¥ï¼Œselect å‡½æ•°ä¹Ÿä¸ä¼šå†å› ä¸ºå­˜åœ¨å¯è¯»äº‹ä»¶è€Œè¿”å›äº†ï¼Œå› ä¸ºç¬¬äºŒæ¬¡ clientfd å·²ç»ä¸åœ¨é‚£ä¸ª read_set ä¸­äº†ã€‚å› æ­¤å¦‚æœå¤ç”¨è¿™äº› fd_set å˜é‡ï¼Œå¿…é¡»æŒ‰ä¸Šæ–‡æ‰€è¯´çš„é‡æ–°æ¸…é›¶å†é‡æ–°æ·»åŠ å…³å¿ƒçš„ socket åˆ°é›†åˆä¸­å»ã€‚\n2. select å‡½æ•°ä¹Ÿä¼šä¿®æ”¹ timeval ç»“æ„ä½“çš„å€¼ï¼Œè¿™ä¹Ÿè¦æ±‚æˆ‘ä»¬å¦‚æœåƒå¤ç”¨è¿™ä¸ªå˜é‡ï¼Œå¿…é¡»ç»™ timeval å˜é‡é‡æ–°è®¾ç½®å€¼ã€‚\næ³¨æ„è§‚å¯Ÿä¸Šé¢çš„ä¾‹å­çš„è¾“å‡ºï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨ select å‡½æ•°ä¸€æ¬¡ä¹‹åï¼Œå˜é‡ tv çš„å€¼ä¹Ÿè¢«ä¿®æ”¹äº†ã€‚å…·ä½“ä¿®æ”¹æˆå¤šå°‘ï¼Œå¾—çœ‹ç³»ç»Ÿçš„è¡¨ç°ã€‚å½“ç„¶è¿™ç§ç‰¹æ€§å´ä¸æ˜¯è·¨å¹³å°çš„ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­æ˜¯è¿™æ ·çš„ï¼Œè€Œåœ¨å…¶ä»–æ“ä½œç³»ç»Ÿä¸Šå´ä¸ä¸€å®šæ˜¯è¿™æ ·ï¼ˆWindows ä¸Šå°±ä¸ä¼šä¿®æ”¹è¿™ä¸ªç»“æ„ä½“çš„å€¼ï¼‰ï¼Œè¿™ç‚¹åœ¨ Linux man æ‰‹å†Œ select å‡½æ•°çš„è¯´æ˜ä¸­è¯´çš„å¾ˆæ¸…æ¥šï¼š\n12345678On  Linux,  select()  modifies timeout to reflect the amountof time not slept; most other implementations do not do this.(POSIX.1-2001 permits either behavior.)  This causes problems both when Linux code which reads timeout is ported to  other operating systems, and when code is ported to Linux that reusesa struct timeval for multiple select()s in a loop withoutreinitializing it.  Consider timeout to be undefined afterselect() returns.\n\nç”±äºä¸åŒç³»ç»Ÿçš„å®ç°ä¸ä¸€æ ·ï¼Œman æ‰‹å†Œçš„å»ºè®®å°† select å‡½æ•°ä¿®æ”¹ timeval ç»“æ„ä½“çš„å€¼çš„è¡Œä¸ºå½“ä½œæ˜¯æœªå®šä¹‰çš„ï¼Œè¨€ä¸‹ä¹‹æ„æ˜¯å¦‚æœä½ è¦ä¸‹æ¬¡ä½¿ç”¨ select å‡½æ•°å¤ç”¨è¿™ä¸ªå˜é‡æ—¶ï¼Œè®°å¾—é‡æ–°èµ‹å€¼ã€‚è¿™æ˜¯ select å‡½æ•°éœ€è¦æ³¨æ„çš„ç¬¬äºŒä¸ªåœ°æ–¹ã€‚\n3. select å‡½æ•°çš„ timeval ç»“æ„ä½“çš„ tv_sec å’Œ tv_sec å¦‚æœä¸¤ä¸ªå€¼è®¾ç½®ä¸º 0ï¼Œå³æ£€æµ‹äº‹ä»¶æ€»æ—¶é—´è®¾ç½®ä¸º0ï¼Œå…¶è¡Œä¸ºæ˜¯ select ä¼šæ£€æµ‹ä¸€ä¸‹ç›¸å…³é›†åˆä¸­çš„ fdï¼Œå¦‚æœæ²¡æœ‰éœ€è¦çš„äº‹ä»¶ï¼Œåˆ™ç«‹å³è¿”å›ã€‚\næˆ‘ä»¬å°†ä¸Šè¿° select_client.cpp ä¿®æ”¹ä¸€ä¸‹ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394/** * éªŒè¯selectæ—¶é—´å‚æ•°è®¾ç½®ä¸º0ï¼Œselect_client_tv0.cpp * zhangyl 2018.12.25 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;errno.h&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000int main(int argc, char* argv[])&#123;    //åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    int ret;    while (true)    &#123;        fd_set readset;        FD_ZERO(&amp;readset);        //å°†ä¾¦å¬socketåŠ å…¥åˆ°å¾…æ£€æµ‹çš„å¯è¯»äº‹ä»¶ä¸­å»        FD_SET(clientfd, &amp;readset);         timeval tm;        tm.tv_sec = 0;        tm.tv_usec = 0;         //æš‚ä¸”åªæ£€æµ‹å¯è¯»äº‹ä»¶ï¼Œä¸æ£€æµ‹å¯å†™å’Œå¼‚å¸¸äº‹ä»¶        ret = select(clientfd + 1, &amp;readset, NULL, NULL, &amp;tm);        std::cout &lt;&lt; &quot;tm.tv_sec: &quot; &lt;&lt; tm.tv_sec &lt;&lt; &quot;, tm.tv_usec: &quot; &lt;&lt; tm.tv_usec &lt;&lt; std::endl;        if (ret == -1)        &#123;            //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™            if (errno != EINTR)                break;        &#125; else if (ret == 0)&#123;            //selectå‡½æ•°è¶…æ—¶            std::cout &lt;&lt; &quot;no event in specific time interval.&quot; &lt;&lt; std::endl;            continue;        &#125; else &#123;            if (FD_ISSET(clientfd, &amp;readset))            &#123;                //æ£€æµ‹åˆ°å¯è¯»äº‹ä»¶                char recvbuf[32];                memset(recvbuf, 0, sizeof(recvbuf));                //å‡è®¾å¯¹ç«¯å‘æ•°æ®çš„æ—¶å€™ä¸è¶…è¿‡31ä¸ªå­—ç¬¦ã€‚                int n = recv(clientfd, recvbuf, 32, 0);                if (n &lt; 0)                &#123;                    //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™                    if (errno != EINTR)                        break;                &#125; else if (n == 0) &#123;                    //å¯¹ç«¯å…³é—­äº†è¿æ¥                    break;                &#125; else &#123;                    std::cout &lt;&lt; &quot;recv data: &quot; &lt;&lt; recvbuf &lt;&lt; std::endl;                &#125;            &#125;            else             &#123;                std::cout &lt;&lt; &quot;other socket event.&quot; &lt;&lt; std::endl;            &#125;        &#125;    &#125;           //å…³é—­socket    close(clientfd);    return 0;&#125;\n\næ‰§è¡Œç»“æœç¡®å®å¦‚æˆ‘ä»¬é¢„æœŸçš„ï¼Œè¿™é‡Œ select å‡½æ•°åªæ˜¯ç®€å•åœ°æ£€æµ‹ä¸€ä¸‹ clientfdï¼Œå¹¶ä¸ä¼šç­‰å¾…å›ºå®šçš„æ—¶é—´ï¼Œç„¶åç«‹å³è¿”å›ã€‚\n\n4. å¦‚æœå°† select å‡½æ•°çš„ timeval å‚æ•°è®¾ç½®ä¸º NULLï¼Œåˆ™ select å‡½æ•°ä¼šä¸€ç›´é˜»å¡ä¸‹å»ï¼Œç›´åˆ°æˆ‘ä»¬éœ€è¦çš„äº‹ä»¶è§¦å‘ã€‚\næˆ‘ä»¬å°†ä¸Šè¿°ä»£ç å†ä¿®æ”¹ä¸€ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/** * éªŒè¯selectæ—¶é—´å‚æ•°è®¾ç½®ä¸ºNULLï¼Œselect_client_tvnull.cpp * zhangyl 2018.12.25 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;errno.h&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000int main(int argc, char* argv[])&#123;    //åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    int ret;    while (true)    &#123;        fd_set readset;        FD_ZERO(&amp;readset);        //å°†ä¾¦å¬socketåŠ å…¥åˆ°å¾…æ£€æµ‹çš„å¯è¯»äº‹ä»¶ä¸­å»        FD_SET(clientfd, &amp;readset);         //timeval tm;        //tm.tv_sec = 0;        //tm.tv_usec = 0;           //æš‚ä¸”åªæ£€æµ‹å¯è¯»äº‹ä»¶ï¼Œä¸æ£€æµ‹å¯å†™å’Œå¼‚å¸¸äº‹ä»¶        ret = select(clientfd + 1, &amp;readset, NULL, NULL, NULL);        if (ret == -1)        &#123;            //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™            if (errno != EINTR)                break;        &#125; else if (ret == 0)&#123;            //selectå‡½æ•°è¶…æ—¶            std::cout &lt;&lt; &quot;no event in specific time interval.&quot; &lt;&lt; std::endl;            continue;        &#125; else &#123;            if (FD_ISSET(clientfd, &amp;readset))            &#123;                //æ£€æµ‹åˆ°å¯è¯»äº‹ä»¶                char recvbuf[32];                memset(recvbuf, 0, sizeof(recvbuf));                //å‡è®¾å¯¹ç«¯å‘æ•°æ®çš„æ—¶å€™ä¸è¶…è¿‡31ä¸ªå­—ç¬¦ã€‚                int n = recv(clientfd, recvbuf, 32, 0);                if (n &lt; 0)                &#123;                    //é™¤äº†è¢«ä¿¡å·ä¸­æ–­çš„æƒ…å½¢ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å‡ºé”™                    if (errno != EINTR)                        break;                &#125; else if (n == 0) &#123;                    //å¯¹ç«¯å…³é—­äº†è¿æ¥                    break;                &#125; else &#123;                    std::cout &lt;&lt; &quot;recv data: &quot; &lt;&lt; recvbuf &lt;&lt; std::endl;                &#125;            &#125;            else             &#123;                std::cout &lt;&lt; &quot;other socket event.&quot; &lt;&lt; std::endl;            &#125;        &#125;    &#125;           //å…³é—­socket    close(clientfd);    return 0;&#125;\n\næˆ‘ä»¬å…ˆåœ¨å¦å¤–ä¸€ä¸ª shell çª—å£ç”¨ nc å‘½ä»¤æ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡å™¨ï¼Œç›‘å¬çš„ ip åœ°å€å’Œç«¯å£å·æ˜¯ 0.0.0.0:3000ï¼š\n123[root@myaliyun ~]# nc -v -l 0.0.0.0 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on 0.0.0.0:3000\n\nç„¶åå›åˆ°åŸæ¥çš„ shell çª—å£ï¼Œç¼–è¯‘ä¸Šè¿° select_client_tvnull.cppï¼Œå¹¶ä½¿ç”¨ gdb è¿è¡Œç¨‹åºï¼Œè¿™æ¬¡ä½¿ç”¨ gdb è¿è¡Œç¨‹åºçš„ç›®çš„æ˜¯ä¸ºäº†å½“ç¨‹åºâ€œå¡â€åœ¨æŸä¸ªä½ç½®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ctrl + C æŠŠç¨‹åºä¸­æ–­ä¸‹æ¥çœ‹çœ‹ç¨‹åºé˜»å¡åœ¨å“ªä¸ªå‡½æ•°è°ƒç”¨å¤„ï¼š\n12345678910111213141516171819202122[root@myaliyun testsocket]# g++ -g -o select_client_tvnull select_client_tvnull.cpp [root@myaliyun testsocket]# gdb select_client_tvnullReading symbols from /root/testsocket/select_client_tvnull...done.(gdb) rStarting program: /root/testsocket/select_client_tvnull ^CProgram received signal SIGINT, Interrupt.0x00007ffff72e7783 in __select_nocancel () from /lib64/libc.so.6Missing separate debuginfos, use: debuginfo-install glibc-2.17-196.el7_4.2.x86_64 libgcc-4.8.5-16.el7_4.1.x86_64 libstdc++-4.8.5-16.el7_4.1.x86_64(gdb) bt#0  0x00007ffff72e7783 in __select_nocancel () from /lib64/libc.so.6#1  0x0000000000400c75 in main (argc=1, argv=0x7fffffffe5f8) at select_client_tvnull.cpp:51(gdb) cContinuing.recv data: hello^CProgram received signal SIGINT, Interrupt.0x00007ffff72e7783 in __select_nocancel () from /lib64/libc.so.6(gdb) cContinuing.recv data: world\n\nå¦‚ä¸Šè¾“å‡ºç»“æœæ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ gdb çš„ r å‘½ä»¤ï¼ˆrunï¼‰å°†ç¨‹åºè·‘èµ·æ¥åï¼Œç¨‹åºå¡åœ¨æŸä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬æŒ‰ Ctrl + Cï¼ˆä»£ç ä¸­çš„ ^Cï¼‰ä¸­æ–­ç¨‹åºåä½¿ç”¨ bt å‘½ä»¤æŸ¥çœ‹å½“å‰ç¨‹åºçš„è°ƒç”¨å †æ ˆï¼Œå‘ç°ç¡®å®é˜»å¡åœ¨ select å‡½æ•°è°ƒç”¨å¤„ï¼›æ¥ç€æˆ‘ä»¬åœ¨æœåŠ¡å™¨ç«¯ç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª hello æ•°æ®ï¼š\n123456[root@myaliyun ~]# nc -v -l 0.0.0.0 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on 0.0.0.0:3000Ncat: Connection from 127.0.0.1.Ncat: Connection from 127.0.0.1:55968.hello\n\nå®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®åï¼Œselect å‡½æ•°æ»¡è¶³æ¡ä»¶ï¼Œç«‹å³è¿”å›ï¼Œå¹¶å°†æ•°æ®è¾“å‡ºæ¥åç»§ç»­è¿›è¡Œä¸‹ä¸€è½® select æ£€æµ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ Ctrl + C å°†ç¨‹åºä¸­æ–­ï¼Œå‘ç°ç¨‹åºåˆé˜»å¡åœ¨ select è°ƒç”¨å¤„ï¼›è¾“å…¥ c å‘½ä»¤ï¼ˆcontinueï¼‰è®©ç¨‹åºç»§ç»­è¿è¡Œï¼Œ æ­¤æ—¶ï¼Œæˆ‘ä»¬å†ç”¨æœåŠ¡å™¨ç«¯ç»™å®¢æˆ·ç«¯å‘é€ world å­—ç¬¦ä¸²ï¼Œselect å‡½æ•°å†æ¬¡è¿”å›ï¼Œå¹¶å°†æ•°æ®æ‰“å°å‡ºæ¥ï¼Œç„¶åç»§ç»­è¿›å…¥ä¸‹ä¸€è½® select æ£€æµ‹ï¼Œå¹¶ç»§ç»­åœ¨ select å¤„é˜»å¡ã€‚\n1234567[root@myaliyun ~]# nc -v -l 0.0.0.0 3000Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on 0.0.0.0:3000Ncat: Connection from 127.0.0.1.Ncat: Connection from 127.0.0.1:55968.helloworld\n\n\n\n5. åœ¨ Linux å¹³å°ä¸Šï¼Œselect å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»è®¾ç½®æˆéœ€è¦æ£€æµ‹äº‹ä»¶çš„æ‰€æœ‰ fd ä¸­çš„æœ€å¤§å€¼åŠ 1ã€‚æ‰€ä»¥ä¸Šæ–‡ä¸­ select_server.cpp ä¸­ï¼Œæ¯æ–°äº§ç”Ÿä¸€ä¸ª clientfdï¼Œæˆ‘éƒ½ä¼šä¸å½“å‰æœ€å¤§çš„ maxfd ä½œæ¯”è¾ƒï¼Œå¦‚æœå¤§äºå½“å‰çš„ maxfd åˆ™å°† maxfd æ›´æ–°æˆè¿™ä¸ªæ–°çš„æœ€å¤§å€¼ã€‚å…¶æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†åœ¨ select è°ƒç”¨æ—¶ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆåŠ  1ï¼‰ä¼ è¿›å»ã€‚\n\nåœ¨ Windows å¹³å°ä¸Šï¼Œselect å‡½æ•°çš„ç¬¬ä¸€ä¸ªå€¼ä¼ ä»»æ„å€¼éƒ½å¯ä»¥ï¼ŒWindows ç³»ç»Ÿæœ¬èº«ä¸ä½¿ç”¨è¿™ä¸ªå€¼ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹æ€§è€Œä¿ç•™äº†è¿™ä¸ªå‚æ•°ï¼Œä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ä¸ºäº†å…¼å®¹è·¨å¹³å°ä»£ç ï¼Œä¹Ÿä¼šæŒ‰æƒ¯ä¾‹ï¼Œå°†è¿™ä¸ªå€¼è®¾ç½®ä¸ºæœ€å¤§ socket åŠ  1ã€‚è¿™ç‚¹è¯·è¯»è€…æ³¨æ„ã€‚\n\nä»¥ä¸Šæ˜¯æˆ‘æ€»ç»“çš„ Linux ä¸‹ select ä½¿ç”¨çš„äº”ä¸ªæ³¨æ„äº‹é¡¹ï¼Œå¸Œæœ›è¯»è€…èƒ½ç†è§£å®ƒä»¬ã€‚\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/selectå‡½æ•°é‡éš¾ç‚¹è§£æ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"fb6fadde5a0ca98e5162a3e35095bf9a","title":"ã€è½¬è½½ã€‘socketçš„é˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼","content":"socket çš„é˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼å¯¹ socket åœ¨é˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹çš„å„ä¸ªå‡½æ•°çš„è¡Œä¸ºå·®åˆ«æ·±å…¥çš„ç†è§£æ˜¯æŒæ¡ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬è¦æ±‚ä¹‹ä¸€ï¼Œæ˜¯é‡ç‚¹ä¹Ÿæ˜¯éš¾ç‚¹ã€‚\né˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¸¸è®¨è®ºçš„å…·æœ‰ä¸åŒè¡Œä¸ºè¡¨ç°çš„ socket å‡½æ•°ä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªï¼Œè§ä¸‹è¡¨ï¼š\n\nconnect\naccept\nsend (Linux å¹³å°ä¸Šå¯¹ socket è¿›è¡Œæ“ä½œæ—¶ä¹ŸåŒ…æ‹¬ write å‡½æ•°ï¼Œä¸‹æ–‡ä¸­å¯¹ send å‡½æ•°çš„è®¨è®ºä¹Ÿé€‚ç”¨äº write å‡½æ•°)\nrecv (Linux å¹³å°ä¸Šå¯¹ socket è¿›è¡Œæ“ä½œæ—¶ä¹ŸåŒ…æ‹¬ read å‡½æ•°ï¼Œä¸‹æ–‡ä¸­å¯¹ recv å‡½æ•°çš„è®¨è®ºä¹Ÿé€‚ç”¨äº read å‡½æ•°)\n\né™äºæ–‡ç« ç¯‡å¹…ï¼Œæœ¬æ–‡åªè®¨è®º send å’Œrecvå‡½æ•°ï¼Œconnect å’Œ accept å‡½æ•°æˆ‘ä»¬å°†åœ¨è¯¥ç³»åˆ—çš„åé¢æ–‡ç« ä¸­è®¨è®ºã€‚åœ¨æ­£å¼è®¨è®ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè§£é‡Šä¸€ä¸‹é˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼çš„æ¦‚å¿µã€‚æ‰€è°“é˜»å¡æ¨¡å¼ï¼Œå°±å½“æŸä¸ªå‡½æ•°â€œæ‰§è¡ŒæˆåŠŸçš„æ¡ä»¶â€å½“å‰ä¸èƒ½æ»¡è¶³æ—¶ï¼Œè¯¥å‡½æ•°ä¼šé˜»å¡å½“å‰æ‰§è¡Œçº¿ç¨‹ï¼Œç¨‹åºæ‰§è¡Œæµåœ¨è¶…æ—¶æ—¶é—´åˆ°è¾¾æˆ–â€œæ‰§è¡ŒæˆåŠŸçš„æ¡ä»¶â€æ»¡è¶³åæ¢å¤ç»§ç»­æ‰§è¡Œã€‚è€Œéé˜»å¡æ¨¡å¼æ°æ°ç›¸åï¼Œå³ä½¿æŸä¸ªå‡½æ•°çš„â€œæ‰§è¡ŒæˆåŠŸçš„æ¡ä»¶â€ä¸å½“å‰ä¸èƒ½æ»¡è¶³ï¼Œè¯¥å‡½æ•°ä¹Ÿä¸ä¼šé˜»å¡å½“å‰æ‰§è¡Œçº¿ç¨‹ï¼Œè€Œæ˜¯ç«‹å³è¿”å›ï¼Œç»§ç»­è¿è¡Œæ‰§è¡Œç¨‹åºæµã€‚å¦‚æœè¯»è€…ä¸å¤ªæ˜ç™½è¿™ä¸¤ä¸ªå®šä¹‰ä¹Ÿæ²¡å…³ç³»ï¼Œåé¢æˆ‘ä»¬ä¼šä»¥å…·ä½“çš„ç¤ºä¾‹æ¥è®²è§£è¿™ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«ã€‚\nå¦‚ä½•å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼æ— è®ºæ˜¯ Windows è¿˜æ˜¯ Linux å¹³å°ï¼Œé»˜è®¤åˆ›å»ºçš„ socket éƒ½æ˜¯é˜»å¡æ¨¡å¼çš„ã€‚\nåœ¨ Linux å¹³å°ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fcntl() å‡½æ•°æˆ– ioctl() å‡½æ•°ç»™åˆ›å»ºçš„ socket å¢åŠ  O_NONBLOCK æ ‡å¿—æ¥å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n123int oldSocketFlag = fcntl(sockfd, F_GETFL, 0);int newSocketFlag = oldSocketFlag | O_NONBLOCK;fcntl(sockfd, F_SETFL,  newSocketFlag);\n\nioctl() å‡½æ•° ä¸ fcntl() å‡½æ•°ä½¿ç”¨æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†ç»™å‡ºç¤ºä¾‹ä»£ç äº†ã€‚\nå½“ç„¶ï¼ŒLinux ä¸‹çš„ socket() åˆ›å»ºå‡½æ•°ä¹Ÿå¯ä»¥ç›´æ¥åœ¨åˆ›å»ºæ—¶å°† socket è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼ï¼Œsocket() å‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š\n1int socket(int domain, int type, int protocol);\n\nç»™ type å‚æ•°å¢åŠ ä¸€ä¸ª SOCK_NONBLOCK æ ‡å¿—å³å¯ï¼Œä¾‹å¦‚ï¼š\n1int s = socket(AF_INET, SOCK_STREAM | SOCK_NONBLOCK, IPPROTO_TCP);\n\nä¸ä»…å¦‚æ­¤ï¼ŒLinux ç³»ç»Ÿä¸‹åˆ©ç”¨ accept() å‡½æ•°è¿”å›çš„ä»£è¡¨ä¸å®¢æˆ·ç«¯é€šä¿¡çš„ socket ä¹Ÿæä¾›äº†ä¸€ä¸ªæ‰©å±•å‡½æ•° **accept4()**ï¼Œç›´æ¥å°† accept å‡½æ•°è¿”å›çš„ socket è®¾ç½®æˆéé˜»å¡çš„ã€‚\n12int accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen); int accept4(int sockfd, struct sockaddr *addr, socklen_t *addrlen, int flags);\n\nåªè¦å°† accept4() å‡½æ•°æœ€åä¸€ä¸ªå‚æ•° flags è®¾ç½®æˆ SOCK_NONBLOCK å³å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ä»¥ä¸‹ä»£ç æ˜¯ç­‰ä»·çš„ï¼š\n12345678910socklen_t addrlen = sizeof(clientaddr);int clientfd = accept4(listenfd, &amp;clientaddr, &amp;addrlen, SOCK_NONBLOCK);socklen_t addrlen = sizeof(clientaddr);int clientfd = accept(listenfd, &amp;clientaddr, &amp;addrlen);if (clientfd != -1)&#123;    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    fcntl(clientfd, F_SETFL,  newSocketFlag);&#125;\n\nåœ¨ Windows å¹³å°ä¸Šï¼Œå¯ä»¥è°ƒç”¨ ioctlsocket() å‡½æ•° å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œioctlsocket() ç­¾åå¦‚ä¸‹ï¼š\n1int ioctlsocket(SOCKET s, long cmd, u_long *argp);\n\nå°† cmd å‚æ•°è®¾ç½®ä¸º FIONBIOï¼Œ*argp* è®¾ç½®ä¸º 0 å³å¯å°† socket è®¾ç½®æˆé˜»å¡æ¨¡å¼ï¼Œè€Œå°† argp è®¾ç½®æˆé 0 å³å¯è®¾ç½®æˆéé˜»å¡æ¨¡å¼ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š\n1234567//å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼u_long argp = 1;ioctlsocket(s, FIONBIO, &amp;argp);//å°† socket è®¾ç½®æˆé˜»å¡æ¨¡å¼u_long argp = 0;ioctlsocket(s, FIONBIO, &amp;argp);\n\nWindows å¹³å°éœ€è¦æ³¨æ„ä¸€ä¸ªåœ°æ–¹ï¼Œå¦‚æœå¯¹ä¸€ä¸ª socket è°ƒç”¨äº† WSAAsyncSelect() æˆ– WSAEventSelect() å‡½æ•°åï¼Œå†è°ƒç”¨ ioctlsocket() å‡½æ•°å°†è¯¥ socket è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼ä¼šå¤±è´¥ï¼Œä½ å¿…é¡»å…ˆè°ƒç”¨ WSAAsyncSelect() é€šè¿‡å°† lEvent å‚æ•°ä¸º 0 æˆ–è°ƒç”¨ WSAEventSelect() é€šè¿‡è®¾ç½® lNetworkEvents å‚æ•°ä¸º 0 æ¥æ¸…é™¤å·²ç»è®¾ç½®çš„ socket ç›¸å…³æ ‡å¿—ä½ï¼Œå†æ¬¡è°ƒç”¨ ioctlsocket() å°†è¯¥ socket è®¾ç½®æˆé˜»å¡æ¨¡å¼æ‰ä¼šæˆåŠŸã€‚å› ä¸ºè°ƒç”¨ WSAAsyncSelect() æˆ–WSAEventSelect() å‡½æ•°ä¼šè‡ªåŠ¨å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼ã€‚MSDN ä¸ŠåŸæ–‡ï¼ˆhttps://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-ioctlsocketï¼‰å¦‚ä¸‹ï¼š\n123The WSAAsyncSelect and WSAEventSelect functions automatically set a socket to nonblocking mode. If WSAAsyncSelect or WSAEventSelect has been issued on a socket, then any attempt to use ioctlsocket to set the socket back to blocking mode will fail with WSAEINVAL.To set the socket back to blocking mode, an application must first disable WSAAsyncSelect by calling WSAAsyncSelect with the lEvent parameter equal to zero, or disable WSAEventSelect by calling WSAEventSelect with the lNetworkEvents parameter equal to zero.\n\nå…³äº WSAAsyncSelect() å’Œ WSAEventSelect() è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œåæ–‡ä¸­ä¼šè¯¦ç»†è®²è§£ã€‚\n\næ³¨æ„äº‹é¡¹ï¼šæ— è®ºæ˜¯ Linux çš„ fcntl å‡½æ•°ï¼Œè¿˜æ˜¯ Windows çš„ ioctlsocketï¼Œå»ºè®®è¯»è€…åœ¨å®é™…ç¼–ç ä¸­åˆ¤æ–­ä¸€ä¸‹å‡½æ•°è¿”å›å€¼ä»¥ç¡®å®šæ˜¯å¦è°ƒç”¨æˆåŠŸã€‚\n\nsend å’Œ recv å‡½æ•°åœ¨é˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹çš„è¡Œä¸º\nsend å’Œ recv å‡½æ•°å…¶å®åä¸ç¬¦å®ã€‚\nsend å‡½æ•°æœ¬è´¨ä¸Šå¹¶ä¸æ˜¯å¾€ç½‘ç»œä¸Šå‘é€æ•°æ®ï¼Œè€Œæ˜¯å°†åº”ç”¨å±‚å‘é€ç¼“å†²åŒºçš„æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼ˆä¸‹æ–‡ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¥â€œç½‘å¡ç¼“å†²åŒºâ€ä»£æŒ‡ï¼‰ä¸­å»ï¼Œè‡³äºä»€ä¹ˆæ—¶å€™æ•°æ®ä¼šä»ç½‘å¡ç¼“å†²åŒºä¸­çœŸæ­£åœ°å‘åˆ°ç½‘ç»œä¸­å»è¦æ ¹æ® TCP&#x2F;IP åè®®æ ˆçš„è¡Œä¸ºæ¥ç¡®å®šï¼Œè¿™ç§è¡Œä¸ºæ¶‰åŠåˆ°ä¸€ä¸ªå« nagel ç®—æ³•å’Œ TCP_NODELAY çš„ socket é€‰é¡¹ï¼Œæˆ‘ä»¬å°†åœ¨ã€Šnagleç®—æ³•ä¸ TCP_NODELAYã€‹ç« èŠ‚è¯¦ç»†ä»‹ç»ã€‚\nrecv å‡½æ•°æœ¬è´¨ä¸Šä¹Ÿå¹¶ä¸æ˜¯ä»ç½‘ç»œä¸Šæ”¶å–æ•°æ®ï¼Œè€Œåªæ˜¯å°†å†…æ ¸ç¼“å†²åŒºä¸­çš„æ•°æ®æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„ç¼“å†²åŒºä¸­ï¼Œå½“ç„¶æ‹·è´å®Œæˆä»¥åä¼šå°†å†…æ ¸ç¼“å†²åŒºä¸­è¯¥éƒ¨åˆ†æ•°æ®ç§»é™¤ã€‚\nå¯ä»¥ç”¨ä¸‹é¢ä¸€å¼ å›¾æ¥æè¿°ä¸Šè¿°äº‹å®ï¼š\n\né€šè¿‡ä¸Šå›¾æˆ‘ä»¬çŸ¥é“ï¼Œä¸åŒçš„ç¨‹åºè¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå‘é€çš„ä¸€æ–¹ä¼šå°†å†…æ ¸ç¼“å†²åŒºçš„æ•°æ®é€šè¿‡ç½‘ç»œä¼ è¾“ç»™æ¥æ”¶æ–¹çš„å†…æ ¸ç¼“å†²åŒºã€‚åœ¨åº”ç”¨ç¨‹åº A ä¸ åº”ç”¨ç¨‹åº B å»ºç«‹äº† TCP è¿æ¥ä¹‹åï¼Œå‡è®¾åº”ç”¨ç¨‹åº A ä¸æ–­è°ƒç”¨ send å‡½æ•°ï¼Œè¿™æ ·æ•°æ®ä¼šä¸æ–­æ‹·è´è‡³å¯¹åº”çš„å†…æ ¸ç¼“å†²åŒºä¸­ï¼Œå¦‚æœ B é‚£ä¸€ç«¯ä¸€ç›´ä¸è°ƒç”¨ recv å‡½æ•°ï¼Œé‚£ä¹ˆ B çš„å†…æ ¸ç¼“å†²åŒºè¢«å¡«æ»¡ä»¥åï¼ŒA çš„å†…æ ¸ç¼“å†²åŒºä¹Ÿä¼šè¢«å¡«æ»¡ï¼Œæ­¤æ—¶ A ç»§ç»­è°ƒç”¨ send å‡½æ•°ä¼šæ˜¯ä»€ä¹ˆç»“æœå‘¢ï¼Ÿ å…·ä½“çš„ç»“æœå–å†³äºè¯¥ socket æ˜¯å¦æ˜¯é˜»å¡æ¨¡å¼ã€‚æˆ‘ä»¬è¿™é‡Œå…ˆç»™å‡ºç»“è®ºï¼š\n\nå½“ socket æ˜¯é˜»å¡æ¨¡å¼çš„ï¼Œç»§ç»­è°ƒç”¨ send&#x2F;recv å‡½æ•°ä¼šå¯¼è‡´ç¨‹åºé˜»å¡åœ¨ send&#x2F;recv è°ƒç”¨å¤„ã€‚\nå½“ socket æ˜¯éé˜»å¡æ¨¡å¼ï¼Œç»§ç»­è°ƒç”¨ send&#x2F;recv å‡½æ•°ï¼Œsend&#x2F;recv å‡½æ•°ä¸ä¼šé˜»å¡ç¨‹åºæ‰§è¡Œæµï¼Œè€Œæ˜¯ä¼šç«‹å³å‡ºé”™è¿”å›ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªç›¸å…³çš„é”™è¯¯ç ï¼ŒLinux å¹³å°ä¸Šè¯¥é”™è¯¯ç ä¸º EWOULDBLOCK æˆ– EAGAINï¼ˆè¿™ä¸¤ä¸ªé”™è¯¯ç å€¼ç›¸åŒï¼‰ï¼ŒWindows å¹³å°ä¸Šé”™è¯¯ç ä¸º WSAEWOULDBLOCKã€‚\n\næˆ‘ä»¬å®é™…æ¥ç¼–å†™ä¸€ä¸‹ä»£ç æ¥éªŒè¯ä¸€ä¸‹ä»¥ä¸Šè¯´çš„ä¸¤ç§æƒ…å†µã€‚\nsocket é˜»å¡æ¨¡å¼ä¸‹çš„ send è¡Œä¸ºæœåŠ¡ç«¯ä»£ç ï¼ˆblocking_server.cppï¼‰å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/** * éªŒè¯é˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°çš„è¡Œä¸ºï¼Œserverç«¯ * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªä¾¦å¬socket    int listenfd = socket(AF_INET, SOCK_STREAM, 0);    if (listenfd == -1)    &#123;        std::cout &lt;&lt; &quot;create listen socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.åˆå§‹åŒ–æœåŠ¡å™¨åœ°å€    struct sockaddr_in bindaddr;    bindaddr.sin_family = AF_INET;    bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);    bindaddr.sin_port = htons(3000);    if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    //3.å¯åŠ¨ä¾¦å¬    if (listen(listenfd, SOMAXCONN) == -1)    &#123;        std::cout &lt;&lt; &quot;listen error.&quot; &lt;&lt; std::endl;        close(listenfd);        return -1;    &#125;    while (true)    &#123;        struct sockaddr_in clientaddr;        socklen_t clientaddrlen = sizeof(clientaddr);        //4. æ¥å—å®¢æˆ·ç«¯è¿æ¥        int clientfd = accept(listenfd, (struct sockaddr *)&amp;clientaddr, &amp;clientaddrlen);        if (clientfd != -1)        &#123;                         //åªæ¥å—è¿æ¥ï¼Œä¸è°ƒç”¨recvæ”¶å–ä»»ä½•æ•°æ®            std:: cout &lt;&lt; &quot;accept a client connection.&quot; &lt;&lt; std::endl;        &#125;    &#125;    //7.å…³é—­ä¾¦å¬socket    close(listenfd);    return 0;&#125;\n\nå®¢æˆ·ç«¯ä»£ç ï¼ˆblocking_client.cppï¼‰å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/** * éªŒè¯é˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°çš„è¡Œä¸ºï¼Œclientç«¯ * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //3. ä¸æ–­å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œæˆ–è€…å‡ºé”™é€€å‡º    int count = 0;    while (true)    &#123;        int ret = send(clientfd, SEND_DATA, strlen(SEND_DATA), 0);        if (ret != strlen(SEND_DATA))        &#123;            std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;            break;        &#125;         else        &#123;            count ++;            std::cout &lt;&lt; &quot;send data successfully, count = &quot; &lt;&lt; count &lt;&lt; std::endl;        &#125;    &#125;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\nåœ¨ shell ä¸­åˆ†åˆ«ç¼–è¯‘è¿™ä¸¤ä¸ª cpp æ–‡ä»¶å¾—åˆ°ä¸¤ä¸ªå¯æ‰§è¡Œç¨‹åº blocking_server å’Œ blocking_clientï¼š\n12g++ -g -o blocking_server blocking_server.cppg++ -g -o blocking_client blocking_client.cpp\n\næˆ‘ä»¬å…ˆå¯åŠ¨ blocking_serverï¼Œç„¶åç”¨ gdb å¯åŠ¨ blocking_clientï¼Œè¾“å…¥ run å‘½ä»¤è®© blocking_clientè·‘èµ·æ¥ï¼Œblocking_client ä¼šä¸æ–­åœ°å‘ blocking_server å‘é€â€helloworldâ€œå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡ send æˆåŠŸåï¼Œä¼šå°†è®¡æ•°å™¨ count çš„å€¼æ‰“å°å‡ºæ¥ï¼Œè®¡æ•°å™¨ä¼šä¸æ–­å¢åŠ ï¼Œç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œè®¡æ•°å™¨ count å€¼ä¸å†å¢åŠ ä¸”ç¨‹åºä¸å†æœ‰è¾“å‡ºã€‚æ“ä½œè¿‡ç¨‹åŠè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š\nblocking_server ç«¯ï¼š\n12345678910111213141516171819202122[root@localhost testsocket]# ./blocking_server accept a client connection.[root@localhost testsocket]# gdb blocking_clientGNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-100.el7_4.1Copyright (C) 2013 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;and &quot;show warranty&quot; for details.This GDB was configured as &quot;x86_64-redhat-linux-gnu&quot;.For bug reporting instructions, please see:&lt;http://www.gnu.org/software/gdb/bugs/&gt;...Reading symbols from /root/testsocket/blocking_client...done.(gdb) run//è¾“å‡ºç»“æœå¤ªå¤šï¼Œçœç•¥éƒ¨åˆ†...send data successfully, count = 355384send data successfully, count = 355385send data successfully, count = 355386send data successfully, count = 355387send data successfully, count = 355388send data successfully, count = 355389send data successfully, count = 355390\n\næ­¤æ—¶ç¨‹åºä¸å†æœ‰è¾“å‡ºï¼Œè¯´æ˜æˆ‘ä»¬çš„ç¨‹åºåº”è¯¥â€œå¡åœ¨â€æŸä¸ªåœ°æ–¹ï¼Œç»§ç»­æŒ‰ Ctrl + C è®© gdb ä¸­æ–­ä¸‹æ¥ï¼Œè¾“å…¥ bt å‘½ä»¤æŸ¥çœ‹æ­¤æ—¶çš„è°ƒç”¨å †æ ˆï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„ç¨‹åºç¡®å®é˜»å¡åœ¨ send å‡½æ•°è°ƒç”¨å¤„ï¼š\n1234567^CProgram received signal SIGINT, Interrupt.0x00007ffff72f130d in send () from /lib64/libc.so.6(gdb) bt#0  0x00007ffff72f130d in send () from /lib64/libc.so.6#1  0x0000000000400b46 in main (argc=1, argv=0x7fffffffe598) at blocking_client.cpp:41(gdb) \n\nä¸Šé¢çš„ç¤ºä¾‹éªŒè¯äº†å¦‚æœä¸€ç«¯ä¸€ç›´å‘æ•°æ®ï¼Œè€Œå¯¹ç«¯åº”ç”¨å±‚ä¸€ç›´ä¸å–æ•°æ®ï¼ˆæˆ–æ”¶å–æ•°æ®çš„é€Ÿåº¦æ…¢äºå‘é€é€Ÿåº¦ï¼‰ï¼Œåˆ™å¾ˆå¿«ä¸¤ç«¯çš„å†…æ ¸ç¼“å†²åŒºå¾ˆå¿«å°±ä¼šè¢«å¡«æ»¡ï¼Œå¯¼è‡´å‘é€ç«¯è°ƒç”¨ send å‡½æ•°è¢«é˜»å¡ã€‚è¿™é‡Œè¯´çš„â€œå†…æ ¸ç¼“å†²åŒºâ€ å…¶å®æœ‰ä¸ªä¸“é—¨çš„åå­—ï¼Œå³ TCP çª—å£ã€‚ä¹Ÿå°±æ˜¯è¯´ socket é˜»å¡æ¨¡å¼ä¸‹ï¼Œ send å‡½æ•°åœ¨ TCP çª—å£å¤ªå°æ—¶çš„è¡Œä¸ºæ˜¯é˜»å¡å½“å‰ç¨‹åºæ‰§è¡Œæµï¼ˆå³é˜»å¡ send å‡½æ•°æ‰€åœ¨çš„çº¿ç¨‹çš„æ‰§è¡Œï¼‰ã€‚\nè¯´ç‚¹é¢˜å¤–è¯ï¼Œä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¯æ¬¡å‘é€ä¸€ä¸ªâ€œhelloworldâ€ï¼ˆ10ä¸ªå­—èŠ‚ï¼‰ï¼Œä¸€å…±å‘äº† 355390 æ¬¡ï¼ˆæ¯æ¬¡æµ‹è¯•çš„ç»“æœç•¥æœ‰ä¸åŒï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç²—ç•¥åœ°ç®—å‡º TCP çª—å£çš„å¤§å°å¤§çº¦ç­‰äº 1.7 Må·¦å³ ï¼ˆ10 * 355390 &#x2F; 2ï¼‰ã€‚\nè®©æˆ‘ä»¬å†æ·±å…¥ä¸€ç‚¹ï¼Œæˆ‘ä»¬åˆ©ç”¨ Linux tcpdump å·¥å…·æ¥åŠ¨æ€çœ‹ä¸€ä¸‹è¿™ç§æƒ…å½¢ä¸‹ TCP çª—å£å¤§å°çš„åŠ¨æ€å˜åŒ–ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒLinux ä¸‹ä½¿ç”¨ tcpdump è¿™ä¸ªå‘½ä»¤éœ€è¦æœ‰ root æƒé™ã€‚\næˆ‘ä»¬å¼€å¯ä¸‰ä¸ª shell çª—å£ï¼Œåœ¨ç¬¬ä¸€ä¸ªçª—å£å…ˆå¯åŠ¨ blocking_server è¿›ç¨‹ï¼Œåœ¨ç¬¬äºŒä¸ªçª—å£ç”¨ tcpdump æŠ“ç»è¿‡ TCP ç«¯å£ 3000 ä¸Šçš„æ•°æ®åŒ…ï¼š\n123[root@localhost testsocket]# tcpdump -i any -nn -S &#x27;tcp port 3000&#x27;    tcpdump: verbose output suppressed, use -v or -vv for full protocol decodelistening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes\n\næ¥ç€åœ¨ç¬¬ä¸‰ä¸ª shell çª—å£ï¼Œå¯åŠ¨ blocking_clientã€‚å½“ blocking_client è¿›ç¨‹ä¸å†è¾“å‡ºæ—¶ï¼Œæˆ‘ä»¬æŠ“åŒ…çš„ç»“æœå¦‚ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233[root@localhost testsocket]# tcpdump -i any -nn -S &#x27;tcp port 3000&#x27; tcpdump: verbose output suppressed, use -v or -vv for full protocol decodelistening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes11:52:35.907381 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [S], seq 1394135076, win 43690, options [mss 65495,sackOK,TS val 78907688 ecr 0,nop,wscale 7], length 020:32:21.261484 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [S.], seq 1233000591, ack 1394135077, win 43690, options [mss 65495,sackOK,TS val 78907688 ecr 78907688,nop,wscale 7], length 011:52:35.907441 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 011:52:35.907615 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1394135077:1394135087, ack 1233000592, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 1011:52:35.907626 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1394135087, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 011:52:35.907785 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1394135087:1394135097, ack 1233000592, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 1011:52:35.907793 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1394135097, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 011:52:35.907809 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1394135097:1394135107, ack 1233000592, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 1011:52:35.907814 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1394135107, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 0...å†…å®¹å¤ªé•¿ï¼Œ éƒ¨åˆ†çœç•¥...11:52:40.075794 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395013717, win 374, options [nop,nop,TS val 78911856 ecr 78911816], length 011:52:40.075829 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1395013717:1395030517, ack 1233000592, win 342, options [nop,nop,TS val 78911856 ecr 78911856], length 1680011:52:40.115847 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395030517, win 305, options [nop,nop,TS val 78911896 ecr 78911856], length 011:52:40.115866 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1395030517:1395047317, ack 1233000592, win 342, options [nop,nop,TS val 78911896 ecr 78911896], length 1680011:52:40.155703 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395047317, win 174, options [nop,nop,TS val 78911936 ecr 78911896], length 011:52:40.155752 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1395047317:1395064117, ack 1233000592, win 342, options [nop,nop,TS val 78911936 ecr 78911936], length 1680011:52:40.195132 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395064117, win 43, options [nop,nop,TS val 78911976 ecr 78911936], length 011:52:40.435748 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [P.], seq 1395064117:1395069621, ack 1233000592, win 342, options [nop,nop,TS val 78912216 ecr 78911976], length 550411:52:40.435782 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78912216 ecr 78912216], length 011:52:40.670661 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78912451 ecr 78912216], length 011:52:40.670674 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78912451 ecr 78912216], length 011:52:41.141703 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78912922 ecr 78912451], length 011:52:42.083643 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78913864 ecr 78912451], length 011:52:42.083655 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78913864 ecr 78912216], length 011:52:43.967506 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78915748 ecr 78913864], length 011:52:43.967532 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78915748 ecr 78912216], length 011:52:47.739259 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78919520 ecr 78915748], length 011:52:47.739274 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78919520 ecr 78912216], length 011:52:55.275863 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78927056 ecr 78919520], length 011:52:55.275931 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [.], ack 1395069621, win 0, options [nop,nop,TS val 78927056 ecr 78912216], length 0\n\næŠ“å–åˆ°çš„å‰ä¸‰ä¸ªæ•°æ®åŒ…æ˜¯ blocking_client ä¸ blocking_server å»ºç«‹ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚\n12311:52:35.907381 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [S], seq 1394135076, win 43690, options [mss 65495,sackOK,TS val 78907688 ecr 0,nop,wscale 7], length 020:32:21.261484 IP 127.0.0.1.3000 &gt; 127.0.0.1.40846: Flags [S.], seq 1233000591, ack 1394135077, win 43690, options [mss 65495,sackOK,TS val 78907688 ecr 78907688,nop,wscale 7], length 011:52:35.907441 IP 127.0.0.1.40846 &gt; 127.0.0.1.3000: Flags [.], ack 1233000592, win 342, options [nop,nop,TS val 78907688 ecr 78907688], length 0\n\nç¤ºæ„å›¾å¦‚ä¸‹ï¼š\n\nå½“æ¯æ¬¡ blocking_client ç»™ blocking_server å‘æ•°æ®ä»¥åï¼Œblocking_server ä¼šåº”ç­” blocking_serverï¼Œåœ¨æ¯æ¬¡åº”ç­”çš„æ•°æ®åŒ…ä¸­ä¼šå¸¦ä¸Šè‡ªå·±çš„å½“å‰å¯ç”¨ TCP çª—å£å¤§å°ï¼ˆçœ‹ä¸Šæ–‡ä¸­ç»“æœä» 127.0.0.1.3000 &gt; 127.0.0.1.40846æ–¹å‘çš„æ•°æ®åŒ…çš„ win å­—æ®µå¤§å°å˜åŒ–ï¼‰ï¼Œç”±äº TCP æµé‡æ§åˆ¶å’Œæ‹¥èµ›æ§åˆ¶æœºåˆ¶çš„å­˜åœ¨ï¼Œblocking_server ç«¯çš„ TCP çª—å£å¤§å°çŸ­æœŸå†…ä¼šæ…¢æ…¢å¢åŠ ï¼Œåé¢éšç€æ¥æ”¶ç¼“å†²åŒºä¸­æ•°æ®ç§¯å‹è¶Šæ¥è¶Šå¤šï¼Œ TCP çª—å£ä¼šæ…¢æ…¢å˜å°ï¼Œæœ€ç»ˆå˜ä¸º 0ã€‚\nå¦å¤–ï¼Œç»†å¿ƒçš„è¯»è€…å¦‚æœå®é™…å»åšä¸€ä¸‹è¿™ä¸ªå®éªŒä¼šå‘ç°ä¸€ä¸ªç°è±¡ï¼Œå³å½“ tcpdump å·²ç»æ˜¾ç¤ºå¯¹ç«¯çš„ TCP çª—å£æ˜¯ 0 æ—¶ï¼Œ blocking_client ä»ç„¶å¯ä»¥ç»§ç»­å‘é€ä¸€æ®µæ—¶é—´çš„æ•°æ®ï¼Œæ­¤æ—¶çš„æ•°æ®å·²ç»ä¸æ˜¯åœ¨å‘å¾€å¯¹ç«¯ï¼Œè€Œæ˜¯é€æ¸å¡«æ»¡åˆ°æœ¬ç«¯çš„å†…æ ¸å‘é€ç¼“å†²åŒºä¸­å»äº†ï¼Œè¿™ä¹ŸéªŒè¯äº† send å‡½æ•°å®é™…ä¸Šæ˜¯å¾€å†…æ ¸ç¼“å†²åŒºä¸­æ‹·è´æ•°æ®è¿™ä¸€è¡Œä¸ºã€‚\nsocket éé˜»å¡æ¨¡å¼ä¸‹çš„ send è¡Œä¸ºæˆ‘ä»¬å†æ¥éªŒè¯ä¸€ä¸‹éé˜»å¡ socket çš„ send è¡Œä¸ºï¼Œserver ç«¯çš„ä»£ç ä¸å˜ï¼Œæˆ‘ä»¬å°† blocking_client.cpp ä¸­ socket è®¾ç½®æˆéé˜»å¡çš„ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495/** * éªŒè¯éé˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°çš„è¡Œä¸ºï¼Œclientç«¯ï¼Œnonblocking_client.cpp * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;fcntl.h&gt;#include &lt;errno.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    //è¿æ¥æˆåŠŸä»¥åï¼Œæˆ‘ä»¬å†å°† clientfd è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œ    //ä¸èƒ½åœ¨åˆ›å»ºæ—¶å°±è®¾ç½®ï¼Œè¿™æ ·ä¼šå½±å“åˆ° connect å‡½æ•°çš„è¡Œä¸º    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)    &#123;        close(clientfd);        std::cout &lt;&lt; &quot;set socket to nonblock error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //3. ä¸æ–­å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œæˆ–è€…å‡ºé”™é€€å‡º    int count = 0;    while (true)    &#123;        int ret = send(clientfd, SEND_DATA, strlen(SEND_DATA), 0);        if (ret == -1)         &#123;            //éé˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°ç”±äºTCPçª—å£å¤ªå°å‘ä¸å‡ºå»æ•°æ®ï¼Œé”™è¯¯ç æ˜¯EWOULDBLOCK            if (errno == EWOULDBLOCK)            &#123;                std::cout &lt;&lt; &quot;send data error as TCP Window size is too small.&quot; &lt;&lt; std::endl;                continue;            &#125;             else if (errno == EINTR)            &#123;                //å¦‚æœè¢«ä¿¡å·ä¸­æ–­ï¼Œæˆ‘ä»¬ç»§ç»­é‡è¯•                std::cout &lt;&lt; &quot;sending data interrupted by signal.&quot; &lt;&lt; std::endl;                continue;            &#125;             else             &#123;                std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;                break;            &#125;        &#125;        if (ret == 0)        &#123;            //å¯¹ç«¯å…³é—­äº†è¿æ¥ï¼Œæˆ‘ä»¬ä¹Ÿå…³é—­            std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;            close(clientfd);            break;        &#125;         else        &#123;            count ++;            std::cout &lt;&lt; &quot;send data successfully, count = &quot; &lt;&lt; count &lt;&lt; std::endl;        &#125;    &#125;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\nç¼–è¯‘ nonblocking_client.cpp å¾—åˆ°å¯æ‰§è¡Œç¨‹åº nonblocking_clientï¼š\n1g++ -g -o nonblocking_client nonblocking_client.cpp \n\nè¿è¡Œ nonblocking_clientï¼Œè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œç”±äºå¯¹ç«¯å’Œæœ¬ç«¯çš„ TCP çª—å£å·²æ»¡ï¼Œæ•°æ®å‘ä¸å‡ºå»äº†ï¼Œä½†æ˜¯ send å‡½æ•°ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯ç«‹å³è¿”å›ï¼Œè¿”å›å€¼æ˜¯ -1ï¼ˆWindows ç³»ç»Ÿä¸Š è¿”å› SOCKET_ERRORï¼Œè¿™ä¸ªå®çš„å€¼ä¹Ÿæ˜¯ -1ï¼‰ï¼Œæ­¤æ—¶å¾—åˆ°é”™è¯¯ç æ˜¯ EWOULDBLOCKã€‚æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\n\nsocket é˜»å¡æ¨¡å¼ä¸‹çš„ recv è¡Œä¸ºåœ¨äº†è§£äº† send å‡½æ•°çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹é˜»å¡æ¨¡å¼ä¸‹çš„ recv å‡½æ•°è¡Œä¸ºã€‚æœåŠ¡å™¨ç«¯ä»£ç ä¸éœ€è¦ä¿®æ”¹ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å®¢æˆ·ç«¯ä»£ç ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯ä¸ç»™å®¢æˆ·ç«¯å‘æ•°æ®ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯è°ƒç”¨ recv å‡½æ•°æ‰§è¡Œæµä¼šé˜»å¡åœ¨ recv å‡½æ•°è°ƒç”¨å¤„ã€‚ç»§ç»­ä¿®æ”¹ä¸€ä¸‹å®¢æˆ·ç«¯ä»£ç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/** * éªŒè¯é˜»å¡æ¨¡å¼ä¸‹recvå‡½æ•°çš„è¡Œä¸ºï¼Œclientç«¯ï¼Œblocking_client_recv.cpp * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    //ç›´æ¥è°ƒç”¨recvå‡½æ•°ï¼Œç¨‹åºä¼šé˜»å¡åœ¨recvå‡½æ•°è°ƒç”¨å¤„    char recvbuf[32] = &#123;0&#125;;    int ret = recv(clientfd, recvbuf, 32, 0);    if (ret &gt; 0)     &#123;        std::cout &lt;&lt; &quot;recv successfully.&quot; &lt;&lt; std::endl;    &#125;     else     &#123;        std::cout &lt;&lt; &quot;recv data error.&quot; &lt;&lt; std::endl;    &#125;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\nç¼–è¯‘ blocking_client_recv.cpp å¹¶ä½¿ç”¨å¯åŠ¨ï¼Œæˆ‘ä»¬å‘ç°ç¨‹åºæ—¢æ²¡æœ‰æ‰“å° recv è°ƒç”¨æˆåŠŸçš„ä¿¡æ¯ä¹Ÿæ²¡æœ‰è°ƒç”¨å¤±è´¥çš„ä¿¡æ¯ï¼Œå°†ç¨‹åºä¸­æ–­ä¸‹æ¥ï¼Œä½¿ç”¨ bt å‘½ä»¤æŸ¥çœ‹æ­¤æ—¶çš„è°ƒç”¨å †æ ˆï¼Œå‘ç°ç¨‹åºç¡®å®é˜»å¡åœ¨ recv å‡½æ•°è°ƒç”¨å¤„ã€‚\n123456789101112[root@localhost testsocket]# g++ -g -o blocking_client_recv blocking_client_recv.cpp [root@localhost testsocket]# gdb blocking_client_recvReading symbols from /root/testsocket/blocking_client_recv...done.(gdb) rStarting program: /root/testsocket/blocking_client_recv ^CProgram received signal SIGINT, Interrupt.0x00007ffff72f119d in recv () from /lib64/libc.so.6Missing separate debuginfos, use: debuginfo-install glibc-2.17-196.el7_4.2.x86_64 libgcc-4.8.5-16.el7_4.2.x86_64 libstdc++-4.8.5-16.el7_4.2.x86_64(gdb) bt#0  0x00007ffff72f119d in recv () from /lib64/libc.so.6#1  0x0000000000400b18 in main (argc=1, argv=0x7fffffffe588) at blocking_client_recv.cpp:40\n\nsocket éé˜»å¡æ¨¡å¼ä¸‹çš„ recv è¡Œä¸ºéé˜»å¡æ¨¡å¼ä¸‹å¦‚æœå½“å‰æ— æ•°æ®å¯è¯»ï¼Œrecv å‡½æ•°å°†ç«‹å³è¿”å›ï¼Œè¿”å›å€¼ä¸º -1ï¼Œé”™è¯¯ç ä¸º EWOULDBLOCKã€‚å°†å®¢æˆ·ç«¯ä»£ç ä¿®æˆä¸€ä¸‹ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990/** * éªŒè¯é˜»å¡æ¨¡å¼ä¸‹recvå‡½æ•°çš„è¡Œä¸ºï¼Œclientç«¯ï¼Œblocking_client_recv.cpp * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;fcntl.h&gt;#include &lt;errno.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)    &#123;        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    //è¿æ¥æˆåŠŸä»¥åï¼Œæˆ‘ä»¬å†å°† clientfd è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œ    //ä¸èƒ½åœ¨åˆ›å»ºæ—¶å°±è®¾ç½®ï¼Œè¿™æ ·ä¼šå½±å“åˆ° connect å‡½æ•°çš„è¡Œä¸º    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)    &#123;        close(clientfd);        std::cout &lt;&lt; &quot;set socket to nonblock error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //ç›´æ¥è°ƒç”¨recvå‡½æ•°ï¼Œç¨‹åºä¼šé˜»å¡åœ¨recvå‡½æ•°è°ƒç”¨å¤„    while (true)    &#123;        char recvbuf[32] = &#123;0&#125;;        int ret = recv(clientfd, recvbuf, 32, 0);        if (ret &gt; 0)         &#123;            //æ”¶åˆ°äº†æ•°æ®            std::cout &lt;&lt; &quot;recv successfully.&quot; &lt;&lt; std::endl;        &#125;         else if (ret == 0)        &#123;            //å¯¹ç«¯å…³é—­äº†è¿æ¥            std::cout &lt;&lt; &quot;peer close the socket.&quot; &lt;&lt; std::endl;             break;        &#125;         else if (ret == -1)         &#123;            if (errno == EWOULDBLOCK)            &#123;                std::cout &lt;&lt; &quot;There is no data available now.&quot; &lt;&lt; std::endl;            &#125;             else if (errno == EINTR)             &#123;                //å¦‚æœè¢«ä¿¡å·ä¸­æ–­äº†ï¼Œåˆ™ç»§ç»­é‡è¯•recvå‡½æ•°                std::cout &lt;&lt; &quot;recv data interrupted by signal.&quot; &lt;&lt; std::endl;                           &#125; else            &#123;                //çœŸçš„å‡ºé”™äº†                break;            &#125;        &#125;    &#125;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\næ‰§è¡Œç»“æœä¸æˆ‘ä»¬é¢„æœŸçš„ä¸€æ¨¡ä¸€æ ·ï¼Œ recv å‡½æ•°åœ¨æ— æ•°æ®å¯è¯»çš„æƒ…å†µä¸‹å¹¶ä¸ä¼šé˜»å¡æƒ…ç»ªï¼Œæ‰€ä»¥ç¨‹åºä¼šä¸€ç›´æœ‰â€œ**There is no data available now.**â€ç›¸å…³çš„è¾“å‡ºã€‚\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/socketçš„é˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c646ab357404b495e460a8a7d56a1d77","title":"ã€è½¬è½½ã€‘connectå‡½æ•°åœ¨é˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹çš„è¡Œä¸º","content":"connect å‡½æ•°åœ¨é˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹çš„è¡Œä¸ºåœ¨ socket æ˜¯é˜»å¡æ¨¡å¼ä¸‹ connect å‡½æ•°ä¼šä¸€ç›´åˆ°æœ‰æ˜ç¡®çš„ç»“æœæ‰ä¼šè¿”å›ï¼ˆæˆ–è¿æ¥æˆåŠŸæˆ–è¿æ¥å¤±è´¥ï¼‰ï¼Œå¦‚æœæœåŠ¡å™¨åœ°å€â€œè¾ƒè¿œâ€ï¼Œè¿æ¥é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œconnect å‡½æ•°åœ¨è¿æ¥è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºé˜»å¡åœ¨ connect å‡½æ•°å¤„å¥½ä¸€ä¼šå„¿ï¼ˆå¦‚ä¸¤ä¸‰ç§’ä¹‹ä¹…ï¼‰ï¼Œè™½ç„¶è¿™ä¸€èˆ¬ä¹Ÿä¸ä¼šå¯¹ä¾èµ–äºç½‘ç»œé€šä¿¡çš„ç¨‹åºé€ æˆä»€ä¹ˆå½±å“ï¼Œä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å€¾å‘ä½¿ç”¨æ‰€è°“çš„å¼‚æ­¥çš„ connect æŠ€æœ¯ï¼Œæˆ–è€…å«éé˜»å¡çš„ connectã€‚è¿™ä¸ªæµç¨‹ä¸€èˆ¬æœ‰å¦‚ä¸‹æ­¥éª¤ï¼š\n1231. åˆ›å»ºsocketï¼Œå¹¶å°† socket è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼›2. è°ƒç”¨ connect å‡½æ•°ï¼Œæ­¤æ—¶æ— è®º connect å‡½æ•°æ˜¯å¦è¿æ¥æˆåŠŸä¼šç«‹å³è¿”å›ï¼›å¦‚æœè¿”å›-1å¹¶ä¸è¡¨ç¤ºè¿æ¥å‡ºé”™ï¼Œå¦‚æœæ­¤æ—¶é”™è¯¯ç æ˜¯EINPROGRESS3. æ¥ç€è°ƒç”¨ select å‡½æ•°ï¼Œåœ¨æŒ‡å®šçš„æ—¶é—´å†…åˆ¤æ–­è¯¥ socket æ˜¯å¦å¯å†™ï¼Œå¦‚æœå¯å†™è¯´æ˜è¿æ¥æˆåŠŸï¼Œåä¹‹åˆ™è®¤ä¸ºè¿æ¥å¤±è´¥ã€‚\n\næŒ‰ä¸Šè¿°æµç¨‹ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091/** * å¼‚æ­¥çš„connectå†™æ³•ï¼Œnonblocking_connect.cpp * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;fcntl.h&gt;#include &lt;errno.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è¿æ¥æˆåŠŸä»¥åï¼Œæˆ‘ä»¬å†å°† clientfd è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œ    //ä¸èƒ½åœ¨åˆ›å»ºæ—¶å°±è®¾ç½®ï¼Œè¿™æ ·ä¼šå½±å“åˆ° connect å‡½æ•°çš„è¡Œä¸º    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)    &#123;        close(clientfd);        std::cout &lt;&lt; &quot;set socket to nonblock error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    for (;;)    &#123;        int ret = connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr));        if (ret == 0)        &#123;            std::cout &lt;&lt; &quot;connect to server successfully.&quot; &lt;&lt; std::endl;            close(clientfd);            return 0;        &#125;         else if (ret == -1)         &#123;            if (errno == EINTR)            &#123;                //connect åŠ¨ä½œè¢«ä¿¡å·ä¸­æ–­ï¼Œé‡è¯•connect                std::cout &lt;&lt; &quot;connecting interruptted by signal, try again.&quot; &lt;&lt; std::endl;                continue;            &#125; else if (errno == EINPROGRESS)            &#123;                //è¿æ¥æ­£åœ¨å°è¯•ä¸­                break;            &#125; else &#123;                //çœŸçš„å‡ºé”™äº†ï¼Œ                close(clientfd);                return -1;            &#125;        &#125;    &#125;    fd_set writeset;    FD_ZERO(&amp;writeset);    FD_SET(clientfd, &amp;writeset);    //å¯ä»¥åˆ©ç”¨tv_secå’Œtv_usecåšæ›´å°ç²¾åº¦çš„è¶…æ—¶æ§åˆ¶    struct timeval tv;    tv.tv_sec = 3;      tv.tv_usec = 0;    if (select(clientfd + 1, NULL, &amp;writeset, NULL, &amp;tv) == 1)    &#123;        std::cout &lt;&lt; &quot;[select] connect to server successfully.&quot; &lt;&lt; std::endl;    &#125; else &#123;        std::cout &lt;&lt; &quot;[select] connect to server error.&quot; &lt;&lt; std::endl;    &#125;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\nä¸ºäº†åŒºåˆ«åˆ°åº•æ˜¯åœ¨è°ƒç”¨ connect å‡½æ•°æ—¶åˆ¤æ–­è¿æ¥æˆåŠŸè¿˜æ˜¯é€šè¿‡ select å‡½æ•°åˆ¤æ–­è¿æ¥æˆåŠŸï¼Œæˆ‘ä»¬åœ¨åè€…çš„è¾“å‡ºå†…å®¹ä¸­åŠ ä¸Šäº†â€œ**[select]**â€æ ‡ç­¾ä»¥ç¤ºåŒºåˆ«ã€‚\næˆ‘ä»¬å…ˆç”¨ nc å‘½ä»¤å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºï¼š\n1nc -v -l 0.0.0.0 3000\n\nç„¶åç¼–è¯‘å®¢æˆ·ç«¯ç¨‹åºå¹¶æ‰§è¡Œï¼š\n123[root@localhost testsocket]# g++ -g -o nonblocking_connect nonblocking_connect.cpp [root@localhost testsocket]# ./nonblocking_connect [select] connect to server successfully.\n\næˆ‘ä»¬æŠŠæœåŠ¡å™¨ç¨‹åºå…³æ‰ï¼Œå†é‡æ–°å¯åŠ¨ä¸€ä¸‹å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ä¼šè¿æ¥å¤±è´¥ï¼Œç¨‹åºè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š\n12[root@localhost testsocket]# ./nonblocking_connect [select] connect to server successfully.\n\nå¥‡æ€ªï¼Ÿä¸ºä»€ä¹ˆè¿æ¥ä¸ä¸Šä¹Ÿä¼šå¾—å‡ºä¸€æ ·çš„è¾“å‡ºç»“æœï¼Ÿéš¾é“ç¨‹åºæœ‰é—®é¢˜ï¼Ÿè¿™æ˜¯å› ä¸ºï¼š\n\nåœ¨ Windows ç³»ç»Ÿä¸Šï¼Œä¸€ä¸ª socket æ²¡æœ‰å»ºç«‹è¿æ¥ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ select å‡½æ•°æ£€æµ‹å…¶æ˜¯å¦å¯å†™ï¼Œèƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼ˆä¸å¯å†™ï¼‰ï¼Œè¿æ¥æˆåŠŸåæ£€æµ‹ï¼Œä¼šå˜ä¸ºå¯å†™ã€‚æ‰€ä»¥ï¼Œä¸Šè¿°ä»‹ç»çš„å¼‚æ­¥ connect å†™æ³•æµç¨‹åœ¨ Windows ç³»ç»Ÿä¸Šæ—¶æ²¡æœ‰é—®é¢˜çš„ã€‚\nåœ¨ Linux ç³»ç»Ÿä¸Šä¸€ä¸ª socket æ²¡æœ‰å»ºç«‹è¿æ¥ä¹‹å‰ï¼Œç”¨ select å‡½æ•°æ£€æµ‹å…¶æ˜¯å¦å¯å†™ï¼Œä½ ä¹Ÿä¼šå¾—åˆ°å¯å†™å¾—ç»“æœï¼Œæ‰€ä»¥ä¸Šè¿°æµç¨‹å¹¶ä¸é€‚ç”¨äº Linux ç³»ç»Ÿã€‚æ­£ç¡®çš„åšæ³•æ˜¯ï¼Œconnect ä¹‹åï¼Œä¸ä»…è¦ç”¨ select æ£€æµ‹å¯å†™ï¼Œè¿˜è¦æ£€æµ‹æ­¤æ—¶ socket æ˜¯å¦å‡ºé”™ï¼Œé€šè¿‡é”™è¯¯ç æ¥æ£€æµ‹ç¡®å®šæ˜¯å¦è¿æ¥ä¸Šï¼Œé”™è¯¯ç ä¸º 0 è¡¨ç¤ºè¿æ¥ä¸Šï¼Œåä¹‹ä¸ºæœªè¿æ¥ä¸Šã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104/** * Linux ä¸‹æ­£ç¡®çš„å¼‚æ­¥çš„connectå†™æ³•ï¼Œlinux_nonblocking_connect.cpp * zhangyl 2018.12.17 */#include &lt;sys/types.h&gt; #include &lt;sys/socket.h&gt;#include &lt;arpa/inet.h&gt;#include &lt;unistd.h&gt;#include &lt;iostream&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;fcntl.h&gt;#include &lt;errno.h&gt;#define SERVER_ADDRESS &quot;127.0.0.1&quot;#define SERVER_PORT     3000#define SEND_DATA       &quot;helloworld&quot;int main(int argc, char* argv[])&#123;    //1.åˆ›å»ºä¸€ä¸ªsocket    int clientfd = socket(AF_INET, SOCK_STREAM, 0);    if (clientfd == -1)    &#123;        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //è¿æ¥æˆåŠŸä»¥åï¼Œæˆ‘ä»¬å†å°† clientfd è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œ    //ä¸èƒ½åœ¨åˆ›å»ºæ—¶å°±è®¾ç½®ï¼Œè¿™æ ·ä¼šå½±å“åˆ° connect å‡½æ•°çš„è¡Œä¸º    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);    int newSocketFlag = oldSocketFlag | O_NONBLOCK;    if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)    &#123;        close(clientfd);        std::cout &lt;&lt; &quot;set socket to nonblock error.&quot; &lt;&lt; std::endl;        return -1;    &#125;    //2.è¿æ¥æœåŠ¡å™¨    struct sockaddr_in serveraddr;    serveraddr.sin_family = AF_INET;    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);    serveraddr.sin_port = htons(SERVER_PORT);    for (;;)    &#123;        int ret = connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr));        if (ret == 0)        &#123;            std::cout &lt;&lt; &quot;connect to server successfully.&quot; &lt;&lt; std::endl;            close(clientfd);            return 0;        &#125;         else if (ret == -1)         &#123;            if (errno == EINTR)            &#123;                //connect åŠ¨ä½œè¢«ä¿¡å·ä¸­æ–­ï¼Œé‡è¯•connect                std::cout &lt;&lt; &quot;connecting interruptted by signal, try again.&quot; &lt;&lt; std::endl;                continue;            &#125; else if (errno == EINPROGRESS)            &#123;                //è¿æ¥æ­£åœ¨å°è¯•ä¸­                break;            &#125; else &#123;                //çœŸçš„å‡ºé”™äº†ï¼Œ                close(clientfd);                return -1;            &#125;        &#125;    &#125;    fd_set writeset;    FD_ZERO(&amp;writeset);    FD_SET(clientfd, &amp;writeset);    //å¯ä»¥åˆ©ç”¨tv_secå’Œtv_usecåšæ›´å°ç²¾åº¦çš„è¶…æ—¶æ§åˆ¶    struct timeval tv;    tv.tv_sec = 3;      tv.tv_usec = 0;    if (select(clientfd + 1, NULL, &amp;writeset, NULL, &amp;tv) != 1)    &#123;        std::cout &lt;&lt; &quot;[select] connect to server error.&quot; &lt;&lt; std::endl;        close(clientfd);        return -1;    &#125;    int err;    socklen_t len = static_cast&lt;socklen_t&gt;(sizeof err);    if (::getsockopt(clientfd, SOL_SOCKET, SO_ERROR, &amp;err, &amp;len) &lt; 0)    &#123;        close(clientfd);        return -1;    &#125;    if (err == 0)        std::cout &lt;&lt; &quot;connect to server successfully.&quot; &lt;&lt; std::endl;    else        std::cout &lt;&lt; &quot;connect to server error.&quot; &lt;&lt; std::endl;    //5. å…³é—­socket    close(clientfd);    return 0;&#125;\n\n\nå½“ç„¶ï¼Œåœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œç¬¬ 3 ä¸ªæ­¥éª¤ä¸­ Linux å¹³å°ä¸Šä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ poll å‡½æ•°æ¥åˆ¤æ–­ socket æ˜¯å¦å¯å†™ï¼›åœ¨ Windows å¹³å°ä¸Šä½ å¯ä»¥ä½¿ç”¨ WSAEventSelect æˆ– WSAAsyncSelect å‡½æ•°åˆ¤æ–­è¿æ¥æ˜¯å¦æˆåŠŸï¼Œå…³äºè¿™ä¸‰ä¸ªå‡½æ•°æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä¸­è¯¦ç»†è®²è§£ï¼Œè¿™é‡Œæš‚ä¸”ä»…ä»¥ select å‡½æ•°ä¸ºä¾‹ã€‚\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/connectå‡½æ•°åœ¨é˜»å¡å’Œéé˜»å¡æ¨¡å¼ä¸‹çš„è¡Œä¸º","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"f4314c9e2807b5be1e4e59a1606b1819","title":"ã€è½¬è½½ã€‘æœåŠ¡å™¨å¼€å‘é€šä¿¡åè®®è®¾è®¡ä»‹ç»","content":"æœåŠ¡å™¨å¼€å‘é€šä¿¡åè®®è®¾è®¡ä»‹ç»\nä¸€ã€é€‰æ‹©TCPè¿˜æ˜¯UDPåè®®ç”±äºæˆ‘ä»¬çš„å³æ—¶é€šè®¯è½¯ä»¶çš„ç”¨æˆ·å­˜åœ¨ç”¨æˆ·çŠ¶æ€é—®é¢˜ï¼Œå³ç”¨æˆ·ç™»å½•æˆåŠŸä»¥åå¯ä»¥åœ¨ä»–çš„å¥½å‹åˆ—è¡¨ä¸­çœ‹åˆ°å“ªäº›å¥½å‹åœ¨çº¿ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦ä¿æŒé•¿è¿æ¥çŠ¶æ€ã€‚å¦å¤–å³æ—¶é€šè®¯è½¯ä»¶ä¸€èˆ¬è¦æ±‚ä¿¡æ¯å‡†ç¡®ã€æœ‰åºã€å®Œæ•´åœ°åˆ°è¾¾å¯¹ç«¯ï¼Œè€Œè¿™ä¹Ÿæ˜¯TCPåè®®çš„ç‰¹ç‚¹ä¹‹ä¸€ã€‚ç»¼åˆè¿™ä¸¤ä¸ªæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é€‰æ‹©TCPåè®®ï¼Œè€Œä¸æ˜¯UDPåè®®ã€‚\näºŒã€åè®®çš„ç»“æ„ç”±äºTCPåè®®æ˜¯æµå¼åè®®ï¼Œæ‰€è°“æµå¼åè®®å³é€šè®¯çš„å†…å®¹æ˜¯æ— è¾¹ç•Œçš„å­—èŠ‚æµï¼šå¦‚Aç»™Bè¿ç»­å‘é€äº†ä¸‰ä¸ªæ•°æ®åŒ…ï¼Œæ¯ä¸ªåŒ…çš„å¤§å°éƒ½æ˜¯100ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆBå¯èƒ½ä¼šä¸€æ¬¡æ€§æ”¶åˆ°300ä¸ªå­—èŠ‚ï¼›ä¹Ÿå¯èƒ½å…ˆæ”¶åˆ°100ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°200ä¸ªå­—èŠ‚ï¼›ä¹Ÿå¯èƒ½å…ˆæ”¶åˆ°100ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°50ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°150ä¸ªå­—èŠ‚ï¼›æˆ–è€…å…ˆæ”¶åˆ°50ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°50ä¸ªå­—èŠ‚ï¼Œå†æ”¶åˆ°50ä¸ªå­—èŠ‚ï¼Œæœ€åæ”¶åˆ°150ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒBå¯èƒ½ä»¥ä»»ä½•ç»„åˆå½¢å¼æ”¶åˆ°è¿™300ä¸ªå­—èŠ‚ã€‚å³åƒæ°´æµä¸€æ ·æ— æ˜ç¡®çš„è¾¹ç•Œã€‚ä¸ºäº†èƒ½è®©å¯¹ç«¯çŸ¥é“å¦‚ä½•ç»™åŒ…åˆ†ç•Œï¼Œç›®å‰ä¸€èˆ¬æœ‰ä¸‰ç§åšæ³•ï¼š\n\nä»¥å›ºå®šå¤§å°å­—èŠ‚æ•°ç›®æ¥åˆ†ç•Œï¼Œä¸Šæ–‡æ‰€è¯´çš„å°±æ˜¯å±äºè¿™ç§ç±»å‹ï¼Œå¦‚æ¯ä¸ªåŒ…100ä¸ªå­—èŠ‚ï¼Œå¯¹ç«¯æ¯æ”¶é½100ä¸ªå­—èŠ‚ï¼Œå°±å½“æˆä¸€ä¸ªåŒ…æ¥è§£æï¼›\nä»¥ç‰¹å®šç¬¦å·æ¥åˆ†ç•Œï¼Œå¦‚æ¯ä¸ªåŒ…éƒ½ä»¥ç‰¹å®šçš„å­—ç¬¦æ¥ç»“å°¾ï¼ˆå¦‚\\nï¼‰ï¼Œå½“åœ¨å­—èŠ‚æµä¸­è¯»å–åˆ°è¯¥å­—ç¬¦æ—¶ï¼Œåˆ™è¡¨æ˜ä¸Šä¸€ä¸ªåŒ…åˆ°æ­¤ä¸ºæ­¢ã€‚\nå›ºå®šåŒ…å¤´+åŒ…ä½“ç»“æ„ï¼Œè¿™ç§ç»“æ„ä¸­ä¸€èˆ¬åŒ…å¤´éƒ¨åˆ†æ˜¯ä¸€ä¸ªå›ºå®šå­—èŠ‚é•¿åº¦çš„ç»“æ„ï¼Œå¹¶ä¸”åŒ…å¤´ä¸­ä¼šæœ‰ä¸€ä¸ªç‰¹å®šçš„å­—æ®µæŒ‡å®šåŒ…ä½“çš„å¤§å°ã€‚è¿™æ˜¯ç›®å‰å„ç§ç½‘ç»œåº”ç”¨ç”¨çš„æœ€å¤šçš„ä¸€ç§åŒ…æ ¼å¼ã€‚\n\nä¸Šé¢ä¸‰ç§åˆ†åŒ…æ–¹å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œæ–¹æ³•1å’Œæ–¹æ³•2ç®€å•æ˜“æ“ä½œï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å¾ˆä¸çµæ´»ï¼Œå¦‚æ–¹æ³•ä¸€å½“åŒ…æ•°æ®ä¸è¶³æŒ‡å®šé•¿åº¦ï¼Œåªèƒ½ä½¿ç”¨å ä½ç¬¦å¦‚0æ¥å‡‘ï¼Œæ¯”è¾ƒæµªè´¹ï¼›æ–¹æ³•2ä¸­åŒ…ä¸­ä¸èƒ½æœ‰åŒ…ç•Œå®šç¬¦ï¼Œå¦åˆ™å°±ä¼šå¼•èµ·æ­§ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¦æ±‚åŒ…å†…å®¹ä¸­ä¸èƒ½æœ‰æŸäº›ç‰¹æ®Šç¬¦å·ã€‚è€Œæ–¹æ³•3è™½ç„¶è§£å†³äº†æ–¹æ³•1å’Œæ–¹æ³•2çš„ç¼ºç‚¹ï¼Œä½†æ˜¯æ“ä½œèµ·æ¥å°±æ¯”è¾ƒéº»çƒ¦ã€‚æˆ‘ä»¬çš„å³æ—¶é€šè®¯åè®®å°±é‡‡ç”¨ç¬¬ä¸‰ç§åˆ†åŒ…æ–¹å¼ã€‚æ‰€ä»¥æˆ‘ä»¬çš„åè®®åŒ…çš„åŒ…å¤´çœ‹èµ·æ¥åƒè¿™æ ·ï¼š\n1234struct package_header&#123;    int32_t bodysize;&#125;;\n\nä¸€ä¸ªåº”ç”¨ä¸­ï¼Œæœ‰è®¸å¤šçš„åº”ç”¨æ•°æ®ï¼Œæ‹¿æˆ‘ä»¬è¿™é‡Œçš„å³æ—¶é€šè®¯æ¥è¯´ï¼Œæœ‰æ³¨å†Œã€ç™»å½•ã€è·å–å¥½å‹åˆ—è¡¨ã€å¥½å‹æ¶ˆæ¯ç­‰å„ç§å„æ ·çš„åè®®æ•°æ®åŒ…ï¼Œè€Œæ¯ä¸ªåŒ…å› ä¸ºä¸šåŠ¡å†…å®¹ä¸ä¸€æ ·å¯èƒ½æ•°æ®å†…å®¹ä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥å„ä¸ªåŒ…å¯èƒ½çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758struct package_header&#123;    int32_t bodysize;&#125;;//ç™»å½•æ•°æ®åŒ…struct register_package&#123;    package_header header;    //å‘½ä»¤å·    int32_t cmd;    //æ³¨å†Œç”¨æˆ·å    char username[16];    //æ³¨å†Œå¯†ç     char password[16];    //æ³¨å†Œæ˜µç§°    char nickname[16];    //æ³¨å†Œæ‰‹æœºå·    char mobileno[16];&#125;;//ç™»å½•æ•°æ®åŒ…struct login_package&#123;    package_header header;    //å‘½ä»¤å·    int32_t cmd;    //ç™»å½•ç”¨æˆ·å    char username[16];    //å¯†ç     char password[16];    //å®¢æˆ·ç«¯ç±»å‹    int32_t clienttype;    //ä¸Šçº¿ç±»å‹ï¼Œå¦‚åœ¨çº¿ã€éšèº«ã€å¿™ç¢Œã€ç¦»å¼€ç­‰    int32_t onlinetype;&#125;;//è·å–å¥½å‹åˆ—è¡¨struct getfriend_package&#123;    package_header header;    //å‘½ä»¤å·    int32_t cmd;&#125;;//èŠå¤©å†…å®¹struct chat_package&#123;    package_header header;    //å‘½ä»¤å·    int32_t cmd;    //å‘é€äººuserid    int32_t senderid;    //æ¥æ”¶äººuserid    int32_t targetid;    //æ¶ˆæ¯å†…å®¹    char chatcontent[8192];&#125;;\n\nçœ‹åˆ°æ²¡æœ‰ï¼Ÿç”±äºæ¯ä¸€ä¸ªä¸šåŠ¡çš„å†…å®¹ä¸ä¸€æ ·ï¼Œå®šä¹‰çš„ç»“æ„ä½“ä¹Ÿä¸ä¸€æ ·ã€‚å¦‚æœä¸šåŠ¡æ¯”è¾ƒå¤šçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å„ç§å„æ ·çš„è¿™ç§ç»“æ„ä½“ï¼Œè¿™ç®€ç›´æ˜¯ä¸€åœºå™©æ¢¦ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæœ‰ï¼Œæˆ‘å—jdkä¸­çš„æµå¯¹è±¡çš„WriteInt32ã€WriteByteã€WriteInt64ã€WriteStringï¼Œè¿™æ ·çš„æ¥å£çš„å¯å‘ï¼Œä¹Ÿå‘æ˜äº†ä¸€å¥—è¿™æ ·çš„åè®®ï¼Œè€Œä¸”è¿™å¥—åè®®åŸºæœ¬ä¸Šæ˜¯é€šç”¨åè®®ï¼Œå¯ç”¨äºä»»ä½•åœºæ™¯ã€‚æˆ‘ä»¬çš„åŒ…è¿˜æ˜¯åˆ†ä¸ºåŒ…å¤´å’ŒåŒ…ä½“ä¸¤éƒ¨åˆ†ï¼ŒåŒ…å¤´å’Œä¸Šæ–‡æ‰€è¯´çš„ä¸€æ ·ï¼ŒåŒ…ä½“æ˜¯ä¸€ä¸ªä¸å›ºå®šå¤§å°çš„äºŒè¿›åˆ¶æµï¼Œå…¶é•¿åº¦ç”±åŒ…å¤´ä¸­çš„æŒ‡å®šåŒ…ä½“é•¿åº¦çš„å­—æ®µå†³å®šã€‚\n12345678struct package_protocol&#123;    int32_t bodysize;    //æ³¨æ„ï¼šC/C++è¯­æ³•ä¸èƒ½è¿™ä¹ˆå®šä¹‰ç»“æ„ä½“ï¼Œ    //è¿™é‡Œåªæ˜¯ä¸ºäº†è¯´æ˜å«ä¹‰çš„ä¼ªä»£ç     //bodycontentå³ä¸ºä¸€ä¸ªä¸å›ºå®šå¤§å°çš„äºŒè¿›åˆ¶æµ    char    binarystream[bodysize];&#125;;\n\næ¥ä¸‹æ¥çš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯å¦‚ä½•æ“ä½œè¿™ä¸ªäºŒè¿›åˆ¶æµï¼Œæˆ‘ä»¬å°†æµåˆ†ä¸ºäºŒè¿›åˆ¶è¯»å’ŒäºŒè¿›åˆ¶å†™ä¸¤ç§æµï¼Œä¸‹é¢ç»™å‡ºæ¥å£å®šä¹‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//å†™class BinaryWriteStream&#123;public:    BinaryWriteStream(string* data);    const char* GetData() const;    size_t GetSize() const;    bool WriteCString(const char* str, size_t len);    bool WriteString(const string&amp; str);    bool WriteDouble(double value, bool isNULL = false);    bool WriteInt64(int64_t value, bool isNULL = false);    bool WriteInt32(int32_t i, bool isNULL = false);    bool WriteShort(short i, bool isNULL = false);    bool WriteChar(char c, bool isNULL = false);    size_t GetCurrentPos() const&#123; return m_data-&gt;length(); &#125;    void Flush();    void Clear();private:    string* m_data;&#125;;//è¯»class BinaryReadStream : public IReadStream&#123;private:    const char* const ptr;    const size_t      len;    const char*       cur;    BinaryReadStream(const BinaryReadStream&amp;);    BinaryReadStream&amp; operator=(const BinaryReadStream&amp;);public:    BinaryReadStream(const char* ptr, size_t len);    const char* GetData() const;    size_t GetSize() const;    bool IsEmpty() const;    bool ReadString(string* str, size_t maxlen, size_t&amp; outlen);    bool ReadCString(char* str, size_t strlen, size_t&amp; len);    bool ReadCCString(const char** str, size_t maxlen, size_t&amp; outlen);    bool ReadInt32(int32_t&amp; i);    bool ReadInt64(int64_t&amp; i);    bool ReadShort(short&amp; i);    bool ReadChar(char&amp; c);    size_t ReadAll(char* szBuffer, size_t iLen) const;    bool IsEnd() const;    const char* GetCurrent() const&#123; return cur; &#125;public:    bool ReadLength(size_t &amp; len);    bool ReadLengthWithoutOffset(size_t &amp;headlen, size_t &amp; outlen);&#125;;\n\nè¿™æ ·å¦‚æœæ˜¯ä¸Šæ–‡çš„ä¸€ä¸ªç™»å½•æ•°æ®åŒ…ï¼Œæˆ‘ä»¬åªè¦å†™æˆå¦‚ä¸‹å½¢å¼å°±å¯ä»¥äº†ï¼š\n123456789std::string outbuf;BinaryWriteStream stream(&amp;outbuf);stream.WriteInt32(cmd);stream.WriteCString(username, 16);stream.WriteCString(password, 16);stream.WriteInt32(clienttype);stream.WriteInt32(onlinetype);//æœ€ç»ˆæ•°æ®å°±å­˜å‚¨åˆ°outbufä¸­å»äº†stream.Flush();\n\næ¥ç€æˆ‘ä»¬å†å¯¹ç«¯ï¼Œè§£å¾—æ­£ç¡®çš„åŒ…ä½“åï¼Œæˆ‘ä»¬åªè¦æŒ‰å†™å…¥çš„é¡ºåºä¾æ¬¡è¯»å‡ºæ¥å³å¯ï¼š\n1234567891011BinaryWriteStream stream(outbuf.c_str(), outbuf.length());int32_t cmd;stream.WriteInt32(cmd);char username[16];stream.ReadCString(username, 16, NULL);char password[16];stream.WriteCString(password, 16, NULL);int32_t clienttype;stream.WriteInt32(clienttype);int32_t onlinetype;stream.WriteInt32(onlinetype);\n\nè¿™é‡Œç»™å‡ºBinaryReadStreamå’ŒBinaryWriteStreamçš„å®Œæ•´å®ç°ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359//è®¡ç®—æ ¡éªŒå’Œunsigned short checksum(const unsigned short *buffer, int size)&#123;    unsigned int cksum = 0;    while (size &gt; 1)    &#123;        cksum += *buffer++;        size -= sizeof(unsigned short);    &#125;    if (size)    &#123;        cksum += *(unsigned char*)buffer;    &#125;    //å°†32ä½æ•°è½¬æ¢æˆ16    while (cksum &gt;&gt; 16)        cksum = (cksum &gt;&gt; 16) + (cksum &amp; 0xffff);    return (unsigned short)(~cksum);&#125;bool compress_(unsigned int i, char *buf, size_t &amp;len)&#123;    len = 0;    for (int a = 4; a &gt;= 0; a--)    &#123;        char c;        c = i &gt;&gt; (a * 7) &amp; 0x7f;        if (c == 0x00 &amp;&amp; len == 0)            continue;        if (a == 0)            c &amp;= 0x7f;        else            c |= 0x80;        buf[len] = c;        len++;    &#125;    if (len == 0)    &#123;        len++;        buf[0] = 0;    &#125;    //cout &lt;&lt; &quot;compress:&quot; &lt;&lt; i &lt;&lt; endl;    //cout &lt;&lt; &quot;compress len:&quot; &lt;&lt; len &lt;&lt; endl;    return true;&#125;bool uncompress_(char *buf, size_t len, unsigned int &amp;i)&#123;    i = 0;    for (int index = 0; index &lt; (int)len; index++)    &#123;        char c = *(buf + index);        i = i &lt;&lt; 7;        c &amp;= 0x7f;        i |= c;    &#125;    //cout &lt;&lt; &quot;uncompress:&quot; &lt;&lt; i &lt;&lt; endl;    return true;&#125;BinaryReadStream::BinaryReadStream(const char* ptr_, size_t len_)    : ptr(ptr_), len(len_), cur(ptr_)&#123;    cur += BINARY_PACKLEN_LEN_2 + CHECKSUM_LEN;&#125;bool BinaryReadStream::IsEmpty() const&#123;    return len &lt;= BINARY_PACKLEN_LEN_2;&#125;size_t BinaryReadStream::GetSize() const&#123;    return len;&#125;bool BinaryReadStream::ReadCString(char* str, size_t strlen, /* out */ size_t&amp; outlen)&#123;    size_t fieldlen;    size_t headlen;    if (!ReadLengthWithoutOffset(headlen, fieldlen)) &#123;        return false;    &#125;    // user buffer is not enough    if (fieldlen &gt; strlen) &#123;        return false;    &#125;    // åç§»åˆ°æ•°æ®çš„ä½ç½®    //cur += BINARY_PACKLEN_LEN_2;        cur += headlen;    if (cur + fieldlen &gt; ptr + len)    &#123;        outlen = 0;        return false;    &#125;    memcpy(str, cur, fieldlen);    outlen = fieldlen;    cur += outlen;    return true;&#125;bool BinaryReadStream::ReadString(string* str, size_t maxlen, size_t&amp; outlen)&#123;    size_t headlen;    size_t fieldlen;    if (!ReadLengthWithoutOffset(headlen, fieldlen)) &#123;        return false;    &#125;    // user buffer is not enough    if (maxlen != 0 &amp;&amp; fieldlen &gt; maxlen) &#123;        return false;    &#125;    // åç§»åˆ°æ•°æ®çš„ä½ç½®    //cur += BINARY_PACKLEN_LEN_2;        cur += headlen;    if (cur + fieldlen &gt; ptr + len)    &#123;        outlen = 0;        return false;    &#125;    str-&gt;assign(cur, fieldlen);    outlen = fieldlen;    cur += outlen;    return true;&#125;bool BinaryReadStream::ReadCCString(const char** str, size_t maxlen, size_t&amp; outlen)&#123;    size_t headlen;    size_t fieldlen;    if (!ReadLengthWithoutOffset(headlen, fieldlen)) &#123;        return false;    &#125;    // user buffer is not enough    if (maxlen != 0 &amp;&amp; fieldlen &gt; maxlen) &#123;        return false;    &#125;    // åç§»åˆ°æ•°æ®çš„ä½ç½®    //cur += BINARY_PACKLEN_LEN_2;        cur += headlen;    //memcpy(str, cur, fieldlen);    if (cur + fieldlen &gt; ptr + len)    &#123;        outlen = 0;        return false;    &#125;    *str = cur;    outlen = fieldlen;    cur += outlen;    return true;&#125;bool BinaryReadStream::ReadInt32(int32_t&amp; i)&#123;    const int VALUE_SIZE = sizeof(int32_t);    if (cur + VALUE_SIZE &gt; ptr + len)        return false;    memcpy(&amp;i, cur, VALUE_SIZE);    i = ntohl(i);    cur += VALUE_SIZE;    return true;&#125;bool BinaryReadStream::ReadInt64(int64_t&amp; i)&#123;    char int64str[128];    size_t length;    if (!ReadCString(int64str, 128, length))        return false;    i = atoll(int64str);    return true;&#125;bool BinaryReadStream::ReadShort(short&amp; i)&#123;    const int VALUE_SIZE = sizeof(short);    if (cur + VALUE_SIZE &gt; ptr + len) &#123;        return false;    &#125;    memcpy(&amp;i, cur, VALUE_SIZE);    i = ntohs(i);    cur += VALUE_SIZE;    return true;&#125;bool BinaryReadStream::ReadChar(char&amp; c)&#123;    const int VALUE_SIZE = sizeof(char);    if (cur + VALUE_SIZE &gt; ptr + len) &#123;        return false;    &#125;    memcpy(&amp;c, cur, VALUE_SIZE);    cur += VALUE_SIZE;    return true;&#125;bool BinaryReadStream::ReadLength(size_t &amp; outlen)&#123;    size_t headlen;    if (!ReadLengthWithoutOffset(headlen, outlen)) &#123;        return false;    &#125;    //cur += BINARY_PACKLEN_LEN_2;    cur += headlen;    return true;&#125;bool BinaryReadStream::ReadLengthWithoutOffset(size_t&amp; headlen, size_t &amp; outlen)&#123;    headlen = 0;    const char *temp = cur;    char buf[5];    for (size_t i = 0; i&lt;sizeof(buf); i++)    &#123;        memcpy(buf + i, temp, sizeof(char));        temp++;        headlen++;        //if ((buf[i] &gt;&gt; 7 | 0x0) == 0x0)        if ((buf[i] &amp; 0x80) == 0x00)            break;    &#125;    if (cur + headlen &gt; ptr + len)        return false;    unsigned int value;    uncompress_(buf, headlen, value);    outlen = value;    /*if ( cur + BINARY_PACKLEN_LEN_2 &gt; ptr + len ) &#123;    return false;    &#125;    unsigned int tmp;    memcpy(&amp;tmp, cur, sizeof(tmp));    outlen = ntohl(tmp);*/    return true;&#125;bool BinaryReadStream::IsEnd() const&#123;    assert(cur &lt;= ptr + len);    return cur == ptr + len;&#125;const char* BinaryReadStream::GetData() const&#123;    return ptr;&#125;size_t BinaryReadStream::ReadAll(char * szBuffer, size_t iLen) const&#123;    size_t iRealLen = min(iLen, len);    memcpy(szBuffer, ptr, iRealLen);    return iRealLen;&#125;//=================class BinaryWriteStream implementation============//BinaryWriteStream::BinaryWriteStream(string *data) :    m_data(data)&#123;    m_data-&gt;clear();    char str[BINARY_PACKLEN_LEN_2 + CHECKSUM_LEN];    m_data-&gt;append(str, sizeof(str));&#125;bool BinaryWriteStream::WriteCString(const char* str, size_t len)&#123;    char buf[5];    size_t buflen;    compress_(len, buf, buflen);    m_data-&gt;append(buf, sizeof(char)*buflen);    m_data-&gt;append(str, len);    //unsigned int ulen = htonl(len);    //m_data-&gt;append((char*)&amp;ulen,sizeof(ulen));    //m_data-&gt;append(str,len);    return true;&#125;bool BinaryWriteStream::WriteString(const string&amp; str)&#123;    return WriteCString(str.c_str(), str.length());&#125;const char* BinaryWriteStream::GetData() const&#123;    return m_data-&gt;data();&#125;size_t BinaryWriteStream::GetSize() const&#123;    return m_data-&gt;length();&#125;bool BinaryWriteStream::WriteInt32(int32_t i, bool isNULL)&#123;    int32_t i2 = 999999999;    if (isNULL == false)        i2 = htonl(i);    m_data-&gt;append((char*)&amp;i2, sizeof(i2));    return true;&#125;bool BinaryWriteStream::WriteInt64(int64_t value, bool isNULL)&#123;    char int64str[128];    if (isNULL == false)    &#123;    #ifndef _WIN32        sprintf(int64str, &quot;%ld&quot;, value);    #else        sprintf(int64str, &quot;%lld&quot;, value);    #endif        WriteCString(int64str, strlen(int64str));    &#125;    else        WriteCString(int64str, 0);    return true;&#125;bool BinaryWriteStream::WriteShort(short i, bool isNULL)&#123;    short i2 = 0;    if (isNULL == false)        i2 = htons(i);    m_data-&gt;append((char*)&amp;i2, sizeof(i2));    return true;&#125;bool BinaryWriteStream::WriteChar(char c, bool isNULL)&#123;    char c2 = 0;    if (isNULL == false)        c2 = c;    (*m_data) += c2;    return true;&#125;bool BinaryWriteStream::WriteDouble(double value, bool isNULL)&#123;    char   doublestr[128];    if (isNULL == false)    &#123;        sprintf(doublestr, &quot;%f&quot;, value);        WriteCString(doublestr, strlen(doublestr));    &#125;    else        WriteCString(doublestr, 0);    return true;&#125;void BinaryWriteStream::Flush()&#123;    char *ptr = &amp;(*m_data)[0];    unsigned int ulen = htonl(m_data-&gt;length());    memcpy(ptr, &amp;ulen, sizeof(ulen));&#125;void BinaryWriteStream::Clear()&#123;    m_data-&gt;clear();    char str[BINARY_PACKLEN_LEN_2 + CHECKSUM_LEN];    m_data-&gt;append(str, sizeof(str));&#125;\n\nè¿™é‡Œè¯¦ç»†è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„å®ç°åŸç†ï¼Œå³å¦‚ä½•æŠŠå„ç§ç±»å‹çš„å­—æ®µå†™å…¥è¿™ç§æ‰€è°“çš„æµä¸­ï¼Œæˆ–è€…æ€ä¹ˆä»è¿™ç§æµä¸­è¯»å‡ºå„ç§ç±»å‹çš„æ•°æ®ã€‚ä¸Šæ–‡çš„å­—æ®µåœ¨æµä¸­çš„æ ¼å¼å¦‚ä¸‹å›¾ï¼š\n\nè¿™é‡Œæœ€ç®€ä¾¿çš„æ–¹å¼å°±æ˜¯æ¯ä¸ªå­—æ®µçš„é•¿åº¦åŸŸéƒ½æ˜¯å›ºå®šå­—èŠ‚æ•°ç›®ï¼Œå¦‚4ä¸ªå­—èŠ‚ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿™ä¹ˆåšï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªå°å°æŠ€å·§å»å¯¹å­—æ®µé•¿åº¦è¿›è¡Œäº†ä¸€ç‚¹å‹ç¼©ã€‚å¯¹äºå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼Œæˆ‘ä»¬å°†è¡¨ç¤ºå…¶å­—æ®µé•¿åº¦åŸŸçš„æ•´å‹å€¼ï¼ˆint32ç±»å‹ï¼Œ4å­—èŠ‚ï¼‰æŒ‰ç…§å…¶æ•°å€¼çš„å¤§å°å‹ç¼©æˆ1ï½5ä¸ªå­—èŠ‚ï¼Œå¯¹äºæ¯ä¸€ä¸ªå­—èŠ‚ï¼Œå¦‚æœæˆ‘ä»¬åªç”¨å…¶ä½7ä½ã€‚æœ€é«˜ä½ä¸ºæ ‡å¿—ä½ï¼Œä¸º1æ—¶ï¼Œè¡¨ç¤ºå…¶å·¦è¾¹çš„è¿˜æœ‰ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œåä¹‹åˆ°æ­¤ç»“æŸã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ•°å­—127ï¼Œæˆ‘ä»¬äºŒè¿›åˆ¶è¡¨ç¤ºæˆ01111111ï¼Œç”±äºæœ€é«˜ä½æ˜¯0ï¼Œé‚£ä¹ˆå¦‚æœå­—æ®µé•¿åº¦æ˜¯127åŠä»¥ä¸‹ï¼Œä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥å­˜å‚¨ä¸‹äº†ã€‚å¦‚æœä¸€ä¸ªå­—æ®µé•¿åº¦å¤§äº127ï¼Œå¦‚ç­‰äº256ï¼Œå¯¹åº”äºŒè¿›åˆ¶100000000ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŒ‰ç…§åˆšæ‰çš„è§„åˆ™ï¼Œå…ˆå¡«å……æœ€ä½å­—èŠ‚ï¼ˆä»å·¦å¾€å³ä¾æ¬¡æ˜¯ä»ä½åˆ°é«˜ï¼‰ï¼Œç”±äºæœ€ä½çš„7ä½æ”¾ä¸ä¸‹ï¼Œè¿˜æœ‰åç»­é«˜ä½å­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æœ€ä½å­—èŠ‚çš„æœ€é«˜ä½ä¸Šå¡«1ï¼Œå³10000000ï¼Œæ¥ç€æ¬¡é«˜ä½ä¸º00000100ï¼Œç”±äºæ¬¡é«˜ä½åé¢æ²¡æœ‰æ›´é«˜ä½çš„å­—èŠ‚äº†ï¼Œæ‰€ä»¥å…¶æœ€é«˜ä½ä¸º0ï¼Œç»„åˆèµ·æ¥ä¸¤ä¸ªå­—èŠ‚å°±æ˜¯10000000 0000100ã€‚å¯¹äºæ•°å­—50000ï¼Œå…¶äºŒè¿›åˆ¶æ˜¯1100001101010000ï¼Œæ ¹æ®æ¯7ä¸ªä¸€æ‹†çš„åŸåˆ™æ˜¯ï¼š11 0000110 1010000å†åŠ ä¸Šæ ‡å¿—ä½å°±æ˜¯ï¼š10000011 10000110 01010000ã€‚é‡‡ç”¨è¿™æ ·ä¸€ç§ç­–ç•¥å°†åŸæ¥å 4ä¸ªå­—èŠ‚çš„æ•´å‹å€¼æ ¹æ®æ•°å€¼å¤§å°å‹ç¼©æˆäº†1ï½5ä¸ªå­—èŠ‚ï¼ˆç”±äºæˆ‘ä»¬å¯¹æ•°æ®åŒ…æœ€å¤§é•¿åº¦æœ‰é™åˆ¶ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°é•¿åº¦éœ€è¦å 5ä¸ªå­—èŠ‚çš„æƒ…å½¢ï¼‰ã€‚åè¿‡æ¥ï¼Œè§£ææ¯ä¸ªå­—æ®µçš„é•¿åº¦ï¼Œå°±æ˜¯å…ˆå–å‡ºä¸€ä¸ªå­—èŠ‚ï¼Œçœ‹å…¶æœ€é«˜ä½æ˜¯å¦æœ‰æ ‡å¿—ä½ï¼Œå¦‚æœæœ‰ç»§ç»­å–ä¸‹ä¸€ä¸ªå­—èŠ‚å½“å­—æ®µé•¿åº¦çš„ä¸€éƒ¨åˆ†ç»§ç»­è§£æï¼Œç›´åˆ°é‡åˆ°æŸä¸ªå­—èŠ‚æœ€é«˜ä½ä¸ä¸º1ä¸ºæ­¢ã€‚\nå¯¹ä¸€ä¸ªæ•´å½¢å‹ç¼©å’Œè§£å‹ç¼©çš„éƒ¨åˆ†ä»ä¸Šé¢çš„ä»£ç ä¸­æ‘˜å½•å¦‚ä¸‹ï¼š\nå‹ç¼©ï¼š\n1234567891011121314151617181920212223242526 1    //å°†ä¸€ä¸ªå››å­—èŠ‚çš„æ•´å½¢æ•°å€¼å‹ç¼©æˆ1~5ä¸ªå­—èŠ‚ 2    bool compress_(unsigned int i, char *buf, size_t &amp;len) 3    &#123; 4        len = 0; 5        for (int a = 4; a &gt;= 0; a--) 6        &#123; 7            char c; 8            c = i &gt;&gt; (a * 7) &amp; 0x7f; 9            if (c == 0x00 &amp;&amp; len == 0)10                continue;11            if (a == 0)12                c &amp;= 0x7f;13            else14                c |= 0x80;15            buf[len] = c;16            len++;17        &#125;18        if (len == 0)19        &#123;20            len++;21            buf[0] = 0;22        &#125;23        //cout &lt;&lt; &quot;compress:&quot; &lt;&lt; i &lt;&lt; endl;24        //cout &lt;&lt; &quot;compress len:&quot; &lt;&lt; len &lt;&lt; endl;25        return true;26    &#125;\n\nè§£å‹\n1234567891011121314 1    //å°†ä¸€ä¸ª1~5ä¸ªå­—èŠ‚çš„å€¼è¿˜åŸæˆå››å­—èŠ‚çš„æ•´å½¢å€¼ 2    bool uncompress_(char *buf, size_t len, unsigned int &amp;i) 3    &#123; 4        i = 0; 5        for (int index = 0; index &lt; (int)len; index++) 6        &#123; 7            char c = *(buf + index); 8            i = i &lt;&lt; 7; 9            c &amp;= 0x7f;10            i |= c;11        &#125;12        //cout &lt;&lt; &quot;uncompress:&quot; &lt;&lt; i &lt;&lt; endl;13        return true;14    &#125;\n\nä¸‰ã€å…³äºè·¨ç³»ç»Ÿä¸è·¨è¯­è¨€ä¹‹é—´çš„ç½‘ç»œé€šä¿¡åè®®è§£æä¸è¯†åˆ«é—®é¢˜ç”±äºæˆ‘ä»¬çš„å³æ—¶é€šè®¯åŒæ—¶æ¶‰åŠåˆ°Javaå’ŒC++ä¸¤ç§ç¼–ç¨‹è¯­è¨€ï¼Œä¸”æœ‰windowsã€linuxã€å®‰å“ä¸‰ä¸ªå¹³å°ï¼Œè€Œæˆ‘ä»¬ä¸ºäº†ä¿éšœå­¦ä¹ çš„è´¨é‡å’Œæ•ˆæœï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨ç¬¬ä¸‰è·¨å¹³å°åº“ï¼ˆå…¶å®æˆ‘ä»¬ä¹Ÿæ˜¯åœ¨å­¦ä¹ å¦‚ä½•ç¼–å†™è¿™äº›è·¨å¹³å°åº“çš„åŸç†ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å­¦ä¹ ä»¥ä¸‹å¦‚ä½•åœ¨Javaè¯­è¨€ä¸­å»è§£æC++çš„ç½‘ç»œæ•°æ®åŒ…æˆ–è€…åè¿‡æ¥ã€‚å®‰å“ç«¯å‘é€çš„æ•°æ®ä½¿ç”¨Javaè¯­è¨€ç¼–å†™ï¼Œpcä¸æœåŠ¡å™¨å‘é€çš„æ•°æ®ä½¿ç”¨C++ç¼–å†™ï¼Œè¿™é‡Œä»¥åœ¨Javaä¸­è§£æC++ç½‘ç»œæ•°æ®åŒ…ä¸ºä¾‹ã€‚ è¿™å¯¹äºå¾ˆå¤šäººæ¥è¯´æ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„äº‹æƒ…ï¼Œæ‰€ä»¥åªèƒ½å˜ç€æ³•å­ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“ã€‚å…¶å®åªè¦ä½ æŒæ¡äº†ä¸€å®šçš„åŸºç¡€çŸ¥è¯†ï¼Œåˆ©ç”¨ä¸€äº›ç°æˆçš„å­—èŠ‚æµæŠ“åŒ…å·¥å…·ï¼ˆå¦‚tcpdumpã€wiresharkï¼‰å¾ˆå®¹æ˜“è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨tcpdumpå·¥å…·æ¥å°è¯•åˆ†æå’Œè§£å†³è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®å­—èŠ‚åºåˆ—è¿™æ ·ä¸€ä¸ªæ¦‚å¿µï¼Œå³æˆ‘ä»¬è¯´çš„å¤§ç«¯ç¼–ç (big endian)å’Œå°ç«¯ç¼–ç (little endian)ï¼Œx86å’Œx64ç³»åˆ—çš„cpuä½¿ç”¨å°ç«¯ç¼–ç ï¼Œè€Œæ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œä»¥åŠJavaè¯­è¨€ä¸­ï¼Œä½¿ç”¨çš„æ˜¯å¤§ç«¯ç¼–ç ã€‚é‚£ä¹ˆè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œçœ‹ä¸€ä¸ªx64æœºå™¨ä¸Šçš„32ä½æ•°å€¼åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼ï¼š\n\niåœ¨å†…å­˜ä¸­çš„åœ°å€åºåˆ—æ˜¯0x003CF7C4~0x003CF7C8ï¼Œå€¼ä¸º40 e2 01 00ã€‚\n\nåå…­è¿›åˆ¶0001e240æ­£å¥½ç­‰äº10è¿›åˆ¶123456ï¼Œä¹Ÿå°±æ˜¯è¯´å°ç«¯ç¼–ç ä¸­æƒé‡é«˜çš„çš„å­—èŠ‚å€¼å­˜å‚¨åœ¨å†…å­˜åœ°å€é«˜ï¼ˆåœ°å€å€¼è¾ƒå¤§ï¼‰çš„ä½ç½®ï¼Œæƒé‡å€¼ä½çš„å­—èŠ‚å€¼å­˜å‚¨åœ¨å†…å­˜åœ°å€ä½ï¼ˆåœ°å€å€¼è¾ƒå°ï¼‰çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é«˜é«˜ä½ä½ã€‚ç›¸åï¼Œå¤§ç«¯ç¼–ç çš„è§„åˆ™åº”è¯¥æ˜¯é«˜ä½ä½é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´æƒå€¼é«˜å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜åœ°å€ä½çš„ä½ç½®ï¼Œæƒå€¼ä½çš„å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜åœ°å€é«˜çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ä¸ªC++ç¨‹åºçš„int32å€¼123456ä¸ä½œè½¬æ¢åœ°ä¼ ç»™Javaç¨‹åºï¼Œé‚£ä¹ˆJavaæŒ‰ç…§å¤§ç«¯ç¼–ç çš„å½¢å¼è¯»å‡ºæ¥çš„å€¼æ˜¯ï¼šåå…­è¿›åˆ¶40E20100 &#x3D; åè¿›åˆ¶1088553216ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä¹ˆåœ¨å‘é€æ–¹å°†æ•°æ®è½¬æ¢æˆç½‘ç»œå­—èŠ‚åºï¼ˆå¤§ç«¯ç¼–ç ï¼‰ï¼Œè¦ä¹ˆåœ¨æ¥æ”¶ç«¯å†è¿›è¡Œè½¬æ¢ã€‚\nä¸‹é¢çœ‹ä¸€ä¸‹å¦‚æœC++ç«¯ä¼ é€ä¸€ä¸ªå¦‚ä¸‹æ•°æ®ç»“æ„ï¼ŒJavaç«¯è¯¥å¦‚ä½•è§£æï¼ˆç”±äºJavaä¸­æ˜¯æ²¡æœ‰æŒ‡é’ˆçš„ï¼Œä¹Ÿæ— æ³•æ“ä½œå†…å­˜åœ°å€ï¼Œå¯¼è‡´å¾ˆå¤šäººæ— ä»ä¸‹æ‰‹ï¼‰ï¼Œä¸‹é¢åˆ©ç”¨tcpdumpæ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ€è·¯ã€‚æˆ‘ä»¬å®¢æˆ·ç«¯å‘é€çš„æ•°æ®åŒ…ï¼š\n\nå…¶ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š\n\nåˆ©ç”¨tcpdumpæŠ“åˆ°çš„åŒ…å¦‚ä¸‹ï¼š\n\næ”¾å¤§ä¸€ç‚¹ï¼š\n\næˆ‘ä»¬ç™½è‰²æ ‡è¯†å‡ºæ¥å°±æ˜¯æˆ‘ä»¬æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚è¿™é‡Œæˆ‘æƒ³è¯´æ˜ä¸¤ç‚¹ï¼š\n\nå¦‚æœæˆ‘ä»¬çŸ¥é“å‘é€ç«¯å‘é€çš„å­—èŠ‚æµï¼Œå†æ¯”ç…§æ¥æ”¶ç«¯æ”¶åˆ°çš„å­—èŠ‚æµï¼Œæˆ‘ä»¬å°±èƒ½æ£€æµ‹æ•°æ®åŒ…çš„å®Œæ•´æ€§ï¼Œæˆ–è€…åˆ©ç”¨è¿™ä¸ªæ¥æ’æŸ¥ä¸€äº›é—®é¢˜ï¼›\n\nå¯¹äºJavaç¨‹åºåªè¦æŒ‰ç…§è¿™ä¸ªé¡ºåºï¼Œå…ˆåˆ©ç”¨java.net.Socketçš„è¾“å‡ºæµjava.io.DataOutputStreamå¯¹è±¡readByteã€readInt32ã€readInt32ã€readBytesã€readBytesæ–¹æ³•ä¾æ¬¡è¯»å‡ºä¸€ä¸ªcharã€int32ã€int32ã€16ä¸ªå­—èŠ‚çš„å­—èŠ‚æ•°ç»„ã€63ä¸ªå­—èŠ‚æ•°ç»„å³å¯ï¼Œä¸ºäº†è¿˜åŸåƒint32è¿™æ ·çš„æ•´å½¢å€¼ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å°ç«¯ç¼–ç å‘å¤§ç«¯ç¼–ç çš„è½¬æ¢ã€‚\n\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/æœåŠ¡å™¨å¼€å‘é€šä¿¡åè®®è®¾è®¡ä»‹ç»","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"e09bb655914509994c8e1511db91931a","title":"ã€è½¬è½½ã€‘æœåŠ¡å™¨ç«¯å‘æ•°æ®æ—¶ï¼Œå¦‚æœå¯¹ç«¯ä¸€ç›´ä¸æ”¶ï¼Œæ€ä¹ˆåŠï¼Ÿ","content":"æœåŠ¡å™¨ç«¯å‘æ•°æ®æ—¶ï¼Œå¦‚æœå¯¹ç«¯ä¸€ç›´ä¸æ”¶ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™ç±»é—®é¢˜ä¸€èˆ¬å‡ºç°åœ¨è·¨éƒ¨é—¨å°¤å…¶æ˜¯ä¸å¤–éƒ¨å¼€å‘äººå‘˜åˆä½œçš„æ—¶å€™ã€‚å‡è®¾ç°åœ¨æœ‰è¿™æ ·ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨æä¾›å¯¹å¤–çš„æœåŠ¡ï¼ŒæŒ‡å®šå¥½äº†åè®®ï¼Œç„¶åå¯¹å¤–æä¾›æœåŠ¡ï¼Œå®¢æˆ·ç«¯ç”±å¤–éƒ¨äººå‘˜å»å¼€å‘ï¼Œç”±äºå­˜åœ¨å¤ªå¤šçš„ä¸ç¡®å®šæ€§ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç»™å¯¹ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰å‘é€æ•°æ®æ—¶ï¼Œå¯¹ç«¯å› ä¸ºä¸€äº›é—®é¢˜ï¼ˆå¯èƒ½æ˜¯é€»è¾‘ bug æˆ–è€…å…¶ä»–çš„ä¸€äº›é—®é¢˜ï¼‰ä¸€ç›´ä¸ä» socket ç³»ç»Ÿç¼“å†²åŒºä¸­æ”¶å–æ•°æ®ï¼Œè€ŒæœåŠ¡å™¨ç«¯å¯èƒ½å®šæœŸäº§ç”Ÿä¸€äº›æ•°æ®éœ€è¦å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå†å‘äº†ä¸€æ®µæ—¶é—´åï¼Œç”±äº TCP çª—å£å¤ªå°ï¼Œå¯¼è‡´æ•°æ®å‘é€ä¸å‡ºå»ï¼Œè¿™æ ·å¾…å‘é€çš„æ•°æ®ä¼šåœ¨æœåŠ¡å™¨ç«¯å¯¹åº”çš„è¿æ¥çš„å‘é€ç¼“å†²åŒºä¸­ç§¯å‹ï¼Œå¦‚æœæˆ‘ä»¬ä¸åšä»»ä½•å¤„ç†ï¼Œå¾ˆå¿«ç³»ç»Ÿå°±ä¼šå› ä¸ºç¼“å†²åŒºè¿‡å¤§å†…å­˜è€—å°½ï¼Œå¯¼è‡´æœåŠ¡è¢«ç³»ç»Ÿæ€æ­»ã€‚\nå¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸€èˆ¬å»ºè®®ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥å¢åŠ ä¸€äº›é˜²å¾¡æªæ–½ï¼š\n\nè®¾ç½®æ¯è·¯å‘é€è¿æ¥çš„å‘é€ç¼“å†²åŒºå¤§å°ä¸Šé™ï¼ˆå¦‚ 2 Mï¼Œæˆ–è€…å°äºè¿™ä¸ªå€¼ï¼‰ï¼Œå½“æŸè·¯è¿æ¥ä¸Šçš„æ•°æ®å‘é€ä¸å‡ºå»çš„æ—¶å€™ï¼Œå³å°†æ•°æ®å­˜å…¥å‘é€ç¼“å†²åŒºæ—¶ï¼Œå…ˆåˆ¤æ–­ä¸€ä¸‹ç¼“å†²åŒºæœ€å¤§å‰©ä½™ç©ºé—´ï¼Œå¦‚æœå‰©ä½™ç©ºé—´å·²ç»å°äºæˆ‘ä»¬è¦æ”¾å…¥çš„æ•°æ®å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼“å†²åŒºä¸­æ•°æ®å¤§å°ä¼šè¶…è¿‡äº†æˆ‘ä»¬è§„å®šçš„ä¸Šé™ï¼Œåˆ™è®¤ä¸ºè¯¥è¿æ¥å‡ºç°äº†é—®é¢˜ï¼Œå…³é—­è¯¥è·¯è¿æ¥å¹¶å›æ”¶ç›¸åº”çš„èµ„æºï¼ˆå¦‚æ¸…ç©ºç¼“å†²åŒºã€å›æ”¶å¥—æ¥å­—èµ„æºç­‰ï¼‰ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n12345678910//outputBuffer_ä¸ºå‘é€ç¼“å†²åŒºå¯¹è±¡size_t remainingLen = outputBuffer_.remainingBytes();//å¦‚æœåŠ å…¥åˆ°ç¼“å†²åŒºä¸­çš„æ•°æ®é•¿åº¦è¶…å‡ºäº†å‘é€ç¼“å†²åŒºæœ€å¤§å‰©ä½™é‡if (remainingLen &lt; dataToAppend.length())&#123;\t\tforceClose()\t\treturn&#125;outputBuffer_.append(static_cast&lt;const char*&gt;(dataToAppend.c_str()), dataToAppend.length());\n\nè¿˜æœ‰å¦å¤–ä¸€ç§åœºæ™¯ï¼Œå½“æœ‰ä¸€éƒ¨åˆ†æ•°æ®å·²ç»ç§¯å‹åœ¨å‘é€ç¼“å†²åŒºäº†ï¼Œæ­¤åæœåŠ¡å™¨ç«¯æœªäº§ç”Ÿæ–°çš„å¾…å‘é€çš„æ•°æ®ï¼Œæ­¤æ—¶å¦‚æœä¸åšä»»ä½•å¤„ç†ï¼Œå‘é€ç¼“å†²åŒºçš„æ•°æ®ä¼šä¸€ç›´ç§¯å‹ï¼Œä½†æ˜¯å‘é€ç¼“å†²åŒºçš„æ•°æ®å®¹é‡ä¹Ÿä¸ä¼šè¶…è¿‡ä¸Šé™ã€‚å¦‚æœä¸åšä»»ä½•å¤„ç†çš„è¯ï¼Œè¯¥æ•°æ®ä¼šä¸€ç›´åœ¨ç¼“å†²åŒºä¸­ç§¯å‹ï¼Œç™½ç™½æµªè´¹ç³»ç»Ÿèµ„æºã€‚å¯¹äºè¿™ç§æƒ…å†µä¸€èˆ¬æˆ‘ä»¬ä¼šè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚ 3 ç§’ï¼‰å»æ£€æŸ¥ä¸€ä¸‹å„è·¯è¿æ¥çš„å‘é€ç¼“å†²åŒºä¸­æ˜¯å¦è¿˜æœ‰æ•°æ®æœªå‘é€å‡ºå»ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸€ä¸ªè¿æ¥è¶…è¿‡ä¸€å®šæ—¶é—´å†…è¿˜å­˜åœ¨æœªå‘é€å‡ºå»çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿè®¤ä¸ºè¯¥è¿æ¥å‡ºç°äº†é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…³é—­è¯¥è·¯è¿æ¥å¹¶å›æ”¶ç›¸åº”çš„èµ„æºï¼ˆå¦‚æ¸…ç©ºç¼“å†²åŒºã€å›æ”¶å¥—æ¥å­—èµ„æºç­‰ï¼‰ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526//æ¯3ç§’æ£€æµ‹ä¸€æ¬¡const int SESSION_CHECK_INTERVAL = 3000;SetTimer(SESSION_CHECK_TIMER_ID, SESSION_CHECK_INTERVAL);void CSessionManager::OnTimer()&#123;    for (auto iter = m_mapSession.begin(); iter != m_mapSession.end(); ++iter)    &#123;        if (!CheckSession(iter-&gt;value))        &#123;            //å…³é—­sessionï¼Œå›æ”¶ç›¸å…³çš„èµ„æº            iter-&gt;value-&gt;ForceClose();            iter = m_mapSession.erase(iter);        &#125;    &#125;&#125;void CSessionManager::CheckSession(CSession* pSession)&#123;    if (!pSession-&gt;GetConnection().OutputBuffer.IsEmpty())        return false;    return true;&#125;\n\nä¸Šè¿°ä»£ç ï¼Œæ¯éš” 3 ç§’æ£€æµ‹æ‰€æœ‰çš„ Session çš„å¯¹åº”çš„ Connection å¯¹è±¡ï¼Œå¦‚æœå‘ç°å‘é€ç¼“å†²åŒºéç©ºï¼Œè¯´æ˜è¯¥è¿æ¥ä¸­å‘é€ç¼“å†²åŒºä¸­æ•°æ®å·²ç»é©»ç•™ 3 ç§’äº†ï¼Œå°†è¯¥è¿æ¥å…³é—­å¹¶æ¸…ç†èµ„æºã€‚\n\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/æœåŠ¡å™¨ç«¯å‘æ•°æ®æ—¶ï¼Œå¦‚æœå¯¹ç«¯ä¸€ç›´ä¸æ”¶ï¼Œæ€ä¹ˆåŠï¼Ÿ","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"fab0416ed78af2e60e15df3589b08519","title":"ã€è½¬è½½ã€‘ç½‘ç»œé€šä¿¡ä¸­æ”¶å‘æ•°æ®çš„æ­£ç¡®å§¿åŠ¿","content":"ç½‘ç»œé€šä¿¡ä¸­æ”¶å‘æ•°æ®çš„æ­£ç¡®å§¿åŠ¿åœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æ—¢è¦é€šè¿‡ socket å»å‘é€æ•°æ®ä¹Ÿè¦é€šè¿‡ socket æ¥æ”¶å–æ•°æ®ã€‚é‚£ä¹ˆä¸€èˆ¬çš„ç½‘ç»œé€šä¿¡æ¡†æ¶æ˜¯å¦‚ä½•æ”¶å‘æ•°æ®çš„å‘¢ï¼Ÿæ³¨æ„ï¼Œè¿™é‡Œè®¨è®ºçš„èŒƒå›´æ˜¯åŸºäºå„ç§ IO å¤ç”¨å‡½æ•°ï¼ˆselectã€pollã€epoll ç­‰ï¼‰æ¥åˆ¤æ–­ socket è¯»å†™æ¥æ”¶å‘æ•°æ®ï¼Œå…¶ä»–æƒ…å½¢æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸æäº†ã€‚\næˆ‘ä»¬è¿™é‡Œä»¥æœåŠ¡å™¨ç«¯ä¸ºä¾‹ã€‚æœåŠ¡å™¨ç«¯æ¥å—å®¢æˆ·ç«¯è¿æ¥åï¼Œäº§ç”Ÿä¸€ä¸ªä¸å®¢æˆ·ç«¯è¿æ¥å¯¹åº”çš„ socketï¼ˆLinux ä¸‹ä¹Ÿå« fdï¼Œä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œä»¥åç§°ä¹‹ä¸º clientfdï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ª clientfd æ”¶å–ä»å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ª clientfd å°†æ•°æ®å‘å¾€å®¢æˆ·ç«¯ã€‚ä½†æ˜¯æ”¶ä¸å‘åœ¨æ“ä½œæµç¨‹ä¸Šæ˜¯æœ‰æ˜æ˜¾çš„åŒºåˆ«çš„ã€‚\næ”¶æ•°æ®çš„æ­£ç¡®å§¿åŠ¿å¯¹äºæ”¶æ•°æ®ï¼Œå½“æ¥å—è¿æ¥æˆåŠŸå¾—åˆ° clientfd åï¼Œæˆ‘ä»¬ä¼šå°†è¯¥ clientfd ç»‘å®šåˆ°ç›¸åº”çš„ IO å¤ç”¨å‡½æ•°ä¸Šå¹¶ç›‘å¬å…¶å¯è¯»äº‹ä»¶ã€‚ä¸åŒçš„ IO å¤ç”¨å‡½æ•°å¯è¯»äº‹ä»¶æ ‡å¿—ä¸ä¸€æ ·ï¼Œä¾‹å¦‚å¯¹äº poll æ¨¡å‹ï¼Œå¯è¯»æ ‡å¿—æ˜¯ POLLINï¼Œå¯¹äº epoll æ¨¡å‹ï¼Œå¯è¯»äº‹ä»¶æ ‡å¿—æ˜¯ EPOLLINã€‚å½“å¯è¯»äº‹ä»¶è§¦å‘åï¼Œæˆ‘ä»¬è°ƒç”¨ recv å‡½æ•°ä» clientfd ä¸Šæ”¶å–æ•°æ®ï¼ˆè¿™é‡Œä¸è€ƒè™‘å‡ºé”™çš„æƒ…å†µï¼‰ï¼Œæ ¹æ®ä¸åŒçš„ç½‘ç»œæ¨¡å¼æˆ‘ä»¬å¯èƒ½ä¼šæ”¶å–éƒ¨åˆ†ï¼Œæˆ–ä¸€æ¬¡æ€§æ”¶å®Œã€‚æ”¶å–åˆ°çš„æ•°æ®æˆ‘ä»¬ä¼šæ”¾å…¥æ¥æ”¶ç¼“å†²åŒºå†…ï¼Œç„¶ååšè§£åŒ…æ“ä½œã€‚è¿™å°±æ˜¯æ”¶æ•°æ®çš„å…¨éƒ¨â€œå§¿åŠ¿â€ã€‚å¯¹äºä½¿ç”¨ epoll çš„ LT æ¨¡å¼ï¼ˆæ°´å¹³è§¦å‘æ¨¡å¼ï¼‰ï¼Œæˆ‘ä»¬æ¯æ¬¡å¯ä»¥åªæ”¶å–éƒ¨åˆ†æ•°æ®ï¼›ä½†æ˜¯å¯¹äº ET æ¨¡å¼ï¼ˆè¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»å°†æœ¬æ¬¡æ”¶åˆ°çš„æ•°æ®å…¨éƒ¨æ”¶å®Œã€‚\n\nET æ¨¡å¼æ”¶å®Œçš„æ ‡å¿—æ˜¯ recv æˆ–è€… read å‡½æ•°çš„è¿”å›å€¼æ˜¯ -1ï¼Œé”™è¯¯ç æ˜¯ EWOULDBLOCKï¼Œé’ˆå¯¹ Windows å’Œ Linux ä¸‹åŒºåˆ«ï¼Œå‰é¢ç« èŠ‚å·²ç»è¯¦ç»†åœ°è¯´è¿‡äº†ã€‚\n\nè¿™å°±æ˜¯è¯»æ•°æ®çš„å…¨éƒ¨å§¿åŠ¿ã€‚æµç¨‹å›¾å¦‚ä¸‹ï¼š\n\nå‘æ•°æ®çš„æ­£ç¡®å§¿åŠ¿å¯¹äºå‘æ•°æ®ï¼Œé™¤äº† epoll æ¨¡å‹çš„ ET æ¨¡å¼å¤–ï¼Œepoll çš„ LT æ¨¡å¼æˆ–è€…å…¶ä»– IO å¤ç”¨å‡½æ•°ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½ä¸ä¼šå»æ³¨å†Œç›‘å¬è¯¥ clientfd çš„å¯å†™äº‹ä»¶ã€‚è¿™æ˜¯å› ä¸ºï¼Œåªè¦å¯¹ç«¯æ­£å¸¸æ”¶æ•°æ®ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç° TCP çª—å£å¤ªå°å¯¼è‡´ send æˆ– write å‡½æ•°æ— æ³•å†™çš„é—®é¢˜ã€‚å› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œclientfd éƒ½æ˜¯å¯å†™çš„ï¼Œå¦‚æœæ³¨å†Œäº†å¯å†™äº‹ä»¶ï¼Œä¼šå¯¼è‡´ä¸€ç›´è§¦å‘å¯å†™äº‹ä»¶ï¼Œè€Œæ­¤æ—¶ä¸ä¸€å®šæœ‰æ•°æ®éœ€è¦å‘é€ã€‚æ•…è€Œï¼Œå¦‚æœæœ‰æ•°æ®è¦å‘é€ä¸€èˆ¬éƒ½æ˜¯è°ƒç”¨ send æˆ–è€… write å‡½æ•°ç›´æ¥å‘é€ï¼Œå¦‚æœå‘é€è¿‡ç¨‹ä¸­ï¼Œ send å‡½æ•°è¿”å› -1ï¼Œå¹¶ä¸”é”™è¯¯ç æ˜¯ EWOULDBLOCK è¡¨æ˜ç”±äº TCP çª—å£å¤ªå°æ•°æ®å·²ç»æ— æ³•å†™å…¥æ—¶ï¼Œè€Œä»ç„¶è¿˜å‰©ä¸‹éƒ¨åˆ†æ•°æ®æœªå‘é€ï¼Œæ­¤æ—¶æˆ‘ä»¬æ‰æ³¨å†Œç›‘å¬å¯å†™äº‹ä»¶ï¼Œå¹¶å°†å‰©ä½™çš„æœåŠ¡å­˜å…¥è‡ªå®šä¹‰çš„å‘é€ç¼“å†²åŒºä¸­ï¼Œç­‰å¯å†™äº‹ä»¶è§¦å‘åå†æ¥ç€å°†å‘é€ç¼“å†²åŒºä¸­å‰©ä½™çš„æ•°æ®å‘é€å‡ºå»ï¼Œå¦‚æœä»ç„¶æœ‰éƒ¨åˆ†æ•°æ®ä¸èƒ½å‘å‡ºå»ï¼Œç»§ç»­æ³¨å†Œå¯å†™äº‹ä»¶ï¼Œå½“å·²ç»æ— æ•°æ®éœ€è¦å‘é€æ—¶åº”è¯¥ç«‹å³ç§»é™¤å¯¹å¯å†™äº‹ä»¶çš„ç›‘å¬ã€‚è¿™æ˜¯ç›®å‰ä¸»æµç½‘ç»œåº“çš„åšæ³•ã€‚\næµç¨‹å›¾å¦‚ä¸‹ï¼š\n\nä¸Šè¿°é€»è¾‘ç¤ºä¾‹å¦‚ä¸‹ï¼š\nç›´æ¥å°è¯•å‘é€æ¶ˆæ¯å¤„ç†é€»è¾‘ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051/** *@param data å¾…å‘é€çš„æ•°æ® *@param len  å¾…å‘é€æ•°æ®é•¿åº¦ */void TcpConnection::sendMessage(const void* data, size_t len)&#123;        int32_t nwrote = 0;    size_t remaining = len;    bool faultError = false;    if (state_ == kDisconnected)    &#123;        LOGW(&quot;disconnected, give up writing&quot;);        return;    &#125;    // å½“å‰æœªç›‘å¬å¯å†™äº‹ä»¶ï¼Œä¸”å‘é€ç¼“å†²åŒºä¸­æ²¡æœ‰é—ç•™æ•°æ®    if (!channel_-&gt;isWriting() &amp;&amp; outputBuffer_.readableBytes() == 0)    &#123;        //ç›´æ¥å‘é€æ•°æ®        nwrote = sockets::write(channel_-&gt;fd(), data, len);              if (nwrote &gt;= 0)        &#123;            remaining = len - nwrote;                   &#125;        else // nwrote &lt; 0        &#123;            nwrote = 0;            //é”™è¯¯ç ä¸ç­‰äºEWOULDBLOCKè¯´æ˜å‘é€å‡ºé”™äº†            if (errno != EWOULDBLOCK)            &#123;                LOGSYSE(&quot;TcpConnection::sendInLoop&quot;);                if (errno == EPIPE || errno == ECONNRESET)                &#123;                    faultError = true;                &#125;            &#125;        &#125;    &#125;    //å‘é€æœªå‡ºé”™ä¸”è¿˜æœ‰å‰©ä½™å­—èŠ‚æœªå‘å‡ºå»    if (!faultError &amp;&amp; remaining &gt; 0)    &#123;        //å°†å‰©ä½™éƒ¨åˆ†åŠ å…¥å‘é€ç¼“å†²åŒº        outputBuffer_.append(static_cast&lt;const char*&gt;(data) + nwrote, remaining);        if (!channel_-&gt;isWriting())        &#123;            //æ³¨å†Œå¯å†™äº‹ä»¶            channel_-&gt;enableWriting();        &#125;    &#125;&#125;\n\nä¸èƒ½å…¨éƒ¨å‘å‡ºå»ç›‘å¬å¯å†™äº‹ä»¶åï¼Œå¯å†™äº‹ä»¶è§¦å‘åå¤„ç†é€»è¾‘ï¼š\n12345678910111213141516171819202122232425262728//å¯å†™äº‹ä»¶è§¦å‘åä¼šè°ƒç”¨handleWrite()å‡½æ•°void TcpConnection::handleWrite()&#123;      //å°†å‘é€ç¼“å†²åŒºä¸­çš„æ•°æ®å‘é€å‡ºå»    int32_t n = sockets::write(channel_-&gt;fd(), outputBuffer_.peek(), outputBuffer_.readableBytes());    if (n &gt; 0)    &#123;        //å‘é€å¤šå°‘ä»å‘é€ç¼“å†²åŒºç§»é™¤å¤šå°‘        outputBuffer_.retrieve(n);        //å¦‚æœå‘é€ç¼“å†²åŒºä¸­å·²ç»æ²¡æœ‰å‰©ä½™ï¼Œåˆ™ç§»é™¤ç›‘å¬å¯å†™äº‹ä»¶        if (outputBuffer_.readableBytes() == 0)        &#123;            //ç§»é™¤ç›‘å¬å¯å†™äº‹ä»¶            channel_-&gt;disableWriting();            if (state_ == kDisconnecting)            &#123;                shutdown();            &#125;        &#125;    &#125;    else    &#123;        //å‘æ•°æ®å‡ºé”™å¤„ç†        LOGSYSE(&quot;TcpConnection::handleWrite&quot;);                   handleClose();    &#125; &#125;\n\nå¯¹äº epoll LT æ¨¡å¼æ³¨å†Œç›‘å¬ä¸€æ¬¡å¯å†™äº‹ä»¶åï¼Œå¯å†™äº‹ä»¶è§¦å‘åï¼Œå°è¯•å‘é€æ•°æ®ï¼Œå¦‚æœæ•°æ®æ­¤æ—¶è¿˜ä¸èƒ½å…¨éƒ¨å‘é€å®Œï¼Œä¸ç”¨å†æ¬¡æ³¨å†Œå¯å†™äº‹ä»¶ï¼›å¦‚æœæ˜¯ epoll çš„ ET æ¨¡å¼ï¼Œæ³¨å†Œç›‘å¬å¯å†™äº‹ä»¶åï¼Œå¯å†™äº‹ä»¶è§¦å‘åï¼Œå°è¯•å‘é€æ•°æ®ï¼Œå¦‚æœæ•°æ®æ­¤æ—¶è¿˜ä¸èƒ½å…¨éƒ¨å‘é€å®Œï¼Œéœ€è¦å†æ¬¡æ³¨å†Œå¯å†™äº‹ä»¶ä»¥ä¾¿è®©å¯å†™äº‹ä»¶ä¸‹æ¬¡å†æ¬¡è§¦å‘ï¼ˆç»™äºˆå†æ¬¡å‘æ•°æ®çš„æœºä¼šï¼‰ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯ç†è®ºä¸Šçš„æƒ…å†µï¼Œå®é™…å¼€å‘ä¸­ï¼Œå¦‚æœä¸€æ®µæ•°æ®åå¤å‘é€éƒ½ä¸èƒ½å®Œå…¨å‘é€å®Œï¼ˆä¾‹å¦‚å¯¹ç«¯å…ˆä¸æ”¶ï¼Œåé¢æ¯éš”å¾ˆé•¿æ—¶é—´å†æ”¶ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªæœ€å¤§å‘é€æ¬¡æ•°æˆ–æœ€å¤§å‘é€æ€»æ—¶é—´ï¼Œè¶…è¿‡è¿™äº›é™å®šï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå¯¹ç«¯å‡ºäº†é—®é¢˜ï¼Œåº”è¯¥ç«‹å³æ¸…ç©ºå‘é€ç¼“å†²åŒºå¹¶å…³é—­è¿æ¥ã€‚\næœ¬èŠ‚çš„æ ‡é¢˜æ˜¯â€œæ”¶å‘æ•°æ®çš„æ­£ç¡®å§¿åŠ¿â€ï¼Œå…¶å®è¿˜å¯ä»¥æ¢ä¸€ç§è¯´æ³•ï¼Œå³â€œæ£€æµ‹ç½‘ç»œäº‹ä»¶çš„æ­£ç¡®å§¿åŠ¿â€ï¼Œè¿™é‡Œæ„æŒ‡æ£€æµ‹ä¸€ä¸ª fd çš„è¯»å†™äº‹ä»¶çš„åŒºåˆ«ï¼ˆå¯¹äºä¾¦å¬ fdï¼Œåªæ£€æµ‹å¯è¯»äº‹ä»¶ï¼‰ï¼š\n\nåœ¨ selectã€poll å’Œ epoll çš„ LT æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®æ£€æµ‹ fd çš„å¯è¯»äº‹ä»¶ï¼›\nåœ¨ selectã€poll å’Œ epoll çš„ LT æ¨¡å¼ä¸‹ä¸è¦ç›´æ¥è®¾ç½®æ£€æµ‹ fd çš„å¯å†™äº‹ä»¶ï¼Œåº”è¯¥å…ˆå°è¯•å‘é€æ•°æ®ï¼Œå› ä¸º TCP çª—å£å¤ªå°å‘ä¸å‡ºå»å†è®¾ç½®æ£€æµ‹ fd çš„å¯å†™äº‹ä»¶ï¼Œä¸€æ—¦æ•°æ®å‘å‡ºå»åº”ç«‹å³å–æ¶ˆå¯¹å¯å†™äº‹ä»¶çš„æ£€æµ‹ã€‚\nåœ¨ epoll çš„ ET æ¨¡å¼ä¸‹ï¼Œéœ€è¦å‘é€æ•°æ®æ—¶ï¼Œæ¯æ¬¡éƒ½è¦è®¾ç½®æ£€æµ‹å¯å†™äº‹ä»¶ã€‚\n\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/ç½‘ç»œé€šä¿¡ä¸­æ”¶å‘æ•°æ®çš„æ­£ç¡®å§¿åŠ¿","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"12ad89ee9300bed7e58f0d5f1f9116ca","title":"ã€è½¬è½½ã€‘éé˜»å¡æ¨¡å¼ä¸‹sendå’Œrecvå‡½æ•°çš„è¿”å›å€¼","content":"éé˜»å¡æ¨¡å¼ä¸‹ send å’Œ recv å‡½æ•°çš„è¿”å›å€¼æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ send å’Œ recv å‡½æ•°çš„å„ç§è¿”å›å€¼æ„ä¹‰ï¼š\n\n\n\nè¿”å›å€¼ n\nè¿”å›å€¼å«ä¹‰\n\n\n\nå¤§äº 0\næˆåŠŸå‘é€ n ä¸ªå­—èŠ‚\n\n\n0\nå¯¹ç«¯å…³é—­è¿æ¥\n\n\nå°äº 0ï¼ˆ -1ï¼‰\nå‡ºé”™æˆ–è€…è¢«ä¿¡å·ä¸­æ–­æˆ–è€…å¯¹ç«¯ TCP çª—å£å¤ªå°æ•°æ®å‘ä¸å‡ºå»ï¼ˆsendï¼‰æˆ–è€…å½“å‰ç½‘å¡ç¼“å†²åŒºå·²æ— æ•°æ®å¯æ”¶ï¼ˆrecvï¼‰\n\n\næˆ‘ä»¬æ¥é€ä¸€ä»‹ç»ä¸‹è¿™ä¸‰ç§æƒ…å†µï¼š\n\nè¿”å›å€¼å¤§äº 0\nå¯¹äº send å’Œ recv å‡½æ•°è¿”å›å€¼å¤§äº 0ï¼Œè¡¨ç¤ºå‘é€æˆ–æ¥æ”¶å¤šå°‘å­—èŠ‚ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬ä¸€å®šè¦åˆ¤æ–­ä¸‹ send å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸æ˜¯æˆ‘ä»¬æœŸæœ›å‘é€çš„ç¼“å†²åŒºé•¿åº¦ï¼Œè€Œä¸æ˜¯ç®€å•åˆ¤æ–­å…¶è¿”å›å€¼å¤§äº 0ã€‚ä¸¾ä¸ªä¾‹å­ï¼š\n123451int n = send(socket, buf, buf_length, 0)ï¼›2if (n &gt; 0)3&#123;4  printf(&quot;send data successfully\\n&quot;);5&#125;\n\nå¾ˆå¤šæ–°æ‰‹ä¼šå†™å‡ºä¸Šè¿°ä»£ç ï¼Œè™½ç„¶è¿”å›å€¼ n å¤§äº 0ï¼Œä½†æ˜¯å®é™…æƒ…å½¢ä¸‹ï¼Œç”±äºå¯¹ç«¯çš„ TCP çª—å£å¯èƒ½å› ä¸ºç¼ºå°‘ä¸€éƒ¨åˆ†å­—èŠ‚å°±æ»¡äº†ï¼Œæ‰€ä»¥è¿”å›å€¼ n çš„å€¼å¯èƒ½åœ¨ (0, buf_length] ä¹‹é—´ï¼Œå½“ 0 &lt; n &lt; buf_length æ—¶ï¼Œè™½ç„¶æ­¤æ—¶ send å‡½æ•°æ˜¯è°ƒç”¨æˆåŠŸäº†ï¼Œä½†æ˜¯ä¸šåŠ¡ä¸Šå¹¶ä¸ç®—æ­£ç¡®ï¼Œå› ä¸ºæœ‰éƒ¨åˆ†æ•°æ®å¹¶æ²¡å‘å‡ºå»ã€‚ä½ å¯èƒ½åœ¨ä¸€æ¬¡æµ‹è¯•ä¸­æµ‹ä¸å‡º n ä¸ç­‰äº buf_length çš„æƒ…å†µï¼Œä½†æ˜¯ä¸ä»£è¡¨å®é™…ä¸­ä¸å­˜åœ¨ã€‚æ‰€ä»¥ï¼Œå»ºè®®è¦ä¹ˆè®¤ä¸ºè¿”å›å€¼ n ç­‰äº buf_length æ‰è®¤ä¸ºæ­£ç¡®ï¼Œè¦ä¹ˆåœ¨ä¸€ä¸ªå¾ªç¯ä¸­è°ƒç”¨ send å‡½æ•°ï¼Œå¦‚æœæ•°æ®ä¸€æ¬¡æ€§å‘ä¸å®Œï¼Œè®°å½•åç§»é‡ï¼Œä¸‹ä¸€æ¬¡ä»åç§»é‡å¤„æ¥ç€å‘ï¼Œç›´åˆ°å…¨éƒ¨å‘é€å®Œä¸ºæ­¢ã€‚\n\n\n1234561  //æ¨èçš„æ–¹å¼ä¸€2  int n = send(socket, buf, buf_length, 0)ï¼›3  if (n == buf_length)4  &#123;5      printf(&quot;send data successfully\\n&quot;);6  &#125;\n\n\n\n123456789101112131415161718192021222324252627282930313233343536 1//æ¨èçš„æ–¹å¼äºŒï¼šåœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢æ ¹æ®åç§»é‡å‘é€æ•°æ® 2bool SendData(const char* buf , int buf_length) 3&#123; 4    //å·²å‘é€çš„å­—èŠ‚æ•°ç›® 5    int sent_bytes = 0; 6    int ret = 0; 7    while (true) 8    &#123; 9        ret = send(m_hSocket, buf + sent_bytes, buf_length - sent_bytes, 0);10        if (nRet == -1)11        &#123;12            if (errno == EWOULDBLOCK)13            &#123;14                //ä¸¥è°¨çš„åšæ³•ï¼Œè¿™é‡Œå¦‚æœå‘ä¸å‡ºå»ï¼Œåº”è¯¥ç¼“å­˜å°šæœªå‘å‡ºå»çš„æ•°æ®ï¼Œåé¢ä»‹ç»15                break;16            &#125;             17            else if (errno == EINTR)18                continue;19            else20                return false;21        &#125;22        else if (nRet == 0)23        &#123;24            return false;25        &#125;2627        sent_bytes += ret;28        if (sent_bytes == buf_length)29            break;3031        //ç¨ç¨é™ä½ CPU çš„ä½¿ç”¨ç‡32        usleep(1);33    &#125;3435    return true;36&#125;\n\n\nè¿”å›å€¼ç­‰äº 0\né€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœ send æˆ–è€… recv å‡½æ•°è¿”å› 0ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå¯¹ç«¯å…³é—­äº†è¿æ¥ï¼Œæˆ‘ä»¬è¿™ç«¯ä¹Ÿå…³é—­è¿æ¥å³å¯ï¼Œè¿™æ˜¯å®é™…å¼€å‘æ—¶æœ€å¸¸è§çš„å¤„ç†é€»è¾‘ã€‚\nä½†æ˜¯ï¼Œç°åœ¨è¿˜æœ‰ä¸€ç§æƒ…å½¢å°±æ˜¯ï¼Œå‡è®¾è°ƒç”¨ send å‡½æ•°ä¼ é€’çš„æ•°æ®é•¿åº¦å°±æ˜¯ 0 å‘¢ï¼Ÿsend å‡½æ•°ä¼šæ˜¯ä»€ä¹ˆè¡Œä¸ºï¼Ÿå¯¹ç«¯ä¼š recv åˆ°ä¸€ä¸ª 0 å­—èŠ‚çš„æ•°æ®å—ï¼Ÿéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œä½ ä¸åº”è¯¥è®©ä½ çš„ç¨‹åºæœ‰ä»»ä½•æœºä¼šå» send 0 å­—èŠ‚çš„æ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ã€‚ è¿™é‡Œä»…ä»…ç”¨äºå®éªŒæ€§è®¨è®ºï¼Œæˆ‘ä»¬æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹ä¸‹ send ä¸€ä¸ªé•¿åº¦ä¸º 0 çš„æ•°æ®ï¼Œsend å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿå¯¹ç«¯ä¼š recv åˆ° 0 å­—èŠ‚çš„æ•°æ®å—ï¼Ÿ\nserver ç«¯ä»£ç ï¼š\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081 1  /** 2   * éªŒè¯recvå‡½æ•°æ¥å—0å­—èŠ‚çš„è¡Œä¸ºï¼Œserverç«¯ï¼Œserver_recv_zero_bytes.cpp 3   * zhangyl 2018.12.17 4   */ 5  #include &lt;sys/types.h&gt;  6  #include &lt;sys/socket.h&gt; 7  #include &lt;arpa/inet.h&gt; 8  #include &lt;unistd.h&gt; 9  #include &lt;iostream&gt;10  #include &lt;string.h&gt;11  #include &lt;vector&gt;1213  int main(int argc, char* argv[])14  &#123;15      //1.åˆ›å»ºä¸€ä¸ªä¾¦å¬socket16      int listenfd = socket(AF_INET, SOCK_STREAM, 0);17      if (listenfd == -1)18      &#123;19          std::cout &lt;&lt; &quot;create listen socket error.&quot; &lt;&lt; std::endl;20          return -1;21      &#125;2223      //2.åˆå§‹åŒ–æœåŠ¡å™¨åœ°å€24      struct sockaddr_in bindaddr;25      bindaddr.sin_family = AF_INET;26      bindaddr.sin_addr.s_addr = htonl(INADDR_ANY);27      bindaddr.sin_port = htons(3000);28      if (bind(listenfd, (struct sockaddr *)&amp;bindaddr, sizeof(bindaddr)) == -1)29      &#123;30          std::cout &lt;&lt; &quot;bind listen socket error.&quot; &lt;&lt; std::endl;31          close(listenfd);32          return -1;33      &#125;3435      //3.å¯åŠ¨ä¾¦å¬36      if (listen(listenfd, SOMAXCONN) == -1)37      &#123;38          std::cout &lt;&lt; &quot;listen error.&quot; &lt;&lt; std::endl;39          close(listenfd);40          return -1;41      &#125;4243      int clientfd;4445      struct sockaddr_in clientaddr;46      socklen_t clientaddrlen = sizeof(clientaddr);47      //4. æ¥å—å®¢æˆ·ç«¯è¿æ¥48      clientfd = accept(listenfd, (struct sockaddr *)&amp;clientaddr, &amp;clientaddrlen);49      if (clientfd != -1)50      &#123;           51          while (true)52          &#123;53              char recvBuf[32] = &#123;0&#125;;54              //5. ä»å®¢æˆ·ç«¯æ¥å—æ•°æ®,å®¢æˆ·ç«¯æ²¡æœ‰æ•°æ®æ¥çš„æ—¶å€™ä¼šåœ¨recvå‡½æ•°å¤„é˜»å¡55              int ret = recv(clientfd, recvBuf, 32, 0);56              if (ret &gt; 0) 57              &#123;58                  std::cout &lt;&lt; &quot;recv data from client, data: &quot; &lt;&lt; recvBuf &lt;&lt; std::endl;               59              &#125; 60              else if (ret == 0)61              &#123;62                  std::cout &lt;&lt; &quot;recv 0 byte data.&quot; &lt;&lt; std::endl;63                  continue;64              &#125; 65              else66              &#123;67                  //å‡ºé”™68                  std::cout &lt;&lt; &quot;recv data error.&quot; &lt;&lt; std::endl;69                  break;70              &#125;71          &#125;               72      &#125;737475      //å…³é—­å®¢æˆ·ç«¯socket76      close(clientfd);77      //7.å…³é—­ä¾¦å¬socket78      close(listenfd);7980      return 0;81  &#125;\n\nä¸Šè¿°ä»£ç ä¾¦å¬ç«¯å£å·æ˜¯ 3000ï¼Œä»£ç  55 è¡Œè°ƒç”¨äº† recv å‡½æ•°ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¸€ç›´æ²¡æœ‰æ•°æ®ï¼Œç¨‹åºä¼šé˜»å¡åœ¨è¿™é‡Œã€‚\nclient ç«¯ä»£ç ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697 1/** 2 * éªŒè¯éé˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°å‘é€0å­—èŠ‚çš„è¡Œä¸ºï¼Œclientç«¯ï¼Œnonblocking_client_send_zero_bytes.cpp 3 * zhangyl 2018.12.17 4 */ 5#include &lt;sys/types.h&gt;  6#include &lt;sys/socket.h&gt; 7#include &lt;arpa/inet.h&gt; 8#include &lt;unistd.h&gt; 9#include &lt;iostream&gt;10#include &lt;string.h&gt;11#include &lt;stdio.h&gt;12#include &lt;fcntl.h&gt;13#include &lt;errno.h&gt;1415#define SERVER_ADDRESS &quot;127.0.0.1&quot;16#define SERVER_PORT     300017#define SEND_DATA       &quot;&quot;1819int main(int argc, char* argv[])20&#123;21    //1.åˆ›å»ºä¸€ä¸ªsocket22    int clientfd = socket(AF_INET, SOCK_STREAM, 0);23    if (clientfd == -1)24    &#123;25        std::cout &lt;&lt; &quot;create client socket error.&quot; &lt;&lt; std::endl;26        return -1;27    &#125;2829    //2.è¿æ¥æœåŠ¡å™¨30    struct sockaddr_in serveraddr;31    serveraddr.sin_family = AF_INET;32    serveraddr.sin_addr.s_addr = inet_addr(SERVER_ADDRESS);33    serveraddr.sin_port = htons(SERVER_PORT);34    if (connect(clientfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1)35    &#123;36        std::cout &lt;&lt; &quot;connect socket error.&quot; &lt;&lt; std::endl;37        close(clientfd);38        return -1;39    &#125;4041    //è¿æ¥æˆåŠŸä»¥åï¼Œæˆ‘ä»¬å†å°† clientfd è®¾ç½®æˆéé˜»å¡æ¨¡å¼ï¼Œ42    //ä¸èƒ½åœ¨åˆ›å»ºæ—¶å°±è®¾ç½®ï¼Œè¿™æ ·ä¼šå½±å“åˆ° connect å‡½æ•°çš„è¡Œä¸º43    int oldSocketFlag = fcntl(clientfd, F_GETFL, 0);44    int newSocketFlag = oldSocketFlag | O_NONBLOCK;45    if (fcntl(clientfd, F_SETFL,  newSocketFlag) == -1)46    &#123;47        close(clientfd);48        std::cout &lt;&lt; &quot;set socket to nonblock error.&quot; &lt;&lt; std::endl;49        return -1;50    &#125;5152    //3. ä¸æ–­å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œæˆ–è€…å‡ºé”™é€€å‡º53    int count = 0;54    while (true)55    &#123;56        //å‘é€ 0 å­—èŠ‚çš„æ•°æ®57        int ret = send(clientfd, SEND_DATA, 0, 0);58        if (ret == -1) 59        &#123;60            //éé˜»å¡æ¨¡å¼ä¸‹sendå‡½æ•°ç”±äºTCPçª—å£å¤ªå°å‘ä¸å‡ºå»æ•°æ®ï¼Œé”™è¯¯ç æ˜¯EWOULDBLOCK61            if (errno == EWOULDBLOCK)62            &#123;63                std::cout &lt;&lt; &quot;send data error as TCP Window size is too small.&quot; &lt;&lt; std::endl;64                continue;65            &#125; 66            else if (errno == EINTR)67            &#123;68                //å¦‚æœè¢«ä¿¡å·ä¸­æ–­ï¼Œæˆ‘ä»¬ç»§ç»­é‡è¯•69                std::cout &lt;&lt; &quot;sending data interrupted by signal.&quot; &lt;&lt; std::endl;70                continue;71            &#125; 72            else 73            &#123;74                std::cout &lt;&lt; &quot;send data error.&quot; &lt;&lt; std::endl;75                break;76            &#125;77        &#125;78        else if (ret == 0)79        &#123;80            //å¯¹ç«¯å…³é—­äº†è¿æ¥ï¼Œæˆ‘ä»¬ä¹Ÿå…³é—­81            std::cout &lt;&lt; &quot;send 0 byte data.&quot; &lt;&lt; std::endl;82        &#125; 83        else84        &#123;85            count ++;86            std::cout &lt;&lt; &quot;send data successfully, count = &quot; &lt;&lt; count &lt;&lt; std::endl;87        &#125;8889        //æ¯ä¸‰ç§’å‘ä¸€æ¬¡90        sleep(3);91    &#125;9293    //5. å…³é—­socket94    close(clientfd);9596    return 0;97&#125;\n\nclient ç«¯è¿æ¥æœåŠ¡å™¨æˆåŠŸä»¥åï¼Œæ¯éš” 3 ç§’è°ƒç”¨ send ä¸€æ¬¡å‘é€ä¸€ä¸ª 0 å­—èŠ‚çš„æ•°æ®ã€‚é™¤äº†å…ˆå¯åŠ¨ server ä»¥å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨ tcpdump æŠ“ä¸€ä¸‹ç»è¿‡ç«¯å£ 3000 ä¸Šçš„æ•°æ®åŒ…ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š\n11tcpdump -i any &#x27;tcp port 3000&#x27;\n\nç„¶åå¯åŠ¨ client ï¼Œæˆ‘ä»¬çœ‹ä¸‹ç»“æœï¼š\n\nå®¢æˆ·ç«¯ç¡®å®æ˜¯æ¯éš” 3 ç§’ send ä¸€æ¬¡æ•°æ®ã€‚æ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨ lsof -i -Pn å‘½ä»¤æŸ¥çœ‹è¿æ¥çŠ¶æ€ï¼Œä¹Ÿæ˜¯æ­£å¸¸çš„ï¼š\n\nç„¶åï¼Œtcpdump æŠ“åŒ…ç»“æœè¾“å‡ºä¸­ï¼Œé™¤äº†è¿æ¥æ—¶çš„ä¸‰æ¬¡æ¡æ‰‹æ•°æ®åŒ…ï¼Œå†ä¹Ÿæ— å…¶ä»–æ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œsend å‡½æ•°å‘é€ 0 å­—èŠ‚æ•°æ®ï¼Œclient çš„åè®®æ ˆå¹¶ä¸ä¼šæŠŠè¿™äº›æ•°æ®å‘å‡ºå»ã€‚\n1234561[root@localhost ~]# tcpdump -i any &#x27;tcp port 3000&#x27;2tcpdump: verbose output suppressed, use -v or -vv for full protocol decode3listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes417:37:03.028449 IP localhost.48820 &gt; localhost.hbci: Flags [S], seq 1632283330, win 43690, options [mss 65495,sackOK,TS val 201295556 ecr 0,nop,wscale 7], length 0517:37:03.028479 IP localhost.hbci &gt; localhost.48820: Flags [S.], seq 3669336158, ack 1632283331, win 43690, options [mss 65495,sackOK,TS val 201295556 ecr 201295556,nop,wscale 7], length 0617:37:03.028488 IP localhost.48820 &gt; localhost.hbci: Flags [.], ack 1, win 342, options [nop,nop,TS val 201295556 ecr 201295556], length 0\n\nå› æ­¤ï¼Œserver ç«¯ä¹Ÿä¼šä¸€ç›´æ²¡æœ‰è¾“å‡ºï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ gdb å¯åŠ¨ serverï¼Œæ­¤æ—¶ä¸­æ–­ä¸‹æ¥ä¼šå‘ç°ï¼Œserver ç«¯ç”±äºæ²¡æœ‰æ•°æ®ä¼šä¸€ç›´é˜»å¡åœ¨ recv å‡½æ•°è°ƒç”¨å¤„ï¼ˆ55 è¡Œï¼‰ã€‚\n\nä¸Šè¿°ç¤ºä¾‹å†æ¬¡éªŒè¯äº†ï¼Œsend ä¸€ä¸ª 0 å­—èŠ‚çš„æ•°æ®æ²¡æœ‰ä»»ä½•æ„æ€ï¼Œå¸Œæœ›è¯»è€…åœ¨å®é™…å¼€å‘æ—¶ï¼Œé¿å…å†™å‡ºè¿™æ ·çš„ä»£ç ã€‚\n","slug":"è½¬è½½/ç½‘ç»œç¼–ç¨‹/éé˜»å¡æ¨¡å¼ä¸‹sendå’Œrecvå‡½æ•°çš„è¿”å›å€¼","date":"2021-05-06T09:27:48.000Z","categories_index":"è½¬è½½","tags_index":"å­¦ä¹ èµ„æ–™,ç½‘ç»œç¼–ç¨‹","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3faf2e95846c995629df56586598456a","title":"C++ä¸­å˜é‡å’Œå¯¹è±¡å¯ä»¥å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ä½ç½®","content":"åœ¨ C++ ä¸­ï¼Œå˜é‡å’Œå¯¹è±¡å¯ä»¥å­˜æ”¾åœ¨å„ç§ä¸åŒçš„å†…å­˜ä½ç½®ï¼Œå…·ä½“å–å†³äºå®ƒä»¬çš„å®šä¹‰æ–¹å¼ã€ç”Ÿå‘½å‘¨æœŸåŠå…¶ç±»å‹ç­‰å› ç´ ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„ C++ å˜é‡å’Œå¯¹è±¡æ‰€å­˜æ”¾çš„ä½ç½®ï¼š\n\nè‡ªåŠ¨å˜é‡ï¼šè‡ªåŠ¨å˜é‡æ˜¯æŒ‡åœ¨ç¨‹åºä¸­ä½¿ç”¨ä½œç”¨åŸŸå£°æ˜çš„å˜é‡ï¼ˆå³å±€éƒ¨å˜é‡ï¼‰ï¼Œå…¶å€¼åªåœ¨ç›¸åº”ä½œç”¨åŸŸå†…æœ‰æ•ˆã€‚è¿™äº›å˜é‡é€šå¸¸è¢«åˆ†é…åœ¨å †æ ˆä¸Šï¼ˆStack Memoryï¼‰ä¸­ï¼Œå¹¶åœ¨å‡½æ•°è¿è¡Œæ—¶åŠ¨æ€åœ°åˆ†é…å’Œé‡Šæ”¾ã€‚\n1234void example() &#123;    int x = 10; // åœ¨å †æ ˆä¸­åˆ†é…æ•´æ•°å˜é‡x    // ...&#125;\n\né™æ€å˜é‡ï¼šé™æ€å˜é‡å±äºæ‰€æœ‰å®ä¾‹å…±äº«çš„å˜é‡ï¼Œå®ƒä»¬ä¸€èˆ¬åœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶é™æ€åœ°åˆ†é…åˆ°ä¸€ä¸ªè§„å®šçš„å†…å­˜ä½ç½®ã€‚å…¨å±€å˜é‡å’Œå‡½æ•°å†… static å˜é‡éƒ½å±äºé™æ€å˜é‡ã€‚å…¨å±€å˜é‡ä¼šè¢«åˆ†é…åˆ°æ•°æ®æ®µä¸­ï¼ˆData Segmentï¼‰ï¼Œè€Œå‡½æ•°å†… static å˜é‡ä¼šè¢«åˆ†é…åˆ°å…¨å±€æˆ–é™æ€å˜é‡æ‰€åœ¨çš„å†…å­˜åŒºåŸŸä¸­ã€‚\n1234int globalVar; // åˆ†é…åœ¨æ•°æ®æ®µä¸­çš„å…¨å±€å˜é‡void example() &#123;    static int localVar; // å‡½æ•°å†…é™æ€å˜é‡    //   &#125;\n\nåŠ¨æ€åˆ†é…çš„å˜é‡ï¼šåŠ¨æ€å˜é‡æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´åŠ¨æ€åœ°åˆ†é…å’Œé‡Šæ”¾çš„ï¼Œé€šå¸¸æ˜¯ç”± new å’Œ delete æˆ–è€… malloc() å’Œ free() ç­‰æ“ä½œæ‰€åˆ›å»ºã€åˆ†é…å’Œé‡Šæ”¾çš„ã€‚åŠ¨æ€å˜é‡é€šå¸¸è¢«åˆ†é…åˆ°å †ï¼ˆHeap Memoryï¼‰ä¸­ã€‚\n123int* ptr = new int(10); // åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´å‹å˜é‡// ...delete ptr; // å†…å­˜é‡Šæ”¾\n\nå¸¸é‡å’Œæ–‡æœ¬å­—ç¬¦ä¸²ï¼šå¸¸é‡è¢«ä¿å­˜åœ¨ä»£ç æ®µï¼ˆCode Segmentï¼‰ã€å…¨å±€æ•°æ®åŒºï¼ˆGlobal Data Areaï¼‰æˆ–åªè¯»æ•°æ®åŒºï¼ˆRead Only Data Segmentï¼‰ã€‚æ–‡æœ¬å­—ç¬¦ä¸²ä¿å­˜åœ¨ ++ ç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨ç¨‹åºè¿è¡Œæ—¶è¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚\n12const int constantNum = 10; // å®šä¹‰å¸¸é‡æ•°å€¼const char* str = &quot;hello&quot;; // æ–‡æœ¬å­—ç¬¦ä¸²åœ¨ä»£ç æ®µä¸­\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒC++ å˜é‡æ‰€å­˜æ”¾çš„ä½ç½®ä¸ä»…å–å†³äºå®ƒä»¬çš„ç±»å‹å’Œå®šä¹‰æ–¹å¼ï¼Œè¿˜å¯èƒ½å—åˆ°ç¼–è¯‘å™¨å’Œç¼–è¯‘å™¨é€‰é¡¹ç­‰å› ç´ çš„å½±å“ã€‚ç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨è°ƒè¯•å·¥å…·æ¥æŸ¥çœ‹å˜é‡çš„å®é™…å†…å­˜åœ°å€å¹¶ç ”ç©¶å…¶ä½ç½®ã€‚\n","slug":"C++/C++ä¸­å˜é‡å’Œå¯¹è±¡å¯ä»¥å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ä½ç½®","date":"2018-05-12T05:52:41.000Z","categories_index":"C++åŸºç¡€","tags_index":"C++,ç½‘ç»œé€šä¿¡","author_index":"é˜¿æœ¨å¤§å”"},{"id":"5ea2af3786de0c1e89d3cfbe74111832","title":"ç¬¬16èŠ‚ MFCä¹‹SendMessageå’ŒPostMessage","content":"\n1ã€PostMessageä¼šå°†æ¶ˆæ¯å‹å…¥çª—å£æ‰€åœ¨çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åè¿”å›ï¼›è€ŒSendMessageåˆ™ä¸ç»è¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒSendMessageå¯è®¤ä¸ºæ˜¯ç›´æ¥è°ƒç”¨äº†è¯¥çª—å£çš„çª—å£è¿‡ç¨‹ï¼Œå› æ­¤åœ¨æˆ‘ä»¬éœ€è¦è·å¾—æ¶ˆæ¯å¤„ç†åçš„è¿”å›å€¼çš„æ—¶å€™ï¼Œå°±è¦ç”¨åˆ°SendMessageã€‚    ä¾‹å¦‚ï¼šå½“åœ¨ç¨‹åºä¸­æŒ‡å®šå¦‚ä¸‹ä½¿ç”¨ï¼šPostMessageï¼ˆhWnd, WM_MSG,0,0ï¼‰ï¼Œé‚£ä¹ˆå½“ç¨‹åºæ‰§è¡Œåˆ°PostMessageçš„æ—¶å€™ï¼Œä»…å°†æ¶ˆæ¯WM_MSGå‹å…¥åˆ°åˆ›å»ºhWndæ‰€æŒ‡çª—å£çš„é‚£ä¸ªçº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åç¨‹åºå°†ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œè€Œè‡³äºç¨‹åºä»€ä¹ˆæ—¶å€™å“åº”è¯¥æ¶ˆæ¯ï¼Œåˆ™è¦çœ‹é‚£ä¸ªçº¿ç¨‹ä»€ä¹ˆæ—¶å€™å¾—åˆ°æ§åˆ¶æƒï¼›    è€ŒæŒ‡å®šå¦‚ä¸‹ä½¿ç”¨ï¼šSendMessageï¼ˆhWnd, WM_MSG,0,0ï¼‰ï¼Œé‚£ä¹ˆå½“ç¨‹åºæ‰§è¡Œåˆ°è¯¥å¤„æ—¶ï¼Œå°†å‘ç”Ÿä¸€æ¬¡è·³è½¬ï¼šä»å½“å‰ä½ç½®ï¼Œè·³è½¬åˆ°hWndçš„çª—å£è¿‡ç¨‹ä¸­å»å“åº”WM_MSGæ¶ˆæ¯ï¼Œå½“æ¶ˆæ¯å¤„ç†ç»“æŸï¼Œçª—å£è¿‡ç¨‹è¿”å›ï¼Œç¨‹åºåˆå°†ä»SendMessageåé¢ç»§ç»­æ‰§è¡Œï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—çª—å£è¿‡ç¨‹å¯¹è¯¥æ¶ˆæ¯çš„å¤„ç†ç»“æœï¼Œä¹Ÿå³å–SendMessageçš„è¿”å›å€¼ã€‚ï¼ˆè¿™é‡Œåªæ˜¯é’ˆå¯¹å•çº¿ç¨‹ï¼‰ã€‚\n\n\n2ã€åœ¨å¤šçº¿ç¨‹åº”ç”¨ä¸­ï¼ŒPostMessageçš„ç”¨æ³•è¿˜æ˜¯ä¸€æ ·ï¼Œä½†SendMessageåˆ™ä¸åŒäº†ã€‚å¦‚æœåœ¨çº¿ç¨‹Aä¸­å‘çº¿ç¨‹Bæ‰€åˆ›å»ºçš„ä¸€ä¸ªçª—å£hWndBå‘é€æ¶ˆæ¯SendMessageï¼ˆhWndBï¼ŒWM_MSGï¼Œ0ï¼Œ0ï¼‰ï¼Œé‚£ä¹ˆç³»ç»Ÿå°†ä¼šç«‹å³å°†æ‰§è¡Œæƒä»çº¿ç¨‹Aåˆ‡æ¢åˆ°çº¿ç¨‹Bï¼Œç„¶ååœ¨çº¿ç¨‹Bä¸­è°ƒç”¨hWndBçš„çª—å£è¿‡ç¨‹æ¥å¤„ç†æ¶ˆæ¯ï¼Œå¹¶ä¸”åœ¨å¤„ç†å®Œè¯¥æ¶ˆæ¯åï¼Œæ‰§è¡Œæƒä»ç„¶åœ¨Bæ‰‹ä¸­ï¼è¿™ä¸ªæ—¶å€™ï¼Œçº¿ç¨‹Aåˆ™æš‚åœåœ¨SendMessageå¤„ï¼Œç­‰å¾…ä¸‹æ¬¡çº¿ç¨‹Aè·å¾—æ‰§è¡Œæƒåæ‰ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä¸”ä»ç„¶å¯ä»¥è·å¾—æ¶ˆæ¯å¤„ç†çš„ç»“æœï¼ˆè¿”å›å€¼ï¼‰ã€‚ä¸€èˆ¬ï¼Œä¸ºäº†é¿å…æ­»é”ï¼Œåœ¨Bä¸­å¯¹WM_MSGåšå‡ºå¤„ç†ä¹‹å‰ï¼Œè¦åŠ ä¸Šï¼šif(InSendMessage()) RelpyMessage(lResult)ï¼› å³åˆ¤æ–­ï¼šå¦‚æœè¯¥æ¶ˆæ¯æ˜¯å‘è‡ªå¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ™ç«‹å³ RelpyMessageï¼Œå›å¤æ¶ˆæ¯ï¼Œå‚æ•°lResultå³æ˜¯è¿”å›å€¼ã€‚è€Œå¦‚æœæ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œåˆ™InSendMessage()å°†ä¼šè¿”å›FALSEã€‚     â€”ç™¾åº¦çŸ¥é“\n\næ€»è€Œè¨€ä¹‹ï¼ŒæŒ‰æˆ‘çš„ç†è§£ï¼ŒSendMessageå’ŒPostMessageéƒ½æ˜¯å‘çª—ä½“å‘é€æ¶ˆæ¯çš„å‡½æ•°ï¼Œä½†æ˜¯PostMessageå‘é€å®Œæ¶ˆæ¯ç«‹åˆ»è¿”å›ï¼Œä¸ä¼šç­‰å¾…æ¶ˆæ¯ç»“æœï¼Œä½†SendMessageä¼šç­‰åˆ°æ¶ˆæ¯è¿”å›ç»“æœå†æ‰§è¡Œä¸‹ä¸€æ­¥ï¼›\nä»Šå¤©æˆ‘ä»¬é€šè¿‡å„ä¾‹å­æ¥è¯•è¯•è¿™ä¸¤ç§å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼›\n\nåˆ›å»ºä¸€ä¸ªç•Œé¢å›¾æ ‡ï¼Œé€šè¿‡æ‹–åŠ¨å›¾æ ‡åˆ°ä»»æ„çš„windowsçª—å£ä¸Šï¼Œè·å–åˆ°çª—å£çš„å¥æŸ„ï¼Œæ ‡é¢˜ï¼Œç±»åï¼›å¹¶é€šè¿‡SendMessageæˆ–PostMessageå‘é€æ¶ˆæ¯åˆ°è¯¥çª—å£ï¼Œä¿®æ”¹çª—å£æ ‡é¢˜æˆ–å…³é—­çª—å£ï¼›\n\n1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday18â€ï¼Œå¸ƒå±€å¦‚ä¸‹ï¼Œè‡ªè¡Œå¤„ç†ï¼š\n2. æ–°å»ºç±»Cday18Dlgæˆå‘˜å˜é‡1234HCURSOR m_hCursor;  //å®šä¹‰ä¸€ä¸ªé¼ æ ‡çš„æŒ‡é’ˆRECT m_rtCtrl;      //å›¾æ ‡çš„å¤§å°BOOL m_bCapturing;   //é¼ æ ‡æ•è·HWND m_hWndDest;   //ç›®æ ‡çª—å£çš„çª—å£å¥æŸ„\n\n3.åŠ è½½é¼ æ ‡æŒ‡é’ˆåŠè·å–å›¾æ ‡å¤§å°ç¼–è¾‘Cday18Dlg::OnInitDialog()åˆå§‹åŒ–å‡½æ•°ï¼Œåœ¨returnä¹‹å‰æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œ\n12m_hCursor = LoadCursor(NULL, IDC_SIZEALL);GetDlgItem(IDC_PIC)-&gt;GetWindowRect(&amp;m_rtCtrl);\n4.åˆ›å»ºé¼ æ ‡å³é”®ç‚¹å‡»åŠé‡Šæ”¾æ¶ˆæ¯å¦‚å›¾ï¼Œæ·»åŠ OnLButtonDownåŠOnLButtonUpæ¶ˆæ¯å¤„ç†å‡½æ•°ï¼šç¼–è¾‘OnLButtonDownåŠOnLButtonUpæ¶ˆæ¯å¤„ç†å‡½æ•°ï¼š\n1234567891011121314void Cday18Dlg::OnLButtonDown(UINT nFlags, CPoint point)&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ¶ˆæ¯å¤„ç†ç¨‹åºä»£ç å’Œ/æˆ–è°ƒç”¨é»˜è®¤å€¼\tif (point.x &gt;= m_rtCtrl.left \t\t&amp;&amp; point.x &lt;= m_rtCtrl.right \t\t|| point.y &gt;= m_rtCtrl.top \t\t&amp;&amp; point.y &lt;= m_rtCtrl.bottom)\t&#123;\t\tm_bCapturing = TRUE;\t\tSetCapture(); // å¼€å§‹æ•è·é¼ æ ‡\t\tSetCursor(m_hCursor);\t&#125;\tCDialogEx::OnLButtonDown(nFlags, point);&#125;\nä»£ç è§£é‡Šï¼š\n\n1.åˆ¤æ–­é¼ æ ‡ç‚¹å‡»çš„ä½ç½®æ˜¯å¦åœ¨å›¾æ ‡ä¸Šï¼›2.è‹¥æ˜¯ï¼Œåˆ™å°†å¼€å§‹æ•è·é¼ æ ‡æ ‡å¿—ç½®ä½çœŸï¼Œå¹¶ä¸”å¼€å§‹æ•è·é¼ æ ‡ä½ç½®ï¼›3.å°†æ•è·çš„é¼ æ ‡ä½ç½®è®¾ç½®åˆ°æˆå‘˜å˜é‡m_hCursorï¼›\n\n12345678910111213141516171819202122void Cday18Dlg::OnLButtonUp(UINT nFlags, CPoint point)&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ¶ˆæ¯å¤„ç†ç¨‹åºä»£ç å’Œ/æˆ–è°ƒç”¨é»˜è®¤å€¼\tif (m_bCapturing)\t&#123;\t\tReleaseCapture();\t\tm_bCapturing = FALSE;\t\tPOINT pt = point;\t\tClientToScreen(&amp;pt);\t\tm_hWndDest = ::WindowFromPoint(pt);\t\tTCHAR szBuf[MAX_PATH] = &#123;0&#125;;\t\t_stprintf(szBuf,_T(&quot;0x%.8X&quot;),m_hWndDest);\t\tSetDlgItemText(IDC_EDIT_DESTHWND,szBuf);\t\tGetClassName(m_hWndDest,szBuf,MAX_PATH);\t\tSetDlgItemText(IDC_EDIT_DESTCLASS,szBuf);\t\t::SendMessage(m_hWndDest,WM_GETTEXT,MAX_PATH,(LPARAM)szBuf);\t\tSetDlgItemText(IDC_EDIT_DESTTEXT,szBuf);\t&#125;\tCDialogEx::OnLButtonUp(nFlags, point);&#125;\n\nä»£ç è§£é‡Šï¼š\n\n1.åˆ¤æ–­æ˜¯å¦åœ¨æ•è·é¼ æ ‡ï¼›2.è‹¥æ˜¯ï¼Œé‡Šæ”¾é¼ æ ‡æ•è·ï¼Œè·å–å½“å‰é¼ æ ‡çš„ä½ç½®ï¼›3.é€šè¿‡å½“å‰é¼ æ ‡çš„ä½ç½®è·å–åˆ°å½“å‰ä½ç½®çš„çª—å£å¥æŸ„ï¼›4.åˆ†åˆ«è·å–è¯¥çª—å£çš„å¥æŸ„ï¼Œç±»åï¼Œæ ‡é¢˜ï¼›\n\næ•ˆæœå›¾ï¼š\n5.å®ç°ä¿®æ”¹ç›®æ ‡çª—å£æ ‡é¢˜åŒå‡»â€œä¿®æ”¹æ ‡é¢˜â€æŒ‰é’®ï¼Œç¼–è¾‘å…¶clickedæ–¹æ³•ï¼š\n1234567void Cday18Dlg::OnBnClickedBtnSettext()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tCString strText;\tGetDlgItemText(IDC_EDIT_DESTTEXT,strText);\t::SendMessage(m_hWndDest,WM_SETTEXT,0,(LPARAM)(LPCTSTR)strText);&#125;\nä»£ç è§£é‡Šï¼š\n\n1.è·å–æ–‡æœ¬æ¡†ä¸­çš„æ ‡é¢˜å€¼ï¼›2.é€šè¿‡SendMessageæ–¹æ³•å‘é€WM_SETTEXTæ¶ˆæ¯ä¿®æ”¹ç›®æ ‡çª—å£çš„æ ‡é¢˜\n\næ•ˆæœå›¾ï¼š\n6.å®ç°å…³é—­ç›®æ ‡çª—å£åŒå‡»â€œå…³é—­æ ‡é¢˜â€æŒ‰é’®ï¼Œç¼–è¾‘å…¶clickedæ–¹æ³•ï¼š\n123456void Cday18Dlg::OnBnClickedBtnSettext2()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \t::SendMessage(m_hWndDest,WM_CLOSE,0,0);\t//::PostMessage(m_hWndDest,WM_CLOSE,0,0);&#125;\nä»£ç è§£é‡Šï¼š\n\n1.é€šè¿‡SendMessageæ–¹æ³•å‘é€WM_CLOSEæ¶ˆæ¯æ¥å…³é—­ç›®æ ‡çª—å£ï¼›\n\nä¸Šé¢æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨SendMessageæ–¹æ³•æ¥å‘é€æ¶ˆæ¯ï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠSendMessageå…¨éƒ¨æ›¿æ¢æˆPostMessageï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼šæˆ‘ä»¬å¯ä»¥çœ‹â€œçª—å£æ ‡é¢˜â€è·å–çš„å€¼æ˜¯ä¸å¯¹çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è·å–æ ‡é¢˜çš„è¿™æ®µä»£ç ï¼š\n123456789101112ReleaseCapture();m_bCapturing = FALSE;POINT pt = point;ClientToScreen(&amp;pt);m_hWndDest = ::WindowFromPoint(pt);TCHAR szBuf[MAX_PATH] = &#123;0&#125;;_stprintf(szBuf,_T(&quot;0x%.8X&quot;),m_hWndDest);SetDlgItemText(IDC_EDIT_DESTHWND,szBuf);GetClassName(m_hWndDest,szBuf,MAX_PATH);SetDlgItemText(IDC_EDIT_DESTCLASS,szBuf);::PostMessage(m_hWndDest,WM_GETTEXT,MAX_PATH,(LPARAM)szBuf);SetDlgItemText(IDC_EDIT_DESTTEXT,szBuf);\næˆ‘ä»¬çœ‹åˆ°å‰é¢è·å–çª—å£å¥æŸ„ï¼Œç±»åéƒ½æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯åˆ°äº†æœ€åè·å–æ ‡é¢˜æ—¶å‡ºäº†é—®é¢˜ï¼›é‚£æ˜¯å› ä¸ºPostMessageæ˜¯ä¸ä¼šç­‰å¾…æ¶ˆæ¯çš„è¿”å›ç»“æœï¼Œå‘é€ä¹‹åç›´æ¥å¾€ä¸‹è¿è¡Œï¼Œè¿™æ—¶szBufçš„å€¼è¿˜æ˜¯å‰é¢è·å–çš„â€œçª—å£ç±»åâ€ï¼Œæ‰€ä»¥å¯¼è‡´æœ€åçš„â€œçª—å£æ ‡é¢˜â€å†…å®¹è·å–å‡ºé”™ï¼Œè¿™ä¹Ÿå¾ˆå¥½çš„è¯æ˜PostMessageå’ŒSendMessageçš„åŒºåˆ«ï¼›è¿˜æœ‰â€œä¿®æ”¹æ ‡é¢˜â€åŠâ€œå…³é—­çª—å£â€æŒ‰é’®ä¸ç®¡æ˜¯PostMessageå’ŒSendMessageæ–¹æ³•éƒ½ä¸ä¼šå‡ºé”™ï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨è¿™ä¸¤ä¸ªæŒ‰é’®æ–¹æ³•ä¸­éƒ½ä¸éœ€è¦æ¶ˆæ¯çš„è¿”å›å€¼ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬ä»¥åçš„å®é™…ä½¿ç”¨ä¸­ä¸€å®šè¦è€ƒè™‘æ¸…æ¥šéœ€è¦ä½¿ç”¨å“ªç§å‘é€æ¶ˆæ¯æ–¹æ³•ï¼›\nåŠ¨æ€æ•ˆæœå›¾ï¼šé™„MFCæ¶ˆæ¯åˆ†ç±»åŠè¯´æ˜ï¼š\nçª—å£æ¶ˆæ¯\nWM_CREATE           åˆ›å»ºä¸€ä¸ªçª—å£ WM_DESTROY          å½“ä¸€ä¸ªçª—å£è¢«ç ´åæ—¶å‘é€ WM_MOVEç§»åŠ¨ä¸€ä¸ªçª—å£ WM_SIZE             æ”¹å˜ä¸€ä¸ªçª—å£çš„å¤§å° WM_ACTIVATEä¸€ä¸ªçª—å£è¢«æ¿€æ´»æˆ–å¤±å»æ¿€æ´»çŠ¶æ€ WM_SETFOCUS         ä¸€ä¸ªçª—å£è·å¾—ç„¦ç‚¹ WM_KILLFOCUSä¸€ä¸ªçª—å£å¤±å»ç„¦ç‚¹ WM_ENABLE           ä¸€ä¸ªçª—å£æ”¹å˜æˆEnableçŠ¶æ€ WM_SETREDRAWè®¾ç½®çª—å£æ˜¯å¦èƒ½é‡ç”» WM_SETTEXT          åº”ç”¨ç¨‹åºå‘é€æ­¤æ¶ˆæ¯æ¥è®¾ç½®ä¸€ä¸ªçª—å£çš„æ–‡æœ¬ WM_GETTEXTåº”ç”¨ç¨‹åºå‘é€æ­¤æ¶ˆæ¯æ¥å¤åˆ¶å¯¹åº”çª—å£çš„æ–‡æœ¬åˆ°ç¼“å†²åŒº WM_GETTEXTLENGTH    å¾—åˆ°ä¸ä¸€ä¸ªçª—å£æœ‰å…³çš„æ–‡æœ¬çš„é•¿åº¦ï¼ˆä¸åŒ…å«ç©ºå­—ç¬¦ï¼‰WM_PAINT            è¦æ±‚ä¸€ä¸ªçª—å£é‡ç”»è‡ªå·± WM_CLOSEå½“ä¸€ä¸ªçª—å£æˆ–åº”ç”¨ç¨‹åºè¦å…³é—­æ—¶å‘é€ä¸€ä¸ªä¿¡å· WM_QUERYENDSESSIONå½“ç”¨æˆ·é€‰æ‹©ç»“æŸå¯¹è¯æ¡†æˆ–ç¨‹åºè‡ªå·±è°ƒç”¨ExitWindowså‡½æ•° WM_QUIT             ç”¨æ¥ç»“æŸç¨‹åºè¿è¡ŒWM_QUERYOPEN        å½“ç”¨æˆ·çª—å£æ¢å¤ä»¥å‰çš„å¤§å°ä½ç½®æ—¶ï¼ŒæŠŠæ­¤æ¶ˆæ¯å‘é€ç»™æŸä¸ªå›¾æ ‡ WM_ERASEBKGNDå½“çª—å£èƒŒæ™¯å¿…é¡»è¢«æ“¦é™¤æ—¶ï¼ˆä¾‹åœ¨çª—å£æ”¹å˜å¤§å°æ—¶ï¼‰ WM_SYSCOLORCHANGE   å½“ç³»ç»Ÿé¢œè‰²æ”¹å˜æ—¶ï¼Œå‘é€æ­¤æ¶ˆæ¯ç»™æ‰€æœ‰é¡¶çº§çª—å£WM_ENDSESSION       å½“ç³»ç»Ÿè¿›ç¨‹å‘å‡ºWM_QUERYENDSESSIONæ¶ˆæ¯åï¼Œæ­¤æ¶ˆæ¯å‘é€ç»™åº”ç”¨ç¨‹åºï¼Œé€šçŸ¥å®ƒå¯¹è¯æ˜¯å¦ç»“æŸWM_SHOWWINDOW       å½“éšè—æˆ–æ˜¾ç¤ºçª—å£æ˜¯å‘é€æ­¤æ¶ˆæ¯ç»™è¿™ä¸ªçª—å£ WM_ACTIVATEAPPå‘æ­¤æ¶ˆæ¯ç»™åº”ç”¨ç¨‹åºå“ªä¸ªçª—å£æ˜¯æ¿€æ´»çš„ï¼Œå“ªä¸ªæ˜¯éæ¿€æ´»çš„ WM_FONTCHANGE       å½“ç³»ç»Ÿçš„å­—ä½“èµ„æºåº“å˜åŒ–æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™æ‰€æœ‰é¡¶çº§çª—å£WM_TIMECHANGE       å½“ç³»ç»Ÿçš„æ—¶é—´å˜åŒ–æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™æ‰€æœ‰é¡¶çº§çª—å£ WM_CANCELMODEå‘é€æ­¤æ¶ˆæ¯æ¥å–æ¶ˆæŸç§æ­£åœ¨è¿›è¡Œçš„æ‘¸æ€ï¼ˆæ“ä½œï¼‰ WM_SETCURSORå¦‚æœé¼ æ ‡å¼•èµ·å…‰æ ‡åœ¨æŸä¸ªçª—å£ä¸­ç§»åŠ¨ä¸”é¼ æ ‡è¾“å…¥æ²¡æœ‰è¢«æ•è·æ—¶ï¼Œå°±å‘æ¶ˆæ¯ç»™æŸä¸ªçª—å£ WM_MOUSEACTIVATEå½“å…‰æ ‡åœ¨æŸä¸ªéæ¿€æ´»çš„çª—å£ä¸­è€Œç”¨æˆ·æ­£æŒ‰ç€é¼ æ ‡çš„æŸä¸ªé”®å‘é€æ­¤æ¶ˆæ¯ç»™å½“å‰çª—å£ WM_CHILDACTIVATEå‘é€æ­¤æ¶ˆæ¯ç»™MDIå­çª—å£å½“ç”¨æˆ·ç‚¹å‡»æ­¤çª—å£çš„æ ‡é¢˜æ ï¼Œæˆ–å½“çª—å£è¢«æ¿€æ´»ï¼Œç§»åŠ¨ï¼Œæ”¹å˜å¤§å° WM_QUEUESYNCæ­¤æ¶ˆæ¯ç”±åŸºäºè®¡ç®—æœºçš„è®­ç»ƒç¨‹åºå‘é€ï¼Œé€šè¿‡ WH_JOURNALPALYBACK çš„ hook ç¨‹åºåˆ†ç¦»å‡ºç”¨æˆ·è¾“å…¥æ¶ˆæ¯WM_GETMINMAXINFO    æ­¤æ¶ˆæ¯å‘é€ç»™çª—å£å½“å®ƒå°†è¦æ”¹å˜å¤§å°æˆ–ä½ç½® WM_PAINTICONå‘é€ç»™æœ€å°åŒ–çª—å£å½“å®ƒå›¾æ ‡å°†è¦è¢«é‡ç”» WM_ICONERASEBKGND   æ­¤æ¶ˆæ¯å‘é€ç»™æŸä¸ªæœ€å°åŒ–çª—å£ï¼Œä»…å½“å®ƒåœ¨ç”»å›¾æ ‡å‰å®ƒçš„èƒŒæ™¯å¿…é¡»è¢«é‡ç”»WM_NEXTDLGCTL       å‘é€æ­¤æ¶ˆæ¯ç»™ä¸€ä¸ªå¯¹è¯æ¡†ç¨‹åºå»æ›´æ”¹ç„¦ç‚¹ä½ç½® WM_SPOOLERSTATUSæ¯å½“æ‰“å°ç®¡ç†åˆ—é˜Ÿå¢åŠ æˆ–å‡å°‘ä¸€æ¡ä½œä¸šæ—¶å‘å‡ºæ­¤æ¶ˆæ¯ WM_DRAWITEMå½“buttonï¼Œcomboboxï¼Œlistboxï¼Œmenuçš„å¯è§†å¤–è§‚æ”¹å˜æ—¶å‘é€ WM_MEASUREITEM      å½“button,combo box, list box, list view control, or menu item è¢«åˆ›å»ºæ—¶WM_VKEYTOITEMæ­¤æ¶ˆæ¯æœ‰ä¸€ä¸ªLBS_WANTKEYBOARDINPUTé£æ ¼çš„å‘å‡ºç»™å®ƒçš„æ‰€æœ‰è€…æ¥å“åº”WM_KEYDOWNæ¶ˆæ¯ WM_CHARTOITEMæ­¤æ¶ˆæ¯ç”±ä¸€ä¸ªLBS_WANTKEYBOARDINPUTé£æ ¼çš„åˆ—è¡¨æ¡†å‘é€ç»™ä»–çš„æ‰€æœ‰è€…æ¥å“åº”WM_CHARæ¶ˆæ¯ WM_SETFONTå½“ç»˜åˆ¶æ–‡æœ¬æ—¶ç¨‹åºå‘é€æ­¤æ¶ˆæ¯å¾—åˆ°æ§ä»¶è¦ç”¨çš„é¢œè‰² WM_GETFONT          åº”ç”¨ç¨‹åºå‘é€æ­¤æ¶ˆæ¯å¾—åˆ°å½“å‰æ§ä»¶ç»˜åˆ¶æ–‡æœ¬çš„å­—ä½“WM_SETHOTKEY        åº”ç”¨ç¨‹åºå‘é€æ­¤æ¶ˆæ¯è®©ä¸€ä¸ªçª—å£ä¸ä¸€ä¸ªçƒ­é”®ç›¸å…³è¿ WM_GETHOTKEYåº”ç”¨ç¨‹åºå‘é€æ­¤æ¶ˆæ¯æ¥åˆ¤æ–­çƒ­é”®ä¸æŸä¸ªçª—å£æ˜¯å¦æœ‰å…³è” WM_QUERYDRAGICONæ­¤æ¶ˆæ¯å‘é€ç»™æœ€å°åŒ–çª—å£ï¼Œå½“æ­¤çª—å£å°†è¦è¢«æ‹–æ”¾è€Œå®ƒçš„ç±»ä¸­æ²¡æœ‰å®šä¹‰å›¾æ ‡ï¼Œåº”ç”¨ç¨‹åºèƒ½è¿”å›ä¸€ä¸ªå›¾æ ‡æˆ–å…‰æ ‡çš„å¥æŸ„ï¼Œå½“ç”¨æˆ·æ‹–æ”¾å›¾æ ‡æ—¶ç³»ç»Ÿæ˜¾ç¤ºè¿™ä¸ªå›¾æ ‡æˆ–å…‰æ ‡WM_COMPAREITEM      å‘é€æ­¤æ¶ˆæ¯æ¥åˆ¤å®š combobox æˆ– listbox æ–°å¢åŠ çš„é¡¹çš„ç›¸å¯¹ä½ç½®WM_COMPACTING       æ˜¾ç¤ºå†…å­˜å·²ç»å¾ˆå°‘äº† WM_WINDOWPOSCHANGINGå‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£çš„å¤§å°å’Œä½ç½®å°†è¦è¢«æ”¹å˜æ—¶ï¼Œæ¥è°ƒç”¨ setwindowpos å‡½æ•°æˆ–å…¶å®ƒçª—å£ç®¡ç†å‡½æ•°WM_WINDOWPOSCHANGED å‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£çš„å¤§å°å’Œä½ç½®å·²ç»è¢«æ”¹å˜æ—¶ï¼Œæ¥è°ƒç”¨setwindowposå‡½æ•°æˆ–å…¶å®ƒçª—å£ç®¡ç†å‡½æ•°WM_POWER            å½“ç³»ç»Ÿå°†è¦è¿›å…¥æš‚åœçŠ¶æ€æ—¶å‘é€æ­¤æ¶ˆæ¯ WM_COPYDATAå½“ä¸€ä¸ªåº”ç”¨ç¨‹åºä¼ é€’æ•°æ®ç»™å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_CANCELJOURNA     å½“æŸä¸ªç”¨æˆ·å–æ¶ˆç¨‹åºæ—¥å¿—æ¿€æ´»çŠ¶æ€ï¼Œæäº¤æ­¤æ¶ˆæ¯ç»™ç¨‹åºWM_NOTIFY           å½“æŸä¸ªæ§ä»¶çš„æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿæˆ–è¿™ä¸ªæ§ä»¶éœ€è¦å¾—åˆ°ä¸€äº›ä¿¡æ¯æ—¶ï¼Œå‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£WM_INPUTLANGCHANGEREQUEST  å½“ç”¨æˆ·é€‰æ‹©æŸç§è¾“å…¥è¯­è¨€ï¼Œæˆ–è¾“å…¥è¯­è¨€çš„çƒ­é”®æ”¹å˜ WM_INPUTLANGCHANGEå½“å¹³å°ç°åœºå·²ç»è¢«æ”¹å˜åå‘é€æ­¤æ¶ˆæ¯ç»™å—å½±å“çš„æœ€é¡¶çº§çª—å£ WM_TCARD            å½“ç¨‹åºå·²ç»åˆå§‹åŒ– windowså¸®åŠ©ä¾‹ç¨‹æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™åº”ç”¨ç¨‹åº WM_HELPæ­¤æ¶ˆæ¯æ˜¾ç¤ºç”¨æˆ·æŒ‰ä¸‹äº†F1ï¼Œå¦‚æœæŸä¸ªèœå•æ˜¯æ¿€æ´»çš„ï¼Œå°±å‘é€æ­¤æ¶ˆæ¯ä¸ªæ­¤çª—å£å…³è”çš„èœå•ï¼Œå¦åˆ™å°±å‘é€ç»™æœ‰ç„¦ç‚¹çš„çª—å£ï¼Œå¦‚æœå½“å‰éƒ½æ²¡æœ‰ç„¦ç‚¹ï¼Œå°±æŠŠæ­¤æ¶ˆæ¯å‘é€ç»™å½“å‰æ¿€æ´»çš„çª—å£WM_USERCHANGEDå½“ç”¨æˆ·å·²ç»ç™»å…¥æˆ–é€€å‡ºåå‘é€æ­¤æ¶ˆæ¯ç»™æ‰€æœ‰çš„çª—å£ï¼Œå½“ç”¨æˆ·ç™»å…¥æˆ–é€€å‡ºæ—¶ç³»ç»Ÿæ›´æ–°ç”¨æˆ·çš„å…·ä½“è®¾ç½®ä¿¡æ¯ï¼Œåœ¨ç”¨æˆ·æ›´æ–°è®¾ç½®æ—¶ç³»ç»Ÿé©¬ä¸Šå‘é€æ­¤æ¶ˆæ¯WM_NOTIFYFORMAT     å…¬ç”¨æ§ä»¶ï¼Œè‡ªå®šä¹‰æ§ä»¶å’Œä»–ä»¬çš„çˆ¶çª—å£é€šè¿‡æ­¤æ¶ˆæ¯æ¥åˆ¤æ–­æ§ä»¶æ˜¯ä½¿ç”¨ANSIè¿˜æ˜¯UNICODEç»“æ„WM_CONTEXTMENU      å½“ç”¨æˆ·æŸä¸ªçª—å£ä¸­ç‚¹å‡»äº†ä¸€ä¸‹å³é”®å°±å‘é€æ­¤æ¶ˆæ¯ç»™è¿™ä¸ªçª—å£ WM_STYLECHANGINGå½“è°ƒç”¨SETWINDOWLONGå‡½æ•°å°†è¦æ”¹å˜ä¸€ä¸ªæˆ–å¤šä¸ª çª—å£çš„é£æ ¼æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£ WM_STYLECHANGED     å½“è°ƒç”¨SETWINDOWLONG å‡½æ•°ä¸€ä¸ªæˆ–å¤šä¸ª çª—å£çš„é£æ ¼åå‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£ WM_DISPLAYCHANGEå½“æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡æ”¹å˜åå‘é€æ­¤æ¶ˆæ¯ç»™æ‰€æœ‰çš„çª—å£ WM_GETICONæ­¤æ¶ˆæ¯å‘é€ç»™æŸä¸ªçª—å£æ¥è¿”å›ä¸æŸä¸ªçª—å£æœ‰å…³è¿çš„å¤§å›¾æ ‡æˆ–å°å›¾æ ‡çš„å¥æŸ„ WM_SETICONç¨‹åºå‘é€æ­¤æ¶ˆæ¯è®©ä¸€ä¸ªæ–°çš„å¤§å›¾æ ‡æˆ–å°å›¾æ ‡ä¸æŸä¸ªçª—å£å…³è” WM_NCCREATEå½“æŸä¸ªçª—å£ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶ï¼Œæ­¤æ¶ˆæ¯åœ¨WM_CREATEæ¶ˆæ¯å‘é€å‰å‘é€ WM_NCDESTROYæ­¤æ¶ˆæ¯é€šçŸ¥æŸä¸ªçª—å£ï¼Œéå®¢æˆ·åŒºæ­£åœ¨é”€æ¯ WM_NCCALCSIZE       å½“æŸä¸ªçª—å£çš„å®¢æˆ·åŒºåŸŸå¿…é¡»è¢«æ ¸ç®—æ—¶å‘é€æ­¤æ¶ˆæ¯WM_NCHITTEST        ç§»åŠ¨é¼ æ ‡ï¼ŒæŒ‰ä½æˆ–é‡Šæ”¾é¼ æ ‡æ—¶å‘ç”Ÿ WM_NCPAINTç¨‹åºå‘é€æ­¤æ¶ˆæ¯ç»™æŸä¸ªçª—å£å½“å®ƒï¼ˆçª—å£ï¼‰çš„æ¡†æ¶å¿…é¡»è¢«ç»˜åˆ¶æ—¶ WM_NCACTIVATEæ­¤æ¶ˆæ¯å‘é€ç»™æŸä¸ªçª—å£ä»…å½“å®ƒçš„éå®¢æˆ·åŒºéœ€è¦è¢«æ”¹å˜æ¥æ˜¾ç¤ºæ˜¯æ¿€æ´»è¿˜æ˜¯éæ¿€æ´»çŠ¶æ€ WM_GETDLGCODEå‘é€æ­¤æ¶ˆæ¯ç»™æŸä¸ªä¸å¯¹è¯æ¡†ç¨‹åºå…³è”çš„æ§ä»¶ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œwindows å¤„ç†æ‰€æœ‰è¾“å…¥åˆ°æ­¤æ§ä»¶çš„ç®­å¤´é”®å’Œ TAB é”®ã€‚é€šå¸¸å“åº”WM_GETDLGCODE æ¶ˆæ¯ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ§åˆ¶ä¸€ä¸ªç‰¹å®šç±»å‹çš„è¾“å…¥å’Œå¤„ç†è¿™ä¸ªè¾“å…¥                     WM_NCMOUSEMOVE      å½“å…‰æ ‡åœ¨ä¸€ä¸ªçª—å£çš„éå®¢æˆ·åŒºå†…ç§»åŠ¨æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™è¿™ä¸ªçª—å£ã€‚éå®¢æˆ·åŒºä¸ºï¼šçª—ä½“çš„æ ‡é¢˜æ åŠçª—ä½“çš„è¾¹æ¡† WM_NCLBUTTONDOWNå½“å…‰æ ‡åœ¨ä¸€ä¸ªçª—å£çš„éå®¢æˆ·åŒºåŒæ—¶æŒ‰ä¸‹é¼ æ ‡å·¦é”®æ—¶æäº¤æ­¤æ¶ˆæ¯ WM_NCLBUTTONUPå½“ç”¨æˆ·é‡Šæ”¾é¼ æ ‡å·¦é”®åŒæ—¶å…‰æ ‡æŸä¸ªçª—å£åœ¨éå®¢æˆ·åŒºåå‘é€æ­¤æ¶ˆæ¯ WM_NCLBUTTONDBLCLKå½“ç”¨æˆ·åŒå‡»é¼ æ ‡å·¦é”®åŒæ—¶å…‰æ ‡æŸä¸ªçª—å£åœ¨éå®¢æˆ·åŒºåå‘é€æ­¤æ¶ˆæ¯ WM_NCRBUTTONDOWNå½“ç”¨æˆ·æŒ‰ä¸‹é¼ æ ‡å³é”®åŒæ—¶å…‰æ ‡åˆåœ¨çª—å£çš„éå®¢æˆ·åŒºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_NCRBUTTONUPå½“ç”¨æˆ·é‡Šæ”¾é¼ æ ‡å³é”®åŒæ—¶å…‰æ ‡åˆåœ¨çª—å£çš„éå®¢æˆ·åŒºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_NCRBUTTONDBLCLKå½“ç”¨æˆ·åŒå‡»é¼ æ ‡å³é”®åŒæ—¶å…‰æ ‡æŸä¸ªçª—å£åœ¨éå®¢æˆ·åŒºåå‘é€æ­¤æ¶ˆæ¯ WM_NCMBUTTONDOWNå½“ç”¨æˆ·æŒ‰ä¸‹é¼ æ ‡ä¸­é”®åŒæ—¶å…‰æ ‡åˆåœ¨çª—å£çš„éå®¢æˆ·åŒºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_NCMBUTTONUPå½“ç”¨æˆ·é‡Šæ”¾é¼ æ ‡ä¸­é”®åŒæ—¶å…‰æ ‡åˆåœ¨çª—å£çš„éå®¢æˆ·åŒºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_NCMBUTTONDBLCLKå½“ç”¨æˆ·åŒå‡»é¼ æ ‡ä¸­é”®åŒæ—¶å…‰æ ‡åˆåœ¨çª—å£çš„éå®¢æˆ·åŒºæ—¶å‘é€æ­¤æ¶ˆæ¯ WM_KEYFIRST         WM_KEYDOWN æŒ‰ä¸‹ä¸€ä¸ªé”®WM_KEYUP            é‡Šæ”¾ä¸€ä¸ªé”® WM_CHAR             æŒ‰ä¸‹æŸé”®ï¼Œå¹¶å·²å‘å‡ºWM_KEYDOWNï¼ŒWM_KEYUPæ¶ˆæ¯ WM_DEADCHAR         å½“ç”¨ translatemessage å‡½æ•°ç¿»è¯‘ WM_KEYUPæ¶ˆæ¯æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™æ‹¥æœ‰ç„¦ç‚¹çš„çª—å£ WM_SYSKEYDOWN       å½“ç”¨æˆ·æŒ‰ä½ ALT é”®åŒæ—¶æŒ‰ä¸‹å…¶å®ƒé”®æ—¶æäº¤æ­¤æ¶ˆæ¯ç»™æ‹¥æœ‰ç„¦ç‚¹çš„çª—å£WM_SYSKEYUP         å½“ç”¨æˆ·é‡Šæ”¾ä¸€ä¸ªé”®åŒæ—¶ ALT é”®è¿˜æŒ‰ç€æ—¶æäº¤æ­¤æ¶ˆæ¯ç»™æ‹¥æœ‰ç„¦ç‚¹çš„çª—å£ WM_SYSCHARå½“WM_SYSKEYDOWNæ¶ˆæ¯è¢«TRANSLATEMESSAGEå‡½æ•°ç¿»è¯‘åæäº¤æ­¤æ¶ˆæ¯ç»™æ‹¥æœ‰ç„¦ç‚¹çš„çª—å£ WM_SYSDEADCHARå½“WM_SYSKEYDOWNæ¶ˆæ¯è¢«TRANSLATEMESSAGEå‡½æ•°ç¿»è¯‘åå‘é€æ­¤æ¶ˆæ¯ç»™æ‹¥æœ‰ç„¦ç‚¹çš„çª—å£ WM_INITDIALOGåœ¨ä¸€ä¸ªå¯¹è¯æ¡†ç¨‹åºè¢«æ˜¾ç¤ºå‰å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒï¼Œé€šå¸¸ç”¨æ­¤æ¶ˆæ¯åˆå§‹åŒ–æ§ä»¶å’Œæ‰§è¡Œå…¶å®ƒä»»åŠ¡ WM_COMMANDå½“ç”¨æˆ·é€‰æ‹©ä¸€æ¡èœå•å‘½ä»¤é¡¹æˆ–å½“æŸä¸ªæ§ä»¶å‘é€ä¸€æ¡æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£ï¼Œä¸€ä¸ªå¿«æ·é”®è¢«ç¿»è¯‘ WM_SYSCOMMANDå½“ç”¨æˆ·é€‰æ‹©çª—å£èœå•çš„ä¸€æ¡å‘½ä»¤æˆ–å½“ç”¨æˆ·é€‰æ‹©æœ€å¤§åŒ–æˆ–æœ€å°åŒ–æ—¶é‚£ä¸ªçª—å£ä¼šæ”¶åˆ°æ­¤æ¶ˆæ¯ WM_TIMER            å‘ç”Ÿäº†å®šæ—¶å™¨äº‹ä»¶WM_HSCROLL          å½“ä¸€ä¸ªçª—å£æ ‡å‡†æ°´å¹³æ»šåŠ¨æ¡äº§ç”Ÿä¸€ä¸ªæ»šåŠ¨äº‹ä»¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£ï¼Œä¹Ÿå‘é€ç»™æ‹¥æœ‰å®ƒçš„æ§ä»¶WM_VSCROLL          å½“ä¸€ä¸ªçª—å£æ ‡å‡†å‚ç›´æ»šåŠ¨æ¡äº§ç”Ÿä¸€ä¸ªæ»šåŠ¨äº‹ä»¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™é‚£ä¸ªçª—å£ï¼Œä¹Ÿå‘é€ç»™æ‹¥æœ‰å®ƒçš„æ§ä»¶WM_INITMENUå½“ä¸€ä¸ªèœå•å°†è¦è¢«æ¿€æ´»æ—¶å‘é€æ­¤æ¶ˆæ¯ï¼Œå®ƒå‘ç”Ÿåœ¨ç”¨æˆ·èœå•æ¡ä¸­çš„æŸé¡¹æˆ–æŒ‰ä¸‹æŸä¸ªèœå•é”®ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨æ˜¾ç¤ºå‰æ›´æ”¹èœå• WM_INITMENUPOPUPå½“ä¸€ä¸ªä¸‹æ‹‰èœå•æˆ–å­èœå•å°†è¦è¢«æ¿€æ´»æ—¶å‘é€æ­¤æ¶ˆæ¯ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨å®ƒæ˜¾ç¤ºå‰æ›´æ”¹èœå•ï¼Œè€Œä¸è¦æ”¹å˜å…¨éƒ¨ WM_MENUSELECTå½“ç”¨æˆ·é€‰æ‹©ä¸€æ¡èœå•é¡¹æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™èœå•çš„æ‰€æœ‰è€…ï¼ˆä¸€èˆ¬æ˜¯çª—å£ï¼‰ WM_MENUCHARå½“èœå•å·²è¢«æ¿€æ´»ç”¨æˆ·æŒ‰ä¸‹äº†æŸä¸ªé”®ï¼ˆä¸åŒäºåŠ é€Ÿé”®ï¼‰ï¼Œå‘é€æ­¤æ¶ˆæ¯ç»™èœå•çš„æ‰€æœ‰è€… WM_ENTERIDLEå½“ä¸€ä¸ªæ¨¡æ€å¯¹è¯æ¡†æˆ–èœå•è¿›å…¥ç©ºè½½çŠ¶æ€æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„æ‰€æœ‰è€…ï¼Œä¸€ä¸ªæ¨¡æ€å¯¹è¯æ¡†æˆ–èœå•è¿›å…¥ç©ºè½½çŠ¶æ€å°±æ˜¯åœ¨å¤„ç†å®Œä¸€æ¡æˆ–å‡ æ¡å…ˆå‰çš„æ¶ˆæ¯åæ²¡æœ‰æ¶ˆæ¯å®ƒçš„åˆ—é˜Ÿä¸­ç­‰å¾…WM_CTLCOLORMSGBOX   åœ¨ windowsç»˜åˆ¶æ¶ˆæ¯æ¡†å‰å‘é€æ­¤æ¶ˆæ¯ç»™æ¶ˆæ¯æ¡†çš„æ‰€æœ‰è€…çª—å£ï¼Œé€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®æ¶ˆæ¯æ¡†çš„æ–‡æœ¬å’ŒèƒŒæ™¯é¢œè‰²WM_CTLCOLOREDIT     å½“ä¸€ä¸ªç¼–è¾‘å‹æ§ä»¶å°†è¦è¢«ç»˜åˆ¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®ç¼–è¾‘æ¡†çš„æ–‡æœ¬å’ŒèƒŒæ™¯é¢œè‰² WM_CTLCOLORLISTBOXå½“ä¸€ä¸ªåˆ—è¡¨æ¡†æ§ä»¶å°†è¦è¢«ç»˜åˆ¶å‰å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®åˆ—è¡¨æ¡†çš„æ–‡æœ¬å’ŒèƒŒæ™¯é¢œè‰² WM_CTLCOLORBTNå½“ä¸€ä¸ªæŒ‰é’®æ§ä»¶å°†è¦è¢«ç»˜åˆ¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£ é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®æŒ‰çº½çš„æ–‡æœ¬å’ŒèƒŒæ™¯é¢œè‰²WM_CTLCOLORDLG      å½“ä¸€ä¸ªå¯¹è¯æ¡†æ§ä»¶å°†è¦è¢«ç»˜åˆ¶å‰å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®å¯¹è¯æ¡†çš„æ–‡æœ¬èƒŒæ™¯é¢œè‰² WM_CTLCOLORSCROLLBARå½“ä¸€ä¸ªæ»šåŠ¨æ¡æ§ä»¶å°†è¦è¢«ç»˜åˆ¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£ é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®æ»šåŠ¨æ¡çš„èƒŒæ™¯é¢œè‰²WM_CTLCOLORSTATIC   å½“ä¸€ä¸ªé™æ€æ§ä»¶å°†è¦è¢«ç»˜åˆ¶æ—¶å‘é€æ­¤æ¶ˆæ¯ç»™å®ƒçš„çˆ¶çª—å£ é€šè¿‡å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€æœ‰è€…çª—å£å¯ä»¥é€šè¿‡ä½¿ç”¨ç»™å®šçš„ç›¸å…³æ˜¾ç¤ºè®¾å¤‡çš„å¥æŸ„æ¥è®¾ç½®é™æ€æ§ä»¶çš„æ–‡æœ¬å’ŒèƒŒæ™¯é¢œè‰² WM_MOUSEFIRST       ç§»åŠ¨é¼ æ ‡æ—¶å‘ç”ŸWM_MOUSEMOVE        ç§»åŠ¨é¼ æ ‡æ—¶å‘ç”Ÿï¼ŒåŒWM_MOUSEFIRST WM_LBUTTONDOWN      æŒ‰ä¸‹é¼ æ ‡å·¦é”®WM_LBUTTONUP        é‡Šæ”¾é¼ æ ‡å·¦é”® WM_LBUTTONDBLCLK    åŒå‡»é¼ æ ‡å·¦é”® WM_RBUTTONDOWNæŒ‰ä¸‹é¼ æ ‡å³é”® WM_RBUTTONUP        é‡Šæ”¾é¼ æ ‡å³é”® WM_RBUTTONDBLCLK    åŒå‡»é¼ æ ‡å³é”®WM_MBUTTONDOWN      æŒ‰ä¸‹é¼ æ ‡ä¸­é”® WM_MBUTTONUP        é‡Šæ”¾é¼ æ ‡ä¸­é”® WM_MBUTTONDBLCLKåŒå‡»é¼ æ ‡ä¸­é”® WM_MOUSEWHEEL       å½“é¼ æ ‡è½®å­è½¬åŠ¨æ—¶å‘é€æ­¤æ¶ˆæ¯ä¸ªå½“å‰æœ‰ç„¦ç‚¹çš„æ§ä»¶\n\næŒ‰é’®\nBM_CLICK    æŒ‰é’®è¢«ç‚¹å‡»æ¶ˆæ¯  BM_GETCHECK å¯ç”¨äºå¤é€‰æ¡†&#x2F;å•é€‰æ¡†ã€‚æŸ¥çœ‹æ˜¯å¦è¢«é€‰æ‹©äº†  BM_GETSTATEå‘é€æ­¤æ¶ˆæ¯ï¼Œå¯è¿”å› button çš„çŠ¶æ€ï¼Œå¦‚æ˜¯å¦è¢«é€‰æ‹©ï¼›æ˜¯å¦å¯ç”¨ï¼ˆä¸å¯ç”¨å°±å˜ç°äº†ï¼‰  BM_SETCHECKå¦‚æœå·²ç»é€‰æ‹©äº†ï¼Œå‘é€æ­¤æ¶ˆæ¯åï¼Œå˜ä¸ºæœªé€‰æ‹©ï¼Œå°±æ˜¯é‚£ä¸ªé’©æ²¡è¢«å‹¾ä¸Š BM_SETSTATE è®¾ç½® button è¢«ç‚¹å‡»çŠ¶æ€ã€‚\n\nç»„åˆæ¡†\nCB_ADDSTRING       æ·»åŠ å­—ç¬¦ä¸²åˆ°ç»„åˆæ¡†ã€‚  CB_DELETESTRING    åˆ é™¤ç»„åˆæ¡†ä¸­çš„æ¡ç›®ï¼Œå³ item ã€‚CB_GETCOUNT        å¾—åˆ°ç»„åˆæ¡†æ¡ç›® item çš„æ•°ç›®ã€‚  CB_GETCURSELè¿”å›ç»„åˆæ¡†ä¸­è¢«é€‰æ¡ç›®åœ¨ç»„åˆæ¡†ä¸­çš„ä½ç½®ï¼Œç¬¬ä¸€æ¡ä¸º 0ã€‚                   å¦‚æœæ²¡æœ‰æ¡ç›®æˆ–å‡ºé”™ï¼Œåˆ™è¿”å› -1 ã€‚ CB_GETDROPPEDSTATE å‘é€æ­¤æ¶ˆæ¯ï¼Œå¯åˆ¤æ–­ç»„åˆæ¡†çš„ä¸‹æ‹‰åˆ—è¡¨æ˜¯å¦ä¸‹æ‹‰ã€‚                   å¦‚æœæ˜¯ï¼Œè¿”å›éé›¶å€¼ï¼Œä¸æ˜¯ï¼Œåˆ™è¿”å› 0 ã€‚ CB_GETLBTEXT       å¾—åˆ°ç»„åˆæ¡†çš„æ¡ç›®æ–‡æœ¬ã€‚è¿”å›å€¼æ˜¯è¿™ä¸ªæ–‡æœ¬çš„é•¿åº¦ã€‚  CB_GETLBTEXTLEN    è¿”å›å€¼æ˜¯æ¡ç›®çš„æ–‡æœ¬çš„é•¿åº¦ã€‚CB_INSERTSTRING    æ’å…¥å­—ç¬¦ä¸²æ¡ç›®åˆ°ç»„åˆæ¡†ä¸­ã€‚  CB_RESETCONTENT    æ¸…ç©ºç»„åˆæ¡†æ‰€æœ‰æ¡ç›®ã€‚CB_SETCURSEL       è®¾ç½®ç»„åˆæ¡†è¢«é€‰æ¡ç›®ã€‚  CB_SHOWDROPDOWN    è®©ç»„åˆæ¡†çš„ä¸‹æ‹‰åˆ—è¡¨ä¸‹æ‹‰ï¼Œå³æ˜¾å‡ºæ‰€æœ‰æ¡ç›®ã€‚\n\nç¼–è¾‘æ¡†\nEM_CANUNDO             å†³å®šä¸Šä¸€æ¬¡æ“ä½œæ˜¯å¦å¯ä»¥ undoï¼ˆæ’¤æ¶ˆæ“ä½œï¼‰ã€‚å¦‚æœå¯ä»¥ï¼Œåˆ™å¯å‘é€ EM_UNDO æ¶ˆæ¯EM_GETFIRSTVISIBLELINE åœ¨å¤šè¡Œæ§ä»¶ä¸­ï¼Œæ‰¾åˆ°æœ€ä¸Šå±‚çš„å¯è§çš„è¡Œå·ã€‚æ­¤è¡Œå·æ˜¯ç›¸å¯¹äºæ‰€æœ‰è¡Œçš„ã€‚EM_GETPASSWORDCHAR     è¿”å›å¯†ç æ¡†çš„å­—ç¬¦é›†ï¼Œå³æŸ¥çœ‹å¯†ç ã€‚  EM_GETSELè¿”å›åœ¨å¯ç¼–è¾‘æ§ä»¶ä¸­ï¼Œè¢«é€‰æ‹©ï¼ˆé«˜äº®é€‰æ‹©ï¼‰çš„å­—ç¬¦é›†çš„èµ·ç‚¹å’Œç»ˆç‚¹çš„ä½ç½®ï¼Œç”¨ SendMessage çš„ wParamå‚æ•°è¿”å›èµ·ç‚¹ä½ç½®ï¼ŒlParam è¿”å›ç»ˆç‚¹ä½ç½®  EM_REPLACESELç”¨ä¸åŒçš„å­—ç¬¦ä¸²æ›¿æ¢å¯ç¼–è¾‘æ§ä»¶ä¸­çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¯ç¼–è¾‘æ§ä»¶ä¸­æ²¡æœ‰å­—ç¬¦ä¸²ï¼Œåˆ™æ­¤æ¶ˆæ¯å˜ä¸ºæ·»åŠ å­—ç¬¦ä¸²ã€‚å¦‚æœ wParam ä¸ºTRUEï¼Œåˆ™æœ¬æ¬¡æ“ä½œå…è®¸æ’¤æ¶ˆï¼ŒFALSE ç¦æ­¢æ’¤æ¶ˆã€‚  EM_SETPASSWORDCHAR     åœ¨å¯ç¼–è¾‘æ§ä»¶ä¸­è®¾ç½®å¯†ç å­—ç¬¦é›†ï¼Œå³ç”¨ *ä»£æ›¿  EM_UNDO                å‘é€æ“ä½œæ’¤æ¶ˆæ¶ˆæ¯ã€‚    EM_GETLINEè·å–ç¼–è¾‘æ§ä»¶ä¸­è¾“å…¥çš„æ–‡å­—ã€‚ EM_LINEFROMCHAR        æ£€ç´¢æŒ‡å®šå­—ç¬¦ç´¢å¼•ï¼ˆç´¢å¼•ç¼–å·ä»ç¼–è¾‘æ¡†çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ï¼‰æ‰€åœ¨çš„è¡Œç´¢å¼•EM_LINEINDEX           åœ¨å¤šè¡Œç¼–è¾‘æ§ä»¶ä¸­ï¼Œæ£€ç´¢æŸè¡Œé¦–å­—ç¬¦åœ¨ç¼–è¾‘æ§ä»¶ä¸­çš„ç´¢å¼• EM_ERRSPACEç¼–è¾‘æ§ä»¶ä¸èƒ½åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥æ»¡è¶³ç‰¹å®šçš„è¦æ±‚ã€‚                       ç¼–è¾‘æ§ä»¶çš„çˆ¶çª—å£é€šè¿‡ WM_COMMAND æ¶ˆæ¯æ”¶åˆ°æ­¤æ¶ˆæ¯ã€‚ EM_LIMITTEXT           è®¾ç½®ç¼–è¾‘æ¡†ç”¨æˆ·å¯è¾“å…¥çš„æœ€å¤§å­—ç¬¦æ•°ã€‚wParam ä¸ºå­—ç¬¦æ•°ï¼ŒlParam ä¸ä½¿ç”¨(0L)\n\nIP åœ°å€æ§ä»¶\nIPM_CLEARADDRESS       æ¸…é™¤ IP åœ°å€æ§ä»¶ï¼ˆIP Address controlï¼‰çš„å†…å®¹IPM_GETADDRESS         ä» IP åœ°å€æ§ä»¶è·å¾—å­˜å‚¨åœ¨å®ƒä¸­çš„ IP åœ°å€ä¿¡æ¯ IPM_ISBLANKå†³å®š IP åœ°å€æ§ä»¶æ˜¯å¦å¯ä»¥ä¸ºç©ºå€¼ã€‚å³ 127.0.0.1 ä¹‹ç±»çš„åœ°å€ä¸ºç©º  IPM_SETADDRESS         åœ¨ IPåœ°å€æ§ä»¶ä¸­è®¾ç½® IP åœ°å€     IPM_SETFOCUS           åœ¨ IP åœ°å€æ§ä»¶ä¸­ï¼Œå½“éœ€è¦è¾“å…¥ IP åœ°å€æ—¶ï¼Œä½¿ä¹‹è·å¾—é”®ç›˜è¾“å…¥ç„¦ç‚¹  IPM_SETRANGE           è®¾ç½®è¾“å…¥ IP åœ°å€çš„æœ‰æ•ˆèŒƒå›´\n\nMCIï¼ˆMedia Control Interface)\nMM_MCINOTIFY           è¯¥ MM_MCINOTIFY æ¶ˆæ¯é€šçŸ¥åº”ç”¨ç¨‹åºï¼Œä¸€ä¸ª MCI è®¾å¤‡å·²å®Œæˆæ“ä½œã€‚åªæœ‰è®¾ç½®äº†MCI_NOTIFY æ ‡å¿—æ—¶ï¼ŒMCI è®¾å¤‡æ‰å‘é€æ­¤æ¶ˆæ¯ã€‚\n\nèœå•\nWM_COMMAND     å½“ç”¨æˆ·é€‰æ‹©èœå•ä¸­çš„é¡¹ç›®å,å°†å‘çª—ä½“å‘é€æ­¤æ¶ˆæ¯. çª—ä½“æ”¶åˆ°æ­¤æ¶ˆæ¯å,å†å†³å®šä¸‹ä¸€ä¸ªè¡Œä¸ºã€‚ WM_INITMENUå½“èœå•å‡†å¤‡æ˜¾ç¤ºå‰,å‘çª—ä½“å‘é€æ­¤æ¶ˆæ¯, çª—ä½“å°†åˆå§‹åŒ–èœå•é¡¹ã€‚  WM_SYSCOMMAND  å‘çª—ä½“å‘é€ç”¨æˆ·ç‚¹å‡»ç³»ç»Ÿèœå•æ¶ˆæ¯.çª—ä½“å°†å“åº”è¿™ä¸ªæ¶ˆæ¯ ,å†³å®šä¸‹ä¸ªè¡Œä¸ºã€‚\n\nåˆ—è¡¨æ¡†\nLB_ADDSTRING        åœ¨æ¡ç›®ä¸­æ·»åŠ å­—ç¬¦ä¸²  LB_DELETESTRING     åˆ é™¤ä¸€ä¸ªæ¡ç›®. æ¡ç›®åºå·æ˜¯ä» 0å¼€å§‹çš„.  LB_GETCOUNT         å¾—åˆ°æ¡ç›®æ€»æ•°.  LB_GETCURSEL        å¾—åˆ°å•é€‰çš„åˆ—è¡¨æ¡†é€‰é¡¹æ¡ç›®çš„åºå·LB_GETSEL           åˆ¤æ–­åˆ—è¡¨æ¡†çš„æ¡ç›®æ˜¯å¦è¢«é€‰ä¸Š, å¦‚æœé€‰ä¸Šäº†,åˆ™è¿”å› &gt;0 çš„å€¼ã€‚å¦åˆ™è¿”å› 0 ,è¡¨ç¤ºç”¨æˆ·æ²¡é€‰æ‹©æ¡ç›®LB_GETSELCOUNT      è·å¾—å¯å¤šé€‰çš„åˆ—è¡¨æ¡†ä¸­è¢«é€‰æ‹©çš„æ¡ç›®æ•°  LB_GETSELITEMSè¿”å›å¯å¤šé€‰çš„åˆ—è¡¨æ¡†ä¸­è¢«é€‰æ¡ç›®çš„åºå·ï¼Œå¯è¿”å›æ•°ç»„ LB_GETTEXT          å¾—åˆ°åˆ—è¡¨æ¡†ä¸­çš„ä¸€ä¸ªæ¡ç›®çš„æ–‡æœ¬LB_GETTEXTLEN       å¾—åˆ°åˆ—è¡¨æ¡†ä¸­çš„ä¸€ä¸ªæ¡ç›®çš„æ–‡æœ¬çš„é•¿åº¦  LB_INSERTSTRINGåœ¨åˆ—è¡¨æ¡†ä¸­æ’å…¥ä¸€ä¸ªæ¡ç›®ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›æ’å…¥åæ­¤æ¡ç›®çš„åºå·ã€‚  LB_SETCURSELå¯¹å•é€‰çš„åˆ—è¡¨æ¡†ï¼Œè®¾å®šç”¨æˆ·é€‰æ‹©æ¡ç›®çš„å…·ä½“å€¼  LB_SETSEL           å¯¹å¤šé€‰çš„åˆ—è¡¨æ¡†ï¼Œè®¾å®šç”¨æˆ·é€‰æ‹©æ¡ç›®çš„å…·ä½“å€¼LB_RESETCONTENT     ä»åˆ—è¡¨æ¡†åˆ é™¤æ‰€æœ‰é¡¹ç›®ï¼ŒwParam å’Œ lParam å‚æ•°å‡ä¸ä½¿ç”¨ï¼ˆä¸º 0ï¼‰LB_SETHORIZONTALEXTENTè®¾å®šåˆ—è¡¨æ¡†æ°´å¹³æ»šåŠ¨èŒƒå›´ã€‚å¦‚æœåˆ—è¡¨æ¡†å®½åº¦å°äºæ­¤å€¼ï¼Œåˆ™æ°´å¹³æ»šåŠ¨æ¡æ˜¾ç°ï¼›å¦‚æœåˆ—è¡¨æ¡†å®½åº¦å¤§äºç­‰äºæ­¤å€¼ï¼Œåˆ™æ°´å¹³æ»šåŠ¨æ¡æ˜¯éšè—çš„ã€‚wParamä¸ºæ‰€è®¾çš„æ°´å¹³æ»šåŠ¨èŒƒå›´ï¼ˆåƒç´ ï¼‰ï¼ŒlParam ä¸ä½¿ç”¨ï¼Œä¸º 0ã€‚æ²¡æœ‰è¿”å›å€¼ æ³¨æ„ï¼šLB_SETHORIZONTALEXTENTæ¶ˆæ¯è¦èµ·ä½œç”¨ï¼Œåˆ—è¡¨æ¡†å¿…é¡»å®šä¹‰ WS_HSCROLL æ ·å¼ LB_SETTABSTOPSåœ¨åˆ—è¡¨æ¡†ä¸­è®¾ç½®åˆ¶è¡¨ä½ä½ç½®ï¼ˆå³æ¯åˆ—é—´è·ï¼‰ä¸ºäº†åº”å¯¹ LB_SETTABSTOPS æ¶ˆæ¯ï¼Œåˆ—è¡¨æ¡†å¿…é¡»å·²ç»æ‹¥æœ‰ LBS_USETABSTOPSæ ·å¼ã€‚ wParam æŒ‡å®šåˆ¶è¡¨ä½æ•°é‡ï¼ŒlParam ä¸ºåˆ¶è¡¨ä½æ•´æ•°æ•°ç»„ï¼ˆå„åˆ—ä¹‹é—´é—´éš”ï¼Œä¸å¿…ç›¸ç­‰ï¼‰å¦‚æœ wParam æ˜¯ 0ï¼ŒlParam ä¸ºNULLï¼Œé»˜è®¤åˆ¶è¡¨ä½æ˜¯ 2 ä¸ªå¯¹è¯æ¡†æ¨¡æ¿å•ä½ã€‚å¦‚æœ wParam æ˜¯ 1ï¼Œåˆ¶è¡¨ä½ä¸º lParam æŒ‡å®šçš„è·ç¦»ã€‚å¦‚æœè¶…è¿‡ 1ï¼Œåˆ¶è¡¨ä½å°†è¢«è®¾ç½®ä¸ºlParam ä¸­çš„æ¯ä¸ªå€¼ï¼ˆwParam æŒ‡å®šæ•°é‡ï¼‰\n\né¼ æ ‡\nWM_LBUTTONDBLCLK  å½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡å·¦é”®å·²åŒå‡»ï¼Œè¿”å›å€¼ 0  WM_LBUTTONDOWNå½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡å·¦é”®å·²ç‚¹å‡»ï¼Œè¿”å›å€¼ 0  WM_LBUTTONUPå½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡å·¦é”®å·²é‡Šæ”¾ï¼Œè¿”å›å€¼ 0   WM_MBUTTONDBLCLKå½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡ä¸­é”®å·²åŒå‡»ï¼Œè¿”å›å€¼ 0  WM_MBUTTONDOWNå½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡ä¸­é”®å·²ç‚¹å‡»ï¼Œè¿”å›å€¼ 0  WM_MBUTTONUPå½“é¼ æ ‡åœ¨ä¸€ä¸ªçª—ä½“èŒƒå›´å†…æ—¶ï¼Œå‘Šè¯‰æ­¤çª—ä½“é¼ æ ‡ä¸­é”®å·²é‡Šæ”¾ï¼Œè¿”å›å€¼ 0\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬16èŠ‚-MFCä¹‹SendMessageå’ŒPostMessage","date":"2017-11-04T15:33:16.000Z","categories_index":"","tags_index":"","author_index":"é˜¿æœ¨å¤§å”"},{"id":"4cba1917e258f58a831088a0ecbb4f93","title":"ç¬¬15èŠ‚ MFCä¹‹å¤é€‰æ¡†åŠå•é€‰æŒ‰é’®","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬15èŠ‚ MFCä¹‹å¤é€‰æ¡†åŠå•é€‰æŒ‰é’®1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday17â€ï¼Œå¸ƒå±€å¦‚ä¸‹ï¼Œè‡ªè¡Œå¤„ç†ï¼š\næ‹–åŠ¨ä¸‰ä¸ªcheck boxå’Œä¸¤ä¸ªradio buttonåˆ°ç•Œé¢ä¸Šï¼Œè®¾ç½®å…¶IDå¦‚ä¸‹ï¼š\n\n\n\næ§ä»¶å\næ§ä»¶ID\n\n\n\nçº¢è‰²\nIDC_CHECK_RED\n\n\nç»¿è‰²\nIDC_CHECK_GREEN\n\n\nè“è‰²\nIDC_CHECK_BLUE\n\n\nçŸ©å½¢\nIDC_RADIO_SQURAE\n\n\nåœ†å½¢\nIDC_RADIO_CIRC\n\n\næ‰§è¡Œâ€œå·¥å…·â€-&gt;â€œtabé”®ä½ç½®â€ï¼Œç¡®ä¿ä¸¤ä¸ªradio buttonçš„é¡ºåºæ˜¯è¿ç»­çš„ï¼Œå¦‚ä¸‹å›¾ï¼š\n\n\n\n\n\n\n\n\n\n\n\næŒ‡å®šç¬¬ä¸€ä¸ªradio buttonï¼ˆçŸ©å½¢ï¼‰çš„Groupçš„å€¼ä¸ºtrueï¼Œå¦‚å›¾:\n2. æ·»åŠ å…³è”å˜é‡æ·»åŠ äº”ä¸ªæ§ä»¶çš„å˜é‡ï¼Œå¦‚å›¾ï¼š\n12345DDX_Control(pDX, IDC_CHECK_RED, m_chk_red);DDX_Control(pDX, IDC_CHECK_GREEN, m_chk_green);DDX_Control(pDX, IDC_CHECK_BLUE, m_chk_blue);DDX_Control(pDX, IDC_RADIO_SQURAE, m_rd_squ);DDX_Control(pDX, IDC_RADIO_CIRC, m_rd_circ);\nåˆ†åˆ«æ·»åŠ å¦‚ä¸Šå˜é‡ï¼›\n3. å¼€å§‹å†™ä»£ç å§ç°åœ¨æˆ‘ä»¬æ¥è®©ç¨‹åºè¿è¡Œèµ·æ¥æ—¶é»˜è®¤é€‰ä¸­åœ†å½¢ï¼›åˆ‡æ¢åˆ°è§£å†³æ–¹æ¡ˆè§†å›¾ï¼Œè¿›å…¥BOOL Cday17Dlg::OnInitDialog()æ–¹æ³•ï¼šåœ¨æœ«å°¾returnå‰åŠ å…¥è¿™ä¸€è¡Œï¼š\n1234// TODO: åœ¨æ­¤æ·»åŠ é¢å¤–çš„åˆå§‹åŒ–ä»£ç CheckRadioButton(IDC_RADIO_SQURAE,IDC_RADIO_CIRC,IDC_RADIO_CIRC);return TRUE;  // é™¤éå°†ç„¦ç‚¹è®¾ç½®åˆ°æ§ä»¶ï¼Œå¦åˆ™è¿”å› TRUE\nä»£ç è§£é‡Šï¼š\n\nåœ¨IDC_RADIO_SQURAEå’ŒIDC_RADIO_CIRCä¹‹é—´é€‰ä¸­IDC_RADIO_CIRC\n\næ·»åŠ äº”ä¸ªæ§ä»¶çš„äº‹ä»¶å¤„ç†æ–¹æ³•å¦‚å›¾æ‰€ç¤ºï¼šå‰©ä¸‹å››ä¸ªéƒ½å¦‚ä¸Šæ·»åŠ å¥½ï¼›ç¼–è¾‘â€œè“è‰²â€æŒ‰é’®çš„ç‚¹å‡»æ–¹æ³•ï¼š\n12345void Cday17Dlg::OnBnClickedCheckBlue()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tInvalidate();&#125;\nä»£ç è§£é‡Šï¼š\n\nInvalidate()è®©å¯¹è¯æ¡†é‡æ±‡å¯¹è¯æ¡†ï¼›\n\næ·»åŠ æ“¦é™¤èƒŒæ™¯æ¶ˆæ¯ï¼ˆOnEraseBkgndï¼‰äº‹ä»¶å¦‚å›¾æ·»åŠ OnEraseBkgndæ¶ˆæ¯å¤„ç†å‡½æ•°ï¼šç¼–è¾‘OnEraseBkgndå‡½æ•°ï¼š\n12345678910111213141516171819202122232425BOOL Cday17Dlg::OnEraseBkgnd(CDC* pDC)&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ¶ˆæ¯å¤„ç†ç¨‹åºä»£ç å’Œ/æˆ–è°ƒç”¨é»˜è®¤å€¼\tBOOL bRet = CDialogEx::OnEraseBkgnd(pDC);\tint nRed,nGreen,nBlue;\tnRed = m_chk_red.GetCheck() ? 255 : 0;\tnGreen = m_chk_green.GetCheck() ? 255 : 0;\tnBlue = m_chk_blue.GetCheck() ? 255 : 0;\tCOLORREF crFore = RGB(nRed,nGreen,nBlue);\tCBrush brush;\tbrush.CreateSolidBrush(crFore);\tCBrush *pOldBrush = pDC-&gt;SelectObject(&amp;brush);\tRECT rc = &#123;100, 40, 400, 340&#125;;\tif (m_rd_squ.GetCheck())\t&#123;\t\tpDC-&gt;Rectangle(&amp;rc);\t&#125;\telse&#123;\t\tpDC-&gt;Ellipse(&amp;rc);\t&#125;\tpDC-&gt;SelectObject(pOldBrush);\treturn bRet;&#125;\nä»£ç è§£é‡Šï¼š\n\n\næ ¹æ®é¢œè‰²æŒ‰é’®çš„é€‰æ‹©çŠ¶æ€æ¥é€‰æ‹©é¢œè‰²ä¸º255è¿˜æ˜¯0ï¼›\nç”¨ä¸‰ä¸ªçš„é¢œè‰²æ¥åˆ›å»ºä¸€ä¸ªç”»åˆ·ï¼›\nä¿ç•™æ—§çš„ç”»åˆ·ï¼›\nåˆ›å»ºRECT å¯¹è±¡ï¼Œå³åœ†å½¢çš„å¤§å°ï¼›\næ ¹æ®å½¢çŠ¶çš„radio buttonæ¥é€‰æ‹©åŒ–åœ†å½¢è¿˜æ˜¯çŸ©å½¢ï¼›\nè¿˜åŸæ—§çš„ç”»åˆ·ï¼›\n\n\nå®ç°å…¶ä»–æŒ‰é’®å…¶ä»–æŒ‰é’®å°±åªç”¨è°ƒç”¨OnBnClickedCheckBlue()å°±å¯ä»¥äº†ï¼›\næœ€ç»ˆæ•ˆæœå›¾ï¼š\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬15èŠ‚-MFCä¹‹å¤é€‰æ¡†åŠå•é€‰æŒ‰é’®","date":"2017-11-02T15:00:09.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"236b306ed30598f9de558dada84c87a9","title":"ç¬¬14èŠ‚ MFCä¹‹æ–‡ä»¶å¯¹è¯æ¡†CFileDialog","content":"ç¬¬14èŠ‚ MFCä¹‹æ–‡ä»¶å¯¹è¯æ¡†CFileDialog\nä»Šå¤©æˆ‘ä»¬å­¦ä¹ ä¸¤ä¸ªæ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†ã€ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†ï¼Œåº”ç”¨ç¨‹åºéš¾å…éœ€è¦åŠ è½½æ–‡ä»¶ï¼Œæˆ–è€…æ‰“å¼€é…ç½®æ–‡ä»¶ç­‰ï¼Œè¿™å°±ç”¨åˆ°æ‰“å¼€æˆ–è€…ä¿å­˜å¯¹è¯æ¡†ï¼Œä¾‹å¦‚windowsæ–‡æœ¬ç¼–è¾‘å™¨ä¸­ä¿å­˜å¯¹è¯æ¡†å°±å±äºå…¶ä¸­ä¸€ç§ï¼š\n\n1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday16â€ï¼Œå¸ƒå±€å¦‚ä¸‹ï¼Œè‡ªè¡Œå¤„ç†ï¼šæ‹–åŠ¨ä¸€ä¸ªEDITåˆ°ç•Œé¢ï¼Œå¹¶ä¿®æ”¹å¦‚ä¸‹å±æ€§ï¼š\n\n\n\nå±æ€§\nä¿®æ”¹å€¼\nè§£é‡Š\n\n\n\nID\nIDC_EDIT_TXT\næ§ä»¶ID\n\n\nWant Return\nTRUE\nå…è®¸å›è½¦\n\n\nMultiline\nTRUE\nå…è®¸å¤šè¡Œ\n\n\nHorizontal Scoll\nTRUE\næ°´å¹³æ»šåŠ¨æ¡\n\n\nVertical Scoll\nTRUE\nå‚ç›´æ»šåŠ¨æ¡\n\n\n2. æ·»åŠ èœå•èµ„æºåˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œæ·»åŠ èœå•èµ„æºå¦‚ä¸‹ï¼šè‹¥ä¸çŸ¥é“æ€ä¹ˆæ·»åŠ èœå•è¯·å‚è€ƒ**Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬10èŠ‚ MFCèœå• **\n\næ³¨æ„ï¼šèœå•é€‰é¡¹æœ€ååŠ ä¸Š&amp;ç¬¦å·å¯ä»¥è®¾ç½®å¿«æ·é”®ï¼Œå¦‚â€œæ–‡ä»¶(&amp;F)â€ï¼Œå½“ç¨‹åºè¿è¡Œæ—¶å¯ä»¥é€šè¿‡ALT + Få¿«æ·æ‰“å¼€æ–‡ä»¶èœå•é€‰é¡¹ï¼›\n\nå°†èœå•ç»‘å®šåˆ°ä¸»ç•Œé¢ï¼š\n3. å®ç°æ–‡ä»¶æ‰“å¼€å¯¹è¯æ¡†å³å‡»èœå•ä¸­â€œæ‰“å¼€â€é€‰é¡¹ï¼Œé€‰æ‹©â€œæ·»åŠ äº‹ä»¶å¤„ç†å¤„ç†ç¨‹åºâ€ï¼Œæ·»åŠ å¤„ç†ç¨‹åºï¼Œå¦‚å›¾ï¼šå…¶ä¸­è¡Œæ•°å¤„ç†ç¨‹åºåç§°ï¼šOnFileOpenï¼Œç±»åˆ—è¡¨é€‰æ‹©ï¼šCday16Dlgï¼Œæ·»åŠ ç¼–è¾‘ï¼šå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728void Cday16Dlg::OnFileOpen()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ å‘½ä»¤å¤„ç†ç¨‹åºä»£ç \tCFileDialog dlg(TRUE,NULL,NULL,OFN_FILEMUSTEXIST|OFN_PATHMUSTEXIST,_T(&quot;æ–‡æœ¬æ–‡ä»¶(*.txt)|*.txt|æ‰€æœ‰æ–‡ä»¶(*.*)|*.*||&quot;),this);\tdlg.m_ofn.lpstrInitialDir = _T(&quot;C:\\\\&quot;);\tif (dlg.DoModal()  == IDOK)\t&#123;\t\tCStdioFile inFile;\t\tinFile.Open(dlg.GetPathName(),CFile::modeRead);\t\tCString text;\t\tCString temp;\t\twhile(inFile.ReadString(text))\t\t&#123;    \t\t\tGetDlgItemText(IDC_EDIT_TXT,temp);\t\t\tif (temp.GetLength() &gt; 0)\t\t\t&#123;\t\t\t\tSetDlgItemText(IDC_EDIT_TXT,temp +&quot;\\r\\n&quot;+ text);\t\t\t&#125;\t\t\telse\t\t\t&#123;\t\t\t\tSetDlgItemText(IDC_EDIT_TXT,text);\t\t\t&#125;\t\t\t\t\t&#125;\t\tinFile.Close();\t&#125;&#125;\nä»£ç è§£é‡Šï¼š\n\n\nåˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶å¯¹è¯æ¡†ï¼›\nå¦‚æ–‡ä»¶å¯¹è¯æ¡†ç¡®å®šæŒ‰é’®è¢«ç‚¹å‡»ï¼Œåˆ™æ‰“å¼€æ–‡ä»¶ä½ç½®ï¼Œæ–‡ä»¶å…¨è·¯å¾„å°±æ˜¯dlg.GetPathName()ï¼›\nå¾ªç¯è¯»å–æ–‡ä»¶ï¼ŒçŸ¥é“æ–‡ä»¶è¯»å–ç»“æŸï¼›æ¯è¯»ä¸€è¡Œå°±å…ˆè·å–ç•Œé¢æ–‡æœ¬æ¡†çš„å†…å®¹åŠ ä¸Šæ–°è¯»å–çš„æ–‡æœ¬ï¼Œé‡æ–°è®¾ç½®åˆ°ç•Œé¢ï¼›\nå…³é—­æ–‡ä»¶\n\n\nè¿™æ ·ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†å°±å®Œæˆäº†ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n3. å®ç°æ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†å³å‡»èœå•ä¸­â€œä¿å­˜â€é€‰é¡¹ï¼Œé€‰æ‹©â€œæ·»åŠ äº‹ä»¶å¤„ç†å¤„ç†ç¨‹åºâ€ï¼Œæ·»åŠ å¤„ç†ç¨‹åºï¼Œå¦‚å›¾ï¼šåç§°ï¼šOnSaveFileï¼Œç±»åˆ—è¡¨é€‰æ‹©ï¼šCday16Dlgï¼Œæ·»åŠ ç¼–è¾‘ï¼šå‡½æ•°ä»£ç å¦‚ä¸‹\n12345678910111213141516171819202122void Cday16Dlg::OnSaveFile()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ å‘½ä»¤å¤„ç†ç¨‹åºä»£ç \tCFileDialog dlg(FALSE,NULL,NULL,OFN_HIDEREADONLY |OFN_OVERWRITEPROMPT | OFN_PATHMUSTEXIST,_T(&quot;æ–‡æœ¬æ–‡ä»¶(*.txt)|*.txt||&quot;),this);\tif (dlg.DoModal()  == IDOK)\t&#123;\t\tCFile file;  //å»ºç«‹ä¸€ä¸ªCFileå¯¹è±¡\t\t//æ‰“å¼€æ–‡ä»¶,å¦‚æœä¸å­˜åœ¨è¯¥æ–‡ä»¶å°±åˆ›å»ºæ–‡ä»¶\t\tif(!file.Open(dlg.GetPathName(),CFile::modeCreate|CFile::modeWrite))\t\t&#123;\t\t\tAfxMessageBox( &quot;can   not   Create   file! &quot;);\t\t\treturn;\t\t&#125; \t\tCString output;\t\tGetDlgItemText(IDC_EDIT_TXT,output);\t\tfile.Write(output,strlen(output));\t\tfile.Flush();    //å°†åœ¨ç¼“å†²åŒºä¸­çš„å­—ç¬¦å†™å…¥æ–‡ä»¶ä¸­\t\tfile.Close();   //å…³é—­æ–‡ä»¶\t\tAfxMessageBox( &quot;ä¿å­˜æˆåŠŸï¼&quot;);\t&#125;&#125;\nä»£ç è§£é‡Šï¼š\n\n\nåˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†ï¼›\nå¦‚æ–‡ä»¶å¯¹è¯æ¡†ç¡®å®šæŒ‰é’®è¢«ç‚¹å‡»ï¼Œåˆ™è·å–æ–‡ä»¶ä½ç½®ï¼Œæ–‡ä»¶å…¨è·¯å¾„å°±æ˜¯dlg.GetPathName()ï¼›\nå…ˆè·å–ç•Œé¢æ–‡æœ¬æ¡†çš„å†…å®¹ï¼Œå°†å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­ï¼›\nå…³é—­æ–‡ä»¶æ•ˆæœå›¾ï¼š\n\n\nå¥½äº†ï¼Œè¿™èŠ‚æˆ‘ä»¬æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºæ–‡ä»¶æ‰“å¼€å’Œä¿å­˜å¯¹è¯æ¡†ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ä½œç”¨ï¼Œä»Šå¤©å°±åˆ°è¿™äº†ã€‚é¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬14èŠ‚-MFCä¹‹æ–‡ä»¶å¯¹è¯æ¡†CFileDialog","date":"2017-11-01T13:49:20.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"33b07364cfa133acbebe1120a6b4e2ef","title":"ç¬¬13èŠ‚ MFCä¹‹å›¾ç‰‡æ§ä»¶","content":"ç¬¬13èŠ‚ MFCä¹‹å›¾ç‰‡æ§ä»¶è¿™èŠ‚å­¦ä¹ ä¸¤ä¸ªæ§ä»¶ï¼š\n\nå›¾ç‰‡æ§ä»¶ï¼š  Picture Control\n\n1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday15â€ï¼Œå¸ƒå±€å¦‚ä¸‹ï¼Œè‡ªè¡Œå¤„ç†ï¼šæ‹–åŠ¨ä¸€ä¸ªPicture Controlæ§ä»¶åˆ°ç•Œé¢ï¼Œå…¶å®Picture Controlå°±æ˜¯CStatic ç±»ï¼›\nè®¾ç½®Picture Controlçš„å¦‚ä¸‹å±æ€§ï¼š\n\n\n\nå±æ€§\nä¿®æ”¹å€¼\nè§£é‡Š\n\n\n\nID\nIDC_STATIC_IMG\næ§ä»¶ID\n\n\nType\nBitmap\nè®¾ç½®ç±»å‹ä¸ºbitmapä½å›¾ç±»å‹\n\n\nå¦‚å›¾ï¼š\n\n\n\n\n2.æ·»åŠ Bitmap ä½å›¾èµ„æºè‡ªè¡Œä¸‹è½½å‡ å¼ .bmpä½å›¾ï¼Œæ‹·è´åˆ°é¡¹ç›®çš„resæ–‡ä»¶ä¸‹ï¼Œç„¶ååˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œæ·»åŠ Bitmap èµ„æºï¼Œå¦‚å›¾æ‰€ç¤ºï¼šä¸Šä¼ å®Œæˆä¹‹åå¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸‰ä¸ªBitmap ä½å›¾çš„IDï¼›\n3.æ˜¾ç¤ºå‡ºä½å›¾èµ„æºå•å‡»Picture Controlæ§ä»¶ï¼Œåœ¨å±æ€§ä¸­æ‰¾åˆ°Imageå±æ€§ï¼Œåœ¨ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©æˆ‘ä»¬åˆšæ‰æ·»åŠ çš„ä½å›¾IDå°±å¯ä»¥æˆåŠŸæ˜¾ç¤ºå›¾ç‰‡äº†ï¼Œå¦‚å›¾ï¼š\n4.åŠ¨æ€æ§åˆ¶æ˜¾ç¤ºå›¾ç‰‡åœ¨ç•Œé¢ä¸Šæ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œæˆ‘ä¹ˆé€šè¿‡æŒ‰é’®æ¥åˆ‡æ¢ç•Œé¢å›¾ç‰‡æ˜¾ç¤ºï¼šæ¥ä¸‹æ¥æˆ‘ä»¬æ·»åŠ Picture Controlæ§ä»¶çš„å˜é‡m_imageï¼Œå¦‚å›¾:æˆ‘ä»¬æ¥ç¼–è¾‘â€œåˆ‡æ¢æŒ‰é’®â€çš„ç‚¹å‡»æ–¹æ³•ï¼š\n123456void Cday15Dlg::OnBnClickedButtonChange()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tHBITMAP phBmp = (HBITMAP)LoadImage(NULL,_T(&quot;.\\\\res\\\\20171031100114614.bmp&quot;),IMAGE_BITMAP,0,0,LR_LOADFROMFILE);\tm_image.SetBitmap(phBmp);&#125;\nä»£ç è§£é‡Šï¼š\n\n\nè·å–ä¸€ä¸ªä½å›¾çš„å¥æŸ„2.å°†å…¶è®¾ç½®åˆ°Picture Controlæ§ä»¶\n\n\næ•ˆæœå›¾ï¼š\n5.é…åˆCFileDialog ç±»æ¥é€‰æ‹©æ˜¾ç¤ºå›¾ç‰‡æˆ‘ä»¬æ¥ç¼–è¾‘â€œåˆ‡æ¢æŒ‰é’®â€çš„ç‚¹å‡»æ–¹æ³•ï¼š\n12345678910void Cday15Dlg::OnBnClickedButtonChange()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tCFileDialog dlg(TRUE,NULL,NULL,OFN_FILEMUSTEXIST,_T(&quot;*.bmp|*.bmp&quot;),this);\tif (dlg.DoModal() == IDOK)\t&#123;\t\tHBITMAP phBmp = (HBITMAP)LoadImage(NULL,dlg.GetPathName(),IMAGE_BITMAP,0,0,LR_LOADFROMFILE);\t\tm_image.SetBitmap(phBmp);\t&#125;&#125;\nä»£ç è§£é‡Šï¼š\n\n\nåˆ›å»ºä¸€ä¸ª.bmpç±»å‹çš„æ–‡ä»¶æ‰“å¼€å¯¹è¯æ¡†\nè‹¥ç‚¹å‡»ç¡®å®šæŒ‰é’®ï¼Œåˆ™å°†é€‰æ‹©çš„.bmpæ–‡ä»¶æ˜¾ç¤ºå‡ºæ¥ï¼›\n\n\næ•ˆæœå›¾ï¼š\né™„Picture Controlæ§ä»¶å¸¸è§å±æ€§åŠæ–¹æ³•ï¼š\nä¸€ã€å›¾ç‰‡æ§ä»¶å±æ€§\nPicture Control å±æ€§: Type:Frame &#x2F;&#x2F;æ¡†æ¶ Type:Etched Horzæ°´å¹³èš€åˆ»çº¿æ¡ Type:EtchedVertå‚çœŸèš€åˆ»çº¿æ¡ Type:Rectangleå®å¿ƒçŸ©å½¢ Type:Bitmapä½å›¾ Type:Icon  å›¾æ ‡Type:Enhanced Metafile å¢å¼ºå›¾å…ƒ æ”¯æŒwmfæ ¼å¼å›¾ç‰‡ Type:Owner Draw   è‡ªç»˜å›¾ Color:é¢œè‰²    Black:é»‘    Gray:ç°è‰²    White:ç™½è‰²    Etched:èš€åˆ»\n\näºŒã€Picture Control æ§ä»¶ç±»\nCStatic:: SetBitmap Specifies a bitmap to be displayed in the staticcontrol. GetBitmap Retrieves the handle of the bitmap previously setwith SetBitmap.\nSetIcon Specifies an icon to be displayed in the static control.GetIcon Retrieves the handle of the icon previously set with SetIcon.\nSetCursor Specifies a cursor image to be displayed in the staticcontrol. GetCursor Retrieves the handle of the cursor image previouslyset with SetCursor.\nSetEnhMetaFile Specifies an enhanced metafile to be displayed in thestatic control. GetEnhMetaFile Retrieves the handle of the enhancedmetafile previously set with SetEnhMetaFile\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬13èŠ‚-MFCä¹‹å›¾ç‰‡æ§ä»¶","date":"2017-10-31T14:37:27.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"38d440139df1f611dc7be067d5f7cb2f","title":"ç¬¬12èŠ‚ MFCä¹‹æ ‘æ§ä»¶CTreeCtrl","content":"\næ ‘å½¢æ§ä»¶ï¼ˆTree Controlï¼‰ï¼šç”¨æ¥æ˜¾ç¤ºä¸€ç³»åˆ—é¡¹ç›®çš„å±‚æ¬¡å…³ç³»ï¼Œæœ€å…¸å‹çš„ä¾‹å­æ˜¯æ˜¾ç¤ºç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸æ–‡ä»¶å¤¹ã€‚å¦‚æœæœ‰å­é¡¹ç›®çš„è¯ï¼Œå•å‡»æ ‘å½¢æ§ä»¶ä¸­çš„é¡¹ç›®å¯ä»¥å±•å¼€æˆ–è€…æ”¶ç¼©å…¶å­é¡¹ç›®ã€‚MFCæä¾›äº†CTreeCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n\næ ‘æ§ä»¶åœ¨windowsç¨‹åºä¸­ä½¿ç”¨ç›¸å¯¹ä¹Ÿæ˜¯æ¯”è¾ƒå¤šçš„æ§ä»¶ï¼Œä¾‹å¦‚windowsèµ„æºç®¡ç†å™¨å·¦è¾¹çš„æµè§ˆè§†å›¾å°±æ˜¯ä¸ªæ ‘æ§ä»¶è§†å›¾ï¼šä»Šå¤©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹ä½¿ç”¨æ ‘æ§ä»¶ï¼Œå®ç°â€œæ·»åŠ èŠ‚ç‚¹â€ã€â€œåˆ é™¤èŠ‚ç‚¹â€ã€â€œä¿®æ”¹èŠ‚ç‚¹â€ï¼›\n1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday14â€ï¼Œå¸ƒå±€å¦‚ä¸‹ï¼Œè‡ªè¡Œå¤„ç†ï¼š\n\n\n\næ§ä»¶å\næ§ä»¶ID\n\n\n\nTree Control\nIDC_TREE_VIEW\n\n\nç¼–è¾‘æ¡†\nIDC_EDIT_ADD_MDY\n\n\næ·»åŠ èŠ‚ç‚¹\nIDC_BUTTON_ADD\n\n\nåˆ é™¤èŠ‚ç‚¹\nIDC_BUTTON_DEL\n\n\nä¿®æ”¹èŠ‚ç‚¹\nIDC_BUTTON_MDY\n\n\n2. è®¾ç½®æ ‘æ§ä»¶å±æ€§ç¼–è¾‘æ ‘æ§ä»¶å¦‚ä¸‹å±æ€§ï¼š\n\n\n\nå±æ€§\nä¿®æ”¹å€¼\nè§£é‡Š\n\n\n\nHas Buttons\nTRUE\nåœ¨çˆ¶èŠ‚ç‚¹æ—è¾¹æ˜¾ç¤º+æˆ–-\n\n\nHas Lines\nTRUE\nåœ¨çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ä¹‹é—´åˆ’çº¿\n\n\nLine At root\nTRUE\nåœ¨æ ¹èŠ‚ç‚¹ä¸Šåˆ’çº¿\n\n\n3. æ·»åŠ æ ‘æ§ä»¶å˜é‡ç»™æ ‘æ§ä»¶æ·»åŠ ä¸€ä¸ªå˜é‡â€œm_treeâ€ï¼Œå¦‚å›¾ï¼š\n4. å®ç°æ·»åŠ èŠ‚ç‚¹æŒ‰é’®å‡½æ•°åŒå‡»â€œæ·»åŠ èŠ‚ç‚¹â€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼š\n123456789101112131415161718192021222324void Cday14Dlg::OnBnClickedButtonAdd()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tCString strText;\tGetDlgItemText(IDC_EDIT_ADD_MDY,strText);\tif (strText.GetLength() == 0)\t&#123;\t\tAfxMessageBox(_T(&quot;è¯·è¾“å…¥èŠ‚ç‚¹åï¼&quot;));\t\treturn;\t&#125;\tHTREEITEM hItem = m_tree.GetSelectedItem();\tif(hItem == NULL)&#123;\t\thItem = TVI_ROOT;\t&#125;\tTVINSERTSTRUCT ts =&#123;0&#125;;\tts.hParent = hItem;\tts.hInsertAfter = TVI_LAST;\tts.item.pszText = strText.GetBuffer();\tts.item.mask = TVIF_TEXT;\tHTREEITEM hNewItem = m_tree.InsertItem(&amp;ts);\tm_tree.SelectItem(hNewItem);\tm_tree.EnsureVisible(hNewItem);&#125;\nä»£ç è§£é‡Šï¼š\n\n\nå…ˆè·å–æ–‡æœ¬æ¡†ä¸­çš„å€¼ï¼Œå¦‚æœå€¼ä¸ºç©ºï¼Œåˆ™æç¤ºç”¨æˆ·è¾“å…¥ï¼›\nè·å–å½“å‰é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œè‹¥ä¸å­˜åœ¨é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™è·å–æ ¹èŠ‚ç‚¹ï¼›\nåˆ›å»ºèŠ‚ç‚¹ç»“æ„ä½“ï¼Œè®¾ç½®å…¶çˆ¶èŠ‚ç‚¹ï¼Œæ’å…¥æ–¹å¼ï¼ŒèŠ‚ç‚¹å†…å®¹ï¼Œå†…å®¹å¯è§ç­‰ï¼›\næ’å…¥æ–°çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”è®¾ç½®èŠ‚ç‚¹ä¿è¯å¯è§ï¼›æ•ˆæœå›¾ï¼š\n\n\n5. å®ç°åˆ é™¤èŠ‚ç‚¹æŒ‰é’®å‡½æ•°åŒå‡»â€œåˆ é™¤èŠ‚ç‚¹â€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼š\n12345678910111213void Cday14Dlg::OnBnClickedButtonDel()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tHTREEITEM hItem = m_tree.GetSelectedItem();\tif(hItem == NULL)&#123;\t\tAfxMessageBox(_T(&quot;è¯·é€‰æ‹©è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼&quot;));\t\treturn;\t&#125;\tHTREEITEM hParentItem = m_tree.GetParentItem(hItem);\tm_tree.DeleteItem(hItem);\tm_tree.SelectItem(hParentItem);&#125;\nä»£ç è§£é‡Šï¼š\n\n\nè·å–é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œè‹¥æ²¡æœ‰é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™æç¤ºç”¨æˆ·ï¼›\nè·å–é€‰ä¸­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹\nåˆ é™¤é€‰ä¸­çš„èŠ‚ç‚¹\nå°†å…¶çˆ¶èŠ‚ç‚¹è®¾ç½®ä¸ºé€‰ä¸­èŠ‚ç‚¹\n\n\nåˆ é™¤å‰ï¼šåˆ é™¤åï¼š\n6. å®ç°ä¿®æ”¹èŠ‚ç‚¹æŒ‰é’®å‡½æ•°åŒå‡»â€œä¿®æ”¹èŠ‚ç‚¹â€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼š\n123456789101112131415161718void Cday14Dlg::OnBnClickedButtonMdy()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tHTREEITEM hItem = m_tree.GetSelectedItem();\tif(hItem == NULL)&#123;\t\tAfxMessageBox(_T(&quot;è¯·é€‰æ‹©è¦ä¿®æ”¹çš„èŠ‚ç‚¹ï¼&quot;));\t\treturn;\t&#125;\tCString strText;\tGetDlgItemText(IDC_EDIT_ADD_MDY,strText);\tif (strText.GetLength() == 0)\t&#123;\t\tAfxMessageBox(_T(&quot;è¯·è¾“å…¥æ–°çš„èŠ‚ç‚¹åï¼&quot;));\t\treturn;\t&#125;\tm_tree.SetItemText(hItem,strText);&#125;\nä»£ç è§£é‡Šï¼š\n\n\nè·å–é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œè‹¥æ²¡æœ‰é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™æç¤ºç”¨æˆ·ï¼›\nå…ˆè·å–æ–‡æœ¬æ¡†ä¸­çš„å€¼ï¼Œå¦‚æœå€¼ä¸ºç©ºï¼Œåˆ™æç¤ºç”¨æˆ·è¾“å…¥ï¼›3.ä¿®æ”¹æ–‡æœ¬å\n\n\n7. æ˜ å°„èŠ‚ç‚¹é€‰æ‹©æ¶ˆæ¯æˆ‘ä»¬æƒ³å®ç°åœ¨ç‚¹å‡»é€‰æ‹©æ§ä»¶æ˜¯ï¼Œä¸‹æ–¹çš„æ–‡æœ¬æ¡†ä¸­è‡ªåŠ¨å‡ºç°é€‰æ‹©èŠ‚ç‚¹çš„æ–‡æœ¬ï¼Œé‚£ä¹ˆå°±è¦æ˜ å°„èŠ‚ç‚¹çš„é€‰æ‹©å˜åŒ–æ¶ˆæ¯ï¼šTVN_SELCHANGEï¼Œå¦‚å›¾æ·»åŠ äº‹ä»¶å¤„ç†å‡½æ•°ï¼šç¼–è¾‘äº‹ä»¶å¤„ç†å‡½æ•°ï¼š\n123456789101112void Cday14Dlg::OnTvnSelchangedTreeView(NMHDR *pNMHDR, LRESULT *pResult)&#123;\tLPNMTREEVIEW pNMTreeView = reinterpret_cast&lt;LPNMTREEVIEW&gt;(pNMHDR);\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tHTREEITEM hItem = m_tree.GetSelectedItem();\tif(hItem != NULL)&#123;\t\tCString strText = m_tree.GetItemText(hItem);\t\tSetDlgItemText(IDC_EDIT_ADD_MDY, strText);\t&#125;\t*pResult = 0;&#125;\nä»£ç è§£é‡Šï¼š\n\n\nè·å–é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™ç•¥è¿‡ï¼Œä¸å¤„ç†ï¼›\nè·å–é€‰ä¸­çš„èŠ‚ç‚¹æ–‡æœ¬ï¼Œå°†æ–‡æœ¬å€¼è®¾ç½®åˆ°æ–‡æœ¬æ¡†ä¸­ï¼›\n\n\næ•ˆæœå›¾ï¼š\nè‡³æ­¤ï¼ŒMFCæ ‘æ§ä»¶çš„ç®€å•ä½¿ç”¨å·²ç»ç»“æŸï¼Œå…¶å®æ ‘æ§ä»¶è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼Œæ¯”å¦‚æ·»åŠ å›¾æ ‡ï¼Œè¿™å°±åˆ°ä»¥åçš„å®è·µä¸­å†æ¥å­¦ä¹ ï¼Œé™„æ ‘æ§ä»¶å¸¸è§å±æ€§åŠæ–¹æ³•ï¼š\n1ã€æ ‘å½¢æ§ä»¶çš„å±æ€§\nTVS_EDITLABELS:å…è®¸ç”¨æˆ·è¿›è¡ŒèŠ‚ç‚¹æ–‡æœ¬çš„ç¼–è¾‘ TVS_HASBUTTONS:èŠ‚ç‚¹å·¦ä¾§æ·»åŠ ä¸€ä¸ªæŒ‰é’®TVS_HASLINES:çˆ¶èŠ‚ç‚¹ä¸å­ç»“ç‚¹å‡ºç°è¿çº¿ TVS_LINESATROOT:å­èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹ä¹‹é—´å‡ºç°è¿çº¿TVS_NOTOOLTIPS:ç»“ç‚¹æ— åŠ¨æ€æç¤º TVS_SINGLEEXPAND:èŠ‚ç‚¹çš„é€‰ä¸­(æœªé€‰ä¸­)t7å±•å¼€(åˆæ‹¢)åŒæ­¥MFCä¸­ä»¥ä¸¤ç§å½¢å¼å°è£…æ ‘å½¢æ§ä»¶ï¼Œä¸€ç§æ˜¯æ ‘å½¢æ§ä»¶CTreeCtrlï¼Œå¦ä¸€ç§æ˜¯æ ‘å½¢è§†å›¾æ§ä»¶CTreeViewã€‚å¯¹äºä¸€èˆ¬çš„è¦æ±‚ï¼Œæ¯”å¦‚åœ¨å¯¹è¯æ¡†ä¸­ï¼Œä½¿ç”¨CTreeCtrlæ¯”è¾ƒæ–¹ä¾¿ã€‚åœ¨ä½¿ç”¨æ ‘å½¢è§†å›¾æ§ä»¶æ—¶ï¼Œåªéœ€è¦åˆ©ç”¨æˆå‘˜å‡½æ•°å–å¾—å…¶å¼•ç”¨ï¼Œå°±å¯ä»¥åƒæ ‘å½¢æ§ä»¶ä¸€æ ·æ–¹ä¾¿çš„ä½¿ç”¨ï¼šCTreeCtrl&amp; GetTreeCtrl( ) const;è°ƒç”¨InsertItemå‡½æ•°èƒ½å¤Ÿå°†èŠ‚ç‚¹æ’å…¥æ ‘å½¢æ§ä»¶ä¸­ï¼Œå¹¶è¿”å›æ’å…¥çš„é¡¹çš„HTREEITEMã€‚æ ‘å½¢æ§ä»¶çš„æ’å…¥å·¥ä½œå¾€å¾€æ˜¯åœ¨å¯¹è¯æ¡†çš„OnInitDialogå‡½æ•°ä¸­è¿›è¡Œï¼Œè€Œå¯¹äºæ ‘å½¢è§†å›¾æ§ä»¶ï¼Œåˆ™æ˜¯åœ¨OnInitUpdateå‡½æ•°ä¸­è¿›è¡Œã€‚æ ‘å½¢æ§ä»¶ä¸­çš„èŠ‚ç‚¹æ•°æ®å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾åƒã€‚èŠ‚ç‚¹ä¸­ä½¿ç”¨çš„å›¾åƒæ˜¯å’Œæ ‘å½¢æ§ä»¶çš„å›¾åƒåˆ—è¡¨ç›¸å¯¹åº”çš„ã€‚åœ¨æ ‘å½¢æ§ä»¶ä¸­ä½¿ç”¨å›¾åƒåˆ—è¡¨æ˜¯é€šè¿‡ä½¿ç”¨SetImageListå‡½æ•°æ¥å®Œæˆã€‚æ ‘å½¢æ§ä»¶èƒ½äº§ç”Ÿé€šå‘Šæ¶ˆæ¯ï¼Œå¦‚: TVN_BEGINDRAGå¼€å§‹æ‹–æ‹½ TVN_ITEMEXPANDEDèŠ‚ç‚¹è¢«å±•å¼€æˆ–æ”¶ç¼©å…¶æ¶ˆæ¯æ˜ å°„ä½¿ç”¨WM_NOTIFI,å¦‚ï¼š WM_NOTIFI(TVN_BEGINDRAG,IDC_TREECTRL,OnBeginDrag);\n\n2ã€æ ‘å½¢æ§ä»¶TVN_BEGINRDRAGæ¶ˆæ¯çš„å“åº”\nä¸æ ‘å½¢æ§ä»¶æœ‰å…³çš„ã€å¸¸ç”¨çš„ç»“æ„æ˜¯TVITEMã€TVINSERTSTRUCT ã€NMTREEVIEW(NM_TREEVIEW)ã€‚å‰ä¸¤ä¸ªæ˜¯ç”¨äºæ’å…¥èŠ‚ç‚¹æ—¶ä½¿ç”¨ï¼Œè€ŒNMTREEVIEWæ˜¯ä¸æ ‘å½¢æ§ä»¶çš„é€šå‘Šæ¶ˆæ¯ç›¸å…³çš„ç»“æ„ã€‚å½“ç”¨é¼ æ ‡å·¦é”®æ‹–æ‹½æ ‘å½¢æ§ä»¶æ—¶ï¼Œæ§ä»¶ä¼šå‘å‡ºTVN_BEGINDRAGé€šå‘Šæ¶ˆæ¯ï¼›å½“ç”¨é¼ æ ‡å³é”®æ‹–æ‹½æ—¶ï¼Œåˆ™ä¼šå‘å‡ºTVN_BEGINRDRAGé€šå‘Šæ¶ˆæ¯ã€‚æ‹–æ‹½æ ‘å½¢æ§ä»¶æ—¶éœ€è¦ä½¿ç”¨åˆ°IImageList::BeginDragå‡½æ•°ï¼šIImageList::BeginDrag creates a temporary image list that is used fordragging. In response to subsequent WM_MOUSEMOVE messages, you canmove the drag image by using IImageList::DragMove. To end the dragoperation, you can use IImageList::EndDrag.é€šå¸¸ä½¿ç”¨CTreeCtrl::CreateDragImageå‡½æ•°åˆ›å»ºä¸€ä¸ªè¢«æ‹–æ‹½èŠ‚ç‚¹çš„å›¾åƒå¹¶è¿”å›ä¸€ä¸ªCImageListæŒ‡é’ˆ(æ³¨æ„è¢«æ‹–æ‹½çš„æ•°æ®èŠ‚ç‚¹å¿…é¡»åŒ…å«å›¾åƒï¼Œå¦åˆ™è¿”å›çš„CImageListæŒ‡é’ˆä¸ºç©º)ï¼Œç„¶ååˆ©ç”¨è¯¥æŒ‡é’ˆæ¥è°ƒç”¨CImageList::BeginDragå‡½æ•°ã€‚é™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦è°ƒç”¨CImageList::DragEnterå‡½æ•°é”å®šã€æ›´æ–°çª—å£ï¼Œå¹¶åœ¨æŒ‡å®šçš„ä½ç½®æ˜¾ç¤ºè¢«æ‹–æ‹½çš„å›¾åƒï¼šstatic BOOL PASCAL DragEnter(    CWnd* pWndLock,    CPoint point  );If pWndLock is NULL, this function draws the image in the displaycontext associated with the desktop window, and coordinates arerelative to the upper left corner of the screen.æ³¨æ„BeginDragå‡½æ•°åªæ˜¯åœ¨æ‹–æ‹½å¼€å§‹æ—¶åˆ›å»ºè¦æ‹–æ‹½çš„å›¾åƒï¼Œè€ŒDragEnterå‡½æ•°åˆ™æ˜¾ç¤ºè¯¥å›¾åƒã€‚æœ€åè°ƒç”¨CWnd::SetCaptureå‡½æ•°ä½¿åç»­æ‰€æœ‰çš„é¼ æ ‡è¾“å…¥éƒ½å‘é€åˆ°å½“å‰çš„CWndå¯¹è±¡è€Œä¸ç®¡é¼ æ ‡çš„ä½ç½®ï¼ˆå› ä¸ºCImageList::DragEnterå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºNULLæ—¶è¡¨ç¤ºåœ¨ä¸æ¡Œé¢çª—å£ç›¸å…³çš„çª—å£ï¼Œå¯ä»¥è¯´å°±æ˜¯å½“å‰ç¨‹åºçš„æ¡†æ¶çª—å£ï¼Œä½†ä¸åŒ…æ‹¬å…¶ä»–åº”ç”¨ç¨‹åºçš„çª—å£ä¸Šæ˜¾ç¤ºè¢«æ‹–æ‹½çš„å›¾åƒã€‚å› æ­¤è¦ä½¿å¾—è¢«æ‹–æ‹½çš„å›¾åƒåœ¨æ‰€æœ‰çš„çª—å£ä¸Šè€Œä¸ä»…ä»…æ˜¯åº”ç”¨ç¨‹åºçš„æ¡†æ¶çª—å£ä¸Šæ˜¾ç¤ºï¼Œå°±éœ€è¦è°ƒç”¨CWnd::SetCaptureå‡½æ•°ã€‚ä¸€æ—¦è°ƒç”¨äº†SetCaptureå‡½æ•°ï¼Œåˆ™åœ¨å½“å‰åº”ç”¨ç¨‹åºçš„éæ¡†æ¶çª—å£ï¼ŒåŒ…æ‹¬ç³»ç»Ÿèœå•ä¸Šçš„é¼ æ ‡æŒ‰é”®åŠ¨ä½œå‡è¢«å‘é€åˆ°å½“å‰CWndå¯¹è±¡ï¼Œç›´åˆ°è°ƒç”¨ReleaseCaptureä¸ºæ­¢ï¼‰ã€‚ç„¶åå°±æ˜¯åœ¨é¼ æ ‡ç§»åŠ¨çš„æ¶ˆæ¯å“åº”å‡½æ•°ä¸­è°ƒç”¨CImageList::DragMoveå‡½æ•°ç§»åŠ¨è¢«æ‹–æ‹½çš„å›¾åƒï¼Œä½¿ä¹‹ä¸é¼ æ ‡çš„ç§»åŠ¨ä½ç½®åŒæ­¥ã€‚æœ€åæ˜¯è°ƒç”¨CImageList::DragShowNolockå‡½æ•°éšè—æˆ–æ˜¾ç¤ºæ‹–æ‹½çš„å›¾åƒï¼Œä½†å®ƒå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä¹Ÿå¯ä»¥ä¸è°ƒç”¨ï¼Œå› æ­¤ä¹‹å‰å·²ç»è°ƒç”¨è¿‡CImageList::DragEnterå‡½æ•°æ˜¾ç¤ºæ‹–æ‹½çš„å›¾åƒäº†ã€‚å½“ä¼ é€’trueå€¼æ˜¾ç¤ºæ‹–æ‹½çš„å›¾åƒæ—¶ï¼ŒDragShowNolockåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸åƒDragEnterå‡½æ•°ä¸€æ ·é”å®šçª—å£ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ‹–æ‹½èŠ‚ç‚¹è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨CTreeCtrl::HitTestå‡½æ•°åˆ¤æ–­é¼ æ ‡æ»‘åŠ¨è¿‡ç¨‹ä¸­æ‰€ç»è¿‡çš„ç‚¹æ˜¯å¦ä½äºæ ‘å½¢æ§ä»¶çš„æŸä¸€ä¸ªèŠ‚ç‚¹ä¹‹ä¸Šï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›è¯¥æ ‘å½¢èŠ‚ç‚¹çš„HTREEITEMã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨CTreeCtrl::SelectDropTargetå‡½æ•°æˆ–CTreeCtrl::SelectItemå‡½æ•°æ¥é«˜äº®æ˜¾ç¤ºè¯¥èŠ‚ç‚¹ã€‚\n\n3ã€æ ‘å½¢æ§ä»¶çš„æˆå‘˜å‡½æ•°\nInsertItemå‡½æ•°æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›æ–°æ’å…¥çš„èŠ‚ç‚¹çš„HTREEITEMã€‚ItemHasChildrenå‡½æ•°æ ¹æ®ç»™å®šçš„HTREEITEMåˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨å­èŠ‚ç‚¹ã€‚GetChildItemå‡½æ•°æ ¹æ®ç»™å®šçš„HTREEITEMè·å–è¯¥èŠ‚ç‚¹ä¸‹å­èŠ‚ç‚¹çš„HTREEITEMï¼Œå¦‚æœæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è¿”å›NULLã€‚GetNextSiblingItemå‡½æ•°æ ¹æ®ç»™å®šçš„HTREEITEMè·å–è¯¥èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ã€‚EnsureVisibleå‡½æ•°åœ¨å¿…è¦çš„æ—¶å€™æ»šåŠ¨è§†å›¾åˆ—è¡¨æ§ä»¶ä½¿å¾—å…¶è‡³å°‘éƒ¨åˆ†å¯è§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨TVE_COLLAPSEè°ƒç”¨Expandæ”¶ç¼©æ ‘å½¢æ§ä»¶åä¸èƒ½å†è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¦åˆ™æ”¶ç¼©æ“ä½œå°†æ— æ•ˆã€‚\n\næ„Ÿä¼¤ï¼šWEè¾“äº†ï¼ŒRNGè¾“äº†ï¼Œå¿ƒç¢äº†ã€‚ã€‚ã€‚é¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬12èŠ‚-MFCä¹‹æ ‘æ§ä»¶CTreeCtrl","date":"2017-10-30T13:42:36.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"a22fef1c02426fa8030849627dae8132","title":"ç¬¬11èŠ‚ MFCä¹‹åˆ—è¡¨æ§ä»¶CListCtrl","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬11èŠ‚ MFCä¹‹åˆ—è¡¨æ§ä»¶CListCtrlåœ¨MFCç¨‹åºä¸­åˆ—è¡¨æ§ä»¶ä¹Ÿæ˜¯ä½¿ç”¨å¾ˆé¢‘ç¹çš„æ§ä»¶ï¼Œä¾‹å¦‚windowsçš„èµ„æºç®¡ç†å™¨å°±å¯ä»¥ç”¨åˆ—è¡¨æ§ä»¶æ¥å®ç°ï¼Œå¦‚ä¸‹å›¾ï¼šåˆ—è¡¨æ§ä»¶å…·æœ‰ä»¥ä¸‹å››ç§è§†å›¾ï¼š\n\n\nå¤§å›¾æ ‡\nå°å›¾æ ‡\nåˆ—è¡¨\nè¯¦ç»†ä¿¡æ¯\n\n\n1. æ–°å»ºé¡¹ç›®æ–°å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®â€œday13â€ï¼Œå¸ƒç½®ç•Œé¢å¦‚ä¸‹ï¼Œä»å·¦ä¾§â€œå·¥å…·ç®±â€æ‹–åŠ¨ä¸€ä¸ªList controlåˆ°ç•Œé¢ï¼Œå†åŠ ä¸Šä¸¤ä¸ªæŒ‰é’®åŠCombo Boxï¼Œå¦‚å›¾ï¼š\n\n\n\næ§ä»¶å\næ§ä»¶ID\n\n\n\nList control\nIDC_LIST_VIEW\n\n\nCombo Box\nIDC_COMBO2\n\n\næ·»åŠ è¡Œ\nIDC_BUTTON_ADD\n\n\nåˆ é™¤è¡Œ\nIDC_BUTTON_DEL\n\n\n2. æ·»åŠ åˆ—è¡¨æ§ä»¶å˜é‡å•å‡»é€‰ä¸­åˆ—è¡¨æ§ä»¶ï¼Œå³å‡»é€‰æ‹©-&gt;â€œæ·»åŠ å˜é‡â€ï¼Œæ·»åŠ å˜é‡åä¸ºm_list,å¦‚ä¸‹ï¼š\n3. åˆå§‹åŒ–åˆ—è¡¨æ§ä»¶åˆ‡æ¢åˆ°å¯¹è¯æ¡†çš„åˆå§‹åŒ–å‡½æ•°ï¼ˆOnInitDialog()ï¼‰ï¼Œæˆ‘ä»¬æ¥ç»™åˆ—è¡¨æ§ä»¶å¢åŠ ä¸‰åˆ—ï¼Œ\n1234m_list.ModifyStyle(LVS_TYPEMASK, LVS_REPORT); //è®¾ç½®åˆ—è¡¨æ§ä»¶æ ·å¼ä¸ºè¯¦ç»†ä¿¡æ¯m_list.InsertColumn(0,_T(&quot;ç¬¬ä¸€åˆ—&quot;),LVCFMT_LEFT,120);m_list.InsertColumn(1,_T(&quot;ç¬¬äºŒåˆ—&quot;),LVCFMT_LEFT,120);m_list.InsertColumn(2,_T(&quot;ç¬¬ä¸‰åˆ—&quot;),LVCFMT_LEFT,120);\n4. æ·»åŠ åˆ—è¡¨å›¾æ ‡è‡ªè¡Œä¸‹è½½æˆ–è€…åˆ¶ä½œä¸¤ä¸ªbmpå›¾æ ‡ï¼Œåˆ†åˆ«ä¸º1616ï¼Œå’Œ3232ï¼›å°†å›¾æ ‡å¤åˆ¶åˆ°é¡¹ç›®çš„resèµ„æºç›®å½•ä¸­ï¼Œåˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œå³å‡»æ·»åŠ èµ„æºï¼Œå¯¼å…¥æˆ‘ä»¬å‡†å¤‡å¥½çš„å›¾æ ‡ï¼Œå¦‚å›¾æ‰€ç¤ºï¼šå¯¼å…¥å¥½ä¹‹åæˆ‘ä»¬å¯ä»¥æ›´æ”¹ä½å›¾IDï¼Œå¦‚å›¾æ‰€ç¤ºï¼šæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨day13.hçš„å¤´æ–‡ä»¶ä¸­æ·»åŠ ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼š\n12CImageList m_ilLarge;CImageList m_ilSmall; \nåˆ†åˆ«æ¥å¯¹åº”3232ï¼Œå’Œ1616ï¼›ç„¶åæˆ‘ä»¬å†åˆ‡æ¢åˆ°åˆå§‹åŒ–å‡½æ•°ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹å››è¡Œä»£ç ï¼š\n12345m_ilLarge.Create(IDB_BITMAP_32, 32, 1,RGB(255,0,255));m_ilSmall.Create(IDB_BITMAP_16, 16, 1,RGB(255,0,255));m_list.SetImageList(&amp;m_ilLarge,LVSIL_NORMAL);m_list.SetImageList(&amp;m_ilSmall,LVSIL_SMALL);\n5. å®ç°æ·»åŠ è¡ŒæŒ‰é’®å‡½æ•°åŒå‡»â€œæ·»åŠ è¡Œâ€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼š\n123456789101112void Cday13Dlg::OnBnClickedButtonAdd()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tint nCount = m_list.GetItemCount();\tCString strText;\tstrText.Format(_T(&quot;ç¬¬%dè¡Œï¼Œç¬¬ä¸€åˆ—&quot;), nCount + 1);\tm_list.InsertItem(nCount,strText,0);\tstrText.Format(_T(&quot;ç¬¬%dè¡Œï¼Œç¬¬äºŒåˆ—&quot;), nCount + 1);\tm_list.SetItemText(nCount,1,strText);\tstrText.Format(_T(&quot;ç¬¬%dè¡Œï¼Œç¬¬ä¸‰åˆ—&quot;), nCount + 1);\tm_list.SetItemText(nCount,2,strText);&#125;\næ³¨æ„ï¼Œåªæœ‰æ·»åŠ ç¬¬ä¸€è¡Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ‰æ˜¯InsertItemï¼Œä¹‹åçš„æ·»åŠ éƒ½åº”è¯¥æ˜¯SetItemTextï¼Œé˜²æ­¢å‡ºé”™ï¼›\n5. å®ç°åˆ é™¤è¡ŒæŒ‰é’®å‡½æ•°åŒå‡»â€œåˆ é™¤è¡Œâ€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼š\n123456789101112void Cday13Dlg::OnBnClickedButtonDel()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tint nCount = m_list.GetItemCount();\tfor (int i = nCount; i&gt;=0 ; --i)\t&#123;\t\tif (m_list.GetItemState(i,LVIS_SELECTED) == LVIS_SELECTED)\t\t&#123;\t\t\tm_list.DeleteItem(i);\t\t&#125;\t&#125;&#125;\nè¿™æ ·å°±å®ç°äº†åˆ é™¤è¡Œçš„æŒ‰é’®ï¼Œå¹¶ä¸”æ‰€æœ‰è¢«é€‰ä¸­çš„è¡Œéƒ½ä¼šè¢«åˆ é™¤ï¼ŒæŒ‰ä½Ctrlé€‰ä¸­å¤šè¡Œï¼Œç‚¹å‡»åˆ é™¤ï¼Œæ‰€æœ‰è¢«é€‰ä¸­çš„è¡Œéƒ½ä¼šè¢«åˆ é™¤ï¼›\n6. å®ç°åˆ—è¡¨æ§ä»¶çš„æ ·å¼åˆ‡æ¢åˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œå•å‡»Combo Boxï¼Œæ‰“å¼€å±æ€§-&gt;data;è¾“å…¥ï¼š\n\nå¤§å›¾æ ‡;å°å›¾æ ‡;è¯¦ç»†ä¿¡æ¯;åˆ—è¡¨;\n\nå¦‚å›¾ï¼š\nç»§ç»­ç¼–è¾‘Combo Boxçš„å±æ€§ï¼Œé€‰æ‹©â€œæ§ä»¶äº‹ä»¶â€ï¼Œæ·»åŠ CBN_Selchangeäº‹ä»¶ï¼Œå¦‚å›¾ï¼šç¼–è¾‘Combo Boxçš„OnCbnSelchangeCombo2å¤„ç†å‡½æ•°ï¼š\n12345678910111213141516171819202122232425void Cday13Dlg::OnCbnSelchangeCombo2()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tDWORD dwStyle;\tCComboBox *pView;\tpView = (CComboBox *)GetDlgItem(IDC_COMBO2);\tswitch(pView-&gt;GetCurSel())\t&#123;\tcase 0:\t\tdwStyle = LVS_ICON;\t\tbreak;\tcase 1:\t\tdwStyle = LVS_SMALLICON;\t\tbreak;\tcase 2:\t\tdwStyle = LVS_LIST;\t\tbreak;\tcase 3:\t\tdwStyle = LVS_REPORT;\t\tbreak;\tdefault:\t\treturn;\t&#125;\tm_list.ModifyStyle(LVS_TYPEMASK,dwStyle);&#125;\nå¾ˆæ˜æ˜¾ï¼Œå…ˆç”¨GetDlgItemè·å–Combo Boxçš„å¯¹è±¡ï¼Œç„¶ååˆ¤æ–­Combo Boxçš„é€‰ä¸­çš„æ˜¯å“ªä¸€é¡¹ï¼Œè®°å½•é€‰ä¸­é¡¹çš„åˆ—è¡¨ç±»å‹ï¼Œæœ€åè®¾ç½®åˆ—è¡¨å±æ€§ï¼›\næœ€åæ•ˆæœå›¾ï¼šå¤§å›¾æ ‡:å°å›¾æ ‡ï¼š\nåˆ—è¡¨ï¼šè¯¦ç»†ä¿¡æ¯ï¼š\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;","slug":"MFC/ç¬¬11èŠ‚-MFCä¹‹åˆ—è¡¨æ§ä»¶CListCtrl","date":"2017-10-29T13:14:48.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"05174ca29f2b54bcb09b1b16597992ea","title":"å·¥å…·ä½¿ç”¨--ç¬¬2èŠ‚ HEXO+GitHub æ­å»ºä¸ªäººåšå®¢","content":"ä»Šå¤©çªç„¶æƒ³æ­å»ºä¸€ä¸ªè‡ªå·±çš„ç§äººåšå®¢ï¼Œä½†æ˜¯åˆä¸æƒ³ä¸ºæ­¤ä¹°ä¸€å°æœåŠ¡å™¨ï¼Œæ‰€ä»¥ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨**HEXO+ç äº‘ **æ­å»ºç§äººåšå®¢ï¼Œæ‰€ä»¥å°±å†™ç¯‡æ•™ç¨‹ï¼Œè®°å½•ä¸€ä¸‹å§ã€‚\n1ã€ç¯å¢ƒå®‰è£…é…ç½®1.1 å®‰è£…nodeä¸‹è½½åœ°å€ï¼šhttps://nodejs.org/en/download/é»˜è®¤å®‰è£…å°±å¥½ã€‚\n1.2 å®‰è£…gitmsysgitæ˜¯Windowsç‰ˆçš„Gitï¼Œä»https://git-for-windows.github.ioä¸‹è½½ï¼ˆç™¾åº¦ä¸€ä¸‹ä¹Ÿæœ‰å¾ˆå¤šä¸‹è½½é“¾æ¥ï¼‰ï¼Œç„¶åæŒ‰é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ã€‚msysgitçš„æ“ä½œå‘½ä»¤å’ŒLinuxåŸºæœ¬ä¸€è‡´ï¼Œå¾ˆå¤šå‘½ä»¤æ˜¯é€šç”¨çš„ï¼Œä¾‹å¦‚lsï¼Œmvï¼Œrmç­‰ï¼›mygitå®‰è£…å®Œæˆåï¼Œåœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ°â€œGitâ€-&gt;â€œGit Bashâ€ï¼Œè¹¦å‡ºä¸€ä¸ªç±»ä¼¼å‘½ä»¤è¡Œçª—å£çš„ä¸œè¥¿ï¼Œå°±è¯´æ˜Gitå®‰è£…æˆåŠŸï¼ï¼ˆè¯¦æƒ…å¯å‚è§  ç¬¬1èŠ‚  ï¼‰\n1.3 ç”³è¯·GitHubè´¦å· æ‰“å¼€https://github.com/ï¼Œè‡ªè¡Œç”³è¯·è´¦å·ï¼›\n1.4 å®‰è£…HEXOåˆ‡æ¢åˆ°å‘½ä»¤è¡Œå·¥å…·ï¼ŒCMDè¾“å…¥å‘½ä»¤å®‰è£…ï¼š\n\nnpm install -g hexo\n\nç­‰å¾…å®‰è£…å®Œæˆï¼›ä¸è¿‡å›½å†…NPMé•œåƒé€Ÿåº¦ææ…¢ï¼Œå¯ä»¥å®‰è£…æ·˜å®çš„cnpmï¼›\n\nnpm install -g cnpm â€“registry&#x3D;https://registry.npm.taobao.org\n\nç„¶åä½¿ç”¨cnpmæ¥ä¸‹è½½HEXOï¼Œå¦‚ä¸‹ï¼š\n\ncnpm install -g hexo\n\n\n1.5 é…ç½®HEXOåˆ‡æ¢CMDåˆ°ä½ å¸Œæœ›åˆ›å»ºåšå®¢é¡¹ç›®çš„ç›®å½•ï¼Œç„¶åè¾“å…¥hexo initæ¥åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼Œå¦‚ï¼š\n\ncd c:&#x2F;workspase&#x2F;bloghexo init\n\nç»§ç»­è¾“å…¥å‘½ä»¤ï¼š\n\nhexo generate æˆ–è€… hexo g\n\nç”Ÿæˆé™æ€é¡µé¢\n1.6 å¯åŠ¨æœ¬åœ°æœåŠ¡\nhexo server\n\nå¯ä»¥çœ‹åˆ°æç¤ºHexoå·²ç»è¿è¡Œåœ¨http://localhost:4000/ä¸Šï¼Œæˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€ http://localhost:4000/çœ‹çœ‹æ•ˆæœï¼š\nç¥å¥‡çš„åšå®¢ç•Œé¢å°±å‡ºç°äº†ï¼›\n2ã€é…åˆGithubæ­å»ºä¸ªäººåšå®¢2.1 ç™»å½•Githubåˆ›å»ºä¸€ä¸ªé¡¹ç›®\nç™»å½•Githubï¼Œç‚¹å‡»ä¸Šæ–¹çš„æ·»åŠ é¡¹ç›®ï¼šæˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸ªGITç‰ˆæœ¬ä»“ï¼Œç‚¹å‡»+å·ï¼Œé€‰æ‹©â€œNew repositoryâ€ï¼Œå¦‚å›¾ï¼š\næ‰“å¼€åˆ›å»ºå¯¹è¯æ¡†ä¹‹åï¼Œè¾“å…¥repositoryåï¼Œ*****.github.ioï¼Œæ˜Ÿå·ä»£è¡¨ä½ çš„ç”¨æˆ·åï¼Œè®°ä½ç»“å°¾ä¸€å®šè¦ç”¨.github.ioç»“å°¾ï¼Œå¦‚æœä½ è¾“å…¥çš„æ ¼å¼æˆ–è€…ç”¨æˆ·åä¸åŒ¹é…ï¼Œæœ€ååˆ›å»ºçš„ç½‘ç«™å¯èƒ½åŠ è½½ä¸å‡ºcssï¼Œjsç­‰èµ„æºï¼Œå…·ä½“åŸå› è¿˜æ²¡å¼„æ¸…ï¼Œå¾…ä»¥åéªŒè¯ï¼Œæš‚æ—¶å°±æŒ‰ç…§è§„èŒƒæ¥ï¼Œå¦‚å›¾ï¼šå…¶ä½™çš„é»˜è®¤å°±å¥½ï¼Œç‚¹å‡»â€œCreate repositoryâ€æ¥åˆ›å»ºä»“åº“ï¼›ï¼ˆæˆ‘çš„ç”±äºå·²ç»åˆ›å»ºåŒåçš„ï¼Œæ‰€ä»¥å¼¹å‡ºæç¤ºï¼Œè¯·æ— è§†ï¼‰\nåˆ›å»ºå¥½ä¹‹åè¿›å…¥åˆ›å»ºå¥½çš„ç•Œé¢ï¼Œå¦‚ä¸‹ï¼šç”±äºæˆ‘çš„å·²ç»ä¸Šä¼ è¿‡æ–‡ä»¶ï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ²¡æœ‰çº¢æ¡†ä¸­çš„å†…å®¹ï¼Œä¸æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹æ€ä¹ˆä¸Šä¼ æ–‡ä»¶ï¼›\næœ¬åœ°mygitè¿˜éœ€è¦é…ç½®sshç§˜é’¥ï¼Œé‚®ç®±ç­‰æ‰èƒ½å’Œgithubè¿›è¡Œä¸Šä¼ ï¼Œä¿®æ”¹ç­‰æ“ä½œï¼›è¿™ä¸€æ­¥å¦‚æœæ²¡è®¾ç½®è¿‡ï¼Œå‚è§å·¥å…·ä½¿ç”¨â€“ç¬¬1èŠ‚ gitä½¿ç”¨ç®€è®°\n\n2.2 å…³è”Githubå’ŒHEXO\nè¿›å…¥æˆ‘ä»¬åœ¨ 1.5 é…ç½®HEXO åˆ›å»ºçš„HEXOé¡¹ç›®ç›®å½•ï¼Œæ‰“å¼€æ ¹ç›®å½•ä¸­çš„**_config.yml**æ–‡ä»¶ï¼ˆä»¥è®°äº‹æœ¬æ–‡ä»¶æ‰“å¼€ï¼‰ï¼›åœ¨æ–‡ä»¶æœ€æœ«å°¾æ·»åŠ å¦‚ä¸‹ä¸‰è¡Œï¼šå°†å…¶ä¸­çš„repoæ”¹ä¸ºä½ è‡ªå·±repositoryåœ°å€ï¼Œä½ çš„repositoryåœ°å€åœ¨githubç•Œé¢çš„è¿™é‡Œè·å–ï¼Œå¦‚å›¾ï¼šç‚¹å‡»â€œ2â€å¤„å°±å¯ä»¥ç›´æ¥å¤åˆ¶åœ°å€,æœ€åæ·»åŠ çš„ä¸‰æ¡å°±æ˜¯ï¼š\n\n1234deploy:  type: git  repo: https://github.com/AmuUncle/AmuUncle.github.io.git  branch: master\næ³¨æ„ï¼šæ¯é¡¹çš„å†’å·åéƒ½è¦ç•™ä¸€ä¸ªè‹±æ–‡çš„ç©ºæ ¼å·ï¼›2. åœ¨HEXOé¡¹ç›®æ ¹ç›®å½•ä¸­å³å‡»é€‰æ‹©â€œGit Bash Hereâ€3. ç”Ÿæˆé™æ€ç½‘ç«™å¹¶åŒæ­¥åˆ°githubæ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ï¼š\n\nhexo g   &#x2F;&#x2F; ç”Ÿæˆhexo d   &#x2F;&#x2F; åŒæ­¥æˆ–è€…ç›´æ¥ç”¨ï¼šhexo d -g  &#x2F;&#x2F; åœ¨åŒæ­¥å‰å…ˆç”Ÿæˆç½‘ç«™\n\nä¸­é—´å¯èƒ½ä¼šè®©ä½ è¾“å…¥githubçš„è´¦å·å¯†ç ï¼Œè¾“å…¥å°±å¥½ï¼šè¿è¡Œç»“æœå¦‚ä¸‹ï¼šè¿™æ ·ç½‘ç«™å°±åŒæ­¥åˆ°githubä¸­äº†ï¼›æˆ‘ä»¬å¯ä»¥åˆ·æ–°githubé¡µé¢ã€‚å¯ä»¥çœ‹åˆ°å·²ç»æœ‰å¾ˆå¤šæ–‡ä»¶äº†ï¼š\n2.3 è®©ç½‘ç«™æ˜¾ç¤ºå‡ºæ¥æˆ‘ä»¬ç‚¹å‡»githubç•Œé¢ä¸Šçš„SettingsæŒ‰é’®ï¼Œè¿›å…¥è®¾ç½®ç•Œé¢ï¼šå¾€ä¸‹æ‹–åŠ¨ï¼Œæ‰¾åˆ°â€œgithub pagesâ€é€‰é¡¹ï¼Œç‚¹å‡»â€œLaunch Automatic page generatorâ€æŒ‰é’®ï¼Œå¼€å¯github pagesåŠŸèƒ½ï¼›è¿™æ—¶æˆ‘ä»¬å°±å¯å·²è¾“å…¥â€œhttps://AmuUncle.github.ioâ€æ¥æ‰“å¼€æˆ‘ä»¬åˆ›å»ºçš„blogç½‘ç«™ï¼›å¦‚ä¸‹ï¼šè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸå°†ç½‘ç«™éƒ¨ç½²åˆ°GITHUBï¼Œå¹¶ä¸”æ˜¯ä¸ªäººç‹¬ç«‹åšå®¢å“¦ã€‚ã€‚ã€‚\n3ã€è®¾ç½®HEXOçš„ä¸»é¢˜è¿™é‡Œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹ï¼Œå¾ˆç®€å•ï¼Œå¾ˆå¤šäººæ¨èNEXTä¸»é¢˜ï¼Œæˆ‘ä¹Ÿç”¨çš„æ˜¯è¿™æ¬¾ï¼ŒåŠŸèƒ½å¾ˆé½å…¨ï¼Œè¿™é‡Œæˆ‘å°±ç›´æ¥ç»™æ•™ç¨‹é“¾æ¥äº†ï¼Œå¾ˆè¯¦ç»†ï¼›\n\nNEXTä¸»é¢˜å®˜ç½‘ï¼Œæ•™ç¨‹éå¸¸è¯¦ç»†ï¼šhttp://theme-next.iissnan.com/getting-started.htmlHEXOä¸»é¢˜ç±»åˆ—è¡¨ï¼šhttps://hexo.io/themes/\n\nå…¶ä»–ä¸»é¢˜ä¹Ÿå·®ä¸å¤šé…ç½®æ–¹æ³•ï¼Œè‡ªå·±ç ”ç©¶å§ã€‚ã€‚\n4ã€å°†åŸŸåå’Œgithubåšå®¢åœ°å€å…³è”ï¼ˆä¸ªäººéœ€æ±‚ï¼‰4.1 è´­ä¹°åŸŸåæˆ‘æ˜¯åœ¨é˜¿é‡Œäº‘è´­ä¹°çš„.siteåŸŸå,å¾ˆä¾¿å®œï¼Œä¸€å¹´æ‰å‡ å—é’±ï¼Œæœ‰éœ€è¦çš„å¯ä»¥å»çœ‹çœ‹ï¼š\n\nhttps://wanwang.aliyun.com/domain/?spm=5176.8076989.763973.3.5a54fa45x7NU0Z\n\n\n4.2 é…ç½®åŸŸåè¿›å…¥åŸŸåè§£æé…ç½®ç•Œé¢ï¼Œæ·»åŠ ä¸€ä¸‹ä¸‰é¡¹ï¼šè§£æåˆ—è¡¨ï¼š\n\n\n\næ–¹æ³•è®°å½•ç±»å‹\nä¸»æœºè®°å½•\nè®°å½•å€¼\n\n\n\nCNAME\nwww\nAmuUncle.github.io\n\n\nA\n@\n192.30.252.154\n\n\nA\n@\n192.30.252.153\n\n\nå…¶ä¸­ 192.30.252.153å’Œ 192.30.252.154 ä¸ºgithubçš„IPåœ°å€ï¼›åŸŸåè¿™è¾¹å·²ç»é…ç½®å¥½ï¼Œä½†è¿˜æ²¡ç»“æŸï¼Œæˆ‘ä»¬å†æ¥åˆ°HEXOåšå®¢çš„ç›®å½•ï¼Œè¿›å…¥sourceç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªCNAMEæ–‡ä»¶ï¼Œæ²¡æœ‰ä»»ä½•åç¼€åï¼Œç¼–è¾‘å†…å®¹ä¸ºï¼šamuuncle.site\næ¥ä¸‹æ¥è¾“å…¥ï¼š\n\nhexo d -g\n\né‡æ–°ç”ŸæˆåŒæ­¥ç½‘ç«™åˆ°githubï¼Œæ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶å€™æˆ‘ä»¬åˆ°æµè§ˆå™¨è¾“å…¥æˆ‘ä»¬çš„åŸŸåï¼Œå°±æ‰“å¼€äº†æˆ‘ä»¬çš„blogé¡µé¢ï¼Œå¦‚å›¾ï¼ˆå¦‚æœæ‰“ä¸å¼€ï¼Œè¯·ç­‰å¾…10åˆ†é’Ÿï¼Œå› ä¸ºæ›´æ”¹åŸŸåè§£æè¦ååˆ†é’Ÿåæ‰èƒ½ç”Ÿæ•ˆï¼‰æœ€ç»ˆæ•ˆæœå›¾ï¼Œå®Œç¾ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è‡ªç”±å†™ä¸ªäººå¾®åšï¼Œå¹¶ä¸”éƒ¨ç½²åˆ°githubäº†ï¼Œé…ç½®å¥½åŸŸåä¹‹åï¼Œä¸æ³¨æ„æ ¹æœ¬å‘ç°ä¸äº†ä½ æ˜¯åœ¨githubä¸Šéƒ¨ç½²çš„ç½‘ç«™å“¦ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ·»åŠ ä¸€ç¯‡åšå®¢ï¼Œç„¶åè¿›å…¥é¡¹ç›®çš„source_postsç›®å½•æ‰¾æ‰“åˆ›å»ºçš„mdæ–‡ä»¶ï¼Œç¼–è¾‘æ­¤æ–‡ä»¶å°±æ˜¯åœ¨å†™åšå®¢ï¼›\n\nhexo new post â€œå·¥å…·ä½¿ç”¨â€“ç¬¬2èŠ‚ HEXO+GitHub æ­å»ºä¸ªäººåšå®¢â€\n\nå¯¹äºmdæ–‡ä»¶çš„ç¼–å†™ï¼Œç½‘ä¸Šæœ‰å¾ˆå¯¹æ•™ç¨‹ï¼Œæˆ‘ä½¿ç”¨çš„å·¥å…·æ˜¯ï¼šHaroopadï¼Œå®Œå…¨æ²¡è´¹ï¼Œå¯è‡ªè¡Œä¸‹è½½ã€‚è®°ä½å†™å®Œä¹‹åè¿˜æ˜¯è¦è¾“å…¥ï¼š\n\nhexo d -g\n\næ¥é‡æ–°ç”ŸæˆåŒæ­¥ç½‘ç«™åˆ°githubï¼›\næœ€åï¼Œæˆ‘çš„blogåœ°å€å°±æ˜¯&gt;&gt;&gt;æˆ‘çš„ç§äººåšå®¢&lt;&lt;&lt;æ¬¢é¥®å¤§å®¶å…‰ä¸´æŒ‡æ•™ã€‚\n","slug":"WEB/å·¥å…·ä½¿ç”¨-ç¬¬2èŠ‚-HEXO-GitHub-æ­å»ºä¸ªäººåšå®¢","date":"2017-10-29T06:10:26.000Z","categories_index":"GitHub","tags_index":"HEXO","author_index":"é˜¿æœ¨å¤§å”"},{"id":"bc39cd2103ce29a3cc74ae96baf8383f","title":"python selenium è‡ªåŠ¨åŒ–æŸ¥è¯¢ä¸Šæµ·å…¬äº¤å¡ä½™é¢ï¼Œå¹¶é‚®ä»¶é€šçŸ¥","content":"python selenium è‡ªåŠ¨åŒ–æŸ¥è¯¢ä¸Šæµ·å…¬äº¤å¡ä½™é¢ï¼Œå¹¶é‚®ä»¶é€šçŸ¥1ã€ä¸‹è½½pythonå®‰è£…ã€‚ã€€ã€€https://www.python.org/downloads/release/python-351/2ã€å®‰è£…selenium2.1ã€é€šè¿‡pip å®‰è£…    pip install selenium\n2.2ã€é€šè¿‡ä¸‹è½½åŒ…å®‰è£… ,ç›´æ¥ä¸‹è½½seleniumåŒ…ï¼š    https://pypi.python.org/pypi/selenium    è§£å‹ï¼Œcmdè¿›å…¥ç›®å½•:         python setup.py install\n3 ã€ å®‰è£…Chrome driver    ä¸‹è½½åœ°å€ï¼šhttp://npm.taobao.org/mirrors/chromedriver    ä¸‹è½½è§£å‹ï¼Œå°† chromedriver.exe æ–‡ä»¶æ”¾åˆ°chromeçš„å®‰è£…ç›®å½•ä¸‹â€¦\\Google\\Chrome\\Application\\ ,ç„¶åè®¾ç½®pathç¯å¢ƒå˜é‡ï¼›    \n4ã€å…¨éƒ¨ä»£ç \n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273\t# coding = utf-8from selenium import webdriverfrom time import sleepimport smtplibimport tracebackfrom email.mime.text import MIMETextfrom email.mime.multipart import MIMEMultipartcardIDList = [u&quot;u54311******&quot;, u&quot;u728833******&quot;]def sendmail(subject,msg,toaddrs,fromaddr,smtpaddr,password):    &#x27;&#x27;&#x27;    @subject:é‚®ä»¶ä¸»é¢˜    @msg:é‚®ä»¶å†…å®¹    @toaddrs:æ”¶ä¿¡äººçš„é‚®ç®±åœ°å€    @fromaddr:å‘ä¿¡äººçš„é‚®ç®±åœ°å€    @smtpaddr:smtpæœåŠ¡åœ°å€ï¼Œå¯ä»¥åœ¨é‚®ç®±çœ‹ï¼Œæ¯”å¦‚163é‚®ç®±ä¸ºsmtp.163.com    @password:å‘ä¿¡äººçš„é‚®ç®±å¯†ç     &#x27;&#x27;&#x27;    mail_msg = MIMEMultipart()    mail_msg[&#x27;Subject&#x27;] = subject    mail_msg[&#x27;From&#x27;] =fromaddr    mail_msg[&#x27;To&#x27;] = &#x27;,&#x27;.join(toaddrs)    mail_msg.attach(MIMEText(msg, &#x27;html&#x27;, &#x27;utf-8&#x27;))    try:        s = smtplib.SMTP()        s.connect(smtpaddr)  #è¿æ¥smtpæœåŠ¡å™¨        s.login(fromaddr,password)  #ç™»å½•é‚®ç®±        s.sendmail(fromaddr, toaddrs, mail_msg.as_string()) #å‘é€é‚®ä»¶        s.quit()    except :       print (&quot;Error: unable to send email&quot;)       print (traceback.format_exc())def get_gj_info(cardID):    for i in range(1, 10, 1):        try:            print(&quot;ç¬¬%dæ¬¡å°è¯•ã€‚ã€‚ã€‚ã€‚&quot; % i)            driver = webdriver.Chrome()            print(&quot;###########&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹æ‰“å¼€ä¸Šæµ·äº¤é€šç½‘ç«™&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;#########&quot;)            driver.get(&#x27;http://www.sptcc.com/&#x27;)            print(driver.title)            print(&quot;ç½‘ç«™æ‰“å¼€æˆåŠŸ&quot;)            sleep(2)            print(&quot;æŸ¥è¯¢å…¬äº¤å¡å·:%s&quot; % cardID)            driver.find_element_by_id(&quot;pL1i1&quot;).send_keys(cardID)            driver.find_element_by_css_selector(&quot;a[class=\\&quot;pL1b1\\&quot;]&quot;).click()            sleep(2)            data = driver.find_element_by_css_selector(&quot;p[class=\\&quot;amt\\&quot;]&quot;).text            print(&quot;å…¬äº¤å¡ &#123;0&#125;  &#123;1&#125; &quot;.format(cardID, data))            driver.quit()            return &quot;å…¬äº¤å¡ &#123;0&#125;  &#123;1&#125; \\n&quot;.format(cardID, data)            break        except:            print(&quot;æŸ¥è¯¢å‡ºé”™ã€‚ã€‚ã€‚ï¼Œå†æ¬¡å°è¯•ã€‚ã€‚ã€‚&quot;)    print(&quot;##################&gt;&gt;&gt;&gt;&gt;&gt;&gt;é€€å‡ºæŸ¥è¯¢&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;##############&quot;)    return &quot;æŸ¥è¯¢å‡ºé”™ã€‚ã€‚ã€‚&quot;if __name__ == &#x27;__main__&#x27;:    fromaddr = &quot;*******@163.com&quot;    smtpaddr = &quot;smtp.163.com&quot;          # 163é‚®ä»¶smtpæœåŠ¡å™¨åœ°å€    toaddrs = [&quot;*******@qq.com&quot;, &quot;*******@163.com&quot;]    gj_info =&#x27;&#x27;    for cardID in cardIDList:        gj_info += get_gj_info(cardID)    subject = gj_info    password = &quot;*******&quot;    msg = gj_info    sendmail(subject,msg,toaddrs,fromaddr,smtpaddr,password)\n\n\n\n\n\n\n","slug":"PYTHON/python-selenium-è‡ªåŠ¨åŒ–æŸ¥è¯¢ä¸Šæµ·å…¬äº¤å¡ä½™é¢ï¼Œå¹¶é‚®ä»¶é€šçŸ¥","date":"2017-10-28T16:49:43.000Z","categories_index":"PYTHONå®æˆ˜","tags_index":"PYTHON","author_index":"é˜¿æœ¨å¤§å”"},{"id":"1af68f9dfe3c7e2933ac93e37e9817a4","title":"å·¥å…·ä½¿ç”¨--ç¬¬1èŠ‚ gitä½¿ç”¨ç®€è®°","content":"å·¥å…·ä½¿ç”¨â€“ç¬¬1èŠ‚ gitä½¿ç”¨ç®€è®°GIT ï¼ˆåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼‰\nGitæ˜¯ä¸€æ¬¾å…è´¹ã€å¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨äºæ•æ·é«˜æ•ˆåœ°å¤„ç†ä»»ä½•æˆ–å°æˆ–å¤§çš„é¡¹ç›®ã€‚  Gitçš„è¯»éŸ³ä¸º&#x2F;gÉªt&#x2F;ã€‚ Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»å¾ˆå°åˆ°éå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚ Git æ˜¯ Linus Torvalds ä¸ºäº†å¸®åŠ©ç®¡ç† Linux å†…æ ¸å¼€å‘è€Œå¼€å‘çš„ä¸€ä¸ªå¼€æ”¾æºç çš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ã€‚ Torvalds å¼€å§‹ç€æ‰‹å¼€å‘ Git æ˜¯ä¸ºäº†ä½œä¸ºä¸€ç§è¿‡æ¸¡æ–¹æ¡ˆæ¥æ›¿ä»£ BitKeeperï¼Œåè€…ä¹‹å‰ä¸€ç›´æ˜¯ Linux å†…æ ¸å¼€å‘äººå‘˜åœ¨å…¨çƒä½¿ç”¨çš„ä¸»è¦æºä»£ç å·¥å…·ã€‚å¼€æ”¾æºç ç¤¾åŒºä¸­çš„æœ‰äº›äººè§‰å¾—BitKeeper çš„è®¸å¯è¯å¹¶ä¸é€‚åˆå¼€æ”¾æºç ç¤¾åŒºçš„å·¥ä½œï¼Œå› æ­¤ Torvalds å†³å®šç€æ‰‹ç ”ç©¶è®¸å¯è¯æ›´ä¸ºçµæ´»çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚å°½ç®¡æœ€åˆ Git çš„å¼€å‘æ˜¯ä¸ºäº†è¾…åŠ© Linux å†…æ ¸å¼€å‘çš„è¿‡ç¨‹ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»å‘ç°åœ¨å¾ˆå¤šå…¶ä»–è‡ªç”±è½¯ä»¶é¡¹ç›®ä¸­ä¹Ÿä½¿ç”¨äº† Gitã€‚ä¾‹å¦‚ å¾ˆå¤š Freedesktop çš„é¡¹ç›®è¿ç§»åˆ°äº†Git ä¸Šã€‚    â€” ç™¾åº¦ç™¾ç§‘\n\n1.å®‰è£…gitè¿™é‡Œåªè¯´windowsç‰ˆæœ¬å®‰è£…ä½¿ç”¨ï¼ŒLinuxç‰ˆæœ¬ç­‰ä»¥åå†ç ”ç©¶ï¼›\n1.1  ä¸‹è½½msysgitmsysgitæ˜¯Windowsç‰ˆçš„Gitï¼Œä»https://git-for-windows.github.ioä¸‹è½½ï¼ˆç™¾åº¦ä¸€ä¸‹ä¹Ÿæœ‰å¾ˆå¤šä¸‹è½½é“¾æ¥ï¼‰ï¼Œç„¶åæŒ‰é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ã€‚**msysgit**çš„æ“ä½œå‘½ä»¤å’ŒLinuxåŸºæœ¬ä¸€è‡´ï¼Œå¾ˆå¤šå‘½ä»¤æ˜¯é€šç”¨çš„ï¼Œä¾‹å¦‚lsï¼Œmvï¼Œrmç­‰ï¼›mygitå®‰è£…å®Œæˆåï¼Œåœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ°â€œGitâ€-&gt;â€œGit Bashâ€ï¼Œè¹¦å‡ºä¸€ä¸ªç±»ä¼¼å‘½ä»¤è¡Œçª—å£çš„ä¸œè¥¿ï¼Œå°±è¯´æ˜Gitå®‰è£…æˆåŠŸï¼\n2. é…ç½®msysgitåœ¨æ¡Œé¢ç©ºç™½å¤„å³å‡»ï¼Œé€‰æ‹©â€œGit Bash hereâ€è¿›å…¥msysgitçš„æ§åˆ¶å°ï¼Œè¾“å…¥ä¸€ä¸‹ä¸¤æ¡å‘½ä»¤ï¼Œé…ç½®å…¨å±€çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼š\n12$ git config --global user.name &quot;ä½ çš„ç”¨æˆ·å&quot;$ git config --global user.email &quot;é‚®ç®±åœ°å€&quot;\nä½ çš„ç”¨æˆ·åï¼šå¯ä»¥éšæ„è®¾ç½®ï¼Œä½†è¦è®°ä½ç”¨æˆ·åé‚®ç®±åœ°å€ï¼šä½ çš„é‚®ç®±åœ°å€\n3.åˆ›å»ºä»£ç ä»“3.1 è¿›å…¥ä½ æƒ³å»ºä»“çš„ç›®å½•åœ¨ç›®å½•ç©ºç™½å¤„å³å‡»é€‰æ‹©â€œGit Bash hereâ€è¿›å…¥msysgitçš„æ§åˆ¶å°ï¼Œè¾“å…¥git initå‘½ä»¤æŠŠè¿™ä¸ªç›®å½•å˜æˆGitå¯ä»¥ç®¡ç†çš„ä»“åº“ï¼š\n\n$ git init Initialized empty Git repository in C:&#x2F;Users&#x2F;Administrator&#x2F;Desktop&#x2F;usb_encryption_5.4.0&#x2F;git_demo&#x2F;.git&#x2F;\n\ngitä¼šåœ¨æ­¤ç›®å½•åˆ›å»º.gitç›®å½•ï¼Œè¿™æ˜¯Gitæ¥è·Ÿè¸ªç®¡ç†ç‰ˆæœ¬åº“çš„ï¼Œæ— éœ€æˆ‘ä»¬æ¥æ”¹åŠ¨ï¼Œ\n4.ç‰ˆæœ¬æ§åˆ¶æˆ‘ä»¬ç°åœ¨åœ¨æ­¤ç›®å½•ä¸‹æ¥åˆ›å»ºä¸€ä¸ªreadme.mdæ–‡ä»¶ï¼Œéšæ„å¡«å†™äº›å†…å®¹ï¼Œå¦‚ä¸‹\n4.1 æŸ¥çœ‹ç‰ˆæœ¬çŠ¶æ€\ngit status\n\n4.2 æ·»åŠ åˆ°ç¼“å­˜åŒº1git add readme.md\n\n4.3 æäº¤ä»£ç åˆ°ç‰ˆæœ¬ä»“1git commit -m &quot;Add readme&quot;\n\n-m åé¢è·Ÿå¾—æ˜¯ä½ æäº¤çš„ä»£ç çš„æè¿°ï¼Œå»ºè®®æ‰€æœ‰æäº¤éƒ½åº”è¯¥æ·»åŠ æè¿°ã€‚\næš‚æ—¶å…ˆè®°å½•è¿™ä¹ˆå¤šï¼Œä¸‹æ¬¡å†è¡¥å……å®Œæ•´\n","slug":"WEB/å·¥å…·ä½¿ç”¨-ç¬¬1èŠ‚-gitä½¿ç”¨ç®€è®°","date":"2017-10-28T15:38:48.000Z","categories_index":"gitæ•™ç¨‹","tags_index":"GIT","author_index":"é˜¿æœ¨å¤§å”"},{"id":"0686f7c34d3d8d3e03a82f60ca6790dd","title":"ç¬¬10èŠ‚ MFCèœå•","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬10èŠ‚ MFCèœå•MFCèœå•ï¼ˆCMenuï¼‰MFCèœå•åˆ†ä¸ºä¸¤ç±»ï¼š\n\nçª—ä½“èœå•å¿«æ·èœå•:åˆå«å¼¹å‡ºèœå•ï¼Œæˆ–è€…ä¸Šä¸‹æ–‡èœå•\n\n1ã€åˆ›å»ºé¡¹ç›®æ‰“å¼€vs2010ï¼Œåˆ›å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†çš„é¡¹ç›®ï¼Œé¡¹ç›®åâ€œday10â€,æ³¨æ„è¿™æ¬¡ä¸»æ¡†æ¶ä¸­å°±ä¸è¦å‹¾é€‰â€œç³»ç»Ÿèœå•â€å’Œâ€œå…³äºæ¡†â€äº†ï¼Œå¦‚å›¾ï¼šåˆ›å»ºå¥½åï¼Œåˆ é™¤è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æœ¬æ§ä»¶ï¼Œå¦‚å›¾ï¼š\n2ã€åˆ›å»ºç³»ç»Ÿèœå•åˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œå³å‡»æˆ‘ä»¬çš„é¡¹ç›®â€œday10â€ï¼Œé€‰æ‹©æ·»åŠ èµ„æºï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼š\né€‰æ‹©â€œMenuâ€ç‚¹å‡»æ–°å»º,ç„¶åå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­Menuç›®å½•ï¼Œè¿™é‡Œå°±å­˜æ”¾èœå•èµ„æºï¼Œå±•å¼€åå°±å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åˆšæ·»åŠ çš„èœå•IDï¼ŒåŒå‡»æ‰“å¼€ï¼›æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥æƒ³è¦æ·»åŠ çš„èœå•é€‰é¡¹ï¼Œå¦‚å›¾ï¼šæˆ‘ä»¬å¯ä»¥åœ¨èµ„æºè§†å›¾å³å‡»èœå•IDï¼Œç„¶åé€‰æ‹©å±æ€§ï¼Œä¿®æ”¹IDä¸ºIDR_MENU_SYSTEM;\n3ã€æ˜¾ç¤ºç³»ç»Ÿèœå•æˆ‘ä»¬æ‰“å¼€åˆšæ‰åˆ›å»ºçš„ä¸»çª—å£ï¼Œå³å‡»æ‰“å¼€å±æ€§ï¼Œåœ¨å±æ€§åˆ—è¡¨æ‰¾åˆ°MENUå±æ€§ï¼Œä¸‹æ‹‰æ¡†é€‰æ‹©åˆšæ‰åˆ›å»ºçš„IDR_MENU_SYSTEMèœå•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼šè¿™æ—¶ä¸»çª—å£å°±å’ŒIDR_MENU_SYSTEMèœå•å…³è”èµ·æ¥äº†ï¼Œè¿è¡Œçœ‹çœ‹æ•ˆæœï¼š\n4ã€åˆ›å»ºèœå•æ¶ˆæ¯äº‹ä»¶æˆ‘ä»¬åˆ‡æ¢åˆ°æˆ‘ä»¬åˆ›å»ºçš„èœå•ç•Œé¢ï¼Œæ¥å®ç°èœå•ä¸­ä¿å­˜é€‰é¡¹çš„å¤„ç†äº‹ä»¶ï¼Œåœ¨â€œä¿å­˜â€é€‰é¡¹ä¸Šå³å‡»ï¼Œé€‰æ‹©â€œæ·»åŠ äº‹ä»¶å¤„ç†å‡½æ•°â€ï¼Œå¦‚ä¸‹ï¼šï¼Œå‡ºç°å¦‚ä¸‹æ·»åŠ äº‹ä»¶ç•Œé¢ï¼šè¿™é‡Œæˆ‘ä»¬ç±»åˆ—è¡¨ä¸­é€‰æ‹©Cday10Dlgä¸­åˆ›å»ºæ“ä½œå‡½æ•°ï¼Œå‡½æ•°åä¿®æ”¹ä¸ºOnMenuSaveClickï¼Œç‚¹å‡»â€œæ·»åŠ ç¼–è¾‘â€ï¼Œæ·»åŠ å¤„ç†å‡½æ•°ï¼›\n12345void Cday10Dlg::OnMenuSaveClick()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ å‘½ä»¤å¤„ç†ç¨‹åºä»£ç \tAfxMessageBox(_T(&quot;æ–‡ä»¶å·²ä¿å­˜ï¼&quot;));  &#125;\nè¿è¡Œæ•ˆæœï¼Œç‚¹å‡»â€œæ–‡ä»¶â€-&gt;â€œä¿å­˜â€,æ­¤æ—¶å°±ä¼šå¼¹çª—æç¤ºâ€œâ€â€æ–‡ä»¶å·²ä¿å­˜ï¼â€ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n5ã€åˆ›å»ºå¿«æ·èœå•åˆ‡æ¢èµ„æºè§†å›¾ï¼Œé€‰æ‹©â€œMenuâ€ç‚¹å‡»â€œæ’å…¥MENUâ€,è‡ªåŠ¨æ‰“å¼€ï¼›æˆ‘ä»¬å¯ä»¥ç›´æ¥è¾“å…¥æƒ³è¦æ·»åŠ çš„èœå•é€‰é¡¹ï¼Œå¦‚å›¾ï¼šæ³¨æ„ï¼šå¿«æ·èœå•ä¸­æœ€ä¸Šé¢çš„â€œå¿«æ·èœå•â€ä¸ä¼šæ˜¾ç¤ºï¼Œåå­—å¯ä»¥éšæ„ã€‚ä¿®æ”¹æ¬¡menuçš„IDä¸ºIDR_MENU_QUICKï¼›\n6ã€æ˜¾ç¤ºå¿«æ·èœå•æˆ‘ä»¬æ‰“å¼€åˆšæ‰åˆ›å»ºçš„ä¸»çª—å£ï¼Œå³å‡»æ‰“å¼€å±æ€§ï¼Œåœ¨å±æ€§åˆ—è¡¨ä¸Šæ–¹é€‰æ‹©â€œæ¶ˆæ¯â€æŒ‰é’®ï¼Œæ‰¾åˆ°â€œWM_OnContextMenuâ€,é€‰æ‹©add OnContextMenuæ–¹æ³•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n1234567891011void Cday10Dlg::OnContextMenu(CWnd* pWnd, CPoint point)&#123;\t// TODO: åœ¨æ­¤å¤„æ·»åŠ æ¶ˆæ¯å¤„ç†ç¨‹åºä»£ç \tCMenu menu;\tif(!menu.LoadMenu(IDR_MENU_QUICK))\t&#123;\t\treturn;\t&#125;\tCMenu* pMenu = menu.GetSubMenu(0);\tpMenu-&gt;TrackPopupMenu(TPM_LEFTALIGN|TPM_RIGHTBUTTON,point.x,point.y,pWnd);&#125;\nè¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯ï¼šå…ˆè¯•å›¾åŠ è½½IDR_MENU_QUICKèœå•ï¼ŒåŠ è½½æˆåŠŸä¹‹åï¼Œå°†èœå•æ˜¾ç¤ºåœ¨é¼ æ ‡å³å‡»ï¼ˆTPM_RIGHTBUTTONï¼‰ï¼Œé å·¦æ–¹ï¼ˆTPM_LEFTALIGNï¼‰çš„ä½ç½®ï¼›è¿è¡Œæ•ˆæœï¼šå¯ä»¥çœ‹è§ï¼Œèœå•å·²ç»æ˜¾ç¤ºå‡ºæ¥ï¼›\n7ã€åˆ›å»ºèœå•æ¶ˆæ¯äº‹ä»¶åŒæ­¥éª¤4ï¼Œå¦‚å›¾ï¼šç¼–è¾‘OnCopyå‡½æ•°ï¼Œå¦‚ä¸‹ï¼š\n12345void Cday10Dlg::OnCopy()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ å‘½ä»¤å¤„ç†ç¨‹åºä»£ç \t\tAfxMessageBox(_T(&quot;æ–‡ä»¶å·²å¤åˆ¶ï¼&quot;));  &#125;\næ•ˆæœå›¾ï¼š\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘","slug":"MFC/ç¬¬10èŠ‚-MFCèœå•","date":"2017-10-28T15:33:24.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"d5ebde1940644a1d236c756a4a2c1627","title":"ç¬¬9èŠ‚ MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸‹ï¼‰","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬9èŠ‚ MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸‹ï¼‰ä¸ŠèŠ‚å­¦ä¹ äº†MFCè®¿é—®æ§ä»¶çš„ä¸‰ç§æ–¹æ³•ï¼Œè¿™èŠ‚æˆ‘ä»¬æ¥å­¦ä¹ å‰©ä¸‹çš„å››ç§æ–¹æ³•ï¼Œå››ç§æ–¹æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š\n\nç¬¬å››ç§æŠŠæ§ä»¶å’Œæ•´å‹å˜é‡ç›¸å…³è”\nç¬¬äº”ç§æŠŠæ§ä»¶å’Œæ§ä»¶å˜é‡ç›¸å…³è”\nç¬¬å…­ç§ SendMessageæ–¹æ³•\nç¬¬ä¸ƒç§SendDlgItemMessageæ–¹æ³•\n\næ–¹æ³•å›› æŠŠæ§ä»¶å’Œæ•´å‹å˜é‡ç›¸å…³è”1. åˆ›å»ºé¡¹ç›®æ‰“å¼€ä¸ŠèŠ‚ç”¨åˆ°çš„day08é¡¹ç›®ï¼Œåˆ‡æ¢åˆ°èµ„æºè§†å›¾ï¼Œæ·»åŠ ä¸€ä¸ªæŒ‰é’®â€œæ–¹æ³•4â€ï¼Œæˆ‘ä»¬åœ¨æ­¤æŒ‰é’®ä¸Šå®ç°æ–¹æ³•å››ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n2. å…³è”æ•´å‹å˜é‡å•å‡»é€‰æ‹©èº«é«˜çš„è¾“å…¥æ¡†ï¼ˆIDC_EDIT_SGï¼‰,å³å‡»é€‰æ‹©â€œæ·»åŠ å˜é‡â€ï¼Œæ‰“å¼€å¦‚ä¸‹ç•Œé¢ï¼šç°åœ¨æˆ‘ä»¬å…ˆé€‰æ‹©ç±»åˆ«ä¸ºâ€œvalueâ€ï¼Œç„¶åé€‰æ‹©å˜é‡ç±»å‹é€‰æ‹©â€œintâ€ï¼Œå˜é‡åâ€œm_Heightâ€ï¼Œå…¶ä½™çš„é»˜è®¤å°±å¥½ï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥å°è¯•ä¿®æ”¹ä¸€ä¸‹æœ€å¤§å€¼ï¼Œæœ€å°å€¼ç­‰ã€‚å¦‚å›¾æ‰€ç¤ºï¼šç°åœ¨æˆ‘ä»¬åˆ‡æ¢åˆ°è§£å†³æ–¹æ¡ˆè§†å›¾ï¼Œå¯ä»¥çœ‹è§ï¼Œday08Dlg.hä¸­å·²ç»å¢åŠ äº†ä¸€ä¸ªç±»å˜é‡ï¼Œm_Heightï¼Œday08Dlg.cppä¸­DoDataExchangeä¹Ÿå¢åŠ è¯¥å˜é‡çš„å…³è”æ–¹æ³•ï¼Œå°†å˜é‡ m_Heightå’ŒIDC_EDIT_SGçš„è¾“å…¥æ¡†å…³è”èµ·æ¥ï¼Œå¦‚ä¸‹ï¼š\n12345void Cday08Dlg::DoDataExchange(CDataExchange* pDX)&#123;\tCDialogEx::DoDataExchange(pDX);\tDDX_Text(pDX, IDC_EDIT_SG, m_Height);&#125;\nè¿˜æœ‰day08Dlgçš„æ„é€ å‡½æ•°ä¸­ä¹Ÿå¯¹m_Heightè¿›è¡Œäº†åˆå§‹åŒ–ï¼Œå¦‚ä¸‹ï¼š\n123456Cday08Dlg::Cday08Dlg(CWnd* pParent /*=NULL*/)\t: CDialogEx(Cday08Dlg::IDD, pParent)\t, m_Height(0)&#123;\tm_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);&#125;\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°m_Heightçš„åˆå§‹åŒ–å€¼ä¸º0ï¼Œç°åœ¨æˆ‘ä»¬ç¼–è¯‘è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°èº«é«˜è¾“å…¥æ¡†ä¸­çš„å€¼å°±ä¸º0ï¼Œå¦‚å›¾ï¼šæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«å…³è”IDC_EDIT_TZå’ŒIDC_EDIT_BMIä¸ºå˜é‡int m_Weight,double m_BMI;\n123int m_Height;int m_Weight;double m_BMI;\n\n3.å®ç°æŒ‰é’®äº‹ä»¶ç°åœ¨m_Height ï¼Œm_Weight ï¼Œm_BMI åˆ†åˆ«å’Œç•Œé¢ä¸Šçš„ä¸‰ä¸ªè¾“å…¥æ¡†ç›¸å…³è”ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å–å®ƒä»¬çš„å€¼å°±å¯ä»¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œèµ‹å€¼ï¼Œä½†è¿™æ˜¯ä¼šç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•:\n\nUpdateData(TRUE);   &#x2F;&#x2F;æŠŠæ§ä»¶çš„å€¼å…³è”åˆ°å˜é‡UpdateData(FALSE);  &#x2F;&#x2F;æŠŠå˜é‡çš„å€¼å…³è”åˆ°æ§ä»¶\n\n12345678void Cday08Dlg::OnBnClickedButtonFunc4()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tUpdateData(TRUE);   //æŠŠæ§ä»¶çš„å€¼å…³è”åˆ°å˜é‡\tdouble dHeight = m_Height / 100.00;\tm_BMI = m_Weight / (dHeight * dHeight );\tUpdateData(FALSE);  //æŠŠå˜é‡çš„å€¼å…³è”åˆ°æ§ä»¶&#125;\nç¼–è¯‘è¿è¡Œï¼Œè¿™æ—¶å°±å¯ä»¥çœ‹åˆ°ç‚¹å‡»æ–¹æ³•4ä¹‹åï¼ŒBMIå€¼å°±è®¡ç®—å‡ºæ¥äº†ï¼Œå¦‚å›¾ï¼š\næ–¹æ³•äº” æŠŠæ§ä»¶å’Œæ§ä»¶å˜é‡ç›¸å…³è”1. æ·»åŠ â€œæ–¹æ³•5â€æŒ‰é’®å¦‚å›¾ï¼š\n1. å…³è”æ§ä»¶å˜é‡å•å‡»é€‰æ‹©èº«é«˜çš„è¾“å…¥æ¡†ï¼ˆIDC_EDIT_SGï¼‰,å³å‡»é€‰æ‹©â€œæ·»åŠ å˜é‡â€ï¼Œæ‰“å¼€å¦‚ä¸‹ç•Œé¢ï¼š\nç°åœ¨æˆ‘ä»¬å…ˆé€‰æ‹©ç±»åˆ«ä¸ºâ€œcontrolâ€ï¼Œå˜é‡åâ€œm_edit_Heightâ€ï¼Œå…¶ä½™çš„é»˜è®¤å°±å¥½ï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥å°è¯•ä¿®æ”¹ä¸€ä¸‹æœ€å¤§å€¼ï¼Œæœ€å°å€¼ç­‰ã€‚å¦‚å›¾æ‰€ç¤ºï¼šæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«å…³è”IDC_EDIT_TZå’ŒIDC_EDIT_BMIä¸ºå˜é‡\tCEdit m_edit_tz, CEdit m_edit_bmi;\n123CEdit m_edit_sg;CEdit m_edit_tz;CEdit m_edit_bmi;\n3.å®ç°æŒ‰é’®äº‹ä»¶ç°åœ¨m_edit_sgï¼Œm_edit_tzï¼Œm_edit_bmiåˆ†åˆ«å’Œç•Œé¢ä¸Šçš„ä¸‰ä¸ªè¾“å…¥æ¡†ç›¸å…³è”ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å–å®ƒä»¬çš„å€¼å°±å¯ä»¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œèµ‹å€¼ï¼Œä½†è¿™æ˜¯ä¼šç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•:\n12345678910111213141516void Cday08Dlg::OnBnClickedButtonFunc5()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tTCHAR tcHeight[10], tcWeight[10] , tcBMI[10];\tm_edit_sg.GetWindowText(tcHeight,10);\tm_edit_tz.GetWindowText(tcWeight,10);\tint nHeight = _ttoi(tcHeight);\tdouble dHeight = nHeight / 100.00;\tint nWeight = _ttoi(tcWeight);\tdouble bmi = nWeight/(dHeight * dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\tm_edit_bmi.SetWindowText(buf);&#125;\n\næ–¹æ³•å…­ SendMessageæ–¹æ³•é€šè¿‡SendMessageæ–¹æ³•å‘é€WM_GETTEXTæ¶ˆæ¯åˆ°æ§ä»¶æ‰€åœ¨çª—å£æ¥è·å–æ§ä»¶æ–‡æœ¬å€¼ï¼ŒåŒæ ·å‘é€WM_SETTEXTæ¶ˆæ¯åˆ°æ§ä»¶æ‰€åœ¨çª—å£æ¥è®¾ç½®æ§ä»¶æ–‡æœ¬å€¼ï¼›\n12345678910111213141516void Cday08Dlg::OnBnClickedButtonFunc6()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tTCHAR tcHeight[10], tcWeight[10] , tcBMI[10];\t::SendMessage(GetDlgItem(IDC_EDIT_SG)-&gt;m_hWnd,WM_GETTEXT,10,(LPARAM)tcHeight);\t::SendMessage(GetDlgItem(IDC_EDIT_TZ)-&gt;m_hWnd,WM_GETTEXT,10,(LPARAM)tcWeight);\tint nHeight = _ttoi(tcHeight);\tdouble dHeight = nHeight / 100.00;\tint nWeight = _ttoi(tcWeight);\tdouble bmi = nWeight/(dHeight * dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\t::SendMessage(GetDlgItem(IDC_EDIT_BMI)-&gt;m_hWnd,WM_SETTEXT,10,(LPARAM)buf);&#125;\næ–¹æ³•ä¸ƒ SendDlgItemMessageæ–¹æ³•é€šè¿‡SendDlgItemMessageæ–¹æ³•å‘é€WM_GETTEXTæ¶ˆæ¯åˆ°æ§ä»¶æ‰€åœ¨çª—å£æ¥è·å–æ§ä»¶æ–‡æœ¬å€¼ï¼ŒåŒæ ·å‘é€WM_SETTEXTæ¶ˆæ¯åˆ°æ§ä»¶æ‰€åœ¨çª—å£æ¥è®¾ç½®æ§ä»¶æ–‡æœ¬å€¼ï¼›\n1234567891011121314151617void Cday08Dlg::OnBnClickedButtonFunc7()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tTCHAR tcHeight[10], tcWeight[10] , tcBMI[10];\tSendDlgItemMessage(IDC_EDIT_SG,WM_GETTEXT,10,(LPARAM)tcHeight);\tSendDlgItemMessage(IDC_EDIT_TZ,WM_GETTEXT,10,(LPARAM)tcWeight);\tint nHeight = _ttoi(tcHeight);\tdouble dHeight = nHeight / 100.00;\tint nWeight = _ttoi(tcWeight);\tdouble bmi = nWeight/(dHeight * dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\tSendDlgItemMessage(IDC_EDIT_BMI,WM_SETTEXT,10,(LPARAM)buf);&#125;\n\næ€»ç»“ï¼Œä»¥ä¸Šä¸ƒç§æ–¹æ³•è™½ç„¶ç»“æœç›¸åŒï¼Œä½†æ˜¯å…¶å†…éƒ¨æœºåˆ¶æ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼Œåœ¨æˆ‘ä»¬å°†æ¥çš„ç¼–ç¨‹ä¸­è¦æ ¹æ®å®é™…æƒ…å†µæ¥é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œæœ€åï¼Œæˆ‘ä»¬åˆ—ä¸¾ä¸€ä¸‹è¿™ä¸ƒç§æ–¹æ³•ï¼š\n\n\n\næ–¹æ³•å\nç®€ä»‹\n\n\n\nGetDlgItem()\nè·å–æ§ä»¶å¯¹è±¡\n\n\nGetDlgItemText()\nè·å–å¯¹è±¡æ–‡æœ¬\n\n\nGetDlgItemInt()\nè·å–å¯¹è±¡æ•´å‹å€¼\n\n\nDDX_Text(pDX,IDC_EDIT_SG, m_Height);\næŠŠæ§ä»¶å’Œæ•´å‹å˜é‡ç›¸å…³è”\n\n\nDDX_Control(pDX,IDC_EDIT_BMI,m_edit_bmi);\næŠŠæ§ä»¶å’Œæ§ä»¶å˜é‡ç›¸å…³è”\n\n\nSendMessage\nå‘é€WM_GETTEXTæ¶ˆæ¯åˆ°æ§ä»¶æ‰€åœ¨çª—å£æ¥è·å–æ§ä»¶æ–‡æœ¬å€¼\n\n\nSendDlgItemMessage\nå‘é€WM_GETTEXTæ¶ˆæ¯æ¥è·å–æ§ä»¶æ–‡æœ¬å€¼\n\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘","slug":"MFC/ç¬¬9èŠ‚-MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸‹ï¼‰","date":"2017-10-28T15:33:13.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"89acd55286d16d2f969d7ac76f20c8d8","title":"ç¬¬8èŠ‚ MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸Šï¼‰","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬8èŠ‚ MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸Šï¼‰MFCå¯¹è¯æ¡†æ§ä»¶å…·æœ‰ä»¥ä¸‹ä¸‰ç§è®¿é—®æ–¹å¼(å½“ç„¶è¿˜æœ‰å¾ˆå¤šåˆ«çš„è®¿é—®æ–¹å¼ï¼Œä»Šå¤©æ—¶é—´ç´§æ€¥ï¼Œå…ˆå­¦è¿™ä¸‰ç§)ï¼Œåˆ†åˆ«æ˜¯ï¼š\n\nç¬¬ä¸€ç§GetDlgItem()-&gt;GetWindowText()GetDlgItem()-&gt;SetWindowText()\nç¬¬äºŒç§GetDlgItemText()\n\n\nç¬¬ä¸‰ç§GetDlgItemInt()SetDlgItemInt()\n\n1.æ–°å»ºä¸€ä¸ªå¯¹è¯æ¡†é¡¹ç›®å‚è§ä¸ŠèŠ‚ï¼Œæˆ‘ä»¬è¿™èŠ‚é‡‡ç”¨VS2010ç¼–å†™ä¸€ä¸ªèº«é«˜ä½“é‡è®¡ç®—å™¨ï¼ˆBMIï¼‰ï¼Œå‚è§ ç¬¬äºŒèŠ‚ï¼›\n2.å¸ƒå±€ç¼–è¾‘å¸ƒå±€å¦‚ä¸‹ï¼š\n\n\n\nEDITåç§°\nID\n\n\n\nèº«é«˜\nIDC_EDIT_SG\n\n\nä½“é‡\nIDC_EDIT_TZ\n\n\nBMI\nIDC_EDIT_BMI\n\n\n3.å®ç°æ–¹æ³•åŒå‡»ç¡®è®¤æŒ‰é’®ï¼Œç¼–è¾‘å…¶ç‚¹å‡»æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼›\n1234567891011void Cday08Dlg::OnBnClickedOk()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tint nHeight= GetDlgItemInt(IDC_EDIT_SG,NULL,TRUE);\tdouble dHeight = nHeight / 100.00;\tint nWeight = GetDlgItemInt(IDC_EDIT_TZ,NULL,TRUE);\tdouble bmi = nWeight/(dHeight*dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\tSetDlgItemText(IDC_EDIT_BMI,buf);&#125;\nè¿™é‡Œå¯ä»¥çœ‹è§ä½¿ç”¨åˆ°äº†GetDlgItemIntï¼Œè¿™å°±æ˜¯ç›´æ¥è·å–æ–‡æœ¬æ¡†çš„å€¼ï¼Œå¹¶è¿”å›ä¸ºæ•´å½¢ï¼Œç„¶åç”¨sprintf(buf, â€œ%.3fâ€, bmi);å°†doubleç±»å‹å€¼è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡SetDlgItemTextå°†å­—ç¬¦ä¸²çš„å€¼è®¾ç½®åˆ°IDä¸ºIDC_EDIT_BMIçš„æ–‡æœ¬æ¡†ä¸Šï¼›\n4.ç¼–è¯‘è¿è¡Œä¼°è®¡å¾ˆå¤šäººä¼šåƒæˆ‘ä¸€æ ·ï¼ŒVS2010ä¼šæŠ¥è¿™æ ·çš„é”™è¯¯ï¼šè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åˆ›å»ºçš„é¡¹ç›®çš„å­—ç¬¦é›†ä¸ºUnicodeï¼Œä¸å…è®¸è¿™æ ·è½¬æ¢ï¼Œè¿™æ—¶æˆ‘ä»¬åªè¦å°†è§£å†³æ–¹æ¡ˆä¸­å³å‡»é¡¹ç›®åâ€œday09â€-&gt;â€œå±æ€§â€-&gt;â€œé…ç½®å±æ€§â€-&gt;â€å¸¸è§„â€-&gt;â€å­—ç¬¦é›†â€-&gt;é€‰æ‹©â€œä½¿ç”¨å¤šå­—èŠ‚å­—ç¬¦é›†â€å°±å¥½äº†ï¼Œå¦‚ä¸‹:è¿™æ—¶å°±å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n5.å…¶ä»–æ–¹æ³•å†æ¬¡ç¼–è¾‘â€œç¡®è®¤â€æŒ‰é’®çš„ç‚¹å‡»æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼›ç¬¬äºŒç§\n12345678910111213141516void Cday08Dlg::OnBnClickedOk()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tTCHAR tcHeight[10], tcWeight[10];\tGetDlgItem(IDC_EDIT_SG)-&gt;GetWindowText(tcHeight,10);\tGetDlgItem(IDC_EDIT_TZ)-&gt;GetWindowText(tcWeight,10);\tint nHeight = _ttoi(tcHeight);\tdouble dHeight = nHeight / 100.00;\tint nWeight = _ttoi(tcWeight);\t\tdouble bmi = nWeight/(dHeight * dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\tGetDlgItem(IDC_EDIT_BMI)-&gt;SetWindowText(buf);&#125;\nå¯ä»¥çœ‹è§ï¼Œè¿™é‡Œç”¨åˆ°äº†GetDlgItem(IDC_EDIT_SG)-&gt;GetWindowText(tcHeight,10)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„è¿‡ç¨‹å°±æ˜¯å…ˆé€šè¿‡GetDlgItem(IDC_EDIT_SG)è·å–åˆ°æ§ä»¶å¯¹è±¡ï¼Œç„¶åè°ƒç”¨æ§ä»¶çš„GetWindowText(tcHeight,10)æ–¹æ³•æ¥è·å–æ§ä»¶çš„æ˜¾ç¤ºæ–‡æœ¬ï¼›\nç¬¬ä¸‰ç§\n123456789101112131415void Cday08Dlg::OnBnClickedOk()&#123;\tTCHAR tcHeight[10], tcWeight[10] , tcBMI[10];\tGetDlgItemText(IDC_EDIT_SG,tcHeight,10);\tGetDlgItemText(IDC_EDIT_TZ,tcWeight,10);\tint nHeight = _ttoi(tcHeight);\tdouble dHeight = nHeight / 100.00;\tint nWeight = _ttoi(tcWeight);\t\tdouble bmi = nWeight/(dHeight * dHeight);\tchar buf[28];\tsprintf(buf, &quot;%.3f&quot;, bmi);\tSetDlgItemText(IDC_EDIT_BMI,buf);&#125;\nå¯ä»¥çœ‹è§ï¼Œè¿™é‡Œç›´æ¥ç”¨åˆ°äº†GetDlgItemText(IDC_EDIT_SG,tcHeight,10)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„è¿‡ç¨‹å°±æ˜¯å…ˆé€šè¿‡GetDlgItem(IDC_EDIT_SG)è·å–åˆ°æ§ä»¶å¯¹è±¡ï¼Œç„¶åè°ƒç”¨æ§ä»¶çš„GetWindowText(tcHeight,10)æ–¹æ³•æ¥è®¾ç½®æ§ä»¶çš„æ˜¾ç¤ºæ–‡æœ¬ï¼›\nè™½ç„¶ä¸Šé¢ä¸‰ç§æ–¹æ³•æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å…¶æœ¬è´¨è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘","slug":"MFC/ç¬¬8èŠ‚-MFCå¯¹è¯æ¡†æ§ä»¶è®¿é—®çš„ä¸ƒç§æ–¹æ³•ï¼ˆä¸Šï¼‰","date":"2017-10-28T15:32:43.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"b83dba6958730d41cfeb66ec4a2f0efa","title":"ç¬¬7èŠ‚ æ¥å§ï¼ŒVS 2010","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬7èŠ‚ æ¥å§ï¼ŒVS 2010VS 2010å¼€å‘ç¬¬ä¸€æ­¥\nå‰é¢å‡ èŠ‚æˆ‘ä»¬éƒ½æ˜¯é‡‡ç”¨VC++ 6.0 ä½œä¸ºIDEï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰ï¼Œä½†æ˜¯ç”±äº**VC++ 6.0 **å·²ç»è¿‡äºè€æ—§ï¼Œç›®å‰å¤§å¤šæ•°ä¼ä¸šå’Œä¸ªäººéƒ½å·²ç»ä¸å†ä½¿ç”¨ï¼Œè€Œé‡‡ç”¨vs2005ï¼Œ vs2008ï¼Œ vs2010ï¼Œvs2015ä½œä¸ºMFCç¨‹åºçš„å¼€å‘ç¯å¢ƒï¼Œvsç›¸å¯¹vc++6.0å…·æœ‰æ›´å‹å¥½çš„ç•Œé¢ï¼ŒåŠæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œé‡‡ç”¨vså¼€å‘MFCåº”ç”¨ç¨‹åºæ›´åŠ å¾—å¿ƒåº”æ‰‹ã€‚\n1ã€å¼€å§‹ä½¿ç”¨VS 20101.1 å®‰è£…VS 2010å‚è§ç™¾åº¦ç™¾ç§‘\n1.2 åˆ›å»ºä¸€ä¸ªåŸºäºå¯¹è¯æ¡†é¡¹ç›®æ‰§è¡Œâ€œæ–‡ä»¶â€-&gt;â€œæ–°å»ºâ€-&gt;â€œé¡¹ç›®â€ï¼Œé€‰æ‹©åŸºäºå¯¹è¯æ¡†çš„MFCç¨‹åºï¼Œå…¶ä»–é»˜è®¤å°±å¥½ï¼ŒåŸºæœ¬ä¸Šå’Œ**VC++ 6.0 **åˆ›å»ºé¡¹ç›®ä¸€æ¨¡ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n1.3 åˆ›å»ºä¸€ä¸ªå­—ç¬¦ç»Ÿè®¡çª—å£ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå°ä¾‹å­æ¥çœ‹çœ‹VS2010åˆ›å»ºMFCç¨‹åºæœ‰ä»€ä¹ˆä¸åŒï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå­—ç¬¦ç»Ÿè®¡çª—å£ï¼Œè¾“å…¥å„ç§å­—ç¬¦ï¼Œæœ€åç»Ÿè®¡å‡ºæ‰€æœ‰å­—ç¬¦ä¸ªæ•°ï¼›è®¾è®¡ç•Œé¢å¦‚ä¸‹ï¼Œä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ï¼Œä¸€ä¸ªâ€œç»Ÿè®¡â€æŒ‰é’®ï¼Œä¸€ä¸ªæ–‡æœ¬æ˜¾ç¤ºâ€œå­—ç¬¦ä¸ªæ•°â€ï¼Œç›´æ¥åœ¨å·¥å…·ç®±ä¸­æ‹–åŠ¨è¿›æ¥å°±OKï¼Œç„¶åæ‹–åŠ¨å¤§å°é€‚ä¸­å°±å¥½ï¼Œæ–¹æ³•åŒ**VC++ 6.0 **æ²¡æœ‰åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒä¸Šå‡ èŠ‚å†…å®¹ã€‚æ³¨æ„: è‹¥æ˜¯å³è¾¹æ²¡æœ‰å·¥å…·ç®±é€‰é¡¹å¡ï¼Œå¯ä»¥é€šè¿‡â€œè§†å›¾â€-&gt;â€œå·¥å…·ç®±â€æ‰“å¼€ã€‚ç¼–è¯‘è¿è¡Œï¼Œæ•ˆæœå›¾ï¼š\n1.3 åˆ›å»ºä¸€ä¸ªå­—ç¬¦ç»Ÿè®¡çª—å£åŒå‡»â€œç»Ÿè®¡â€æŒ‰é’®ï¼Œç¼–è¾‘æŒ‰é’®çš„ç‚¹å‡»å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š\n\n\nè·å–è¾“å…¥æ¡†ä¸­æ–‡æœ¬\nè·å–è¾“å…¥æ¡†ä¸­æ–‡æœ¬çš„å­—ç¬¦ä¸ªæ•°\nå°†å­—ç¬¦ä¸ªæ•°æ˜¾ç¤ºåˆ°é™æ€æ–‡æœ¬ä¸Šæ‰€ä»¥å¤„ç†å‡½æ•°å¦‚ä¸‹ï¼š\n\n\n12345678910void Cday07Dlg::OnBnClickedButtonCount()&#123;\t// TODO: åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tCString strInput,strOutput;\tGetDlgItemText(IDC_EDIT_TEXT,strInput);\tint nCount = strInput.GetLength();\tstrOutput.Format(_T(&quot;å­—ç¬¦ä¸ªæ•°ï¼š%d &quot;),nCount);\tSetDlgItemText(IDC_STATIC_COUNT,strOutput);&#125;\n1.4 ç¼–è¯‘è¿è¡Œè¿è¡Œç»“æœå›¾ï¼šè¿™æ˜¯æˆ‘ä»¬å‘ç°å½“æˆ‘ä»¬è¾“å…¥å®Œæˆæ˜¯ï¼Œè¾“å…¥â€œå›è½¦â€æ—¶ï¼Œç¨‹åºå°±ä¼šç›´æ¥ç»“æŸï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¿®æ”¹è¾“å…¥æ¡†çš„å±æ€§å€¼â€œWant Returnâ€æ¥å…è®¸è¾“å…¥æ¡†æ¥æ¥æ”¶å›è½¦ï¼Œå¦‚å›¾å…¶å®è¿™æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°ç°åœ¨æ–‡æœ¬æ¡†æ˜¯åªèƒ½è¾“å…¥ä¸€è¡Œï¼Œæ˜¾ç„¶ä¸å¤Ÿç¾è§‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†ä¿®æ”¹ä¸€ä¸‹è¾“å…¥æ¡†å±æ€§ï¼š\n\n\nMultilineï¼šå…è®¸å¤šè¡Œ \nHorizontal Scrollï¼šæ°´å¹³æ»šåŠ¨æ¡ \nVertical Scroll:å‚ç›´æ»šåŠ¨æ¡\n\n\nå†æ¬¡ç¼–è¯‘è¿è¡Œï¼šç°åœ¨æ–‡æœ¬æ¡†ç°åœ¨å¯ä»¥è¾“å…¥å¤šè¡Œï¼Œå¹¶ä¸”å¯ä»¥ä»»æ„å›è½¦äº†ã€‚æœ‰äººå¯èƒ½å’Œæˆ‘ä¸€æ ·ï¼Œå‘ç°ç¨‹åºæ²¡æœ‰å…³é—­æŒ‰é’®ï¼Œé‚£æ˜¯å› ä¸ºæˆ‘åœ¨åˆ›å»ºçš„æ—¶å€™å–æ¶ˆäº†ç³»ç»Ÿèœå•ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å®šå¯¹è¯æ¡†ä¸»ç•Œé¢ï¼Œé€‰æ‹©å±æ€§-&gt;system menu-&gt;TRUE:è¿™æ˜¯å…³é—­æŒ‰é’®å°±å‡ºç°äº†ï¼Œå¯ä»¥æ­£å¸¸å…³é—­äº†ã€‚\n2ã€åˆæ¢VSä¸­æ¶ˆæ¯æ˜ å°„æœºåˆ¶2.1 åˆ›å»ºEDITçš„æ¶ˆæ¯å¤„ç†å‡½æ•°å•å‡»é€‰å®šè¾“å…¥æ¡†ï¼Œå³å‡»é€‰æ‹©â€œæ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºâ€ï¼Œè¿™æ˜¯å¯ä»¥å¾ˆç›´è§‚çš„çœ‹è§EDITçš„æ¶ˆæ¯åˆ—è¡¨å’Œè¦æ·»åŠ åˆ°çš„ç±»ï¼Œä»¥åŠæ·»åŠ çš„å¤„ç†å‡½æ•°åï¼Œç°åœ¨æˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸ªEN_CHANGEçš„æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼Œå¦‚å›¾æ‰€ç¤ºï¼šå•å‡»â€œæ·»åŠ ç¼–è¾‘â€æ¥ç¼–è¾‘æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š\n12345678910111213141516void Cday07Dlg::OnEnChangeEditText()&#123;\t// TODO:  å¦‚æœè¯¥æ§ä»¶æ˜¯ RICHEDIT æ§ä»¶ï¼Œå®ƒå°†ä¸\t// å‘é€æ­¤é€šçŸ¥ï¼Œé™¤éé‡å†™ CDialogEx::OnInitDialog()\t// å‡½æ•°å¹¶è°ƒç”¨ CRichEditCtrl().SetEventMask()ï¼Œ\t// åŒæ—¶å°† ENM_CHANGE æ ‡å¿—â€œæˆ–â€è¿ç®—åˆ°æ©ç ä¸­ã€‚\t// TODO:  åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç \tCString strInput,strOutput;\tGetDlgItemText(IDC_EDIT_TEXT,strInput);\tint nCount = strInput.GetLength();\tstrOutput.Format(_T(&quot;å­—ç¬¦ä¸ªæ•°ï¼š%d &quot;),nCount);\tSetDlgItemText(IDC_STATIC_COUNT,strOutput);&#125;\n\n2.2 ç¼–è¯‘è¿è¡Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å­—ç¬¦æ—¶ï¼Œä¸‹æ–¹çš„å­—ç¬¦ç»Ÿè®¡æ•°ä¼šå®æ—¶æ˜¾ç¤ºï¼Œè¿™å°±æ˜¯è¾“å…¥æ–‡æœ¬æ—¶ï¼ŒEDITçš„EN_CHANGEæ¶ˆæ¯è¢«è§¦å‘ï¼Œä»è€Œè§¦å‘å…¶æ¶ˆæ¯å¤„ç†å‡½æ•°OnEnChangeEditTextï¼Œå¯¼è‡´å­—ç¬¦ç»Ÿè®¡æ•°å®æ—¶æ›´æ–°ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n2.3 MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶æµç¨‹12345678st=&gt;start: Startop=&gt;operation: è¾“å…¥æ¡†æ–‡æœ¬å˜åŒ–op2=&gt;operation: è§¦å‘EN_CHANGEæ¶ˆæ¯op3=&gt;operation: è°ƒç”¨EN_CHANGEçš„å¤„ç†å‡½æ•°OnEnChangeEditTextop4=&gt;operation: å°†è¾“å…¥æ¡†å­—ç¬¦æ•°è¿”å›åˆ°ç•Œé¢e=&gt;endst-&gt;op-&gt;op2-&gt;op3-&gt;op4-&gt;e\n\n\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘","slug":"MFC/ç¬¬7èŠ‚-æ¥å§ï¼ŒVS-2010","date":"2017-10-28T15:32:25.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"9179eacff46448e05283197250e564aa","title":"ç¬¬6èŠ‚ VC++6.0æ§ä»¶è¯´æ˜","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬6èŠ‚ VC++6.0æ§ä»¶è¯´æ˜VC++6.0æ§ä»¶å·¥å…·ç®±\n\næ§ä»¶è¯´æ˜\n\n2 å›¾å½¢æ§ä»¶ï¼ˆpictureï¼‰ï¼šå¸¸ç”¨äºæ˜¾ç¤ºä½å›¾ï¼ˆBitmapï¼‰å’Œå›¾æ ‡ï¼ˆIconï¼‰  \n3 é™æ€æ–‡æœ¬ï¼ˆStatic Textï¼‰ï¼šç”¨æ¥åœ¨æŒ‡å®šçš„ä½ç½®æ˜¾ç¤ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬ç”¨æ¥æ ‡è¯†é™„è¿‘å¦ä¸€ä¸ªæ§ä»¶çš„å†…å®¹ã€‚æ˜¾ç¤ºåœ¨é™æ€æ–‡æœ¬æ§ä»¶ä¸­çš„å­—ç¬¦ä¸²ä¸€èˆ¬ä¸å†æ”¹å˜ï¼Œä½†æ˜¯åœ¨éœ€è¦çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ç›¸åº”çš„å‡½æ•°æ¥è¿›è¡Œè®¾ç½®ã€‚MFCæä¾›äº†CStaticç±»æ”¯æŒé™æ€æ§ä»¶ã€‚  \n4 ç¼–è¾‘æ¡†ï¼ˆEdit Boxï¼‰ï¼šç”¨æ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚é€šè¿‡é€‰æ‹©ç¼–è¾‘æ¡†çš„é€‰é¡¹ï¼Œç¼–è¾‘æ¡†å¯ä»¥æ¥æ”¶å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯†ç ç­‰ï¼›ç¼–è¾‘æ¡†è¿˜å¯ä»¥è®¾ç½®æˆæ¥æ”¶å¤šè¡Œå­—ç¬¦ä¸²çš„æ¨¡å¼ï¼›å¯ä»¥è‡ªåŠ¨è¿›è¡Œå¤§å°å†™è½¬æ¢ã€‚ç¼–è¾‘æ¡†å¯èƒ½å‘å…¶çˆ¶çª—å£å‘é€å¤šç§æ§ä»¶é€šçŸ¥ï¼Œå¦‚æœç”¨æˆ·éœ€è¦ï¼Œå¯ä»¥å¯¹è¿™äº›æ§ä»¶é€šçŸ¥è¿›è¡Œå¤„ç†ã€‚MFCæä¾›äº†CEditç±»æ”¯æŒç¼–è¾‘æ¡†æ§ä»¶ã€‚  \n5 ç»„æˆæ¡†ï¼ˆGroup Boxï¼‰ï¼šç”¨æ¥åŒ…å›´å…·æœ‰é€»è¾‘å…³ç³»çš„ä¸€ç»„æ§ä»¶ï¼Œåœ¨è¿™äº›æ§ä»¶çš„å‘¨å›´åŠ ä¸Šè¾¹ç•Œå’Œæ ‡é¢˜ã€‚éœ€æ³¨æ„çš„æ˜¯ï¼Œç»„æˆæ¡†ä»…ä»…æ˜¯åœ¨è§†è§‰æ•ˆæœä¸Šå¯¹æ§ä»¶è¿›è¡Œâ€œæˆç»„â€ï¼ŒçœŸæ­£çš„â€œæˆç»„â€å·¥ä½œè¿˜éœ€è¦å¦å¤–ä¸€äº›å·¥ä½œã€‚ \n6 æŒ‰é’®ï¼ˆButtonï¼‰ï¼šç”¨æ¥æ¥æ”¶ç”¨æˆ·çš„å‘½ä»¤ï¼Œåº”ç”¨ç¨‹åºåœ¨æ¥æ”¶åˆ°ç”¨æˆ·å‘½ä»¤åï¼Œé€šå¸¸éœ€è¦è¿›è¡Œä¸€äº›åå°å·¥ä½œã€‚æŒ‰é’®å¯ä»¥å“åº”å•å‡»æˆ–åŒå‡»åŠ¨ä½œï¼Œåœ¨æŒ‰é’®æ¥æ”¶åˆ°é¼ æ ‡åŠ¨ä½œåï¼Œå‘å…¶çˆ¶çª—å£å‘é€ç›¸åº”çš„æ§ä»¶é€šçŸ¥ï¼Œç”¨æˆ·å¯ä»¥å¯¹è¿™äº›æ§ä»¶é€šçŸ¥è¿›è¡Œæ¶ˆæ¯æ˜ å°„ï¼Œä»è€Œè¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚åœ¨ä¸€ä¸ªå¯¹è¯æ¡†ä¸­ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªé»˜è®¤æŒ‰é’®ï¼Œè¿™åªè¦é€‰ä¸­æŒ‰é’®å±æ€§ä¸­çš„â€œDefaultâ€é€‰é¡¹ã€‚å¦‚æœåœ¨å¯¹è¯æ¡†æ´»åŠ¨çš„æ—¶å€™æŒ‰ä¸‹äº†Enteré”®ï¼Œåˆ™ç­‰åŒäºå•å‡»äº†é»˜è®¤æŒ‰é’®ã€‚MFCæä¾›äº†CButtonç±»æ”¯æŒæŒ‰é’®æ§ä»¶ã€‚\n7 å¤é€‰æ¡†ï¼ˆCheck Boxï¼‰ï¼šç”¨æ¥æ˜¾ç¤ºæŸç§å¯èƒ½çš„é€‰æ‹©ï¼Œè¯¥é¡¹é€‰æ‹©æ˜¯ç‹¬ç«‹çš„ï¼Œç”¨æˆ·å¯ä»¥é€‰ä¸­æˆ–å–æ¶ˆè¯¥é€‰é¡¹ã€‚åœ¨é€‰é¡¹è¢«é€‰ä¸­çš„æ—¶å€™æ ¸é€‰æ ‡è®°å‡ºç°ï¼Œé€‰é¡¹è¢«å–æ¶ˆæ—¶æ ¸é€‰æ ‡è®°æ¶ˆå¤±ã€‚MFCä¸­ç”±CButtonç±»å¯¹æ ¸é€‰æ¡†è¿›è¡Œæ”¯æŒï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡SetCheck()å‡½æ•°å’ŒGetCheck()å‡½æ•°è®¾ç½®æˆ–è·å–æ ¸é€‰æ¡†å½“å‰çš„çŠ¶æ€ã€‚ \n8 å•é€‰æŒ‰é’®ï¼ˆRadio Buttonï¼‰ï¼šç”¨æ¥é€‰æ‹©æŸç§å¯èƒ½çš„é€‰æ‹©ï¼Œä¸æ ¸é€‰æ¡†ä¸åŒï¼Œè¯¥é€‰é¡¹ä¸æ˜¯ç‹¬ç«‹çš„ã€‚ä¸€èˆ¬æ˜¯å‡ ä¸ªå•é€‰æŒ‰é’®ç»„æˆä¸€ç»„ï¼ŒåŒç»„ä¸­çš„å•é€‰æŒ‰é’®å¯ä»¥æœ‰ä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªæŒ‰é’®è¢«é€‰ä¸­ã€‚MFCåŒæ ·ä½¿ç”¨CButtonç±»å¯¹å•é€‰æŒ‰é’®æ§ä»¶è¿›è¡Œæ”¯æŒï¼ŒSetCheck()å‡½æ•°å’ŒGetCheck()å‡½æ•°å¯¹å•é€‰æŒ‰é’®ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚ \n9 ç»„åˆæ¡†ï¼ˆCombo Boxï¼‰ï¼šåˆ—è¡¨æ¡†å’Œç¼–è¾‘æ¡†çš„ç»„åˆï¼Œç”¨æˆ·é™¤äº†å¯ä»¥åœ¨åˆ—è¡¨ä¸­å¯¹å·²ç»å­˜åœ¨çš„é€‰é¡¹è¿›è¡Œé€‰æ‹©å¤–ï¼Œè¿˜å¯ä»¥è¾“å…¥æ–°çš„é€‰æ‹©ã€‚MFCæä¾›äº†CComboBoxç±»å¯¹ç»„åˆæ¡†æ§ä»¶è¿›è¡Œæ”¯æŒã€‚ \n10 åˆ—è¡¨æ¡†ï¼ˆList Boxï¼‰ï¼šç”¨æ¥é€‰æ‹©ä¸€ç³»åˆ—çš„å¯èƒ½é€‰æ‹©ï¼Œç”¨æˆ·é€šè¿‡æ»šåŠ¨æ¡å¯ä»¥åœ¨è¿™äº›é€‰æ‹©ä¸­æµè§ˆã€‚åœ¨åˆ—è¡¨æ¡†ä¸­ï¼Œå¯ä»¥è¿›è¡Œå•é¡¹é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå¤šé¡¹é€‰æ‹©ï¼Œè¿™å–å†³äºç”¨æˆ·åœ¨æ§ä»¶å±æ€§å¯¹è¯æ¡†ä¸­çš„è®¾ç½®ã€‚MFCæä¾›äº†CListBoxç±»å¯¹åˆ—è¡¨æ¡†æ§ä»¶è¿›è¡Œæ”¯æŒã€‚ \n11ã€12 æ»šåŠ¨æ¡ï¼ˆScroll Barï¼‰ï¼šè¿™åŒ…æ‹¬æ°´å¹³æ»šåŠ¨æ¡å’Œå‚ç›´æ»šåŠ¨æ¡ï¼Œé™¤äº†åœ¨è§†è§‰æ•ˆæœä¸Šçš„æ–¹å‘ä¸åŒå¤–ï¼Œæ°´å¹³æ»šåŠ¨æ¡åœ¨è¢«æ»šåŠ¨æ—¶å‘ç”ŸWM_HSCROLLæ¶ˆæ¯ï¼Œè€Œå‚ç›´æ»šåŠ¨æ¡åœ¨è¢«æ»šåŠ¨æ—¶å‘é€WM_VSCROLLæ¶ˆæ¯ã€‚MFCæä¾›äº†CScrollBarè¿›è¡Œæ”¯æŒã€‚ \n13 å¾®è°ƒæŒ‰é’®ï¼ˆSpin Buttonï¼‰ï¼šåŒ…æ‹¬ä¸€å¯¹ç´§é åœ¨ä¸€èµ·çš„ä¸Šä¸‹ç®­å¤´ï¼Œä½¿ç”¨å¾®è°ƒæŒ‰é’®å¯ä»¥å¢å¤§æˆ–è€…ç¼©å°æŸä¸ªç‰¹å®šçš„æ•°å€¼ã€‚å¾®è°ƒæŒ‰é’®å¾€å¾€éƒ½éœ€è¦ä¸€ä¸ªâ€œä¼™ä¼´â€æ§ä»¶ï¼Œè¿™é€šå¸¸éƒ½æ˜¯ä¸€ä¸ªç¼–è¾‘æ¡†ã€‚å½“å¾®è°ƒæŒ‰é’®çš„å‘ä¸Šç®­å¤´è¢«å•å‡»æ—¶ï¼Œç¼–è¾‘æ¡†ä¸­çš„æ•°å­—å°±å¢å¤§ï¼›åä¹‹åˆ™å‡å°ã€‚MFCæä¾›äº†CPinButtonCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n14 è¿›åº¦æ¡ï¼ˆProgressï¼‰ï¼šåœ¨è¿›è¡Œä¸€é¡¹éœ€è¦å æœ‰è¾ƒé•¿æ—¶é—´çš„æ“ä½œæ—¶æ¥ååº”å½“å‰çš„è¿›åº¦ã€‚å½“æ“ä½œçš„è¿›åº¦ä¸æ–­å‰è¿›æ—¶ï¼Œè¿›åº¦æ¡å°±ç”¨ç‰¹è‰²é¢œè‰²å¡«å……è¿›åº¦æ¡æ¡†ã€‚ç”¨æˆ·å¯ä»¥è®¾å®šè¿›åº¦æ¡çš„èŒƒå›´å’Œå½“å‰ä½ç½®ã€‚MFCæä¾›äº†CProgressCtrlç±»è¿›è¡Œæ”¯æŒã€‚ \n15 æ»‘å—æ§ä»¶ï¼ˆSliderï¼‰ï¼šé€šå¸¸ç”¨æ¥åœ¨ç¨‹åºä¸­æ¥å—ä¸€ç³»åˆ—ç¦»æ•£çš„æ•°å€¼ã€‚ç”¨æˆ·å¯ä»¥è®¾ç½®æ»‘å—æ§ä»¶çš„å–å€¼èŒƒå›´ï¼Œå¹¶å¯ä»¥ä¸ºæ§ä»¶åŠ ä¸Šåˆ»åº¦æ ‡è®°ä»¥æ˜¾ç¤ºç‰¹å®šä½ç½®çš„å«ä¹‰ã€‚MFCæä¾›äº†CSliderCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n16 çƒ­é”®æ§åˆ¶ï¼ˆHot Keyï¼‰ï¼šçƒ­é”®æ§ä»¶çœ‹èµ·æ¥å°±åƒä¸€ä¸ªç¼–è¾‘æ¡†ï¼Œä½†æ˜¯åœ¨çƒ­é”®æ§ä»¶ä¸­èƒ½å¤Ÿç«‹åˆ»ååº”ç”¨æˆ·åˆšåˆšæŒ‰ä¸‹çš„é”®ç»„åˆï¼Œè¿™åœ¨è®¾ç½®ç¨‹åºçš„çƒ­é”®æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚çƒ­é”®æ§ä»¶åªæ˜¯åœ¨â€œè§†è§‰â€ä¸Šæ˜¾ç¤ºäº†æŒ‰é”®ç»„åˆï¼Œè®¾ç½®çƒ­é”®çš„å·¥ä½œè¿˜éœ€è¦ç”¨æˆ·æ·»åŠ ä»£ç å®Œæˆã€‚MFCæä¾›äº†CHotKeyç±»è¿›è¡Œæ”¯æŒã€‚ \n17 åˆ—è¡¨æ§åˆ¶ï¼ˆList Controlï¼‰ï¼šæŒ‰ä¸€å®šçš„æ’åˆ—é¡ºåºæ˜¾ç¤ºä¸€ç³»åˆ—å¸¦å›¾æ ‡çš„å­—ç¬¦ä¸²ï¼Œåˆ—è¡¨æ§ä»¶æä¾›äº†å››ç§æ˜¾ç¤ºæ¨¡å¼ï¼šå¤§å›¾æ ‡ã€å°å›¾æ ‡ã€åˆ—è¡¨å’Œè¯¦ç»†ä¿¡æ¯ã€‚ç”¨æˆ·å¯ä»¥å‘åˆ—è¡¨æ§ä»¶ä¸­æ·»åŠ æ–°çš„é¡¹ï¼Œä¹Ÿå¯ä»¥æ§åˆ¶åˆ—è¡¨æ§ä»¶çš„æ˜¾ç¤ºæ¨¡å¼ã€‚MFCæä¾›äº†CListCtrlç±»è¿›è¡Œæ”¯æŒã€‚ \n18 æ ‘å½¢æ§ä»¶ï¼ˆTree Controlï¼‰ï¼šç”¨æ¥æ˜¾ç¤ºä¸€ç³»åˆ—é¡¹ç›®çš„å±‚æ¬¡å…³ç³»ï¼Œæœ€å…¸å‹çš„ä¾‹å­æ˜¯æ˜¾ç¤ºç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸æ–‡ä»¶å¤¹ã€‚å¦‚æœæœ‰å­é¡¹ç›®çš„è¯ï¼Œå•å‡»æ ‘å½¢æ§ä»¶ä¸­çš„é¡¹ç›®å¯ä»¥å±•å¼€æˆ–è€…æ”¶ç¼©å…¶å­é¡¹ç›®ã€‚MFCæä¾›äº†CTreeCtrlç±»è¿›è¡Œæ”¯æŒã€‚ \n19 å±æ€§è¡¨æ§ä»¶ï¼ˆTab Controlï¼‰ï¼šç”¨æ¥åŒ…å«å¤§é‡çš„æ§ä»¶ï¼Œå¯ä»¥æ»¡è¶³ç”¨æˆ·æ˜¾ç¤ºæˆ–è€…è·å–å¤§é‡æ•°æ®çš„è¦æ±‚ã€‚æ¯ä¸ªå±æ€§è¡¨åˆåˆ†ä¸ºå¥½å‡ ä¸ªå±æ€§é¡µï¼Œè¿™äº›å±æ€§é¡µç”±å„è‡ªçš„æ ‡ç­¾è¿›è¡ŒåŒºåˆ†ï¼Œè¿™äº›å±æ€§é¡µä¸­éƒ½å¯ä»¥åŒ…å®¹å…¶ä»–æ§ä»¶ã€‚åœ¨æ˜¾ç¤ºå±æ€§è¡¨çš„æ—¶å€™ï¼Œä¸€æ¬¡åªèƒ½å¤Ÿæ˜¾ç¤ºä¸€ä¸ªå±æ€§é¡µçš„å…¨éƒ¨å†…å®¹ï¼ŒåŒæ—¶æ˜¾ç¤ºå…¶ä»–å±æ€§é¡µçš„æ ‡ç­¾ï¼Œç”¨æˆ·é€šè¿‡å•å‡»æ ‡ç­¾æ‰“å¼€ç›¸åº”çš„å±æ€§é¡µã€‚MFCæä¾›äº†CTabCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n20 åŠ¨ç”»æ§ä»¶ï¼ˆAnimationï¼‰ï¼šç”¨æ¥æ’­æ”¾ä¸€æ®µAVIæ ¼å¼çš„è§†é¢‘å‰ªè¾‘ã€‚ç”¨æˆ·å¯ä»¥æ§åˆ¶è§†é¢‘å‰ªè¾‘çš„æ’­æ”¾ã€åœæ­¢å’Œå®šä½ï¼Œä½†ä¹Ÿä»…é™äºè¿™äº›åŠŸèƒ½ã€‚åŠ¨ç”»æ§ä»¶è®¾ç½®ä¸èƒ½æ’­æ”¾éŸ³é¢‘å‰ªè¾‘ï¼Œå¦‚æœç”¨æˆ·éœ€è¦æ›´é«˜å±‚æ¬¡çš„è§†é¢‘æˆ–è€…éŸ³é¢‘çš„æ”¯æŒï¼Œè¯·é€‰ç”¨MCIWndæ§ä»¶ã€‚MFCæä¾›äº†CAnimateCtrlç±»å¯¹åŠ¨ç”»æ§ä»¶è¿›è¡Œæ”¯æŒã€‚\n21 é«˜çº§ç¼–è¾‘æ¡†ï¼ˆRich Editï¼‰ï¼šç¼–è¾‘æ§ä»¶åŠŸèƒ½çš„æ‰©å±•ã€‚åœ¨é«˜çº§ç¼–è¾‘æ¡†ä¸­ï¼Œé™¤äº†ç®€å•çš„è¾“å…¥å’Œç¼–è¾‘å­—ç¬¦ä¸²å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºå­—ç¬¦æˆ–æ®µè½æŒ‡å®šç‰¹å®šçš„æ ¼å¼ï¼Œç”¨æˆ·ç”šè‡³è¿˜å¯ä»¥å‘é«˜çº§ç¼–è¾‘æ¡†ä¸­æ’å…¥OLEé¡¹ã€‚é«˜çº§ç¼–è¾‘æ¡†åŸºæœ¬ä¸Šå®ç°äº†ä¸€ä¸ªå¸¦æ ¼å¼çš„æ–‡æœ¬ç¼–è¾‘å™¨åŠŸèƒ½ï¼Œè€Œåªéœ€è¦ç”¨æˆ·æ·»åŠ å°‘é‡çš„æ¥å£ã€‚MFCæä¾›äº†CRichEditCtrlç±»è¿›è¡Œæ”¯æŒã€‚ \n22 æ—¥å†æ§ä»¶ï¼ˆMonth Calenderï¼‰ï¼šçœ‹ä¼¼ä¸çœŸæ­£çš„æ—¥å†ç±»ä¼¼ï¼Œæ“ä½œä¹Ÿç±»ä¼¼ï¼Œç›´è§‚çš„ä¸ºç”¨æˆ·æä¾›äº†è§‚å¯Ÿå’Œæ˜¾ç¤ºå½“å‰æ—¥æœŸçš„é€”å¾„ã€‚MFCæä¾›äº†CMonthCalCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n23 æ—¥æœŸ&#x2F;æ—¶é—´é€‰æ‹©å™¨ï¼ˆDate Time Pickerï¼‰ï¼šå‘ç”¨æˆ·æä¾›äº†ä¸€ç§ç›´è§‚çš„é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´çš„æ–¹æ³•ã€æ—¥æœŸ&#x2F;æ—¶é—´é€‰æ‹©å™¨åœ¨å¤–è§‚ä¸Šç±»ä¼¼äºä¸€ä¸ªç»„åˆæ¡†ï¼Œä½†æ˜¯å½“ç”¨æˆ·å•å‡»ä¸‹æ‹‰ç®­å¤´æ—¶å°±ä¼šå±•å¼€ä¸€ä¸ªæ—¥å†æ§ä»¶ä¾›ç”¨æˆ·é€‰æ‹©ï¼Œè€Œä¸€æ—¦ç”¨æˆ·åšå‡ºäº†é€‰æ‹©ï¼Œæ—¥æœŸ&#x2F;æ—¶é—´é€‰æ‹©å™¨ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ–°çš„æ—¥æœŸ&#x2F;æ—¶é—´ã€‚MFCæä¾›äº†CDateTimeCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n24 IPåœ°å€æ§ä»¶ï¼ˆIP Adressï¼‰:IPåœ°å€æ§ä»¶ç”¨æ¥è¾“å…¥å’Œç¼–è¾‘IPåœ°å€ã€‚è¯¥æ§ä»¶å¤–è§‚ç±»ä¼¼äºä¸€ä¸ªç¼–è¾‘æ¡†ï¼Œä½†æ˜¯å¯ä»¥è‡ªåŠ¨å¯¹è¾“å…¥çš„å­—ç¬¦æŒ‰3ä¸ªä¸€ç»„è¿›è¡ŒåŒºåˆ†å’ŒåŠ é—´éš”åœ†ç‚¹ã€‚IPåœ°å€æ§ä»¶ä¸ºå¼€å‘æ”¯æŒInternetæŠ€æœ¯çš„ç¨‹åºæä¾›äº†æ–¹ä¾¿ã€‚MFCæä¾›äº†CIPAddressCtrlç±»è¿›è¡Œæ”¯æŒã€‚\n26 æ‰©å±•ç»„åˆæ¡†ï¼ˆExtended Combo Boxï¼‰ï¼šåœ¨æ™®é€šç»„åˆæ¡†çš„åŸºç¡€ä¸Šè¿˜æ”¯æŒå›¾åƒåˆ—è¡¨ã€‚å³ï¼Œå¯ä»¥åœ¨ç»„åˆæ¡†ä¸­æ˜¾ç¤ºç‰¹å®šçš„å›¾æ ‡è¡¨ç¤ºç›¸åº”çš„é€‰æ‹©ï¼Œè€Œä¸ä»…ä»…æ˜¯æ˜¾ç¤ºæ–‡æœ¬ã€‚MFCæä¾›äº†CComboBoxExç±»è¿›è¡Œæ”¯æŒã€‚\n\n\n\næ‰€æœ‰æ§ä»¶çš„å…¬å…±å±æ€§\nIDï¼šæ§ä»¶çš„èµ„æºæ ‡è¯†ã€‚Visiableï¼šæ§ä»¶æ˜¯å¦å¯è§ã€‚Disabledï¼šæ§ä»¶æ˜¯å¦è¢«ç¦æ­¢ã€è¢«ç¦æ­¢çš„æ§ä»¶æ— æ³•æ¥å—é”®ç›˜å’Œé¼ æ ‡è¾“å…¥ã€‚Groupï¼šæ˜¯å¦ä»è¿™ä¸ªç©ºé—´å¼€å§‹ä¸€ä¸ªæ–°ç»„ã€‚Tab stopï¼šåœ¨ç¨‹åºä¸­æ˜¯å¦å¯ä»¥ç”¨ã€Tabã€‘é”®åˆ‡æ¢åˆ°è¿™ä¸ªæ§ä»¶ã€‚Help IDï¼šæ˜¯å¦ç»™æ§ä»¶åˆ†é…ä¸€ä¸ªå¸®åŠ©æ ‡è¯†ï¼Œå¸®åŠ©æ ‡è¯†åŸºäºæ§ä»¶æœ¬èº«çš„èµ„æºæ ‡è¯†ã€‚Client edgeï¼šç»™æ§ä»¶å¢åŠ ä¸€ä¸ªå‡¹é™·çš„è¾¹ç•Œï¼Œä½¿æ•´ä¸ªæ§ä»¶çœ‹èµ·æ¥åƒæ˜¯å‡¹ä¸‹å»çš„ä¸€æ ·ã€‚Static edgeï¼šç»™æ§ä»¶å¢åŠ ä¸€ä¸ªè¾¹ç•Œã€‚Modal frameï¼šç»™æ§ä»¶å¢åŠ ä¸€ä¸ª3ç»´çš„æ¡†æ¶ï¼Œä¸Client edgeç›¸åï¼Œå®ƒæ˜¯å‡¸å‡ºæ¥çš„ã€‚Transparentï¼šæ‹¥æœ‰æ­¤å±æ€§çš„çª—å£æ˜¯é€æ˜çš„ï¼Œå®ƒä¸‹é¢çš„çª—å£ä¸ä¼šè¢«å®ƒé®æ©ä½ã€‚Accept filesï¼šæ‹¥æœ‰æ­¤å±æ€§çš„çª—å£å¯ä»¥æ¥æ”¶æ‹–æ”¾æ–‡ä»¶ï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶è¢«æ‹–åŠ¨åˆ°è¿™ä¸ªæ§ä»¶ä¸Šé¢ï¼Œæ§ä»¶ä¼šæ”¶åˆ°WM_DROPFILESæ¶ˆæ¯ã€‚No parent notifyï¼šè¡¨ç¤ºæ§ä»¶ä¸å‘å…¶çˆ¶çª—å£å‘é€WM_PARENTNOTIFYæ¶ˆæ¯ã€‚Right aligned textï¼šè¡¨ç¤ºæ–‡æœ¬å³å¯¹é½ã€‚\ntxtä»¥ä¸Šå±æ€§å¯é€šè¿‡æ§ä»¶çš„å±æ€§å¯¹è¯æ¡†è¿›è¡Œè®¾ç½®ï¼Œåœ¨å±æ€§å¯¹è¯æ¡†ä¸­æŒ‰ã€F1ã€‘é”®å¯ä»¥æŸ¥çœ‹å±æ€§çš„å¸®åŠ©ä¿¡æ¯ã€‚æ¯ä¸€ç§æ§ä»¶éƒ½ç”±ä¸€ä¸ªMFCæ§ä»¶ç±»æ¥ç®¡ç†ï¼Œå½“é€šè¿‡èµ„æºç¼–è¾‘å™¨åœ¨å¯¹è¯æ¡†ä¸Šæ·»åŠ ä¸€ä¸ªæ§ä»¶æ—¶ï¼ŒvisualC++ä¼šè‡ªåŠ¨ä¸ºæ§ä»¶ç±»ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œå³å¯¹è±¡ï¼Œå¹¶è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå½“å¯¹è¯æ¡†å…³é—­æ—¶ï¼Œå…¶å„ä¸ªå­æ§ä»¶å¯¹è±¡è¢«è‡ªåŠ¨é”€æ¯ã€‚ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨èµ„æºç¼–è¾‘å™¨ï¼Œè‡ªå·±åœ¨ç¨‹åºä¸­å†™ä»£ç åˆ›å»ºã€æ˜¾ç¤ºæ§ä»¶å¹¶è®¾ç½®æ§ä»¶çš„å±æ€§ã€‚æ‰€æœ‰çš„æ§ä»¶ç±»éƒ½ç»§æ‰¿è‡ªCWndï¼Œæ§ä»¶çš„æŸäº›æ“ä½œå’Œå±æ€§è®¾ç½®éœ€è¦ç”¨åˆ°CWndæœ¬èº«çš„æˆå‘˜å‡½æ•°ï¼ŒCWndæŸäº›å‡½æ•°ç»å¸¸ç”¨æ¥æ“çºµæ§ä»¶å’Œè®¾ç½®æ§ä»¶å±æ€§ã€‚\nSetWindowTextï¼šè®¾ç½®æ§ä»¶ä¸Šè¦æ˜¾ç¤ºçš„æ ‡é¢˜æ–‡æœ¬ï¼Œå³ç”¨æ¥è®¾ç½®æ§ä»¶çš„captionå±æ€§GetWindowTextï¼šå¾—åˆ°æ§ä»¶çš„æ ‡é¢˜æ–‡æœ¬EnableWindowï¼šè®¾ç½®æ§ä»¶çš„Disabledå±æ€§ï¼Œå³ç¤¾ä¼šè‡ªæ§ä»¶æ˜¯å¦å¯ä»¥æ¥æ”¶é”®ç›˜å’Œé¼ æ ‡çš„è¾“å…¥SetWindowPosï¼šæ”¹å˜çª—å£çš„å¤§å°ã€ä½ç½®å’ŒZè½´æ¬¡åºã€‚ MoveWindowï¼šæ”¹å˜çª—å£çš„å¤§å°å’Œä½ç½®GetWindowRecï¼šå¾—åˆ°çª—å£çš„å¤§å°ã€ä½ç½®ï¼ˆä¿¡æ¯å­˜æ”¾åœ¨ä¸€ä¸ªçŸ©å½¢ç»“æ„ä¸­ï¼‰ã€‚GetClientRectï¼šå¾—åˆ°çª—å£å®¢æˆ·åŒºçš„å¤§å°ï¼ˆä¿¡æ¯å­˜æ”¾åœ¨ä¸€ä¸ªçŸ©å½¢ç»“æ„ä¸­ ï¼‰ ShowWindowï¼šè®¾ç½®çª—å£çš„å¯è§æ€§ï¼ˆå³çª—å£æ˜¯å¦å¯è§ï¼‰SetWindowText&#x2F;GetWindowTextè¿˜å¯ä»¥ç”¨æ¥è®¾ç½®&#x2F;å¾—åˆ°å¯¹è¯æ¡†çš„æ ‡é¢˜æ–‡æœ¬ã€‚\n\n\nè½¬è½½Button\næŒ‰é’®çª—å£ï¼ˆæ§ä»¶ï¼‰åœ¨MFCä¸­ä½¿ç”¨CButtonè¡¨ç¤ºï¼ŒCButtonåŒ…å«äº†ä¸‰ç§æ ·å¼çš„æŒ‰é’®ï¼ŒPush Buttonï¼ŒCheck Boxï¼ŒRadio Boxã€‚æ‰€ä»¥åœ¨åˆ©ç”¨CButtonå¯¹è±¡ç”ŸæˆæŒ‰é’®çª—å£æ—¶éœ€è¦æŒ‡æ˜æŒ‰é’®çš„é£æ ¼ã€‚\n\n\nåˆ›å»ºæŒ‰é’®ï¼šBOOL CButton::Create( LPCTSTR lpszCaption, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID );å…¶ä¸­lpszCaptionæ˜¯æŒ‰é’®ä¸Šæ˜¾ç¤ºçš„æ–‡å­—ï¼ŒdwStyleä¸ºæŒ‰é’®é£æ ¼ï¼Œé™¤äº†Windowsé£æ ¼å¯ä»¥ä½¿ç”¨å¤–ï¼ˆå¦‚ WS_CHILD|WS_VISUBLE|WS_BORDERï¼‰è¿˜æœ‰æŒ‰é’®ä¸“ç”¨çš„ä¸€äº›é£æ ¼ã€‚\n\n\nÂ· BS_AUTOCHECKBOX æ£€æŸ¥æ¡†ï¼ŒæŒ‰é’®çš„çŠ¶æ€ä¼šè‡ªåŠ¨æ”¹å˜   Same as a check box, except that a check mark appears in the check box when the user selects the box; the check mark disappears the next time the user selects the box.\n\n\nÂ· BS_AUTORADIOBUTTON åœ†å½¢é€‰æ‹©æŒ‰é’®ï¼ŒæŒ‰é’®çš„çŠ¶æ€ä¼šè‡ªåŠ¨æ”¹å˜   Same as a radio button, except that when the user selects it, the button automatically highlights itself and removes the selection from any other radio buttons with the same style in the same group.\n\n\nÂ· BS_AUTO3STATE å…è®¸æŒ‰é’®æœ‰ä¸‰ç§çŠ¶æ€å³ï¼šé€‰ä¸­ï¼Œæœªé€‰ä¸­ï¼Œæœªå®š   Same as a three-state check box, except that the box changes its state when the user selects it.\n\n\nÂ· BS_CHECKBOX æ£€æŸ¥æ¡†   Creates a small square that has text displayed to its right (unless this style is combined with the BS_LEFTTEXT style).\n\n\nÂ· BS_DEFPUSHBUTTON é»˜è®¤æ™®é€šæŒ‰é’®   Creates a button that has a heavy black border. The user can select this button by pressing the ENTER key. This style enables the user to quickly select the most likely option (the default option).\n\n\nÂ· BS_LEFTTEXT å·¦å¯¹é½æ–‡å­—   When combined with a radio-button or check-box style, the text appears on the left side of the radio button or check box.\n\n\nÂ· BS_OWNERDRAW è‡ªç»˜æŒ‰é’®   Creates an owner-drawn button. The framework calls the DrawItem member function when a visual aspect of the button has changed. This style must be set when using the CBitmapButton class.\n\n\nÂ· BS_PUSHBUTTON æ™®é€šæŒ‰é’®   Creates a pushbutton that posts a WM_COMMAND message to the owner window when the user selects the button.\n\n\nÂ· BS_RADIOBUTTON åœ†å½¢é€‰æ‹©æŒ‰é’®   Creates a small circle that has text displayed to its right (unless this style is combined with the BS_LEFTTEXT style). Radio buttons are usually used in groups of related but mutually exclusive choices.\n\n\nÂ· BS_3STATE å…è®¸æŒ‰é’®æœ‰ä¸‰ç§çŠ¶æ€å³ï¼šé€‰ä¸­ï¼Œæœªé€‰ä¸­ï¼Œæœªå®š   Same as a check box, except that the box can be dimmed as well as checked. The dimmed state typically is used to show that a check box has been disabled.\n\n\nrectä¸ºçª—å£æ‰€å æ®çš„çŸ©å½¢åŒºåŸŸï¼ŒpParentWndä¸ºçˆ¶çª—å£æŒ‡é’ˆï¼ŒnIDä¸ºè¯¥çª—å£çš„IDå€¼ã€‚\n\n\nè·å–&#x2F;æ”¹å˜æŒ‰é’®çŠ¶æ€ï¼šå¯¹äºæ£€æŸ¥æŒ‰é’®å’Œåœ†å½¢æŒ‰é’®å¯èƒ½æœ‰ä¸¤ç§çŠ¶æ€ï¼Œé€‰ä¸­å’Œæœªé€‰ä¸­ï¼Œå¦‚æœè®¾ç½®äº†BS_3STATEæˆ–BS_AUTO3STATEé£æ ¼å°±å¯èƒ½å‡ºç°ç¬¬ä¸‰ç§çŠ¶æ€ï¼šæœªå®šï¼Œè¿™æ—¶æŒ‰é’®æ˜¾ç¤ºç°è‰²ã€‚é€šè¿‡è°ƒç”¨int CButton::GetCheck( ) å¾—åˆ°å½“å‰æ˜¯å¦è¢«é€‰ä¸­ï¼Œè¿”å›0ï¼šæœªé€‰ä¸­ï¼Œ1ï¼šé€‰ä¸­ï¼Œ2ï¼šæœªå®šã€‚è°ƒç”¨void CButton::SetCheck( int nCheck );è®¾ç½®å½“å‰é€‰ä¸­çŠ¶æ€ã€‚\n\n\nå¤„ç†æŒ‰é’®æ¶ˆæ¯ï¼šè¦å¤„ç†æŒ‰é’®æ¶ˆæ¯éœ€è¦åœ¨çˆ¶çª—å£ä¸­è¿›è¡Œæ¶ˆæ¯æ˜ å°„ï¼Œæ˜ å°„å®ä¸ºON_BN_CLICKED( id, memberFxn )idä¸ºæŒ‰é’®çš„IDå€¼ï¼Œå°±æ˜¯åˆ›å»ºæ—¶æŒ‡å®šçš„nIDå€¼ã€‚å¤„ç†å‡½æ•°åŸå‹ä¸ºafx_msg void memberFxn( );\n\nStatic Box\né™æ€æ–‡æœ¬æ§ä»¶çš„åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œå¯ä½œä¸ºæ˜¾ç¤ºå­—ç¬¦ä¸²ï¼Œå›¾æ ‡ï¼Œä½å›¾ç”¨ã€‚åˆ›å»ºä¸€ä¸ªçª—å£å¯ä»¥ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼š BOOL CStatic::Create( LPCTSTR lpszText, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID &#x3D; 0xffff );å…¶ä¸­dwStyleå°†æŒ‡æ˜è¯¥çª—å£çš„é£æ ¼ï¼Œé™¤äº†å­çª—å£å¸¸ç”¨çš„é£æ ¼WS_CHILD,WS_VISIBLEå¤–ï¼Œä½ å¯ä»¥é’ˆå¯¹é™æ€æ§ä»¶æŒ‡æ˜ä¸“é—¨çš„é£æ ¼ã€‚\n\n\nÂ· SS_CENTER,SS_LEFT,SS_RIGHT æŒ‡æ˜å­—ç¬¦æ˜¾ç¤ºçš„å¯¹é½æ–¹å¼ã€‚\n\n\nÂ· SS_GRAYRECT æ˜¾ç¤ºä¸€ä¸ªç°è‰²çš„çŸ©å½¢\n\n\nÂ· SS_NOPREFIX å¦‚æœæŒ‡æ˜è¯¥é£æ ¼ï¼Œå¯¹äºå­—ç¬¦&amp;å°†ç›´æ¥æ˜¾ç¤ºï¼Œå¦åˆ™&amp;å°†ä½œä¸ºè½¬ä¹‰ç¬¦ï¼Œ&amp;å°†ä¸æ˜¾ç¤ºè€Œåœ¨å…¶åçš„å­—ç¬¦å°†æœ‰ä¸‹åˆ’çº¿ï¼Œå¦‚æœéœ€è¦ç›´æ¥æ˜¾ç¤º&amp;å¿…é¡»ä½¿ç”¨&amp;&amp;è¡¨ç¤ºã€‚\n\n\nÂ· SS_BITMAP æ˜¾ç¤ºä½å›¾\n\n\nÂ· SS_ICON æ˜¾ç¤ºå›¾æ ‡\n\n\nÂ· SS_CENTERIMAGE å›¾è±¡å±…ä¸­æ˜¾ç¤º\n\n\næ§åˆ¶æ˜¾ç¤ºçš„æ–‡æœ¬åˆ©ç”¨æˆå‘˜å‡½æ•°SetWindowText&#x2F;GetWindowTextç”¨äºè®¾ç½®&#x2F;å¾—åˆ°å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬ã€‚\n\n\næ§åˆ¶æ˜¾ç¤ºçš„å›¾æ ‡åˆ©ç”¨æˆå‘˜å‡½æ•°SetIcon&#x2F;GetIconç”¨äºè®¾ç½®&#x2F;å¾—åˆ°å½“å‰æ˜¾ç¤ºçš„å›¾æ ‡ã€‚\n\n\næ§åˆ¶æ˜¾ç¤ºçš„ä½å›¾åˆ©ç”¨æˆå‘˜å‡½æ•°SetBitmap&#x2F;GetBitmapç”¨äºè®¾ç½®&#x2F;å¾—åˆ°å½“å‰æ˜¾ç¤ºçš„ä½å›¾ã€‚ä¸‹é¢ä¸€æ®µä»£ç æ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºä½å›¾çš„é™æ€çª—å£å¹¶è®¾ç½®ä½å›¾\n\n\n1CStatic* pstaDis=new CStatic; pstaDis-&gt;Create(&quot;&quot;,WS_CHILD|WS_VISIBLE|SS_BITMAP|SSCENTERIMAGE, CRect(0,0,40,40),pWnd,1); CBitmap bmpLoad; bmpLoad.LoadBitmap(IDB_TEST); pstaDis-&gt;SetBitmap(bmpLoad.Detach());\n\nEdit Box\nEditçª—å£æ˜¯ç”¨æ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥æœ€å¸¸ç”¨çš„ä¸€ä¸ªæ§ä»¶ã€‚åˆ›å»ºä¸€ä¸ªè¾“å…¥çª—å£å¯ä»¥ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼šBOOL CEdit::Create( LPCTSTR lpszText, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID &#x3D; 0xffff );å…¶ä¸­dwStyleå°†æŒ‡æ˜è¯¥çª—å£çš„é£æ ¼ï¼Œé™¤äº†å­çª—å£å¸¸ç”¨çš„é£æ ¼WS_CHILD,WS_VISIBLEå¤–ï¼Œä½ å¯ä»¥é’ˆå¯¹è¾“å…¥æ§ä»¶æŒ‡æ˜ä¸“é—¨çš„é£æ ¼ã€‚\n\n\nÂ· ES_AUTOHSCROLL,ES_AUTOVSCROLL æŒ‡æ˜è¾“å…¥æ–‡å­—è¶…å‡ºæ˜¾ç¤ºèŒƒå›´æ—¶è‡ªåŠ¨æ»šåŠ¨ã€‚\n\n\nÂ· ES_CENTER,ES_LEFT,ES_RIGHT æŒ‡å®šå¯¹é½æ–¹å¼\n\n\nÂ· ES_MULTILINE æ˜¯å¦å…è®¸å¤šè¡Œè¾“å…¥\n\n\nÂ· ES_PASSWORD æ˜¯å¦ä¸ºå¯†ç è¾“å…¥æ¡†ï¼Œå¦‚æœæŒ‡æ˜è¯¥é£æ ¼åˆ™è¾“å…¥çš„æ–‡å­—æ˜¾ç¤ºä¸º*\n\n\nÂ· ES_READONLY æ˜¯å¦ä¸ºåªè¯»\n\n\nÂ· ES_UPPERCASE,ES_LOWERCASE æ˜¾ç¤ºå¤§å†™&#x2F;å°å†™å­—ç¬¦\n\n\næ§åˆ¶æ˜¾ç¤ºçš„æ–‡æœ¬åˆ©ç”¨æˆå‘˜å‡½æ•°SetWindowText&#x2F;GetWindowTextç”¨äºè®¾ç½®&#x2F;å¾—åˆ°å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬ã€‚\n\n\né€šè¿‡GetLimitText&#x2F;SetLimitTextå¯ä»¥å¾—åˆ°&#x2F;è®¾ç½®åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥çš„å­—ç¬¦æ•°é‡ã€‚\n\n\nç”±äºåœ¨è¾“å…¥æ—¶ç”¨æˆ·å¯èƒ½é€‰æ‹©æŸä¸€æ®µæ–‡æœ¬ï¼Œæ‰€ä»¥é€šè¿‡void CEdit::GetSel( int&amp; nStartChar, int&amp; nEndChar )å¾—åˆ°ç”¨æˆ·é€‰æ‹©çš„å­—ç¬¦èŒƒå›´ï¼Œé€šè¿‡è°ƒç”¨void CEdit::SetSel( int nStartChar, int nEndChar, BOOL bNoScroll &#x3D; FALSE )å¯ä»¥è®¾ç½®å½“å‰é€‰æ‹©çš„æ–‡æœ¬èŒƒå›´ï¼Œå¦‚æœæŒ‡å®šnStartChar&#x3D;0 nEndChar&#x3D;-1åˆ™è¡¨ç¤ºé€‰ä¸­æ‰€æœ‰çš„æ–‡æœ¬ã€‚void ReplaceSel( LPCTSTR lpszNewText, BOOL bCanUndo &#x3D; FALSE )å¯ä»¥å°†é€‰ä¸­çš„æ–‡æœ¬æ›¿æ¢ä¸ºæŒ‡å®šçš„æ–‡å­—ã€‚\n\n\næ­¤å¤–è¾“å…¥æ¡†è¿˜æœ‰ä¸€äº›å’Œå‰ªè´´æ¿æœ‰å…³çš„åŠŸèƒ½ï¼Œvoid Clear( );åˆ é™¤é€‰ä¸­çš„æ–‡æœ¬ï¼Œvoid Copy( );å¯å°†é€‰ä¸­çš„æ–‡æœ¬é€å…¥å‰ªè´´æ¿ï¼Œvoid Paste( );å°†å‰ªè´´æ¿ä¸­å†…å®¹æ’å…¥åˆ°å½“å‰è¾“å…¥æ¡†ä¸­å…‰æ ‡ä½ç½®ï¼Œvoid Cut( );ç›¸å½“äºCopyå’ŒClearç»“åˆä½¿ç”¨ã€‚\n\n\næœ€åä»‹ç»ä¸€ä¸‹è¾“å…¥æ¡†å‡ ç§å¸¸ç”¨çš„æ¶ˆæ¯æ˜ å°„å®ï¼š\n\n\nÂ· ON_EN_CHANGE è¾“å…¥æ¡†ä¸­æ–‡å­—æ›´æ–°åäº§ç”Ÿ\n\n\nÂ· ON_EN_ERRSPACE è¾“å…¥æ¡†æ— æ³•åˆ†é…å†…å­˜æ—¶äº§ç”Ÿ\n\n\nÂ· ON_EN_KILLFOCUS &#x2F; ON_EN_SETFOCUS åœ¨è¾“å…¥æ¡†å¤±å»&#x2F;å¾—åˆ°è¾“å…¥ç„¦ç‚¹æ—¶äº§ç”Ÿ\n\n\nä½¿ç”¨ä»¥ä¸Šå‡ ç§æ¶ˆæ¯æ˜ å°„çš„æ–¹æ³•ä¸ºå®šä¹‰åŸå‹å¦‚ï¼šafx_msg void memberFxn( );çš„å‡½æ•°ï¼Œå¹¶ä¸”å®šä¹‰å½¢å¼å¦‚ON_Notification( id, memberFxn )çš„æ¶ˆæ¯æ˜ å°„ã€‚å¦‚æœåœ¨å¯¹è¯æ¡†ä¸­ä½¿ç”¨è¾“å…¥æ¡†ï¼ŒClass Wizardä¼šè‡ªåŠ¨åˆ—å‡ºç›¸å…³çš„æ¶ˆæ¯ï¼Œå¹¶èƒ½è‡ªåŠ¨äº§ç”Ÿæ¶ˆæ¯æ˜ å°„ä»£ç ã€‚\n\nScroll Bar\nScroll Barä¸€èˆ¬ä¸ä¼šå•ç‹¬ä½¿ç”¨ï¼Œå› ä¸ºSpinCtrlå¯ä»¥å–ä»£æ»šåŠ¨æ¡çš„ä¸€éƒ¨åˆ†ä½œç”¨ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦è‡ªå·±ç”Ÿæˆæ´¾ç”Ÿçª—å£ï¼Œæ»šåŠ¨æ¡è¿˜æ˜¯ä¼šæ´¾ä¸Šä¸€äº›ç”¨åœºã€‚åˆ›å»ºä¸€ä¸ªæ»šåŠ¨æ¡å¯ä»¥ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼š ï¼šBOOL CEdit::Create( LPCTSTR lpszText, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID &#x3D; 0xffff );å…¶ä¸­dwStyleå°†æŒ‡æ˜è¯¥çª—å£çš„é£æ ¼ï¼Œé™¤äº†å­çª—å£å¸¸ç”¨çš„é£æ ¼WS_CHILD,WS_VISIBLEå¤–ï¼Œä½ å¯ä»¥é’ˆå¯¹æ»šåŠ¨æ¡æŒ‡æ˜ä¸“é—¨çš„é£æ ¼ã€‚\n\n\nÂ· SBS_VERT é£æ ¼å°†åˆ›å»ºä¸€ä¸ªå‚ç›´çš„æ»šåŠ¨æ¡ã€‚\n\n\nÂ· SBS_HORZ é£æ ¼å°†åˆ›å»ºä¸€ä¸ªæ°´å¹³çš„æ»šåŠ¨æ¡ã€‚\n\n\nåœ¨åˆ›å»ºæ»šåŠ¨æ¡åéœ€è¦è°ƒç”¨void SetScrollRange( int nMinPos, int nMaxPos, BOOL bRedraw &#x3D; TRUE )è®¾ç½®æ»šåŠ¨èŒƒå›´ï¼Œint GetScrollPos( )&#x2F;int SetScrollPos( )ç”¨æ¥å¾—åˆ°å’Œè®¾ç½®å½“å‰æ»šåŠ¨æ¡çš„ä½ç½®ã€‚\n\n\nvoid ShowScrollBar( BOOL bShow &#x3D; TRUE );ç”¨æ¥æ˜¾ç¤º&#x2F;éšè—æ»šåŠ¨æ¡ã€‚\n\n\nBOOL EnableScrollBar( UINT nArrowFlags &#x3D; ESB_ENABLE_BOTH )ç”¨æ¥è®¾ç½®æ»šåŠ¨æ¡ä¸Šç®­å¤´æ˜¯å¦ä¸ºå…è®¸çŠ¶æ€ã€‚nArrowFlagså¯å–ä»¥ä¸‹å€¼ï¼š\n\n\nÂ· ESB_ENABLE_BOTH ä¸¤ä¸ªç®­å¤´éƒ½ä¸ºå…è®¸çŠ¶æ€\n\n\nÂ· ESB_DISABLE_LTUP ä¸Š&#x2F;å·¦ç®­å¤´ä¸ºç¦æ­¢çŠ¶æ€\n\n\nÂ· ESB_DISABLE_RTDN ä¸‹&#x2F;å³ç®­å¤´ä¸ºç¦æ­¢çŠ¶æ€\n\n\nÂ· ESB_DISABLE_BOTH ä¸¤ä¸ªç®­å¤´éƒ½ä¸ºç¦æ­¢çŠ¶æ€\n\n\nå¦‚æœéœ€è¦åœ¨æ»šåŠ¨æ¡ä½ç½®è¢«æ”¹å˜æ—¶å¾—åˆ°é€šçŸ¥ï¼Œéœ€è¦åœ¨çˆ¶çª—å£ä¸­å®šä¹‰å¯¹æ¶ˆæ¯WM_VSCROLL&#x2F;WM_HSCROLLçš„æ˜ å°„ã€‚æ–¹æ³•ä¸ºåœ¨çˆ¶çª—å£ç±»ä¸­é‡è½½afx_msg void OnVScroll( UINT nSBCode, UINT nPos, CScrollBar* pScrollBar )&#x2F;afx_msg void OnHScroll( UINT nSBCode, UINT nPos, CScrollBar* pScrollBar )æ‰€ä½¿ç”¨çš„æ¶ˆæ¯æ˜ å°„å®ä¸ºï¼šON_WM_VSCROLL( ),ON_WM_HSCROLL( )ï¼Œåœ¨æ˜ å°„å®ä¸­ä¸éœ€è¦æŒ‡æ˜æ»šåŠ¨æ¡çš„IDï¼Œå› ä¸ºæ‰€æœ‰æ»šåŠ¨æ¡çš„æ»šåŠ¨æ¶ˆæ¯éƒ½ç”±åŒæ ·çš„å‡½æ•°å¤„ç†ã€‚åœ¨OnHScroll&#x2F;OnVScrollçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼šæŒ‡æ˜å½“å‰æ»šåŠ¨æ¡çš„æŒ‡é’ˆã€‚ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ»šåŠ¨æ¡ä¸Šå‘ç”Ÿçš„åŠ¨ä½œï¼Œå¯å–ä»¥ä¸‹å€¼ï¼š\n\n\nÂ· SB_TOP&#x2F;SB_BOTTOM å·²æ»šåŠ¨åˆ°é¡¶&#x2F;åº•éƒ¨\n\n\nÂ· SB_LINEUP&#x2F;SB_LINEDOWN å‘ä¸Š&#x2F;ä¸‹æ»šåŠ¨ä¸€è¡Œ\n\n\nÂ· SB_PAGEDOWN&#x2F;SB_PAGEUP å‘ä¸Š&#x2F;ä¸‹æ»šåŠ¨ä¸€é¡µ\n\n\nÂ· SB_THUMBPOSITION&#x2F;SB_THUMBTRACK æ»šåŠ¨æ¡æ‹–åŠ¨åˆ°æŸä¸€ä½ç½®ï¼Œå‚æ•°nPosæŒ‡æ˜å½“å‰ä½ç½®ï¼ˆå‚æ•°&gt;nPosåœ¨å…¶å®ƒçš„æƒ…å†µä¸‹æ˜¯æ— æ•ˆçš„ï¼‰\n\n\nÂ· SB_ENDSCROLL æ»šåŠ¨æ¡æ‹–åŠ¨å®Œæˆï¼ˆç”¨æˆ·æ¾å¼€é¼ æ ‡ï¼‰\n\nList Box&#x2F;Check List Box\nListBoxçª—å£ç”¨æ¥åˆ—å‡ºä¸€ç³»åˆ—çš„æ–‡æœ¬ï¼Œæ¯æ¡æ–‡æœ¬å ä¸€è¡Œã€‚åˆ›å»ºä¸€ä¸ªåˆ—è¡¨çª—å£å¯ä»¥ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼šBOOL CListBox::Create( LPCTSTR lpszText, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID &#x3D; 0xffff );å…¶ä¸­dwStyleå°†æŒ‡æ˜è¯¥çª—å£çš„é£æ ¼ï¼Œé™¤äº†å­çª—å£å¸¸ç”¨çš„é£æ ¼WS_CHILD,WS_VISIBLEå¤–ï¼Œä½ å¯ä»¥é’ˆå¯¹åˆ—è¡¨æ§ä»¶æŒ‡æ˜ä¸“é—¨çš„é£æ ¼ã€‚\n\n\nÂ· LBS_MULTIPLESEL æŒ‡æ˜åˆ—è¡¨æ¡†å¯ä»¥åŒæ—¶é€‰æ‹©å¤šè¡Œ\n\n\nÂ· LBS_EXTENDEDSEL å¯ä»¥é€šè¿‡æŒ‰ä¸‹Shift&#x2F;Ctrlé”®é€‰æ‹©å¤šè¡Œ\nÂ· LBS_SORT æ‰€æœ‰çš„è¡ŒæŒ‰ç…§å­—æ¯é¡ºåºè¿›è¡Œæ’åº\nåœ¨åˆ—è¡¨æ¡†ç”Ÿæˆåéœ€è¦å‘å…¶ä¸­åŠ å…¥æˆ–æ˜¯åˆ é™¤è¡Œï¼Œå¯ä»¥åˆ©ç”¨ï¼š  int AddString( LPCTSTR lpszItem )æ·»åŠ è¡Œï¼Œ  intDeleteString( UINT nIndex )åˆ é™¤æŒ‡å®šè¡Œï¼Œ  int InsertString( int nIndex,LPCTSTR lpszItem )å°†è¡Œæ’å…¥åˆ°æŒ‡å®šä½ç½®ã€‚  void ResetContent( )å¯ä»¥åˆ é™¤åˆ—è¡¨æ¡†ä¸­æ‰€æœ‰è¡Œã€‚é€šè¿‡è°ƒç”¨int GetCount( )å¾—åˆ°å½“å‰åˆ—è¡¨æ¡†ä¸­è¡Œçš„æ•°é‡ã€‚\nå¦‚æœéœ€è¦å¾—åˆ°&#x2F;è®¾ç½®å½“å‰è¢«é€‰ä¸­çš„è¡Œï¼Œå¯ä»¥è°ƒç”¨int GetCurSel( )&#x2F;int SetCurSel(intiIndex)ã€‚å¦‚æœä½ æŒ‡æ˜äº†é€‰æ‹©å¤šè¡Œçš„é£æ ¼ï¼Œä½ å°±éœ€è¦å…ˆè°ƒç”¨int GetSelCount( )å¾—åˆ°è¢«é€‰ä¸­çš„è¡Œçš„æ•°é‡ï¼Œç„¶åintGetSelItems( int nMaxItems, LPINT rgIndex)å¾—åˆ°æ‰€æœ‰é€‰ä¸­çš„è¡Œï¼Œå‚æ•°rgIndexä¸ºå­˜æ”¾è¢«é€‰ä¸­è¡Œçš„æ•°ç»„ã€‚é€šè¿‡è°ƒç”¨int GetLBText( int nIndex, LPTSTRlpszText )å¾—åˆ°åˆ—è¡¨æ¡†å†…æŒ‡å®šè¡Œçš„å­—ç¬¦ä¸²ã€‚\næ­¤å¤–é€šè¿‡è°ƒç”¨int FindString( int nStartAfter, LPCTSTR lpszItem)å¯ä»¥åœ¨å½“å‰æ‰€æœ‰è¡Œä¸­æŸ¥æ‰¾æŒ‡å®šçš„å­—ç¬¦ä¼ çš„ä½ç½®ï¼ŒnStartAfteræŒ‡æ˜ä»é‚£ä¸€è¡Œå¼€å§‹è¿›è¡ŒæŸ¥æ‰¾ã€‚  int SelectString( intnStartAfter, LPCTSTR lpszItem )å¯ä»¥é€‰ä¸­åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œã€‚\nåœ¨MFC4.2ç‰ˆæœ¬ä¸­æ·»åŠ äº†CCheckListBoxç±»ï¼Œè¯¥ç±»æ˜¯ç”±CListBoxæ´¾ç”Ÿå¹¶æ‹¥æœ‰CListBoxçš„æ‰€æœ‰åŠŸèƒ½ï¼Œä¸åŒçš„æ˜¯å¯ä»¥åœ¨æ¯è¡Œå‰åŠ ä¸Šä¸€ä¸ªæ£€æŸ¥æ¡†ã€‚å¿…é¡»æ³¨æ„çš„æ˜¯åœ¨åˆ›å»ºæ—¶å¿…é¡»æŒ‡æ˜LBS_OWNERDRAWFIXEDæˆ–LBS_OWNERDRAWVARIABLEé£æ ¼ã€‚\né€šè¿‡void SetCheckStyle( UINT nStyle )&#x2F;UINT GetCheckStyle()å¯ä»¥è®¾ç½®&#x2F;å¾—åˆ°æ£€æŸ¥æ¡†çš„é£æ ¼ï¼Œå…³äºæ£€æŸ¥æ¡†é£æ ¼å¯ä»¥å‚è€ƒ4.1 Buttonä¸­ä»‹ç»ã€‚é€šè¿‡void SetCheck( int nIndex,int nCheck )&#x2F;int GetCheck( int nIndex )å¯ä»¥è®¾ç½®å’Œå¾—åˆ°æŸè¡Œçš„æ£€æŸ¥çŠ¶æ€ï¼Œå…³äºæ£€æŸ¥æ¡†çŠ¶æ€å¯ä»¥å‚è€ƒ4.1Buttonä¸­ä»‹ç»ã€‚\næœ€åä»‹ç»ä¸€ä¸‹åˆ—è¡¨æ¡†å‡ ç§å¸¸ç”¨çš„æ¶ˆæ¯æ˜ å°„å®ï¼š\nÂ· ON_LBN_DBLCLK é¼ æ ‡åŒå‡»\nÂ· ON_EN_ERRSPACE è¾“å…¥æ¡†æ— æ³•åˆ†é…å†…å­˜æ—¶äº§ç”Ÿ\nÂ· ON_EN_KILLFOCUS &#x2F; ON_EN_SETFOCUS åœ¨è¾“å…¥æ¡†å¤±å»&#x2F;å¾—åˆ°è¾“å…¥ç„¦ç‚¹æ—¶äº§ç”Ÿ\nÂ· ON_LBN_SELCHANGE é€‰æ‹©çš„è¡Œå‘ç”Ÿæ”¹å˜\nä½¿ç”¨ä»¥ä¸Šå‡ ç§æ¶ˆæ¯æ˜ å°„çš„æ–¹æ³•ä¸ºå®šä¹‰åŸå‹å¦‚ï¼šafx_msg void memberFxn();çš„å‡½æ•°ï¼Œå¹¶ä¸”å®šä¹‰å½¢å¼å¦‚ON_Notification( id, memberFxn )çš„æ¶ˆæ¯æ˜ å°„ã€‚å¦‚æœåœ¨å¯¹è¯æ¡†ä¸­ä½¿ç”¨åˆ—è¡¨æ¡†ï¼ŒClassWizardä¼šè‡ªåŠ¨åˆ—å‡ºç›¸å…³çš„æ¶ˆæ¯ï¼Œå¹¶èƒ½è‡ªåŠ¨äº§ç”Ÿæ¶ˆæ¯æ˜ å°„ä»£ç ã€‚\n\nCombo Box&#x2F;Combo Box Ex\nç»„åˆçª—å£æ˜¯ç”±ä¸€ä¸ªè¾“å…¥æ¡†å’Œä¸€ä¸ªåˆ—è¡¨æ¡†ç»„æˆã€‚åˆ›å»ºä¸€ä¸ªç»„åˆçª—å£å¯ä»¥ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼š  BOOL CListBox::Create( LPCTSTRlpszText, DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID&#x3D; 0xffff );  å…¶ä¸­dwStyleå°†æŒ‡æ˜è¯¥çª—å£çš„é£æ ¼ï¼Œé™¤äº†å­çª—å£å¸¸ç”¨çš„é£æ ¼WS_CHILD,WS_VISIBLEå¤–ï¼Œä½ å¯ä»¥é’ˆå¯¹åˆ—è¡¨æ§ä»¶æŒ‡æ˜ä¸“é—¨çš„é£æ ¼ã€‚\nÂ· CBS_DROPDOWN ä¸‹æ‹‰å¼ç»„åˆæ¡†\nÂ· CBS_DROPDOWNLIST ä¸‹æ‹‰å¼ç»„åˆæ¡†ï¼Œä½†æ˜¯è¾“å…¥æ¡†å†…ä¸èƒ½è¿›è¡Œè¾“å…¥\nÂ· CBS_SIMPLE è¾“å…¥æ¡†å’Œåˆ—è¡¨æ¡†åŒæ—¶è¢«æ˜¾ç¤º\nÂ· LBS_SORT æ‰€æœ‰çš„è¡ŒæŒ‰ç…§å­—æ¯é¡ºåºè¿›è¡Œæ’åº\nç”±äºç»„åˆæ¡†å†…åŒ…å«äº†åˆ—è¡¨æ¡†ï¼Œæ‰€ä»¥åˆ—è¡¨æ¡†çš„åŠŸèƒ½éƒ½èƒ½å¤Ÿä½¿ç”¨ï¼Œå¦‚å¯ä»¥åˆ©ç”¨ï¼š  int AddString( LPCTSTR lpszItem)æ·»åŠ è¡Œï¼Œ  int DeleteString( UINT nIndex )åˆ é™¤æŒ‡å®šè¡Œï¼Œ  int InsertString( intnIndex, LPCTSTR lpszItem )å°†è¡Œæ’å…¥åˆ°æŒ‡å®šä½ç½®ã€‚  void ResetContent( )å¯ä»¥åˆ é™¤åˆ—è¡¨æ¡†ä¸­æ‰€æœ‰è¡Œã€‚é€šè¿‡è°ƒç”¨int GetCount( )å¾—åˆ°å½“å‰åˆ—è¡¨æ¡†ä¸­è¡Œçš„æ•°é‡ã€‚\nå¦‚æœéœ€è¦å¾—åˆ°&#x2F;è®¾ç½®å½“å‰è¢«é€‰ä¸­çš„è¡Œçš„ä½ç½®ï¼Œå¯ä»¥è°ƒç”¨int GetCurSel( )&#x2F;int SetCurSel(intiIndex)ã€‚é€šè¿‡è°ƒç”¨int GetLBText( int nIndex, LPTSTR lpszText )å¾—åˆ°åˆ—è¡¨æ¡†å†…æŒ‡å®šè¡Œçš„å­—ç¬¦ä¸²ã€‚\næ­¤å¤–é€šè¿‡è°ƒç”¨int FindString( int nStartAfter, LPCTSTR lpszItem)å¯ä»¥åœ¨å½“å‰æ‰€æœ‰è¡Œä¸­æŸ¥æ‰¾æŒ‡å®šçš„å­—ç¬¦ä¼ çš„ä½ç½®ï¼ŒnStartAfteræŒ‡æ˜ä»é‚£ä¸€è¡Œå¼€å§‹è¿›è¡ŒæŸ¥æ‰¾ã€‚  int SelectString( intnStartAfter, LPCTSTR lpszItem )å¯ä»¥é€‰ä¸­åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œã€‚\næ­¤å¤–è¾“å…¥æ¡†çš„åŠŸèƒ½éƒ½èƒ½å¤Ÿä½¿ç”¨ï¼Œå¦‚å¯ä»¥åˆ©ç”¨ï¼š  DWORD GetEditSel( ) &#x2F;BOOL SetEditSel( intnStartChar, int nEndChar )å¾—åˆ°æˆ–è®¾ç½®è¾“å…¥æ¡†ä¸­è¢«é€‰ä¸­çš„å­—ç¬¦ä½ç½®ã€‚  BOOL LimitText( intnMaxChars )è®¾ç½®è¾“å…¥æ¡†ä¸­å¯è¾“å…¥çš„æœ€å¤§å­—ç¬¦æ•°ã€‚  è¾“å…¥æ¡†çš„å‰ªè´´æ¿åŠŸèƒ½Copy,Clear,Cut,PasteåŠ¨å¯ä»¥ä½¿ç”¨ã€‚\næœ€åä»‹ç»ä¸€ä¸‹åˆ—è¡¨æ¡†å‡ ç§å¸¸ç”¨çš„æ¶ˆæ¯æ˜ å°„å®ï¼š\nÂ· ON_CBN_DBLCLK é¼ æ ‡åŒå‡»\nÂ· ON_CBN_DROPDOWN åˆ—è¡¨æ¡†è¢«å¼¹å‡º\nÂ· ON_CBN_KILLFOCUS &#x2F; ON_CBN_SETFOCUS åœ¨è¾“å…¥æ¡†å¤±å»&#x2F;å¾—åˆ°è¾“å…¥ç„¦ç‚¹æ—¶äº§ç”Ÿ\nÂ· ON_CBN_SELCHANGE åˆ—è¡¨æ¡†ä¸­é€‰æ‹©çš„è¡Œå‘ç”Ÿæ”¹å˜\nÂ· ON_CBN_EDITUPDATE è¾“å…¥æ¡†ä¸­å†…å®¹è¢«æ›´æ–°\nä½¿ç”¨ä»¥ä¸Šå‡ ç§æ¶ˆæ¯æ˜ å°„çš„æ–¹æ³•ä¸ºå®šä¹‰åŸå‹å¦‚ï¼šafx_msg void memberFxn();çš„å‡½æ•°ï¼Œå¹¶ä¸”å®šä¹‰å½¢å¼å¦‚ON_Notification( id, memberFxn )çš„æ¶ˆæ¯æ˜ å°„ã€‚å¦‚æœåœ¨å¯¹è¯æ¡†ä¸­ä½¿ç”¨ç»„åˆæ¡†ï¼ŒClassWizardä¼šè‡ªåŠ¨åˆ—å‡ºç›¸å…³çš„æ¶ˆæ¯ï¼Œå¹¶èƒ½è‡ªåŠ¨äº§ç”Ÿæ¶ˆæ¯æ˜ å°„ä»£ç ã€‚\n\nTree Ctrl\næ ‘å½¢æ§ä»¶TreeCtrlå’Œä¸‹èŠ‚è¦è®²çš„åˆ—è¡¨æ§ä»¶ ListCtrlåœ¨ç³»ç»Ÿä¸­å¤§é‡è¢«ä½¿ç”¨ï¼Œä¾‹å¦‚Windowsèµ„æºç®¡ç†å™¨å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚\næ ‘å½¢æ§ä»¶å¯ä»¥ç”¨äºæ ‘å½¢çš„ç»“æ„ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ ¹æ¥ç‚¹(Root)ç„¶åä¸‹é¢æœ‰è®¸å¤šå­ç»“ç‚¹ï¼Œè€Œæ¯ä¸ªå­ç»“ç‚¹ä¸Šæœ‰å…è®¸æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæˆ–æ²¡æœ‰å­ç»“ç‚¹ã€‚MFCä¸­ä½¿ç”¨CTreeCtrlç±»æ¥å°è£…æ ‘å½¢æ§ä»¶çš„å„ç§æ“ä½œã€‚é€šè¿‡è°ƒç”¨BOOL Create( DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINTnID );åˆ›å»ºä¸€ä¸ªçª—å£ï¼ŒdwStyleä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸€äº›æ ‘å½¢æ§ä»¶çš„ä¸“ç”¨é£æ ¼ï¼š\nÂ· TVS_HASLINES åœ¨çˆ¶&#x2F;å­ç»“ç‚¹ä¹‹é—´ç»˜åˆ¶è¿çº¿\nÂ· TVS_LINESATROOT åœ¨æ ¹&#x2F;å­ç»“ç‚¹ä¹‹é—´ç»˜åˆ¶è¿çº¿\nÂ· TVS_HASBUTTONS åœ¨æ¯ä¸€ä¸ªç»“ç‚¹å‰æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œç”¨äºè¡¨ç¤ºå½“å‰ç»“ç‚¹æ˜¯å¦å·²è¢«å±•å¼€\nÂ· TVS_EDITLABELS ç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦å¯ä»¥è¢«ç¼–è¾‘\nÂ· TVS_SHOWSELALWAYS åœ¨å¤±å»ç„¦ç‚¹æ—¶ä¹Ÿæ˜¾ç¤ºå½“å‰é€‰ä¸­çš„ç»“ç‚¹\nÂ· TVS_DISABLEDRAGDROP ä¸å…è®¸Drag&#x2F;Drop\nÂ· TVS_NOTOOLTIPS ä¸ä½¿ç”¨ToolTipæ˜¾ç¤ºç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦\nåœ¨æ ‘å½¢æ§ä»¶ä¸­æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªå¥æŸ„ï¼ˆHTREEITEMï¼‰ï¼ŒåŒæ—¶æ·»åŠ ç»“ç‚¹æ—¶å¿…é¡»æä¾›çš„å‚æ•°æ˜¯è¯¥ç»“ç‚¹çš„çˆ¶ç»“ç‚¹å¥æŸ„ï¼Œï¼ˆå…¶ä¸­æ ¹Rootç»“ç‚¹åªæœ‰ä¸€ä¸ªï¼Œæ—¢ä¸å¯ä»¥æ·»åŠ ä¹Ÿä¸å¯ä»¥åˆ é™¤ï¼‰åˆ©ç”¨HTREEITEM InsertItem( LPCTSTR lpszItem, HTREEITEM hParent &#x3D; TVI_ROOT,HTREEITEM hInsertAfter &#x3D; TVI_LAST);å¯ä»¥æ·»åŠ ä¸€ä¸ªç»“ç‚¹ï¼ŒpszItemä¸ºæ˜¾ç¤ºçš„å­—ç¬¦ï¼ŒhParentä»£è¡¨çˆ¶ç»“ç‚¹çš„å¥æŸ„ï¼Œå½“å‰æ·»åŠ çš„ç»“ç‚¹ä¼šæ’åœ¨hInsertAfterè¡¨ç¤ºçš„ç»“ç‚¹çš„åé¢ï¼Œè¿”å›å€¼ä¸ºå½“å‰åˆ›å»ºçš„ç»“ç‚¹çš„å¥æŸ„ã€‚ä¸‹é¢çš„ä»£ç ä¼šå»ºç«‹ä¸€ä¸ªå¦‚ä¸‹å½¢å¼çš„æ ‘å½¢ç»“æ„ï¼š\n+â€” Parent1 +â€” Child1_1 +â€” Child1_2 +â€” Child1_3 +â€” Parent2 +â€” Parent3 &#x2F;å‡è®¾m_treeä¸ºä¸€ä¸ªCTreeCtrlå¯¹è±¡ï¼Œè€Œä¸”è¯¥çª—å£å·²ç»åˆ›å»º&#x2F; HTREEITEM hItem,hSubItem; hItem &#x3D; m_tree.InsertItem(â€œParent1â€,TVI_ROOT);åœ¨æ ¹ç»“ç‚¹ä¸Šæ·»åŠ Parent1 hSubItem &#x3D; m_tree.InsertItem(â€œChild1_1â€,hItem);&#x2F;&#x2F;åœ¨Parent1ä¸Šæ·»åŠ ä¸€ä¸ªå­ç»“ç‚¹ hSubItem &#x3D;m_tree.InsertItem(â€œChild1_2â€,hItem,hSubItem);&#x2F;&#x2F;åœ¨Parent1ä¸Šæ·»åŠ ä¸€ä¸ªå­ç»“ç‚¹ï¼Œæ’åœ¨Child1_1åé¢ hSubItem &#x3D;m_tree.InsertItem(â€œChild1_3â€,hItem,hSubItem); hItem &#x3D;m_tree.InsertItem(â€œParent2â€,TVI_ROOT,hItem); hItem &#x3D;m_tree.InsertItem(â€œParent3â€,TVI_ROOT,hItem);\nå¦‚æœä½ å¸Œæœ›åœ¨æ¯ä¸ªç»“ç‚¹å‰æ·»åŠ ä¸€ä¸ªå°å›¾æ ‡ï¼Œå°±å¿…éœ€å…ˆè°ƒç”¨CImageList* SetImageList( CImageList *pImageList, int nImageListType);æŒ‡æ˜å½“å‰æ‰€ä½¿ç”¨çš„ImageListï¼ŒnImageListTypeä¸ºTVSIL_NORMALã€‚åœ¨è°ƒç”¨å®Œæˆåæ§ä»¶ä¸­ä½¿ç”¨å›¾ç‰‡ä»¥è®¾ç½®çš„ImageListä¸­å›¾ç‰‡ä¸ºå‡†ã€‚ç„¶åè°ƒç”¨  HTREEITEM InsertItem( LPCTSTR lpszItem, intnImage, int nSelectedImage, HTREEITEM hParent &#x3D; TVI_ROOT, HTREEITEMhInsertAfter &#x3D;TVI_LAST);æ·»åŠ ç»“ç‚¹ï¼ŒnImageä¸ºç»“ç‚¹æ²¡è¢«é€‰ä¸­æ—¶æ‰€ä½¿ç”¨å›¾ç‰‡åºå·ï¼ŒnSelectedImageä¸ºç»“ç‚¹è¢«é€‰ä¸­æ—¶æ‰€ä½¿ç”¨å›¾ç‰‡åºå·ã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ImageListçš„è®¾ç½®ã€‚\n&#x2F;m_list ä¸ºCImageListå¯¹è±¡ IDB_TREE ä¸º16(164)çš„ä½å›¾ï¼Œæ¯ä¸ªå›¾ç‰‡ä¸º1616å…±4ä¸ªå›¾æ ‡*&#x2F;m_list.Create(IDB_TREE,16,4,RGB(0,0,0));m_tree.SetImageList(&amp;m_list,TVSIL_NORMAL);m_tree.InsertItem(â€œParent1â€,0,1); &#x2F;&#x2F;æ·»åŠ ï¼Œé€‰ä¸­æ—¶æ˜¾ç¤ºå›¾æ ‡1ï¼Œæœªé€‰ä¸­æ—¶æ˜¾ç¤ºå›¾æ ‡0\næ­¤å¤–CTreeCtrlè¿˜æä¾›äº†ä¸€äº›å‡½æ•°ç”¨äºå¾—åˆ°&#x2F;ä¿®æ”¹æ§ä»¶çš„çŠ¶æ€ã€‚  HTREEITEM GetSelectedItem();å°†è¿”å›å½“å‰é€‰ä¸­çš„ç»“ç‚¹çš„å¥æŸ„ã€‚BOOL SelectItem( HTREEITEM hItem );å°†é€‰ä¸­æŒ‡æ˜ç»“ç‚¹ã€‚  BOOLGetItemImage( HTREEITEM hItem, int&amp; nImage, int&amp; nSelectedImage ) &#x2F;BOOL SetItemImage( HTREEITEM hItem, int nImage, int nSelectedImage)ç”¨äºå¾—åˆ°&#x2F;ä¿®æ”¹æŸç»“ç‚¹æ‰€ä½¿ç”¨å›¾æ ‡ç´¢å¼•ã€‚  CString GetItemText( HTREEITEM hItem ) &#x2F;BOOLSetItemText( HTREEITEM hItem, LPCTSTR lpszItem );ç”¨äºå¾—åˆ°&#x2F;ä¿®æ”¹æŸä¸€ç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦ã€‚BOOL DeleteItem( HTREEITEM hItem );ç”¨äºåˆ é™¤æŸä¸€ç»“ç‚¹ï¼ŒBOOL DeleteAllItems();å°†åˆ é™¤æ‰€æœ‰ç»“ç‚¹ã€‚\næ­¤å¤–å¦‚æœæƒ³éå†æ ‘å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°ï¼š  HTREEITEM GetRootItem( );å¾—åˆ°æ ¹ç»“ç‚¹ã€‚  HTREEITEMGetChildItem( HTREEITEM hItem );å¾—åˆ°å­ç»“ç‚¹ã€‚  HTREEITEMGetPrevSiblingItem&#x2F;GetNextSiblingItem( HTREEITEM hItem);å¾—åˆ°æŒ‡æ˜ç»“ç‚¹çš„ä¸Š&#x2F;ä¸‹ä¸€ä¸ªå…„å¼Ÿç»“ç‚¹ã€‚  HTREEITEM GetParentItem( HTREEITEM hItem );å¾—åˆ°çˆ¶ç»“ç‚¹ã€‚\næ ‘å½¢æ§ä»¶çš„æ¶ˆæ¯æ˜ å°„ä½¿ç”¨ON_NOTIFYå®ï¼Œå½¢å¼å¦‚åŒï¼šON_NOTIFY( wNotifyCode, id, memberFxn)ï¼ŒwNotifyCodeä¸ºé€šçŸ¥ä»£ç ï¼Œidä¸ºäº§ç”Ÿè¯¥æ¶ˆæ¯çš„çª—å£IDï¼ŒmemberFxnä¸ºå¤„ç†å‡½æ•°ï¼Œå‡½æ•°çš„åŸå‹å¦‚åŒvoidOnXXXTree(NMHDR* pNMHDR, LRESULT*pResult)ï¼Œå…¶ä¸­pNMHDRä¸ºä¸€æ•°æ®ç»“æ„ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶éœ€è¦è½¬æ¢æˆå…¶ä»–ç±»å‹çš„ç»“æ„ã€‚å¯¹äºæ ‘å½¢æ§ä»¶å¯èƒ½å–å€¼å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ä¸ºï¼š\nÂ· TVN_SELCHANGED åœ¨æ‰€é€‰ä¸­çš„ç»“ç‚¹å‘ç”Ÿæ”¹å˜åå‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMTREEVIEW\nÂ· TVN_ITEMEXPANDED åœ¨æŸç»“ç‚¹è¢«å±•å¼€åå‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMTREEVIEW\nÂ· TVN_BEGINLABELEDIT åœ¨å¼€å§‹ç¼–è¾‘ç»“ç‚¹å­—ç¬¦æ—¶å‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMTVDISPINFO\nÂ· TVN_ENDLABELEDIT åœ¨ç»“æŸç¼–è¾‘ç»“ç‚¹å­—ç¬¦æ—¶å‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMTVDISPINFO\nÂ· TVN_GETDISPINFO åœ¨éœ€è¦å¾—åˆ°æŸç»“ç‚¹ä¿¡æ¯æ—¶å‘é€ï¼Œï¼ˆå¦‚å¾—åˆ°ç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦ï¼‰æ‰€ç”¨ç»“æ„ï¼šNMTVDISPINFO\nå…³äºON_NOTIFYæœ‰å¾ˆå¤šå†…å®¹ï¼Œå°†åœ¨ä»¥åçš„å†…å®¹ä¸­è¿›è¡Œè¯¦ç»†è®²è§£ã€‚\nå…³äºåŠ¨æ€æä¾›ç»“ç‚¹æ‰€æ˜¾ç¤ºçš„å­—ç¬¦ï¼šé¦–å…ˆä½ åœ¨æ·»åŠ ç»“ç‚¹æ—¶éœ€è¦æŒ‡æ˜lpszItemå‚æ•°ä¸ºï¼šLPSTR_TEXTCALLBACKã€‚åœ¨æ§ä»¶æ˜¾ç¤ºè¯¥ç»“ç‚¹æ—¶ä¼šé€šè¿‡å‘é€TVN_GETDISPINFOæ¥å–å¾—æ‰€éœ€è¦çš„å­—ç¬¦ï¼Œåœ¨å¤„ç†è¯¥æ¶ˆæ¯æ—¶å…ˆå°†å‚æ•°pNMHDRè½¬æ¢ä¸ºLPNMTVDISPINFOï¼Œç„¶åå¡«å……å…¶ä¸­item.pszTextã€‚ä½†æ˜¯æˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ¥çŸ¥é“è¯¥ç»“ç‚¹æ‰€å¯¹åº”çš„ä¿¡æ¯å‘¢ï¼Œæˆ‘çš„åšæ³•æ˜¯åœ¨æ·»åŠ ç»“ç‚¹åè®¾ç½®å…¶lParamå‚æ•°ï¼Œç„¶ååœ¨æä¾›ä¿¡æ¯æ—¶åˆ©ç”¨è¯¥å‚æ•°æ¥æŸ¥æ‰¾æ‰€å¯¹åº”çš„ä¿¡æ¯ã€‚ä¸‹é¢çš„ä»£ç è¯´æ˜äº†è¿™ç§æ–¹æ³•ï¼š\nchar szOut[8][3]&#x3D;{â€œNo.1â€,â€No.2â€,â€No.3â€}; &#x2F;&#x2F;æ·»åŠ ç»“ç‚¹ HTREEITEM hItem &#x3D;m_tree.InsertItem(LPSTR_TEXTCALLBACK,â€¦) m_tree.SetItemData(hItem, 0); hItem &#x3D; m_tree.InsertItem(LPSTR_TEXTCALLBACK,â€¦)m_tree.SetItemData(hItem, 1 ); &#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ voidCParentWnd::OnGetDispInfoTree(NMHDR* pNMHDR, LRESULT* pResult) {TV_DISPINFO* pTVDI &#x3D; (TV_DISPINFO*)pNMHDR;pTVDI-&gt;item.pszText&#x3D;szOut[pTVDI-&gt;item.lParam];&#x2F;&#x2F;é€šè¿‡lParamå¾—åˆ°éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦åœ¨æ•°ç»„ä¸­çš„ä½ç½® *pResult &#x3D; 0; }\nå…³äºç¼–è¾‘ç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦ï¼šé¦–å…ˆéœ€è¦è®¾ç½®æ ‘å½¢æ§ä»¶çš„TVS_EDITLABELSé£æ ¼ï¼Œåœ¨å¼€å§‹ç¼–è¾‘æ—¶è¯¥æ§ä»¶å°†ä¼šå‘é€TVN_BEGINLABELEDITï¼Œä½ å¯ä»¥é€šè¿‡åœ¨å¤„ç†å‡½æ•°ä¸­è¿”å›TRUEæ¥å–æ¶ˆæ¥ä¸‹æ¥çš„ç¼–è¾‘ï¼Œåœ¨ç¼–è¾‘å®Œæˆåä¼šå‘é€TVN_ENDLABELEDITï¼Œåœ¨å¤„ç†è¯¥æ¶ˆæ¯æ—¶éœ€è¦å°†å‚æ•°pNMHDRè½¬æ¢ä¸ºLPNMTVDISPINFOï¼Œç„¶åé€šè¿‡å…¶ä¸­çš„item.pszTextå¾—åˆ°ç¼–è¾‘åçš„å­—ç¬¦ï¼Œå¹¶é‡ç½®æ˜¾ç¤ºå­—ç¬¦ã€‚å¦‚æœç¼–è¾‘åœ¨ä¸­é€”ä¸­å–æ¶ˆè¯¥å˜é‡ä¸ºNULLã€‚ä¸‹é¢çš„ä»£ç è¯´æ˜å¦‚ä½•å¤„ç†è¿™äº›æ¶ˆæ¯ï¼š\n&#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ TVN_BEGINLABELEDIT void CParentWnd::OnBeginEditTree(NMHDR*pNMHDR, LRESULT* pResult) { TV_DISPINFO* pTVDI &#x3D; (TV_DISPINFO*)pNMHDR;if(pTVDI-&gt;item.lParam&#x3D;&#x3D;0);&#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦å–æ¶ˆè¯¥æ“ä½œ pResult &#x3D; 1; else pResult &#x3D; 0;} &#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ TVN_BEGINLABELEDIT void CParentWnd::OnBeginEditTree(NMHDRpNMHDR, LRESULT pResult) { TV_DISPINFO* pTVDI &#x3D; (TV_DISPINFO*)pNMHDR;if(pTVDI-&gt;item.pszText&#x3D;&#x3D;NULL);&#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦å·²ç»å–æ¶ˆå–æ¶ˆç¼–è¾‘m_tree.SetItemText(pTVDI-&gt;item.hItem,pTVDI-&gt;pszText); &#x2F;&#x2F;é‡ç½®æ˜¾ç¤ºå­—ç¬¦*pResult &#x3D; 0; }\nä¸Šé¢è®²è¿°çš„æ–¹æ³•æ‰€è¿›è¡Œçš„æ¶ˆæ¯æ˜ å°„å¿…é¡»åœ¨çˆ¶çª—å£ä¸­è¿›è¡Œï¼ˆåŒæ ·WM_NOTIFYçš„æ‰€æœ‰æ¶ˆæ¯éƒ½éœ€è¦åœ¨çˆ¶çª—å£ä¸­å¤„ç†ï¼‰ã€‚\n\nList Ctrl\nåˆ—è¡¨æ§ä»¶å¯ä»¥çœ‹ä½œæ˜¯åŠŸèƒ½å¢å¼ºçš„ListBoxï¼Œå®ƒæä¾›äº†å››ç§é£æ ¼ï¼Œè€Œä¸”å¯ä»¥åŒæ—¶æ˜¾ç¤ºä¸€åˆ—çš„å¤šä¸­å±æ€§å€¼ã€‚MFCä¸­ä½¿ç”¨CListCtrlç±»æ¥å°è£…åˆ—è¡¨æ§ä»¶çš„å„ç§æ“ä½œã€‚é€šè¿‡è°ƒç”¨BOOL Create( DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINTnID );åˆ›å»ºä¸€ä¸ªçª—å£ï¼ŒdwStyleä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸€äº›åˆ—è¡¨æ§ä»¶çš„ä¸“ç”¨é£æ ¼ï¼š\nÂ· LVS_ICON LVS_SMALLICON LVS_LIST LVS_REPORTè¿™å››ç§é£æ ¼å†³å®šæ§ä»¶çš„å¤–è§‚ï¼ŒåŒæ—¶åªå¯ä»¥é€‰æ‹©å…¶ä¸­ä¸€ç§ï¼Œåˆ†åˆ«å¯¹åº”ï¼šå¤§å›¾æ ‡æ˜¾ç¤ºï¼Œå°å›¾æ ‡æ˜¾ç¤ºï¼Œåˆ—è¡¨æ˜¾ç¤ºï¼Œè¯¦ç»†æŠ¥è¡¨æ˜¾ç¤º\nÂ· LVS_EDITLABELS ç»“ç‚¹çš„æ˜¾ç¤ºå­—ç¬¦å¯ä»¥è¢«ç¼–è¾‘ï¼Œå¯¹äºæŠ¥è¡¨é£æ ¼æ¥è®²å¯ç¼–è¾‘çš„åªä¸ºç¬¬ä¸€åˆ—ã€‚\nÂ· LVS_SHOWSELALWAYS åœ¨å¤±å»ç„¦ç‚¹æ—¶ä¹Ÿæ˜¾ç¤ºå½“å‰é€‰ä¸­çš„ç»“ç‚¹\nÂ· LVS_SINGLESEL åŒæ—¶åªèƒ½é€‰ä¸­åˆ—è¡¨ä¸­ä¸€é¡¹\né¦–å…ˆä½ éœ€è¦è®¾ç½®åˆ—è¡¨æ§ä»¶æ‰€ä½¿ç”¨çš„ImageListï¼Œå¦‚æœä½ ä½¿ç”¨å¤§å›¾æ ‡æ˜¾ç¤ºé£æ ¼ï¼Œä½ å°±éœ€è¦ä»¥å¦‚ä¸‹å½¢å¼è°ƒç”¨ï¼š  CImageList*SetImageList( CImageList* pImageList, LVSIL_NORMAL);å¦‚æœä½¿ç”¨å…¶å®ƒä¸‰ç§é£æ ¼æ˜¾ç¤ºè€Œä¸æƒ³æ˜¾ç¤ºå›¾æ ‡ä½ å¯ä»¥ä¸è¿›è¡Œä»»ä½•è®¾ç½®ï¼Œå¦åˆ™éœ€è¦ä»¥å¦‚ä¸‹å½¢å¼è°ƒç”¨ï¼š  CImageList* SetImageList(CImageList* pImageList, LVSIL_SMALL);\né€šè¿‡è°ƒç”¨ int InsertItem( int nItem, LPCTSTR lpszItem);å¯ä»¥åœ¨åˆ—è¡¨æ§ä»¶ä¸­nItemæŒ‡æ˜ä½ç½®æ’å…¥ä¸€é¡¹ï¼ŒlpszItemä¸ºæ˜¾ç¤ºå­—ç¬¦ã€‚é™¤LVS_REPORTé£æ ¼å¤–å…¶ä»–ä¸‰ç§é£æ ¼éƒ½åªéœ€è¦ç›´æ¥è°ƒç”¨InsertItemå°±å¯ä»¥äº†ï¼Œä½†å¦‚æœä½¿ç”¨æŠ¥è¡¨é£æ ¼å°±å¿…é¡»å…ˆè®¾ç½®åˆ—è¡¨æ§ä»¶ä¸­çš„åˆ—ä¿¡æ¯ã€‚\né€šè¿‡è°ƒç”¨ int InsertColumn( int nCol, LPCTSTR lpszColumnHeading, intnFormat , int nWidth, intnSubItem);å¯ä»¥æ’å…¥åˆ—ã€‚iColä¸ºåˆ—çš„ä½ç½®ï¼Œä»é›¶å¼€å§‹ï¼ŒlpszColumnHeadingä¸ºæ˜¾ç¤ºçš„åˆ—åï¼ŒnFormatä¸ºæ˜¾ç¤ºå¯¹é½æ–¹å¼ï¼ŒnWidthä¸ºæ˜¾ç¤ºå®½åº¦ï¼ŒnSubItemä¸ºåˆ†é…ç»™è¯¥åˆ—çš„åˆ—ç´¢å¼•ã€‚\nåœ¨æœ‰å¤šåˆ—çš„åˆ—è¡¨æ§ä»¶ä¸­å°±éœ€è¦ä¸ºæ¯ä¸€é¡¹æŒ‡æ˜å…¶åœ¨æ¯ä¸€åˆ—ä¸­çš„æ˜¾ç¤ºå­—ç¬¦ï¼Œé€šè¿‡è°ƒç”¨  BOOL SetItemText( int nItem, intnSubItem, LPTSTR lpszText);å¯ä»¥è®¾ç½®æ¯åˆ—çš„æ˜¾ç¤ºå­—ç¬¦ã€‚nItemä¸ºè®¾ç½®çš„é¡¹çš„ä½ç½®ï¼ŒnSubItemä¸ºåˆ—ä½ç½®ï¼ŒlpszTextä¸ºæ˜¾ç¤ºå­—ç¬¦ã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•è®¾ç½®å¤šåˆ—å¹¶æ’å…¥æ•°æ®ï¼š\nm_list.SetImageList(&amp;m_listSmall,LVSIL_SMALL);&#x2F;&#x2F;è®¾ç½®ImageListm_list.InsertColumn(0,â€Col 1â€,LVCFMT_LEFT,300,0);&#x2F;&#x2F;è®¾ç½®åˆ—m_list.InsertColumn(1,â€Col 2â€,LVCFMT_LEFT,300,1);m_list.InsertColumn(2,â€Col 3â€,LVCFMT_LEFT,300,2);m_list.InsertItem(0,â€Item 1_1â€);&#x2F;&#x2F;æ’å…¥è¡Œ m_list.SetItemText(0,1,â€Item1_2â€);&#x2F;&#x2F;è®¾ç½®è¯¥è¡Œçš„ä¸åŒåˆ—çš„æ˜¾ç¤ºå­—ç¬¦ m_list.SetItemText(0,2,â€Item 1_3â€);\næ­¤å¤–CListCtrlè¿˜æä¾›äº†ä¸€äº›å‡½æ•°ç”¨äºå¾—åˆ°&#x2F;ä¿®æ”¹æ§ä»¶çš„çŠ¶æ€ã€‚  COLORREF GetTextColor( )&#x2F;BOOLSetTextColor( COLORREF cr );ç”¨äºå¾—åˆ°&#x2F;è®¾ç½®æ˜¾ç¤ºçš„å­—ç¬¦é¢œè‰²ã€‚  COLORREF GetTextBkColor()&#x2F;BOOL SetTextBkColor( COLORREF cr );ç”¨äºå¾—åˆ°&#x2F;è®¾ç½®æ˜¾ç¤ºçš„èƒŒæ™¯é¢œè‰²ã€‚  voidSetItemCount( int iCount );ç”¨äºå¾—åˆ°æ·»åŠ è¿›åˆ—è¡¨ä¸­é¡¹çš„æ•°é‡ã€‚  BOOL DeleteItem(intnItem);ç”¨äºåˆ é™¤æŸä¸€é¡¹ï¼ŒBOOL DeleteAllItems( );å°†åˆ é™¤æ‰€æœ‰é¡¹ã€‚  BOOL SetBkImage(HBITMAPhbm, BOOL fTile , int xOffsetPercent, int yOffsetPercent);ç”¨äºè®¾ç½®èƒŒæ™¯ä½å›¾ã€‚CString GetItemText( int nItem, int nSubItem );ç”¨äºå¾—åˆ°æŸé¡¹çš„æ˜¾ç¤ºå­—ç¬¦ã€‚\nåˆ—è¡¨æ§ä»¶çš„æ¶ˆæ¯æ˜ å°„åŒæ ·ä½¿ç”¨ON_NOTIFYå®ï¼Œå½¢å¼å¦‚åŒï¼šON_NOTIFY( wNotifyCode, id, memberFxn)ï¼ŒwNotifyCodeä¸ºé€šçŸ¥ä»£ç ï¼Œidä¸ºäº§ç”Ÿè¯¥æ¶ˆæ¯çš„çª—å£IDï¼ŒmemberFxnä¸ºå¤„ç†å‡½æ•°ï¼Œå‡½æ•°çš„åŸå‹å¦‚åŒvoidOnXXXList(NMHDR* pNMHDR, LRESULT*pResult)ï¼Œå…¶ä¸­pNMHDRä¸ºä¸€æ•°æ®ç»“æ„ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶éœ€è¦è½¬æ¢æˆå…¶ä»–ç±»å‹çš„ç»“æ„ã€‚å¯¹äºåˆ—è¡¨æ§ä»¶å¯èƒ½å–å€¼å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ä¸ºï¼š\nÂ· LVN_BEGINLABELEDIT åœ¨å¼€å§‹æŸé¡¹ç¼–è¾‘å­—ç¬¦æ—¶å‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMLVDISPINFO\nÂ· LVN_ENDLABELEDIT åœ¨ç»“æŸæŸé¡¹ç¼–è¾‘å­—ç¬¦æ—¶å‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMLVDISPINFO\nÂ· LVN_GETDISPINFO åœ¨éœ€è¦å¾—åˆ°æŸé¡¹ä¿¡æ¯æ—¶å‘é€ï¼Œï¼ˆå¦‚å¾—åˆ°æŸé¡¹çš„æ˜¾ç¤ºå­—ç¬¦ï¼‰æ‰€ç”¨ç»“æ„ï¼šNMLVDISPINFO\nå…³äºON_NOTIFYæœ‰å¾ˆå¤šå†…å®¹ï¼Œå°†åœ¨ä»¥åçš„å†…å®¹ä¸­è¿›è¡Œè¯¦ç»†è®²è§£ã€‚\nå…³äºåŠ¨æ€æä¾›ç»“ç‚¹æ‰€æ˜¾ç¤ºçš„å­—ç¬¦ï¼šé¦–å…ˆä½ åœ¨é¡¹æ—¶éœ€è¦æŒ‡æ˜lpszItemå‚æ•°ä¸ºï¼šLPSTR_TEXTCALLBACKã€‚åœ¨æ§ä»¶æ˜¾ç¤ºè¯¥ç»“ç‚¹æ—¶ä¼šé€šè¿‡å‘é€TVN_GETDISPINFOæ¥å–å¾—æ‰€éœ€è¦çš„å­—ç¬¦ï¼Œåœ¨å¤„ç†è¯¥æ¶ˆæ¯æ—¶å…ˆå°†å‚æ•°pNMHDRè½¬æ¢ä¸ºLPNMLVDISPINFOï¼Œç„¶åå¡«å……å…¶ä¸­item.pszTextã€‚é€šè¿‡itemä¸­çš„iItem,iSubItemå¯ä»¥çŸ¥é“å½“å‰æ˜¾ç¤ºçš„ä¸ºé‚£ä¸€é¡¹ã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†è¿™ç§æ–¹æ³•ï¼š\nchar szOut[8][3]&#x3D;{â€œNo.1â€,â€No.2â€,â€No.3â€}; &#x2F;&#x2F;æ·»åŠ ç»“ç‚¹m_list.InsertItem(LPSTR_TEXTCALLBACK,â€¦)m_list.InsertItem(LPSTR_TEXTCALLBACK,â€¦) &#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ voidCParentWnd::OnGetDispInfoList(NMHDR* pNMHDR, LRESULT* pResult) {LV_DISPINFO* pLVDI &#x3D; (LV_DISPINFO*)pNMHDR;pLVDI-&gt;item.pszText&#x3D;szOut[pTVDI-&gt;item.iItem];&#x2F;&#x2F;é€šè¿‡iItemå¾—åˆ°éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦åœ¨æ•°ç»„ä¸­çš„ä½ç½® *pResult &#x3D; 0; }\nå…³äºç¼–è¾‘æŸé¡¹çš„æ˜¾ç¤ºå­—ç¬¦ï¼šï¼ˆåœ¨æŠ¥è¡¨é£æ ¼ä¸­åªå¯¹ç¬¬ä¸€åˆ—æœ‰æ•ˆï¼‰é¦–å…ˆéœ€è¦è®¾ç½®åˆ—è¡¨æ§ä»¶çš„LVS_EDITLABELSé£æ ¼ï¼Œåœ¨å¼€å§‹ç¼–è¾‘æ—¶è¯¥æ§ä»¶å°†ä¼šå‘é€LVN_BEGINLABELEDITï¼Œä½ å¯ä»¥é€šè¿‡åœ¨å¤„ç†å‡½æ•°ä¸­è¿”å›TRUEæ¥å–æ¶ˆæ¥ä¸‹æ¥çš„ç¼–è¾‘ï¼Œåœ¨ç¼–è¾‘å®Œæˆåä¼šå‘é€LVN_ENDLABELEDITï¼Œåœ¨å¤„ç†è¯¥æ¶ˆæ¯æ—¶éœ€è¦å°†å‚æ•°pNMHDRè½¬æ¢ä¸ºLPNMLVDISPINFOï¼Œç„¶åé€šè¿‡å…¶ä¸­çš„item.pszTextå¾—åˆ°ç¼–è¾‘åçš„å­—ç¬¦ï¼Œå¹¶é‡ç½®æ˜¾ç¤ºå­—ç¬¦ã€‚å¦‚æœç¼–è¾‘åœ¨ä¸­é€”ä¸­å–æ¶ˆè¯¥å˜é‡ä¸ºNULLã€‚ä¸‹é¢çš„ä»£ç è¯´æ˜å¦‚ä½•å¤„ç†è¿™äº›æ¶ˆæ¯ï¼š\n&#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ LVN_BEGINLABELEDIT void CParentWnd::OnBeginEditList(NMHDR*pNMHDR, LRESULT* pResult) { LV_DISPINFO* pLVDI &#x3D; (LV_DISPINFO*)pNMHDR;if(pLVDI-&gt;item.iItem&#x3D;&#x3D;0);&#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦å–æ¶ˆè¯¥æ“ä½œ pResult &#x3D; 1; else pResult &#x3D; 0;} &#x2F;&#x2F;å¤„ç†æ¶ˆæ¯ LVN_BEGINLABELEDIT void CParentWnd::OnBeginEditList(NMHDRpNMHDR, LRESULT pResult) { LV_DISPINFO* pLVDI &#x3D; (LV_DISPINFO*)pNMHDR;if(pLVDI-&gt;item.pszText&#x3D;&#x3D;NULL);&#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦å·²ç»å–æ¶ˆå–æ¶ˆç¼–è¾‘m_list.SetItemText(pLVDI-&gt;item.iItem,0,pLVDI-&gt;pszText); &#x2F;&#x2F;é‡ç½®æ˜¾ç¤ºå­—ç¬¦*pResult &#x3D; 0; }\nä¸Šé¢è®²è¿°çš„æ–¹æ³•æ‰€è¿›è¡Œçš„æ¶ˆæ¯æ˜ å°„å¿…é¡»åœ¨çˆ¶çª—å£ä¸­è¿›è¡Œï¼ˆåŒæ ·WM_NOTIFYçš„æ‰€æœ‰æ¶ˆæ¯éƒ½éœ€è¦åœ¨çˆ¶çª—å£ä¸­å¤„ç†ï¼‰ã€‚\nå¦‚ä½•å¾—åˆ°å½“å‰é€‰ä¸­é¡¹ä½ç½®ï¼šåœ¨åˆ—è¡¨æ§ä»¶ä¸­æ²¡æœ‰ä¸€ä¸ªç±»ä¼¼äºListBoxä¸­GetCurSel()çš„å‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨GetNextItem(-1, LVNI_ALL | LVNI_SELECTED);å¾—åˆ°é€‰ä¸­é¡¹ä½ç½®ã€‚\n\nTab Ctrl\nTabå±æ€§é¡µæ§ä»¶å¯ä»¥åœ¨ä¸€ä¸ªçª—å£ä¸­æ·»åŠ ä¸åŒçš„é¡µé¢ï¼Œç„¶ååœ¨é¡µé€‰æ‹©å‘ç”Ÿæ”¹å˜æ—¶å¾—åˆ°é€šçŸ¥ã€‚MFCä¸­ä½¿ç”¨CTabCtrlç±»æ¥å°è£…å±æ€§é¡µæ§ä»¶çš„å„ç§æ“ä½œã€‚é€šè¿‡è°ƒç”¨BOOL Create( DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINTnID );åˆ›å»ºä¸€ä¸ªçª—å£ï¼ŒdwStyleä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸€äº›å±æ€§é¡µæ§ä»¶çš„ä¸“ç”¨é£æ ¼ï¼š\nTCS_BUTTONS ä½¿ç”¨æŒ‰é’®æ¥è¡¨ç¤ºé¡µé€‰æ‹©ä½ç½®  TCS_MULTILINE åˆ†è¡Œæ˜¾ç¤ºé¡µé€‰æ‹©ä½ç½®  TCS_SINGLELINEåªä½¿ç”¨ä¸€è¡Œæ˜¾ç¤ºé¡µé€‰æ‹©ä½ç½®  åœ¨æ§ä»¶åˆ›å»ºåå¿…éœ€å‘å…¶ä¸­æ·»åŠ é¡µé¢æ‰å¯ä»¥ä½¿ç”¨ï¼Œæ·»åŠ é¡µé¢çš„å‡½æ•°ä¸ºï¼š  BOOL InsertItem( intnItem, LPCTSTR lpszItem);nItemä¸ºä½ç½®ï¼Œä»é›¶å¼€å§‹ï¼ŒlpszItemä¸ºé¡µé€‰æ‹©ä½ç½®ä¸Šæ˜¾ç¤ºçš„æ–‡å­—ã€‚å¦‚æœä½ å¸Œæœ›åœ¨é¡µé€‰æ‹©ä½ç½®å¤„æ˜¾ç¤ºä¸€ä¸ªå›¾æ ‡ï¼Œä½ å¯ä»¥è°ƒç”¨  BOOLInsertItem( int nItem, LPCTSTR lpszItem, int nImage);nImageæŒ‡æ˜æ‰€ä½¿ç”¨çš„å›¾ç‰‡ä½ç½®ã€‚ï¼ˆåœ¨æ­¤ä¹‹å‰å¿…é¡»è°ƒç”¨CImageList * SetImageList( CImageList *pImageList );è®¾ç½®æ­£ç¡®çš„ImageListï¼‰\næ­¤å¤–CTabCtrlè¿˜æä¾›äº†ä¸€äº›å‡½æ•°ç”¨äºå¾—åˆ°&#x2F;ä¿®æ”¹æ§ä»¶çš„çŠ¶æ€ã€‚  int GetCurSel( )&#x2F;int SetCurSel( intnItem );ç”¨äºå¾—åˆ°&#x2F;è®¾ç½®å½“å‰è¢«é€‰ä¸­çš„é¡µä½ç½®ã€‚  BOOL DeleteItem( int nItem )&#x2F;BOOLDeleteAllItems( );ç”¨äºåˆ é™¤æŒ‡å®š&#x2F;æ‰€æœ‰é¡µé¢ã€‚  void RemoveImage( int nImage);ç”¨äºåˆ é™¤æŸé¡µé€‰æ‹©ä½ç½®ä¸Šçš„å›¾æ ‡ã€‚\nå±æ€§é¡µæ§ä»¶çš„æ¶ˆæ¯æ˜ å°„åŒæ ·ä½¿ç”¨ON_NOTIFYå®ï¼Œå½¢å¼å¦‚åŒï¼šON_NOTIFY( wNotifyCode, id, memberFxn)ï¼ŒwNotifyCodeä¸ºé€šçŸ¥ä»£ç ï¼Œidä¸ºäº§ç”Ÿè¯¥æ¶ˆæ¯çš„çª—å£IDï¼ŒmemberFxnä¸ºå¤„ç†å‡½æ•°ï¼Œå‡½æ•°çš„åŸå‹å¦‚åŒvoidOnXXXTab(NMHDR* pNMHDR, LRESULT*pResult)ï¼Œå…¶ä¸­pNMHDRä¸ºä¸€æ•°æ®ç»“æ„ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶éœ€è¦è½¬æ¢æˆå…¶ä»–ç±»å‹çš„ç»“æ„ã€‚å¯¹äºåˆ—è¡¨æ§ä»¶å¯èƒ½å–å€¼å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ä¸ºï¼š\nTCN_SELCHANGE åœ¨å½“å‰é¡µæ”¹å˜åå‘é€ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMHDR  TCN_SELCHANGINGåœ¨å½“å‰é¡µæ”¹å˜æ—¶å‘é€å¯ä»¥é€šè¿‡è¿”å›TRUEæ¥ç¦æ­¢é¡µé¢çš„æ”¹å˜ï¼Œæ‰€ç”¨ç»“æ„ï¼šNMHDR\nä¸€èˆ¬æ¥è®²åœ¨å½“å‰é¡µå‘ç”Ÿæ”¹å˜æ—¶éœ€è¦éšè—å½“å‰çš„ä¸€äº›å­çª—å£ï¼Œå¹¶æ˜¾ç¤ºå…¶å®ƒçš„å­çª—å£ã€‚ä¸‹é¢çš„ä¼ªä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å±æ€§é¡µæ§ä»¶ï¼šCParentWnd::OnCreate(â€¦){m_tab.Create(â€¦);m_tab.InsertItem(0,â€Option 1â€);m_tab.InsertItem(1,â€Option 2â€);Create a edit box as the m_tabâ€™s ChildCreate a static box as the m_tabâ€™s Childedit_box.ShowWindow(SW_SHOW); &#x2F;&#x2F; edit boxåœ¨å±æ€§é¡µçš„ç¬¬ä¸€é¡µstatic_box.ShowWindow(SW_HIDE); &#x2F;&#x2F; static boxåœ¨å±æ€§é¡µçš„ç¬¬äºŒé¡µ}void CParentWnd::OnSelectChangeTab(NMHDR* pNMHDR, LRESULT* pResult){&#x2F;&#x2F;å¤„ç†é¡µé€‰æ‹©æ”¹å˜åçš„æ¶ˆæ¯if(m_tab.GetCurSel()&#x3D;&#x3D;0){&#x2F;&#x2F;æ ¹æ®å½“å‰é¡µæ˜¾ç¤º&#x2F;éšè—ä¸åŒçš„å­çª—å£edit_box.ShowWindow(SW_SHOW);static_box.ShowWindow(SW_HIDE);}else{&#x2F;&#x2F;edit_box.ShowWindow(SW_HIDE);static_box.ShowWindow(SW_SHOW);}}\n\n\n","slug":"MFC/ç¬¬6èŠ‚-VC-6-0æ§ä»¶è¯´æ˜","date":"2017-10-28T15:32:11.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"d41da3519676c2875183fa7ba0389f75","title":"ç¬¬5èŠ‚ MFCå¯¹è¯æ¡†ç¨‹åº","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬5èŠ‚ MFCå¯¹è¯æ¡†ç¨‹åºæ¨¡å¼å¯¹è¯æ¡†\nå¯¹è¯æ¡†ç¨‹åºæ˜¯MFCæœ€é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿæ˜¯Visual C++ä¸­å”¯ä¸€å¯ä»¥å¯è§†åŒ–è®¾è®¡çš„çª—å£ç¨‹åºï¼Œå¯¹è¯æ¡†ä¸»è¦æœ‰ä¸¤ç±»ï¼š\n\n\næ¨¡å¼å¯¹è¯æ¡†ï¼šå¿…é¡»å…³é—­è¿™ä¸ªå¯¹è¯æ¡†æ‰èƒ½ç»§ç»­æ“ä½œçˆ¶çª—å£æˆ–è€…ä¸Šä¸€çº§çª—å£\néæ¨¡å¼å¯¹è¯æ¡†:ä¸å½±å“çˆ¶çª—å£æˆ–è€…ä¸Šä¸€çº§çª—å£ï¼Œå¯ç»§ç»­æ“ä½œçˆ¶çª—å£æˆ–è€…ä¸Šä¸€çº§çª—å£ï¼Œå¯¹è¯æ¡†ç¨‹åºä¹Ÿå¯ä»¥ä¸€ç›´ä¿ç•™ï¼Œæ— éœ€å…³é—­æ‰èƒ½æ‰§è¡Œä¸‹ä¸€æ­¥ï¼›\n\n\næ¥æ¥ä¸‹æˆ‘ä»¬å…ˆä¸€èµ·å­¦ä¹ æ¨¡å¼å¯¹è¯æ¡†ï¼›\n1. æ–°å»ºé¡¹ç›®å»ºç«‹ä¸€ä¸ªMFCçš„ä¸»å¯¹è¯æ¡†é¡¹ç›®day04ï¼Œå‚è§ä¸ŠèŠ‚ï¼Œæ·»åŠ ä¸¤ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«ä¸ºâ€œå…³äºâ€ï¼Œâ€œèŠå¤©â€ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n2. æ·»åŠ å…³äºå¯¹è¯æ¡†åœ¨èµ„æºè§†å›¾ï¼ˆResourceViewï¼‰ä¸­Dialogä¸Šå³å‡»-&gt;Insert Diallogï¼Œæ’å…¥å¯¹è¯æ¡†ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n3. æ·»åŠ å…³äºå¯¹è¯æ¡†ç±»å•å‡»æ·»åŠ çš„å…³äºå¯¹è¯æ¡†ï¼Œæ‰§è¡ŒView-&gt;Class Wizardï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”®Ctrl + Wæ‰“å¼€ç±»å‘å¯¼ï¼›ç”±äºæ–°çš„å¯¹è¯æ¡†ä¸å­˜åœ¨å…³è”ç±»ï¼Œæ­¤æ—¶ä¼šæç¤ºåˆ›å»ºä¸€ä¸ªä¸å®ƒç›¸å…³è”çš„ç±»ï¼Œé€‰æ‹©Create a new class,å•å‡»OKåˆ›å»ºå…³è”ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå•å‡»OKå®Œæˆåˆ›å»ºå…³è”ç±»ï¼›\n3. æ·»åŠ å…³äºæŒ‰é’®æ¶ˆæ¯äº‹ä»¶åˆ‡æ¢å›ä¸»å¯¹è¯æ¡†ï¼Œå•å‡»ä¸»å¯¹è¯æ¡†ï¼Œæ‰§è¡ŒView-&gt;Class Wizardï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”®Ctrl + Wæ‰“å¼€ç±»å‘å¯¼ï¼›é€‰æ‹©å…³äºæŒ‰é’®ï¼Œå¢åŠ clickedæ–¹æ³•ï¼Œç„¶åEdit Codeç¼–è¾‘å…³äºæŒ‰é’®çš„å“åº”æ–¹æ³•ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥åŒå‡»â€œå…³äºâ€æŒ‰é’®å°±å¯ä»¥ç›´æ¥è¿›å…¥æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼Œåœ¨day04Dlg.hä¸­æ·»åŠ â€œ#include AboutDlg.hâ€æ¥å¼•å…¥å¯¹è¯æ¡†ç±»ï¼Œç„¶åæˆ‘ä»¬æ¥ç¼–è¾‘å…³äºæŒ‰é”®æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªæ¨¡å¼å¯¹è¯æ¡†ï¼›\n123456void CDay04Dlg::OnButtonAbout() &#123;\t// TODO: Add your control notification handler code here\tCAboutDlg dlg;\tdlg.DoModal();&#125;\næ•ˆæœå›¾ï¼šè‡³æ­¤ï¼Œä¸€ä¸ªæ¨¡å¼å¯¹è¯æ¡†å°±åˆ›å»ºæˆåŠŸäº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¿…é¡»å…³é—­å…³äºå¯¹è¯æ¡†ï¼Œæ‰èƒ½å•å‡»ä¸»å¯¹è¯æ¡†ã€‚\néæ¨¡å¼å¯¹è¯æ¡†ç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªéæ¨¡å¼å¯¹è¯æ¡†ï¼›\n1. æ·»åŠ èŠå¤©å¯¹è¯æ¡†åœ¨èµ„æºè§†å›¾ï¼ˆResourceViewï¼‰ä¸­Dialogä¸Šå³å‡»-&gt;Insert Diallogï¼Œæ’å…¥å¯¹è¯æ¡†ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n2. æ·»åŠ èŠå¤©å¯¹è¯æ¡†ç±»å•å‡»æ·»åŠ çš„å…³äºå¯¹è¯æ¡†ï¼Œæ‰§è¡ŒView-&gt;Class Wizardï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”®Ctrl + Wæ‰“å¼€ç±»å‘å¯¼ï¼›ç”±äºæ–°çš„å¯¹è¯æ¡†ä¸å­˜åœ¨å…³è”ç±»ï¼Œæ­¤æ—¶ä¼šæç¤ºåˆ›å»ºä¸€ä¸ªä¸å®ƒç›¸å…³è”çš„ç±»ï¼Œé€‰æ‹©Create a new class,å•å‡»OKåˆ›å»ºå…³è”ç±»ï¼Œå¦‚ä¸Šé¢æ­¥éª¤3\n3. æ·»åŠ èŠå¤©æŒ‰é’®æ¶ˆæ¯äº‹ä»¶åˆ‡æ¢å›ä¸»å¯¹è¯æ¡†ï¼Œå•å‡»ä¸»å¯¹è¯æ¡†ï¼Œæ‰§è¡ŒView-&gt;Class Wizardï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”®Ctrl + Wæ‰“å¼€ç±»å‘å¯¼ï¼›é€‰æ‹©èŠå¤©æŒ‰é’®ï¼Œå¢åŠ clickedæ–¹æ³•ï¼Œç„¶åEdit Codeç¼–è¾‘å…³äºæŒ‰é’®çš„å“åº”æ–¹æ³•ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥åŒå‡»â€œèŠå¤©â€æŒ‰é’®å°±å¯ä»¥ç›´æ¥è¿›å…¥æŒ‰é’®ç‚¹å‡»æ–¹æ³•ï¼Œåœ¨day04Dlg.hä¸­æ·»åŠ â€œ#include â€œChat.hâ€â€æ¥å¼•å…¥å¯¹è¯æ¡†ç±»ï¼Œç„¶åæˆ‘ä»¬æ¥ç¼–è¾‘èŠå¤©æŒ‰é”®æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªéæ¨¡å¼å¯¹è¯æ¡†ï¼›\n1234567void CDay04Dlg::OnButtonChat() &#123;\t// TODO: Add your control notification handler code here\tCChat * pDlg = new CChat;\tpDlg-&gt;Create(IDD_DIALOG_CHAT);\tpDlg-&gt;ShowWindow(SW_SHOW);&#125;\næ•ˆæœå›¾ï¼šè‡³æ­¤ï¼Œä¸€ä¸ªéæ¨¡å¼å¯¹è¯æ¡†å°±åˆ›å»ºæˆåŠŸäº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰“å¼€èŠå¤©ç•Œé¢åè¿˜å¯ä»¥ç»§ç»­æ“ä½œçˆ¶çª—å£ä¸­çš„å…³äºå¯¹è¯æ¡†ï¼Œç”šè‡³è¿˜å¯ä»¥å•å‡»èŠå¤©å¯¹è¯æ¡†åˆ›å»ºå¤šä¸ªèŠå¤©ç•Œé¢ï¼›\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘","slug":"MFC/ç¬¬5èŠ‚-MFCå¯¹è¯æ¡†ç¨‹åº","date":"2017-10-28T15:31:35.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"2f4d7dd6c64cb6ac7562ed9535f84aaa","title":"ç¬¬4èŠ‚ MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬4èŠ‚ MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶å¯¹äºMFCç¨‹åºæœ€é‡è¦çš„å“åº”æœºåˆ¶å°±æ˜¯æ¶ˆæ¯æ˜ å°„æœºåˆ¶ï¼Œè¿™èŠ‚æˆ‘ä»¬å°±æ¥ä¸€èµ·å°è¯•ä¸€ä¸‹MFCçš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶ã€‚ï¼ˆæ“ä½œç³»ç»Ÿï¼šwin10 64ä½ IDEï¼švc++ 6.0ï¼‰1ã€æ–°å»ºä¸€ä¸ªMFCå¯¹è¯æ¡†é¡¹ç›®ï¼Œå‚è§ä¸ŠèŠ‚ï¼Œ2ã€ç¼–è¯‘ä»£ç è¿è¡Œï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š3ã€ç°åœ¨æˆ‘ä»¬åˆ é™¤å¯¹è¯æ¡†ä¸Šçš„ã€Šç¡®å®šã€‹å’Œã€Šå–æ¶ˆã€‹æŒ‰é’®ï¼Œå¦‚å›¾ï¼š4ã€ç°åœ¨æˆ‘ä»¬æ·»åŠ è‡ªå·±çš„â€œOKâ€å’Œâ€œCANCELâ€æŒ‰é’®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹â€œOKâ€æŒ‰é’®çš„æŒ‰ä¸‹æ¶ˆæ¯æ˜¯æ€ä¹ˆè¿›è¡Œå¤„ç†çš„ï¼Ÿ4ã€æ‰§è¡ŒView-&gt;Class Wizard,æ‰“å¼€ç±»å‘å¯¼ï¼›ï¼ˆæˆ–è€…ç›´æ¥ç”¨ctrl + Wï¼‰\næ­¤æ—¶å°±èƒ½çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºçš„å¯¹è¯æ¡†ï¼ŒOKæŒ‰é’®ï¼ŒCANCELæŒ‰é’®å¯¹è±¡ï¼Œç‚¹å‡»å®ƒä»¬å¯ä»¥çœ‹è§å®ƒä»¬åˆ†åˆ«çš„æ‹¥æœ‰çš„æ¶ˆæ¯ï¼Œå¦‚å›¾ï¼š\n5ã€æˆ‘ä»¬é€‰æ‹©Cday03Dlgï¼ŒMESSAGESé€‰æ‹©WM_MOUSEMOVEæ¶ˆæ¯ï¼Œç‚¹å‡»Add Functionï¼Œä¸‹éƒ¨Member functionå°±ä¼šå‡ºç°ä¸WM_MOUSEMOVEå¯¹åº”çš„OnMouseMoveå‡½æ•°ï¼Œæ¥ä¸‹æ¥ç‚¹å‡»Edit Codeï¼Œç¼–è¾‘OnMouseMoveå‡½æ•°çš„å†…å®¹ï¼š6ã€æˆ‘ä»¬æ¥ä¿®æ”¹OnMouseMove(UINT nFlags, CPoint point) å‡½æ•°ï¼Œå‚æ•°ä¸­pointä¸ºé¼ æ ‡çš„åæ ‡ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡point.x, point.yæ¥è·å–é¼ æ ‡çš„ä½ç½®ï¼ŒnFlagsä¸»è¦æ˜¯æ ‡å¿—ä¸€äº›æ§åˆ¶é”®æ˜¯å¦æŒ‰ä¸‹ï¼Œç„¶åMK_LBUTTONã€MK_RBUTTONã€MK_CONTROLã€MK_SHIFTã€MK_MBUTTON åˆ†åˆ«å¯¹åº”é¼ æ ‡å·¦é”®ï¼Œå³é”®ï¼ŒCTRL ï¼ŒSHIFT ï¼Œé¼ æ ‡ä¸­é—´ï¼ˆè½¬è½®ï¼‰ï¼š\n123456789101112131415161718192021222324252627282930void CDay03Dlg::OnMouseMove(UINT nFlags, CPoint point) &#123;\t// TODO: Add your message handler code here and/or call default\tCString strText;\tstrText.Format(&quot;åæ ‡ x = %d ,y = %d &quot;,point.x, point.y);\tif (nFlags &amp; MK_LBUTTON)\t&#123;\t\tstrText += &quot; é¼ æ ‡å·¦é”®DOWN&quot;;\t&#125;\tif (nFlags &amp; MK_RBUTTON)\t&#123;\t\tstrText += &quot; é¼ æ ‡å³é”®DOWN&quot;;\t&#125;\tif (nFlags &amp; MK_CONTROL)\t&#123;\t\tstrText += &quot; CTRL DOWN&quot;;\t&#125;\tif (nFlags &amp; MK_SHIFT)\t&#123;\t\tstrText += &quot; SHIFT DOWN&quot;;\t&#125;\tif (nFlags &amp; MK_MBUTTON)\t&#123;\t\tstrText += &quot; MIDBUTTON DOWN&quot;;\t&#125;\tSetWindowText(strText);  // è®¾ç½®å¯¹è¯æ¡†æ ‡é¢˜æ–‡æœ¬\tCDialog::OnMouseMove(nFlags, point);&#125;\næ•ˆæœå›¾ï¼š\n7ã€åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»å‘å¯¼åˆ†åˆ«è®¾ç½®â€œOKâ€ï¼Œâ€œCANCELâ€æŒ‰é’®çš„æ¶ˆæ¯è§¦å‘å‡½æ•°ï¼›\n8ã€è¿™æ˜¯æˆ‘ä»¬å…¶å®å¯ä»¥çœ‹åˆ°åœ¨day03Dlg.cppä¸­MESSAGE_MAPæ€»ä¸‹æ–¹å°±æœ‰æˆ‘ä»¬æ–°å¢çš„ä¸‰ä¸ªMFCæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯ä»¥ç›´è§‚çš„çœ‹å‡ºæ˜¯å±äºå“ªä¸ªæ§ä»¶IDçš„ï¼›\n12345678910BEGIN_MESSAGE_MAP(CDay03Dlg, CDialog)\t//&#123;&#123;AFX_MSG_MAP(CDay03Dlg)\tON_WM_SYSCOMMAND()\tON_WM_PAINT()\tON_WM_QUERYDRAGICON()\tON_WM_MOUSEMOVE()\tON_BN_CLICKED(IDC_BUTTON_OK, OnButtonOk)\tON_BN_CLICKED(IDC_BUTTON_CACEL, OnButtonCacel)\t//&#125;&#125;AFX_MSG_MAPEND_MESSAGE_MAP()\n9ã€æ¥ä¸‹æ¥æˆ‘ä»¬åˆ‡æ¢åˆ°day03Dlg.hå¤´æ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰afx_msg å¼€å¤´çš„éƒ½æ˜¯æ¶ˆæ¯å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼š\n1234567891011// Generated message map functions//&#123;&#123;AFX_MSG(CDay03Dlg)afx_msg void OnSysCommand(UINT nID, LPARAM lParam);afx_msg void OnPaint();afx_msg HCURSOR OnQueryDragIcon();afx_msg void OnMouseMove(UINT nFlags, CPoint point);afx_msg void OnButtonOk();afx_msg void OnDoubleclickedButtonCacel();afx_msg void OnButtonCacel();//&#125;&#125;AFX_MSGDECLARE_MESSAGE_MAP()\n10ã€ç”±ä»¥ä¸Šä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒMFCç¨‹åºçš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶æ˜¯åˆ›å»ºä¸€ä¸ªä¸çª—å£ç›¸å…³è”çš„æ´¾ç”Ÿç±»ï¼Œç”¨äºæ¶ˆæ¯å…³è”çš„æˆå‘˜å‡½æ•°æ¥æ¥æ”¶å’Œå¤„ç†çª—å£çš„æ¶ˆæ¯ã€‚åœ¨ç±»å‘å¯¼ä¸­é€‰æ‹©å¯¹åº”çš„æ¶ˆæ¯ï¼Œæ·»åŠ ä¸è¯¥æ¶ˆæ¯å…³è”çš„æˆå‘˜å‡½æ•°æ¥å¤„ç†è¯¥æ¶ˆæ¯ï¼Œè¿™å°±æ˜¯MFCçš„æ¶ˆæ¯æ˜ å°„æœºåˆ¶ã€‚å…·ä½“æ§ä»¶æˆ–çª—å£æ”¯æŒå“ªäº›æ¶ˆæ¯åŠæ¶ˆæ¯å¯¹åº”çš„å‡½æ•°å‚æ•°ç­‰ï¼Œè¯·å‚è§MSDNï¼›11ã€æœ€ç»ˆæ•ˆæœå›¾ï¼š\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘æ¥fork\n","slug":"MFC/ç¬¬4èŠ‚-MFCæ¶ˆæ¯æ˜ å°„æœºåˆ¶","date":"2017-10-28T15:30:28.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"436629cc87cd5604a8123cfb0e89982f","title":"ç¬¬3èŠ‚ åˆæ¢MFC","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬3èŠ‚ åˆæ¢MFC\nå‰è¨€ win32ç¨‹åºå±äºæ—©æœŸwindowsè½¯ä»¶ï¼Œå·²ç»é€æ¸è¢«æ·˜æ±°ï¼Œä½†å®ƒçš„è®¾è®¡æ¨¡å¼å’Œæ–¹æ³•å¤§éƒ¨åˆ†éƒ½è¢«MFCæ‰€ç»§æ‰¿ï¼Œå¹¶ä¸”MFCå¼€å§‹ä½¿ç”¨C++è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œå€ŸåŠ©C++æ¯”Cè¯­è¨€çš„å¼ºå¤§ç‰¹æ€§ï¼Œä½¿å¾—å¼€å‘windwsç¨‹åºæ›´åŠ ç®€ä¾¿ã€é«˜æ•ˆï¼Œæ›´åŠ å¤šå…ƒåŒ–ã€‚\nåˆ›å»ºç¬¬ä¸€ä¸ªMFCç¨‹åºï¼ˆæ“ä½œç³»ç»Ÿï¼šwin10 64ä½ IDEï¼švc++ 6.0ï¼‰\n\n\næ‰§è¡ŒFile-&gt;newï¼Œé€‰æ‹©Projecté€‰é¡¹å¡ï¼Œé€‰æ‹©ä¸‹é¢çš„MFC AppWizardï¼Œå¡«å†™é¡¹ç›®åç§°ç­‰ï¼Œå¦‚å›¾ï¼š  2ï¼‰ç‚¹å‡» OK æŒ‰é’®è¿›å…¥ä¸‹ä¸€é¡µï¼Œæˆ‘ä»¬å…ˆé€‰æ‹©ç®€å•çš„Dialog basedï¼Œç„¶å-&gt;NEXT ï¼Œç¬¬ä¸‰é¡µè¿›è¡Œæ˜¯å¦é€‰æ‹©MFCé™æ€åº“è¿˜æ˜¯å…±äº«åº“ç­‰é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ä½œä¿®æ”¹ï¼Œç›´æ¥ç‚¹å‡»Finishï¼Œå®Œæˆåˆ›å»ºï¼› \n\n 3ï¼‰ç°åœ¨å¯ä»¥å°è¯•ç¼–è¯‘ï¼Œè¿è¡Œæ‰“å¼€é»˜è®¤çš„Dialogç•Œé¢  4)ç°åœ¨æˆ‘ä»¬å¾€åˆšæ‰åˆ›å»ºçš„Dialogä¸­æ·»åŠ ä¸€äº›èµ„æºæ§ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š  æ³¨æ„ï¼šListCtrlå±æ€§ä¸­Stytle-&gt;Viewé€‰æ‹©Report 5ï¼‰ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°åº•éƒ¨ä¸‰ä¸ªæŒ‰é’®çš„æ–¹æ³•ï¼š    æ·»åŠ æŒ‰é’®\n12345678910111213 void CDay02Dlg::OnAdd() &#123;\t// TODO: Add your control notification handler code here\tCString szNumb,szName,szSala;\tGetDlgItemText(IDC_NUMB,szNumb);\tGetDlgItemText(IDC_NAME,szName);\tGetDlgItemText(IDC_SALA,szSala);\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nCount = pList-&gt;GetItemCount();\tpList-&gt;InsertItem(nCount,szNumb);\tpList-&gt;SetItemText(nCount,1,szName);\tpList-&gt;SetItemText(nCount,2,szSala);&#125;\nå…ˆé€šè¿‡GetDlgItemTextæ–¹æ³•è·å–é¡¶éƒ¨ä¸‰ä¸ªEditè¾“å…¥çš„å‚æ•°å€¼ï¼Œå¹¶åˆ†åˆ«èµ‹å€¼ç»™szNumb,szName,szSala;æ¥ä¸‹æ¥é€šè¿‡GetDlgItemå–å¾—ListCtrlçš„æ“ä½œå¥æŸ„ï¼Œè·å–ListCtrlå½“å‰æ€»æ•°ï¼Œåœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªItenï¼Œå¹¶èµ‹å€¼ï¼›\ntxtåˆ é™¤æŒ‰é’®123456789101112void CDay02Dlg::OnDel() &#123;\t// TODO: Add your control notification handler code here\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nSel = pList-&gt;GetSelectionMark();\tif(nSel &lt; 0)\t&#123;\t\tAfxMessageBox(&quot;è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„å‘˜å·¥&quot;);\t\treturn;\t&#125;\tpList-&gt;DeleteItem(nSel);&#125;\nè·å–ListCtrlçš„æ“ä½œå¥æŸ„åè·å–åˆ°å½“å‰é€‰çš„è¡Œæ•°ï¼Œæœ€ååˆ é™¤æ”¹è¡Œï¼›\nä¿®æ”¹æŒ‰é’®ï¼š\n1234567891011121314151617181920void CDay02Dlg::OnMod() &#123;\t// TODO: Add your control notification handler code here\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nSel = pList-&gt;GetSelectionMark();\tif(nSel &lt; 0)\t&#123;\t\tAfxMessageBox(&quot;è¯·å…ˆé€‰æ‹©è¦ä¿®æ”¹çš„å‘˜å·¥&quot;);\t\treturn;\t&#125;\t\tCString szNumb,szName,szSala;\tGetDlgItemText(IDC_NUMB,szNumb);\tGetDlgItemText(IDC_NAME,szName);\tGetDlgItemText(IDC_SALA,szSala);\tpList-&gt;SetItemText(nSel,0,szNumb);\tpList-&gt;SetItemText(nSel,1,szName);\tpList-&gt;SetItemText(nSel,2,szSala);\t&#125;\nå…ˆé€šè¿‡GetDlgItemTextæ–¹æ³•è·å–é¡¶éƒ¨ä¸‰ä¸ªEditè¾“å…¥çš„å‚æ•°å€¼ï¼Œå¹¶åˆ†åˆ«èµ‹å€¼ç»™szNumb,szName,szSala;æ¥ä¸‹æ¥é€šè¿‡GetDlgItemå–å¾—ListCtrlçš„æ“ä½œå¥æŸ„ï¼Œè·å–ListCtrlå½“å‰é€‰æ‹©è¡Œæ•°ï¼Œå°†è·å–çš„szNumb,szName,szSalaåˆ†åˆ«èµ‹å€¼ç»™å½“å‰Itemçš„å¯¹åº”ä½ç½®ï¼›\nå‡½æ•°åŸå‹å¦‚ä¸‹ï¼šBOOL SetItemText( int nItem, int nSubItem, LPTSTR lpszText );ç”¨äºMFCè®¾ç½®CListCtrlæ§ä»¶ä¸­çš„åˆ—è¡¨é¡¹å†…å®¹ã€‚\nint GetDlgItemText( int nID, CString&amp; rString) nID æŒ‡å®šäº†è¦è·å–å…¶æ ‡é¢˜çš„æ§ä»¶çš„æ•´æ•°æ ‡è¯†ç¬¦ã€‚ lpStr æŒ‡å‘è¦æ¥æ”¶æ§ä»¶çš„æ ‡é¢˜æˆ–æ–‡æœ¬çš„ç¼“å†²åŒºã€‚ nMaxCount æŒ‡å®šäº†è¦æ‹·è´åˆ°lpStrçš„å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚å¦‚æœå­—ç¬¦ä¸²æ¯”nMaxCountè¦é•¿ï¼Œå®ƒå°†è¢«æˆªæ–­ã€‚ rString å¯¹ä¸€ä¸ªCStringå¯¹è±¡çš„å¼•ç”¨ã€‚\n 3.æœ€ç»ˆæ•ˆæœå›¾ 4. day02.cpp æºç \n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236\t// day02Dlg.cpp : implementation file//#include &quot;stdafx.h&quot;#include &quot;day02.h&quot;#include &quot;day02Dlg.h&quot;#ifdef _DEBUG#define new DEBUG_NEW#undef THIS_FILEstatic char THIS_FILE[] = __FILE__;#endif/////////////////////////////////////////////////////////////////////////////// CAboutDlg dialog used for App Aboutclass CAboutDlg : public CDialog&#123;public:\tCAboutDlg();// Dialog Data\t//&#123;&#123;AFX_DATA(CAboutDlg)\tenum &#123; IDD = IDD_ABOUTBOX &#125;;\t//&#125;&#125;AFX_DATA\t// ClassWizard generated virtual function overrides\t//&#123;&#123;AFX_VIRTUAL(CAboutDlg)\tprotected:\tvirtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support\t//&#125;&#125;AFX_VIRTUAL// Implementationprotected:\t//&#123;&#123;AFX_MSG(CAboutDlg)\t//&#125;&#125;AFX_MSG\tDECLARE_MESSAGE_MAP()&#125;;CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)&#123;\t//&#123;&#123;AFX_DATA_INIT(CAboutDlg)\t//&#125;&#125;AFX_DATA_INIT&#125;void CAboutDlg::DoDataExchange(CDataExchange* pDX)&#123;\tCDialog::DoDataExchange(pDX);\t//&#123;&#123;AFX_DATA_MAP(CAboutDlg)\t//&#125;&#125;AFX_DATA_MAP&#125;BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)\t//&#123;&#123;AFX_MSG_MAP(CAboutDlg)\t\t// No message handlers\t//&#125;&#125;AFX_MSG_MAPEND_MESSAGE_MAP()/////////////////////////////////////////////////////////////////////////////// CDay02Dlg dialogCDay02Dlg::CDay02Dlg(CWnd* pParent /*=NULL*/)\t: CDialog(CDay02Dlg::IDD, pParent)&#123;\t//&#123;&#123;AFX_DATA_INIT(CDay02Dlg)\t\t// NOTE: the ClassWizard will add member initialization here\t//&#125;&#125;AFX_DATA_INIT\t// Note that LoadIcon does not require a subsequent DestroyIcon in Win32\tm_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);&#125;void CDay02Dlg::DoDataExchange(CDataExchange* pDX)&#123;\tCDialog::DoDataExchange(pDX);\t//&#123;&#123;AFX_DATA_MAP(CDay02Dlg)\t\t// NOTE: the ClassWizard will add DDX and DDV calls here\t//&#125;&#125;AFX_DATA_MAP&#125;BEGIN_MESSAGE_MAP(CDay02Dlg, CDialog)\t//&#123;&#123;AFX_MSG_MAP(CDay02Dlg)\tON_WM_SYSCOMMAND()\tON_WM_PAINT()\tON_WM_QUERYDRAGICON()\tON_BN_CLICKED(IDC_BUTTON4, OnButtonOK)\tON_BN_CLICKED(IDC_ADD, OnAdd)\tON_BN_CLICKED(IDC_DEL, OnDel)\tON_BN_CLICKED(IDC_MOD, OnMod)\t//&#125;&#125;AFX_MSG_MAPEND_MESSAGE_MAP()/////////////////////////////////////////////////////////////////////////////// CDay02Dlg message handlersBOOL CDay02Dlg::OnInitDialog()&#123;\tCDialog::OnInitDialog();\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tpList-&gt;InsertColumn(0,&quot;å­¦å·&quot;,0,100);\tpList-&gt;InsertColumn(1,&quot;å§“å&quot;,0,100);\tpList-&gt;InsertColumn(2,&quot;å·¥èµ„&quot;,0,100);\t// Add &quot;About...&quot; menu item to system menu.\t// IDM_ABOUTBOX must be in the system command range.\tASSERT((IDM_ABOUTBOX &amp; 0xFFF0) == IDM_ABOUTBOX);\tASSERT(IDM_ABOUTBOX &lt; 0xF000);\tCMenu* pSysMenu = GetSystemMenu(FALSE);\tif (pSysMenu != NULL)\t&#123;\t\tCString strAboutMenu;\t\tstrAboutMenu.LoadString(IDS_ABOUTBOX);\t\tif (!strAboutMenu.IsEmpty())\t\t&#123;\t\t\tpSysMenu-&gt;AppendMenu(MF_SEPARATOR);\t\t\tpSysMenu-&gt;AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);\t\t&#125;\t&#125;\t// Set the icon for this dialog.  The framework does this automatically\t//  when the application&#x27;s main window is not a dialog\tSetIcon(m_hIcon, TRUE);\t\t\t// Set big icon\tSetIcon(m_hIcon, FALSE);\t\t// Set small icon\t\t// TODO: Add extra initialization here\t\treturn TRUE;  // return TRUE  unless you set the focus to a control&#125;void CDay02Dlg::OnSysCommand(UINT nID, LPARAM lParam)&#123;\tif ((nID &amp; 0xFFF0) == IDM_ABOUTBOX)\t&#123;\t\tCAboutDlg dlgAbout;\t\tdlgAbout.DoModal();\t&#125;\telse\t&#123;\t\tCDialog::OnSysCommand(nID, lParam);\t&#125;&#125;// If you add a minimize button to your dialog, you will need the code below//  to draw the icon.  For MFC applications using the document/view model,//  this is automatically done for you by the framework.void CDay02Dlg::OnPaint() &#123;\tif (IsIconic())\t&#123;\t\tCPaintDC dc(this); // device context for painting\t\tSendMessage(WM_ICONERASEBKGND, (WPARAM) dc.GetSafeHdc(), 0);\t\t// Center icon in client rectangle\t\tint cxIcon = GetSystemMetrics(SM_CXICON);\t\tint cyIcon = GetSystemMetrics(SM_CYICON);\t\tCRect rect;\t\tGetClientRect(&amp;rect);\t\tint x = (rect.Width() - cxIcon + 1) / 2;\t\tint y = (rect.Height() - cyIcon + 1) / 2;\t\t// Draw the icon\t\tdc.DrawIcon(x, y, m_hIcon);\t&#125;\telse\t&#123;\t\tCDialog::OnPaint();\t&#125;&#125;// The system calls this to obtain the cursor to display while the user drags//  the minimized window.HCURSOR CDay02Dlg::OnQueryDragIcon()&#123;\treturn (HCURSOR) m_hIcon;&#125;void CDay02Dlg::OnButtonOK() &#123;\t// TODO: Add your control notification handler code here\t&#125;void CDay02Dlg::OnAdd() &#123;\t// TODO: Add your control notification handler code here\tCString szNumb,szName,szSala;\tGetDlgItemText(IDC_NUMB,szNumb);\tGetDlgItemText(IDC_NAME,szName);\tGetDlgItemText(IDC_SALA,szSala);\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nCount = pList-&gt;GetItemCount();\tpList-&gt;InsertItem(nCount,szNumb);\tpList-&gt;SetItemText(nCount,1,szName);\tpList-&gt;SetItemText(nCount,2,szSala);&#125;void CDay02Dlg::OnDel() &#123;\t// TODO: Add your control notification handler code here\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nSel = pList-&gt;GetSelectionMark();\tif(nSel &lt; 0)\t&#123;\t\tAfxMessageBox(&quot;è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„å‘˜å·¥&quot;);\t\treturn;\t&#125;\tpList-&gt;DeleteItem(nSel);\t&#125;void CDay02Dlg::OnMod() &#123;\t// TODO: Add your control notification handler code here\tCListCtrl *pList = (CListCtrl*)GetDlgItem(IDC_LIST);\tint nSel = pList-&gt;GetSelectionMark();\tif(nSel &lt; 0)\t&#123;\t\tAfxMessageBox(&quot;è¯·å…ˆé€‰æ‹©è¦ä¿®æ”¹çš„å‘˜å·¥&quot;);\t\treturn;\t&#125;\t\tCString szNumb,szName,szSala;\tGetDlgItemText(IDC_NUMB,szNumb);\tGetDlgItemText(IDC_NAME,szName);\tGetDlgItemText(IDC_SALA,szSala);\tpList-&gt;SetItemText(nSel,0,szNumb);\tpList-&gt;SetItemText(nSel,1,szName);\tpList-&gt;SetItemText(nSel,2,szSala);\t&#125;\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘æ¥forkï¼š\n1https://gitee.com/AmuUncle/MFC_CSDN.git","slug":"MFC/ç¬¬3èŠ‚-åˆæ¢MFC","date":"2017-10-28T15:14:58.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"3f633bfafeec92d57d809cdb658962e5","title":"Windowsç¼–ç¨‹åŸºç¡€--ç¬¬2èŠ‚ win32ç¨‹åºèµ„æºç®¡ç†","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬2èŠ‚ win32ç¨‹åºèµ„æºç®¡ç†ï¼ˆæ“ä½œç³»ç»Ÿï¼šwin10 64ä½ IDEï¼švc++ 6.0ï¼‰windowsç¨‹åºéƒ½æœ‰è‡ªå·±çš„èµ„æºï¼Œä¾‹å¦‚æŒ‰é’®ï¼Œå›¾æ ‡ï¼Œå¯¹è¯æ¡†ç­‰ç­‰ï¼Œè¿™èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨win32ç¨‹åºèµ„æºç®¡ç†ï¼›1ã€ç»§ç»­ä½¿ç”¨ä¸ŠèŠ‚çš„win32ç¨‹åºdemoï¼Œæ‰§è¡ŒFile-&gt;newæ·»åŠ èµ„æºï¼Œé€‰æ‹©Filesé€‰é¡¹å¡ä¸­çš„Resource Scriptï¼Œå¡«å†™èµ„æºåï¼Œå¦‚å›¾æ‰€ç¤ºï¼š2ã€æ­¤æ—¶é¡¹ç›®å·¦ä¾§ä¼šå‡ºç°ResourceViewè§†å›¾ï¼Œå•å‡»ResourceViewä¸­çš„æ ¹èŠ‚ç‚¹+å·ï¼Œä¼šæç¤ºâ€œThis file is already open in an editorâ€ï¼Œè¿™æ—¶å€™å…³é—­å³è¾¹çš„day01.rcï¼Œå†æ¬¡æ‰“å¼€å°±å¯ä»¥äº†ï¼›3ã€åœ¨ResourceViewèŠ‚ç‚¹day01 ResourcesèŠ‚ç‚¹ä¸Šå³å‡»-&gt;Insert,é€‰ä¸­Dialog,å•å‡»â€œNewâ€,åˆ›å»ºä¸€ä¸ªå¯¹è¯æ¡†èµ„æºï¼Œåˆ›å»ºæˆåŠŸä¹‹åå¦‚å›¾ï¼š4ã€åœ¨æ–°å»ºçš„å¯¹è¯æ¡†ä¸Šå³å‡»é€‰æ‹©å±æ€§ï¼ˆPropertiesï¼‰ï¼Œä¼šå¼¹å‡ºdialogçš„å±æ€§çª—å£ï¼Œå¯ä»¥è®¾ç½®ä¸€äº›å¯¹è¯æ¡†çš„ç›¸å…³å±æ€§ï¼Œå¦‚å›¾5ã€æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„BMIè®¡ç®—å™¨(ä½“é‡æŒ‡æ•°BMI&#x3D;ä½“é‡&#x2F;èº«é«˜çš„å¹³æ–¹ï¼ˆå›½é™…å•ä½kg&#x2F;ã¡ï¼‰)ï¼Œæ‹–åŠ¨ä¸‰ä¸ªEditåˆ†åˆ«ç”¨æ¥æ˜¾ç¤ºèº«é«˜ï¼Œä½“é‡ï¼ŒBMIå€¼ï¼Œå¹¶è®¾ç½®å±æ€§IDï¼Œåˆ†åˆ«ä¸ºï¼šIDC_EDIT_SGã€IDC_EDIT_TZ,IDC_EDIT_BMIï¼Œå¦‚å›¾æ‰€ç¤ºï¼š6ã€æ¥ä¸‹æ¥åˆ‡æ¢åˆ°ç±»è§†å›¾ï¼ˆclassViewï¼‰ï¼ŒåŒå‡»WinMainå…¥å£å‡½æ•°ï¼Œæ·»åŠ å¯¹è¯æ¡†è¯­å¥ï¼š\n1DialogBox(hInstance,(LPCTSTR)IDD_DIALOG_BMI,NULL,DlGFUNC);\nå…¶ä¸­IDD_DIALOG_BMIä¸ºåˆšæ‰æ·»åŠ çš„å¯¹è¯æ¡†å±æ€§IDï¼ŒDlGFUNCä¸ºå¯¹è¯æ¡†çš„æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼Œ7ã€æ¥ä¸‹æ¥æˆ‘ä»¬æ·»åŠ DlGFUNCå‡½æ•°ï¼Œå¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526BOOL CALLBACK DlGFUNC(HWND hwnd_dlg,UINT uMsg,WPARAM wParam,LPARAM lParam)&#123;\tswitch(uMsg)\t&#123;\tcase WM_COMMAND:\t\tswitch(wParam)\t\t&#123;\t\tcase IDCANCEL:\t\t\tEndDialog(hwnd_dlg,IDCANCEL);\t\t\tbreak;\t\tcase IDOK:\t\t\t&#123;\t\t\t\tint nHeight= GetDlgItemInt(hwnd_dlg,IDC_EDIT_SG,NULL,TRUE);\t\t\t\tdouble dHeight = nHeight / 100.00;\t\t\t\tint nWeight = GetDlgItemInt(hwnd_dlg,IDC_EDIT_TZ,NULL,TRUE);\t\t\t\tdouble bmi = nWeight/(dHeight*dHeight);\t\t\t\tchar buf[28];\t\t\t\tsprintf(buf, &quot;%.3f&quot;, bmi);\t\t\t\tSetDlgItemText(hwnd_dlg,IDC_EDIT_BMI,buf);\t\t\t&#125;\t\t\tbreak;\t\t&#125;\t\tbreak;\t&#125;\treturn FALSE;&#125;\nå…¶ä¸­IDOKï¼Œå’ŒIDCANCELä¸ºå¯¹è¯æ¡†ç¡®è®¤æŒ‰é’®å’Œå–æ¶ˆæŒ‰é’®æ‰€è§¦å‘æ¶ˆæ¯ï¼ŒIDCANCELå…³é—­å¯¹è¯æ¡†ï¼ŒIDOKæ¶ˆæ¯æˆ‘ä»¬æ¥è·å–èº«é«˜å’Œä½“é‡Editä¸­çš„å€¼ï¼Œå¹¶æŒ‰ç…§å…¬å¼ä½“é‡æŒ‡æ•°BMI&#x3D;ä½“é‡&#x2F;èº«é«˜çš„å¹³æ–¹ï¼ˆå›½é™…å•ä½kg&#x2F;ã¡ï¼‰è®¡ç®—BMI,æœ€åå°†BMIå€¼è®¾ç½®åˆ°BMI  Editä¸­ï¼š\n1234567int nHeight= GetDlgItemInt(hwnd_dlg,IDC_EDIT_SG,NULL,TRUE);double dHeight = nHeight / 100.00;int nWeight = GetDlgItemInt(hwnd_dlg,IDC_EDIT_TZ,NULL,TRUE);double bmi = nWeight/(dHeight*dHeight);char buf[28];sprintf(buf, &quot;%.3f&quot;, bmi);SetDlgItemText(hwnd_dlg,IDC_EDIT_BMI,buf);\næ³¨æ„ï¼šè¦åœ¨æ–‡ä»¶å¤´éƒ¨å¼•ç”¨èµ„æºå¤´æ–‡ä»¶ï¼š#include â€œresource.hâ€æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼šé™„day01.cppæºç ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445// day01.cpp : Defines the entry point for the application.//#include &quot;stdafx.h&quot;#include &quot;resource.h&quot;#include &quot;stdio.h&quot;BOOL CALLBACK DlGFUNC(HWND hwnd_dlg,UINT uMsg,WPARAM wParam,LPARAM lParam)&#123;\tswitch(uMsg)\t&#123;\tcase WM_COMMAND:\t\tswitch(wParam)\t\t&#123;\t\tcase IDCANCEL:\t\t\tEndDialog(hwnd_dlg,IDCANCEL);\t\t\tbreak;\t\tcase IDOK:\t\t\t&#123;\t\t\t\tint nHeight= GetDlgItemInt(hwnd_dlg,IDC_EDIT_SG,NULL,TRUE);\t\t\t\tdouble dHeight = nHeight / 100.00;\t\t\t\tint nWeight = GetDlgItemInt(hwnd_dlg,IDC_EDIT_TZ,NULL,TRUE);\t\t\t\tdouble bmi = nWeight/(dHeight*dHeight);\t\t\t\tchar buf[28];\t\t\t\tsprintf(buf, &quot;%.3f&quot;, bmi);\t\t\t\tSetDlgItemText(hwnd_dlg,IDC_EDIT_BMI,buf);\t\t\t&#125;\t\t\tbreak;\t\t&#125;\t\tbreak;\t&#125;\treturn FALSE;&#125;int APIENTRY WinMain(HINSTANCE hInstance,                     HINSTANCE hPrevInstance,                     LPSTR     lpCmdLine,                     int       nCmdShow)&#123; \t// TODO: Place code here.\tDialogBox(hInstance,(LPCTSTR)IDD_DIALOG_BMI,NULL,DlGFUNC);\treturn 0;&#125;\nåè®°ï¼š    DialogProcæ˜¯ä¸€ä¸ªçª—å£è¿‡ç¨‹å‡½æ•°ã€‚è¯¥å‡½æ•°ä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºå®šä¹‰å¯ä¸DialogBoxå‡½æ•°ä¸€èµ·ä½¿ç”¨çš„å›è°ƒå‡½æ•°ã€‚å®ƒå¤„ç†å‘é€åˆ°ä¸€ä¸ªæ¨¡æ€çš„æˆ–æ— æ¨¡å¼å¯¹è¯æ¡†çš„æ¶ˆæ¯ã€‚DLGPROCç±»å‹å®šä¹‰äº†ä¸€ä¸ªæŒ‡å‘æ­¤å›è°ƒå‡½æ•°çš„æŒ‡é’ˆã€‚DialogProcå‡½æ•°æ˜¯åº”ç”¨ç¨‹åºå®šä¹‰å‡½æ•°åçš„ä¸€ä¸ªå ä½ç¬¦ã€‚å‡½æ•°åŸå‹ï¼š\n123456BOOL CALLBACK DialogProc(HWND hwndDlg,UINT UMsg,WPARAM wParam,LPARAM lParam);\n\nhwndDlgæŒ‡å®šå¯¹è¯æ¡†ã€‚uMsgæŒ‡å®šæ¶ˆæ¯ã€‚wParamæŒ‡å®šæ¶ˆæ¯ç‰¹å®šçš„å…¶ä»–ä¿¡æ¯ã€‚IparamæŒ‡å®šæ¶ˆæ¯ç‰¹å®šçš„å…¶ä»–ä¿¡æ¯ã€‚\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘æ¥forkï¼š\n1https://gitee.com/AmuUncle/MFC_CSDN.git","slug":"MFC/MFC02","date":"2017-10-28T14:55:13.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"},{"id":"c9371cf78a705f43f8740427c79cb17f","title":"Windowsç¼–ç¨‹åŸºç¡€--ç¬¬1èŠ‚  ç¬¬ä¸€ä¸ªwin32è½¯ä»¶","content":"Windowsç¼–ç¨‹åŸºç¡€â€“ç¬¬1èŠ‚  ç¬¬ä¸€ä¸ªwin32è½¯ä»¶ä¸‹é¢æ–°å»ºä¸€ä¸ªwin32ç¨‹åºï¼Œæ¥æ¼”ç¤ºwin32ç¨‹åºå¼€å‘çš„åŸç†ï¼ˆæ“ä½œç³»ç»Ÿï¼šwin10 64ä½    IDEï¼švc++ 6.0ï¼‰ 1ã€æ‰§è¡ŒFile -&gt; newå‘½ä»¤ï¼Œæ¥æ–°å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š  2ã€ç‚¹å‡» OKæŒ‰é’®ï¼Œç„¶åé€‰æ‹©A simple win32 applicationï¼Œå•å‡»Finishå®Œæˆåˆ›å»ºï¼› 3ã€æ­¤æ—¶å³è¾¹é¡¹ç›®è§†å›¾ä¼šæ˜¾ç¤ºæˆ‘ä»¬åˆšæ‰åˆ›å»ºå¥½çš„é¡¹ç›®ï¼ŒåŒå‡»Globalsä¸‹é¢çš„WinMainå‡½æ•°  4ã€ç°åœ¨æ¥æ–°å»ºä¸€ä¸ªç®€å•çš„å¯¹è¯æ¡†\n1MessageBox(NULL,&quot;Hello World!!&quot;,&quot;My First Win32 App&quot;,MB_OK);\n5ã€å•å‡»çŠ¶æ€æ ä¸Šçš„ â€œbuildâ€ï¼Œæˆ–è€…ç›´æ¥æŒ‰é”®è¿›è¡Œç¼–è¯‘ï¼Œç„¶åå•å‡»çŠ¶æ€æ çš„ ï¼ æ¥è¿è¡Œç¨‹åºï¼Œæˆ–è€…ctrl+F5;ä»¥ä¸‹æ˜¯MessageBoxçš„åŸå‹ï¼š\n123456int WINAPI MessageBox(  HWND hWnd,          // handle of owner window  LPCTSTR lpText,     // address of text in message box  LPCTSTR lpCaption, // address of title of message box  UINT uType          // style of message box);\nhWndæ˜¯æ¶ˆæ¯æ¡†çš„æ‹¥æœ‰çª—å£ã€‚å¦‚æœæ­¤å‚æ•°ä¸ºNULLï¼Œåˆ™æ¶ˆæ¯æ¡†æ²¡æœ‰æ‹¥æœ‰çª—å£ã€‚lpTextä¸ºæ¶ˆæ¯æ¡†çš„å†…å®¹ã€‚lpCaptionä¸ºæ¶ˆæ¯æ¡†çš„æ ‡é¢˜ã€‚uTypeæŒ‡å®šä¸€ä¸ªå†³å®šå¯¹è¯æ¡†çš„å†…å®¹å’Œè¡Œä¸ºï¼ˆæŒ‰é’®ã€å›¾æ ‡ã€å½¢æ€åŠå…¶ä»–ï¼‰çš„ä½æ ‡å¿—é›†ã€‚é™„å…¶å®ƒå¸¸ç”¨å±æ€§ \nç³»ç»Ÿé»˜è®¤å›¾æ ‡ï¼Œå¯åœ¨æ¶ˆæ¯æ¡†ä¸Šæ˜¾ç¤ºXé”™è¯¯ MB_ICONHAND, MB_ICONSTOP, and MB_ICONERROR?è¯¢é—® MB_ICONQUESTION!è­¦å‘Š MB_ICONEXCLAMATION and MB_ICONWARNINGiä¿¡æ¯ MB_ICONASTERISK and MB_ICONINFORMATION \næŒ‰é’®çš„å½¢å¼ \nMB_OK é»˜è®¤MB_OKCANCEL ç¡®å®šå–æ¶ˆMB_YESNO æ˜¯å¦MB_YESNOCANCEL æ˜¯å¦å–æ¶ˆ \nè¿”å›å€¼ \nIDCANCEL å–æ¶ˆè¢«é€‰IDNO å¦è¢«é€‰IDOK ç¡®å®šè¢«é€‰IDYES æ˜¯è¢«é€‰6ã€å¯¹ç…§å‡½æ•°è¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•æ ¹æ®å¯¹è¯æ¡†è¿”å›å€¼æ¥æ‰§è¡Œä¸åŒçš„ä»£ç ï¼Œå¦‚å›¾ï¼š\n12345678910111213141516171819#include &quot;stdafx.h&quot;int APIENTRY WinMain(HINSTANCE hInstance,                     HINSTANCE hPrevInstance,                     LPSTR     lpCmdLine,                     int       nCmdShow)&#123; \t// TODO: Place code here.\tint ret = MessageBox(NULL,&quot;Hello World!!&quot;,&quot;My First Win32 App&quot;,MB_OKCANCEL );\tif(IDCANCEL == ret)\t&#123;\t\tMessageBox(NULL,&quot;CANCEL is clicked&quot;,&quot;My First Win32 App&quot;,MB_OK);\t&#125;\telse if(IDOK  == ret)\t&#123;\t\tMessageBox(NULL,&quot;OK is clicked&quot;,&quot;My First Win32 App&quot;,MB_OK);\t&#125;\treturn 0;&#125;\n\n\né¡¹ç›®æºç å¯ä»¥è®¿é—®æˆ‘çš„ç äº‘æ¥forkï¼š\n1https://gitee.com/AmuUncle/MFC_CSDN.git","slug":"MFC/MFC01","date":"2017-10-28T14:42:12.000Z","categories_index":"MFCä»å…¥é—¨åˆ°æ”¾å¼ƒ","tags_index":"MFC","author_index":"é˜¿æœ¨å¤§å”"}]