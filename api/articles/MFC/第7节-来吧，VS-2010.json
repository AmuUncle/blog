{"title":"第7节 来吧，VS 2010","uid":"b83dba6958730d41cfeb66ec4a2f0efa","slug":"MFC/第7节-来吧，VS-2010","date":"2017-10-28T15:32:25.000Z","updated":"2023-05-19T05:34:20.892Z","comments":true,"path":"api/articles/MFC/第7节-来吧，VS-2010.json","keywords":null,"cover":[],"content":"<h1 id=\"Windows编程基础–第7节-来吧，VS-2010\"><a href=\"#Windows编程基础–第7节-来吧，VS-2010\" class=\"headerlink\" title=\"Windows编程基础–第7节 来吧，VS 2010\"></a>Windows编程基础–第7节 来吧，VS 2010</h1><h1 id=\"VS-2010开发第一步\"><a href=\"#VS-2010开发第一步\" class=\"headerlink\" title=\"VS 2010开发第一步\"></a>VS 2010开发第一步</h1><hr>\n<p>前面几节我们都是采用<strong>VC++ 6.0 作为IDE（集成开发环境）</strong>，但是由于**VC++ 6.0 **已经过于老旧，目前大多数企业和个人都已经不再使用，而采用vs2005， vs2008， vs2010，vs2015作为MFC程序的开发环境，vs相对vc++6.0具有更友好的界面，及更强大的功能，采用vs开发MFC应用程序更加得心应手。</p>\n<h2 id=\"1、开始使用VS-2010\"><a href=\"#1、开始使用VS-2010\" class=\"headerlink\" title=\"1、开始使用VS 2010\"></a>1、开始使用VS 2010</h2><h3 id=\"1-1-安装VS-2010\"><a href=\"#1-1-安装VS-2010\" class=\"headerlink\" title=\"1.1 安装VS 2010\"></a>1.1 安装VS 2010</h3><p><a href=\"https://jingyan.baidu.com/article/4e5b3e195b838991901e24e5.html\">参见百度百科</a></p>\n<h3 id=\"1-2-创建一个基于对话框项目\"><a href=\"#1-2-创建一个基于对话框项目\" class=\"headerlink\" title=\"1.2 创建一个基于对话框项目\"></a>1.2 创建一个基于对话框项目</h3><p>执行“文件”-&gt;“新建”-&gt;“项目”，选择基于对话框的MFC程序，其他默认就好，基本上和**VC++ 6.0 **创建项目一模一样，如图所示：<br><img src=\"http://img.blog.csdn.net/20171023201320375?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br><img src=\"http://img.blog.csdn.net/20171023201410030?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br><img src=\"http://img.blog.csdn.net/20171023201434296?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h3 id=\"1-3-创建一个字符统计窗口\"><a href=\"#1-3-创建一个字符统计窗口\" class=\"headerlink\" title=\"1.3 创建一个字符统计窗口\"></a>1.3 创建一个字符统计窗口</h3><p>现在我们通过一个小例子来看看VS2010创建MFC程序有什么不同，我们来创建一个字符统计窗口，输入各种字符，最后统计出所有字符个数；<br>设计界面如下，<br><img src=\"http://img.blog.csdn.net/20171023202332101?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>一个文本输入框，一个“统计”按钮，一个文本显示“字符个数”，直接在工具箱中拖动进来就OK，然后拖动大小适中就好，方法同**VC++ 6.0 **没有区别，可以参考上几节内容。<br><strong>注意:</strong> 若是右边没有工具箱选项卡，可以通过“视图”-&gt;“工具箱”打开。<br>编译运行，效果图：<br><img src=\"http://img.blog.csdn.net/20171023203106380?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h3 id=\"1-3-创建一个字符统计窗口-1\"><a href=\"#1-3-创建一个字符统计窗口-1\" class=\"headerlink\" title=\"1.3 创建一个字符统计窗口\"></a>1.3 创建一个字符统计窗口</h3><p>双击“统计”按钮，编辑按钮的点击处理函数，<br>我们来分析一下：</p>\n<blockquote>\n<ul>\n<li>获取输入框中文本</li>\n<li>获取输入框中文本的字符个数</li>\n<li>将字符个数显示到静态文本上<br>所以处理函数如下：</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void Cday07Dlg::OnBnClickedButtonCount()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t// TODO: 在此添加控件通知处理程序代码</span><br><span class=\"line\">\tCString strInput,strOutput;</span><br><span class=\"line\">\tGetDlgItemText(IDC_EDIT_TEXT,strInput);</span><br><span class=\"line\"></span><br><span class=\"line\">\tint nCount = strInput.GetLength();</span><br><span class=\"line\">\tstrOutput.Format(_T(&quot;字符个数：%d &quot;),nCount);</span><br><span class=\"line\">\tSetDlgItemText(IDC_STATIC_COUNT,strOutput);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-4-编译运行\"><a href=\"#1-4-编译运行\" class=\"headerlink\" title=\"1.4 编译运行\"></a>1.4 编译运行</h3><p>运行结果图：<br><img src=\"http://img.blog.csdn.net/20171023204200061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>这是我们发现当我们输入完成是，输入“回车”时，程序就会直接结束，那么我们修改输入框的属性值“Want Return”来允许输入框来接收回车，如图<br><img src=\"http://img.blog.csdn.net/20171023204439088?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>其实这是我们可以发现现在文本框是只能输入一行，显然不够美观，那么我们再修改一下输入框属性：<br><img src=\"http://img.blog.csdn.net/20171023205039008?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<blockquote>\n<ol>\n<li>Multiline：允许多行 </li>\n<li>Horizontal Scroll：水平滚动条 </li>\n<li>Vertical Scroll:垂直滚动条</li>\n</ol>\n</blockquote>\n<p>再次编译运行：<br><img src=\"http://img.blog.csdn.net/20171023205614359?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>现在文本框现在可以输入多行，并且可以任意回车了。<br>有人可能和我一样，发现程序没有关闭按钮，那是因为我在创建的时候取消了系统菜单，我们可以选定对话框主界面，选择属性-&gt;system menu-&gt;TRUE:<br><img src=\"http://img.blog.csdn.net/20171023205947196?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>这是关闭按钮就出现了，可以正常关闭了。</p>\n<h2 id=\"2、初探VS中消息映射机制\"><a href=\"#2、初探VS中消息映射机制\" class=\"headerlink\" title=\"2、初探VS中消息映射机制\"></a>2、初探VS中消息映射机制</h2><h3 id=\"2-1-创建EDIT的消息处理函数\"><a href=\"#2-1-创建EDIT的消息处理函数\" class=\"headerlink\" title=\"2.1 创建EDIT的消息处理函数\"></a>2.1 创建EDIT的消息处理函数</h3><p>单击选定输入框，右击选择“添加事件处理程序”，这是可以很直观的看见EDIT的消息列表和要添加到的类，以及添加的处理函数名，现在我们来添加一个EN_CHANGE的消息处理函数，如图所示：<br><img src=\"http://img.blog.csdn.net/20171023212741178?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"><br>单击“添加编辑”来编辑消息处理函数，代码如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void Cday07Dlg::OnEnChangeEditText()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t// TODO:  如果该控件是 RICHEDIT 控件，它将不</span><br><span class=\"line\">\t// 发送此通知，除非重写 CDialogEx::OnInitDialog()</span><br><span class=\"line\">\t// 函数并调用 CRichEditCtrl().SetEventMask()，</span><br><span class=\"line\">\t// 同时将 ENM_CHANGE 标志“或”运算到掩码中。</span><br><span class=\"line\"></span><br><span class=\"line\">\t// TODO:  在此添加控件通知处理程序代码</span><br><span class=\"line\">\tCString strInput,strOutput;</span><br><span class=\"line\">\tGetDlgItemText(IDC_EDIT_TEXT,strInput);</span><br><span class=\"line\"></span><br><span class=\"line\">\tint nCount = strInput.GetLength();</span><br><span class=\"line\">\tstrOutput.Format(_T(&quot;字符个数：%d &quot;),nCount);</span><br><span class=\"line\">\tSetDlgItemText(IDC_STATIC_COUNT,strOutput);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-2-编译运行\"><a href=\"#2-2-编译运行\" class=\"headerlink\" title=\"2.2 编译运行\"></a>2.2 编译运行</h3><p>这是我们可以发现我们在输入框中输入字符时，下方的字符统计数会实时显示，这就是输入文本时，EDIT的EN_CHANGE消息被触发，从而触发其消息处理函数OnEnChangeEditText，导致字符统计数实时更新，效果图如下：<br><img src=\"http://img.blog.csdn.net/20171023213131534?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h3 id=\"2-3-MFC消息映射机制流程\"><a href=\"#2-3-MFC消息映射机制流程\" class=\"headerlink\" title=\"2.3 MFC消息映射机制流程\"></a>2.3 MFC消息映射机制流程</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">st=&gt;start: Start</span><br><span class=\"line\">op=&gt;operation: 输入框文本变化</span><br><span class=\"line\">op2=&gt;operation: 触发EN_CHANGE消息</span><br><span class=\"line\">op3=&gt;operation: 调用EN_CHANGE的处理函数OnEnChangeEditText</span><br><span class=\"line\">op4=&gt;operation: 将输入框字符数返回到界面</span><br><span class=\"line\">e=&gt;end</span><br><span class=\"line\"></span><br><span class=\"line\">st-&gt;op-&gt;op2-&gt;op3-&gt;op4-&gt;e</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"项目源码可以访问我的码云\"><a href=\"#项目源码可以访问我的码云\" class=\"headerlink\" title=\"项目源码可以访问我的码云\"></a><a href=\"https://gitee.com/AmuUncle/MFC_CSDN.git\">项目源码可以访问我的码云</a></h3>","text":"Windows编程基础–第7节 来吧，VS 2010VS 2010开发第一步 前面几节我们都是采用VC++ 6.0 作为IDE（集成开发环境），但是由于**VC...","permalink":"/post/MFC/第7节-来吧，VS-2010","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"MFC从入门到放弃","slug":"MFC从入门到放弃","count":15,"path":"api/categories/MFC从入门到放弃.json"}],"tags":[{"name":"MFC","slug":"MFC","count":15,"path":"api/tags/MFC.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Windows%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%E2%80%93%E7%AC%AC7%E8%8A%82-%E6%9D%A5%E5%90%A7%EF%BC%8CVS-2010\"><span class=\"toc-text\">Windows编程基础–第7节 来吧，VS 2010</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#VS-2010%E5%BC%80%E5%8F%91%E7%AC%AC%E4%B8%80%E6%AD%A5\"><span class=\"toc-text\">VS 2010开发第一步</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1%E3%80%81%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8VS-2010\"><span class=\"toc-text\">1、开始使用VS 2010</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1-%E5%AE%89%E8%A3%85VS-2010\"><span class=\"toc-text\">1.1 安装VS 2010</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E5%AF%B9%E8%AF%9D%E6%A1%86%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">1.2 创建一个基于对话框项目</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E7%BB%9F%E8%AE%A1%E7%AA%97%E5%8F%A3\"><span class=\"toc-text\">1.3 创建一个字符统计窗口</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E7%BB%9F%E8%AE%A1%E7%AA%97%E5%8F%A3-1\"><span class=\"toc-text\">1.3 创建一个字符统计窗口</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4-%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C\"><span class=\"toc-text\">1.4 编译运行</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2%E3%80%81%E5%88%9D%E6%8E%A2VS%E4%B8%AD%E6%B6%88%E6%81%AF%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6\"><span class=\"toc-text\">2、初探VS中消息映射机制</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-%E5%88%9B%E5%BB%BAEDIT%E7%9A%84%E6%B6%88%E6%81%AF%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">2.1 创建EDIT的消息处理函数</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C\"><span class=\"toc-text\">2.2 编译运行</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-3-MFC%E6%B6%88%E6%81%AF%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6%E6%B5%81%E7%A8%8B\"><span class=\"toc-text\">2.3 MFC消息映射机制流程</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E6%88%91%E7%9A%84%E7%A0%81%E4%BA%91\"><span class=\"toc-text\">项目源码可以访问我的码云</span></a></li></ol></li></ol></li></ol>","author":{"name":"阿木大叔","slug":"blog-author","avatar":"/images/base/logo.png","link":"/","description":"坚持code，努力吹牛 <br /> @ <b>gitee：阿木大叔</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"第8节 MFC对话框控件访问的七种方法（上）","uid":"89acd55286d16d2f969d7ac76f20c8d8","slug":"MFC/第8节-MFC对话框控件访问的七种方法（上）","date":"2017-10-28T15:32:43.000Z","updated":"2023-05-19T05:34:20.913Z","comments":true,"path":"api/articles/MFC/第8节-MFC对话框控件访问的七种方法（上）.json","keywords":null,"cover":[],"text":"Windows编程基础–第8节 MFC对话框控件访问的七种方法（上）MFC对话框控件具有以下三种访问方式(当然还有很多别的访问方式，今天时间紧急，先学这三种)，...","permalink":"/post/MFC/第8节-MFC对话框控件访问的七种方法（上）","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"MFC从入门到放弃","slug":"MFC从入门到放弃","count":15,"path":"api/categories/MFC从入门到放弃.json"}],"tags":[{"name":"MFC","slug":"MFC","count":15,"path":"api/tags/MFC.json"}],"author":{"name":"阿木大叔","slug":"blog-author","avatar":"/images/base/logo.png","link":"/","description":"坚持code，努力吹牛 <br /> @ <b>gitee：阿木大叔</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"第6节 VC++6.0控件说明","uid":"9179eacff46448e05283197250e564aa","slug":"MFC/第6节-VC-6-0控件说明","date":"2017-10-28T15:32:11.000Z","updated":"2023-05-19T05:34:20.892Z","comments":true,"path":"api/articles/MFC/第6节-VC-6-0控件说明.json","keywords":null,"cover":[],"text":"Windows编程基础–第6节 VC++6.0控件说明VC++6.0控件工具箱 控件说明 2 图形控件（picture）：常用于显示位图（Bitmap）和图标（...","permalink":"/post/MFC/第6节-VC-6-0控件说明","photos":[],"count_time":{"symbolsCount":"24k","symbolsTime":"22 mins."},"categories":[{"name":"MFC从入门到放弃","slug":"MFC从入门到放弃","count":15,"path":"api/categories/MFC从入门到放弃.json"}],"tags":[{"name":"MFC","slug":"MFC","count":15,"path":"api/tags/MFC.json"}],"author":{"name":"阿木大叔","slug":"blog-author","avatar":"/images/base/logo.png","link":"/","description":"坚持code，努力吹牛 <br /> @ <b>gitee：阿木大叔</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}