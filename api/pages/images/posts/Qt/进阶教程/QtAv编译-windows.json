{"title":"QtAv编译-windows平台","type":"page","uid":"c8d3f9d5025f627264e29f8766a44133","text":" 简介 QtAV是基于Qt和FFmpeg的多媒体播放库。它可以帮助您以前所未有的精力编写播放器。 QtAV强大的功能 QtAV可以满足您的最大需求 硬件解码支持：DXVA2，VAAPI，VDA / VideoToolbox，CedarX，CUDA（第一个播放器在Linux上支持C...","date":"2022-11-02T05:57:29.000Z","updated":"2023-05-19T05:34:19.756Z","comments":true,"path":"api/pages/images/posts/Qt/进阶教程/QtAv编译-windows.json","covers":[],"excerpt":"","content":"<hr>\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><blockquote>\n<p>QtAV是基于Qt和FFmpeg的多媒体播放库。它可以帮助您以前所未有的精力编写播放器。</p>\n</blockquote>\n<h2 id=\"QtAV强大的功能\"><a href=\"#QtAV强大的功能\" class=\"headerlink\" title=\"QtAV强大的功能\"></a>QtAV强大的功能</h2><blockquote>\n<p>QtAV可以满足您的最大需求</p>\n<ul>\n<li>硬件解码支持：DXVA2，VAAPI，VDA &#x2F; VideoToolbox，CedarX，CUDA（第一个播放器在Linux上支持CUDA吗？）</li>\n<li>OpenGL和ES2支持几乎所有格式，包括Hi10P视频（第一个播放器&#x2F;库在ES2中支持10bit？VLC，XBMC，mplayer现在不支持）</li>\n<li>实时预览</li>\n<li>RGB和YUV格式的视频捕获</li>\n<li>OSD和自定义过滤器</li>\n<li>libavfilter中的过滤器，例如stero3d，模糊</li>\n<li>字幕轨道选择。动态更改FFmpeg和libass引擎</li>\n<li>逐帧播放</li>\n<li>播放速度控制</li>\n<li>各种流：区域设置文件，http，rtsp等以及您的自定义流</li>\n<li>音频通道，轨道和外部音频轨道</li>\n<li>播放时动态更改渲染引擎。</li>\n<li>动态更改视频解码器</li>\n<li>1个播放器的多个视频输出</li>\n<li>视频均衡器（软件和OpenGL）：亮度，对比度，饱和度，色相</li>\n<li>QML支持。大多数播放API与QtMultimedia模块兼容</li>\n<li>兼容性：QtAV可以同时使用Qt4和Qt5，FFmpeg（&gt; &#x3D; 1.0）和Libav（&gt; &#x3D; 9.0）来构建。建议使用最新的FFmpeg版本。</li>\n</ul>\n</blockquote>\n<hr>\n<h2 id=\"编译准备\"><a href=\"#编译准备\" class=\"headerlink\" title=\"编译准备\"></a>编译准备</h2><p>作者目前所使用的的环境为Qt5.9.3 + vs2015编译器</p>\n<h3 id=\"下载FFmpeg\"><a href=\"#下载FFmpeg\" class=\"headerlink\" title=\"下载FFmpeg\"></a>下载FFmpeg</h3><h4 id=\"直接下载官方提供的开发库\"><a href=\"#直接下载官方提供的开发库\" class=\"headerlink\" title=\"直接下载官方提供的开发库\"></a>直接下载官方提供的开发库</h4><p>下载地址：<br>    - <a href=\"https://ffmpeg.zeranoe.com/builds/win64/dev/ffmpeg-3.4.2-win64-dev.zip\">https://ffmpeg.zeranoe.com/builds/win64/dev/ffmpeg-3.4.2-win64-dev.zip</a><br>    - <a href=\"https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-3.4.2-win64-shared.zip\">https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-3.4.2-win64-shared.zip</a></p>\n<h4 id=\"使用QtAv提供的开发库（推荐）\"><a href=\"#使用QtAv提供的开发库（推荐）\" class=\"headerlink\" title=\"使用QtAv提供的开发库（推荐）\"></a>使用QtAv提供的开发库（推荐）</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">- 文件名：QtAV-depends-windows-x86+x64.7z</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- http://sourceforge.net/projects/qtav/files/depends/QtAV-depends-windows-x86+x64.7z/download</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- 本教程采用此种方式编译QtAv</span></span></code></pre></div><h4 id=\"自行编译FFmpeg\"><a href=\"#自行编译FFmpeg\" class=\"headerlink\" title=\"自行编译FFmpeg\"></a>自行编译FFmpeg</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">- 自行编译比较麻烦，感兴趣的可以自行尝试，这里不再赘述</span></span></code></pre></div><h3 id=\"下载QtAv源码\"><a href=\"#下载QtAv源码\" class=\"headerlink\" title=\"下载QtAv源码\"></a>下载QtAv源码</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">- 访问QtAv github地址：https://github.com/wang-bin/QtAV/</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- 可以使用git clone或者直接下载源代码</span></span></code></pre></div><h2 id=\"配置环境\"><a href=\"#配置环境\" class=\"headerlink\" title=\"配置环境\"></a>配置环境</h2><ul>\n<li>进入QtAv代码根目录</li>\n<li>创建ffmpeg&#x2F;win目录<br><img src=\"/QtAv%E7%BC%96%E8%AF%91-windows/01.png\" alt=\"创建ffmpeg目录\"></li>\n<li>解压上面下载的FFmpeg依赖库：QtAV-depends-windows-x86+x64.7z，解压到上面创建ffmpeg&#x2F;win目录</li>\n<li>目录结构如下<br><img src=\"/QtAv%E7%BC%96%E8%AF%91-windows/02.png\" alt=\"ffmpeg目录\"></li>\n<li>修改QtAv&#x2F;.qmake.conf文件</li>\n<li>在最后加上下面两行，即设置FFmpeg的动态库路径及头文件路径<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">INCLUDEPATH += $$PWD/ffmpeg/win/include</span><br><span class=\"line\">LIBS +=  -L$$PWD/ffmpeg/win/lib</span><br></pre></td></tr></table></figure></li>\n<li>完整文件如下<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">QTAV_MAJOR_VERSION = 1</span><br><span class=\"line\">QTAV_MINOR_VERSION = 13</span><br><span class=\"line\">QTAV_PATCH_VERSION = 0</span><br><span class=\"line\"></span><br><span class=\"line\">QTAV_VERSION = $$&#123;QTAV_MAJOR_VERSION&#125;.$$&#123;QTAV_MINOR_VERSION&#125;.$$&#123;QTAV_PATCH_VERSION&#125;</span><br><span class=\"line\">#MODULE_VERSION = $$QTAV_VERSION</span><br><span class=\"line\"></span><br><span class=\"line\"># set runpath instead of rpath for gcc for elf targets. Qt&gt;=5.5</span><br><span class=\"line\">CONFIG *= enable_new_dtags</span><br><span class=\"line\"># OSX10.6 is not supported in Qt5.4</span><br><span class=\"line\">macx:isEqual(QT_MAJOR_VERSION,5):greaterThan(QT_MINOR_VERSION, 3): CONFIG *= c++11</span><br><span class=\"line\">android: CONFIG*=c++11</span><br><span class=\"line\">QMAKE_MACOSX_DEPLOYMENT_TARGET = 10.8</span><br><span class=\"line\">QMAKE_IOS_DEPLOYMENT_TARGET = 6.0</span><br><span class=\"line\"></span><br><span class=\"line\"># 阿木大叔</span><br><span class=\"line\">INCLUDEPATH += $$PWD/ffmpeg/win/include</span><br><span class=\"line\">LIBS +=  -L$$PWD/ffmpeg/win/lib</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"开始编译\"><a href=\"#开始编译\" class=\"headerlink\" title=\"开始编译\"></a>开始编译</h2><ul>\n<li>使用QtCreator打开QtAv.pro文件</li>\n<li>进行编译即可</li>\n</ul>\n<h2 id=\"运行-测试\"><a href=\"#运行-测试\" class=\"headerlink\" title=\"运行&amp;测试\"></a>运行&amp;测试</h2><ul>\n<li>将QtAV\\ffmpeg\\win\\bin下面的所有dll文件拷贝到QtAV\\bin目录</li>\n<li>选择simpleplayer项目，点击运行即可<br><img src=\"/QtAv%E7%BC%96%E8%AF%91-windows/03.png\" alt=\"运行&amp;测试\"><br><img src=\"/QtAv%E7%BC%96%E8%AF%91-windows/04.png\" alt=\"运行&amp;测试\"></li>\n<li>可以看见一个简易的视频播放器就出现了，可以去播放测试了</li>\n</ul>\n<h2 id=\"使用QtAv动态库\"><a href=\"#使用QtAv动态库\" class=\"headerlink\" title=\"使用QtAv动态库\"></a>使用QtAv动态库</h2><ul>\n<li>在QtAV\\lib_win_x86目录下有生成的QmlAV.dll及QmlAV.lib，QtAVWidgets1.lib，QtAVWidgets1.lib，这四个文件即我们需要的动态库文件</li>\n<li>QtAV\\src\\QtAV和QtAV\\widgets\\QtAVWidgets两个目录为上面两个动态库的头文件</li>\n<li>有了上面这些文件，你就可以集成到自己的程序里，开发自己的播放器了，具体开发过程这里就不再说明了，有机会可以再写一篇教程，具体可以看官方示例就行</li>\n</ul>\n","count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">简介</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#QtAV%E5%BC%BA%E5%A4%A7%E7%9A%84%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">QtAV强大的功能</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%87%86%E5%A4%87\"><span class=\"toc-text\">编译准备</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BDFFmpeg\"><span class=\"toc-text\">下载FFmpeg</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84%E5%BC%80%E5%8F%91%E5%BA%93\"><span class=\"toc-text\">直接下载官方提供的开发库</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8QtAv%E6%8F%90%E4%BE%9B%E7%9A%84%E5%BC%80%E5%8F%91%E5%BA%93%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89\"><span class=\"toc-text\">使用QtAv提供的开发库（推荐）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%87%AA%E8%A1%8C%E7%BC%96%E8%AF%91FFmpeg\"><span class=\"toc-text\">自行编译FFmpeg</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BDQtAv%E6%BA%90%E7%A0%81\"><span class=\"toc-text\">下载QtAv源码</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">配置环境</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%A7%8B%E7%BC%96%E8%AF%91\"><span class=\"toc-text\">开始编译</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C-%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">运行&amp;测试</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8QtAv%E5%8A%A8%E6%80%81%E5%BA%93\"><span class=\"toc-text\">使用QtAv动态库</span></a></li></ol>","data":[]}